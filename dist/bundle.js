/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var t={733:(t,e,n)=>{t.exports=function t(e,n,r){function i(a,s){if(!n[a]){if(!e[a]){if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};e[a][0].call(c.exports,(function(t){return i(e[a][1][t]||t)}),c,c.exports,t,e,n,r)}return n[a].exports}for(var o=void 0,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,e,n){"use strict";var r=t("./utils"),i=t("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(t){for(var e,n,i,a,s,l,c,u=[],d=0,h=t.length,p=h,m="string"!==r.getTypeOf(t);d<t.length;)p=h-d,i=m?(e=t[d++],n=d<h?t[d++]:0,d<h?t[d++]:0):(e=t.charCodeAt(d++),n=d<h?t.charCodeAt(d++):0,d<h?t.charCodeAt(d++):0),a=e>>2,s=(3&e)<<4|n>>4,l=1<p?(15&n)<<2|i>>6:64,c=2<p?63&i:64,u.push(o.charAt(a)+o.charAt(s)+o.charAt(l)+o.charAt(c));return u.join("")},n.decode=function(t){var e,n,r,a,s,l,c=0,u=0,d="data:";if(t.substr(0,d.length)===d)throw new Error("Invalid base64 input, it looks like a data url.");var h,p=3*(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(t.charAt(t.length-1)===o.charAt(64)&&p--,t.charAt(t.length-2)===o.charAt(64)&&p--,p%1!=0)throw new Error("Invalid base64 input, bad content length.");for(h=i.uint8array?new Uint8Array(0|p):new Array(0|p);c<t.length;)e=o.indexOf(t.charAt(c++))<<2|(a=o.indexOf(t.charAt(c++)))>>4,n=(15&a)<<4|(s=o.indexOf(t.charAt(c++)))>>2,r=(3&s)<<6|(l=o.indexOf(t.charAt(c++))),h[u++]=e,64!==s&&(h[u++]=n),64!==l&&(h[u++]=r);return h}},{"./support":30,"./utils":32}],2:[function(t,e,n){"use strict";var r=t("./external"),i=t("./stream/DataWorker"),o=t("./stream/Crc32Probe"),a=t("./stream/DataLengthProbe");function s(t,e,n,r,i){this.compressedSize=t,this.uncompressedSize=e,this.crc32=n,this.compression=r,this.compressedContent=i}s.prototype={getContentWorker:function(){var t=new i(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),e=this;return t.on("end",(function(){if(this.streamInfo.data_length!==e.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),t},getCompressedWorker:function(){return new i(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(t,e,n){return t.pipe(new o).pipe(new a("uncompressedSize")).pipe(e.compressWorker(n)).pipe(new a("compressedSize")).withStreamInfo("compression",e)},e.exports=s},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,e,n){"use strict";var r=t("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(t){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},n.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,e,n){"use strict";var r=t("./utils"),i=function(){for(var t,e=[],n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e}();e.exports=function(t,e){return void 0!==t&&t.length?"string"!==r.getTypeOf(t)?function(t,e,n,r){var o=i,a=0+n;t^=-1;for(var s=0;s<a;s++)t=t>>>8^o[255&(t^e[s])];return-1^t}(0|e,t,t.length):function(t,e,n,r){var o=i,a=0+n;t^=-1;for(var s=0;s<a;s++)t=t>>>8^o[255&(t^e.charCodeAt(s))];return-1^t}(0|e,t,t.length):0}},{"./utils":32}],5:[function(t,e,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(t,e,n){"use strict";var r;r="undefined"!=typeof Promise?Promise:t("lie"),e.exports={Promise:r}},{lie:37}],7:[function(t,e,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=t("pako"),o=t("./utils"),a=t("./stream/GenericWorker"),s=r?"uint8array":"array";function l(t,e){a.call(this,"FlateWorker/"+t),this._pako=null,this._pakoAction=t,this._pakoOptions=e,this.meta={}}n.magic="\b\0",o.inherits(l,a),l.prototype.processChunk=function(t){this.meta=t.meta,null===this._pako&&this._createPako(),this._pako.push(o.transformTo(s,t.data),!1)},l.prototype.flush=function(){a.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var t=this;this._pako.onData=function(e){t.push({data:e,meta:t.meta})}},n.compressWorker=function(t){return new l("Deflate",t)},n.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,e,n){"use strict";function r(t,e){var n,r="";for(n=0;n<e;n++)r+=String.fromCharCode(255&t),t>>>=8;return r}function i(t,e,n,i,a,u){var d,h,p=t.file,m=t.compression,_=u!==s.utf8encode,f=o.transformTo("string",u(p.name)),g=o.transformTo("string",s.utf8encode(p.name)),b=p.comment,v=o.transformTo("string",u(b)),y=o.transformTo("string",s.utf8encode(b)),w=g.length!==p.name.length,E=y.length!==b.length,k="",x="",C="",S=p.dir,T=p.date,L={crc32:0,compressedSize:0,uncompressedSize:0};e&&!n||(L.crc32=t.crc32,L.compressedSize=t.compressedSize,L.uncompressedSize=t.uncompressedSize);var I=0;e&&(I|=8),_||!w&&!E||(I|=2048);var D=0,R=0;S&&(D|=16),"UNIX"===a?(R=798,D|=function(t,e){var n=t;return t||(n=e?16893:33204),(65535&n)<<16}(p.unixPermissions,S)):(R=20,D|=function(t){return 63&(t||0)}(p.dosPermissions)),d=T.getUTCHours(),d<<=6,d|=T.getUTCMinutes(),d<<=5,d|=T.getUTCSeconds()/2,h=T.getUTCFullYear()-1980,h<<=4,h|=T.getUTCMonth()+1,h<<=5,h|=T.getUTCDate(),w&&(x=r(1,1)+r(l(f),4)+g,k+="up"+r(x.length,2)+x),E&&(C=r(1,1)+r(l(v),4)+y,k+="uc"+r(C.length,2)+C);var A="";return A+="\n\0",A+=r(I,2),A+=m.magic,A+=r(d,2),A+=r(h,2),A+=r(L.crc32,4),A+=r(L.compressedSize,4),A+=r(L.uncompressedSize,4),A+=r(f.length,2),A+=r(k.length,2),{fileRecord:c.LOCAL_FILE_HEADER+A+f+k,dirRecord:c.CENTRAL_FILE_HEADER+r(R,2)+A+r(v.length,2)+"\0\0\0\0"+r(D,4)+r(i,4)+f+k+v}}var o=t("../utils"),a=t("../stream/GenericWorker"),s=t("../utf8"),l=t("../crc32"),c=t("../signature");function u(t,e,n,r){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=e,this.zipPlatform=n,this.encodeFileName=r,this.streamFiles=t,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(u,a),u.prototype.push=function(t){var e=t.meta.percent||0,n=this.entriesCount,r=this._sources.length;this.accumulate?this.contentBuffer.push(t):(this.bytesWritten+=t.data.length,a.prototype.push.call(this,{data:t.data,meta:{currentFile:this.currentFile,percent:n?(e+100*(n-r-1))/n:100}}))},u.prototype.openedSource=function(t){this.currentSourceOffset=this.bytesWritten,this.currentFile=t.file.name;var e=this.streamFiles&&!t.file.dir;if(e){var n=i(t,e,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},u.prototype.closedSource=function(t){this.accumulate=!1;var e=this.streamFiles&&!t.file.dir,n=i(t,e,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),e)this.push({data:function(t){return c.DATA_DESCRIPTOR+r(t.crc32,4)+r(t.compressedSize,4)+r(t.uncompressedSize,4)}(t),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},u.prototype.flush=function(){for(var t=this.bytesWritten,e=0;e<this.dirRecords.length;e++)this.push({data:this.dirRecords[e],meta:{percent:100}});var n=this.bytesWritten-t,i=function(t,e,n,i,a){var s=o.transformTo("string",a(i));return c.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(t,2)+r(t,2)+r(e,4)+r(n,4)+r(s.length,2)+s}(this.dirRecords.length,n,t,this.zipComment,this.encodeFileName);this.push({data:i,meta:{percent:100}})},u.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},u.prototype.registerPrevious=function(t){this._sources.push(t);var e=this;return t.on("data",(function(t){e.processChunk(t)})),t.on("end",(function(){e.closedSource(e.previous.streamInfo),e._sources.length?e.prepareNextSource():e.end()})),t.on("error",(function(t){e.error(t)})),this},u.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},u.prototype.error=function(t){var e=this._sources;if(!a.prototype.error.call(this,t))return!1;for(var n=0;n<e.length;n++)try{e[n].error(t)}catch(t){}return!0},u.prototype.lock=function(){a.prototype.lock.call(this);for(var t=this._sources,e=0;e<t.length;e++)t[e].lock()},e.exports=u},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,e,n){"use strict";var r=t("../compressions"),i=t("./ZipFileWorker");n.generateWorker=function(t,e,n){var o=new i(e.streamFiles,n,e.platform,e.encodeFileName),a=0;try{t.forEach((function(t,n){a++;var i=function(t,e){var n=t||e,i=r[n];if(!i)throw new Error(n+" is not a valid compression method !");return i}(n.options.compression,e.compression),s=n.options.compressionOptions||e.compressionOptions||{},l=n.dir,c=n.date;n._compressWorker(i,s).withStreamInfo("file",{name:t,dir:l,date:c,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(o)})),o.entriesCount=a}catch(t){o.error(t)}return o}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,e,n){"use strict";function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var t=new r;for(var e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t}}(r.prototype=t("./object")).loadAsync=t("./load"),r.support=t("./support"),r.defaults=t("./defaults"),r.version="3.7.1",r.loadAsync=function(t,e){return(new r).loadAsync(t,e)},r.external=t("./external"),e.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,e,n){"use strict";var r=t("./utils"),i=t("./external"),o=t("./utf8"),a=t("./zipEntries"),s=t("./stream/Crc32Probe"),l=t("./nodejsUtils");function c(t){return new i.Promise((function(e,n){var r=t.decompressed.getContentWorker().pipe(new s);r.on("error",(function(t){n(t)})).on("end",(function(){r.streamInfo.crc32!==t.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):e()})).resume()}))}e.exports=function(t,e){var n=this;return e=r.extend(e||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),l.isNode&&l.isStream(t)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",t,!0,e.optimizedBinaryString,e.base64).then((function(t){var n=new a(e);return n.load(t),n})).then((function(t){var n=[i.Promise.resolve(t)],r=t.files;if(e.checkCRC32)for(var o=0;o<r.length;o++)n.push(c(r[o]));return i.Promise.all(n)})).then((function(t){for(var r=t.shift(),i=r.files,o=0;o<i.length;o++){var a=i[o];n.file(a.fileNameStr,a.decompressed,{binary:!0,optimizedBinaryString:!0,date:a.date,dir:a.dir,comment:a.fileCommentStr.length?a.fileCommentStr:null,unixPermissions:a.unixPermissions,dosPermissions:a.dosPermissions,createFolders:e.createFolders})}return r.zipComment.length&&(n.comment=r.zipComment),n}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,e,n){"use strict";var r=t("../utils"),i=t("../stream/GenericWorker");function o(t,e){i.call(this,"Nodejs stream input adapter for "+t),this._upstreamEnded=!1,this._bindStream(e)}r.inherits(o,i),o.prototype._bindStream=function(t){var e=this;(this._stream=t).pause(),t.on("data",(function(t){e.push({data:t,meta:{percent:0}})})).on("error",(function(t){e.isPaused?this.generatedError=t:e.error(t)})).on("end",(function(){e.isPaused?e._upstreamEnded=!0:e.end()}))},o.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},e.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,e,n){"use strict";var r=t("readable-stream").Readable;function i(t,e,n){r.call(this,e),this._helper=t;var i=this;t.on("data",(function(t,e){i.push(t)||i._helper.pause(),n&&n(e)})).on("error",(function(t){i.emit("error",t)})).on("end",(function(){i.push(null)}))}t("../utils").inherits(i,r),i.prototype._read=function(){this._helper.resume()},e.exports=i},{"../utils":32,"readable-stream":16}],14:[function(t,e,n){"use strict";e.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(t,e){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(t,e);if("number"==typeof t)throw new Error('The "data" argument must not be a number');return new Buffer(t,e)},allocBuffer:function(t){if(Buffer.alloc)return Buffer.alloc(t);var e=new Buffer(t);return e.fill(0),e},isBuffer:function(t){return Buffer.isBuffer(t)},isStream:function(t){return t&&"function"==typeof t.on&&"function"==typeof t.pause&&"function"==typeof t.resume}}},{}],15:[function(t,e,n){"use strict";function r(t,e,n){var r,i=o.getTypeOf(e),s=o.extend(n||{},l);s.date=s.date||new Date,null!==s.compression&&(s.compression=s.compression.toUpperCase()),"string"==typeof s.unixPermissions&&(s.unixPermissions=parseInt(s.unixPermissions,8)),s.unixPermissions&&16384&s.unixPermissions&&(s.dir=!0),s.dosPermissions&&16&s.dosPermissions&&(s.dir=!0),s.dir&&(t=_(t)),s.createFolders&&(r=m(t))&&f.call(this,r,!0);var d="string"===i&&!1===s.binary&&!1===s.base64;n&&void 0!==n.binary||(s.binary=!d),(e instanceof c&&0===e.uncompressedSize||s.dir||!e||0===e.length)&&(s.base64=!1,s.binary=!0,e="",s.compression="STORE",i="string");var g;g=e instanceof c||e instanceof a?e:h.isNode&&h.isStream(e)?new p(t,e):o.prepareContent(t,e,s.binary,s.optimizedBinaryString,s.base64);var b=new u(t,g,s);this.files[t]=b}var i=t("./utf8"),o=t("./utils"),a=t("./stream/GenericWorker"),s=t("./stream/StreamHelper"),l=t("./defaults"),c=t("./compressedObject"),u=t("./zipObject"),d=t("./generate"),h=t("./nodejsUtils"),p=t("./nodejs/NodejsStreamInputAdapter"),m=function(t){"/"===t.slice(-1)&&(t=t.substring(0,t.length-1));var e=t.lastIndexOf("/");return 0<e?t.substring(0,e):""},_=function(t){return"/"!==t.slice(-1)&&(t+="/"),t},f=function(t,e){return e=void 0!==e?e:l.createFolders,t=_(t),this.files[t]||r.call(this,t,null,{dir:!0,createFolders:e}),this.files[t]};function g(t){return"[object RegExp]"===Object.prototype.toString.call(t)}var b={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(t){var e,n,r;for(e in this.files)r=this.files[e],(n=e.slice(this.root.length,e.length))&&e.slice(0,this.root.length)===this.root&&t(n,r)},filter:function(t){var e=[];return this.forEach((function(n,r){t(n,r)&&e.push(r)})),e},file:function(t,e,n){if(1!==arguments.length)return t=this.root+t,r.call(this,t,e,n),this;if(g(t)){var i=t;return this.filter((function(t,e){return!e.dir&&i.test(t)}))}var o=this.files[this.root+t];return o&&!o.dir?o:null},folder:function(t){if(!t)return this;if(g(t))return this.filter((function(e,n){return n.dir&&t.test(e)}));var e=this.root+t,n=f.call(this,e),r=this.clone();return r.root=n.name,r},remove:function(t){t=this.root+t;var e=this.files[t];if(e||("/"!==t.slice(-1)&&(t+="/"),e=this.files[t]),e&&!e.dir)delete this.files[t];else for(var n=this.filter((function(e,n){return n.name.slice(0,t.length)===t})),r=0;r<n.length;r++)delete this.files[n[r].name];return this},generate:function(t){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(t){var e,n={};try{if((n=o.extend(t||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),"binarystring"===n.type&&(n.type="string"),!n.type)throw new Error("No output type specified.");o.checkSupport(n.type),"darwin"!==n.platform&&"freebsd"!==n.platform&&"linux"!==n.platform&&"sunos"!==n.platform||(n.platform="UNIX"),"win32"===n.platform&&(n.platform="DOS");var r=n.comment||this.comment||"";e=d.generateWorker(this,n,r)}catch(t){(e=new a("error")).error(t)}return new s(e,n.type||"string",n.mimeType)},generateAsync:function(t,e){return this.generateInternalStream(t).accumulate(e)},generateNodeStream:function(t,e){return(t=t||{}).type||(t.type="nodebuffer"),this.generateInternalStream(t).toNodejsStream(e)}};e.exports=b},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,e,n){e.exports=t("stream")},{stream:void 0}],17:[function(t,e,n){"use strict";var r=t("./DataReader");function i(t){r.call(this,t);for(var e=0;e<this.data.length;e++)t[e]=255&t[e]}t("../utils").inherits(i,r),i.prototype.byteAt=function(t){return this.data[this.zero+t]},i.prototype.lastIndexOfSignature=function(t){for(var e=t.charCodeAt(0),n=t.charCodeAt(1),r=t.charCodeAt(2),i=t.charCodeAt(3),o=this.length-4;0<=o;--o)if(this.data[o]===e&&this.data[o+1]===n&&this.data[o+2]===r&&this.data[o+3]===i)return o-this.zero;return-1},i.prototype.readAndCheckSignature=function(t){var e=t.charCodeAt(0),n=t.charCodeAt(1),r=t.charCodeAt(2),i=t.charCodeAt(3),o=this.readData(4);return e===o[0]&&n===o[1]&&r===o[2]&&i===o[3]},i.prototype.readData=function(t){if(this.checkOffset(t),0===t)return[];var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=i},{"../utils":32,"./DataReader":18}],18:[function(t,e,n){"use strict";var r=t("../utils");function i(t){this.data=t,this.length=t.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(t){},readInt:function(t){var e,n=0;for(this.checkOffset(t),e=this.index+t-1;e>=this.index;e--)n=(n<<8)+this.byteAt(e);return this.index+=t,n},readString:function(t){return r.transformTo("string",this.readData(t))},readData:function(t){},lastIndexOfSignature:function(t){},readAndCheckSignature:function(t){},readDate:function(){var t=this.readInt(4);return new Date(Date.UTC(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1))}},e.exports=i},{"../utils":32}],19:[function(t,e,n){"use strict";var r=t("./Uint8ArrayReader");function i(t){r.call(this,t)}t("../utils").inherits(i,r),i.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,e,n){"use strict";var r=t("./DataReader");function i(t){r.call(this,t)}t("../utils").inherits(i,r),i.prototype.byteAt=function(t){return this.data.charCodeAt(this.zero+t)},i.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)-this.zero},i.prototype.readAndCheckSignature=function(t){return t===this.readData(4)},i.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=i},{"../utils":32,"./DataReader":18}],21:[function(t,e,n){"use strict";var r=t("./ArrayReader");function i(t){r.call(this,t)}t("../utils").inherits(i,r),i.prototype.readData=function(t){if(this.checkOffset(t),0===t)return new Uint8Array(0);var e=this.data.subarray(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(t,e,n){"use strict";var r=t("../utils"),i=t("../support"),o=t("./ArrayReader"),a=t("./StringReader"),s=t("./NodeBufferReader"),l=t("./Uint8ArrayReader");e.exports=function(t){var e=r.getTypeOf(t);return r.checkSupport(e),"string"!==e||i.uint8array?"nodebuffer"===e?new s(t):i.uint8array?new l(r.transformTo("uint8array",t)):new o(r.transformTo("array",t)):new a(t)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,e,n){"use strict";n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\b"},{}],24:[function(t,e,n){"use strict";var r=t("./GenericWorker"),i=t("../utils");function o(t){r.call(this,"ConvertWorker to "+t),this.destType=t}i.inherits(o,r),o.prototype.processChunk=function(t){this.push({data:i.transformTo(this.destType,t.data),meta:t.meta})},e.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(t,e,n){"use strict";var r=t("./GenericWorker"),i=t("../crc32");function o(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(o,r),o.prototype.processChunk=function(t){this.streamInfo.crc32=i(t.data,this.streamInfo.crc32||0),this.push(t)},e.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,e,n){"use strict";var r=t("../utils"),i=t("./GenericWorker");function o(t){i.call(this,"DataLengthProbe for "+t),this.propName=t,this.withStreamInfo(t,0)}r.inherits(o,i),o.prototype.processChunk=function(t){if(t){var e=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=e+t.data.length}i.prototype.processChunk.call(this,t)},e.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(t,e,n){"use strict";var r=t("../utils"),i=t("./GenericWorker");function o(t){i.call(this,"DataWorker");var e=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,t.then((function(t){e.dataIsReady=!0,e.data=t,e.max=t&&t.length||0,e.type=r.getTypeOf(t),e.isPaused||e._tickAndRepeat()}),(function(t){e.error(t)}))}r.inherits(o,i),o.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var t=null,e=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":t=this.data.substring(this.index,e);break;case"uint8array":t=this.data.subarray(this.index,e);break;case"array":case"nodebuffer":t=this.data.slice(this.index,e)}return this.index=e,this.push({data:t,meta:{percent:this.max?this.index/this.max*100:0}})},e.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(t,e,n){"use strict";function r(t){this.name=t||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(t){this.emit("data",t)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(t){this.emit("error",t)}return!0},error:function(t){return!this.isFinished&&(this.isPaused?this.generatedError=t:(this.isFinished=!0,this.emit("error",t),this.previous&&this.previous.error(t),this.cleanUp()),!0)},on:function(t,e){return this._listeners[t].push(e),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(t,e){if(this._listeners[t])for(var n=0;n<this._listeners[t].length;n++)this._listeners[t][n].call(this,e)},pipe:function(t){return t.registerPrevious(this)},registerPrevious:function(t){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=t.streamInfo,this.mergeStreamInfo(),this.previous=t;var e=this;return t.on("data",(function(t){e.processChunk(t)})),t.on("end",(function(){e.end()})),t.on("error",(function(t){e.error(t)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var t=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),t=!0),this.previous&&this.previous.resume(),!t},flush:function(){},processChunk:function(t){this.push(t)},withStreamInfo:function(t,e){return this.extraStreamInfo[t]=e,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var t in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(t)&&(this.streamInfo[t]=this.extraStreamInfo[t])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var t="Worker "+this.name;return this.previous?this.previous+" -> "+t:t}},e.exports=r},{}],29:[function(t,e,n){"use strict";var r=t("../utils"),i=t("./ConvertWorker"),o=t("./GenericWorker"),a=t("../base64"),s=t("../support"),l=t("../external"),c=null;if(s.nodestream)try{c=t("../nodejs/NodejsStreamOutputAdapter")}catch(t){}function u(t,e,n){var a=e;switch(e){case"blob":case"arraybuffer":a="uint8array";break;case"base64":a="string"}try{this._internalType=a,this._outputType=e,this._mimeType=n,r.checkSupport(a),this._worker=t.pipe(new i(a)),t.lock()}catch(t){this._worker=new o("error"),this._worker.error(t)}}u.prototype={accumulate:function(t){return function(t,e){return new l.Promise((function(n,i){var o=[],s=t._internalType,l=t._outputType,c=t._mimeType;t.on("data",(function(t,n){o.push(t),e&&e(n)})).on("error",(function(t){o=[],i(t)})).on("end",(function(){try{var t=function(t,e,n){switch(t){case"blob":return r.newBlob(r.transformTo("arraybuffer",e),n);case"base64":return a.encode(e);default:return r.transformTo(t,e)}}(l,function(t,e){var n,r=0,i=null,o=0;for(n=0;n<e.length;n++)o+=e[n].length;switch(t){case"string":return e.join("");case"array":return Array.prototype.concat.apply([],e);case"uint8array":for(i=new Uint8Array(o),n=0;n<e.length;n++)i.set(e[n],r),r+=e[n].length;return i;case"nodebuffer":return Buffer.concat(e);default:throw new Error("concat : unsupported type '"+t+"'")}}(s,o),c);n(t)}catch(t){i(t)}o=[]})).resume()}))}(this,t)},on:function(t,e){var n=this;return"data"===t?this._worker.on(t,(function(t){e.call(n,t.data,t.meta)})):this._worker.on(t,(function(){r.delay(e,arguments,n)})),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(t){if(r.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new c(this,{objectMode:"nodebuffer"!==this._outputType},t)}},e.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,e,n){"use strict";if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer="undefined"!=typeof Buffer,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var r=new ArrayBuffer(0);try{n.blob=0===new Blob([r],{type:"application/zip"}).size}catch(t){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(r),n.blob=0===i.getBlob("application/zip").size}catch(t){n.blob=!1}}}try{n.nodestream=!!t("readable-stream").Readable}catch(t){n.nodestream=!1}},{"readable-stream":16}],31:[function(t,e,n){"use strict";for(var r=t("./utils"),i=t("./support"),o=t("./nodejsUtils"),a=t("./stream/GenericWorker"),s=new Array(256),l=0;l<256;l++)s[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function c(){a.call(this,"utf-8 decode"),this.leftOver=null}function u(){a.call(this,"utf-8 encode")}s[254]=s[254]=1,n.utf8encode=function(t){return i.nodebuffer?o.newBufferFrom(t,"utf-8"):function(t){var e,n,r,o,a,s=t.length,l=0;for(o=0;o<s;o++)55296==(64512&(n=t.charCodeAt(o)))&&o+1<s&&56320==(64512&(r=t.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(r-56320),o++),l+=n<128?1:n<2048?2:n<65536?3:4;for(e=i.uint8array?new Uint8Array(l):new Array(l),o=a=0;a<l;o++)55296==(64512&(n=t.charCodeAt(o)))&&o+1<s&&56320==(64512&(r=t.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(r-56320),o++),n<128?e[a++]=n:(n<2048?e[a++]=192|n>>>6:(n<65536?e[a++]=224|n>>>12:(e[a++]=240|n>>>18,e[a++]=128|n>>>12&63),e[a++]=128|n>>>6&63),e[a++]=128|63&n);return e}(t)},n.utf8decode=function(t){return i.nodebuffer?r.transformTo("nodebuffer",t).toString("utf-8"):function(t){var e,n,i,o,a=t.length,l=new Array(2*a);for(e=n=0;e<a;)if((i=t[e++])<128)l[n++]=i;else if(4<(o=s[i]))l[n++]=65533,e+=o-1;else{for(i&=2===o?31:3===o?15:7;1<o&&e<a;)i=i<<6|63&t[e++],o--;1<o?l[n++]=65533:i<65536?l[n++]=i:(i-=65536,l[n++]=55296|i>>10&1023,l[n++]=56320|1023&i)}return l.length!==n&&(l.subarray?l=l.subarray(0,n):l.length=n),r.applyFromCharCode(l)}(t=r.transformTo(i.uint8array?"uint8array":"array",t))},r.inherits(c,a),c.prototype.processChunk=function(t){var e=r.transformTo(i.uint8array?"uint8array":"array",t.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var o=e;(e=new Uint8Array(o.length+this.leftOver.length)).set(this.leftOver,0),e.set(o,this.leftOver.length)}else e=this.leftOver.concat(e);this.leftOver=null}var a=function(t,e){var n;for((e=e||t.length)>t.length&&(e=t.length),n=e-1;0<=n&&128==(192&t[n]);)n--;return n<0||0===n?e:n+s[t[n]]>e?n:e}(e),l=e;a!==e.length&&(i.uint8array?(l=e.subarray(0,a),this.leftOver=e.subarray(a,e.length)):(l=e.slice(0,a),this.leftOver=e.slice(a,e.length))),this.push({data:n.utf8decode(l),meta:t.meta})},c.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=c,r.inherits(u,a),u.prototype.processChunk=function(t){this.push({data:n.utf8encode(t.data),meta:t.meta})},n.Utf8EncodeWorker=u},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,e,n){"use strict";var r=t("./support"),i=t("./base64"),o=t("./nodejsUtils"),a=t("set-immediate-shim"),s=t("./external");function l(t){return t}function c(t,e){for(var n=0;n<t.length;++n)e[n]=255&t.charCodeAt(n);return e}n.newBlob=function(t,e){n.checkSupport("blob");try{return new Blob([t],{type:e})}catch(n){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return r.append(t),r.getBlob(e)}catch(t){throw new Error("Bug : can't construct the Blob.")}}};var u={stringifyByChunk:function(t,e,n){var r=[],i=0,o=t.length;if(o<=n)return String.fromCharCode.apply(null,t);for(;i<o;)"array"===e||"nodebuffer"===e?r.push(String.fromCharCode.apply(null,t.slice(i,Math.min(i+n,o)))):r.push(String.fromCharCode.apply(null,t.subarray(i,Math.min(i+n,o)))),i+=n;return r.join("")},stringifyByChar:function(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(t){return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&1===String.fromCharCode.apply(null,o.allocBuffer(1)).length}catch(t){return!1}}()}};function d(t){var e=65536,r=n.getTypeOf(t),i=!0;if("uint8array"===r?i=u.applyCanBeUsed.uint8array:"nodebuffer"===r&&(i=u.applyCanBeUsed.nodebuffer),i)for(;1<e;)try{return u.stringifyByChunk(t,r,e)}catch(t){e=Math.floor(e/2)}return u.stringifyByChar(t)}function h(t,e){for(var n=0;n<t.length;n++)e[n]=t[n];return e}n.applyFromCharCode=d;var p={};p.string={string:l,array:function(t){return c(t,new Array(t.length))},arraybuffer:function(t){return p.string.uint8array(t).buffer},uint8array:function(t){return c(t,new Uint8Array(t.length))},nodebuffer:function(t){return c(t,o.allocBuffer(t.length))}},p.array={string:d,array:l,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return o.newBufferFrom(t)}},p.arraybuffer={string:function(t){return d(new Uint8Array(t))},array:function(t){return h(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:l,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return o.newBufferFrom(new Uint8Array(t))}},p.uint8array={string:d,array:function(t){return h(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:l,nodebuffer:function(t){return o.newBufferFrom(t)}},p.nodebuffer={string:d,array:function(t){return h(t,new Array(t.length))},arraybuffer:function(t){return p.nodebuffer.uint8array(t).buffer},uint8array:function(t){return h(t,new Uint8Array(t.length))},nodebuffer:l},n.transformTo=function(t,e){if(e=e||"",!t)return e;n.checkSupport(t);var r=n.getTypeOf(e);return p[r][t](e)},n.getTypeOf=function(t){return"string"==typeof t?"string":"[object Array]"===Object.prototype.toString.call(t)?"array":r.nodebuffer&&o.isBuffer(t)?"nodebuffer":r.uint8array&&t instanceof Uint8Array?"uint8array":r.arraybuffer&&t instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(t){if(!r[t.toLowerCase()])throw new Error(t+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(t){var e,n,r="";for(n=0;n<(t||"").length;n++)r+="\\x"+((e=t.charCodeAt(n))<16?"0":"")+e.toString(16).toUpperCase();return r},n.delay=function(t,e,n){a((function(){t.apply(n||null,e||[])}))},n.inherits=function(t,e){function n(){}n.prototype=e.prototype,t.prototype=new n},n.extend=function(){var t,e,n={};for(t=0;t<arguments.length;t++)for(e in arguments[t])arguments[t].hasOwnProperty(e)&&void 0===n[e]&&(n[e]=arguments[t][e]);return n},n.prepareContent=function(t,e,o,a,l){return s.Promise.resolve(e).then((function(t){return r.blob&&(t instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(t)))&&"undefined"!=typeof FileReader?new s.Promise((function(e,n){var r=new FileReader;r.onload=function(t){e(t.target.result)},r.onerror=function(t){n(t.target.error)},r.readAsArrayBuffer(t)})):t})).then((function(e){var u=n.getTypeOf(e);return u?("arraybuffer"===u?e=n.transformTo("uint8array",e):"string"===u&&(l?e=i.decode(e):o&&!0!==a&&(e=function(t){return c(t,r.uint8array?new Uint8Array(t.length):new Array(t.length))}(e))),e):s.Promise.reject(new Error("Can't read the data of '"+t+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"set-immediate-shim":54}],33:[function(t,e,n){"use strict";var r=t("./reader/readerFor"),i=t("./utils"),o=t("./signature"),a=t("./zipEntry"),s=(t("./utf8"),t("./support"));function l(t){this.files=[],this.loadOptions=t}l.prototype={checkSignature:function(t){if(!this.reader.readAndCheckSignature(t)){this.reader.index-=4;var e=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(e)+", expected "+i.pretty(t)+")")}},isSignature:function(t,e){var n=this.reader.index;this.reader.setIndex(t);var r=this.reader.readString(4)===e;return this.reader.setIndex(n),r},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var t=this.reader.readData(this.zipCommentLength),e=s.uint8array?"uint8array":"array",n=i.transformTo(e,t);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t,e,n,r=this.zip64EndOfCentralSize-44;0<r;)t=this.reader.readInt(2),e=this.reader.readInt(4),n=this.reader.readData(e),this.zip64ExtensibleData[t]={id:t,length:e,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,e;for(t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8(),e.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(t=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(t);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(t<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(t);var e=t;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(t=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(t),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var r=e-n;if(0<r)this.isSignature(e,o.CENTRAL_FILE_HEADER)||(this.reader.zero=r);else if(r<0)throw new Error("Corrupted zip: missing "+Math.abs(r)+" bytes.")},prepareReader:function(t){this.reader=r(t)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(t,e,n){"use strict";var r=t("./reader/readerFor"),i=t("./utils"),o=t("./compressedObject"),a=t("./crc32"),s=t("./utf8"),l=t("./compressions"),c=t("./support");function u(t,e){this.options=t,this.loadOptions=e}u.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(t){var e,n;if(t.skip(22),this.fileNameLength=t.readInt(2),n=t.readInt(2),this.fileName=t.readData(this.fileNameLength),t.skip(n),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(e=function(t){for(var e in l)if(l.hasOwnProperty(e)&&l[e].magic===t)return l[e];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,e,t.readData(this.compressedSize))},readCentralPart:function(t){this.versionMadeBy=t.readInt(2),t.skip(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4);var e=t.readInt(2);if(this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");t.skip(e),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==t&&(this.dosPermissions=63&this.externalFileAttributes),3==t&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(t){if(this.extraFields[1]){var e=r(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(t){var e,n,r,i=t.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});t.index+4<i;)e=t.readInt(2),n=t.readInt(2),r=t.readData(n),this.extraFields[e]={id:e,length:n,value:r};t.setIndex(i)},handleUTF8:function(){var t=c.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var e=this.findExtraFieldUnicodePath();if(null!==e)this.fileNameStr=e;else{var n=i.transformTo(t,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var r=this.findExtraFieldUnicodeComment();if(null!==r)this.fileCommentStr=r;else{var o=i.transformTo(t,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(o)}}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var e=r(t.value);return 1!==e.readInt(1)||a(this.fileName)!==e.readInt(4)?null:s.utf8decode(e.readData(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var e=r(t.value);return 1!==e.readInt(1)||a(this.fileComment)!==e.readInt(4)?null:s.utf8decode(e.readData(t.length-5))}return null}},e.exports=u},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,e,n){"use strict";function r(t,e,n){this.name=t,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=e,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}}var i=t("./stream/StreamHelper"),o=t("./stream/DataWorker"),a=t("./utf8"),s=t("./compressedObject"),l=t("./stream/GenericWorker");r.prototype={internalStream:function(t){var e=null,n="string";try{if(!t)throw new Error("No output type specified.");var r="string"===(n=t.toLowerCase())||"text"===n;"binarystring"!==n&&"text"!==n||(n="string"),e=this._decompressWorker();var o=!this._dataBinary;o&&!r&&(e=e.pipe(new a.Utf8EncodeWorker)),!o&&r&&(e=e.pipe(new a.Utf8DecodeWorker))}catch(t){(e=new l("error")).error(t)}return new i(e,n,"")},async:function(t,e){return this.internalStream(t).accumulate(e)},nodeStream:function(t,e){return this.internalStream(t||"nodebuffer").toNodejsStream(e)},_compressWorker:function(t,e){if(this._data instanceof s&&this._data.compression.magic===t.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new a.Utf8EncodeWorker)),s.createWorkerFrom(n,t,e)},_decompressWorker:function(){return this._data instanceof s?this._data.getContentWorker():this._data instanceof l?this._data:new o(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],u=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<c.length;d++)r.prototype[c[d]]=u;e.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,e,r){(function(t){"use strict";var n,r,i=t.MutationObserver||t.WebKitMutationObserver;if(i){var o=0,a=new i(u),s=t.document.createTextNode("");a.observe(s,{characterData:!0}),n=function(){s.data=o=++o%2}}else if(t.setImmediate||void 0===t.MessageChannel)n="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){u(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(u,0)};else{var l=new t.MessageChannel;l.port1.onmessage=u,n=function(){l.port2.postMessage(0)}}var c=[];function u(){var t,e;r=!0;for(var n=c.length;n;){for(e=c,c=[],t=-1;++t<n;)e[t]();n=c.length}r=!1}e.exports=function(t){1!==c.push(t)||r||n()}}).call(this,void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(t,e,n){"use strict";var r=t("immediate");function i(){}var o={},a=["REJECTED"],s=["FULFILLED"],l=["PENDING"];function c(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,t!==i&&p(this,t)}function u(t,e,n){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function d(t,e,n){r((function(){var r;try{r=e(n)}catch(r){return o.reject(t,r)}r===t?o.reject(t,new TypeError("Cannot resolve promise with itself")):o.resolve(t,r)}))}function h(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function p(t,e){var n=!1;function r(e){n||(n=!0,o.reject(t,e))}function i(e){n||(n=!0,o.resolve(t,e))}var a=m((function(){e(i,r)}));"error"===a.status&&r(a.value)}function m(t,e){var n={};try{n.value=t(e),n.status="success"}catch(t){n.status="error",n.value=t}return n}(e.exports=c).prototype.finally=function(t){if("function"!=typeof t)return this;var e=this.constructor;return this.then((function(n){return e.resolve(t()).then((function(){return n}))}),(function(n){return e.resolve(t()).then((function(){throw n}))}))},c.prototype.catch=function(t){return this.then(null,t)},c.prototype.then=function(t,e){if("function"!=typeof t&&this.state===s||"function"!=typeof e&&this.state===a)return this;var n=new this.constructor(i);return this.state!==l?d(n,this.state===s?t:e,this.outcome):this.queue.push(new u(n,t,e)),n},u.prototype.callFulfilled=function(t){o.resolve(this.promise,t)},u.prototype.otherCallFulfilled=function(t){d(this.promise,this.onFulfilled,t)},u.prototype.callRejected=function(t){o.reject(this.promise,t)},u.prototype.otherCallRejected=function(t){d(this.promise,this.onRejected,t)},o.resolve=function(t,e){var n=m(h,e);if("error"===n.status)return o.reject(t,n.value);var r=n.value;if(r)p(t,r);else{t.state=s,t.outcome=e;for(var i=-1,a=t.queue.length;++i<a;)t.queue[i].callFulfilled(e)}return t},o.reject=function(t,e){t.state=a,t.outcome=e;for(var n=-1,r=t.queue.length;++n<r;)t.queue[n].callRejected(e);return t},c.resolve=function(t){return t instanceof this?t:o.resolve(new this(i),t)},c.reject=function(t){var e=new this(i);return o.reject(e,t)},c.all=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return this.resolve([]);for(var a=new Array(n),s=0,l=-1,c=new this(i);++l<n;)u(t[l],l);return c;function u(t,i){e.resolve(t).then((function(t){a[i]=t,++s!==n||r||(r=!0,o.resolve(c,a))}),(function(t){r||(r=!0,o.reject(c,t))}))}},c.race=function(t){if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var e=t.length,n=!1;if(!e)return this.resolve([]);for(var r,a=-1,s=new this(i);++a<e;)r=t[a],this.resolve(r).then((function(t){n||(n=!0,o.resolve(s,t))}),(function(t){n||(n=!0,o.reject(s,t))}));return s}},{immediate:36}],38:[function(t,e,n){"use strict";var r={};(0,t("./lib/utils/common").assign)(r,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),e.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,e,n){"use strict";var r=t("./zlib/deflate"),i=t("./utils/common"),o=t("./utils/strings"),a=t("./zlib/messages"),s=t("./zlib/zstream"),l=Object.prototype.toString;function c(t){if(!(this instanceof c))return new c(t);this.options=i.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},t||{});var e=this.options;e.raw&&0<e.windowBits?e.windowBits=-e.windowBits:e.gzip&&0<e.windowBits&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var n=r.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(0!==n)throw new Error(a[n]);if(e.header&&r.deflateSetHeader(this.strm,e.header),e.dictionary){var u;if(u="string"==typeof e.dictionary?o.string2buf(e.dictionary):"[object ArrayBuffer]"===l.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,0!==(n=r.deflateSetDictionary(this.strm,u)))throw new Error(a[n]);this._dict_set=!0}}function u(t,e){var n=new c(e);if(n.push(t,!0),n.err)throw n.msg||a[n.err];return n.result}c.prototype.push=function(t,e){var n,a,s=this.strm,c=this.options.chunkSize;if(this.ended)return!1;a=e===~~e?e:!0===e?4:0,"string"==typeof t?s.input=o.string2buf(t):"[object ArrayBuffer]"===l.call(t)?s.input=new Uint8Array(t):s.input=t,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new i.Buf8(c),s.next_out=0,s.avail_out=c),1!==(n=r.deflate(s,a))&&0!==n)return this.onEnd(n),!(this.ended=!0);0!==s.avail_out&&(0!==s.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(o.buf2binstring(i.shrinkBuf(s.output,s.next_out))):this.onData(i.shrinkBuf(s.output,s.next_out)))}while((0<s.avail_in||0===s.avail_out)&&1!==n);return 4===a?(n=r.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n):2!==a||(this.onEnd(0),!(s.avail_out=0))},c.prototype.onData=function(t){this.chunks.push(t)},c.prototype.onEnd=function(t){0===t&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},n.Deflate=c,n.deflate=u,n.deflateRaw=function(t,e){return(e=e||{}).raw=!0,u(t,e)},n.gzip=function(t,e){return(e=e||{}).gzip=!0,u(t,e)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,e,n){"use strict";var r=t("./zlib/inflate"),i=t("./utils/common"),o=t("./utils/strings"),a=t("./zlib/constants"),s=t("./zlib/messages"),l=t("./zlib/zstream"),c=t("./zlib/gzheader"),u=Object.prototype.toString;function d(t){if(!(this instanceof d))return new d(t);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&0<=e.windowBits&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(0<=e.windowBits&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),15<e.windowBits&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,e.windowBits);if(n!==a.Z_OK)throw new Error(s[n]);this.header=new c,r.inflateGetHeader(this.strm,this.header)}function h(t,e){var n=new d(e);if(n.push(t,!0),n.err)throw n.msg||s[n.err];return n.result}d.prototype.push=function(t,e){var n,s,l,c,d,h,p=this.strm,m=this.options.chunkSize,_=this.options.dictionary,f=!1;if(this.ended)return!1;s=e===~~e?e:!0===e?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof t?p.input=o.binstring2buf(t):"[object ArrayBuffer]"===u.call(t)?p.input=new Uint8Array(t):p.input=t,p.next_in=0,p.avail_in=p.input.length;do{if(0===p.avail_out&&(p.output=new i.Buf8(m),p.next_out=0,p.avail_out=m),(n=r.inflate(p,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&_&&(h="string"==typeof _?o.string2buf(_):"[object ArrayBuffer]"===u.call(_)?new Uint8Array(_):_,n=r.inflateSetDictionary(this.strm,h)),n===a.Z_BUF_ERROR&&!0===f&&(n=a.Z_OK,f=!1),n!==a.Z_STREAM_END&&n!==a.Z_OK)return this.onEnd(n),!(this.ended=!0);p.next_out&&(0!==p.avail_out&&n!==a.Z_STREAM_END&&(0!==p.avail_in||s!==a.Z_FINISH&&s!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(l=o.utf8border(p.output,p.next_out),c=p.next_out-l,d=o.buf2string(p.output,l),p.next_out=c,p.avail_out=m-c,c&&i.arraySet(p.output,p.output,l,c,0),this.onData(d)):this.onData(i.shrinkBuf(p.output,p.next_out)))),0===p.avail_in&&0===p.avail_out&&(f=!0)}while((0<p.avail_in||0===p.avail_out)&&n!==a.Z_STREAM_END);return n===a.Z_STREAM_END&&(s=a.Z_FINISH),s===a.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===a.Z_OK):s!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),!(p.avail_out=0))},d.prototype.onData=function(t){this.chunks.push(t)},d.prototype.onEnd=function(t){t===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},n.Inflate=d,n.inflate=h,n.inflateRaw=function(t,e){return(e=e||{}).raw=!0,h(t,e)},n.ungzip=h},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,e,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var n=e.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])}}return t},n.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var i={arraySet:function(t,e,n,r,i){if(e.subarray&&t.subarray)t.set(e.subarray(n,n+r),i);else for(var o=0;o<r;o++)t[i+o]=e[n+o]},flattenChunks:function(t){var e,n,r,i,o,a;for(e=r=0,n=t.length;e<n;e++)r+=t[e].length;for(a=new Uint8Array(r),e=i=0,n=t.length;e<n;e++)o=t[e],a.set(o,i),i+=o.length;return a}},o={arraySet:function(t,e,n,r,i){for(var o=0;o<r;o++)t[i+o]=e[n+o]},flattenChunks:function(t){return[].concat.apply([],t)}};n.setTyped=function(t){t?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,i)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,o))},n.setTyped(r)},{}],42:[function(t,e,n){"use strict";var r=t("./common"),i=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(t){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){o=!1}for(var a=new r.Buf8(256),s=0;s<256;s++)a[s]=252<=s?6:248<=s?5:240<=s?4:224<=s?3:192<=s?2:1;function l(t,e){if(e<65537&&(t.subarray&&o||!t.subarray&&i))return String.fromCharCode.apply(null,r.shrinkBuf(t,e));for(var n="",a=0;a<e;a++)n+=String.fromCharCode(t[a]);return n}a[254]=a[254]=1,n.string2buf=function(t){var e,n,i,o,a,s=t.length,l=0;for(o=0;o<s;o++)55296==(64512&(n=t.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=t.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),l+=n<128?1:n<2048?2:n<65536?3:4;for(e=new r.Buf8(l),o=a=0;a<l;o++)55296==(64512&(n=t.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=t.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),n<128?e[a++]=n:(n<2048?e[a++]=192|n>>>6:(n<65536?e[a++]=224|n>>>12:(e[a++]=240|n>>>18,e[a++]=128|n>>>12&63),e[a++]=128|n>>>6&63),e[a++]=128|63&n);return e},n.buf2binstring=function(t){return l(t,t.length)},n.binstring2buf=function(t){for(var e=new r.Buf8(t.length),n=0,i=e.length;n<i;n++)e[n]=t.charCodeAt(n);return e},n.buf2string=function(t,e){var n,r,i,o,s=e||t.length,c=new Array(2*s);for(n=r=0;n<s;)if((i=t[n++])<128)c[r++]=i;else if(4<(o=a[i]))c[r++]=65533,n+=o-1;else{for(i&=2===o?31:3===o?15:7;1<o&&n<s;)i=i<<6|63&t[n++],o--;1<o?c[r++]=65533:i<65536?c[r++]=i:(i-=65536,c[r++]=55296|i>>10&1023,c[r++]=56320|1023&i)}return l(c,r)},n.utf8border=function(t,e){var n;for((e=e||t.length)>t.length&&(e=t.length),n=e-1;0<=n&&128==(192&t[n]);)n--;return n<0||0===n?e:n+a[t[n]]>e?n:e}},{"./common":41}],43:[function(t,e,n){"use strict";e.exports=function(t,e,n,r){for(var i=65535&t|0,o=t>>>16&65535|0,a=0;0!==n;){for(n-=a=2e3<n?2e3:n;o=o+(i=i+e[r++]|0)|0,--a;);i%=65521,o%=65521}return i|o<<16|0}},{}],44:[function(t,e,n){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,e,n){"use strict";var r=function(){for(var t,e=[],n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e}();e.exports=function(t,e,n,i){var o=r,a=i+n;t^=-1;for(var s=i;s<a;s++)t=t>>>8^o[255&(t^e[s])];return-1^t}},{}],46:[function(t,e,n){"use strict";var r,i=t("../utils/common"),o=t("./trees"),a=t("./adler32"),s=t("./crc32"),l=t("./messages"),c=-2,u=258,d=262,h=113;function p(t,e){return t.msg=l[e],e}function m(t){return(t<<1)-(4<t?9:0)}function _(t){for(var e=t.length;0<=--e;)t[e]=0}function f(t){var e=t.state,n=e.pending;n>t.avail_out&&(n=t.avail_out),0!==n&&(i.arraySet(t.output,e.pending_buf,e.pending_out,n,t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending&&(e.pending_out=0))}function g(t,e){o._tr_flush_block(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,f(t.strm)}function b(t,e){t.pending_buf[t.pending++]=e}function v(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function y(t,e){var n,r,i=t.max_chain_length,o=t.strstart,a=t.prev_length,s=t.nice_match,l=t.strstart>t.w_size-d?t.strstart-(t.w_size-d):0,c=t.window,h=t.w_mask,p=t.prev,m=t.strstart+u,_=c[o+a-1],f=c[o+a];t.prev_length>=t.good_match&&(i>>=2),s>t.lookahead&&(s=t.lookahead);do{if(c[(n=e)+a]===f&&c[n+a-1]===_&&c[n]===c[o]&&c[++n]===c[o+1]){o+=2,n++;do{}while(c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&o<m);if(r=u-(m-o),o=m-u,a<r){if(t.match_start=e,s<=(a=r))break;_=c[o+a-1],f=c[o+a]}}}while((e=p[e&h])>l&&0!=--i);return a<=t.lookahead?a:t.lookahead}function w(t){var e,n,r,o,l,c,u,h,p,m,_=t.w_size;do{if(o=t.window_size-t.lookahead-t.strstart,t.strstart>=_+(_-d)){for(i.arraySet(t.window,t.window,_,_,0),t.match_start-=_,t.strstart-=_,t.block_start-=_,e=n=t.hash_size;r=t.head[--e],t.head[e]=_<=r?r-_:0,--n;);for(e=n=_;r=t.prev[--e],t.prev[e]=_<=r?r-_:0,--n;);o+=_}if(0===t.strm.avail_in)break;if(c=t.strm,u=t.window,h=t.strstart+t.lookahead,m=void 0,(p=o)<(m=c.avail_in)&&(m=p),n=0===m?0:(c.avail_in-=m,i.arraySet(u,c.input,c.next_in,m,h),1===c.state.wrap?c.adler=a(c.adler,u,m,h):2===c.state.wrap&&(c.adler=s(c.adler,u,m,h)),c.next_in+=m,c.total_in+=m,m),t.lookahead+=n,t.lookahead+t.insert>=3)for(l=t.strstart-t.insert,t.ins_h=t.window[l],t.ins_h=(t.ins_h<<t.hash_shift^t.window[l+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[l+3-1])&t.hash_mask,t.prev[l&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=l,l++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<d&&0!==t.strm.avail_in)}function E(t,e){for(var n,r;;){if(t.lookahead<d){if(w(t),t.lookahead<d&&0===e)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==n&&t.strstart-n<=t.w_size-d&&(t.match_length=y(t,n)),t.match_length>=3)if(r=o._tr_tally(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){for(t.match_length--;t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,0!=--t.match_length;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else r=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(r&&(g(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,4===e?(g(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(g(t,!1),0===t.strm.avail_out)?1:2}function k(t,e){for(var n,r,i;;){if(t.lookahead<d){if(w(t),t.lookahead<d&&0===e)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==n&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-d&&(t.match_length=y(t,n),t.match_length<=5&&(1===t.strategy||3===t.match_length&&4096<t.strstart-t.match_start)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){for(i=t.strstart+t.lookahead-3,r=o._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=i&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!=--t.prev_length;);if(t.match_available=0,t.match_length=2,t.strstart++,r&&(g(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((r=o._tr_tally(t,0,t.window[t.strstart-1]))&&g(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(r=o._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,4===e?(g(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(g(t,!1),0===t.strm.avail_out)?1:2}function x(t,e,n,r,i){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=r,this.func=i}function C(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(1146),this.dyn_dtree=new i.Buf16(122),this.bl_tree=new i.Buf16(78),_(this.dyn_ltree),_(this.dyn_dtree),_(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(16),this.heap=new i.Buf16(573),_(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(573),_(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function S(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=2,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:h,t.adler=2===e.wrap?0:1,e.last_flush=0,o._tr_init(e),0):p(t,c)}function T(t){var e=S(t);return 0===e&&function(t){t.window_size=2*t.w_size,_(t.head),t.max_lazy_match=r[t.level].max_lazy,t.good_match=r[t.level].good_length,t.nice_match=r[t.level].nice_length,t.max_chain_length=r[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0}(t.state),e}function L(t,e,n,r,o,a){if(!t)return c;var s=1;if(-1===e&&(e=6),r<0?(s=0,r=-r):15<r&&(s=2,r-=16),o<1||9<o||8!==n||r<8||15<r||e<0||9<e||a<0||4<a)return p(t,c);8===r&&(r=9);var l=new C;return(t.state=l).strm=t,l.wrap=s,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new i.Buf8(2*l.w_size),l.head=new i.Buf16(l.hash_size),l.prev=new i.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new i.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=e,l.strategy=a,l.method=n,T(t)}r=[new x(0,0,0,0,(function(t,e){var n=65535;for(n>t.pending_buf_size-5&&(n=t.pending_buf_size-5);;){if(t.lookahead<=1){if(w(t),0===t.lookahead&&0===e)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var r=t.block_start+n;if((0===t.strstart||t.strstart>=r)&&(t.lookahead=t.strstart-r,t.strstart=r,g(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-d&&(g(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(g(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(g(t,!1),t.strm.avail_out),1)})),new x(4,4,8,4,E),new x(4,5,16,8,E),new x(4,6,32,32,E),new x(4,4,16,16,k),new x(8,16,32,32,k),new x(8,16,128,128,k),new x(8,32,128,256,k),new x(32,128,258,1024,k),new x(32,258,258,4096,k)],n.deflateInit=function(t,e){return L(t,e,8,15,8,0)},n.deflateInit2=L,n.deflateReset=T,n.deflateResetKeep=S,n.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?c:(t.state.gzhead=e,0):c},n.deflate=function(t,e){var n,i,a,l;if(!t||!t.state||5<e||e<0)return t?p(t,c):c;if(i=t.state,!t.output||!t.input&&0!==t.avail_in||666===i.status&&4!==e)return p(t,0===t.avail_out?-5:c);if(i.strm=t,n=i.last_flush,i.last_flush=e,42===i.status)if(2===i.wrap)t.adler=0,b(i,31),b(i,139),b(i,8),i.gzhead?(b(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),b(i,255&i.gzhead.time),b(i,i.gzhead.time>>8&255),b(i,i.gzhead.time>>16&255),b(i,i.gzhead.time>>24&255),b(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),b(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(b(i,255&i.gzhead.extra.length),b(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=s(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(b(i,0),b(i,0),b(i,0),b(i,0),b(i,0),b(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),b(i,3),i.status=h);else{var d=8+(i.w_bits-8<<4)<<8;d|=(2<=i.strategy||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(d|=32),d+=31-d%31,i.status=h,v(i,d),0!==i.strstart&&(v(i,t.adler>>>16),v(i,65535&t.adler)),t.adler=1}if(69===i.status)if(i.gzhead.extra){for(a=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>a&&(t.adler=s(t.adler,i.pending_buf,i.pending-a,a)),f(t),a=i.pending,i.pending!==i.pending_buf_size));)b(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>a&&(t.adler=s(t.adler,i.pending_buf,i.pending-a,a)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(t.adler=s(t.adler,i.pending_buf,i.pending-a,a)),f(t),a=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,b(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>a&&(t.adler=s(t.adler,i.pending_buf,i.pending-a,a)),0===l&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(t.adler=s(t.adler,i.pending_buf,i.pending-a,a)),f(t),a=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,b(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>a&&(t.adler=s(t.adler,i.pending_buf,i.pending-a,a)),0===l&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&f(t),i.pending+2<=i.pending_buf_size&&(b(i,255&t.adler),b(i,t.adler>>8&255),t.adler=0,i.status=h)):i.status=h),0!==i.pending){if(f(t),0===t.avail_out)return i.last_flush=-1,0}else if(0===t.avail_in&&m(e)<=m(n)&&4!==e)return p(t,-5);if(666===i.status&&0!==t.avail_in)return p(t,-5);if(0!==t.avail_in||0!==i.lookahead||0!==e&&666!==i.status){var y=2===i.strategy?function(t,e){for(var n;;){if(0===t.lookahead&&(w(t),0===t.lookahead)){if(0===e)return 1;break}if(t.match_length=0,n=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(g(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(g(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(g(t,!1),0===t.strm.avail_out)?1:2}(i,e):3===i.strategy?function(t,e){for(var n,r,i,a,s=t.window;;){if(t.lookahead<=u){if(w(t),t.lookahead<=u&&0===e)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&0<t.strstart&&(r=s[i=t.strstart-1])===s[++i]&&r===s[++i]&&r===s[++i]){a=t.strstart+u;do{}while(r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&i<a);t.match_length=u-(a-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(n=o._tr_tally(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(g(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(g(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(g(t,!1),0===t.strm.avail_out)?1:2}(i,e):r[i.level].func(i,e);if(3!==y&&4!==y||(i.status=666),1===y||3===y)return 0===t.avail_out&&(i.last_flush=-1),0;if(2===y&&(1===e?o._tr_align(i):5!==e&&(o._tr_stored_block(i,0,0,!1),3===e&&(_(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),f(t),0===t.avail_out))return i.last_flush=-1,0}return 4!==e?0:i.wrap<=0?1:(2===i.wrap?(b(i,255&t.adler),b(i,t.adler>>8&255),b(i,t.adler>>16&255),b(i,t.adler>>24&255),b(i,255&t.total_in),b(i,t.total_in>>8&255),b(i,t.total_in>>16&255),b(i,t.total_in>>24&255)):(v(i,t.adler>>>16),v(i,65535&t.adler)),f(t),0<i.wrap&&(i.wrap=-i.wrap),0!==i.pending?0:1)},n.deflateEnd=function(t){var e;return t&&t.state?42!==(e=t.state.status)&&69!==e&&73!==e&&91!==e&&103!==e&&e!==h&&666!==e?p(t,c):(t.state=null,e===h?p(t,-3):0):c},n.deflateSetDictionary=function(t,e){var n,r,o,s,l,u,d,h,p=e.length;if(!t||!t.state)return c;if(2===(s=(n=t.state).wrap)||1===s&&42!==n.status||n.lookahead)return c;for(1===s&&(t.adler=a(t.adler,e,p,0)),n.wrap=0,p>=n.w_size&&(0===s&&(_(n.head),n.strstart=0,n.block_start=0,n.insert=0),h=new i.Buf8(n.w_size),i.arraySet(h,e,p-n.w_size,n.w_size,0),e=h,p=n.w_size),l=t.avail_in,u=t.next_in,d=t.input,t.avail_in=p,t.next_in=0,t.input=e,w(n);n.lookahead>=3;){for(r=n.strstart,o=n.lookahead-2;n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+3-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++,--o;);n.strstart=r,n.lookahead=2,w(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,t.next_in=u,t.input=d,t.avail_in=l,n.wrap=s,0},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,e,n){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,e,n){"use strict";e.exports=function(t,e){var n,r,i,o,a,s,l,c,u,d,h,p,m,_,f,g,b,v,y,w,E,k,x,C,S;n=t.state,r=t.next_in,C=t.input,i=r+(t.avail_in-5),o=t.next_out,S=t.output,a=o-(e-t.avail_out),s=o+(t.avail_out-257),l=n.dmax,c=n.wsize,u=n.whave,d=n.wnext,h=n.window,p=n.hold,m=n.bits,_=n.lencode,f=n.distcode,g=(1<<n.lenbits)-1,b=(1<<n.distbits)-1;t:do{m<15&&(p+=C[r++]<<m,m+=8,p+=C[r++]<<m,m+=8),v=_[p&g];e:for(;;){if(p>>>=y=v>>>24,m-=y,0==(y=v>>>16&255))S[o++]=65535&v;else{if(!(16&y)){if(0==(64&y)){v=_[(65535&v)+(p&(1<<y)-1)];continue e}if(32&y){n.mode=12;break t}t.msg="invalid literal/length code",n.mode=30;break t}w=65535&v,(y&=15)&&(m<y&&(p+=C[r++]<<m,m+=8),w+=p&(1<<y)-1,p>>>=y,m-=y),m<15&&(p+=C[r++]<<m,m+=8,p+=C[r++]<<m,m+=8),v=f[p&b];n:for(;;){if(p>>>=y=v>>>24,m-=y,!(16&(y=v>>>16&255))){if(0==(64&y)){v=f[(65535&v)+(p&(1<<y)-1)];continue n}t.msg="invalid distance code",n.mode=30;break t}if(E=65535&v,m<(y&=15)&&(p+=C[r++]<<m,(m+=8)<y&&(p+=C[r++]<<m,m+=8)),l<(E+=p&(1<<y)-1)){t.msg="invalid distance too far back",n.mode=30;break t}if(p>>>=y,m-=y,(y=o-a)<E){if(u<(y=E-y)&&n.sane){t.msg="invalid distance too far back",n.mode=30;break t}if(x=h,(k=0)===d){if(k+=c-y,y<w){for(w-=y;S[o++]=h[k++],--y;);k=o-E,x=S}}else if(d<y){if(k+=c+d-y,(y-=d)<w){for(w-=y;S[o++]=h[k++],--y;);if(k=0,d<w){for(w-=y=d;S[o++]=h[k++],--y;);k=o-E,x=S}}}else if(k+=d-y,y<w){for(w-=y;S[o++]=h[k++],--y;);k=o-E,x=S}for(;2<w;)S[o++]=x[k++],S[o++]=x[k++],S[o++]=x[k++],w-=3;w&&(S[o++]=x[k++],1<w&&(S[o++]=x[k++]))}else{for(k=o-E;S[o++]=S[k++],S[o++]=S[k++],S[o++]=S[k++],2<(w-=3););w&&(S[o++]=S[k++],1<w&&(S[o++]=S[k++]))}break}}break}}while(r<i&&o<s);r-=w=m>>3,p&=(1<<(m-=w<<3))-1,t.next_in=r,t.next_out=o,t.avail_in=r<i?i-r+5:5-(r-i),t.avail_out=o<s?s-o+257:257-(o-s),n.hold=p,n.bits=m}},{}],49:[function(t,e,n){"use strict";var r=t("../utils/common"),i=t("./adler32"),o=t("./crc32"),a=t("./inffast"),s=t("./inftrees"),l=-2;function c(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function u(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function d(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new r.Buf32(852),e.distcode=e.distdyn=new r.Buf32(592),e.sane=1,e.back=-1,0):l}function h(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,d(t)):l}function p(t,e){var n,r;return t&&t.state?(r=t.state,e<0?(n=0,e=-e):(n=1+(e>>4),e<48&&(e&=15)),e&&(e<8||15<e)?l:(null!==r.window&&r.wbits!==e&&(r.window=null),r.wrap=n,r.wbits=e,h(t))):l}function m(t,e){var n,r;return t?(r=new u,(t.state=r).window=null,0!==(n=p(t,e))&&(t.state=null),n):l}var _,f,g=!0;function b(t){if(g){var e;for(_=new r.Buf32(512),f=new r.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(s(1,t.lens,0,288,_,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;s(2,t.lens,0,32,f,0,t.work,{bits:5}),g=!1}t.lencode=_,t.lenbits=9,t.distcode=f,t.distbits=5}function v(t,e,n,i){var o,a=t.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new r.Buf8(a.wsize)),i>=a.wsize?(r.arraySet(a.window,e,n-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):(i<(o=a.wsize-a.wnext)&&(o=i),r.arraySet(a.window,e,n-i,o,a.wnext),(i-=o)?(r.arraySet(a.window,e,n-i,i,0),a.wnext=i,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0}n.inflateReset=h,n.inflateReset2=p,n.inflateResetKeep=d,n.inflateInit=function(t){return m(t,15)},n.inflateInit2=m,n.inflate=function(t,e){var n,u,d,h,p,m,_,f,g,y,w,E,k,x,C,S,T,L,I,D,R,A,N,B,M=0,O=new r.Buf8(4),z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return l;12===(n=t.state).mode&&(n.mode=13),p=t.next_out,d=t.output,_=t.avail_out,h=t.next_in,u=t.input,m=t.avail_in,f=n.hold,g=n.bits,y=m,w=_,A=0;t:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;g<16;){if(0===m)break t;m--,f+=u[h++]<<g,g+=8}if(2&n.wrap&&35615===f){O[n.check=0]=255&f,O[1]=f>>>8&255,n.check=o(n.check,O,2,0),g=f=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&f)<<8)+(f>>8))%31){t.msg="incorrect header check",n.mode=30;break}if(8!=(15&f)){t.msg="unknown compression method",n.mode=30;break}if(g-=4,R=8+(15&(f>>>=4)),0===n.wbits)n.wbits=R;else if(R>n.wbits){t.msg="invalid window size",n.mode=30;break}n.dmax=1<<R,t.adler=n.check=1,n.mode=512&f?10:12,g=f=0;break;case 2:for(;g<16;){if(0===m)break t;m--,f+=u[h++]<<g,g+=8}if(n.flags=f,8!=(255&n.flags)){t.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=f>>8&1),512&n.flags&&(O[0]=255&f,O[1]=f>>>8&255,n.check=o(n.check,O,2,0)),g=f=0,n.mode=3;case 3:for(;g<32;){if(0===m)break t;m--,f+=u[h++]<<g,g+=8}n.head&&(n.head.time=f),512&n.flags&&(O[0]=255&f,O[1]=f>>>8&255,O[2]=f>>>16&255,O[3]=f>>>24&255,n.check=o(n.check,O,4,0)),g=f=0,n.mode=4;case 4:for(;g<16;){if(0===m)break t;m--,f+=u[h++]<<g,g+=8}n.head&&(n.head.xflags=255&f,n.head.os=f>>8),512&n.flags&&(O[0]=255&f,O[1]=f>>>8&255,n.check=o(n.check,O,2,0)),g=f=0,n.mode=5;case 5:if(1024&n.flags){for(;g<16;){if(0===m)break t;m--,f+=u[h++]<<g,g+=8}n.length=f,n.head&&(n.head.extra_len=f),512&n.flags&&(O[0]=255&f,O[1]=f>>>8&255,n.check=o(n.check,O,2,0)),g=f=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(m<(E=n.length)&&(E=m),E&&(n.head&&(R=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,u,h,E,R)),512&n.flags&&(n.check=o(n.check,u,E,h)),m-=E,h+=E,n.length-=E),n.length))break t;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===m)break t;for(E=0;R=u[h+E++],n.head&&R&&n.length<65536&&(n.head.name+=String.fromCharCode(R)),R&&E<m;);if(512&n.flags&&(n.check=o(n.check,u,E,h)),m-=E,h+=E,R)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===m)break t;for(E=0;R=u[h+E++],n.head&&R&&n.length<65536&&(n.head.comment+=String.fromCharCode(R)),R&&E<m;);if(512&n.flags&&(n.check=o(n.check,u,E,h)),m-=E,h+=E,R)break t}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;g<16;){if(0===m)break t;m--,f+=u[h++]<<g,g+=8}if(f!==(65535&n.check)){t.msg="header crc mismatch",n.mode=30;break}g=f=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=12;break;case 10:for(;g<32;){if(0===m)break t;m--,f+=u[h++]<<g,g+=8}t.adler=n.check=c(f),g=f=0,n.mode=11;case 11:if(0===n.havedict)return t.next_out=p,t.avail_out=_,t.next_in=h,t.avail_in=m,n.hold=f,n.bits=g,2;t.adler=n.check=1,n.mode=12;case 12:if(5===e||6===e)break t;case 13:if(n.last){f>>>=7&g,g-=7&g,n.mode=27;break}for(;g<3;){if(0===m)break t;m--,f+=u[h++]<<g,g+=8}switch(n.last=1&f,g-=1,3&(f>>>=1)){case 0:n.mode=14;break;case 1:if(b(n),n.mode=20,6!==e)break;f>>>=2,g-=2;break t;case 2:n.mode=17;break;case 3:t.msg="invalid block type",n.mode=30}f>>>=2,g-=2;break;case 14:for(f>>>=7&g,g-=7&g;g<32;){if(0===m)break t;m--,f+=u[h++]<<g,g+=8}if((65535&f)!=(f>>>16^65535)){t.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&f,g=f=0,n.mode=15,6===e)break t;case 15:n.mode=16;case 16:if(E=n.length){if(m<E&&(E=m),_<E&&(E=_),0===E)break t;r.arraySet(d,u,h,E,p),m-=E,h+=E,_-=E,p+=E,n.length-=E;break}n.mode=12;break;case 17:for(;g<14;){if(0===m)break t;m--,f+=u[h++]<<g,g+=8}if(n.nlen=257+(31&f),f>>>=5,g-=5,n.ndist=1+(31&f),f>>>=5,g-=5,n.ncode=4+(15&f),f>>>=4,g-=4,286<n.nlen||30<n.ndist){t.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;g<3;){if(0===m)break t;m--,f+=u[h++]<<g,g+=8}n.lens[z[n.have++]]=7&f,f>>>=3,g-=3}for(;n.have<19;)n.lens[z[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,N={bits:n.lenbits},A=s(0,n.lens,0,19,n.lencode,0,n.work,N),n.lenbits=N.bits,A){t.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;S=(M=n.lencode[f&(1<<n.lenbits)-1])>>>16&255,T=65535&M,!((C=M>>>24)<=g);){if(0===m)break t;m--,f+=u[h++]<<g,g+=8}if(T<16)f>>>=C,g-=C,n.lens[n.have++]=T;else{if(16===T){for(B=C+2;g<B;){if(0===m)break t;m--,f+=u[h++]<<g,g+=8}if(f>>>=C,g-=C,0===n.have){t.msg="invalid bit length repeat",n.mode=30;break}R=n.lens[n.have-1],E=3+(3&f),f>>>=2,g-=2}else if(17===T){for(B=C+3;g<B;){if(0===m)break t;m--,f+=u[h++]<<g,g+=8}g-=C,R=0,E=3+(7&(f>>>=C)),f>>>=3,g-=3}else{for(B=C+7;g<B;){if(0===m)break t;m--,f+=u[h++]<<g,g+=8}g-=C,R=0,E=11+(127&(f>>>=C)),f>>>=7,g-=7}if(n.have+E>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=30;break}for(;E--;)n.lens[n.have++]=R}}if(30===n.mode)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,N={bits:n.lenbits},A=s(1,n.lens,0,n.nlen,n.lencode,0,n.work,N),n.lenbits=N.bits,A){t.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,N={bits:n.distbits},A=s(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,N),n.distbits=N.bits,A){t.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===e)break t;case 20:n.mode=21;case 21:if(6<=m&&258<=_){t.next_out=p,t.avail_out=_,t.next_in=h,t.avail_in=m,n.hold=f,n.bits=g,a(t,w),p=t.next_out,d=t.output,_=t.avail_out,h=t.next_in,u=t.input,m=t.avail_in,f=n.hold,g=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;S=(M=n.lencode[f&(1<<n.lenbits)-1])>>>16&255,T=65535&M,!((C=M>>>24)<=g);){if(0===m)break t;m--,f+=u[h++]<<g,g+=8}if(S&&0==(240&S)){for(L=C,I=S,D=T;S=(M=n.lencode[D+((f&(1<<L+I)-1)>>L)])>>>16&255,T=65535&M,!(L+(C=M>>>24)<=g);){if(0===m)break t;m--,f+=u[h++]<<g,g+=8}f>>>=L,g-=L,n.back+=L}if(f>>>=C,g-=C,n.back+=C,n.length=T,0===S){n.mode=26;break}if(32&S){n.back=-1,n.mode=12;break}if(64&S){t.msg="invalid literal/length code",n.mode=30;break}n.extra=15&S,n.mode=22;case 22:if(n.extra){for(B=n.extra;g<B;){if(0===m)break t;m--,f+=u[h++]<<g,g+=8}n.length+=f&(1<<n.extra)-1,f>>>=n.extra,g-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;S=(M=n.distcode[f&(1<<n.distbits)-1])>>>16&255,T=65535&M,!((C=M>>>24)<=g);){if(0===m)break t;m--,f+=u[h++]<<g,g+=8}if(0==(240&S)){for(L=C,I=S,D=T;S=(M=n.distcode[D+((f&(1<<L+I)-1)>>L)])>>>16&255,T=65535&M,!(L+(C=M>>>24)<=g);){if(0===m)break t;m--,f+=u[h++]<<g,g+=8}f>>>=L,g-=L,n.back+=L}if(f>>>=C,g-=C,n.back+=C,64&S){t.msg="invalid distance code",n.mode=30;break}n.offset=T,n.extra=15&S,n.mode=24;case 24:if(n.extra){for(B=n.extra;g<B;){if(0===m)break t;m--,f+=u[h++]<<g,g+=8}n.offset+=f&(1<<n.extra)-1,f>>>=n.extra,g-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===_)break t;if(E=w-_,n.offset>E){if((E=n.offset-E)>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=30;break}k=E>n.wnext?(E-=n.wnext,n.wsize-E):n.wnext-E,E>n.length&&(E=n.length),x=n.window}else x=d,k=p-n.offset,E=n.length;for(_<E&&(E=_),_-=E,n.length-=E;d[p++]=x[k++],--E;);0===n.length&&(n.mode=21);break;case 26:if(0===_)break t;d[p++]=n.length,_--,n.mode=21;break;case 27:if(n.wrap){for(;g<32;){if(0===m)break t;m--,f|=u[h++]<<g,g+=8}if(w-=_,t.total_out+=w,n.total+=w,w&&(t.adler=n.check=n.flags?o(n.check,d,w,p-w):i(n.check,d,w,p-w)),w=_,(n.flags?f:c(f))!==n.check){t.msg="incorrect data check",n.mode=30;break}g=f=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;g<32;){if(0===m)break t;m--,f+=u[h++]<<g,g+=8}if(f!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=30;break}g=f=0}n.mode=29;case 29:A=1;break t;case 30:A=-3;break t;case 31:return-4;default:return l}return t.next_out=p,t.avail_out=_,t.next_in=h,t.avail_in=m,n.hold=f,n.bits=g,(n.wsize||w!==t.avail_out&&n.mode<30&&(n.mode<27||4!==e))&&v(t,t.output,t.next_out,w-t.avail_out)?(n.mode=31,-4):(y-=t.avail_in,w-=t.avail_out,t.total_in+=y,t.total_out+=w,n.total+=w,n.wrap&&w&&(t.adler=n.check=n.flags?o(n.check,d,w,t.next_out-w):i(n.check,d,w,t.next_out-w)),t.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0==y&&0===w||4===e)&&0===A&&(A=-5),A)},n.inflateEnd=function(t){if(!t||!t.state)return l;var e=t.state;return e.window&&(e.window=null),t.state=null,0},n.inflateGetHeader=function(t,e){var n;return t&&t.state?0==(2&(n=t.state).wrap)?l:((n.head=e).done=!1,0):l},n.inflateSetDictionary=function(t,e){var n,r=e.length;return t&&t.state?0!==(n=t.state).wrap&&11!==n.mode?l:11===n.mode&&i(1,e,r,0)!==n.check?-3:v(t,e,r,r)?(n.mode=31,-4):(n.havedict=1,0):l},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,e,n){"use strict";var r=t("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(t,e,n,l,c,u,d,h){var p,m,_,f,g,b,v,y,w,E=h.bits,k=0,x=0,C=0,S=0,T=0,L=0,I=0,D=0,R=0,A=0,N=null,B=0,M=new r.Buf16(16),O=new r.Buf16(16),z=null,P=0;for(k=0;k<=15;k++)M[k]=0;for(x=0;x<l;x++)M[e[n+x]]++;for(T=E,S=15;1<=S&&0===M[S];S--);if(S<T&&(T=S),0===S)return c[u++]=20971520,c[u++]=20971520,h.bits=1,0;for(C=1;C<S&&0===M[C];C++);for(T<C&&(T=C),k=D=1;k<=15;k++)if(D<<=1,(D-=M[k])<0)return-1;if(0<D&&(0===t||1!==S))return-1;for(O[1]=0,k=1;k<15;k++)O[k+1]=O[k]+M[k];for(x=0;x<l;x++)0!==e[n+x]&&(d[O[e[n+x]]++]=x);if(b=0===t?(N=z=d,19):1===t?(N=i,B-=257,z=o,P-=257,256):(N=a,z=s,-1),k=C,g=u,I=x=A=0,_=-1,f=(R=1<<(L=T))-1,1===t&&852<R||2===t&&592<R)return 1;for(;;){for(v=k-I,w=d[x]<b?(y=0,d[x]):d[x]>b?(y=z[P+d[x]],N[B+d[x]]):(y=96,0),p=1<<k-I,C=m=1<<L;c[g+(A>>I)+(m-=p)]=v<<24|y<<16|w|0,0!==m;);for(p=1<<k-1;A&p;)p>>=1;if(0!==p?(A&=p-1,A+=p):A=0,x++,0==--M[k]){if(k===S)break;k=e[n+d[x]]}if(T<k&&(A&f)!==_){for(0===I&&(I=T),g+=C,D=1<<(L=k-I);L+I<S&&!((D-=M[L+I])<=0);)L++,D<<=1;if(R+=1<<L,1===t&&852<R||2===t&&592<R)return 1;c[_=A&f]=T<<24|L<<16|g-u|0}}return 0!==A&&(c[g+A]=k-I<<24|64<<16|0),h.bits=T,0}},{"../utils/common":41}],51:[function(t,e,n){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,e,n){"use strict";var r=t("../utils/common");function i(t){for(var e=t.length;0<=--e;)t[e]=0}var o=256,a=286,s=30,l=15,c=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],u=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],h=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],p=new Array(576);i(p);var m=new Array(60);i(m);var _=new Array(512);i(_);var f=new Array(256);i(f);var g=new Array(29);i(g);var b,v,y,w=new Array(s);function E(t,e,n,r,i){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=t&&t.length}function k(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function x(t){return t<256?_[t]:_[256+(t>>>7)]}function C(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function S(t,e,n){t.bi_valid>16-n?(t.bi_buf|=e<<t.bi_valid&65535,C(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=n-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)}function T(t,e,n){S(t,n[2*e],n[2*e+1])}function L(t,e){for(var n=0;n|=1&t,t>>>=1,n<<=1,0<--e;);return n>>>1}function I(t,e,n){var r,i,o=new Array(16),a=0;for(r=1;r<=l;r++)o[r]=a=a+n[r-1]<<1;for(i=0;i<=e;i++){var s=t[2*i+1];0!==s&&(t[2*i]=L(o[s]++,s))}}function D(t){var e;for(e=0;e<a;e++)t.dyn_ltree[2*e]=0;for(e=0;e<s;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function R(t){8<t.bi_valid?C(t,t.bi_buf):0<t.bi_valid&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function A(t,e,n,r){var i=2*e,o=2*n;return t[i]<t[o]||t[i]===t[o]&&r[e]<=r[n]}function N(t,e,n){for(var r=t.heap[n],i=n<<1;i<=t.heap_len&&(i<t.heap_len&&A(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!A(e,r,t.heap[i],t.depth));)t.heap[n]=t.heap[i],n=i,i<<=1;t.heap[n]=r}function B(t,e,n){var r,i,a,s,l=0;if(0!==t.last_lit)for(;r=t.pending_buf[t.d_buf+2*l]<<8|t.pending_buf[t.d_buf+2*l+1],i=t.pending_buf[t.l_buf+l],l++,0===r?T(t,i,e):(T(t,(a=f[i])+o+1,e),0!==(s=c[a])&&S(t,i-=g[a],s),T(t,a=x(--r),n),0!==(s=u[a])&&S(t,r-=w[a],s)),l<t.last_lit;);T(t,256,e)}function M(t,e){var n,r,i,o=e.dyn_tree,a=e.stat_desc.static_tree,s=e.stat_desc.has_stree,c=e.stat_desc.elems,u=-1;for(t.heap_len=0,t.heap_max=573,n=0;n<c;n++)0!==o[2*n]?(t.heap[++t.heap_len]=u=n,t.depth[n]=0):o[2*n+1]=0;for(;t.heap_len<2;)o[2*(i=t.heap[++t.heap_len]=u<2?++u:0)]=1,t.depth[i]=0,t.opt_len--,s&&(t.static_len-=a[2*i+1]);for(e.max_code=u,n=t.heap_len>>1;1<=n;n--)N(t,o,n);for(i=c;n=t.heap[1],t.heap[1]=t.heap[t.heap_len--],N(t,o,1),r=t.heap[1],t.heap[--t.heap_max]=n,t.heap[--t.heap_max]=r,o[2*i]=o[2*n]+o[2*r],t.depth[i]=(t.depth[n]>=t.depth[r]?t.depth[n]:t.depth[r])+1,o[2*n+1]=o[2*r+1]=i,t.heap[1]=i++,N(t,o,1),2<=t.heap_len;);t.heap[--t.heap_max]=t.heap[1],function(t,e){var n,r,i,o,a,s,c=e.dyn_tree,u=e.max_code,d=e.stat_desc.static_tree,h=e.stat_desc.has_stree,p=e.stat_desc.extra_bits,m=e.stat_desc.extra_base,_=e.stat_desc.max_length,f=0;for(o=0;o<=l;o++)t.bl_count[o]=0;for(c[2*t.heap[t.heap_max]+1]=0,n=t.heap_max+1;n<573;n++)_<(o=c[2*c[2*(r=t.heap[n])+1]+1]+1)&&(o=_,f++),c[2*r+1]=o,u<r||(t.bl_count[o]++,a=0,m<=r&&(a=p[r-m]),s=c[2*r],t.opt_len+=s*(o+a),h&&(t.static_len+=s*(d[2*r+1]+a)));if(0!==f){do{for(o=_-1;0===t.bl_count[o];)o--;t.bl_count[o]--,t.bl_count[o+1]+=2,t.bl_count[_]--,f-=2}while(0<f);for(o=_;0!==o;o--)for(r=t.bl_count[o];0!==r;)u<(i=t.heap[--n])||(c[2*i+1]!==o&&(t.opt_len+=(o-c[2*i+1])*c[2*i],c[2*i+1]=o),r--)}}(t,e),I(o,u,t.bl_count)}function O(t,e,n){var r,i,o=-1,a=e[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),e[2*(n+1)+1]=65535,r=0;r<=n;r++)i=a,a=e[2*(r+1)+1],++s<l&&i===a||(s<c?t.bl_tree[2*i]+=s:0!==i?(i!==o&&t.bl_tree[2*i]++,t.bl_tree[32]++):s<=10?t.bl_tree[34]++:t.bl_tree[36]++,o=i,c=(s=0)===a?(l=138,3):i===a?(l=6,3):(l=7,4))}function z(t,e,n){var r,i,o=-1,a=e[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),r=0;r<=n;r++)if(i=a,a=e[2*(r+1)+1],!(++s<l&&i===a)){if(s<c)for(;T(t,i,t.bl_tree),0!=--s;);else 0!==i?(i!==o&&(T(t,i,t.bl_tree),s--),T(t,16,t.bl_tree),S(t,s-3,2)):s<=10?(T(t,17,t.bl_tree),S(t,s-3,3)):(T(t,18,t.bl_tree),S(t,s-11,7));o=i,c=(s=0)===a?(l=138,3):i===a?(l=6,3):(l=7,4)}}i(w);var P=!1;function F(t,e,n,i){S(t,0+(i?1:0),3),function(t,e,n,i){R(t),C(t,n),C(t,~n),r.arraySet(t.pending_buf,t.window,e,n,t.pending),t.pending+=n}(t,e,n)}n._tr_init=function(t){P||(function(){var t,e,n,r,i,o=new Array(16);for(r=n=0;r<28;r++)for(g[r]=n,t=0;t<1<<c[r];t++)f[n++]=r;for(f[n-1]=r,r=i=0;r<16;r++)for(w[r]=i,t=0;t<1<<u[r];t++)_[i++]=r;for(i>>=7;r<s;r++)for(w[r]=i<<7,t=0;t<1<<u[r]-7;t++)_[256+i++]=r;for(e=0;e<=l;e++)o[e]=0;for(t=0;t<=143;)p[2*t+1]=8,t++,o[8]++;for(;t<=255;)p[2*t+1]=9,t++,o[9]++;for(;t<=279;)p[2*t+1]=7,t++,o[7]++;for(;t<=287;)p[2*t+1]=8,t++,o[8]++;for(I(p,287,o),t=0;t<s;t++)m[2*t+1]=5,m[2*t]=L(t,5);b=new E(p,c,257,a,l),v=new E(m,u,0,s,l),y=new E(new Array(0),d,0,19,7)}(),P=!0),t.l_desc=new k(t.dyn_ltree,b),t.d_desc=new k(t.dyn_dtree,v),t.bl_desc=new k(t.bl_tree,y),t.bi_buf=0,t.bi_valid=0,D(t)},n._tr_stored_block=F,n._tr_flush_block=function(t,e,n,r){var i,a,s=0;0<t.level?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<o;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0}(t)),M(t,t.l_desc),M(t,t.d_desc),s=function(t){var e;for(O(t,t.dyn_ltree,t.l_desc.max_code),O(t,t.dyn_dtree,t.d_desc.max_code),M(t,t.bl_desc),e=18;3<=e&&0===t.bl_tree[2*h[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),i=t.opt_len+3+7>>>3,(a=t.static_len+3+7>>>3)<=i&&(i=a)):i=a=n+5,n+4<=i&&-1!==e?F(t,e,n,r):4===t.strategy||a===i?(S(t,2+(r?1:0),3),B(t,p,m)):(S(t,4+(r?1:0),3),function(t,e,n,r){var i;for(S(t,e-257,5),S(t,n-1,5),S(t,r-4,4),i=0;i<r;i++)S(t,t.bl_tree[2*h[i]+1],3);z(t,t.dyn_ltree,e-1),z(t,t.dyn_dtree,n-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,s+1),B(t,t.dyn_ltree,t.dyn_dtree)),D(t),r&&R(t)},n._tr_tally=function(t,e,n){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&n,t.last_lit++,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(f[n]+o+1)]++,t.dyn_dtree[2*x(e)]++),t.last_lit===t.lit_bufsize-1},n._tr_align=function(t){S(t,2,3),T(t,256,p),function(t){16===t.bi_valid?(C(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},{"../utils/common":41}],53:[function(t,e,n){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,e,n){"use strict";e.exports="function"==typeof setImmediate?setImmediate:function(){var t=[].slice.apply(arguments);t.splice(1,0,0),setTimeout.apply(null,t)}},{}]},{},[10])(10)}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";var t={};n.r(t),n.d(t,{audio:()=>Ye,coverImage:()=>Xe,previewTime:()=>tn,progression:()=>pn});var e={};n.r(e),n.d(e,{acceptablePrec:()=>Sn,colorCheck:()=>$i,doubleDirectional:()=>li,effectiveBPM:()=>yn,hitboxInline:()=>Or,hitboxPath:()=>$r,hitboxReverseStair:()=>Rr,hitboxStair:()=>Sr,improperWindow:()=>Wr,inlineAngle:()=>Yn,parity:()=>ri,shradoAngle:()=>dr,slowSlider:()=>$n,speedPause:()=>wr,stackedNote:()=>Ni,varySwing:()=>Rn,visionBlock:()=>Li});var r={};n.r(r),n.d(r,{centerObstacle:()=>no,negativeObstacle:()=>po,shortObstacle:()=>Wi,zeroObstacle:()=>so});var i={};n.r(i),n.d(i,{insufficientLight:()=>bo,oldEventValue:()=>ko,testEvent:()=>Lo});var o={};n.r(o),n.d(o,{difficultyLabel:()=>Mo,hotStart:()=>No,invalidObject:()=>Jo,njs:()=>zo,outsidePlayable:()=>Uo});const a="accordion__";var s;!function(t){t.none="",t.ExpertPlus="accordion__label--bg-expertplus",t.Expert="accordion__label--bg-expert",t.Hard="accordion__label--bg-hard",t.Normal="accordion__label--bg-normal",t.Easy="accordion__label--bg-easy"}(s||(s={}));const l=document.querySelectorAll(".accordion__button");l.length||console.error("UI Accordion: empty accordion list, intentional or typo error?");const c=(t,e)=>{l.forEach((n=>{n.id.endsWith(t)&&(n.checked=e)}))},u=t=>{if(!t)return"0:00";const e=Math.floor(t),n=e/60;return`${n<0?`-${Math.ceil(n).toString()}`:Math.floor(n).toString()}:${Math.abs(e%60).toString().padStart(2,"0")}`},d=(t,e=0)=>Math.round(t*Math.pow(10,e))/Math.pow(10,e),h=t=>t*(Math.PI/180),p=(t,e)=>{e<0&&(e=-e);let n=t%e;return n<0?n+e:n},m=(t,e,n)=>Math.min(p(t-e,n),p(e-t,n)),_=t=>{if(0===t.length)return 0;t.sort(((t,e)=>t-e));const e=Math.floor(t.length/2);return t.length%2?t[e]:(t[e-1]+t[e])/2},f=t=>{if(t=t.trim(),/^http:\/\//.test(t)&&(t=t.replace("http://","https://")),/^(http|ftp|https):\/\/([\w_-]+(?:(?:\.[\w_-]+)+))([\w.,@?^=%&:/~+#-]*[\w@?^=%&/~+#-])?/.test(t))return t;throw new Error("Invalid URL")},g=t=>{if(t=t.trim(),/^!bsr /.test(t)&&(t=t.replace("!bsr ","")),/^[0-9a-fA-F]{1,6}$/.test(t))return t;throw new Error("Invalid ID")},b=t=>/[a-fA-F0-9]*/g.test(t),v=t=>{for(let e=t.options.length-1;e>=0;e--)t.remove(e)};const y=document.querySelector(".intro"),w=document.querySelector(".metadata"),E=document.querySelector(".cover__link"),k=document.querySelector(".cover__image"),x=document.querySelector(".metadata__song-name"),C=document.querySelector(".metadata__song-subname"),S=document.querySelector(".metadata__song-author"),T=document.querySelector(".metadata__song-bpm"),L=document.querySelector(".metadata__song-duration"),I=document.querySelector(".audio");y&&w||console.error("UI Header: header component is missing one of the two section"),E&&k||console.error("UI Header: cover component is missing"),x&&C&&S&&T&&L||console.error("UI Header: metadata component is missing one of the part");const D=t=>{y&&w?(t?y.classList.add("hidden"):y.classList.remove("hidden"),t?w.classList.remove("hidden"):w.classList.add("hidden")):console.error("UI Header: could not switch header, one of the section is missing")},R=t=>{k?k.src=t||"./assets/unknown.jpg":console.error("UI Header: missing HTML element for cover image")},A=(t,e)=>{if(E)return null==t&&null==e?(E.textContent="",E.href="",void E.classList.add("disabled")):void(null!=t&&(E.textContent=null!=e?e:"Download Link",E.href=t,E.classList.remove("disabled")));console.error("UI Header: missing HTML element for cover link")},N=t=>{L?L.textContent=t?(t=>{var e;if(!t)return"0:00.000";const n=(null===(e=(t%1).toString().split(".")[1])||void 0===e?void 0:e.padEnd(3,"0").slice(0,3))||"000";return`${u(t)}.${n}`})(t):"No audio":console.error("UI Header: missing HTML element for song duration")};class B{constructor(t,e=[],n=0){this._bpm=t,this._offset=n/1e3,this._bpmChange=this.getBPMChangeTime([...e])}get value(){return this._bpm}set value(t){this._bpm=t}get change(){return this._bpmChange}set change(t){this._bpmChange=this.getBPMChangeTime([...t])}get offset(){return 1e3*this._offset}set offset(t){this._offset=t/1e3}getBPMChangeTime(t=[]){var e;let n;const r=[];for(let i=0;i<t.length;i++){let o={_BPM:null!==(e=t[i]._BPM)&&void 0!==e?e:t[i]._bpm,_time:t[i]._time,_newTime:0};o._newTime=n?Math.ceil((o._time-n._time)/this._bpm*n._BPM+n._newTime-.01):Math.ceil(o._time-this._offset*this._bpm/60-.01),r.push(o),n=o}return r}offsetBegone(t){return(this.toRealTime(t)-this._offset)*this._bpm/60}toRealTime(t){return t/this._bpm*60}toBeatTime(t){return t*this._bpm/60}adjustTime(t){for(let e=this._bpmChange.length-1;e>=0;e--)if(t>this._bpmChange[e]._time)return(t-this._bpmChange[e]._time)/this._bpm*this._bpmChange[e]._BPM+this._bpmChange[e]._newTime;return this.offsetBegone(t)}}const M=(t,e,n)=>new B(t,e,n);var O,z,P,F,j,$,U,H;!function(t){t.Standard="Standard",t.NoArrows="No Arrows",t.OneSaber="One Saber",t["360Degree"]="360 Degree",t["90Degree"]="90 Degree",t.Lightshow="Lightshow",t.Lawless="Lawless"}(O||(O={})),function(t){t[t.Standard=0]="Standard",t[t.NoArrows=1]="NoArrows",t[t.OneSaber=2]="OneSaber",t[t["360Degree"]=3]="360Degree",t[t["90Degree"]=4]="90Degree",t[t.Lightshow=5]="Lightshow",t[t.Lawless=6]="Lawless"}(z||(z={})),function(t){t._id="Ct",t._lookupMethod="Lm",t._duplicate="D",t._active="A",t._scale="S",t._position="P",t._localPosition="Lp",t._rotation="R",t._localRotation="Lr",t._lightID="Li",t._track="T"}(P||(P={})),function(t){t.Easy="Easy",t.Normal="Normal",t.Hard="Hard",t.Expert="Expert",t.ExpertPlus="Expert+"}(F||(F={})),function(t){t[t.Easy=1]="Easy",t[t.Normal=3]="Normal",t[t.Hard=5]="Hard",t[t.Expert=7]="Expert",t[t.ExpertPlus=9]="ExpertPlus"}(j||(j={})),function(t){t._colorLeft="Left Note Color",t._colorRight="Right Note Color",t._envColorLeft="Left Environment Color",t._envColorRight="Right Environment Color",t._envColorLeftBoost="Left Environment Boost Color",t._envColorRightBoost="Right Environment Boost Color",t._obstacleColor="Obstacle Color"}($||($={})),function(t){t.DefaultEnvironment="The First",t.OriginsEnvironment="Origins",t.Origins="Origins",t.TriangleEnvironment="Triangle",t.NiceEnvironment="Nice",t.BigMirrorEnvironment="Big Mirror",t.DragonsEnvironment="Dragons",t.KDAEnvironment="K/DA",t.MonstercatEnvironment="Monstercat",t.CrabRaveEnvironment="Crab Rave",t.PanicEnvironment="Panic",t.RocketEnvironment="Rocket",t.GreenDayEnvironment="Green Day",t.GreenDayGrenadeEnvironment="Green Day Grenade",t.TimbalandEnvironment="Timbaland",t.FitBeatEnvironment="FitBeat",t.LinkinParkEnvironment="Linkin Park",t.BTSEnvironment="BTS",t.KaleidoscopeEnvironment="Kaleidoscope",t.InterscopeEnvironment="Interscope",t.SkrillexEnvironment="Skrillex",t.BillieEnvironment="Billie",t.HalloweenEnvironment="Spooky",t.GlassDesertEnvironment="Glass Desert"}(U||(U={})),function(t){t.DefaultEnvironment="The First",t.OriginsEnvironment="Origins",t.Origins="Origins",t.TriangleEnvironment="The First",t.NiceEnvironment="The First",t.BigMirrorEnvironment="The First",t.DragonsEnvironment="The First",t.KDAEnvironment="KDA",t.MonstercatEnvironment="The First",t.CrabRaveEnvironment="Crab Rave",t.PanicEnvironment="The First",t.RocketEnvironment="Rocket",t.GreenDayEnvironment="Green Day",t.GreenDayGrenadeEnvironment="Green Day",t.TimbalandEnvironment="Timbaland",t.FitBeatEnvironment="FitBeat",t.LinkinParkEnvironment="Linkin Park",t.BTSEnvironment="BTS",t.KaleidoscopeEnvironment="Kaleidoscope",t.InterscopeEnvironment="Interscope",t.SkrillexEnvironment="Skrillex",t.BillieEnvironment="Billie Eilish",t.HalloweenEnvironment="Spooky",t.GlassDesertEnvironment="Glass Desert"}(H||(H={}));const q={"Default Custom":{_colorLeft:{r:.7529412,g:.1882353,b:.1882353},_colorRight:{r:.1254902,g:.3921569,b:.6588235},_envColorLeft:{r:.7529412,g:.1882353,b:.1882353},_envColorRight:{r:.1882353,g:.5960785,b:1},_obstacleColor:{r:1,g:.1882353,b:.1882353}},"The First":{_colorLeft:{r:.7843137,g:.07843138,b:.07843138},_colorRight:{r:.1568627,g:.5568627,b:.8235294},_envColorLeft:{r:.85,g:.08499997,b:.08499997},_envColorRight:{r:.1882353,g:.675294,b:1},_obstacleColor:{r:1,g:.1882353,b:.1882353}},Origins:{_colorLeft:{r:.6792453,g:.5712628,b:0},_colorRight:{r:.7075472,g:0,b:.5364411},_envColorLeft:{r:.4910995,g:.6862745,b:.7},_envColorRight:{r:.03844783,g:.6862745,b:.9056604},_obstacleColor:{r:.06167676,g:.2869513,b:.3962264}},KDA:{_colorLeft:{r:.6588235,g:.2627451,b:.1607843},_colorRight:{r:.5019608,g:.08235294,b:.572549},_envColorLeft:{r:1,g:.3960785,b:.2431373},_envColorRight:{r:.7607844,g:.1254902,b:.8666667},_obstacleColor:{r:1,g:.3960785,b:.2431373}},"Crab Rave":{_colorLeft:{r:0,g:.7130001,b:.07806564},_colorRight:{r:.04805952,g:.5068096,b:.734},_envColorLeft:{r:.134568,g:.756,b:.1557533},_envColorRight:{r:.05647058,g:.6211764,b:.9},_obstacleColor:{r:0,g:.8117648,b:.09019608}},Noir:{_colorLeft:{r:.1792453,g:.1792453,b:.1792453},_colorRight:{r:.5943396,g:.5943396,b:.5943396},_envColorLeft:{r:.4056604,g:.4056604,b:.4056604},_envColorRight:{r:.6037736,g:.6037736,b:.6037736},_obstacleColor:{r:.2358491,g:.2358491,b:.2358491}},Rocket:{_colorLeft:{r:1,g:.4980392,b:0},_colorRight:{r:0,g:.5294118,b:1},_envColorLeft:{r:.9,g:.4866279,b:.3244186},_envColorRight:{r:.4,g:.7180724,b:1},_obstacleColor:{r:.3176471,g:.6117647,b:.7254902}},"Green Day":{_colorLeft:{r:.2588235,g:.7843138,b:.01960784},_colorRight:{r:0,g:.7137255,b:.6705883},_envColorLeft:{r:0,g:.7137255,b:.6705883},_envColorRight:{r:.2588235,g:.7843137,b:.01960784},_obstacleColor:{r:0,g:.8117648,b:.09019608}},Timbaland:{_colorLeft:{r:.5019608,g:.5019608,b:.5019608},_colorRight:{r:.1,g:.5517647,b:1},_envColorLeft:{r:.1,g:.5517647,b:1},_envColorRight:{r:.1,g:.5517647,b:1},_obstacleColor:{r:.5,g:.5,b:.5}},FitBeat:{_colorLeft:{r:.8000001,g:.6078432,b:.1568628},_colorRight:{r:.7921569,g:.1607843,b:.682353},_envColorLeft:{r:.8,g:.5594772,b:.5594772},_envColorRight:{r:.5594772,g:.5594772,b:.8},_obstacleColor:{r:.2784314,g:.2784314,b:.4}},"Linkin Park":{_colorLeft:{r:.6627451,g:.1643608,b:.1690187},_colorRight:{r:.3870196,g:.5168997,b:.5568628},_envColorLeft:{r:.7529412,g:.672753,b:.5925647},_envColorRight:{r:.6241197,g:.6890281,b:.709},_envColorLeftBoost:{r:.922,g:.5957885,b:.255394},_envColorRightBoost:{r:.282353,g:.4586275,b:.6235294},_obstacleColor:{r:.6627451,g:.1647059,b:.172549}},BTS:{_colorLeft:{r:1,g:.09019607,b:.4059771},_colorRight:{r:.8018868,g:0,b:.7517689},_envColorLeft:{r:.7843137,g:.1254902,b:.5010797},_envColorRight:{r:.6941177,g:.1254902,b:.8666667},_envColorLeftBoost:{r:.9019608,g:.5411765,b:1},_envColorRightBoost:{r:.3490196,g:.8078431,b:1},_obstacleColor:{r:.6698113,g:.1800908,b:.5528399}},Kaleidoscope:{_colorLeft:{r:.65882355,g:.1254902,b:.1254902},_colorRight:{r:.28235295,g:.28235295,b:.28235295},_envColorLeft:{r:.65882355,g:.1254902,b:.1254902},_envColorRight:{r:.47058824,g:.47058824,b:.47058824},_envColorLeftBoost:{r:.50196081,g:0,b:0},_envColorRightBoost:{r:.49244517,g:0,b:.53725493},_obstacleColor:{r:.25098041,g:.25098041,b:.25098041}},Interscope:{_colorLeft:{r:.726415,g:.62691,b:.31181},_colorRight:{r:.589571,g:.297888,b:.723},_envColorLeft:{r:.724254,g:.319804,b:.913725},_envColorRight:{r:.764706,g:.758971,b:.913725},_envColorLeftBoost:{r:.792453,g:.429686,b:.429868},_envColorRightBoost:{r:.7038,g:.715745,b:.765},_obstacleColor:{r:.588235,g:.298039,b:.721569}},Skrillex:{_colorLeft:{r:.69803923,g:.14117648,b:.36862746},_colorRight:{r:.32933334,g:.32299998,b:.38},_envColorLeft:{r:.80000001,g:.28000003,b:.58594489},_envColorRight:{r:.06525807,g:.57800001,b:.56867743},_envColorLeftBoost:{r:.81176478,g:.30588236,b:.30588236},_envColorRightBoost:{r:.27843139,g:.80000001,b:.44597632},_obstacleColor:{r:.15686275,g:.60392159,b:.60392159}},"Billie Eilish":{_colorLeft:{r:.80000001,g:.64481932,b:.43200001},_colorRight:{r:.54808509,g:.61276591,b:.63999999},_envColorLeft:{r:.81960785,g:.442,b:.184},_envColorRight:{r:.94117647,g:.70677096,b:.56470591},_obstacleColor:{r:.71325314,g:.56140977,b:.78301889},_envColorLeftBoost:{r:.80000001,g:0,b:0},_envColorRightBoost:{r:.55686277,g:.7019608,b:.77647066}},Spooky:{_colorLeft:{r:.81960785,g:.49807876,b:.27702752},_colorRight:{r:.37894738,g:.35789475,b:.40000001},_envColorLeft:{r:.90196079,g:.23009226,b:0},_envColorRight:{r:.46005884,g:.56889427,b:.92941177},_obstacleColor:{r:.81960791,g:.44313729,b:.18431373},_envColorLeftBoost:{r:.33768433,g:.63207543,b:.33690813},_envColorRightBoost:{r:.60209066,g:.3280082,b:.85849059}},"Glass Desert":{_colorLeft:{r:.6792453,g:.5712628,b:0},_colorRight:{r:.7075472,g:0,b:.5364411},_envColorLeft:{r:.32222217,g:.6111111,b:.75},_envColorRight:{r:.03844783,g:.62239975,b:.90566039},_obstacleColor:{r:.06167676,g:.2869513,b:.3962264}}},Z=t=>t._width>=2||1===t._lineIndex||2===t._lineIndex,W=(t,e,n=0)=>t._time+t._duration>e._time+e._duration+n,J=t=>{var e;return Array.isArray(null===(e=t._customData)||void 0===e?void 0:e._color)},G=t=>{var e,n,r,i,o,a,s,l,c,u;return Array.isArray(null===(e=t._customData)||void 0===e?void 0:e._animation)||"boolean"==typeof(null===(n=t._customData)||void 0===n?void 0:n._fake)||"boolean"==typeof(null===(r=t._customData)||void 0===r?void 0:r._interactable)||Array.isArray(null===(i=t._customData)||void 0===i?void 0:i._localRotation)||"number"==typeof(null===(o=t._customData)||void 0===o?void 0:o._noteJumpMovementSpeed)||"number"==typeof(null===(a=t._customData)||void 0===a?void 0:a._noteJumpStartBeatOffset)||Array.isArray(null===(s=t._customData)||void 0===s?void 0:s._position)||Array.isArray(null===(l=t._customData)||void 0===l?void 0:l._rotation)||Array.isArray(null===(c=t._customData)||void 0===c?void 0:c._scale)||"string"==typeof(null===(u=t._customData)||void 0===u?void 0:u._track)},K=t=>t._width>=1e3||t._type>=1e3||t._lineIndex>3||t._lineIndex<0,X=t=>{const{_notes:e,_obstacles:n}=t;let r=Number.MAX_VALUE;e.length>0&&(r=e[0]._time);const i=(t=>{for(let e=0,n=t.length;e<n;e++)if(Z(t[e]))return t[e]._time;return Number.MAX_VALUE})(n);return Math.min(r,i)},V=t=>{const{_notes:e,_obstacles:n}=t;let r=0;e.length>0&&(r=e[e.length-1]._time);const i=(t=>{let e=0;for(let n=t.length-1;n>=0;n--)Z(t[n])&&(e=Math.max(e,t[n]._time+t[n]._duration));return e})(n);return Math.max(r,i)};class Y{constructor(t,e=10,n=0){this._bpm=t,this._njs=e,this._sdm=n,this.update()}set value(t){this._njs=t,this.update()}get value(){return this._njs}set offset(t){this._sdm=t,this.update()}get offset(){return this._sdm}get hjd(){return this._hjd}get hjdMin(){return Y.HJD_MIN}get reactTime(){return this._reactionTime}get jd(){return this._jd}get jdMin(){return this._jdMin}update(){this._hjd=this.calcHalfJumpDuration(),this._jd=this.calcJumpDistance(),this._jdMin=this.calcJumpDistance(Y.HJD_MIN),this._reactionTime=this.calcReactionTimeFromHJD()}calcHalfJumpDurationRaw(){const t=this._njs*this._njs/this._njs,e=60/this._bpm.value;let n=Y.HJD_START;for(;t*e*n>18;)n/=2;return n<1&&(n=1),n}calcHalfJumpDuration(t=this.offset){return Math.max(this.calcHalfJumpDurationRaw()+t,Y.HJD_MIN)}calcHalfJumpDurationFromJD(t=this.calcJumpDistance()){return t/(60/this._bpm.value*this._njs*2)}calcHalfJumpDurationFromRT(t=this.calcReactionTimeFromHJD()){return t/(60/this._bpm.value)}calcJumpDistance(t=this.calcHalfJumpDuration()){return this._njs*(60/this._bpm.value)*t*2}calcJumpDistanceOptimalHigh(){return 18*Math.pow(1/1.07,this._njs)+18}calcJumpDistanceOptimalLow(){return-18/(this._njs+1)+18}calcReactionTimeFromJD(t=this.calcJumpDistance()){return t/(2*this._njs)}calcReactionTimeFromHJD(t=this.calcHalfJumpDuration()){return 60/this._bpm.value*t}calcDistance(t){return 60*this._njs/this._bpm.value*t*2}}Y.HJD_START=4,Y.HJD_MIN=.25;const Q=(t,e=10,n=0)=>new Y(t,e,n);var tt,et,nt,rt;!function(t){t[t.ExpertPlus=16]="ExpertPlus",t[t.Expert=12]="Expert",t[t.Hard=10]="Hard",t[t.Normal=10]="Normal",t[t.Easy=10]="Easy"}(tt||(tt={})),function(t){t._childrenTracks="Ct",t._color="C",t._definitePosition="Dp",t._dissolve="D",t._dissolveArrow="Da",t._duration="Dur",t._easing="E",t._interactable="I",t._localRotation="Lr",t._parentTrack="Pt",t._position="P",t._rotation="R",t._scale="S",t._time="T",t._track="Tr"}(et||(et={})),function(t){t.audio="Audio",t.imageCover="Cover Image",t.imageContributor="Contributor Image"}(nt||(nt={})),function(t){t.info="Information",t.tools="Tools",t.stats="Stats",t.settings="Settings"}(rt||(rt={}));const it={_load:{audio:!0,imageCover:!0,imageContributor:!0},_sorting:!0,_beatNumbering:"beattime",_rounding:3,_theme:"Dark",_onLoad:{stats:!1},_show:{info:!1,tools:!1,stats:!1,settings:!1}},ot=new class{constructor(){this._property=JSON.parse(JSON.stringify(it)),this.stringify=()=>JSON.stringify({_property:this._property}),this.init=()=>{var t;if(null==localStorage)return;const e=localStorage.getItem("settings");if(e){const n=JSON.parse(e);this._property=null!==(t=n._property)&&void 0!==t?t:this._property,this.save()}},this.save=()=>{localStorage&&localStorage.setItem("settings",this.stringify())},this.clear=()=>{localStorage&&localStorage.clear()},this.reset=()=>{this._property=JSON.parse(JSON.stringify(it))},this.init()}get load(){return this._property._load}get sorting(){return this._property._sorting}set sorting(t){this._property._sorting=t}get beatNumbering(){return this._property._beatNumbering}set beatNumbering(t){this._property._beatNumbering=t}get rounding(){return this._property._rounding}set rounding(t){this._property._rounding=t}get theme(){return this._property._theme}set theme(t){this._property._theme=t}get onLoad(){return this._property._onLoad}get show(){return this._property._show}},at=t=>{const{_notes:e,_obstacles:n,_events:r,_waypoints:i}=t;return e.forEach((t=>{for(const e in t)if(null===t[e])throw new Error("contain null value in _notes object")})),n.forEach((t=>{for(const e in t)if(null===t[e])throw new Error("contain null value in _obstacles object")})),r.forEach((t=>{for(const e in t)if(null===t[e])throw new Error("contain null value in _events object")})),null==i||i.forEach((t=>{for(const e in t)if(null===t[e])throw new Error("contain null value in _waypoints object")})),ot.sorting&&(e.sort(((t,e)=>t._time-e._time)),n.sort(((t,e)=>t._time-e._time)),r.sort(((t,e)=>t._time-e._time)),null==i||i.sort(((t,e)=>t._time-e._time))),t},st=[0,180,270,90,315,45,225,135,0],lt=[1,0,3,2,7,6,5,4,8],ct={0:[0,1],1:[0,-1],2:[-1,0],3:[1,0],4:[-1,1],5:[1,1],6:[-1,-1],7:[1,-1],8:[0,0]},ut=(t,e)=>Math.max(Math.abs(t._lineIndex-e._lineIndex),Math.abs(t._lineLayer-e._lineLayer)),dt=t=>0===t._type||1===t._type,ht=(t,e)=>{var n,r;return(null===(n=t._customData)||void 0===n?void 0:n._position)&&(null===(r=e._customData)||void 0===r?void 0:r._position)?t._customData._position[1]-e._customData._position[1]==0:t._lineIndex-e._lineIndex==0},pt=(t,e)=>{var n,r;return(null===(n=t._customData)||void 0===n?void 0:n._position)&&(null===(r=e._customData)||void 0===r?void 0:r._position)?t._customData._position[0]-e._customData._position[0]==0:t._lineLayer-e._lineLayer==0},mt=(t,e)=>{var n,r;return(null===(n=t._customData)||void 0===n?void 0:n._position)&&(null===(r=e._customData)||void 0===r?void 0:r._position)?Math.abs(t._customData._position[1]-e._customData._position[1])===Math.abs(t._customData._position[0]-e._customData._position[0]):Math.abs(t._lineIndex-e._lineIndex)===Math.abs(t._lineLayer-e._lineLayer)},_t=(t,e)=>{var n,r;return(null===(n=t._customData)||void 0===n?void 0:n._position)&&(null===(r=e._customData)||void 0===r?void 0:r._position)?t._customData._position[1]===e._customData._position[1]&&t._customData._position[0]===e._customData._position[0]:t._lineLayer===e._lineLayer&&t._lineIndex===e._lineIndex},ft=(t,e,n)=>{for(let r=n,i=e.length;r<i;r++){if(e[r]._time<t._time+.01&&e[r]._type!==t._type)return!0;if(e[r]._time>t._time+.01)return!1}return!1},gt=(t,e)=>ut(t,e)>=2,bt=(t,e,n)=>{for(let r=1;r<=n;r++){if(8!==t._cutDirection){let n=t._lineIndex+ct[lt[t._cutDirection]][0]*r,i=t._lineLayer+ct[lt[t._cutDirection]][1]*r;if(e._lineIndex===n&&e._lineLayer===i)return!0}if(8!==e._cutDirection){let n=e._lineIndex+ct[lt[e._cutDirection]][0]*r,i=e._lineLayer+ct[lt[e._cutDirection]][1]*r;if(t._lineIndex===n&&t._lineLayer===i)return!0}}return!1},vt=(t,e,n)=>{if(8===t._cutDirection&&8===e._cutDirection&&8!==n){if(t._lineIndex>e._lineIndex&&(5===n||3===n||7===n))return!0;if(t._lineIndex<e._lineIndex&&(6===n||2===n||4===n))return!0;if(t._lineLayer>e._lineLayer&&(4===n||0===n||5===n))return!0;if(t._lineLayer<e._lineLayer&&(6===n||1===n||7===n))return!0}if(t._lineIndex>e._lineIndex){if(5===t._cutDirection||3===t._cutDirection||7===t._cutDirection)return!0;if((5===e._cutDirection||3===e._cutDirection||7===e._cutDirection)&&8===t._cutDirection)return!0}if(t._lineIndex<e._lineIndex){if(6===t._cutDirection||2===t._cutDirection||4===t._cutDirection)return!0;if((6===e._cutDirection||2===e._cutDirection||4===e._cutDirection)&&8===t._cutDirection)return!0}if(t._lineLayer>e._lineLayer){if(4===t._cutDirection||0===t._cutDirection||5===t._cutDirection)return!0;if((4===e._cutDirection||0===e._cutDirection||5===e._cutDirection)&&8===t._cutDirection)return!0}if(t._lineLayer<e._lineLayer){if(6===t._cutDirection||1===t._cutDirection||7===t._cutDirection)return!0;if((6===e._cutDirection||1===e._cutDirection||7===e._cutDirection)&&8===t._cutDirection)return!0}return!1},yt=(t,e)=>{if(vt(t,e,8))return 8===t._cutDirection?e._cutDirection:t._cutDirection;if(8!==t._cutDirection)return t._cutDirection;if(t._time>e._time){if(t._lineIndex>e._lineIndex&&pt(t,e))return 3;if(t._lineIndex<e._lineIndex&&pt(t,e))return 2;if(t._lineLayer>e._lineLayer){if(ht(t,e))return 0;if(t._lineIndex>e._lineIndex)return 5;if(t._lineIndex<e._lineIndex)return 4}if(t._lineLayer<e._lineLayer){if(ht(t,e))return 1;if(t._lineIndex>e._lineIndex)return 7;if(t._lineIndex<e._lineIndex)return 6}}return 8},wt=t=>t._cutDirection>=1e3||t._lineIndex>3||t._lineIndex<0||t._lineLayer>2||t._lineLayer<0,Et=t=>{var e,n,r,i,o,a;const s={red:{total:0,chroma:0,noodleExtensions:0,mappingExtensions:0},blue:{total:0,chroma:0,noodleExtensions:0,mappingExtensions:0},bomb:{total:0,chroma:0,noodleExtensions:0,mappingExtensions:0}};for(let l=t.length-1;l>=0;l--)0===t[l]._type?(s.red.total++,((null===(e=t[l]._customData)||void 0===e?void 0:e._color)||(null===(n=t[l]._customData)||void 0===n?void 0:n._disableSpawnEffect))&&s.red.chroma++):1===t[l]._type?(s.blue.total++,((null===(r=t[l]._customData)||void 0===r?void 0:r._color)||(null===(i=t[l]._customData)||void 0===i?void 0:i._disableSpawnEffect))&&s.blue.chroma++):3===t[l]._type&&(s.bomb.total++,((null===(o=t[l]._customData)||void 0===o?void 0:o._color)||(null===(a=t[l]._customData)||void 0===a?void 0:a._disableSpawnEffect))&&s.bomb.chroma++);return s},kt=(t,e)=>t.filter((t=>t._lineIndex===e)).length,xt=(t,e)=>t.filter((t=>t._lineLayer===e)).length,Ct=(t,e,n)=>t.filter((t=>t._lineIndex===e&&t._lineLayer===n)).length,St=(t,e)=>t.filter((t=>t._cutDirection===e)).length,Tt=(t,e)=>e?t.filter((t=>dt(t))).length/e:0,Lt=(t,e,n)=>{const r=t.filter((t=>0===t._type||1===t._type));let i=0,o=0;for(let t=0;t<r.length;t++){for(;r[t]._time-r[o]._time>e;)o++;i=Math.max(i,(t-o+1)/(e/n*60))}return i},It=t=>{var e;return(null===(e=t._customData)||void 0===e?void 0:e._cutDirection)?t._customData._cutDirection:t._cutDirection>=1e3?t._cutDirection%1e3:st[t._cutDirection]},Dt=(t,e,n,r)=>{let i,o;if("number"==typeof t){if(8===t)return!1;i=st[t]}else{if(8===t._cutDirection)return!1;i=It(t)}if("number"==typeof e){if(8===e)return!1;o=st[e]}else{if(8===e._cutDirection)return!1;o=It(e)}return r?m(i,o,360)<=n:m(i,o,360)>=n};var Rt;!function(t){t[t["Back Lasers"]=0]="Back Lasers",t[t["Ring Lights"]=1]="Ring Lights",t[t["Left Lasers"]=2]="Left Lasers",t[t["Right Lasers"]=3]="Right Lasers",t[t["Center Lights"]=4]="Center Lights",t[t["Light Boost"]=5]="Light Boost",t[t["Extra Left Lights"]=6]="Extra Left Lights",t[t["Extra Right Lights"]=7]="Extra Right Lights",t[t["Ring Rotation"]=8]="Ring Rotation",t[t["Ring Zoom"]=9]="Ring Zoom",t[t["Extra Left Lasers"]=10]="Extra Left Lasers",t[t["Extra Right Lasers"]=11]="Extra Right Lasers",t[t["Left Laser Rotation"]=12]="Left Laser Rotation",t[t["Right Laser Rotation"]=13]="Right Laser Rotation",t[t["Early Lane Rotation"]=14]="Early Lane Rotation",t[t["Late Lane Rotation"]=15]="Late Lane Rotation",t[t["Lower Hydraulic"]=16]="Lower Hydraulic",t[t["Raise Hydraulic"]=17]="Raise Hydraulic",t[t["BPM Change"]=100]="BPM Change"}(Rt||(Rt={}));const At=t=>t._type>=0&&t._type<=17||100===t._type,Nt=t=>t._type>=0&&t._type<=11&&!Mt(t)&&!Bt(t),Bt=t=>5===t._type,Mt=t=>8===t._type||9===t._type,Ot=t=>12===t._type||13===t._type,zt=t=>t._value>=2e9,Pt=t=>{var e;return(14===t._type||15===t._type)&&"number"==typeof(null===(e=t._customData)||void 0===e?void 0:e._rotation)},Ft=t=>(14===t._type||15===t._type)&&t._value>=1e3&&t._value<=1720,jt=[0,1,2,3,4,8,9,12,13],$t={info:[2,0,0],difficulty:[2,5,0]},Ut=t=>[t.r,t.g,t.b],Ht=t=>{let e=t.toString(16);return 1===e.length?"0"+e:e},qt=t=>t>1&&!(t<0)?255:d(255*t),Zt=t=>{if(!t)return null;let e={r:0,g:0,b:0};for(const n in t){let r=t[n];void 0!==r&&(e[n]=qt(r))}return`#${Ht(e.r)}${Ht(e.g)}${Ht(e.b)}${e.a?Ht(e.a):""}`},Wt=t=>{let e,n,r,i=t[0],o=t[1],a=t[2];return i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92,o=o>.04045?Math.pow((o+.055)/1.055,2.4):o/12.92,a=a>.04045?Math.pow((a+.055)/1.055,2.4):a/12.92,e=(.4124*i+.3576*o+.1805*a)/.95047,n=(.2126*i+.7152*o+.0722*a)/1,r=(.0193*i+.1192*o+.9505*a)/1.08883,e=e>.008856?Math.pow(e,1/3):7.787*e+16/116,n=n>.008856?Math.pow(n,1/3):7.787*n+16/116,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,[116*n-16,500*(e-n),200*(n-r)]},Jt=(t,e)=>{let n=0;return t>=0&&0===e?0:t<0&&0===e?180:0===t&&e>0?90:0===t&&e<0?270:(t>0&&e>0&&(n=0),t<0&&(n=180),t>0&&e<0&&(n=360),Math.atan(e/t)*(180/Math.PI)+n)},Gt=(t,e)=>{const[n,r,i]=Wt(t),[o,a,s]=Wt(e);let l,c,u,p,m,_,f,g,b,v,y,w,E,k,x,C,S,T,L,I;return l=Math.sqrt(r*r+i*i),c=Math.sqrt(a*a+s*s),u=(l+c)/2,m=.5*(1-Math.sqrt((7^u)/(30+(7^u)))),b=(1+m)*r,l=Math.sqrt(b*b+i*i),_=Jt(b,i),b=(1+m)*a,c=Math.sqrt(b*b+s*s),f=Jt(b,s),T=o-n,L=c-l,l*c==0?I=0:(b=d(f-_,12),I=Math.abs(b)<=180?f-_:b>180?f-_-360:f-_+360),I=2*Math.sqrt(l*c)*Math.sin(h(I/2)),v=(n+o)/2,p=(l+c)/2,l*c==0?g=_+f:(b=Math.abs(d(_-f,12)),g=b>180?f+_<360?_+f+360:_+f-360:_+f,g/=2),y=1-.17*Math.cos(h(g-30))+.24*Math.cos(h(2*g))+.32*Math.cos(h(3*g+6))-.2*Math.cos(h(4*g-63)),x=30*Math.exp(-(g-275)/25*((g-275)/25)),C=2*Math.sqrt((7^p)/(30+(7^p))),w=1+(v-50)*(v-50)*.015/Math.sqrt(20+(v-50)*(v-50)),E=1+.045*p,k=1+.015*p*y,S=-Math.sin(h(2*x))*C,T/=1*w,L/=1*E,I/=1*k,Math.sqrt(T*T+L*L+I*I+S*L*I)};var Kt,Xt;!function(t){t.tiny="panel--tiny",t.small="panel--small",t.medium="panel--medium",t.large="panel--large",t.max="panel--max"}(Kt||(Kt={})),function(t){t.none="",t.normal="panel--offset",t.half="panel--offset-half"}(Xt||(Xt={}));const Vt=(t,e,n,r)=>{const i=document.createElement("div");return i.className=`panel ${Kt[t]}`,e&&"none"!==e&&i.classList.add(Xt[e]),n&&i.classList.add("-column"),i},Yt={},Qt=()=>{for(const t in Yt)delete Yt[t]},te=Yt,ee=document.querySelector(".info__level-author"),ne=document.querySelector(".info__environment"),re=document.querySelector(".info__editors"),ie=document.querySelector(".info__contributors"),oe=document.querySelector(".info__contributors-select"),ae=document.querySelector(".info__contributors-image"),se=document.querySelector(".info__contributors-name"),le=document.querySelector(".info__contributors-role"),ce=document.querySelector(".info__version"),ue=document.querySelector(".info__time-spend"),de=document.querySelector(".info__custom-color"),he=document.querySelector(".info__requirements"),pe=document.querySelector(".info__suggestions"),me=document.querySelector(".info__information"),_e=document.querySelector(".info__warnings"),fe=document.querySelector(".info__bookmarks"),ge=document.querySelector(".info__bpm-changes"),be=document.querySelector(".info__environment-enhancement"),ve=document.querySelector(".info__point-definitions"),ye=document.querySelector(".info__custom-events");ee&&ne&&re||console.error("UI Info: info component is missing part"),ie&&se&&le||console.error("UI Info: contributors component is missing part"),oe?oe.addEventListener("change",(function(t){if(!te._contributors)return void console.error("UI Info: no saved data for contributors");const e=t.target;xe(te._contributors[parseInt(e.value)])})):console.error("UI Info: contributors select is missing"),ce&&ue&&de&&he&&pe&&me&&_e&&fe&&ge&&be&&ve&&ye||console.error("UI Info: table info component is missing part");const we=t=>{ee?ee.textContent=t?"Mapped by "+t:"":console.error("UI Info: missing HTML element for level author")},Ee=t=>{ne?ne.textContent=t?(U[t]||"Unknown")+" Environment":"":console.error("UI Info: missing HTML element for environment")},ke=t=>{if(!re)return void console.error("UI Info: missing HTML element for editor");if(!t||!t._lastEditedBy)return void re.classList.add("hidden");re.classList.remove("hidden");const e=t._lastEditedBy||"Undefined";let n="Last edited on "+e;t[e]&&(n+=" v"+t[e].version),re.textContent=n},xe=t=>{var e,n;e=t._base64?"data:image;base64,"+t._base64:null,ae?ae.src=e||"./assets/unknown.jpg":console.error("UI Info: missing HTML element for contributor image"),n=t._name,se?se.textContent=n:console.error("UI Info: missing HTML element for contributor name"),(t=>{le?le.textContent=t:console.error("UI Info: missing HTML element for contributor role")})(t._role)},Ce=t=>{if(ie&&oe){if(ie&&(!t||!t.length))return ie.classList.add("hidden"),void v(oe);if(t){ie.classList.remove("hidden");let e=!0;t.forEach(((t,n)=>{e&&(e=!1,xe(t));const r=document.createElement("option");r.value=n.toString(),r.text=t._name+" -- "+t._role,oe.add(r)}))}}else console.error("UI Info: missing HTML element for contributor")},Se=t=>{const e=t.querySelector(".info__table-element");e&&(e.innerHTML=""),t.classList.add("hidden")},Te=(t,e)=>{const n=t.querySelector(".info__table-element");if(n){for(;n.firstChild;)n.removeChild(n.firstChild);"string"==typeof e?n.textContent=e:(e.forEach((t=>{if("string"==typeof t){let e=document.createElement("span");e.textContent=t,n.appendChild(e),n.appendChild(document.createElement("br"))}else n.appendChild(t),n.appendChild(document.createElement("br"))})),n.lastChild&&n.removeChild(n.lastChild))}t.classList.remove("hidden")},Le=t=>{ce?null!=t?Te(ce,t):Se(ce):console.error("UI Info: missing table row for time spend")},Ie=t=>{ue?null!=t?Te(ue,u(t)):Se(ue):console.error("UI Info: missing table row for time spend")},De=(t,e)=>{var n,r,i,o,a,s,l,c,u;if(!de)return void console.error("UI Info: missing table row for custom colors");if(!t||!(t._colorLeft||t._colorRight||t._envColorLeft||t._envColorLeftBoost||t._envColorRight||t._envColorRightBoost||t._obstacleColor))return void Se(de);e||(e="DefaultEnvironment");let d={_colorLeft:Zt(null===(n=q[H[e]])||void 0===n?void 0:n._colorLeft)||null,_colorRight:Zt(null===(r=q[H[e]])||void 0===r?void 0:r._colorRight)||null,_envColorLeft:Zt(null===(i=q[H[e]])||void 0===i?void 0:i._envColorLeft)||null,_envColorRight:Zt(null===(o=q[H[e]])||void 0===o?void 0:o._envColorRight)||null,_envColorLeftBoost:Zt(null===(a=q[H[e]])||void 0===a?void 0:a._envColorLeftBoost)||null,_envColorRightBoost:Zt(null===(s=q[H[e]])||void 0===s?void 0:s._envColorRightBoost)||null,_obstacleColor:Zt(null===(l=q[H[e]])||void 0===l?void 0:l._obstacleColor)||null};t._colorLeft&&(d._colorLeft=Zt(t._colorLeft)),t._colorRight&&(d._colorRight=Zt(t._colorRight)),t._envColorLeft?d._envColorLeft=Zt(t._envColorLeft):t._colorLeft&&(d._envColorLeft=Zt(t._colorLeft)),t._envColorRight?d._envColorRight=Zt(t._envColorRight):t._colorRight&&(d._envColorRight=Zt(t._colorRight));let h,p,m=!1;t._envColorLeftBoost?(h=Zt(t._envColorLeftBoost),m=!0):h=Zt(null===(c=q[H[e]])||void 0===c?void 0:c._envColorLeftBoost)||d._envColorLeft,t._envColorRightBoost?(p=Zt(t._envColorRightBoost),m=!0):p=Zt(null===(u=q[H[e]])||void 0===u?void 0:u._envColorRightBoost)||d._envColorRight,m&&(d._envColorLeftBoost=h,d._envColorRightBoost=p),t._obstacleColor&&(d._obstacleColor=Zt(t._obstacleColor));const _=Vt("max","none",!0);for(const t in d){if(!d[t])continue;const e=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div"),i=document.createElement("div");n.className="info__color-dot",n.style.backgroundColor=d[t]||"#000000",r.className="info__color-text info__color-text--monospace",r.textContent=`${d[t]}`,i.className="info__color-text",i.textContent=` -- ${$[t]}`,e.appendChild(n),e.appendChild(r),e.appendChild(i),_.appendChild(e)}Te(de,[_])},Re=t=>{he?null!=t&&t.length?Te(he,t.join(", ")):Se(he):console.error("UI Info: missing table row for requirements")},Ae=t=>{pe?null!=t&&t.length?Te(pe,t.join(", ")):Se(pe):console.error("UI Info: missing table row for suggestions")},Ne=t=>{me?null!=t&&t.length?Te(me,t):Se(me):console.error("UI Info: missing table row for information")},Be=t=>{_e?null!=t&&t.length?Te(_e,t):Se(_e):console.error("UI Info: missing table row for warnings")},Me=(t,e)=>{if(!fe)return void console.error("UI Info: missing table row for bookmarks");if(null==t||!t.length)return void Se(fe);const n=t.map((t=>{let n,r=t._time;return e&&(r=e.adjustTime(r),n=e.toRealTime(r)),`${d(t._time,3)}${n?" | "+u(n):""} -- ${""!==t._name?t._name:"**EMPTY NAME**"}`}));Te(fe,n)},Oe=t=>{if(!ge)return void console.error("UI Info: missing table row for bookmarks");if(!t||!t.change.length)return void Se(ge);const e=t.change.map((e=>{let n=d(e._newTime,3),r=t.toRealTime(e._time);return`${n} | ${u(r)} -- ${e._BPM}`}));Te(ge,e)},ze=t=>{if(!be)return void console.error("UI Info: missing table row for environment enhancement");if(null==t||!t.length)return void Se(be);const e=t.map((t=>{let e=[];for(const n in t){if("_lookupMethod"==n||"_id"==n)continue;let r=P[n];null!=t[n]&&e.push(r)}return`${t._lookupMethod} [${e.join("")}]${t._track?`(${t._track})`:""} -> ${t._id}`}));Te(be,e)},Pe=t=>{if(!ve)return void console.error("UI Info: missing table row for point definitions");if(null==t||!t.length)return void Se(ve);const e=t.map((t=>`${t._name} -- ${t._points.length} point${t._points.length>1?"s":""}`));Te(ve,e)},Fe=(t,e)=>{if(!ye)return void console.error("UI Info: missing table row for custom events");if(null==t||!t.length)return void Se(ye);const n=t.map((t=>{let n,r=t._time;e&&(r=e.adjustTime(r),n=e.toRealTime(r));let i=[];for(const e in t._data){if("_duration"==e||"_easing"==e||"_track"==e)continue;let n=et[e];null!=t._data[e]&&i.push(n)}return`${d(t._time,3)}${n?" | "+u(n):""} -- ${t._type} -> [${i.join("")}]${t._data._track?`(${t._data._track})`:""}`}));Te(ye,n)},je=t=>{var e,n,r;if(Le(t._data._version),(null===(e=t._info)||void 0===e?void 0:e._customData)&&(De(t._info._customData),Re(t._info._customData._requirements),Ae(t._info._customData._suggestions),Ne(t._info._customData._information),Be(t._info._customData._warnings)),null===(n=t._data)||void 0===n?void 0:n._customData){const e=(null===(r=te._mapInfo)||void 0===r?void 0:r._beatsPerMinute)?M(te._mapInfo._beatsPerMinute,t._data._customData._bpmChanges||t._data._customData._BPMChanges):null;Ie(t._data._customData._time),Me(t._data._customData._bookmarks,e),Oe(e),ze(t._data._customData._environment),Pe(t._data._customData._pointDefinitions),Fe(t._data._customData._customEvents,e)}},$e=document.querySelector(".loading__bar"),Ue="loading__bar--error",He="loading__bar--download",qe=document.querySelector(".loading__text");$e&&qe||console.error("UI Loading: loading component is missing part");const Ze=(t,e,n=100)=>{$e&&qe?(qe.textContent=e,$e.style.width=`${n}%`,"error"===t?$e.classList.add(Ue):$e.classList.remove(Ue),"download"===t?$e.classList.add(He):$e.classList.remove(He)):console.error("UI Loading: could not process, missing HTML element")};var We=n(733),Je=n.n(We);const Ge={loading:!1,map:{load:{image:!1,audio:!1}}},Ke={name:"Cover Image",description:"Placeholder",type:"general",order:{input:0,output:0},input:{enabled:!0,params:{}},output:{html:null},run:function(){const t=new Image,e=k?k.src:(console.error("UI Header: missing HTML element for cover image"),null),n=[];if(Ge.map.load.image&&null!==e?(t.src=e,t.width!==t.height&&n.push("<b>Cover image is not square:</b> resize to fit square"),(t.width<256||t.height<256)&&n.push("<b>Cover image is too small:</b> require at least 256x256")):n.push("<b>No cover image:</b> "+(ot.load.imageCover?"could not be loaded or found":"no cover image option is enabled")),n.length){const t=document.createElement("div");t.innerHTML=n.join("<br>"),Ke.output.html=t}else Ke.output.html=null}},Xe=Ke,Ve={name:"Preview Time",description:"Placeholder",type:"general",order:{input:0,output:0},input:{enabled:!0,params:{}},output:{html:null},run:function(t){const{_audioDuration:e}=t,n=document.createElement("div");e&&e<20?(n.innerHTML=`<b>Unrankable audio length:</b> too short (${u(e)}s)`,Ve.output.html=n):Ge.map.load.audio?Ve.output.html=null:(n.innerHTML="<b>No audio:</b> "+(ot.load.audio?"could not be loaded or not found":"no audio mode is enabled"),Ve.output.html=n)}},Ye=Ve,Qe={name:"Preview Time",description:"Placeholder",type:"general",order:{input:0,output:0},input:{enabled:!0,params:{}},output:{html:null},run:function(t,e,n){if(!n)throw new Error("something went wrong!");const{_previewStartTime:r,_previewDuration:i}=n;if(12===r&&10===i){const t=document.createElement("div");t.innerHTML="<b>Default preview time:</b> strongly recommended to set for audience's 1st impression",Qe.output.html=t}else Qe.output.html=null}},tn=Qe,en=(t,e,n,r)=>{if(r&&r.length>0&&n.toRealTime(e._time)+.005<n.toRealTime(t._time)&&8!==t._cutDirection)for(const e of r)if(8!==e._cutDirection&&Dt(t,e,90,!1))return!0;if(r&&r.length>0)for(const e of r)if(Math.max(Math.abs(e._lineIndex-t._lineIndex),Math.abs(e._lineLayer-t._lineLayer))<1)return!0;return gt(t,e)&&n.toRealTime(t._time-e._time)>.08||n.toRealTime(t._time-e._time)>.07},nn=(t,e,n)=>n/(2*(t._time-e._time)),rn=(t,e)=>{let n=[];const r={},i={0:[],1:[]};for(let o=0,a=t.length;o<a;o++){if(!dt(t[o]))continue;const a=JSON.parse(JSON.stringify(t[o]));r[a._type]&&en(a,r[a._type],e,i[a._type])&&(a._ebpm=nn(a,r[a._type],e.value),n.push(a),i[a._type]=[]),r[a._type]=a,i[a._type].push(a)}return n},on=(t,e)=>{let n=[];const r={},i={0:[],1:[]};for(let o=0,a=t.length;o<a;o++){if(!dt(t[o]))continue;const a=JSON.parse(JSON.stringify(t[o]));r[a._type]?en(a,r[a._type],e,i[a._type])&&(a._ebpm=nn(a,r[a._type],e.value),n.push(a),r[a._type]=a,i[a._type]=[]):r[a._type]=a,i[a._type].push(a)}return n},an=(t,e)=>e.toRealTime(Math.max(...t.map(((e,n)=>(t[n]._time-t[Math.max(n-1,0)]._time)/(n?ut(t[n],t[n-1]):1))))),sn=(t,e)=>e.toRealTime(Math.min(...t.map(((e,n)=>0===n?Number.MAX_SAFE_INTEGER:(t[n]._time-t[Math.max(n-1,0)]._time)/(n?ut(t[n],t[n-1]):1))))),ln=(t,e)=>{let n=[];const r={},i={0:[],1:[]};for(let o=0,a=t.length;o<a;o++){if(!dt(t[o]))continue;const a=JSON.parse(JSON.stringify(t[o]));if(a._minSpeed=0,a._maxSpeed=Number.MAX_SAFE_INTEGER,r[a._type]){if(en(a,r[a._type],e,i[a._type])){let t=an(i[a._type],e),o=sn(i[a._type],e);t>0&&o!==1/0&&(r[a._type]._minSpeed=t,r[a._type]._maxSpeed=o,n.push(r[a._type])),r[a._type]=a,i[a._type]=[]}}else r[a._type]=a;i[a._type].push(a)}for(let t=0;t<2;t++)if(r[t]){let o=an(i[t],e),a=sn(i[t],e);o>0&&a!==1/0&&(r[t]._minSpeed=o,r[t]._maxSpeed=a,n.push(r[t]))}return n},cn=(t,e)=>{if(!t.length)return 0;if(t.length<e)return t.reduce(((t,e)=>t+e))/t.length;let n=t.slice(0,e).reduce(((t,e)=>t+e)),r=n;for(let i=0;i<t.length-e;i++)n=n-t[i]+t[i+e],r=Math.max(r,n);return r/e},un=(t,e)=>{const n=10,r={red:{overall:0,peak:0,median:0,total:0},blue:{overall:0,peak:0,median:0,total:0},total:{overall:0,peak:0,median:0,total:0}},i=Math.max(e.toRealTime(V(t._data)-X(t._data)),0),o=Math.max(e.toRealTime(V(t._data)),0),a=((t,e,n)=>{const r={left:new Array(Math.floor(e+1)).fill(0),right:new Array(Math.floor(e+1)).fill(0)};let i,o;for(let e=0,a=t.length;e<a;e++){const a=t[e],s=n.toRealTime(a._time);0===a._type&&(i?en(a,i,n)&&r.left[Math.floor(s)]++:r.left[Math.floor(s)]++,i=a),1===a._type&&(o?en(a,o,n)&&r.right[Math.floor(s)]++:r.right[Math.floor(s)]++,o=a)}return r})(t._data._notes,o,e),s=a.left.map(((t,e)=>t+a.right[e]));if(0===s.reduce(((t,e)=>t+e)))return r;const l=[],c=[],u=[];for(let t=0,e=Math.ceil(s.length/n);t<e;t++){const e=t*n;let r=n;r+e>s.length&&(r=s.length-e);const i=a.left.slice(e,e+r),o=a.right.slice(e,e+r),d=s.slice(e,e+r);l.push(i.reduce(((t,e)=>t+e))/r),c.push(o.reduce(((t,e)=>t+e))/r),u.push(d.reduce(((t,e)=>t+e))/r)}return r.red.total=a.left.reduce(((t,e)=>t+e)),r.red.overall=a.left.reduce(((t,e)=>t+e))/i,r.red.peak=cn(a.left,n),r.red.median=_(l),r.blue.total=a.right.reduce(((t,e)=>t+e)),r.blue.overall=a.right.reduce(((t,e)=>t+e))/i,r.blue.peak=cn(a.right,n),r.blue.median=_(c),r.total.total=r.red.total+r.blue.total,r.total.overall=s.reduce(((t,e)=>t+e))/i,r.total.peak=cn(s,n),r.total.median=_(u),r},dn=t=>{let e=Number.MAX_SAFE_INTEGER;return t.forEach((t=>{const n=t.sps.total.overall;n>0&&(e=Math.min(e,n))})),e},hn={name:"Progression",description:"Placeholder",type:"general",order:{input:0,output:0},input:{enabled:!0,params:{}},output:{html:null},run:function(t,e,n,r){const{_audioDuration:i}=t;if(!i)return void(hn.output.html=null);if(!r)throw new Error("no sps");const o=r.filter((t=>"Standard"===t.mode)).sort(((t,e)=>t.sps.total.overall-e.sps.total.overall));if(!o.length)return void(hn.output.html=null);const a=i<120?3.2:i<240?4.2:5.2,s=[];i<240&&dn(o)>a&&(t=>{let e=0,n=Number.MAX_SAFE_INTEGER;return t.forEach((t=>{const r=t.sps.total.overall;r>0&&(e=Math.max(e,r),n=Math.min(n,r))})),e||e&&n?100*(1-n/e):0})(o)<60&&s.push(`<b>Minimum SPS not met (<${a}):</b> lowest is ${d(dn(o),2)}`);const l=((t,e)=>{let n=0,r=0;for(const i of t){const t=i.sps.total.overall;if(r>0&&t>0&&(n=100*(1-r/t)),r=t>0?t:r,r>e&&n>40)return i}return null})(o,a),c=((t,e)=>{let n=Number.MAX_SAFE_INTEGER,r=0;for(const i of t){const t=i.sps.total.overall;if(r>0&&t>0&&(n=100*(1-r/t)),r=t>0?t:r,r>e&&n<10)return i}return null})(o,a);if(l&&i<360&&s.push(`<b>Violates progression:</b> ${l.difficulty} exceeded 40% SPS drop`),c&&i<360&&s.push(`<b>Violates progression:</b> ${c.difficulty} has less than 10% SPS drop`),s.length){const t=document.createElement("div");t.innerHTML=s.join("<br>"),hn.output.html=t}else hn.output.html=null}},pn=hn,mn=document.createElement("div"),_n=document.createElement("input"),fn=document.createElement("label"),gn=document.createElement("input"),bn=document.createElement("label");fn.textContent="Effective BPM threshold: ",fn.htmlFor="input__tools-ebpm",_n.id="input__tools-ebpm",_n.className="input-toggle input--small",_n.type="number",_n.min="0",_n.value=450..toString(),_n.addEventListener("change",(function(){vn.input.params.ebpmThres=d(Math.abs(parseFloat(this.value)),1),this.value=vn.input.params.ebpmThres.toString()})),bn.textContent=" (swing): ",bn.htmlFor="input__tools-ebpms",gn.id="input__tools-ebpms",gn.className="input-toggle input--small",gn.type="number",gn.min="0",gn.value=350..toString(),gn.addEventListener("change",(function(){vn.input.params.ebpmsThres=d(Math.abs(parseFloat(this.value)),1),this.value=vn.input.params.ebpmsThres.toString()})),mn.appendChild(fn),mn.appendChild(_n),mn.appendChild(bn),mn.appendChild(gn);const vn={name:"Effective BPM",description:"Placeholder",type:"note",order:{input:0,output:100},input:{enabled:!0,params:{ebpmThres:450,ebpmsThres:350},html:mn,adjustTime:function(t){vn.input.params.ebpmThres=d(Math.min(450,2*t.value*1.285714),1),vn.input.params.ebpmsThres=d(Math.min(350,2*t.value),1),_n.value=vn.input.params.ebpmThres.toString(),gn.value=vn.input.params.ebpmsThres.toString()}},output:{html:null},run:function(t,e){if(!e)throw new Error("something went wrong!");const n=function(t,e){const{_bpm:n}=t,{_notes:r}=e._data,{ebpmThres:i,ebpmsThres:o}=vn.input.params;return{base:rn(r,n).filter((t=>t._ebpm>i)).map((t=>t._time)),swing:on(r,n).filter((t=>t._ebpm>o)).map((t=>t._time))}}(t,e),{ebpmThres:r,ebpmsThres:i}=vn.input.params,o=[];if(n.base.length&&o.push(`<b>>${r}EBPM warning [${n.base.length}]:</b> ${n.base.map((e=>d(t._bpm.adjustTime(e),3))).join(", ")}`),n.swing.length&&o.push(`<b>>${i}EBPM (swing) warning [${n.swing.length}]:</b> ${n.swing.map((e=>d(t._bpm.adjustTime(e),3))).join(", ")}`),o.length){const t=document.createElement("div");t.innerHTML=o.join("<br>"),vn.output.html=t}else vn.output.html=null}},yn=vn,wn=[4,3],En=document.createElement("div"),kn=document.createElement("input"),xn=document.createElement("label");xn.textContent="Acceptable beat precision: ",xn.htmlFor="input__tools-prec",kn.id="input__tools-prec",kn.className="input-toggle input--small",kn.type="text",kn.value=wn.join(" "),kn.addEventListener("change",(function(){Cn.input.params.prec=this.value.trim().split(" ").map((t=>parseInt(t))).filter((t=>t>0&&!Number.isNaN(t))),this.value=Cn.input.params.prec.join(" ")})),En.appendChild(xn),En.appendChild(kn);const Cn={name:"Acceptable Beat Precision",description:"Placeholder",type:"note",order:{input:10,output:110},input:{enabled:!0,params:{prec:[...wn]},html:En},output:{html:null},run:function(t,e){if(!e)throw new Error("something went wrong!");const n=function(t,e){const{_bpm:n}=t,{_notes:r}=e._data,{prec:i}=Cn.input.params;return on(r,n).map((t=>t._time)).filter(((t,e,n)=>!e||t!==n[e-1])).filter((t=>{if(!i.length)return!1;for(let e=0;e<i.length;e++)if((n.adjustTime(t)+.001)%(1/i[e])<.01)return!1;return!0}))}(t,e);if(n.length){const e=document.createElement("div");e.innerHTML=`<b>Off-beat precision [${n.length}]:</b> ${n.map((e=>d(t._bpm.adjustTime(e),3))).join(", ")}`,Cn.output.html=e}else Cn.output.html=null}},Sn=Cn,Tn=document.createElement("div"),Ln=document.createElement("input"),In=document.createElement("label");In.textContent=" Varying swing speed",In.htmlFor="input__tools-vary-swing-check",Ln.id="input__tools-vary-swing-check",Ln.className="input-toggle",Ln.type="checkbox",Ln.checked=!0,Ln.addEventListener("change",(function(){Dn.input.enabled=this.checked})),Tn.appendChild(Ln),Tn.appendChild(In);const Dn={name:"Varying Swing Speed",description:"Placeholder",type:"note",order:{input:20,output:130},input:{enabled:Ln.checked,params:{},html:Tn},output:{html:null},run:function(t,e){if(!e)throw new Error("something went wrong!");const n=function(t,e){const{_bpm:n}=t,{_notes:r}=e._data;return ln(r,n).filter((t=>Math.abs(t._minSpeed-t._maxSpeed)>.002)).map((t=>t._time)).filter(((t,e,n)=>!e||t!==n[e-1]))}(t,e);if(n.length){const e=document.createElement("div");e.innerHTML=`<b>Varying swing speed [${n.length}]:</b> ${n.map((e=>d(t._bpm.adjustTime(e),3))).join(", ")}`,Dn.output.html=e}else Dn.output.html=null}},Rn=Dn,An=document.createElement("div"),Nn=document.createElement("input"),Bn=document.createElement("label"),Mn=document.createElement("input"),On=document.createElement("label"),zn=document.createElement("input"),Pn=document.createElement("label");let Fn;Bn.textContent=" Slow slider",Bn.htmlFor="input__tools-slow-slider-check",Nn.id="input__tools-slow-slider-check",Nn.className="input-toggle",Nn.type="checkbox",Nn.checked=!0,Nn.addEventListener("change",(function(){jn.input.enabled=this.checked})),On.textContent="min speed (ms): ",On.htmlFor="input__tools-slow-slider-time",Mn.id="input__tools-slow-slider-time",Mn.className="input-toggle input--small",Mn.type="number",Mn.min="0",Mn.value=d(25,1).toString(),Mn.addEventListener("change",(function(){jn.input.params.minSpeed=Math.abs(parseFloat(this.value))/1e3,this.value=d(1e3*jn.input.params.minSpeed,1).toString(),Fn&&(zn.value=d(1/Fn.toBeatTime(jn.input.params.minSpeed),2).toString())})),Pn.textContent=" (prec): ",Pn.htmlFor="input__tools-slow-slider-prec",zn.id="input__tools-slow-slider-prec",zn.className="input-toggle input--small",zn.type="number",zn.min="0",zn.addEventListener("change",(function(){if(!Fn)return void(this.value="0");let t=d(Math.abs(parseFloat(this.value)),2)||1;jn.input.params.minSpeed=Fn.toRealTime(1/t),Mn.value=d(1e3*jn.input.params.minSpeed,1).toString(),this.value=t.toString()})),An.appendChild(Nn),An.appendChild(Bn),An.appendChild(document.createElement("br")),An.appendChild(On),An.appendChild(Mn),An.appendChild(Pn),An.appendChild(zn);const jn={name:"Slow Slider",description:"Placeholder",type:"note",order:{input:21,output:120},input:{enabled:Nn.checked,params:{minSpeed:.025},html:An,adjustTime:function(t){Fn=t,zn.value=d(1/Fn.toBeatTime(jn.input.params.minSpeed),2).toString()}},output:{html:null},run:function(t,e){if(!e)throw new Error("something went wrong!");const{minSpeed:n}=jn.input.params,r=function(t,e){const{_bpm:n}=t,{_notes:r}=e._data,{minSpeed:i}=jn.input.params;return ln(r,n).filter((t=>t._maxSpeed>i||t._minSpeed>i)).map((t=>t._time)).filter(((t,e,n)=>!e||t!==n[e-1]))}(t,e);if(r.length){const e=document.createElement("div");e.innerHTML=`<b>Slow slider (>${d(1e3*n,1)}ms) [${r.length}]:</b> ${r.map((e=>d(t._bpm.adjustTime(e),3))).join(", ")}`,jn.output.html=e}else jn.output.html=null}},$n=jn;let Un;const Hn=document.createElement("div"),qn=document.createElement("input"),Zn=document.createElement("label"),Wn=document.createElement("input"),Jn=document.createElement("label"),Gn=document.createElement("input"),Kn=document.createElement("label");Zn.textContent=" Inline sharp angle",Zn.htmlFor="input__tools-inline-angle-check",qn.id="input__tools-inline-angle-check",qn.className="input-toggle",qn.type="checkbox",qn.checked=!0,qn.addEventListener("change",(function(){Xn.input.enabled=this.checked})),Jn.textContent="max time (ms): ",Jn.htmlFor="input__tools-inline-angle-time",Wn.id="input__tools-inline-angle-time",Wn.className="input-toggle input--small",Wn.type="number",Wn.min="0",Wn.value=d(150,1).toString(),Wn.addEventListener("change",(function(){Xn.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=d(1e3*Xn.input.params.maxTime,1).toString(),Un&&(Gn.value=d(Un.toBeatTime(Xn.input.params.maxTime),2).toString())})),Kn.textContent=" (beat): ",Kn.htmlFor="input__tools-inline-angle-beat",Gn.id="input__tools-inline-angle-beat",Gn.className="input-toggle input--small",Gn.type="number",Gn.min="0",Gn.step="0.1",Gn.addEventListener("change",(function(){if(!Un)return void(this.value="0");let t=d(Math.abs(parseFloat(this.value)),2)||1;Xn.input.params.maxTime=Un.toRealTime(t),Wn.value=d(1e3*Xn.input.params.maxTime,1).toString(),this.value=t.toString()})),Hn.appendChild(qn),Hn.appendChild(Zn),Hn.appendChild(document.createElement("br")),Hn.appendChild(Jn),Hn.appendChild(Wn),Hn.appendChild(Kn),Hn.appendChild(Gn);const Xn={name:"Inline Sharp Angle",description:"Placeholder",type:"note",order:{input:30,output:160},input:{enabled:qn.checked,params:{maxTime:.15},html:Hn,adjustTime:function(t){Un=t,Gn.value=d(Un.toBeatTime(Xn.input.params.maxTime),2).toString()}},output:{html:null},run:function(t,e){if(!e)throw new Error("something went wrong!");const n=function(t,e){const{_bpm:n}=t,{_notes:r}=e._data,{maxTime:i}=Xn.input.params,o=n.toBeatTime(i)+.001,a={},s={},l={},c={0:[],1:[],3:[]},u=[];let d=0,h=0;for(let t=0,e=r.length;t<e;t++){const e=r[t];dt(e)&&a[e._type]?en(e,a[e._type],n,c[e._type])?(l[e._type]&&(l[e._type]=null,s[e._type]=lt[s[e._type]]),Vn(e,r,h,o)&&Dt(e._cutDirection,s[e._type],90,!0)&&u.push(e),8===e._cutDirection?l[e._type]=e:s[e._type]=e._cutDirection,c[e._type]=[]):(l[e._type]&&Vn(e,r,h,o)&&Dt(e._cutDirection,s[e._type],90,!0)&&(u.push(l[e._type]),l[e._type]=null),8!==e._cutDirection&&(s[e._type]=e._cutDirection)):s[e._type]=e._cutDirection,d<e._time-o&&(d=e._time-o,h=t),a[e._type]=e,c[e._type].push(e),3===e._type&&(0===e._lineLayer&&(1===e._lineIndex&&(s[0]=0,l[0]=null),2===e._lineIndex&&(s[1]=0,l[1]=null)),2===e._lineLayer&&(1===e._lineIndex&&(s[0]=1,l[0]=null),2===e._lineIndex&&(s[1]=1,l[1]=null)))}return u.map((t=>t._time)).filter((function(t,e,n){return!e||t!==n[e-1]}))}(t,e);if(n.length){const e=document.createElement("div");e.innerHTML=`<b>Inline sharp angle [${n.length}]:</b> ${n.map((e=>d(t._bpm.adjustTime(e),3))).join(", ")}`,Xn.output.html=e}else Xn.output.html=null}};function Vn(t,e,n,r){for(let i=n;e[i]._time<t._time;i++)if(_t(t,e[i])&&t._time-e[i]._time<=r)return!0;return!1}const Yn=Xn;let Qn;const tr=document.createElement("div"),er=document.createElement("input"),nr=document.createElement("label"),rr=document.createElement("input"),ir=document.createElement("label"),or=document.createElement("input"),ar=document.createElement("label"),sr=document.createElement("input"),lr=document.createElement("label");nr.textContent=" shrado angle",nr.htmlFor="input__tools-shrado-angle-check",er.id="input__tools-shrado-angle-check",er.className="input-toggle",er.type="checkbox",er.checked=!1,er.addEventListener("change",(function(){cr.input.enabled=this.checked})),ir.textContent="min distance: ",ir.htmlFor="input__tools-shrado-angle-distance",rr.id="input__tools-shrado-angle-distance",rr.className="input-toggle input--small",rr.type="number",rr.min="0",rr.value=1..toString(),rr.addEventListener("change",(function(){cr.input.params.distance=Math.max(parseInt(this.value),0),this.value=cr.input.params.distance.toString()})),ar.textContent="max time (ms): ",ar.htmlFor="input__tools-shrado-angle-time",or.id="input__tools-shrado-angle-time",or.className="input-toggle input--small",or.type="number",or.min="0",or.value=d(150,1).toString(),or.addEventListener("change",(function(){cr.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=d(1e3*cr.input.params.maxTime,1).toString(),Qn&&(sr.value=d(Qn.toBeatTime(cr.input.params.maxTime),2).toString())})),lr.textContent=" (beat): ",lr.htmlFor="input__tools-shrado-angle-beat",sr.id="input__tools-shrado-angle-beat",sr.className="input-toggle input--small",sr.type="number",sr.min="0",sr.step="0.1",sr.addEventListener("change",(function(){if(!Qn)return void(this.value="0");let t=d(Math.abs(parseFloat(this.value)),2)||1;cr.input.params.maxTime=Qn.toRealTime(t),or.value=d(1e3*cr.input.params.maxTime,1).toString(),this.value=t.toString()})),tr.appendChild(er),tr.appendChild(nr),tr.appendChild(document.createElement("br")),tr.appendChild(ir),tr.appendChild(rr),tr.appendChild(document.createElement("br")),tr.appendChild(ar),tr.appendChild(or),tr.appendChild(lr),tr.appendChild(sr);const cr={name:"shrado Angle",description:"Placeholder",type:"note",order:{input:40,output:170},input:{enabled:er.checked,params:{distance:1,maxTime:.15},html:tr,adjustTime:function(t){Qn=t,sr.value=d(Qn.toBeatTime(cr.input.params.maxTime),2).toString()}},output:{html:null},run:function(t,e){if(!e)throw new Error("something went wrong!");const n=function(t,e){const{_bpm:n}=t,{_notes:r}=e._data,{maxTime:i,distance:o}=cr.input.params,a=n.toBeatTime(i)+.001,s={},l={},c={},u={0:[],1:[],3:[]},d=[];for(let t=0,e=r.length;t<e;t++){const e=r[t];dt(e)&&s[e._type]?en(e,s[e._type],n,u[e._type])?(c[e._type]&&(c[e._type]=null,l[e._type]=lt[l[e._type]]),ut(e,s[e._type])>=o&&ur(e._cutDirection,l[e._type],e._type)&&e._time-s[e._type]._time<=a&&d.push(e),8===e._cutDirection?c[e._type]=e:l[e._type]=e._cutDirection,u[e._type]=[]):(c[e._type]&&ut(e,s[e._type])>=o&&ur(e._cutDirection,l[e._type],e._type)&&e._time-s[e._type]._time<=a&&(d.push(c[e._type]),c[e._type]=null),8!==e._cutDirection&&(l[e._type]=e._cutDirection)):l[e._type]=e._cutDirection,s[e._type]=e,u[e._type].push(e)}return d.map((t=>t._time)).filter((function(t,e,n){return!e||t!==n[e-1]}))}(t,e);if(n.length){const e=document.createElement("div");e.innerHTML=`<b>shrado angle [${n.length}]:</b> ${n.map((e=>d(t._bpm.adjustTime(e),3))).join(", ")}`,cr.output.html=e}else cr.output.html=null}};function ur(t,e,n){return 8!==t&&8!==e&&(0===n?7===e:6===e)&&0===t}const dr=cr,hr=document.createElement("div"),pr=document.createElement("input"),mr=document.createElement("label"),_r=document.createElement("input"),fr=document.createElement("label"),gr=document.createElement("input"),br=document.createElement("label");let vr;mr.textContent=" Speed pause (EXPERIMENTAL)",mr.htmlFor="input__tools-speed-pause-check",pr.id="input__tools-speed-pause-check",pr.className="input-toggle",pr.type="checkbox",pr.checked=!1,pr.addEventListener("change",(function(){yr.input.enabled=this.checked})),fr.textContent="stream speed (ms): ",fr.htmlFor="input__tools-speed-pause-time",_r.id="input__tools-speed-pause-time",_r.className="input-toggle input--small",_r.type="number",_r.min="0",_r.value=d(75,1).toString(),_r.addEventListener("change",(function(){yr.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=d(1e3*yr.input.params.maxTime,1).toString(),vr&&(gr.value=d(1/vr.toBeatTime(yr.input.params.maxTime),2).toString())})),br.textContent=" (prec): ",br.htmlFor="input__tools-speed-pause-prec",gr.id="input__tools-speed-pause-prec",gr.className="input-toggle input--small",gr.type="number",gr.min="0",gr.addEventListener("change",(function(){if(!vr)return void(this.value="0");let t=d(Math.abs(parseFloat(this.value)),2)||1;yr.input.params.maxTime=vr.toRealTime(1/t),_r.value=d(1e3*yr.input.params.maxTime,1).toString(),this.value=t.toString()})),hr.appendChild(pr),hr.appendChild(mr),hr.appendChild(document.createElement("br")),hr.appendChild(fr),hr.appendChild(_r),hr.appendChild(br),hr.appendChild(gr);const yr={name:"Speed Pause",description:"Placeholder",type:"note",order:{input:50,output:180},input:{enabled:pr.checked,params:{maxTime:.075},html:hr,adjustTime:function(t){vr=t,gr.value=d(1/vr.toBeatTime(yr.input.params.maxTime),2).toString()}},output:{html:null},run:function(t,e){if(!e)throw new Error("something went wrong!");const n=function(t,e){const{_bpm:n}=t,{_notes:r}=e._data,{maxTime:i}=yr.input.params,o=n.toBeatTime(i)+.001,a={},s={},l={0:!1,1:!1,3:!1},c={0:[],1:[],3:[]},u=[];for(let t=0,e=r.length;t<e;t++){const e=r[t];dt(e)&&a[e._type]?en(e,a[e._type],n,c[e._type])&&(e._time-a[e._type]._time<=2*o?(l[0]&&l[1]&&a[e._type]._time-s[e._type]._time<=3*o&&u.push(a[e._type]),l[e._type]=!1):l[e._type]||(l[e._type]=!0,s[e._type]=a[e._type]),c[e._type]=[],a[e._type]=e):a[e._type]=e,c[e._type].push(e)}return u.map((t=>t._time)).filter((function(t,e,n){return!e||t!==n[e-1]}))}(t,e);if(n.length){const e=document.createElement("div");e.innerHTML=`<b>Speed pause [${n.length}]:</b> ${n.map((e=>d(t._bpm.adjustTime(e),3))).join(", ")}`,yr.output.html=e}else yr.output.html=null}},wr=yr,Er=document.createElement("div"),kr=document.createElement("input"),xr=document.createElement("label");xr.textContent=" Hitbox staircase",xr.htmlFor="input__tools-hitbox-stair-check",kr.id="input__tools-hitbox-stair-check",kr.className="input-toggle",kr.type="checkbox",kr.checked=!0,kr.addEventListener("change",(function(){Cr.input.enabled=this.checked})),Er.appendChild(kr),Er.appendChild(xr);const Cr={name:"Hitbox Staircase",description:"Placeholder",type:"note",order:{input:70,output:190},input:{enabled:kr.checked,params:{},html:Er},output:{html:null},run:function(t,e){if(!e)throw new Error("something went wrong!");const n=function(t,e){const{_bpm:n}=t,{_notes:r}=e._data,i=n.toBeatTime(.15),o={},a={},s={},l={0:[],1:[],3:[]},c={0:{_time:0,_type:0,_cutDirection:0,_lineIndex:0,_lineLayer:0},1:{_time:0,_type:1,_cutDirection:0,_lineIndex:0,_lineLayer:0},3:{_time:0,_type:3,_cutDirection:0,_lineIndex:0,_lineLayer:0}},u=[];for(let t=0,e=r.length;t<e;t++){const e=r[t];dt(e)&&o[e._type]?(en(e,o[e._type],n,l[e._type])?(s[e._type]=e._time-o[e._type]._time,8!==e._cutDirection?(c[e._type]._lineIndex=e._lineIndex+ct[e._cutDirection][0],c[e._type]._lineLayer=e._lineLayer+ct[e._cutDirection][1]):(c[e._type]._lineIndex=-1,c[e._type]._lineLayer=-1),l[e._type]=[],a[e._type]=e._cutDirection):vt(e,o[e._type],a[e._type])&&(8!==e._cutDirection?(c[e._type]._lineIndex=e._lineIndex+ct[e._cutDirection][0],c[e._type]._lineLayer=e._lineLayer+ct[e._cutDirection][1],a[e._type]=e._cutDirection):(c[e._type]._lineIndex=e._lineIndex+ct[a[e._type]][0],c[e._type]._lineLayer=e._lineLayer+ct[a[e._type]][1])),o[(e._type+1)%2]&&e._time-o[(e._type+1)%2]._time!=0&&e._time-o[(e._type+1)%2]._time<Math.min(i,s[(e._type+1)%2])&&(e._lineIndex!==c[(e._type+1)%2]._lineIndex||e._lineLayer!==c[(e._type+1)%2]._lineLayer||ft(e,r,t)||u.push(e))):(8!==e._cutDirection?(c[e._type]._lineIndex=e._lineIndex+ct[e._cutDirection][0],c[e._type]._lineLayer=e._lineLayer+ct[e._cutDirection][1]):(c[e._type]._lineIndex=-1,c[e._type]._lineLayer=-1),a[e._type]=e._cutDirection),o[e._type]=e,l[e._type].push(e)}return u.map((t=>t._time)).filter((function(t,e,n){return!e||t!==n[e-1]}))}(t,e);if(n.length){const e=document.createElement("div");e.innerHTML=`<b>Hitbox staircase [${n.length}]:</b> ${n.map((e=>d(t._bpm.adjustTime(e),3))).join(", ")}`,Cr.output.html=e}else Cr.output.html=null}},Sr=Cr,Tr=document.createElement("div"),Lr=document.createElement("input"),Ir=document.createElement("label");Ir.textContent=" Hitbox reverse staircase",Ir.htmlFor="input__tools-hitbox-rstair-check",Lr.id="input__tools-hitbox-rstair-check",Lr.className="input-toggle",Lr.type="checkbox",Lr.checked=!0,Lr.addEventListener("change",(function(){Dr.input.enabled=this.checked})),Tr.appendChild(Lr),Tr.appendChild(Ir);const Dr={name:"Hitbox Reverse Staircase",description:"Placeholder",type:"note",order:{input:71,output:191},input:{enabled:Lr.checked,params:{},html:Tr},output:{html:null},run:function(t,e){if(!e)throw new Error("something went wrong!");const n=function(t,e){const{_bpm:n,_njs:r}=t,{_notes:i}=e._data,o={},a={0:[],1:[],3:[]},s=[];for(let t=0,e=i.length;t<e;t++){const e=i[t];dt(e)&&o[e._type]&&en(e,o[e._type],n,a[e._type])&&(a[e._type]=[]);for(const t of a[(e._type+1)%2])if(8!==t._cutDirection){let i=t._lineIndex+ct[lt[t._cutDirection]][0],o=t._lineLayer+ct[lt[t._cutDirection]][1];if(!(r.value>n.value/(60*(e._time-t._time)))&&e._lineIndex===i&&e._lineLayer===o){s.push(t);break}}o[e._type]=e,a[e._type].push(e)}return s.map((t=>t._time)).filter((function(t,e,n){return!e||t!==n[e-1]}))}(t,e);if(n.length){const e=document.createElement("div");e.innerHTML=`<b>Hitbox reverse staircase [${n.length}]:</b> ${n.map((e=>d(t._bpm.adjustTime(e),3))).join(", ")}`,Dr.output.html=e}else Dr.output.html=null}},Rr=Dr,Ar=document.createElement("div"),Nr=document.createElement("input"),Br=document.createElement("label");Br.textContent=" Hitbox inline",Br.htmlFor="input__tools-hitbox-inline-check",Nr.id="input__tools-hitbox-inline-check",Nr.className="input-toggle",Nr.type="checkbox",Nr.checked=!0,Nr.addEventListener("change",(function(){Mr.input.enabled=this.checked})),Ar.appendChild(Nr),Ar.appendChild(Br);const Mr={name:"Hitbox Inline",description:"Placeholder",type:"note",order:{input:72,output:192},input:{enabled:Nr.checked,params:{},html:Ar},output:{html:null},run:function(t,e){if(!e)throw new Error("something went wrong!");const n=function(t,e){const{_bpm:n,_njs:r}=t,{_notes:i}=e._data,o={},a={0:[],1:[],3:[]},s=[];for(let t=0,e=i.length;t<e;t++){const e=i[t];dt(e)&&o[e._type]&&en(e,o[e._type],n,a[e._type])&&(a[e._type]=[]);for(const t of a[(e._type+1)%2])if(!(r.value>1.425*n.value/(60*(e._time-t._time)))&&e._lineIndex===t._lineIndex&&e._lineLayer===t._lineLayer){s.push(e);break}o[e._type]=e,a[e._type].push(e)}return s.map((t=>t._time)).filter((function(t,e,n){return!e||t!==n[e-1]}))}(t,e);if(n.length){const e=document.createElement("div");e.innerHTML=`<b>Hitbox inline [${n.length}]:</b> ${n.map((e=>d(t._bpm.adjustTime(e),3))).join(", ")}`,Mr.output.html=e}else Mr.output.html=null}},Or=Mr,zr=document.createElement("div"),Pr=document.createElement("input"),Fr=document.createElement("label");Fr.textContent=" Hitbox path",Fr.htmlFor="input__tools-hitbox-path-check",Pr.id="input__tools-hitbox-path-check",Pr.className="input-toggle",Pr.type="checkbox",Pr.checked=!0,Pr.addEventListener("change",(function(){jr.input.enabled=this.checked})),zr.appendChild(Pr),zr.appendChild(Fr);const jr={name:"Hitbox Path",description:"Placeholder",type:"note",order:{input:74,output:190},input:{enabled:Pr.checked,params:{},html:zr},output:{html:null},run:function(t,e){if(!e)throw new Error("something went wrong!");const n=function(t,e){const{_bpm:n,_njs:r}=t,{_notes:i}=e._data,o=[];let a=0;for(let t=0,e=i.length;t<e;t++)if(!(n.toRealTime(i[t]._time)<a+.01||3===i[t]._type))for(let r=t+1;r<e&&!(n.toRealTime(i[r]._time)>n.toRealTime(i[t]._time)+.01);r++)i[t]._type!==i[r]._type&&3!==i[r]._type&&((pt(i[t],i[r])||ht(i[t],i[r]))&&bt(i[t],i[r],2)||mt(i[t],i[r])&&bt(i[t],i[r],1))&&(o.push(i[t]),a=n.toRealTime(i[t]._time));return o.map((t=>t._time)).filter((function(t,e,n){return!e||t!==n[e-1]}))}(t,e);if(n.length){const e=document.createElement("div");e.innerHTML=`<b>Hitbox path [${n.length}]:</b> ${n.map((e=>d(t._bpm.adjustTime(e),3))).join(", ")}`,jr.output.html=e}else jr.output.html=null}},$r=jr,Ur=document.createElement("div"),Hr=document.createElement("input"),qr=document.createElement("label");qr.textContent=" Improper window snap",qr.htmlFor="input__tools-window-snap-check",Hr.id="input__tools-window-snap-check",Hr.className="input-toggle",Hr.type="checkbox",Hr.checked=!0,Hr.addEventListener("change",(function(){Zr.input.enabled=this.checked})),Ur.appendChild(Hr),Ur.appendChild(qr);const Zr={name:"Improper Window Snap",description:"Placeholder",type:"note",order:{input:60,output:185},input:{enabled:Hr.checked,params:{},html:Ur},output:{html:null},run:function(t,e){if(!e)throw new Error("something went wrong!");const n=function(t,e){const{_bpm:n}=t,{_notes:r}=e._data,i={},o={0:[],1:[],3:[]},a=[];for(let t=0,e=r.length;t<e;t++){const e=r[t];dt(e)&&i[e._type]?en(e,i[e._type],n,o[e._type])?(i[e._type]=e,o[e._type]=[]):(s=e,l=i[e._type],gt(s,l)&&!mt(s,l)&&!pt(s,l)&&!ht(s,l)&&e._time-i[e._type]._time>=.001&&e._cutDirection===i[e._type]._cutDirection&&8!==e._cutDirection&&8!==i[e._type]._cutDirection&&a.push(i[e._type])):i[e._type]=e,o[e._type].push(e)}var s,l;return a.map((t=>t._time)).filter((function(t,e,n){return!e||t!==n[e-1]}))}(t,e);if(n.length){const e=document.createElement("div");e.innerHTML=`<b>Improper window snap [${n.length}]:</b> ${n.map((e=>d(t._bpm.adjustTime(e),3))).join(", ")}`,Zr.output.html=e}else Zr.output.html=null}},Wr=Zr;var Jr;!function(t){t.forehand="backhand",t.backhand="forehand"}(Jr||(Jr={}));const Gr={0:{forehand:[1,3,6,7],backhand:[0,2,4,5]},1:{forehand:[1,2,6,7],backhand:[0,3,4,5]}},Kr={0:[0,0,90,90,45,-45,45,-45],1:[0,0,-90,-90,-45,45,-45,45]},Xr={0:{forehand:[180,0,-90,90,-135,135,-45,45],backhand:[0,180,90,-90,45,-45,135,-135]},1:{forehand:[-180,0,-90,90,-135,135,-45,45],backhand:[0,-180,90,-90,45,-45,135,-135]}};class Vr{constructor(t,e,n,r,i,o){this._type=e,this._warningThreshold=n,this._errorThreshold=r,this._allowedRotation=i,o&&"neutral"!==o?(this._state=o,this._rotation=0):(this._state=this.predictStartState(t,e),this._rotation=this.predictStartRotation(t,e)),this._position=this.predictStartPosition(t,e)}get state(){return this._state}get rotation(){return this._rotation}check(t,e){if("neutral"===this._state)return"none";if(!t.length)throw new Error("no notes were given");const n=t[0]._time,r=this._type;let i,o=this._state,a=this._rotation;e.forEach((t=>{t._time-.001>n||(0===t._lineLayer&&t._lineIndex===(r?2:1)&&(o="backhand",a=0),2===t._lineLayer&&t._lineIndex===(r?2:1)&&(o="forehand",a=0))}));let s=8;for(const e of t)8!==e._cutDirection&&(s=e._cutDirection),i&&8===s&&(s=yt(e,i)),i=e;if(8===s)return"none";const l=Xr[r][Jr[o]][s];return(a>l?a-l:l-a)>180||l<Vr.CONSTRAINT_ROTATION[r][0]+this._errorThreshold||l>Vr.CONSTRAINT_ROTATION[r][1]-this._errorThreshold?"error":l<Vr.CONSTRAINT_ROTATION[r][0]+this._warningThreshold||l>Vr.CONSTRAINT_ROTATION[r][1]-this._warningThreshold||(a>l?a-l:l-a)>this._allowedRotation?"warning":"none"}next(t,e){if("error"!==this.check(t,e))switch(this._state){case"forehand":this._state="backhand";break;case"backhand":this._state="forehand";break;case"neutral":for(let e=0;e<t.length;e++){const n=t[e];if(Gr[n._type].forehand.includes(n._cutDirection)){this._state="backhand";break}if(Gr[n._type].backhand.includes(n._cutDirection)){this._state="forehand";break}"neutral"===this._state&&8===n._cutDirection&&(0===n._lineLayer&&(this._state="backhand"),n._lineLayer>0&&(this._state="forehand"))}}if("neutral"===this._state)throw new Error("parity unexpected input");const n=t[0]._time,r=this._type;let i;e.forEach((t=>{t._time-.001>n||(0===t._lineLayer&&t._lineIndex===(r?2:1)&&(this._state="forehand",this._rotation=0),2===t._lineLayer&&t._lineIndex===(r?2:1)&&(this._state="backhand",this._rotation=0))}));let o=8;for(const e of t)8!==e._cutDirection&&(o=e._cutDirection),i&&8===o&&(o=yt(e,i)),i=e;8!==o&&(this._rotation=Xr[this._type][this._state][o])}predictStartState(t,e){let n="neutral";for(let r=0,i=t.length;r<i;r++){let i=t[r];if(i._type!==Math.abs(e-1)&&(3===i._type&&(0===i._lineLayer&&(i._lineIndex===e||2)&&(n="backhand"),2===i._lineLayer&&(i._lineIndex===e||2)&&(n="forehand")),i._type===e)){if("neutral"!==n)break;const e=i._time;for(let o=r;o<t.length&&!(t[o]._time>i._time+.001&&e<i._time+.001);o++){if(i=t[o],Gr[i._type].forehand.includes(i._cutDirection))return"backhand";if(Gr[i._type].backhand.includes(i._cutDirection))return"forehand";"neutral"===n&&8===i._cutDirection&&(0===i._lineLayer&&(n="backhand"),i._lineLayer>0&&(n="forehand"))}break}}return n}predictStartRotation(t,e){let n=0;for(let r=0,i=t.length;r<i;r++){let i=t[r];if(i._type===e&&i._type===e){const e=i._time;for(let o=r;o<t.length&&!(t[o]._time>i._time+.001&&e<i._time+.001);o++){if(i=t[o],8!==i._cutDirection)return Kr[i._type][i._cutDirection];8===i._cutDirection&&(0===i._lineLayer&&(0===i._lineIndex&&(n=Kr[i._type][6]),3===i._lineIndex&&(n=Kr[i._type][7])),1===i._lineLayer&&(0===i._lineIndex&&(n=Kr[i._type][2]),3===i._lineIndex&&(n=Kr[i._type][3])),2===i._lineLayer&&(0===i._lineIndex&&(n=Kr[i._type][4]),3===i._lineIndex&&(n=Kr[i._type][5])))}break}}return n}predictStartPosition(t,e){return e?[-.5,1]:[.5,1]}}Vr.CONSTRAINT_ROTATION=[[-155,195],[-195,155]];const Yr=(t,e,n,r,...i)=>{const o=document.createElement(n);o.className=r;const a=document.createElement("select");a.className="input-toggle",a.id=t,i.forEach((t=>{const e=document.createElement("option");e.textContent=t.text,e.value=t.value,a.append(e)}));const s=document.createElement("label");return s.htmlFor=t,s.innerHTML=`<span>${e}</span>`,o.append(s),o.append(a),o},Qr=document.createElement("div"),ti=document.createElement("input"),ei=document.createElement("label");Yr("input__tools-parity-rotation","Wrist rotation type: ","div","",{text:"Normal",value:"90"},{text:"Extended",value:"135"},{text:"Squid",value:"180"}),Yr("input__tools-parity-left","Left hand parity: ","div","",{text:"Auto",value:"auto"},{text:"Forehand",value:"forehand"},{text:"Backhand",value:"backhand"}),Yr("input__tools-parity-right","Right hand parity: ","div","",{text:"Auto",value:"auto"},{text:"Forehand",value:"forehand"},{text:"Backhand",value:"backhand"}),ei.textContent=" Parity (EXPERIMENTAL)",ei.htmlFor="input__tools-parity-check",ti.id="input__tools-parity-check",ti.className="input-toggle",ti.type="checkbox",ti.checked=!1,ti.addEventListener("change",(function(){ni.input.enabled=this.checked})),Qr.appendChild(ti),Qr.appendChild(ei),Qr.appendChild(document.createElement("br"));const ni={name:"Parity check",description:"Placeholder",type:"note",order:{input:15,output:135},input:{enabled:ti.checked,params:{warningThres:90,errorThres:45,allowedRot:90},html:Qr},output:{html:null},run:function(t,e){if(!e)throw new Error("something went wrong!");const n=function(t,e){const{_bpm:n}=t,{_notes:r}=e._data,{warningThres:i,errorThres:o,allowedRot:a}=ni.input.params,s={},l={0:[],1:[],3:[]},c={0:[],1:[]},u={0:[],1:[]},d={0:new Vr(r,0,i,o,a),1:new Vr(r,1,i,o,a)},h={warning:[],error:[]};for(let t=0,e=r.length;t<e;t++){const e=r[t];if(dt(e)&&s[e._type]&&en(e,s[e._type],n,l[e._type])){switch(d[e._type].check(l[e._type],u[e._type])){case"warning":h.warning.push(l[e._type][0]._time);break;case"error":h.error.push(l[e._type][0]._time)}d[e._type].next(l[e._type],u[e._type]),u[e._type]=c[e._type],c[e._type]=[],l[e._type]=[]}3===e._type&&(c[0].push(e),c[1].push(e)),s[e._type]=e,l[e._type].push(e)}for(let t=0;t<2;t++)if(s[t])switch(d[t].check(l[t],c[t])){case"warning":h.warning.push(l[t][0]._time);break;case"error":h.error.push(l[t][0]._time)}return h}(t,e),r=[];if(n.warning.length&&r.push(`<b>Parity warning [${n.warning.length}]:</b> ${n.warning.filter((function(t,e,n){return!e||t!==n[e-1]})).sort(((t,e)=>t-e)).map((e=>d(t._bpm.adjustTime(e),3))).join(", ")}`),n.error.length&&r.push(`<b>Parity error [${n.error.length}]:</b> ${n.error.filter((function(t,e,n){return!e||t!==n[e-1]})).sort(((t,e)=>t-e)).map((e=>d(t._bpm.adjustTime(e),3))).join(", ")}`),r.length){const t=document.createElement("div");t.innerHTML=r.join("<br>"),ni.output.html=t}else ni.output.html=null}},ri=ni,ii=document.createElement("div"),oi=document.createElement("input"),ai=document.createElement("label");ai.textContent=" Double-directional",ai.htmlFor="input__tools-dd-check",oi.id="input__tools-dd-check",oi.className="input-toggle",oi.type="checkbox",oi.checked=!0,oi.addEventListener("change",(function(){si.input.enabled=this.checked})),ii.appendChild(oi),ii.appendChild(ai);const si={name:"Double-directional",description:"Placeholder",type:"note",order:{input:99,output:140},input:{enabled:oi.checked,params:{},html:ii},output:{html:null},run:function(t,e){if(!e)throw new Error("something went wrong!");const n=function(t,e){const{_bpm:n}=t,{_notes:r}=e._data,i={},o={},a={},s={0:[],1:[],3:[]},l=[];for(let t=0,e=r.length;t<e;t++){const e=r[t];dt(e)&&i[e._type]?en(e,i[e._type],n,s[e._type])?(a[e._type]&&(a[e._type]=null,o[e._type]=lt[o[e._type]]),Dt(e,o[e._type],45,!0)&&l.push(e),8===e._cutDirection?a[e._type]=e:o[e._type]=e._cutDirection,s[e._type]=[]):(a[e._type]&&Dt(e,o[e._type],45,!0)&&(l.push(e),a[e._type]=null,o[e._type]=e._cutDirection),8!==e._cutDirection&&(a[e._type]=null,o[e._type]=e._cutDirection)):o[e._type]=e._cutDirection,i[e._type]=e,s[e._type].push(e),3===e._type&&(0===e._lineLayer&&(1===e._lineIndex&&(o[0]=0,a[0]=null),2===e._lineIndex&&(o[1]=0,a[1]=null)),2===e._lineLayer&&(1===e._lineIndex&&(o[0]=1,a[0]=null),2===e._lineIndex&&(o[1]=1,a[1]=null)))}return l.map((t=>t._time)).filter((function(t,e,n){return!e||t!==n[e-1]}))}(t,e);if(n.length){const e=document.createElement("div");e.innerHTML=`<b>Double-directional [${n.length}]:</b> ${n.map((e=>d(t._bpm.adjustTime(e),3))).join(", ")}`,si.output.html=e}else si.output.html=null}},li=si,ci={Easy:{min:.025,max:1.2},Normal:{min:.05,max:1},Hard:{min:.08,max:.75},Expert:{min:.1,max:.625},ExpertPlus:{min:.1,max:.5}};let ui;const di=document.createElement("div"),hi=document.createElement("input"),pi=document.createElement("label"),mi=document.createElement("input"),_i=document.createElement("label"),fi=document.createElement("input"),gi=document.createElement("label"),bi=document.createElement("input"),vi=document.createElement("label"),yi=document.createElement("input"),wi=document.createElement("label"),Ei=document.createElement("input"),ki=document.createElement("label"),xi=document.createElement("input"),Ci=document.createElement("label");pi.textContent=" Vision block",pi.htmlFor="input__tools-vb-check",hi.id="input__tools-vb-check",hi.className="input-toggle",hi.type="checkbox",hi.checked=!0,hi.addEventListener("change",(function(){Si.input.enabled=this.checked})),_i.textContent=" VB time specific ",_i.htmlFor="input__tools-vb-time-check",mi.id="input__tools-vb-time-check",mi.className="input-toggle",mi.type="radio",mi.name="input__tools-vb-spec",mi.value="time",mi.addEventListener("change",Ti),gi.textContent=" VB difficulty specific ",gi.htmlFor="input__tools-vb-diff-check",fi.id="input__tools-vb-diff-check",fi.className="input-toggle",fi.type="radio",fi.checked=!0,fi.name="input__tools-vb-spec",fi.value="difficulty",fi.addEventListener("change",Ti),vi.textContent="min time (ms): ",vi.htmlFor="input__tools-vb-min-time",bi.id="input__tools-vb-min-time",bi.className="input-toggle input--small",bi.type="number",bi.min="0",bi.value=d(100,1).toString(),bi.addEventListener("change",(function(){Si.input.params.minTime=Math.abs(parseFloat(this.value))/1e3,this.value=d(1e3*Si.input.params.minTime,1).toString(),ui&&(yi.value=d(ui.toBeatTime(Si.input.params.minTime),2).toString(),Si.input.params.minTime>Si.input.params.maxTime&&(Si.input.params.maxTime=Si.input.params.minTime,Ei.value=d(1e3*Si.input.params.maxTime,1).toString(),xi.value=d(ui.toBeatTime(Si.input.params.maxTime),2).toString()))})),wi.textContent=" (beat): ",wi.htmlFor="input__tools-vb-min-beat",yi.id="input__tools-vb-min-beat",yi.className="input-toggle input--small",yi.type="number",yi.min="0",yi.step="0.1",yi.addEventListener("change",(function(){if(!ui)return void(this.value="0");const t=Math.abs(parseFloat(this.value))||1;Si.input.params.minTime=ui.toRealTime(t),bi.value=d(1e3*Si.input.params.minTime,1).toString(),this.value=d(t,2).toString(),Si.input.params.minTime>Si.input.params.maxTime&&(Si.input.params.maxTime=Si.input.params.minTime,Ei.value=d(1e3*Si.input.params.maxTime,1).toString(),xi.value=d(ui.toBeatTime(Si.input.params.maxTime),2).toString())})),ki.textContent="max time (ms): ",ki.htmlFor="input__tools-vb-max-time",Ei.id="input__tools-vb-max-time",Ei.className="input-toggle input--small",Ei.type="number",Ei.min="0",Ei.value=d(500,1).toString(),Ei.addEventListener("change",(function(){Si.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=d(1e3*Si.input.params.maxTime,1).toString(),ui&&(xi.value=d(ui.toBeatTime(Si.input.params.maxTime),2).toString())})),Ci.textContent=" (beat): ",Ci.htmlFor="input__tools-vb-max-beat",xi.id="input__tools-vb-max-beat",xi.className="input-toggle input--small",xi.type="number",xi.min="0",xi.step="0.1",xi.addEventListener("change",(function(){if(!ui)return void(this.value="0");const t=Math.abs(parseFloat(this.value))||1;Si.input.params.maxTime=ui.toRealTime(t),Ei.value=d(1e3*Si.input.params.maxTime,1).toString(),this.value=d(t,2).toString()})),di.appendChild(hi),di.appendChild(pi),di.appendChild(document.createElement("br")),di.appendChild(mi),di.appendChild(_i),di.appendChild(fi),di.appendChild(gi),di.appendChild(document.createElement("br")),di.appendChild(vi),di.appendChild(bi),di.appendChild(wi),di.appendChild(yi),di.appendChild(document.createElement("br")),di.appendChild(ki),di.appendChild(Ei),di.appendChild(Ci),di.appendChild(xi);const Si={name:"Slow Slider",description:"Placeholder",type:"note",order:{input:100,output:120},input:{enabled:hi.checked,params:{specific:"difficulty",minTime:.1,maxTime:.5},html:di,adjustTime:function(t){ui=t,yi.value=d(ui.toBeatTime(Si.input.params.minTime),2).toString(),xi.value=d(ui.toBeatTime(Si.input.params.maxTime),2).toString()}},output:{html:null},run:function(t,e){if(!e)throw new Error("something went wrong!");const n=function(t,e){const{_bpm:n,_njs:r}=t,{_notes:i}=e._data,{minTime:o,maxTime:a,specific:s}=Si.input.params,l="time"===s?n.toBeatTime(o):n.toBeatTime(ci[e._difficulty].min),c="time"===s?n.toBeatTime(a):Math.min(r.hjd,n.toBeatTime(ci[e._difficulty].max));let u,d;const h=[];for(let t=0,e=i.length;t<e;t++){const e=i[t];u&&(e._time-u._time>=l&&e._time-u._time<=c?e._lineIndex<2&&h.push(e):e._time-u._time>c&&(u=null)),d&&(e._time-d._time>=l&&e._time-d._time<=c?e._lineIndex>1&&h.push(e):e._time-d._time>c&&(d=null)),1===e._lineLayer&&1===e._lineIndex&&(u=e),1===e._lineLayer&&2===e._lineIndex&&(d=e)}return h.map((t=>t._time)).filter((function(t,e,n){return!e||t!==n[e-1]}))}(t,e);if(n.length){const e=document.createElement("div");e.innerHTML=`<b>Vision block [${n.length}]:</b> ${n.map((e=>d(t._bpm.adjustTime(e),3))).join(", ")}`,Si.output.html=e}else Si.output.html=null}};function Ti(){Si.input.params.specific=this.value}const Li=Si,Ii=document.createElement("div"),Di=document.createElement("input"),Ri=document.createElement("label");Ri.textContent=" Stacked note",Ri.htmlFor="input__tools-stack-note-check",Di.id="input__tools-stack-note-check",Di.className="input-toggle",Di.type="checkbox",Di.checked=!0,Di.addEventListener("change",(function(){Ai.input.enabled=this.checked})),Ii.appendChild(Di),Ii.appendChild(Ri);const Ai={name:"Stacked Note",description:"Placeholder",type:"note",order:{input:98,output:198},input:{enabled:Di.checked,params:{},html:Ii},output:{html:null},run:function(t,e){if(!e)throw new Error("something went wrong!");const n=function(t,e){const{_bpm:n}=t,{_notes:r}=e._data,i=[];let o=0;for(let t=0,e=r.length;t<e;t++)if(!(n.toRealTime(r[t]._time)<o+.01||3===r[t]._type))for(let a=t+1;a<e&&!(n.toRealTime(r[a]._time)>n.toRealTime(r[t]._time)+.01);a++)_t(r[t],r[a])&&(i.push(r[t]),o=n.toRealTime(r[t]._time));return i.map((t=>t._time)).filter((function(t,e,n){return!e||t!==n[e-1]}))}(t,e),r=function(t,e){const{_bpm:n,_njs:r}=t,{_notes:i}=e._data,o=[];for(let t=0,e=i.length;t<e;t++)if(3===i[t]._type)for(let a=t+1;a<e&&!(n.toRealTime(i[a]._time)>n.toRealTime(i[t]._time)+1);a++)_t(i[t],i[a])&&(r.value<n.value/(120*(i[a]._time-i[t]._time))||n.toRealTime(i[a]._time)<n.toRealTime(i[t]._time)+.02)&&o.push(i[t]);return o.map((t=>t._time)).filter((function(t,e,n){return!e||t!==n[e-1]}))}(t,e),i=[];if(n.length&&i.push(`<b>Stacked note [${n.length}]:</b> ${n.map((e=>d(t._bpm.adjustTime(e),3))).join(", ")}`),r.length&&i.push(`<b>Stacked bomb [${r.length}]:</b> ${r.map((e=>d(t._bpm.adjustTime(e),3))).join(", ")}`),i.length){const t=document.createElement("div");t.innerHTML=i.join("<br>"),Ai.output.html=t}else Ai.output.html=null}},Ni=Ai,Bi=[1,1,1],Mi={1:"Indistinguishable",5:"Hardly perceivable",10:"Close apparent",20:"Mildly similar",40:"Different",90:"Discernible",100:"Opposite"},Oi=(t,e)=>{var n;let r=null!==(n=Object.keys(t).find((t=>parseFloat(t)>=e)))&&void 0!==n?n:"100";return t[parseFloat(r)]},zi=document.createElement("div"),Pi=document.createElement("input"),Fi=document.createElement("label");Fi.textContent=" Color check (EXPERIMENTAL)",Fi.htmlFor="input__tools-note-color-check",Pi.id="input__tools-note-color-check",Pi.className="input-toggle",Pi.type="checkbox",Pi.checked=!0,Pi.addEventListener("change",(function(){ji.input.enabled=this.checked})),zi.appendChild(Pi),zi.appendChild(Fi);const ji={name:"Color Check",description:"Placeholder",type:"note",order:{input:97,output:45},input:{enabled:Pi.checked,params:{},html:zi},output:{html:null},run:function(t,e){var n,r;if(!e)throw new Error("something went wrong!");if(!(null===(n=e._info._customData)||void 0===n?void 0:n._colorLeft)&&!(null===(r=e._info._customData)||void 0===r?void 0:r._colorRight))return;const i=function(t,e){var n,r,i,o;const a=null!==(r=null===(n=e._info._customData)||void 0===n?void 0:n._colorLeft)&&void 0!==r?r:q[H[e._environment]]._colorLeft,s=null!==(o=null===(i=e._info._customData)||void 0===i?void 0:i._colorRight)&&void 0!==o?o:q[H[e._environment]]._colorRight;return a&&s?Gt(Ut(a),Ut(s)):100}(0,e),o=function(t,e){var n,r,i,o;let a=100,s=100;const l=null!==(r=null===(n=e._info._customData)||void 0===n?void 0:n._colorLeft)&&void 0!==r?r:q[H[e._environment]]._colorLeft,c=null!==(o=null===(i=e._info._customData)||void 0===i?void 0:i._colorRight)&&void 0!==o?o:q[H[e._environment]]._colorRight;return l&&(a=Gt(Bi,Ut(l))),c&&(s=Gt(Bi,Ut(c))),Math.min(a,s)}(0,e),a=[];if(i<=20&&a.push(`<b>${Oi(Mi,i)} note color (dE${d(i,1)}):</b> suggest change to better differentiate between 2 note colour`),o<=20&&a.push(`<b>${Oi(Mi,o)} arrow note color (dE${d(o,1)}):</b> may be difficult to see the arrow`),a.length){const t=document.createElement("div");t.innerHTML=a.join("<br>"),ji.output.html=t}else ji.output.html=null}},$i=ji,Ui=document.createElement("div"),Hi=document.createElement("input"),qi=document.createElement("label");qi.textContent=" <15ms obstacle",qi.htmlFor="input__tools-short-obstacle-check",Hi.id="input__tools-short-obstacle-check",Hi.className="input-toggle",Hi.type="checkbox",Hi.checked=!0,Hi.addEventListener("change",(function(){Zi.input.enabled=this.checked})),Ui.appendChild(Hi),Ui.appendChild(qi);const Zi={name:"Short Obstacle",description:"Placeholder",type:"obstacle",order:{input:0,output:50},input:{enabled:Hi.checked,params:{minDur:.015},html:Ui},output:{html:null},run:function(t,e){if(!e)throw new Error("something went wrong!");const n=function(t,e){const{_obstacles:n}=e._data,{_bpm:r}=t,{minDur:i}=Zi.input.params,o=r.toBeatTime(i),a=[];let s={_time:0,_duration:0,_lineIndex:0,_type:0,_width:0},l={_time:0,_duration:0,_lineIndex:0,_type:0,_width:0},c={_time:0,_duration:0,_lineIndex:0,_type:0,_width:0},u={_time:0,_duration:0,_lineIndex:0,_type:0,_width:0};return n.forEach((t=>{0===t._type&&t._duration>0?t._width>2||t._width>1&&1===t._lineIndex?(W(t,s)&&(t._duration<o&&a.push(t),s=t),W(t,l)&&(t._duration<o&&a.push(t),l=t)):2===t._width?0===t._lineIndex?W(t,s)&&(t._duration<o&&a.push(t),s=t):2===t._lineIndex&&W(t,l)&&(t._duration<o&&a.push(t),l=t):1===t._width&&(1===t._lineIndex?W(t,s)&&(t._duration<o&&a.push(t),s=t):2===t._lineIndex&&W(t,l)&&(t._duration<o&&a.push(t),l=t)):1===t._type&&t._duration>0&&(t._width>2||t._width>1&&1===t._lineIndex?(W(t,c)&&(t._duration<o&&W(t,s,o)&&W(t,c,o)&&a.push(t),c=t),W(t,u)&&(t._duration<o&&W(t,l,o)&&W(t,u,o)&&a.push(t),u=t)):2===t._width?0===t._lineIndex?W(t,c)&&(t._duration<o&&W(t,s,o)&&W(t,c,o)&&a.push(t),c=t):2===t._lineIndex&&W(t,u)&&(t._duration<o&&W(t,l,o)&&W(t,u,o)&&a.push(t),u=t):1===t._width&&(1===t._lineIndex?W(t,c)&&(t._duration<o&&W(t,s,o)&&W(t,c,o)&&a.push(t),c=t):2===t._lineIndex&&W(t,u)&&(t._duration<o&&W(t,l,o)&&W(t,u,o)&&a.push(t),u=t)))})),a.map((t=>t._time)).filter((function(t,e,n){return!e||t!==n[e-1]}))}(t,e);if(n.length){const e=document.createElement("div");e.innerHTML=`<b><15ms obstacle [${n.length}]:</b> ${n.map((e=>d(t._bpm.adjustTime(e),3))).join(", ")}`,Zi.output.html=e}else Zi.output.html=null}},Wi=Zi;let Ji;const Gi=document.createElement("div"),Ki=document.createElement("input"),Xi=document.createElement("label"),Vi=document.createElement("input"),Yi=document.createElement("label"),Qi=document.createElement("input"),to=document.createElement("label");Xi.textContent=" 2-wide center obstacle",Xi.htmlFor="input__tools-center-obstacle-check",Ki.id="input__tools-center-obstacle-check",Ki.className="input-toggle",Ki.type="checkbox",Ki.checked=!0,Ki.addEventListener("change",(function(){eo.input.enabled=this.checked})),Yi.textContent="recovery time (ms): ",Yi.htmlFor="input__tools-2wide-wall-time",Vi.id="input__tools-2wide-wall-time",Vi.className="input-toggle input--small",Vi.type="number",Vi.min="0",Vi.value=d(250,1).toString(),Vi.addEventListener("change",(function(){eo.input.params.recovery=Math.abs(parseFloat(this.value))/1e3,this.value=d(1e3*eo.input.params.recovery,1).toString(),Ji&&(Qi.value=d(Ji.toBeatTime(eo.input.params.recovery),2).toString())})),to.textContent=" (beat): ",to.htmlFor="input__tools-2wide-wall-beat",Qi.id="input__tools-2wide-wall-beat",Qi.className="input-toggle input--small",Qi.type="number",Qi.min="0",Qi.step="0.1",Qi.addEventListener("change",(function(){if(!Ji)return void(this.value="0");let t=d(Math.abs(parseFloat(this.value)),2)||1;eo.input.params.recovery=Ji.toRealTime(t),Vi.value=d(1e3*eo.input.params.recovery,1).toString(),this.value=t.toString()})),Gi.appendChild(Ki),Gi.appendChild(Xi),Gi.appendChild(document.createElement("br")),Gi.appendChild(Yi),Gi.appendChild(Vi),Gi.appendChild(to),Gi.appendChild(Qi);const eo={name:"2-wide Center Obstacle",description:"Placeholder",type:"obstacle",order:{input:10,output:60},input:{enabled:Ki.checked,params:{recovery:.25},html:Gi,adjustTime:function(t){Ji=t,Qi.value=d(Ji.toBeatTime(eo.input.params.recovery),2).toString()}},output:{html:null},run:function(t,e){if(!e)throw new Error("something went wrong!");const n=function(t,e){const{_obstacles:n}=e._data,{_bpm:r}=t,{recovery:i}=eo.input.params,o=[];let a={_time:0,_duration:0,_lineIndex:0,_type:0,_width:0},s={_time:0,_duration:0,_lineIndex:0,_type:0,_width:0};return n.forEach((t=>{0===t._type&&(t._width>2&&(o.push(t),W(t,a)&&(a=t),W(t,s)&&(s=t)),2===t._width&&(0===t._lineIndex&&W(t,a)&&(r.toRealTime(t._time)>r.toRealTime(s._time)-i&&r.toRealTime(t._time)<r.toRealTime(s._time+s._duration)+i&&o.push(t),a=t),1===t._lineIndex&&(o.push(t),W(t,a)&&(a=t),W(t,s)&&(s=t)),2===t._lineIndex&&W(t,s)&&(r.toRealTime(t._time)>r.toRealTime(a._time)-i&&r.toRealTime(t._time)<r.toRealTime(a._time+a._duration)+i&&o.push(t),s=t)),1===t._width&&(1===t._lineIndex&&W(t,a)&&(r.toRealTime(t._time)>r.toRealTime(s._time)-i&&r.toRealTime(t._time)<r.toRealTime(s._time+s._duration)+i&&o.push(t),a=t),2===t._lineIndex&&W(t,s)&&(r.toRealTime(t._time)>r.toRealTime(a._time)-i&&r.toRealTime(t._time)<r.toRealTime(a._time+a._duration)+i&&o.push(t),s=t)))})),o.map((t=>t._time)).filter((function(t,e,n){return!e||t!==n[e-1]}))}(t,e),{recovery:r}=eo.input.params;if(n.length){const e=document.createElement("div");e.innerHTML=`<b>2-wide center obstacle (<${d(1e3*r)}ms) [${n.length}]:</b> ${n.map((e=>d(t._bpm.adjustTime(e),3))).join(", ")}`,eo.output.html=e}else eo.output.html=null}},no=eo,ro=document.createElement("div"),io=document.createElement("input"),oo=document.createElement("label");oo.textContent=" Zero width/duration obstacle",oo.htmlFor="input__tools-zero-obstacle-check",io.id="input__tools-zero-obstacle-check",io.className="input-toggle",io.type="checkbox",io.checked=!0,io.addEventListener("change",(function(){ao.input.enabled=this.checked})),ro.appendChild(io),ro.appendChild(oo);const ao={name:"Negative Obstacle",description:"Placeholder",type:"obstacle",order:{input:20,output:70},input:{enabled:io.checked,params:{},html:ro},output:{html:null},run:function(t,e){if(!e)throw new Error("something went wrong!");const n=function(t,e){const{_obstacles:n}=e._data;return n.filter((t=>0===t._width||0===t._duration)).map((t=>t._time))}(0,e);if(n.length){const e=document.createElement("div");e.innerHTML=`<b>Zero width/duration obstacle [${n.length}]:</b> ${n.map((e=>d(t._bpm.adjustTime(e),3))).join(", ")}`,ao.output.html=e}else ao.output.html=null}},so=ao,lo=document.createElement("div"),co=document.createElement("input"),uo=document.createElement("label");uo.textContent=" Negative obstacle",uo.htmlFor="input__tools-negative-obstacle-check",co.id="input__tools-negative-obstacle-check",co.className="input-toggle",co.type="checkbox",co.checked=!0,co.addEventListener("change",(function(){ho.input.enabled=this.checked})),lo.appendChild(co),lo.appendChild(uo);const ho={name:"Negative Obstacle",description:"Placeholder",type:"obstacle",order:{input:30,output:80},input:{enabled:co.checked,params:{},html:lo},output:{html:null},run:function(t,e){if(!e)throw new Error("something went wrong!");const n=function(t,e){var n,r,i,o;const{_obstacles:a}=e._data;return(null===(r=null===(n=e._info._customData)||void 0===n?void 0:n._requirements)||void 0===r?void 0:r.includes("Mapping Extensions"))||(null===(o=null===(i=e._info._customData)||void 0===i?void 0:i._requirements)||void 0===o?void 0:o.includes("Noodle Extensions"))?[]:a.filter((t=>t._width<0||t._duration<0)).map((t=>t._time))}(0,e);if(n.length){const e=document.createElement("div");e.innerHTML=`<b>Negative obstacle [${n.length}]:</b> ${n.map((e=>d(t._bpm.adjustTime(e),3))).join(", ")}`,ho.output.html=e}else ho.output.html=null}},po=ho,mo=document.createElement("div"),_o=document.createElement("input"),fo=document.createElement("label");fo.textContent=" Insufficient lighting event",fo.htmlFor="input__tools-insufficient-light-check",_o.id="input__tools-insufficient-light-check",_o.className="input-toggle",_o.type="checkbox",_o.checked=!0,_o.addEventListener("change",(function(){go.input.enabled=this.checked})),mo.appendChild(_o),mo.appendChild(fo);const go={name:"Insufficient Light",description:"Placeholder",type:"event",order:{input:0,output:0},input:{enabled:_o.checked,params:{},html:mo},output:{html:null},run:function(t,e){if(!e)throw new Error("something went wrong!");if((t=>{let e=0;for(let n=t.length-1;n>=0;n--)if(Nt(t[n])&&0!==t[n]._value&&4!==t[n]._value&&(e++,e>10))return!0;return!1})(e._data._events))go.output.html=null;else{const t=document.createElement("div");t.innerHTML="<b>Insufficient lighting event</b>",go.output.html=t}}},bo=go,vo=document.createElement("div"),yo=document.createElement("input"),wo=document.createElement("label");wo.textContent=" Old value 4 event",wo.htmlFor="input__tools-light-4",yo.id="input__tools-light-4",yo.className="input-toggle",yo.type="checkbox",yo.checked=!0,yo.addEventListener("change",(function(){Eo.input.enabled=this.checked})),vo.appendChild(yo),vo.appendChild(wo);const Eo={name:"Insufficient Light",description:"Placeholder",type:"event",order:{input:0,output:0},input:{enabled:yo.checked,params:{},html:vo},output:{html:null},run:function(t,e){if(!e)throw new Error("something went wrong!");const n=function(t,e){const{_bpm:n,_audioDuration:r}=t,{_events:i}=e._data,o=[];if("old"!==((t,e)=>{const n=(t=>t.replace("v","").split(".").map((t=>parseInt(t))))(t);for(const t in n){if(n[t]<$t[e][t])return"old";if(n[t]>$t[e][t])return"new"}return"current"})(e._data._version,"difficulty"))return[];for(let t=0;t<i.length;t++)Nt(i[t])&&4===i[t]._value&&o.push(i[t]);return o.map((t=>t._time)).filter((function(t,e,n){return!e||t!==n[e-1]}))}(t,e);if(n.length){const e=document.createElement("div");e.innerHTML=`<b>Event with value 4 [${n.length}]:</b> ${n.map((e=>d(t._bpm.adjustTime(e),3))).join(", ")}`,Eo.output.html=e}else Eo.output.html=null}},ko=Eo,xo=document.createElement("div"),Co=document.createElement("input"),So=document.createElement("label");So.textContent=" Event peak (1 second) and per second",So.htmlFor="input__tools-light-stats",Co.id="input__tools-light-stats",Co.className="input-toggle",Co.type="checkbox",Co.checked=!1,Co.addEventListener("change",(function(){To.input.enabled=this.checked})),xo.appendChild(Co),xo.appendChild(So);const To={name:"Insufficient Light",description:"Placeholder",type:"event",order:{input:0,output:0},input:{enabled:Co.checked,params:{},html:xo},output:{html:null},run:function(t,e){if(!e)throw new Error("something went wrong!");const n=function(t,e){const{_bpm:n,_audioDuration:r}=t,{_events:i}=e._data;let o=n.toBeatTime(1),a=0,s=0;for(let t=0;t<i.length;t++){for(;i[t]._time-i[s]._time>o;)s++;a=Math.max(a,(t-s+o)/(1/n.value*60))}return{EPS:r?d(i.length/r,3):0,peakEPS:d(a,3)}}(t,e);if(n){const t=document.createElement("div");t.innerHTML=`<b>Events per second:</b> ${n.EPS}<br><b>Peak Event (1s):</b> ${n.peakEPS}`,To.output.html=t}else To.output.html=null}},Lo=To,Io=document.createElement("div"),Do=document.createElement("input"),Ro=document.createElement("label");Ro.textContent="Hot start (s): ",Ro.htmlFor="input__tools-hot-start",Do.id="input__tools-hot-start",Do.className="input-toggle input--small",Do.type="number",Do.min="0",Do.step="0.1",Do.value=1.5.toString(),Do.addEventListener("change",(function(){Ao.input.params.time=d(Math.abs(parseFloat(this.value)),3),this.value=Ao.input.params.time.toString()})),Io.appendChild(Ro),Io.appendChild(Do);const Ao={name:"Hot Start",description:"Placeholder",type:"other",order:{input:0,output:0},input:{enabled:!0,params:{time:1.5},html:Io},output:{html:null},run:function(t,e){if(!e)throw new Error("something went wrong!");const{time:n}=Ao.input.params,r=t._bpm.toRealTime(X(e._data));if(r<n){const t=document.createElement("div");t.innerHTML=`<b>Hot start:</b> ${d(r,2)}s`,Ao.output.html=t}else Ao.output.html=null}},No=Ao,Bo={name:"Difficulty Label",description:"Placeholder",type:"other",order:{input:30,output:30},input:{enabled:!0,params:{}},output:{html:null},run:function(t,e){var n;if(!e)throw new Error("something went wrong!");const r=null===(n=e._info._customData)||void 0===n?void 0:n._difficultyLabel;if(r&&r.length>30){const t=document.createElement("div");t.innerHTML=`<b>Difficulty label is too long (${r.length} characters):</b> exceeded 30 max characters by ranking criteria`,Bo.output.html=t}else Bo.output.html=null}},Mo=Bo,Oo={name:"Note Jump Speed",description:"Placeholder",type:"other",order:{input:40,output:40},input:{enabled:!0,params:{}},output:{html:null},run:function(t,e){if(!e)throw new Error("something went wrong!");const{_njs:n,_bpm:r}=t,i=[];if(0===e._info._noteJumpMovementSpeed&&i.push("<b>Unset NJS</b>: fallback NJS is used"),n.value>23&&i.push(`<b>NJS is too high (${d(n.value,2)}):</b> use lower whenever necessary`),n.jd<18&&i.push(`<b>Very low jump distance:</b> ${d(n.jd,2)}`),n.jd>36&&i.push(`<b>Very high jump distance:</b> ${d(n.jd,2)}`),n.jd>n.calcJumpDistanceOptimalHigh()&&i.push(`<b>High jump distance warning (>${d(n.calcJumpDistanceOptimalHigh(),2)}):</b> ${d(n.jd,2)} at ${d(n.value,2)} NJS may be uncomfortable to play`),r.toRealTime(n.hjd)<.45&&i.push(`<b>Very quick reaction time (${d(1e3*r.toRealTime(n.hjd))}ms):</b> may lead to suboptimal gameplay`),n.calcHalfJumpDurationRaw()+n.offset<n.hjdMin&&i.push(`<b>Unnecessary negative offset:</b> will not drop below ${n.hjdMin}`),i.length){const t=document.createElement("div");t.innerHTML=i.join("<br>"),Oo.output.html=t}else Oo.output.html=null}},zo=Oo,Po=document.createElement("div"),Fo=document.createElement("input"),jo=document.createElement("label");jo.textContent=" Outside playable object",jo.htmlFor="input__tools-outside-object-check",Fo.id="input__tools-outside-object-check",Fo.className="input-toggle",Fo.type="checkbox",Fo.checked=!0,Fo.addEventListener("change",(function(){$o.input.enabled=this.checked})),Po.appendChild(Fo),Po.appendChild(jo);const $o={name:"Difficulty Label",description:"Placeholder",type:"other",order:{input:10,output:10},input:{enabled:Fo.checked,params:{},html:Po},output:{html:null},run:function(t,e){if(!e)throw new Error("something went wrong!");const{_bpm:n,_audioDuration:r}=t,{_notes:i,_obstacles:o,_events:a}=e._data,s=[];if(r){let t=n.toBeatTime(r);i.length&&i[0]._time<0&&s.push(`<b>Note(s) before start time:</b> ${d(i[0]._time,3)} (${u(n.toRealTime(i[0]._time))})`),o.length&&o[0]._time<0&&s.push(`<b>Obstacle(s) before start time:</b> ${d(o[0]._time,3)} (${u(n.toRealTime(o[0]._time))})`),a.length&&a[0]._time<0&&s.push(`<b>Event(s) before start time:</b> ${d(a[0]._time,3)} (${u(n.toRealTime(a[0]._time))})`),i.length&&i[i.length-1]._time>t&&s.push(`<b>Note(s) after end time:</b> ${d(i[i.length-1]._time,3)} (${u(n.toRealTime(i[i.length-1]._time))})`),o.length&&o[o.length-1]._time>t&&s.push(`<b>Obstacle(s) after end time:</b> ${d(o[o.length-1]._time,3)} (${u(n.toRealTime(o[o.length-1]._time))})`),a.length&&a[a.length-1]._time>t&&s.push(`<b>Event(s) after end time:</b> ${d(a[a.length-1]._time,3)} (${u(n.toRealTime(a[a.length-1]._time))})`)}if(s.length){const t=document.createElement("div");t.innerHTML=s.join("<br>"),$o.output.html=t}else $o.output.html=null}},Uo=$o,Ho=document.createElement("div"),qo=document.createElement("input"),Zo=document.createElement("label");Zo.textContent=" Invalid object",Zo.htmlFor="input__tools-invalid-object-check",qo.id="input__tools-invalid-object-check",qo.className="input-toggle",qo.type="checkbox",qo.checked=!0,qo.addEventListener("change",(function(){Wo.input.enabled=this.checked})),Ho.appendChild(qo),Ho.appendChild(Zo);const Wo={name:"Invalid Object",description:"Placeholder",type:"other",order:{input:20,output:20},input:{enabled:qo.checked,params:{},html:Ho},output:{html:null},run:function(t,e){var n,r,i,o;if(!e)throw new Error("something went wrong!");const{_bpm:a}=t,{_notes:s,_obstacles:l,_events:c}=e._data;let u=[],h=[];(null===(r=null===(n=e._info._customData)||void 0===n?void 0:n._requirements)||void 0===r?void 0:r.includes("Mapping Extensions"))||((null===(o=null===(i=e._info._customData)||void 0===i?void 0:i._requirements)||void 0===o?void 0:o.includes("Noodle Extensions"))?(u=s.filter((t=>wt(t)&&!(t=>{var e,n,r,i,o,a,s,l,c,u,d,h,p;return Array.isArray(null===(e=t._customData)||void 0===e?void 0:e._animation)||"number"==typeof(null===(n=t._customData)||void 0===n?void 0:n._cutDirection)||"boolean"==typeof(null===(r=t._customData)||void 0===r?void 0:r._disableNoteGravity)||"boolean"==typeof(null===(i=t._customData)||void 0===i?void 0:i._disableNoteLook)||"boolean"==typeof(null===(o=t._customData)||void 0===o?void 0:o._fake)||Array.isArray(null===(a=t._customData)||void 0===a?void 0:a._flip)||"boolean"==typeof(null===(s=t._customData)||void 0===s?void 0:s._interactable)||Array.isArray(null===(l=t._customData)||void 0===l?void 0:l._localRotation)||"number"==typeof(null===(c=t._customData)||void 0===c?void 0:c._noteJumpMovementSpeed)||"number"==typeof(null===(u=t._customData)||void 0===u?void 0:u._noteJumpStartBeatOffset)||Array.isArray(null===(d=t._customData)||void 0===d?void 0:d._position)||Array.isArray(null===(h=t._customData)||void 0===h?void 0:h._rotation)||"string"==typeof(null===(p=t._customData)||void 0===p?void 0:p._track)})(t))).map((t=>t._time)),h=l.filter((t=>K(t)&&!G(t))).map((t=>t._time))):(u=s.filter((t=>{return!(!wt(e=t)&&(t=>t._cutDirection>=0&&t._cutDirection<=8)(e));var e})).map((t=>t._time)),h=l.filter((t=>{return!(!K(e=t)&&e._width>0&&e._width<=4);var e})).map((t=>t._time))));const p=c.filter((t=>{return!(At(e=t)&&e._value>=0&&(Ot(e)||!(e._value>8)||zt(e)));var e})).map((t=>t._time)),m=[];if(u.length&&m.push(`<b>Invalid note [${u.length}]:</b> ${u.map((t=>d(a.adjustTime(t),3))).join(", ")}`),h.length&&m.push(`<b>Invalid obstacle [${h.length}]:</b> ${h.map((t=>d(a.adjustTime(t),3))).join(", ")}`),p.length&&m.push(`<b>Invalid event [${p.length}]:</b> ${p.map((t=>d(a.adjustTime(t),3))).join(", ")}`),m.length){const t=document.createElement("div");t.innerHTML=m.join("<br>"),Wo.output.html=t}else Wo.output.html=null}},Jo=Wo,Go=()=>Object.keys(e).map((t=>e[t])),Ko=()=>Object.keys(r).map((t=>r[t])),Xo=()=>Object.keys(i).map((t=>i[t])),Vo=()=>Object.keys(o).map((t=>o[t])),Yo=()=>Object.keys(t).map((e=>t[e])),Qo=()=>[...Go(),...Ko(),...Xo(),...Vo()],ta=()=>{te._analysis={general:{html:null},mapSet:[],missing:[],sps:[]}},ea=(t,e)=>{var n,r,i,o,a,s,l;const c=te._mapInfo;if(!c)return void console.error("could not analyse, missing map info");const u=null===(n=te._mapSet)||void 0===n?void 0:n.find((n=>n._mode===t&&n._difficulty===e));if(!u)return void console.error("could not analyse, missing map data");te._analysis||ta();const d=null===(r=te._analysis)||void 0===r?void 0:r.mapSet.find((n=>n.difficulty===e&&n.mode===t)),h=M(c._beatsPerMinute,(null===(i=u._data._customData)||void 0===i?void 0:i._BPMChanges)||(null===(o=u._data._customData)||void 0===o?void 0:o._bpmChanges),null===(a=u._info._customData)||void 0===a?void 0:a._editorOffset),p={_bpm:h,_njs:Q(h,u._info._noteJumpMovementSpeed,u._info._noteJumpStartBeatOffset),_audioDuration:null!==(s=te._duration)&&void 0!==s?s:null,_mapDuration:h.toRealTime(V(u._data))},m=Qo().sort(((t,e)=>t.order.output-e.order.output));console.log(`analysing ${t} ${e}`);const _=[];m.forEach((t=>{if(t.input.enabled)try{t.run(p,u,c),t.output.html&&_.push(t.output.html)}catch(t){console.error(t)}})),d?d.html=_:null===(l=te._analysis)||void 0===l||l.mapSet.push({mode:t,difficulty:e,html:_})},na=()=>{var t;null===(t=te._mapSet)||void 0===t||t.forEach((t=>ea(t._mode,t._difficulty)))},ra=document.querySelectorAll(".tools__select-mode"),ia=document.querySelectorAll(".tools__select-difficulty"),oa=document.querySelectorAll(".difficulty__label"),aa=document.querySelector(".tools__note-content"),sa=document.querySelector(".tools__obstacle-content"),la=document.querySelector(".tools__event-content"),ca=document.querySelector(".tools__other-content"),ua=document.querySelector(".tools__output-diff"),da=document.querySelector(".tools__output-general"),ha=document.querySelector(".tools__apply-this"),pa=document.querySelector(".tools__apply-all");aa&&sa&&la&&ca||console.error("UI Tools: missing content element"),ua&&da||console.error("UI Tools: missing output element"),ha&&pa?(ha.addEventListener("click",(function(){const t=ra[0].value,e=ia[0].value;if(!t||!e)throw new Error("UI Tools: mode/difficulty does not exist");Ze("info",`Re-analysing ${t} ${e}`,100),ea(t,e),Ze("info",`Re-analysed ${t} ${e}`,100),ma(t,e)})),pa.addEventListener("click",(function(){const t=ra[0].value,e=ia[0].value;if(!t||!e)throw new Error("UI Tools: mode/difficulty does not exist");Ze("info","Re-analysing all difficulties",100),na(),Ze("info","Re-analysed all difficulties",100),ma(t,e)}))):console.error("UI Tools: missing apply element"),ra.forEach((t=>t.addEventListener("change",ba))),ia.forEach((t=>t.addEventListener("change",va)));const ma=(t,e)=>{var n;if(t||e||(t=ra[0].value,e=ia[0].value),!t||!e)throw new Error("UI Tools: something went wrong!");if(!ua)throw new Error("UI Tools: output difficulty is missing");ua.innerHTML="";const r=null===(n=te._analysis)||void 0===n?void 0:n.mapSet.find((n=>n.difficulty===e&&n.mode===t));r?r.html?(r.html.forEach((t=>ua.appendChild(t))),ua.firstChild||(ua.textContent="No issues found.")):ua.textContent="ERROR: could not find HTML for "+t+" "+e:ua.textContent="ERROR: could not find analysis for "+t+" "+e},_a=t=>{oa.forEach((e=>e.textContent=t))},fa=t=>{if(!t)return;ia.forEach((t=>{for(let e=t.options.length-1;e>=0;e--)t.remove(e)}));let e=!0;t._difficultyBeatmaps.forEach((n=>{ia.forEach((r=>{var i,o,a,s;const l=document.createElement("option");if(l.value=n._difficulty,l.textContent=F[n._difficulty]+((null===(i=n._customData)||void 0===i?void 0:i._difficultyLabel)?" -- "+(null===(o=n._customData)||void 0===o?void 0:o._difficultyLabel):""),e){const e=null===(a=te._mapSet)||void 0===a?void 0:a.find((e=>e._difficulty===n._difficulty&&e._mode===t._beatmapCharacteristicName));if(!e)throw new Error("missing _mapSetData");je(e),_a((null===(s=n._customData)||void 0===s?void 0:s._difficultyLabel)||F[n._difficulty]),ma(t._beatmapCharacteristicName,n._difficulty)}e=!1,r.add(l)}))}))},ga=t=>{if(!t)return ra.forEach((t=>v(t))),void ia.forEach((t=>v(t)));let e=!0;t._difficultyBeatmapSets.forEach((t=>{ra.forEach((e=>{const n=document.createElement("option");n.value=t._beatmapCharacteristicName,n.textContent=O[t._beatmapCharacteristicName],e.add(n)})),e&&fa(t),e=!1}))};function ba(t){var e;const n=t.target;ra.forEach((t=>{t!==n&&(t.value=n.value)}));const r=null===(e=te._mapInfo)||void 0===e?void 0:e._difficultyBeatmapSets.find((t=>t._beatmapCharacteristicName===n.value));fa(r)}function va(t){var e,n,r,i;const o=t.target;ia.forEach((t=>{t!==o&&(t.value=o.value)}));const a=null===(e=te._mapInfo)||void 0===e?void 0:e._difficultyBeatmapSets.find((t=>t._beatmapCharacteristicName===ra.item(0).value));if(!a)throw new Error("aaaaaaaaaaaaaaaaaaa");const s=null===(n=te._mapSet)||void 0===n?void 0:n.find((t=>t._difficulty===o.value&&t._mode===a._beatmapCharacteristicName));s&&(je(s),_a((null===(i=null===(r=s._info)||void 0===r?void 0:r._customData)||void 0===i?void 0:i._difficultyLabel)||F[o.value]),ma(s._mode,s._difficulty))}const ya=document.querySelector("#stats .accordion__collapsible");function wa(t){var e,n;const r=t.target,i=r.id.replace("stats__table-select-placement-","").split("-"),o=i[0],a=i[1],s=null===(n=null===(e=te._mapSet)||void 0===e?void 0:e.find((t=>t._mode===o&&t._difficulty===a)))||void 0===n?void 0:n._data._notes;if(!s)return void console.error("UI Stats: note could not be found");let l;switch(r.value){case"note":l=s.filter((t=>dt(t)));break;case"red":l=s.filter((t=>0===t._type));break;case"blue":l=s.filter((t=>1===t._type));break;case"bomb":l=s.filter((t=>3===t._type));break;default:l=s}const c=document.querySelector(`#stats__table-placement-${o}-${a}`);c?c.innerHTML=Ea(l):console.error("UI Stats: table could not be found")}function Ea(t){const e=t.length||1;let n="";for(let r=2;r>=0;r--){n+="<tr>";for(let e=0;e<=3;e++)n+=`<td class="stats__table-element">${Ct(t,e,r)}</td>`;n+=`<td class="stats__table-element stats__table--no-border">${d(xt(t,r)/e*100,1)}%</td>\n        </tr>`}return n+=`<tr>\n    <td class="stats__table-element stats__table--no-border">${d(kt(t,0)/e*100,1)}%</td>\n    <td class="stats__table-element stats__table--no-border">${d(kt(t,1)/e*100,1)}%</td>\n    <td class="stats__table-element stats__table--no-border">${d(kt(t,2)/e*100,1)}%</td>\n    <td class="stats__table-element stats__table--no-border">${d(kt(t,3)/e*100,1)}%</td>\n    </tr>`,n}function ka(t){var e,n;const r=t.target,i=r.id.replace("stats__table-select-angle-","").split("-"),o=i[0],a=i[1],s=null===(n=null===(e=te._mapSet)||void 0===e?void 0:e.find((t=>t._mode===o&&t._difficulty===a)))||void 0===n?void 0:n._data._notes;if(!s)return void console.error("UI Stats: note could not be found");let l;switch(r.value){case"note":l=s.filter((t=>dt(t)));break;case"red":l=s.filter((t=>0===t._type));break;case"blue":l=s.filter((t=>1===t._type));break;case"bomb":l=s.filter((t=>3===t._type));break;default:l=s}const c=document.querySelector(`#stats__table-angle-${o}-${a}`);c?c.innerHTML=xa(l):console.error("UI Stats: table could not be found")}function xa(t){const e=t.length||1,n=[4,0,5,2,8,3,6,1,7];let r="";for(let i=0;i<3;i++){r+="<tr>";for(let o=0;o<3;o++){let a=St(t,n[3*i+o]);r+=`<td class="stats__table-element">${a}<br>(${d(a/e*100,1)}%)</td>`}r+="</tr>"}return r}const Ca=()=>{if(!ya)return void console.error("UI Stats: HTML stats does not exist");if(!te._mapInfo)throw new Error("UI Stats: map info could not be found in savedData");if(!te._mapSet)throw new Error("UI Stats: map data could not be found in savedData");const t=te._mapInfo;t._difficultyBeatmapSets.forEach((e=>{const n=document.createElement("div");n.className="stats__mode-"+e._beatmapCharacteristicName;const r=document.createElement("div");r.className="stats__title",r.textContent=O[e._beatmapCharacteristicName],n.appendChild(r),e._difficultyBeatmaps.forEach((r=>{var i,o,l;const c=null===(i=te._mapSet)||void 0===i?void 0:i.find((t=>t._mode===e._beatmapCharacteristicName&&t._difficulty===r._difficulty));if(!c)throw new Error("UI Stats: Could not find map data");const u=((t,e,n,r=!1)=>{const i=document.createElement("div");i.className="accordion";const o=document.createElement("input");o.className=a+"button",o.id=t,o.setAttribute("type","checkbox");const l=document.createElement("label");l.className=a+"label unselectable",l.htmlFor=t,l.textContent=e,n&&l.classList.add(s[n]);const c=document.createElement("div");return c.className=r?a+"collapsible-flex":a+"collapsible",c.id=t+"-content",i.appendChild(o),i.appendChild(l),i.appendChild(c),i})(`stats__${e._beatmapCharacteristicName}-${r._difficulty}`,F[r._difficulty]+((null===(o=r._customData)||void 0===o?void 0:o._difficultyLabel)?" -- "+(null===(l=r._customData)||void 0===l?void 0:l._difficultyLabel):""),r._difficulty,!0),h=u.querySelector(".accordion__collapsible-flex"),p=u.querySelector(".accordion__button");if(!h||!p)throw new Error("UI Stats: something went wrong!");p.checked=ot.onLoad.stats;const m=Vt("small","half"),_=Vt("small","half"),f=Vt("small","half");m.append(((t,e)=>{const n=M(t._beatsPerMinute),r=Q(n,e._info._noteJumpMovementSpeed||tt[e._difficulty],e._info._noteJumpStartBeatOffset),i=document.createElement("table");return i.className="stats__table",i.innerHTML=`<caption class="stats__table-caption">Map Settings:</caption>\n    <tr>\n    <th class="stats__table-header" colspan="2">Note Jump Speed</th>\n    <td class="stats__table-element">${d(r.value,3)}</td>\n    </tr>\n    <tr>\n    <th class="stats__table-header" colspan="2">Spawn Distance Modifier</th>\n    <td class="stats__table-element">${d(r.offset,3)}</td>\n    </tr>\n    <tr>\n    <th class="stats__table-header" colspan="2">Half Jump Duration</th>\n    <td class="stats__table-element">${d(r.hjd,3)}</td>\n    </tr>\n    <tr>\n    <th class="stats__table-header" colspan="2">Jump Distance</th>\n    <td class="stats__table-element">${d(r.jd,3)}</td>\n    </tr>\n    <tr>\n    <th class="stats__table-header" colspan="2">Reaction Time</th>\n    <td class="stats__table-element">${d(1e3*r.reactTime)}ms</td>\n    </tr>`,i})(t,c)),m.append(document.createElement("br")),m.append(((t,e)=>{const n=M(t._beatsPerMinute),r=te._duration||0,i=n.toRealTime(V(e._data)),o=document.createElement("table");return o.className="stats__table",o.innerHTML=`<caption class="stats__table-caption">Note Per Seconds (NPS):</caption>\n    <tr>\n    <th class="stats__table-header" colspan="2">Overall</th>\n    <td class="stats__table-element">${d(Tt(e._data._notes,r),2)}</td>\n    </tr>\n    <tr>\n    <th class="stats__table-header" colspan="2">Mapped</th>\n    <td class="stats__table-element">${d(Tt(e._data._notes,i),2)}</td>\n    </tr>\n    <tr>\n    <th class="stats__table-header" rowspan="3">Peak</th>\n    <th class="stats__table-header">16-beat</th>\n    <td class="stats__table-element">${d(Lt(e._data._notes,16,n.value),2)}</td>\n    </tr>\n    <tr>\n    <th class="stats__table-header">8-beat</th>\n    <td class="stats__table-element">${d(Lt(e._data._notes,8,n.value),2)}</td>\n    </tr>\n    <tr>\n    <th class="stats__table-header">4-beat</th>\n    <td class="stats__table-element">${d(Lt(e._data._notes,4,n.value),2)}</td>\n    </tr>`,o})(t,c)),m.append(document.createElement("br")),m.append(((t,e)=>{const n=M(t._beatsPerMinute),r=un(e,n),i=document.createElement("table");return i.className="stats__table",i.innerHTML=`<caption class="stats__table-caption">Swing Per Seconds (SPS):</caption>\n    <tr>\n    <th class="stats__table-header"></th>\n    <th class="stats__table-header">Total</th>\n    <th class="stats__table-header">Red</th>\n    <th class="stats__table-header">Blue</th>\n    </tr>\n    <tr>\n    <th class="stats__table-header">Overall</th>\n    <td class="stats__table-element">${d(r.total.overall,2)}</td>\n    <td class="stats__table-element">${d(r.red.overall,2)}</td>\n    <td class="stats__table-element">${d(r.blue.overall,2)}</td>\n    </tr>\n    <tr>\n    <th class="stats__table-header">Median</th>\n    <td class="stats__table-element">${d(r.total.median,2)}</td>\n    <td class="stats__table-element">${d(r.red.median,2)}</td>\n    <td class="stats__table-element">${d(r.blue.median,2)}</td>\n    </tr>\n    <tr>\n    <th class="stats__table-header">Peak</th>\n    <td class="stats__table-element">${d(r.total.peak,2)}</td>\n    <td class="stats__table-element">${d(r.red.peak,2)}</td>\n    <td class="stats__table-element">${d(r.blue.peak,2)}</td>\n    </tr>\n    <tr>\n    <th class="stats__table-header">Total</th>\n    <td class="stats__table-element">${r.total.total}</td>\n    <td class="stats__table-element">${r.red.total}</td>\n    <td class="stats__table-element">${r.blue.total}</td>\n    </tr>`,i})(t,c)),_.append(((t,e)=>{const n=M(t._beatsPerMinute),r=Et(e._data._notes);let i=`<caption class="stats__table-caption">Note Information:</caption>\n    <tr>\n    <th class="stats__table-header" colspan="2">Max Score</th>\n    <td class="stats__table-element">${o=(t=>{let e=0,n=1;for(let r=0;r<t;r++)n<8&&r===4*n-3&&(n*=2),e+=115*n;return e})(r.red.total+r.blue.total),o.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}</td>\n    </tr>\n    <tr>\n    <th class="stats__table-header" colspan="2">Effective BPM</th>\n    <td class="stats__table-element">${d(((t,e)=>Math.max(...rn(t,e).map((t=>t._ebpm)),0))(e._data._notes,n),2)}</td>\n    </tr>\n    <tr>\n    <th class="stats__table-header" colspan="2">Effective BPM (swing)</th>\n    <td class="stats__table-element">${d(((t,e)=>Math.max(...on(t,e).map((t=>t._ebpm)),0))(e._data._notes,n),2)}</td>\n    </tr>`;var o;let a=d(1e3*((t,e)=>Math.max(...ln(t,e).map((t=>t._minSpeed)),0))(e._data._notes,n),1),s=d(1e3*((t,e)=>{const n=ln(t,e).map((t=>t._maxSpeed));return n.length?Math.min(...n):0})(e._data._notes,n),1);a&&s&&(i+=`\n        <tr>\n        <th class="stats__table-header" colspan="2">Min. Slider Speed</th>\n        <td class="stats__table-element">${a}ms</td>\n        </tr>\n        <tr>\n        <th class="stats__table-header" colspan="2">Max. Slider Speed</th>\n        <td class="stats__table-element">${s}ms</td>\n        </tr>`);const l=document.createElement("table");return l.className="stats__table",l.innerHTML=i,l})(t,c)),_.append(document.createElement("br")),_.append(((t,e)=>{var n;const r=Yr(`stats__table-select-placement-${e._mode}-${e._difficulty}`,"Note Placement: ","caption","stats__table-caption",{text:"All",value:"all"},{text:"Note Only",value:"note"},{text:"Red Note",value:"red"},{text:"Blue Note",value:"blue"},{text:"Bomb",value:"bomb"});null===(n=r.querySelector("select"))||void 0===n||n.addEventListener("change",wa);let i=`<tbody id="stats__table-placement-${e._mode}-${e._difficulty}">${Ea(e._data._notes)}</tbody>`;const o=document.createElement("table");return o.className="stats__table",o.innerHTML=i,o.prepend(r),o})(0,c)),_.append(document.createElement("br")),_.append(((t,e)=>{var n;const r=Yr(`stats__table-select-angle-${e._mode}-${e._difficulty}`,"Note Angle: ","caption","stats__table-caption",{text:"All",value:"all"},{text:"Note Only",value:"note"},{text:"Red Note",value:"red"},{text:"Blue Note",value:"blue"},{text:"Bomb",value:"bomb"});null===(n=r.querySelector("select"))||void 0===n||n.addEventListener("change",ka);let i=`<tbody id="stats__table-angle-${e._mode}-${e._difficulty}">${xa(e._data._notes)}</tbody>`;const o=document.createElement("table");return o.className="stats__table",o.innerHTML=i,o.prepend(r),o})(0,c)),f.append(((t,e)=>{const n=Et(e._data._notes);let r=`<caption class="stats__table-caption">Notes: ${n.red.total+n.blue.total}<br>R/B Ratio: ${d(n.red.total/n.blue.total,2)}</caption>\n    <tr>\n    <th class="stats__table-header"></th>\n    <th class="stats__table-header">Red</th>\n    <th class="stats__table-header">Blue</th>\n    <th class="stats__table-header">Bomb</th>\n    </tr>\n    <tr>\n    <th class="stats__table-header">Total</th>\n    <td class="stats__table-element">${n.red.total}</td>\n    <td class="stats__table-element">${n.blue.total}</td>\n    <td class="stats__table-element">${n.bomb.total}</td>\n    </tr>`;(n.red.chroma||n.blue.chroma||n.bomb.chroma)&&(r+=`<tr>\n        <th class="stats__table-header">Chroma</th>\n        <td class="stats__table-element">${n.red.chroma}</td>\n        <td class="stats__table-element">${n.blue.chroma}</td>\n        <td class="stats__table-element">${n.bomb.chroma}</td>\n        </tr>`),(n.red.noodleExtensions||n.blue.noodleExtensions||n.bomb.noodleExtensions)&&(r+=`<tr>\n        <th class="stats__table-header">NE</th>\n        <td class="stats__table-element">${n.red.noodleExtensions}</td>\n        <td class="stats__table-element">${n.blue.noodleExtensions}</td>\n        <td class="stats__table-element">${n.bomb.noodleExtensions}</td>\n        </tr>`),(n.red.mappingExtensions||n.blue.mappingExtensions||n.bomb.mappingExtensions)&&(r+=`<tr>\n        <th class="stats__table-header">ME</th>\n        <td class="stats__table-element">${n.red.mappingExtensions}</td>\n        <td class="stats__table-element">${n.blue.mappingExtensions}</td>\n        <td class="stats__table-element">${n.bomb.mappingExtensions}</td>\n        </tr>`);const i=document.createElement("table");return i.className="stats__table",i.innerHTML=r,i})(0,c)),f.append(document.createElement("br")),f.append(((t,e)=>{const n=(t=>{const e={};for(let t=jt.length-1;t>=0;t--)e[jt[t]]={total:0,chroma:0,chromaOld:0,noodleExtensions:0,mappingExtensions:0};for(let x=t.length-1;x>=0;x--)At(t[x])&&(e[t[x]._type]||(e[t[x]._type]={total:0,chroma:0,chromaOld:0,noodleExtensions:0,mappingExtensions:0}),e[t[x]._type].total++,n=t[x],r=void 0,i=void 0,o=void 0,a=void 0,s=void 0,l=void 0,c=void 0,u=void 0,d=void 0,h=void 0,p=void 0,m=void 0,_=void 0,f=void 0,g=void 0,b=void 0,v=void 0,y=void 0,w=void 0,E=void 0,k=void 0,(Nt(n)?Array.isArray(null===(r=n._customData)||void 0===r?void 0:r._color)||"number"==typeof(null===(i=n._customData)||void 0===i?void 0:i._lightID)||Array.isArray(null===(o=n._customData)||void 0===o?void 0:o._lightID)||"number"==typeof(null===(a=n._customData)||void 0===a?void 0:a._propID)||"object"==typeof(null===(s=n._customData)||void 0===s?void 0:s._lightGradient):8===n._type?"string"==typeof(null===(l=n._customData)||void 0===l?void 0:l._nameFilter)||"boolean"==typeof(null===(c=n._customData)||void 0===c?void 0:c._reset)||"number"==typeof(null===(u=n._customData)||void 0===u?void 0:u._rotation)||"number"==typeof(null===(d=n._customData)||void 0===d?void 0:d._step)||"number"==typeof(null===(h=n._customData)||void 0===h?void 0:h._prop)||"number"==typeof(null===(p=n._customData)||void 0===p?void 0:p._speed)||"number"==typeof(null===(m=n._customData)||void 0===m?void 0:m._direction)||"boolean"==typeof(null===(_=n._customData)||void 0===_?void 0:_._counterSpin)||"number"==typeof(null===(f=n._customData)||void 0===f?void 0:f._stepMult)||"number"==typeof(null===(g=n._customData)||void 0===g?void 0:g._propMult)||"number"==typeof(null===(b=n._customData)||void 0===b?void 0:b._speedMult):9===n._type?"number"==typeof(null===(v=n._customData)||void 0===v?void 0:v._step):Ot(n)&&("boolean"==typeof(null===(y=n._customData)||void 0===y?void 0:y._lockPosition)||"number"==typeof(null===(w=n._customData)||void 0===w?void 0:w._speed)||"number"==typeof(null===(E=n._customData)||void 0===E?void 0:E._preciseSpeed)||"number"==typeof(null===(k=n._customData)||void 0===k?void 0:k._direction)))&&e[t[x]._type].chroma++,zt(t[x])&&e[t[x]._type].chromaOld++,Pt(t[x])&&e[t[x]._type].noodleExtensions++,Ft(t[x])&&e[t[x]._type].mappingExtensions++);var n,r,i,o,a,s,l,c,u,d,h,p,m,_,f,g,b,v,y,w,E,k;return e})(e._data._events);let r=0,i=0,o=0,a=0,s=`<caption class="stats__table-caption">Events: ${Object.values(n).reduce(((t,{total:e})=>t+e),0)}</caption>`;for(const t in n)r+=n[t].chroma,i+=n[t].chromaOld,o+=n[t].noodleExtensions,a+=n[t].mappingExtensions,s+=`<tr>\n        <th class="stats__table-header" colspan="2">${Rt[t]}</th>\n        <td class="stats__table-element">${n[t].total}</td>\n        </tr>`;r&&(s+=`<tr>\n        <th class="stats__table-header" colspan="2">Chroma</th>\n        <td class="stats__table-element">${r}</td>\n        </tr>`),i&&(s+=`<tr>\n        <th class="stats__table-header" colspan="2">OG Chroma</th>\n        <td class="stats__table-element">${i}</td>\n        </tr>`),o&&(s+=`<tr>\n        <th class="stats__table-header" colspan="2">Noodle Extensions</th>\n        <td class="stats__table-element">${o}</td>\n        </tr>`),a&&(s+=`<tr>\n        <th class="stats__table-header" colspan="2">Mapping Extensions</th>\n        <td class="stats__table-element">${a}</td>\n        </tr>`);const l=document.createElement("table");return l.className="stats__table",l.innerHTML=s,l})(0,c)),f.append(document.createElement("br")),f.append(((t,e)=>{const n=(t=>{const e={total:0,interactive:0,crouch:0,chroma:0,noodleExtensions:0,mappingExtensions:0};for(let r=t.length-1;r>=0;r--)e.total++,Z(t[r])&&e.interactive++,1===(n=t[r])._type&&(n._width>2||2===n._width&&1===n._lineIndex)&&e.crouch++,J(t[r])&&e.chroma++,G(t[r])&&e.noodleExtensions++,K(t[r])&&e.mappingExtensions++;var n;return e})(e._data._obstacles);let r=`<caption class="stats__table-caption">Obstacles: ${n.total}</caption>`;n.interactive&&(r+=`<tr>\n        <th class="stats__table-header" colspan="2">Interactive</th>\n        <td class="stats__table-element">${n.interactive}</td>\n        </tr>`),n.crouch&&(r+=`<tr>\n        <th class="stats__table-header" colspan="2">Crouch</th>\n        <td class="stats__table-element">${n.crouch}</td>\n        </tr>`),n.chroma&&(r+=`<tr>\n        <th class="stats__table-header" colspan="2">Chroma</th>\n        <td class="stats__table-element">${n.chroma}</td>\n        </tr>`),n.noodleExtensions&&(r+=`<tr>\n        <th class="stats__table-header" colspan="2">Noodle Extensions</th>\n        <td class="stats__table-element">${n.noodleExtensions}</td>\n        </tr>`),n.mappingExtensions&&(r+=`<tr>\n        <th class="stats__table-header" colspan="2">Mapping Extensions</th>\n        <td class="stats__table-element">${n.mappingExtensions}</td>\n        </tr>`);const i=document.createElement("table");return i.className="stats__table",i.innerHTML=r,i})(0,c)),h.appendChild(m),h.appendChild(_),h.appendChild(f),n.appendChild(u)})),ya.appendChild(n)}))},Sa=t=>{const e=document.querySelectorAll(".input-toggle");e.length?e.forEach((e=>{e.disabled=t})):console.error("UI Input: empty list, intentional or typo error?")};var Ta=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))};const La=t=>Ta(void 0,void 0,void 0,(function*(){return new Promise((function(e,n){const r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="json",r.timeout=5e3;let i=Date.now();r.onprogress=()=>{r.timeout+=Date.now()-i},r.onload=()=>{200===r.status&&e(r.response),404===r.status&&n("Error 404: Map does not exist"),403===r.status&&n("Error 403: Forbidden"),n(`Error ${r.status}`)},r.onerror=()=>{n("Error downloading")},r.ontimeout=()=>{n("Connection timeout")},r.send()}))}));var Ia=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{l(r.next(t))}catch(t){o(t)}}function s(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}l((r=r.apply(t,e||[])).next())}))};const Da=t=>Ia(void 0,void 0,void 0,(function*(){let e;try{e=f(t)}catch(t){return Ze("info",t,0),void console.error(t)}try{Sa(!0),Ze("info","Requesting download from link",0),console.log(`downloading from ${e}`);let t=yield Na("https://cors-anywhere.herokuapp.com/"+e);A(e),Ba(t)}catch(t){Sa(!1),Ze("error",t,100)}})),Ra=t=>Ia(void 0,void 0,void 0,(function*(){let e;try{e=g(t)}catch(t){throw Ze("info",t,0),console.error(t),new Error(t)}try{Sa(!0),console.log(`fetching download URL from BeatSaver for map ID ${e}`),Ze("info","Fetching download URL from BeatSaver",0);const t=yield(t=>Ta(void 0,void 0,void 0,(function*(){const e=`https://api.beatsaver.com/maps/id/${t}`,n=yield La(e);if(null==n?void 0:n.versions.length)return n.versions[n.versions.length-1].downloadURL;throw new Error("could not find map download link")})))(e);console.log(`downloading from BeatSaver for map ID ${e}`),Ze("info","Requesting download from BeatSaver",0);const n=yield Na(t);A("https://beatsaver.com/maps/"+e,e),Ba(n)}catch(t){Sa(!1),Ze("error",t,100),console.error(t)}})),Aa=t=>Ia(void 0,void 0,void 0,(function*(){let e;try{if(!b(t.trim()))throw new Error("invalid hash");e=t.trim()}catch(t){throw Ze("info",t,0),console.error(t),new Error(t)}try{Sa(!0),console.log(`fetching download URL from BeatSaver for map hash ${e}`),Ze("info","Fetching download URL from BeatSaver",0);const t=yield(t=>Ta(void 0,void 0,void 0,(function*(){const e=`https://api.beatsaver.com/maps/hash/${t}`,n=yield La(e);if(null==n?void 0:n.versions.length)return n.versions[n.versions.length-1].downloadURL;throw new Error("could not find map download link")})))(e);console.log(`downloading from BeatSaver for map hash ${e}`),Ze("info","Requesting download from BeatSaver",0);const n=yield Na(t);Ba(n)}catch(t){Sa(!1),Ze("error",t,100),console.error(t)}})),Na=t=>Ia(void 0,void 0,void 0,(function*(){return new Promise((function(e,n){const r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.timeout=5e3;let i=Date.now();r.onprogress=t=>{r.timeout+=Date.now()-i,Ze("download",`Downloading map: ${d(t.loaded/1024/1024,1)}MB / ${d(t.total/1024/1024,1)}MB`,t.loaded/t.total*100)},r.onload=()=>{200===r.status&&e(r.response),404===r.status&&n("Error 404: Map/link does not exist"),403===r.status&&n("Error 403: Forbidden"),n(`Error ${r.status}`)},r.onerror=()=>{n("Error downloading")},r.ontimeout=()=>{n("Connection timeout")},r.send()}))})),Ba=t=>Ia(void 0,void 0,void 0,(function*(){Ze("info","Extracting zip",0);let e=new(Je());console.time("loading time");try{D(!0),e=yield Je().loadAsync(t),yield Ma(e)}catch(t){Qt(),Sa(!1),D(!1),Ze("error",t,100),console.error(t)}console.timeEnd("loading time")})),Ma=t=>Ia(void 0,void 0,void 0,(function*(){var e,n,r;Ze("info","Parsing map info...",0),console.log("parsing map info");const i=t.file("Info.dat")||t.file("info.dat");if(!i)throw new Error("Couldn't find Info.dat");{Sa(!0);let a=yield i.async("string");te._mapInfo=yield JSON.parse(a),o=te._mapInfo,ot.sorting&&(o._difficultyBeatmapSets.sort(((t,e)=>z[t._beatmapCharacteristicName]-z[e._beatmapCharacteristicName])),o._difficultyBeatmapSets.forEach((t=>{let e=0;t._difficultyBeatmaps.forEach((t=>{t._difficultyRank-e<=0&&console.error(t._difficulty+" may be unordered"),j[t._difficulty]!==t._difficultyRank&&console.error(t._difficulty+" has invalid rank"),e=t._difficultyRank})),t._difficultyBeatmaps.sort(((t,e)=>e._difficultyRank-t._difficultyRank))}))),(t=>{var e,n;n=t._songName,x?x.textContent=n:console.error("UI Header: missing HTML element for song name"),(t=>{C?C.textContent=t:console.error("UI Header: missing HTML element for song subname")})(t._songSubName),(t=>{S?S.textContent=t:console.error("UI Header: missing HTML element for song author")})(t._songAuthorName),((t,e,n)=>{if(!T)return void console.error("UI Header: missing HTML element for song bpm");null==e&&"number"==typeof n&&(e=Math.min(t,n)),null==n&&"number"==typeof e&&(n=Math.max(t,e));let r=d(t,2).toString()+"BPM";T.textContent=r})(t._beatsPerMinute),we(t._levelAuthorName),Ee(t._environmentName),ke(null===(e=t._customData)||void 0===e?void 0:e._editors)})(te._mapInfo),Ze("info","Loading image...",10.4375),console.log("loading cover image");let s=t.file(te._mapInfo._coverImageFilename);if(ot.load.imageCover&&s){let t=yield s.async("base64");R("data:image;base64,"+t),Ge.map.load.image=!0}else console.error(`${te._mapInfo._coverImageFilename} does not exists.`);if(te._contributors=[],null===(n=null===(e=te._mapInfo)||void 0===e?void 0:e._customData)||void 0===n?void 0:n._contributors)for(const e of te._mapInfo._customData._contributors)console.log("loading contributor image "+e._name),s=t.file(e._iconPath),ot.load.imageContributor&&s?e._base64=yield s.async("base64"):console.error(`${e._iconPath} does not exists.`),te._contributors.push(e);Ze("info","Loading audio...",20.875),console.log("loading audio");let l=t.file(te._mapInfo._songFilename);if(ot.load.audio&&l){let t=!1;setTimeout((()=>{t||Ze("info","Loading audio... (this may take a while)",20.875)}),1e4);let e=yield l.async("arraybuffer");(t=>{var e,n,r,i;e=void 0,n=void 0,i=function*(){if(!I)return void console.error("UI Header: missing HTML element for audio");const e=new Blob([t],{type:"audio/ogg"});I.src=window.URL.createObjectURL(e)},new((r=void 0)||(r=Promise))((function(t,o){function a(t){try{l(i.next(t))}catch(t){o(t)}}function s(t){try{l(i.throw(t))}catch(t){o(t)}}function l(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(t){t(n)}))).then(a,s)}l((i=i.apply(e,n||[])).next())}))})(e);let n=new AudioContext;yield n.decodeAudioData(e).then((e=>{t=!0;let n=e.duration;te._duration=n,N(n),Ge.map.load.audio=!0})).catch((function(t){N(),console.error(t)}))}else N(),console.error(`${te._mapInfo._songFilename} does not exist.`);Ze("info","Parsing difficulty...",70),te._mapSet=[];const c=te._mapInfo._difficultyBeatmapSets;for(let e=c.length-1;e>=0;e--){const n=c[e]._difficultyBeatmaps;if(0!==n.length&&n)for(let i=0;i<n.length;i++){const o=n[i],a=t.file(o._beatmapFilename);if(a){console.log(`parsing ${c[e]._beatmapCharacteristicName} ${o._difficulty}`);let t,n=JSON.parse(yield a.async("string"));try{t=at(n)}catch(t){throw new Error(`${c[e]._beatmapCharacteristicName} ${o._difficulty} ${t}`)}null===(r=te._mapSet)||void 0===r||r.push({_mode:c[e]._beatmapCharacteristicName,_difficulty:o._difficulty,_info:o,_data:t,_environment:te._mapInfo._environmentName})}else if(console.error(`Missing ${o._beatmapFilename} file for ${c[e]._beatmapCharacteristicName} ${o._difficulty}, ignoring.`),c[e]._difficultyBeatmaps.splice(i,1),i--,c[e]._difficultyBeatmaps.length<1){console.error(`${c[e]._beatmapCharacteristicName} difficulty set now empty, ignoring.`),c.splice(e,1);continue}}else console.error("Empty difficulty set, removing..."),c.splice(e,1)}(()=>{const t=te._mapInfo;if(!t)throw new Error("UI Tools: could not find map info");var e;e=M(t._beatsPerMinute),Qo().sort(((t,e)=>t.order.output-e.order.output)).forEach((t=>{t.input.adjustTime&&t.input.adjustTime(e)}))})(),Ze("info","Adding map difficulty stats...",80),console.log("adding map stats"),Ca(),Ce(te._contributors),Ze("info","Analysing map...",85),console.log("analysing map"),(()=>{var t;let e=te._mapInfo;if(!e)return void console.error("could not analyse, missing map info");let n=M(e._beatsPerMinute);te._analysis||ta(),null===(t=te._mapSet)||void 0===t||t.forEach((t=>{var e;return null===(e=te._analysis)||void 0===e?void 0:e.sps.push({mode:t._mode,difficulty:t._difficulty,sps:un(t,n)})}))})(),(()=>{var t,e,n;const r=te._mapInfo;if(!r)return void console.error("could not analyse, missing map info");te._analysis||ta();const i=null===(t=te._analysis)||void 0===t?void 0:t.general,o=null===(e=te._analysis)||void 0===e?void 0:e.sps,a=M(r._beatsPerMinute),s={_bpm:a,_njs:Q(a),_audioDuration:null!==(n=te._duration)&&void 0!==n?n:null,_mapDuration:0},l=Yo().sort(((t,e)=>t.order.output-e.order.output));console.log("analysing general");const c=[];l.forEach((t=>{if(t.input.enabled)try{t.run(s,void 0,r,o),t.output.html&&c.push(t.output.html)}catch(t){console.error(t)}})),i&&(i.html=c)})(),(()=>{var t;if(!da)throw new Error("UI Tools: output general is missing");const e=null===(t=te._analysis)||void 0===t?void 0:t.general;e?e.html?(da.innerHTML="",e.html.forEach((t=>da.appendChild(t))),da.firstChild||(da.textContent="No issues found.")):da.textContent="ERROR: could not find HTML for general":da.textContent="ERROR: could not find analysis for general"})(),Ze("info","Analysing difficulty...",90),na(),ga(te._mapInfo),ma(),Sa(!1),Ze("info","Map successfully loaded!")}var o})),Oa=document.querySelector(".input__intro-url"),za=document.querySelector(".input__intro-id"),Pa=document.querySelector(".input__intro-hash"),Fa=document.querySelector(".input__search-button"),ja=document.querySelector(".input__file"),$a=document.querySelector(".input__file-zone");function Ua(t){const e=t.target;"Enter"===t.key&&""!==e.value&&(e.classList.contains("input__intro-url")&&Da(e.value),e.classList.contains("input__intro-id")&&Ra(e.value))}Oa?Oa.addEventListener("keydown",Ua):console.error("UI Intro: URL input is missing"),za?za.addEventListener("keydown",Ua):console.error("UI Intro: ID input is missing"),Pa?Pa.addEventListener("keydown",Ua):console.error("UI Intro: Hash input is missing"),Fa?Fa.addEventListener("click",(function(t){Oa&&""!==Oa.value?Da(Oa.value):za&&""!==za.value?Ra(za.value):Pa&&""!==Pa.value&&Aa(Pa.value)})):console.error("UI Intro: search button is missing"),ja?ja.addEventListener("change",(function(t){const e=t.target;Ze("info","Reading file input",0);const n=e.files?e.files[0]:null;try{if(null==n)throw Ze("info","No file input",0),new Error("No file input");if(!n||".zip"!==n.name.substr(-4)&&".bsl"!==n.name.substr(-4))throw new Error("Unsupported file format, please enter zip file");{const t=new FileReader;t.readAsArrayBuffer(n),t.addEventListener("load",(()=>{Ba(n)}))}}catch(t){Ze("error",t,0),console.error(t)}})):console.error("UI Intro: file input is missing"),$a?($a.addEventListener("drop",(function(t){t.preventDefault(),t.stopPropagation();try{if(null==t.dataTransfer)throw new Error("No file input");if(t.dataTransfer.items&&"file"===t.dataTransfer.items[0].kind){let e=t.dataTransfer.items[0].getAsFile();if(!e||".zip"!==e.name.substr(-4)&&".bsl"!==e.name.substr(-4))throw new Error("Unsupported file format, please enter zip file");{const t=new FileReader;t.readAsArrayBuffer(e),t.addEventListener("load",(()=>{Ba(e)}))}}}catch(t){Ze("error",t,0),console.error(t)}})),$a.addEventListener("dragover",(function(t){t.preventDefault(),t.stopPropagation()}))):console.error("UI Intro: file drop zone is missing");const Ha=document.querySelector("body"),qa=t=>{Ha.className="theme-"+t.toLowerCase().replace(" ","")},Za=document.querySelector(".settings__theme"),Wa=document.querySelectorAll(".settings__load"),Ja=document.querySelector(".settings__sort"),Ga=document.querySelectorAll(".settings__show"),Ka=document.querySelectorAll(".settings__onload"),Xa=document.querySelector(".settings__clear-button");function Va(t){const e=t.target,n=e.id.replace("settings__show-","");ot.show[n]=e.checked,ot.save()}Za?(Za.addEventListener("change",(function(t){const e=t.target;ot.theme=e.options[e.options.selectedIndex].value,qa(ot.theme),ot.save()})),["Dark","Light","Monochrome"].forEach((t=>{const e=document.createElement("option");e.value=t,e.textContent=t,Za.add(e)}))):console.error("UI Settings: theme select is missing"),Wa.length||console.error("UI Settings: empty load list, intentional or typo error?"),Wa.forEach((t=>t.addEventListener("change",Qa))),Ja?Ja.addEventListener("change",(function(t){const e=t.target;ot.sorting=e.checked,ot.save()})):console.error("UI Settings: sort check is missing"),Ka.length||console.error("UI Settings: empty onload list, intentional or typo error?"),Ka.forEach((t=>t.addEventListener("change",es))),Ga.length||console.error("UI Settings: empty show list, intentional or typo error?"),Ga.forEach((t=>t.addEventListener("change",Va))),Xa?Xa.addEventListener("click",(function(){ot.clear(),ot.reset(),location.reload()})):console.error("UI Settings: clear button is missing");const Ya=(t,e)=>{Ga.forEach((n=>{n.id.endsWith(t)&&(n.checked=e)}))};function Qa(t){const e=t.target,n=e.name;ot.load[n]=e.checked,ot.save()}const ts=(t,e)=>{Wa.forEach((n=>{n.name===t&&(n.checked=e)}))};function es(t){const e=t.target,n=e.name;ot.onLoad[n]=e.checked,ot.save()}const ns=(t,e)=>{Ka.forEach((n=>{n.name===t&&(n.checked=e)}))};function rs(){Ze("info","No map loaded",0),D(!1),R(null),A(),N(0),I?(I.src="",window.URL.revokeObjectURL(void 0)):console.error("UI Header: missing HTML element for audio"),we(),Ee(),ke(),Ce(),Le(),Ie(),De(),Re(),Ae(),Ne(),Be(),Me(),Oe(),ze(),Pe(),Fe(),da&&(da.innerHTML="No output."),ua&&(ua.innerHTML="No output."),_a("Difficulty Label"),ga(),(()=>{if(ya)for(;ya.firstChild;)ya.removeChild(ya.firstChild);else console.error("UI Stats: HTML stats does not exist")})(),Qt()}document.querySelectorAll(".input__reset-button").forEach((t=>t.addEventListener("click",rs)));const is=new class{constructor(){this._version="v2.2.5",this._wm="Kival Evan#5480"}get value(){return this._version}get watermark(){return this._wm}},os=document.querySelectorAll(".link__watermark"),as=document.querySelectorAll(".link__version");os.length&&as.length||console.error("UI Footer: missing part");const ss=function(){let t=!1;return function(){if(!t){t=!0,(t=>{Za?Za.value=t:console.error("UI Settings: input element is missing")})(ot.theme),n=is.watermark,os.forEach((t=>t.textContent=n)),(t=>{as.forEach((e=>e.textContent=t))})(is.value),aa&&sa&&la&&ca?[...Go(),...Ko(),...Xo(),...Vo(),...Yo()].sort(((t,e)=>t.order.input-e.order.input)).forEach((t=>{if(t.input.html)switch(t.type){case"note":aa.appendChild(t.input.html);break;case"obstacle":sa.appendChild(t.input.html);break;case"event":la.appendChild(t.input.html);break;case"other":ca.appendChild(t.input.html);break;case"general":console.log("UI Tools: ignoring general tool for "+t.name);break;default:console.error("UI Tools: could not recognise type "+t.type+" for "+t.name)}})):console.error("UI Tools: could not find tools content");for(const t in ot.load)ts(t,ot.load[t]);e=ot.sorting,Ja&&(Ja.checked=e);for(const t in ot.show)c(t,ot.show[t]),Ya(t,ot.show[t]);for(const t in ot.onLoad)ns(t,ot.onLoad[t]);qa(ot.theme),console.log("user interface initialised")}var e,n}}(),ls=new URL(location.href),cs=ls.searchParams.get("url"),us=ls.searchParams.get("id"),ds=ls.searchParams.get("hash");ss(),cs?Da(f(decodeURI(cs))):us?Ra(g(decodeURI(us))):ds&&b(decodeURI(ds).trim())&&Aa(decodeURI(ds).trim())})()})();