(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function i(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(o){if(o.ep)return;o.ep=!0;const r=i(o);fetch(o.href,r)}})();document.querySelectorAll(".accordion__button");function Oh(t){return t.toString().split(".").map((e,i)=>i?e:e.replace(/\B(?=(\d{3})+(?!\d))/g,",")).join(".")}Nh(Math.random());function Nh(t){t=t.toString();let e=0;for(let i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e|=0;return e}function M(t,e=0){const i=Math.pow(10,e);return Math.round(t*i)/i}function oo(t){return t*(180/Math.PI)}function _i(t){return t*(Math.PI/180)}function zo(t,e){const i=t%e;return i<0?i+e:i}function Vo(t,e,i){return Math.min(zo(t-e,i),zo(e-t,i))}function Yn(t){if(!t.length)return 0;const e=t.map(n=>n).sort((n,o)=>n-o),i=Math.floor(e.length/2);return e.length%2?e[i]:(e[i-1]+e[i])/2}function au(t,e,i){return Math.min(Math.max(e,t),i)}function Ih(t,e,i){return e===i?1:(t-e)/(i-e)}function Rn(t,e,i){return e+(i-e)*t}function Ah(t,e,i){return(t-e)/(i-e)}function lu(t,e,i,n,o){const r=Ah(t,e,i);return Rn(r,n,o)}function Nt(t){return t==null||typeof t!="object"?t:Array.isArray(t)?[...t]:{...t}}function W(t){if(t==null||typeof t!="object")return t;const e=Array.isArray(t)?Array(t.length):{};for(const i in t)e[i]=W(t[i]);return e}function yo(t){return/^[a-fA-F0-9]+$/g.test(t)}function He(t){return parseInt(t,16)}function on(t,e,i,n){Array.isArray(t)&&(n=t[3],i=t[2],e=t[1],t=t[0]),t=t,e=e,i=i;let o=0;const r=Math.max(t,e,i),a=Math.min(t,e,i),s=r-a,l=r===0?0:s/r,c=r;switch(r){case a:break;case t:o=e-i+s*(e<i?6:0),o/=6*s;break;case e:o=i-t+s*2,o/=6*s;break;case i:o=t-e+s*4,o/=6*s;break}const h=[o*360,l,c];return typeof n=="number"&&h.push(n),h}function Ph(t,e,i,n){Array.isArray(t)&&(n=t[3],i=t[2],e=t[1],t=t[0]),t=t/360,e=e,i=i,t<0&&(t+=Math.abs(Math.floor(t)));let o=0,r=0,a=0;const s=Math.floor(t*6),l=t*6-s,c=i*(1-e),h=i*(1-l*e),p=i*(1-(1-l)*e);switch(s%6){case 0:o=i,r=p,a=c;break;case 1:o=h,r=i,a=c;break;case 2:o=c,r=i,a=p;break;case 3:o=c,r=h,a=i;break;case 4:o=p,r=c,a=i;break;case 5:o=i,r=c,a=h;break}const d=[o,r,a];return typeof n=="number"&&d.push(n),d}function rn(t){const e=t.toString(16);return e.length===1?"0"+e:e}function $h(t){return Math.round(t*255)}function Ie(t){return t/255}function ie(t,e){if(Array.isArray(t)){const n={r:t[0],g:t[1],b:t[2]};return typeof t[3]=="number"&&(n.a=t[3]),e&&(n.a??(n.a=1)),n}if(typeof t=="string"||"type"in t)return ie(ue(t),e);const i={r:t.r,g:t.g,b:t.b};return typeof t.a=="number"&&(i.a=t.a),e&&(i.a??(i.a=1)),i}function pt(t){const e=ie(t);let i=1;for(const n in e)i=Math.max(Math.abs(e[n]),i);for(const n in e)e[n]=$h(e[n]/i);return`#${rn(e.r)}${rn(e.g)}${rn(e.b)}${typeof e.a=="number"?rn(e.a):""}`}function me(t){if(t=t.trim(),t.startsWith("#")&&(t=t.substring(1)),!yo(t))throw new Error("Not valid hexadecimal");let e=[0,0,0];if(t.length===3||t.length===4)e=[Ie(He(t.slice(0,1)+t.slice(0,1))),Ie(He(t.slice(1,2)+t.slice(1,2))),Ie(He(t.slice(2,3)+t.slice(2,3)))],t.length===4&&e.push(Ie(He(t.slice(3,4)+t.slice(3,4))));else if(t.length===6||t.length===8)e=[Ie(He(t.slice(0,2))),Ie(He(t.slice(2,4))),Ie(He(t.slice(4,6)))],t.length===8&&e.push(Ie(He(t.slice(6,8))));else throw new Error("Not valid colour hexadecimal");return e}function yi(t,e="rgba",i="rgba"){if(typeof t=="string"){const n=me(t);return i==="hsva"?on(n):n}else if(Array.isArray(t)){if(e==="hsva")return i==="hsva"?[...t]:Ph(t);const n=e==="rgba255"?t.map(o=>Ie(o)):[...t];return i==="hsva"?on(n):n}else if("type"in t){let n;switch(t.type){case"hsva":n=ue(t.value,"hsva");break;case"rgba":n=ue(t.value,"rgba");break;case"rgba255":n=ue(t.value,"rgba255")}return i==="hsva"?on(n):n}else{const n=[t.r,t.g,t.b];return typeof t.a=="number"&&n.push(t.a),i==="hsva"?on(n):n}}function Go(t){let e=t[0],i=t[1],n=t[2],o,r,a;e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92,o=(e*.4124+i*.3576+n*.1805)/.95047,r=(e*.2126+i*.7152+n*.0722)/1,a=(e*.0193+i*.1192+n*.9505)/1.08883,o=o>.008856?Math.pow(o,1/3):7.787*o+16/116,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,a=a>.008856?Math.pow(a,1/3):7.787*a+16/116;const s=[116*r-16,500*(o-r),200*(r-a)];return typeof t[3]=="number"&&s.push(t[3]),s}function Ho(t,e){let i=0;return t>=0&&e===0?0:t<0&&e===0?180:t===0&&e>0?90:t===0&&e<0?270:(t>0&&e>0&&(i=0),t<0&&(i=180),t>0&&e<0&&(i=360),oo(Math.atan(e/t))+i)}function ro(t,e){const[i,n,o]=Go(t),[r,a,s]=Go(e),l=1,c=1,h=1;let p,d,u,m,b,y,v,_,w,C,T,P,A,V,O,Y,et,S,$,g;return p=Math.sqrt(n*n+o*o),d=Math.sqrt(a*a+s*s),u=(p+d)/2,b=.5*(1-Math.sqrt((u^7)/((u^7)+30))),w=(1+b)*n,p=Math.sqrt(w*w+o*o),y=Ho(w,o),w=(1+b)*a,d=Math.sqrt(w*w+s*s),v=Ho(w,s),S=r-i,$=d-p,p*d==0?g=0:(w=M(v-y,12),Math.abs(w)<=180?g=v-y:w>180?g=v-y-360:g=v-y+360),g=2*Math.sqrt(p*d)*Math.sin(_i(g/2)),C=(i+r)/2,m=(p+d)/2,p*d==0?_=y+v:(w=Math.abs(M(y-v,12)),w>180?v+y<360?_=y+v+360:_=y+v-360:_=y+v,_/=2),T=1-.17*Math.cos(_i(_-30))+.24*Math.cos(_i(2*_))+.32*Math.cos(_i(3*_+6))-.2*Math.cos(_i(4*_-63)),O=30*Math.exp(-((_-275)/25)*((_-275)/25)),Y=2*Math.sqrt((m^7)/((m^7)+30)),P=1+.015*((C-50)*(C-50))/Math.sqrt(20+(C-50)*(C-50)),A=1+.045*m,V=1+.015*m*T,et=-Math.sin(_i(2*O))*Y,S=S/(l*P),$=$/(c*A),g=g/(h*V),Math.sqrt(S*S+$*$+g*g+et*$*g)}function ue(){const t=arguments;if(typeof t[0]=="number"&&typeof t[1]=="number"&&typeof t[2]=="number"){let e=[t[0],t[1],t[2]];return typeof t[3]=="number"&&e.push(t[3]),typeof t[3]=="string"&&(t[3]==="hsva"&&(e=yi(e,"hsva")),t[3]==="rgba255"&&(e=yi(e,"rgba255"))),typeof t[4]=="string"&&(t[4]==="hsva"&&(e=yi(e,"hsva")),t[4]==="rgba255"&&(e=yi(e,"rgba255"))),e}if(typeof t[0]=="number")return typeof t[1]=="boolean"&&t[1]?[t[0]/255,t[0]/255,t[0]/255]:typeof t[1]=="number"?[t[0],t[0],t[0],t[1]]:[t[0],t[0],t[0]];if(typeof t[0]=="string")return me(t[0]);if(Array.isArray(t[0])){const e=t[0];let i=[e[0],e[1],e[2]];if(!i.every(n=>typeof n=="number"))throw new Error("Unable to parse color; array contain undefined or non-numeric value");return typeof e[3]=="number"&&i.push(e[3]),typeof t[1]=="string"&&(t[1]==="hsva"&&(i=yi(i,"hsva")),t[1]==="rgba255"&&(i=yi(i,"rgba255"))),i}if(typeof t[0]=="object"){const e=t[0];if("type"in e)switch(e.type){case"hsva":return ue(e.value,"hsva");case"rgba":return ue(e.value,"rgba");case"rgba255":return ue(e.value,"rgba255")}if("r"in e&&"g"in e&&"b"in e){const i=[e.r,e.g,e.b];if(!i.every(n=>typeof n=="number"))throw new Error("Unable to parse color; array contain undefined or non-numeric value");return typeof e.a=="number"&&i.push(e.a),i}}throw new Error("Unable to parse color; input is invalid")}function Zt(t){if(!t)return"0:00";const e=Math.floor(t),i=e/60,n=i<0?`-${Math.ceil(i).toString()}`:Math.floor(i).toString(),o=Math.abs(e%60).toString().padStart(2,"0");return`${n}:${o}`}function Mh(t){if(!t)return"0:00:00";const e=Math.abs(Math.round(t*60%60)).toString().padStart(2,"0");return`${Zt(t>0?Math.floor(t):Math.ceil(t))}:${e}`}function gn(t){var i;if(!t)return"0:00.000";const e=((i=(t%1).toString().split(".")[1])==null?void 0:i.padEnd(3,"0").slice(0,3))||"000";return`${Zt(t>0?Math.floor(t):Math.ceil(t))}.${e}`}function uu(t){return Array.isArray(t)&&t.length===3&&t.every(e=>typeof e=="number")}function Te(t,e){if(!t)return t;if(typeof e=="number")return t.map(i=>i*e);if(t=[...t],e)if(Array.isArray(e))for(let i=0;i<t.length;i++)typeof e[i]=="number"&&(t[i]*=e[i]);else switch(t.length){case 4:t[3]=t[3]*(e.w??1);case 3:t[2]=t[2]*(e.z??1);case 2:t[1]=t[1]*(e.y??1),t[0]=t[0]*(e.x??1)}return t}const Uo=document.querySelector(".intro"),Wo=document.querySelector(".metadata"),Ei=document.querySelector(".cover__link"),cu=document.querySelector(".cover__image"),Fh=document.querySelector(".metadata__song-name"),jh=document.querySelector(".metadata__song-subname"),zh=document.querySelector(".metadata__song-author"),Vh=document.querySelector(".metadata__song-bpm"),Xn=document.querySelector(".metadata__song-duration"),hu=document.querySelector(".audio");function mu(t){t?(Uo.classList.remove("hidden"),Wo.classList.add("hidden")):(Uo.classList.add("hidden"),Wo.classList.remove("hidden"))}function fu(t){cu.src=t||"./img/unknown.jpg"}function Gh(){return cu.src}function pu(t,e){if(t==null&&e==null){Ei.textContent="",Ei.href="",Ei.classList.add("disabled");return}t!=null&&(Ei.textContent=e??"Download Link",Ei.href=t,Ei.classList.remove("disabled"))}function Hh(t){Fh.textContent=t}function Uh(t){jh.textContent=t}function Wh(t){zh.textContent=t}function Yh(t,e,i){e==null&&typeof i=="number"&&(e=Math.min(t,i)),i==null&&typeof e=="number"&&(i=Math.max(t,e));let n=M(t,2).toString()+"BPM";e&&i&&e!==i&&(n+=` (${M(e,2)}-${M(i,2)})`),Vh.textContent=n}function du(t){typeof t=="number"?Xn.textContent=gn(t):typeof t=="string"?Xn.textContent=t:Xn.textContent="No audio"}async function Xh(t){const e=new Blob([t],{type:"audio/ogg"});hu.src=window.URL.createObjectURL(e)}function bu(){hu.src="",window.URL.revokeObjectURL("")}function qh(){mu(!0),fu(null),pu(),du(0),bu()}const At={switchHeader:mu,setCoverImage:fu,getCoverImage:Gh,setCoverLink:pu,setSongName:Hh,setSongSubname:Uh,setSongAuthor:Wh,setSongBPM:Yh,setSongDuration:du,setAudio:Xh,unloadAudio:bu,reset:qh};var sn=function(t,e,i,n,o){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!o:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?o.call(t,i):o?o.value=i:e.set(t,i),i},Ee=function(t,e,i,n){if(i==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return i==="m"?n:i==="a"?n.call(t):n?n.value:e.get(t)},vn,Ci,_n,we;function Kh(t){return`\x1B[33m${t}\x1B[39m`}function Zh(t){return`\x1B[31m${t}\x1B[39m`}function Yo(t){return`\x1B[2m${t}\x1B[22m`}var Bt;(function(t){t[t.NONE=0]="NONE",t[t.ERROR=1]="ERROR",t[t.WARN=2]="WARN",t[t.INFO=3]="INFO",t[t.DEBUG=4]="DEBUG",t[t.TRACE=5]="TRACE"})(Bt||(Bt={}));class Mn{constructor(){Ci.set(this,Bt.INFO),_n.set(this,(e,i)=>`${vn.LogPrefixes.get(i)} ${Yo(">")} [${Yo(e.join("::"))}]`),we.set(this,"script")}set logLevel(e){sn(this,Ci,e,"f"),this.tInfo(["logger","logLevel"],`Log level set to ${vn.LogPrefixes.get(e)}`)}get logLevel(){return Ee(this,Ci,"f")}set tagPrint(e){sn(this,_n,e,"f"),this.tInfo(["logger","tagPrint"],"Update tag print function")}get tagPrint(){return Ee(this,_n,"f")}set untagged(e){sn(this,we,e.trim(),"f"),this.tInfo(["logger","untagged"],`Update untagged string to ${Ee(this,we,"f")}`)}get untagged(){return Ee(this,we,"f")}log(e,i,n){if(e>Ee(this,Ci,"f"))return;const o=this.tagPrint(i,e);switch(e){case Bt.TRACE:return o?console.trace(o,...n):console.trace(...n);case Bt.DEBUG:return o?console.debug(o,...n):console.debug(...n);case Bt.INFO:return o?console.info(o,...n):console.info(...n);case Bt.WARN:return o?console.warn(o,...n):console.warn(...n);case Bt.ERROR:return o?console.error(o,...n):console.error(...n);default:return o?console.log(o,...n):console.log(...n)}}setLevel(e){e=Math.min(Math.max(e,0),5),sn(this,Ci,e,"f"),this.tInfo(["logger","setLevel"],`Log level set to ${vn.LogPrefixes.get(e)}`)}tTrace(e,...i){this.log(Bt.TRACE,e,i)}tDebug(e,...i){this.log(Bt.DEBUG,e,i)}tInfo(e,...i){this.log(Bt.INFO,e,i)}tWarn(e,...i){this.log(Bt.WARN,e,i)}tError(e,...i){this.log(Bt.ERROR,e,i)}trace(...e){this.tTrace([Ee(this,we,"f")],...e)}debug(...e){this.tDebug([Ee(this,we,"f")],...e)}info(...e){this.tInfo([Ee(this,we,"f")],...e)}warn(...e){this.tWarn([Ee(this,we,"f")],...e)}error(...e){this.tError([Ee(this,we,"f")],...e)}}vn=Mn,Ci=new WeakMap,_n=new WeakMap,we=new WeakMap;Object.defineProperty(Mn,"LogLevels",{enumerable:!0,configurable:!0,writable:!0,value:Bt});Object.defineProperty(Mn,"LogPrefixes",{enumerable:!0,configurable:!0,writable:!0,value:new Map([[Bt.TRACE,"TRACE"],[Bt.DEBUG,"DEBUG"],[Bt.INFO,"INFO"],[Bt.WARN,Kh("WARN")],[Bt.ERROR,Zh("!!ERROR!!")],[Bt.NONE,"NONE"]])});let J=new Mn;class Jh{clone(){return new this.constructor(this)}}class Oe extends Jh{constructor(){super(...arguments),Object.defineProperty(this,"customData",{enumerable:!0,configurable:!0,writable:!0,value:{}})}setCustomData(e){return this.customData=e,this}resetCustomData(){return this.customData={},this}removeCustomData(e){return typeof e=="string"?delete this.customData[e]:e.forEach(i=>delete this.customData[i]),this}addCustomData(e){for(const i in e)this.customData[i]=e[i];return this}sort(e){return e==null||e(this),this}perform(e){return e(this),this}isValid(e,i){return e?!!e(this):!0}check(e){return e?!!e(this):!1}}class Ne extends Oe{constructor(){super(...arguments),Object.defineProperty(this,"time",{enumerable:!0,configurable:!0,writable:!0,value:0})}setTime(e){return this.time=e,this}}var rt;(function(t){t[t.NONE=-1]="NONE",t[t.RED=0]="RED",t[t.BLUE=1]="BLUE"})(rt||(rt={}));var x;(function(t){t[t.UP=0]="UP",t[t.DOWN=1]="DOWN",t[t.LEFT=2]="LEFT",t[t.RIGHT=3]="RIGHT",t[t.UP_LEFT=4]="UP_LEFT",t[t.UP_RIGHT=5]="UP_RIGHT",t[t.DOWN_LEFT=6]="DOWN_LEFT",t[t.DOWN_RIGHT=7]="DOWN_RIGHT",t[t.ANY=8]="ANY"})(x||(x={}));var ut;(function(t){t[t.LEFT=0]="LEFT",t[t.MIDDLE_LEFT=1]="MIDDLE_LEFT",t[t.MIDDLE_RIGHT=2]="MIDDLE_RIGHT",t[t.RIGHT=3]="RIGHT"})(ut||(ut={}));var Lt;(function(t){t[t.BOTTOM=0]="BOTTOM",t[t.MIDDLE=1]="MIDDLE",t[t.TOP=2]="TOP"})(Lt||(Lt={}));var wt;(function(t){t[t.OFF=0]="OFF",t[t.BLUE_ON=1]="BLUE_ON",t[t.BLUE_FLASH=2]="BLUE_FLASH",t[t.BLUE_FADE=3]="BLUE_FADE",t[t.BLUE_TRANSITION=4]="BLUE_TRANSITION",t[t.RED_ON=5]="RED_ON",t[t.RED_FLASH=6]="RED_FLASH",t[t.RED_FADE=7]="RED_FADE",t[t.RED_TRANSITION=8]="RED_TRANSITION",t[t.WHITE_ON=9]="WHITE_ON",t[t.WHITE_FLASH=10]="WHITE_FLASH",t[t.WHITE_FADE=11]="WHITE_FADE",t[t.WHITE_TRANSITION=12]="WHITE_TRANSITION"})(wt||(wt={}));var It;(function(t){t[t.BACK_LASERS=0]="BACK_LASERS",t[t.RING_LIGHTS=1]="RING_LIGHTS",t[t.LEFT_LASERS=2]="LEFT_LASERS",t[t.RIGHT_LASERS=3]="RIGHT_LASERS",t[t.CENTER_LIGHTS=4]="CENTER_LIGHTS",t[t.COLOR_BOOST=5]="COLOR_BOOST",t[t.EXTRA_LEFT_LIGHTS=6]="EXTRA_LEFT_LIGHTS",t[t.EXTRA_RIGHT_LIGHTS=7]="EXTRA_RIGHT_LIGHTS",t[t.RING_ROTATION=8]="RING_ROTATION",t[t.RING_ZOOM=9]="RING_ZOOM",t[t.EXTRA_LEFT_LASERS=10]="EXTRA_LEFT_LASERS",t[t.EXTRA_RIGHT_LASERS=11]="EXTRA_RIGHT_LASERS",t[t.LEFT_LASER_ROTATION=12]="LEFT_LASER_ROTATION",t[t.RIGHT_LASER_ROTATION=13]="RIGHT_LASER_ROTATION",t[t.EARLY_LANE_ROTATION=14]="EARLY_LANE_ROTATION",t[t.LATE_LANE_ROTATION=15]="LATE_LANE_ROTATION",t[t.UTILITY_EVENT_0=16]="UTILITY_EVENT_0",t[t.UTILITY_EVENT_1=17]="UTILITY_EVENT_1",t[t.UTILITY_EVENT_2=18]="UTILITY_EVENT_2",t[t.UTILITY_EVENT_3=19]="UTILITY_EVENT_3",t[t.SPECIAL_EVENT_0=40]="SPECIAL_EVENT_0",t[t.SPECIAL_EVENT_1=41]="SPECIAL_EVENT_1",t[t.SPECIAL_EVENT_2=42]="SPECIAL_EVENT_2",t[t.SPECIAL_EVENT_3=43]="SPECIAL_EVENT_3",t[t.BPM_CHANGE=100]="BPM_CHANGE"})(It||(It={}));var so;(function(t){t[t.DIVISION=1]="DIVISION",t[t.STEP_AND_OFFSET=2]="STEP_AND_OFFSET"})(so||(so={}));var ao;(function(t){t[t.NONE=0]="NONE",t[t.DURATION=1]="DURATION",t[t.DISTRIBUTION=2]="DISTRIBUTION",t[t.ALL=3]="ALL"})(ao||(ao={}));var lo;(function(t){t[t.NO_RANDOM=0]="NO_RANDOM",t[t.KEEP_ORDER=1]="KEEP_ORDER",t[t.RANDOM_ELEMENTS=2]="RANDOM_ELEMENTS",t[t.ALL=3]="ALL"})(lo||(lo={}));var Xo;(function(t){t[t.NONE=-1]="NONE",t[t.RED=0]="RED",t[t.BLUE=1]="BLUE",t[t.WHITE=2]="WHITE"})(Xo||(Xo={}));var qo;(function(t){t[t.WAVE=1]="WAVE",t[t.STEP=2]="STEP"})(qo||(qo={}));var ji;(function(t){t[t.NONE=-1]="NONE",t[t.LINEAR=0]="LINEAR",t[t.IN_QUAD=1]="IN_QUAD",t[t.OUT_QUAD=2]="OUT_QUAD",t[t.INOUT_QUAD=3]="INOUT_QUAD",t[t.IN_SINE=4]="IN_SINE",t[t.OUT_SINE=5]="OUT_SINE",t[t.INOUT_SINE=6]="INOUT_SINE",t[t.IN_CUBIC=7]="IN_CUBIC",t[t.OUT_CUBIC=8]="OUT_CUBIC",t[t.INOUT_CUBIC=9]="INOUT_CUBIC",t[t.IN_QUART=10]="IN_QUART",t[t.OUT_QUART=11]="OUT_QUART",t[t.INOUT_QUART=12]="INOUT_QUART",t[t.IN_QUINT=13]="IN_QUINT",t[t.OUT_QUINT=14]="OUT_QUINT",t[t.INOUT_QUINT=15]="INOUT_QUINT",t[t.IN_EXPO=16]="IN_EXPO",t[t.OUT_EXPO=17]="OUT_EXPO",t[t.INOUT_EXPO=18]="INOUT_EXPO",t[t.IN_CIRC=19]="IN_CIRC",t[t.OUT_CIRC=20]="OUT_CIRC",t[t.INOUT_CIRC=21]="INOUT_CIRC",t[t.IN_BACK=22]="IN_BACK",t[t.OUT_BACK=23]="OUT_BACK",t[t.INOUT_BACK=24]="INOUT_BACK",t[t.IN_ELASTIC=25]="IN_ELASTIC",t[t.OUT_ELASTIC=26]="OUT_ELASTIC",t[t.INOUT_ELASTIC=27]="INOUT_ELASTIC",t[t.IN_BOUNCE=28]="IN_BOUNCE",t[t.OUT_BOUNCE=29]="OUT_BOUNCE",t[t.INOUT_BOUNCE=30]="INOUT_BOUNCE",t[t.BS_INOUT_BACK=100]="BS_INOUT_BACK",t[t.BS_INOUT_ELASTIC=101]="BS_INOUT_ELASTIC",t[t.BS_INOUT_BOUNCE=102]="BS_INOUT_BOUNCE"})(ji||(ji={}));var uo;(function(t){t[t.EARLY=0]="EARLY",t[t.LATE=1]="LATE"})(uo||(uo={}));var ci;(function(t){t[t.INSTANT=0]="INSTANT",t[t.INTERPOLATE=1]="INTERPOLATE",t[t.EXTEND=2]="EXTEND"})(ci||(ci={}));var Ko;(function(t){t[t.X=0]="X",t[t.Y=1]="Y",t[t.Z=2]="Z"})(Ko||(Ko={}));var co;(function(t){t[t.INT=0]="INT",t[t.FLOAT=1]="FLOAT",t[t.BOOL=2]="BOOL"})(co||(co={}));var Zo;(function(t){t[t.AUTOMATIC=0]="AUTOMATIC",t[t.CLOCKWISE=1]="CLOCKWISE",t[t.COUNTER_CLOCKWISE=2]="COUNTER_CLOCKWISE"})(Zo||(Zo={}));var Jo;(function(t){t[t.STRAIGHT=0]="STRAIGHT",t[t.CLOCKWISE=1]="CLOCKWISE",t[t.COUNTER_CLOCKWISE=2]="COUNTER_CLOCKWISE"})(Jo||(Jo={}));var ke;(function(t){t[t.NONE=0]="NONE",t[t.COLOR=1]="COLOR",t[t.ROTATION=2]="ROTATION",t[t.TRANSLATION=3]="TRANSLATION",t[t.FX_FLOAT=4]="FX_FLOAT"})(ke||(ke={}));const Fn=4,_e={[x.UP]:180,[x.DOWN]:0,[x.LEFT]:270,[x.RIGHT]:90,[x.UP_LEFT]:225,[x.UP_RIGHT]:135,[x.DOWN_LEFT]:315,[x.DOWN_RIGHT]:45,[x.ANY]:0},Qh={[x.UP]:x.DOWN,[x.DOWN]:x.UP,[x.LEFT]:x.RIGHT,[x.RIGHT]:x.LEFT,[x.UP_LEFT]:x.DOWN_RIGHT,[x.UP_RIGHT]:x.DOWN_LEFT,[x.DOWN_LEFT]:x.UP_RIGHT,[x.DOWN_RIGHT]:x.UP_LEFT,[x.ANY]:x.ANY},qn={[x.UP]:[0,1],[x.DOWN]:[0,-1],[x.LEFT]:[-1,0],[x.RIGHT]:[1,0],[x.UP_LEFT]:[-1,1],[x.UP_RIGHT]:[1,1],[x.DOWN_LEFT]:[-1,-1],[x.DOWN_RIGHT]:[1,-1],[x.ANY]:[0,0]},gu={0:-60,1:-45,2:-30,3:-15,4:15,5:30,6:45,7:60},vu={"-60":0,"-45":1,"-30":2,"-15":3,15:4,30:5,45:6,60:7};class Pe extends Ne{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"floatValue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.time=e.time??Pe.defaultValue.time,this.type=e.type??Pe.defaultValue.type,this.value=e.value??Pe.defaultValue.value,this.floatValue=e.floatValue??Pe.defaultValue.floatValue,this.customData=W(e.customData??Pe.defaultValue.customData)}isValidType(){return this.type>=0&&this.type<=19||this.type>=40&&this.type<=43||this.type===100}isValid(e,i){return i?super.isValid(e,i):super.isValid(e,i)&&this.isValidType()&&this.value>=0&&!(!this.isLaserRotationEvent()&&this.value>12&&!this.isOldChroma())}setType(e){return this.type=e,this}setValue(e){return this.value=e,this}setFloatValue(e){return this.floatValue=e,this}isOff(){return this.value===wt.OFF}isOn(){return this.value===wt.BLUE_ON||this.value===wt.RED_ON||this.value===wt.WHITE_ON}isFlash(){return this.value===wt.BLUE_FLASH||this.value===wt.RED_FLASH||this.value===wt.WHITE_FLASH}isFade(){return this.value===wt.BLUE_FADE||this.value===wt.RED_FADE||this.value===wt.WHITE_FADE}isTransition(){return this.value===wt.BLUE_TRANSITION||this.value===wt.RED_TRANSITION||this.value===wt.WHITE_TRANSITION}isBlue(){return this.value===wt.BLUE_ON||this.value===wt.BLUE_FLASH||this.value===wt.BLUE_FADE||this.value===wt.BLUE_TRANSITION}isRed(){return this.value===wt.RED_ON||this.value===wt.RED_FLASH||this.value===wt.RED_FADE||this.value===wt.RED_TRANSITION}isWhite(){return this.value===wt.WHITE_ON||this.value===wt.WHITE_FLASH||this.value===wt.WHITE_FADE||this.value===wt.WHITE_TRANSITION}isLightEvent(){return this.type===0||this.type===1||this.type===2||this.type===3||this.type===4||this.type===6||this.type===7||this.type===10||this.type===11}isColorBoost(){return this.type===It.COLOR_BOOST}isRingEvent(){return this.type===It.RING_ROTATION||this.type===It.RING_ZOOM}isLaserRotationEvent(){return this.type===It.LEFT_LASER_ROTATION||this.type===It.RIGHT_LASER_ROTATION}isLaneRotationEvent(){return this.type===It.EARLY_LANE_ROTATION||this.type===It.LATE_LANE_ROTATION}isExtraEvent(){return this.type===It.UTILITY_EVENT_0||this.type===It.UTILITY_EVENT_1||this.type===It.UTILITY_EVENT_2||this.type===It.UTILITY_EVENT_3}isSpecialEvent(){return this.type===It.SPECIAL_EVENT_0||this.type===It.SPECIAL_EVENT_1||this.type===It.SPECIAL_EVENT_2||this.type===It.SPECIAL_EVENT_3}isBpmEvent(){return this.type===It.BPM_CHANGE}isLightingEvent(){return this.isLightEvent()||this.isRingEvent()||this.isLaserRotationEvent()||this.isExtraEvent()}isOldChroma(){return this.value>=2e9}}Object.defineProperty(Pe,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,type:0,value:0,floatValue:0,customData:{}}});const be={DefaultEnvironment:"The First",OriginsEnvironment:"Origins",TriangleEnvironment:"The First",NiceEnvironment:"The First",BigMirrorEnvironment:"The First",DragonsEnvironment:"The First",KDAEnvironment:"KDA",MonstercatEnvironment:"The First",CrabRaveEnvironment:"Crab Rave",PanicEnvironment:"The First",RocketEnvironment:"Rocket",GreenDayEnvironment:"Green Day",GreenDayGrenadeEnvironment:"Green Day",TimbalandEnvironment:"Timbaland",FitBeatEnvironment:"FitBeat",LinkinParkEnvironment:"Linkin Park",BTSEnvironment:"BTS",KaleidoscopeEnvironment:"Kaleidoscope",InterscopeEnvironment:"Interscope",SkrillexEnvironment:"Skrillex",BillieEnvironment:"Billie Eilish",HalloweenEnvironment:"Spooky",GagaEnvironment:"Gaga",WeaveEnvironment:"Weave",PyroEnvironment:"Pyro",EDMEnvironment:"EDM",TheSecondEnvironment:"The Second",LizzoEnvironment:"Lizzo",TheWeekndEnvironment:"The Weeknd",RockMixtapeEnvironment:"Rock Mixtape",Dragons2Environment:"Dragons 2.0",Panic2Environment:"Panic 2.0",QueenEnvironment:"Queen",LinkinPark2Environment:"Linkin Park 2.0",TheRollingStonesEnvironment:"The Rolling Stones",LatticeEnvironment:"Lattice",DaftPunkEnvironment:"Daft Punk",HipHopEnvironment:"Hip Hop Mixtape",ColliderEnvironment:"Collider",BritneyEnvironment:"Britney Spears",GlassDesertEnvironment:"Glass Desert",MultiplayerEnvironment:"Origins"},tm={_colorLeft:"Left Note Color",_colorRight:"Right Note Color",_envColorLeft:"Left Environment Color",_envColorRight:"Right Environment Color",_envColorWhite:"White Environment Color",_envColorLeftBoost:"Left Environment Boost Color",_envColorRightBoost:"Right Environment Boost Color",_envColorWhiteBoost:"White Environment Boost Color",_obstacleColor:"Obstacle Color"},em={saberLeftColor:"Left Note Color",saberRightColor:"Right Note Color",environment0Color:"Left Environment Color",environment1Color:"Right Environment Color",environmentWColor:"White Environment Color",environment0ColorBoost:"Left Environment Boost Color",environment1ColorBoost:"Right Environment Boost Color",environmentWColorBoost:"White Environment Boost Color",obstaclesColor:"Obstacle Color"},ge={"Default Custom":{_colorLeft:{r:.7529412,g:.1882353,b:.1882353},_colorRight:{r:.1254902,g:.3921569,b:.6588235},_envColorLeft:{r:.7529412,g:.1882353,b:.1882353},_envColorRight:{r:.1882353,g:.5960785,b:1},_obstacleColor:{r:1,g:.1882353,b:.1882353}},"The First":{_colorLeft:{r:.7843137,g:.07843138,b:.07843138},_colorRight:{r:.1568627,g:.5568627,b:.8235294},_envColorLeft:{r:.85,g:.08499997,b:.08499997},_envColorRight:{r:.1882353,g:.675294,b:1},_obstacleColor:{r:1,g:.1882353,b:.1882353}},Origins:{_colorLeft:{r:.6792453,g:.5712628,b:0},_colorRight:{r:.7075472,g:0,b:.5364411},_envColorLeft:{r:.4910995,g:.6825916,b:.7},_envColorRight:{r:.03844783,g:.6862745,b:.9056604},_obstacleColor:{r:.06167676,g:.2869513,b:.3962264}},KDA:{_colorLeft:{r:.6588235,g:.2627451,b:.1607843},_colorRight:{r:.5019608,g:.08235294,b:.572549},_envColorLeft:{r:1,g:.3960785,b:.2431373},_envColorRight:{r:.7607844,g:.1254902,b:.8666667},_obstacleColor:{r:1,g:.3960785,b:.2431373}},"Crab Rave":{_colorLeft:{r:0,g:.7130001,b:.07806564},_colorRight:{r:.04805952,g:.5068096,b:.734},_envColorLeft:{r:.134568,g:.756,b:.1557533},_envColorRight:{r:.05647058,g:.6211764,b:.9},_envColorLeftBoost:{r:.1333333,g:.7568628,b:.1568628},_envColorRightBoost:{r:.05490196,g:.6196079,b:.9019608},_obstacleColor:{r:0,g:.8117648,b:.09019608}},Noir:{_colorLeft:{r:.1792453,g:.1792453,b:.1792453},_colorRight:{r:.5943396,g:.5943396,b:.5943396},_envColorLeft:{r:.4056604,g:.4056604,b:.4056604},_envColorRight:{r:.6037736,g:.6037736,b:.6037736},_obstacleColor:{r:.2358491,g:.2358491,b:.2358491}},Rocket:{_colorLeft:{r:1,g:.4980392,b:0},_colorRight:{r:0,g:.5294118,b:1},_envColorLeft:{r:.9,g:.4866279,b:.3244186},_envColorRight:{r:.4,g:.7180724,b:1},_obstacleColor:{r:.3176471,g:.6117647,b:.7254902}},"Green Day":{_colorLeft:{r:.2588235,g:.7843138,b:.01960784},_colorRight:{r:0,g:.7137255,b:.6705883},_envColorLeft:{r:0,g:.7137255,b:.6705883},_envColorRight:{r:.2588235,g:.7843137,b:.01960784},_obstacleColor:{r:0,g:.8117648,b:.09019608}},Timbaland:{_colorLeft:{r:.5019608,g:.5019608,b:.5019608},_colorRight:{r:.1,g:.5517647,b:1},_envColorLeft:{r:.1,g:.5517647,b:1},_envColorRight:{r:.1,g:.5517647,b:1},_obstacleColor:{r:.5,g:.5,b:.5}},FitBeat:{_colorLeft:{r:.8000001,g:.6078432,b:.1568628},_colorRight:{r:.7921569,g:.1607843,b:.682353},_envColorLeft:{r:.8,g:.5594772,b:.5594772},_envColorRight:{r:.5594772,g:.5594772,b:.8},_obstacleColor:{r:.2784314,g:.2784314,b:.4}},"Linkin Park":{_colorLeft:{r:.6627451,g:.1643608,b:.1690187},_colorRight:{r:.3870196,g:.5168997,b:.5568628},_envColorLeft:{r:.7529412,g:.672753,b:.5925647},_envColorRight:{r:.6241197,g:.6890281,b:.709},_envColorLeftBoost:{r:.922,g:.5957885,b:.255394},_envColorRightBoost:{r:.282353,g:.4586275,b:.6235294},_obstacleColor:{r:.6627451,g:.1647059,b:.172549}},BTS:{_colorLeft:{r:1,g:.09019607,b:.4059771},_colorRight:{r:.8018868,g:0,b:.7517689},_envColorLeft:{r:.7843137,g:.1254902,b:.5010797},_envColorRight:{r:.6941177,g:.1254902,b:.8666667},_envColorLeftBoost:{r:.9019608,g:.5411765,b:1},_envColorRightBoost:{r:.3490196,g:.8078431,b:1},_obstacleColor:{r:.6698113,g:.1800908,b:.5528399}},Kaleidoscope:{_colorLeft:{r:.6588235,g:.1254902,b:.1254902},_colorRight:{r:.282353,g:.282353,b:.282353},_envColorLeft:{r:.6588235,g:.1254902,b:.1254902},_envColorRight:{r:.4705882,g:.4705882,b:.4705882},_envColorLeftBoost:{r:.5019608,g:0,b:0},_envColorRightBoost:{r:.4924452,g:0,b:.5372549},_obstacleColor:{r:.2509804,g:.2509804,b:.2509804}},Interscope:{_colorLeft:{r:.7264151,g:.6269099,b:.3118103},_colorRight:{r:.5895709,g:.2978884,b:.723},_envColorLeft:{r:.7242536,g:.319804,b:.9137255},_envColorRight:{r:.7647059,g:.7589706,b:.7188236},_envColorLeftBoost:{r:.7924528,g:.4298683,b:.4298683},_envColorRightBoost:{r:.7038,g:.7157449,b:.765},_obstacleColor:{r:.5882353,g:.2980392,b:.7215686}},Skrillex:{_colorLeft:{r:.6980392,g:.1411765,b:.3686275},_colorRight:{r:.3293333,g:.323,b:.38},_envColorLeft:{r:.8,g:.28,b:.5859449},_envColorRight:{r:.06525807,g:.578,b:.5686774},_envColorLeftBoost:{r:.8117648,g:.3058824,b:.3058824},_envColorRightBoost:{r:.2784314,g:.8,b:.4459763},_obstacleColor:{r:.1568628,g:.6039216,b:.6039216}},"Billie Eilish":{_colorLeft:{r:.8,g:.6448193,b:.432},_colorRight:{r:.5480851,g:.6127659,b:.64},_envColorLeft:{r:.8196079,g:.442,b:.184},_envColorRight:{r:.9411765,g:.706771,b:.5647059},_envColorLeftBoost:{r:.8,g:0,b:0},_envColorRightBoost:{r:.5568628,g:.7019608,b:.7764707},_obstacleColor:{r:.7132531,g:.5614098,b:.7830189}},Spooky:{_colorLeft:{r:.8196079,g:.4980788,b:.2770275},_colorRight:{r:.3789474,g:.3578947,b:.4},_envColorLeft:{r:.9019608,g:.2300923,b:0},_envColorRight:{r:.4600588,g:.5688943,b:.9294118},_envColorLeftBoost:{r:.3376843,g:.6320754,b:.3369081},_envColorRightBoost:{r:.6020907,g:.3280082,b:.8584906},_obstacleColor:{r:.8196079,g:.4431373,b:.1843137}},Gaga:{_colorLeft:{r:.85,g:.4333333,b:.7833334},_colorRight:{r:.4705882,g:.8,b:.4078431},_envColorLeft:{r:.708,g:.649,b:.2394706},_envColorRight:{r:.894,g:.1625455,b:.7485644},_envColorLeftBoost:{r:.754717,g:.3610244,b:.2207191},_envColorRightBoost:{r:0,g:.7058824,b:1},_obstacleColor:{r:.9921569,g:0,b:.7719755}},"Glass Desert":{_colorLeft:{r:.6792453,g:.5712628,b:0},_colorRight:{r:.7075472,g:0,b:.5364411},_envColorLeft:{r:.32222217,g:.6111111,b:.75},_envColorRight:{r:.03844783,g:.62239975,b:.90566039},_obstacleColor:{r:.06167676,g:.2869513,b:.3962264}},Weave:{_colorLeft:{r:.7843137,g:.07843138,b:.07843138},_colorRight:{r:.1568627,g:.5568627,b:.8235294},_envColorLeft:{r:.85,g:.08499997,b:.08499997},_envColorRight:{r:.1882353,g:.675294,b:1},_envColorLeftBoost:{r:.8218409,g:.08627451,b:.8509804},_envColorRightBoost:{r:.6320754,g:.6320754,b:.6320754},_obstacleColor:{r:1,g:.1882353,b:.1882353}},Pyro:{_colorLeft:{r:.5764706,g:0,b:.03921569},_colorRight:{r:1,g:.6705883,b:0},_envColorLeft:{r:1,g:.1098039,b:.2039216},_envColorRight:{r:.8862745,g:.7372549,b:.2627451},_envColorLeftBoost:{r:1,g:0,b:.1764706},_envColorRightBoost:{r:.7647059,g:.7647059,b:.7647059},_obstacleColor:{r:.8490566,g:.7037643,b:.4285333}},EDM:{_colorLeft:{r:.6320754,g:.6320754,b:.6320754},_colorRight:{r:.1764706,g:.6980392,b:.8784314},_envColorLeft:{r:.08220173,g:.7169812,b:0},_envColorRight:{r:0,g:.3671638,b:.7169812},_envColorLeftBoost:{r:.735849,g:0,b:.1758632},_envColorRightBoost:{r:.4284593,g:0,b:.754717},_obstacleColor:{r:.1764706,g:.6980392,b:.8784314}},"The Second":{_colorLeft:{r:.7843137,g:.07843138,b:.07843138},_colorRight:{r:.1568627,g:.5568627,b:.8235294},_envColorLeft:{r:.85,g:.08499997,b:.08499997},_envColorRight:{r:.1882353,g:.675294,b:1},_envColorLeftBoost:{r:.8235294,g:.08627451,b:.8509804},_envColorRightBoost:{r:0,g:1,b:.6478302},_obstacleColor:{r:1,g:.1882353,b:.1882353}},Lizzo:{_colorLeft:{r:1,g:.8132076,b:.3773585},_colorRight:{r:.6705883,g:.254902,b:.8980392},_envColorLeft:{r:.8392157,g:.6470588,b:.2156863},_envColorRight:{r:.8196079,g:.2392157,b:.8784314},_envColorLeftBoost:{r:1,g:.4,b:.5529412},_envColorRightBoost:{r:.3686275,g:.7960784,b:1},_obstacleColor:{r:1,g:.5020987,b:.1882353}},"The Weeknd":{_colorLeft:{r:.5843138,g:.1294118,b:.1294118},_colorRight:{r:.2235294,g:.2901961,b:.3294118},_envColorLeft:{r:1,g:.2979701,b:.1411765},_envColorRight:{r:.1668743,g:.3753689,b:.7075472},_envColorWhite:{r:.8773585,g:.8773585,b:.8773585},_envColorLeftBoost:{r:.9568628,g:.6039216,b:.1215686},_envColorRightBoost:{r:.5254902,g:.8274511,b:.9921569},_envColorWhiteBoost:{r:.9811321,g:.9308866,b:.8608046},_obstacleColor:{r:.9176471,g:.2980392,b:.007843138}},"Rock Mixtape":{_colorLeft:{r:.6,g:.4233,b:.042},_colorRight:{r:.6006,g:.7441199,b:.78},_envColorLeft:{r:.75,g:.12,b:.162},_envColorRight:{r:.95,g:.5820333,b:.1615},_envColorLeftBoost:{r:.96,g:.1344,b:.9187202},_envColorRightBoost:{r:.378,g:.813,b:.9},_obstacleColor:{r:1,g:1,b:1}},"Dragons 2.0":{_colorLeft:{r:.7264151,g:.6587077,b:.2809719},_colorRight:{r:.2509804,g:.7647059,b:.405098},_envColorLeft:{r:.01960784,g:.9960785,b:.06666667},_envColorRight:{r:0,g:.05490196,b:1},_envColorLeftBoost:{r:.9764706,g:.03137255,b:.01960784},_envColorRightBoost:{r:1,g:.8292086,b:.2264151},_obstacleColor:{r:.5548979,g:.2470588,b:1}},"Panic 2.0":{_colorLeft:{r:.9019608,g:.3333333,b:.5686275},_colorRight:{r:.1529412,g:.5568628,b:.4862745},_envColorLeft:{r:.6980392,g:.1137255,b:.372549},_envColorRight:{r:.1882353,g:.6196079,b:.6235294},_envColorWhite:{r:.8329412,g:.9008105,b:.9254902},_envColorLeftBoost:{r:.9019608,g:.4470589,b:.06666667},_envColorRightBoost:{r:.6365692,g:.4373443,b:.8584906},_envColorWhiteBoost:{r:.8803849,g:.8313726,b:.9254902},_obstacleColor:{r:.9686275,g:.3803922,b:.2745098}},Queen:{_colorLeft:{r:.58,g:.5675714,b:.5551428},_colorRight:{r:.5236231,g:.1345675,b:.6792453},_envColorLeft:{r:.9333334,g:.6392157,b:.1215686},_envColorRight:{r:.04313726,g:.7176471,b:.8980393},_envColorLeftBoost:{r:.7686275,g:.145098,b:.07450981},_envColorRightBoost:{r:.4,g:.007843138,b:.7254902},_obstacleColor:{r:.9333334,g:.6392157,b:.1215686}},"Linkin Park 2.0":{_colorLeft:{r:.6627451,g:.1643608,b:.1690187},_colorRight:{r:.3870196,g:.5168997,b:.5568628},_envColorLeft:{r:.6627451,g:.1647059,b:.172549},_envColorRight:{r:.6235294,g:.6901961,b:.7098039},_envColorWhite:{r:.7529413,g:.6745098,b:.5921569},_envColorLeftBoost:{r:.922,g:.5957885,b:.255394},_envColorRightBoost:{r:.282353,g:.4586275,b:.6235294},_obstacleColor:{r:.6627451,g:.1647059,b:.172549}},"The Rolling Stones":{_colorLeft:{r:.8980392,g:0,b:.1150319},_colorRight:{r:.5254902,g:.1333333,b:.6784314},_envColorLeft:{r:.9529412,g:.01176471,b:.4039216},_envColorRight:{r:.4784314,g:.4039216,b:1},_envColorLeftBoost:{r:.5647059,g:.4622677,b:0},_envColorRightBoost:{r:.003921554,g:.6383545,b:.6705883},_obstacleColor:{r:.9529412,g:.01176471,b:.4039216}},Lattice:{_colorLeft:{r:.8392157,g:.172549,b:.5456773},_colorRight:{r:0,g:.6717121,b:.9803922},_envColorLeft:{r:.8941177,g:.1607843,b:.7490196},_envColorRight:{r:.1960784,g:.5843138,b:.7960785},_envColorLeftBoost:{r:.5450981,g:.1333333,b:.8156863},_envColorRightBoost:{r:.4039216,g:.9176471,b:.9176471},_obstacleColor:{r:.4685534,g:.7095922,b:1}},"Daft Punk":{_colorLeft:{r:.7215686,g:.2254902,b:.1803922},_colorRight:{r:.1215686,g:.6980392,b:.6901961},_envColorLeft:{r:1,g:.7017543,b:.2515723},_envColorRight:{r:.5215687,g:.3294118,b:.8196079},_envColorWhite:{r:.4784314,g:.8117647,b:1},_envColorLeftBoost:{r:.8588235,g:0,b:.4784314},_envColorRightBoost:{r:0,g:.8196079,b:.8039216},_envColorWhiteBoost:{r:1,g:.834256,b:.4874213},_obstacleColor:{r:.6068091,g:0,b:1}},"Hip Hop Mixtape":{_colorLeft:{r:1,g:.583857,b:.3137255},_colorRight:{r:.01542656,g:.6132076,b:.5896002},_envColorLeft:{r:.9137256,g:.4941177,b:0},_envColorRight:{r:.05882353,g:.8039216,b:.1843137},_envColorWhite:{r:.8000001,g:.7568628,b:.7058824},_envColorLeftBoost:{r:.1411765,g:1,b:.9686275},_envColorRightBoost:{r:.227451,g:.2745098,b:1},_envColorWhiteBoost:{r:.8784314,g:.8784314,b:.8784314},_obstacleColor:{r:1,g:.3137255,b:.5529412}},Collider:{_colorLeft:{r:.9647059,g:.4947137,b:.1504941},_colorRight:{r:.1686274,g:.5998134,b:.8588235},_envColorLeft:{r:.9637059,g:.4092787,b:0},_envColorRight:{r:.1686275,g:.3921569,b:.8588236},_envColorLeftBoost:{r:.8980393,g:.03529412,b:.02352941},_envColorRightBoost:{r:.854902,g:.4117647,b:.9725491},_obstacleColor:{r:.8396226,g:.09639232,b:0}},"Britney Spears":{_colorLeft:{r:.9137255,g:.1411765,b:.6008013},_colorRight:{r:.2484275,g:.578789,b:1},_envColorLeft:{r:.9921569,g:.01176471,b:.9882353},_envColorRight:{r:.1921569,g:.5058824,b:.9058824},_envColorLeftBoost:{r:1,g:.4591194,b:.5087922},_envColorRightBoost:{r:.482353,g:.9294118,b:.7960785},_obstacleColor:{r:.8396226,g:.09639232,b:0}}};class Eo extends Ne{constructor(){super(...arguments),Object.defineProperty(this,"posX",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"posY",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"laneRotation",{enumerable:!0,configurable:!0,writable:!0,value:0})}setPosX(e){return this.posX=e,this}setPosY(e){return this.posY=e,this}setLaneRotation(e){return this.laneRotation=e,this}mirror(e,i){return i==null||i(this),this.posX=Fn-1-this.posX,this}getPosition(e){return(e==null?void 0:e(this))??[this.posX-2,this.posY]}getDistance(e,i){const[n,o]=this.getPosition(i),[r,a]=e.getPosition(i);return Math.sqrt(Math.pow(r-n,2)+Math.pow(a-o,2))}isVertical(e,i){const[n]=this.getPosition(i),[o]=e.getPosition(i),r=n-o;return r>-.001&&r<.001}isHorizontal(e,i){const[n,o]=this.getPosition(i),[r,a]=e.getPosition(i),s=o-a;return s>-.001&&s<.001}isDiagonal(e,i){const[n,o]=this.getPosition(i),[r,a]=e.getPosition(i),s=Math.abs(n-r),l=Math.abs(o-a);return s===l}isInline(e,i,n){return i??(i=.5),this.getDistance(e,n)<=i}isAdjacent(e,i){const n=this.getDistance(e,i);return n>.499&&n<1.001}isWindow(e,i,n){return i??(i=1.8),this.getDistance(e,n)>i}isSlantedWindow(e,i){return this.isWindow(e,null,i)&&!this.isDiagonal(e,i)&&!this.isHorizontal(e,i)&&!this.isVertical(e,i)}}class Do extends Eo{constructor(){super(...arguments),Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"direction",{enumerable:!0,configurable:!0,writable:!0,value:0})}setColor(e){return this.color=e,this}setDirection(e){return this.direction=e,this}mirror(e=!0,i){switch(i==null||i(this),e&&(this.color=(1+this.color)%2),this.direction){case 2:this.direction=3;break;case 3:this.direction=2;break;case 6:this.direction=7;break;case 7:this.direction=6;break;case 4:this.direction=5;break;case 5:this.direction=4;break}return super.mirror(e)}isRed(){return this.color===0}isBlue(){return this.color===1}getAngle(e){return(e==null?void 0:e(this))??(_e[this.direction]||0)}isDouble(e,i=.01){return e.time>this.time-i&&e.time<this.time+i&&this.color!==e.color}isValid(e,i){return i?super.isValid(e,i):super.isValid(e,i)&&this.direction>=0&&this.direction<=8}}class ni extends Do{constructor(){super(...arguments),Object.defineProperty(this,"tailTime",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"tailPosX",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"tailPosY",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"tailLaneRotation",{enumerable:!0,configurable:!0,writable:!0,value:0})}setTailTime(e){return this.tailTime=e,this}setTailPosX(e){return this.tailPosX=e,this}setTailPosY(e){return this.tailPosY=e,this}setTailLaneRotation(e){return this.tailLaneRotation=e,this}mirror(e=!0,i){return i==null||i(this),this.tailPosX=Fn-1-this.tailPosX,super.mirror(e)}getTailPosition(e){return(e==null?void 0:e(this))??[this.tailPosX-2,this.tailPosY]}isInverse(){return this.time>this.tailTime}}function xt(t,e){return t.time-e.time}function Ti(t,e){return Array.isArray(t.customData.coordinates)&&Array.isArray(e.customData.coordinates)?t.time-e.time||t.customData.coordinates[0]-e.customData.coordinates[0]||t.customData.coordinates[1]-e.customData.coordinates[1]:Array.isArray(t.customData._position)&&Array.isArray(e.customData._position)?t.time-e.time||t.customData._position[0]-e.customData._position[0]||t.customData._position[1]-e.customData._position[1]:t.time-e.time||t.posX-e.posX||t.posY-e.posY}function im(t,e){return t._time-e._time}function nm(t,e){var i,n;return Array.isArray((i=t._customData)==null?void 0:i._position)&&Array.isArray((n=e._customData)==null?void 0:n._position)?t._time-e._time||t._customData._position[0]-e._customData._position[0]||t._customData._position[1]-e._customData._position[1]:t._time-e._time||t._lineIndex-e._lineLayer||t._lineIndex-e._lineLayer}function ho(t){return["convert","toV1Beatmap",t]}function om(t,e=t.version){switch(J.tWarn(ho("main"),"Converting beatmap to v1 may lose certain data!"),e){case 1:case 2:t.version=1;break;case 3:t.version=1,rm(t);break;case 4:t.version=1,sm(t);break;default:J.tWarn(ho("main"),"Unknown version: version not supported; misinput? Returning original data.")}return t}function rm(t){var e,i;t.difficulty.customData._time=t.difficulty.customData.time,t.difficulty.customData._BPMChanges=(e=t.difficulty.customData.BPMChanges)==null?void 0:e.map(n=>({_time:n.b,_BPM:n.m,_beatsPerBar:n.p,_metronomeOffset:n.o})),t.difficulty.customData._bookmarks=(i=t.difficulty.customData.bookmarks)==null?void 0:i.map(n=>({_time:n.b,_name:n.n})),delete t.difficulty.customData.time,delete t.difficulty.customData.BPMChanges,delete t.difficulty.customData.bookmarks}function sm(t){t.difficulty.customData._time=t.difficulty.customData.time??0;let e=!1;const i={},n=[t.arcs,t.bombNotes,t.chains,t.colorNotes,t.obstacles,t.waypoints].flat().sort(xt);for(let o=0;o<n.length;o++){const r=n[o];if(!(r.time in i))i[r.time]=r.laneRotation;else if(i[r.time]!==r.laneRotation){e=!0;break}}e?J.warn(ho("fromV4"),"Impossible rotation event cannot be represented in v1!"):(t.rotationEvents=[],t.addRotationEvents(...Object.entries(i).map(([o,r])=>({time:+o,rotation:r}))));for(let o=0;o<n.length;o++){const r=n[o];r.laneRotation=0,r instanceof ni&&(r.tailLaneRotation=0)}}function ki(t){return t==="GlassDesertEnvironment"||t==="MultiplayerEnvironment"}function Qo(t){return["convert","toV1Info",t]}function am(t,e=t.version){switch(J.tWarn(Qo("main"),"Converting to beatmap v1 may lose certain data!"),e){case 1:case 2:case 3:case 4:t.environmentBase.normal=t.environmentBase.normal||t.environmentNames.find(i=>!ki(i))||"DefaultEnvironment",t.version=1;break;default:J.tWarn(Qo("main"),"Unknown version: version not supported; misinput? Returning original data.")}return t}function tr(t){return["convert","toV2Audio",t]}function lm(t,e=t.version){switch(J.tWarn(tr("main"),"Converting to beatmap v2 may lose certain data!"),e){case 1:case 2:case 3:case 4:t.version=2;break;default:J.tWarn(tr("main"),"Unknown version: version not supported; misinput? Returning original data.")}return t}function ht(t,e,i){t[i]??(t[i]=t[e]),delete t[e]}function Di(t){if(!t)return{};const e={...t};return Object.keys(e).length?(ht(e,"color","_color"),ht(e,"coordinates","_position"),ht(e,"disableNoteGravity","_disableNoteGravity"),ht(e,"disableNoteLook","_disableNoteLook"),ht(e,"flip","_flip"),ht(e,"localRotation","_localRotation"),ht(e,"noteJumpMovementSpeed","_noteJumpMovementSpeed"),ht(e,"noteJumpStartBeatOffset","_noteJumpStartBeatOffset"),ht(e,"size","_scale"),ht(e,"track","_track"),ht(e,"worldRotation","_rotation"),e._disableSpawnEffect??(e._disableSpawnEffect=typeof e.spawnEffect=="boolean"?!e.spawnEffect:void 0),delete e.spawnEffect,e._interactable??(e._interactable=typeof e.uninteractable=="boolean"?!e.uninteractable:void 0),delete e.uninteractable,e.animation&&(e._animation??(e._animation={_color:e.animation.color,_definitePosition:e.animation.definitePosition,_dissolve:e.animation.dissolve,_dissolveArrow:e.animation.dissolveArrow,_interactable:e.animation.interactable,_localRotation:e.animation.localRotation,_position:e.animation.offsetPosition,_rotation:e.animation.offsetRotation,_scale:e.animation.scale,_time:e.animation.time})),delete e.animation,e):{}}function um(t){if(!t)return{};const e={...t};return Object.keys(e).length?(ht(e,"color","_color"),ht(e,"lightID","_lightID"),ht(e,"easing","_easing"),ht(e,"lerpType","_lerpType"),ht(e,"nameFilter","_nameFilter"),ht(e,"rotation","_rotation"),ht(e,"step","_step"),ht(e,"prop","_prop"),ht(e,"speed","_speed"),ht(e,"direction","_direction"),ht(e,"lockRotation","_lockPosition"),e):{}}function zi(t){return["convert","toV2Beatmap",t]}function cm(t,e=t.version){switch(J.tWarn(zi("main"),"Converting to beatmap v2 may lose certain data!"),e){case 1:case 2:t.version=2;break;case 3:t.version=2,er(t);break;case 4:t.version=2,er(t),hm(t);break;default:J.tWarn(zi("main"),"Unknown version: version not supported; misinput? Returning original data.")}return t}function er(t){var e,i,n,o,r;t.colorNotes.forEach(a=>{a.customData=Di(a.customData)}),(e=t.difficulty.customData.fakeColorNotes)==null||e.forEach(a=>{const s=Di(a.customData);t.addColorNotes({time:a.b,posX:a.x,posY:a.y,color:a.c,direction:a.d,customData:s})}),delete t.difficulty.customData.fakeColorNotes,t.bombNotes.forEach(a=>{a.customData=Di(a.customData)}),(i=t.difficulty.customData.fakeBombNotes)==null||i.forEach(a=>{const s=Di(a.customData);t.addColorNotes({time:a.b,posX:a.x,posY:a.y,customData:s})}),t.difficulty.obstacles.forEach(a=>{a.customData=Di(a.customData)}),(n=t.difficulty.customData.fakeObstacles)==null||n.forEach(a=>{const s=Di(a.customData);t.addObstacles({time:a.b,posX:a.x,posY:a.y,duration:a.d,width:a.w,height:a.h,customData:s})}),t.basicEvents.forEach(a=>{a.customData=um(a.customData),a.isLaserRotationEvent()?delete a.customData._speed:delete a.customData._preciseSpeed});for(const a in t.difficulty.customData){if(a==="customEvents"){t.difficulty.customData._customEvents=[];for(const s of t.difficulty.customData.customEvents){if(s.t==="AnimateTrack")for(let l=0,c=s.d.repeat??0;l<=c;l++)t.difficulty.customData._customEvents.push({_time:s.b+(s.d.duration??0)*l,_type:"AnimateTrack",_data:{_track:s.d.track,_duration:s.d.duration,_easing:s.d.easing,_position:s.d.position,_rotation:s.d.rotation,_localRotation:s.d.localRotation,_scale:s.d.scale,_dissolve:s.d.dissolve,_dissolveArrow:s.d.dissolveArrow,_color:s.d.color,_interactable:s.d.interactable,_time:s.d.time}});s.t==="AssignPathAnimation"&&t.difficulty.customData._customEvents.push({_time:s.b,_type:"AssignPathAnimation",_data:{_track:s.d.track,_easing:s.d.easing,_position:s.d.position,_rotation:s.d.rotation,_localRotation:s.d.localRotation,_scale:s.d.scale,_dissolve:s.d.dissolve,_dissolveArrow:s.d.dissolveArrow,_color:s.d.color,_interactable:s.d.interactable,_definitePosition:s.d.definitePosition}}),s.t==="AssignTrackParent"&&t.difficulty.customData._customEvents.push({_time:s.b,_type:"AssignTrackParent",_data:{_childrenTracks:s.d.childrenTracks,_parentTrack:s.d.parentTrack,_worldPositionStays:s.d.worldPositionStays}}),s.t==="AssignPlayerToTrack"&&t.difficulty.customData._customEvents.push({_time:s.b,_type:"AssignPlayerToTrack",_data:{_track:s.d.track,_target:s.d.target}}),s.t==="AnimateComponent"&&s.d.BloomFogEnvironment&&t.difficulty.customData._customEvents.push({_time:s.b,_type:"AssignFogTrack",_data:{_track:s.d.track,_duration:s.d.duration,_attenuation:s.d.BloomFogEnvironment.attenuation,_height:s.d.BloomFogEnvironment.height,_offset:s.d.BloomFogEnvironment.offset,_startY:s.d.BloomFogEnvironment.startY}})}delete t.difficulty.customData.customEvents;continue}if(a==="environment"){t.difficulty.customData._environment=t.difficulty.customData.environment.map(s=>{var l,c,h,p,d,u,m,b;if(s.id&&s.lookupMethod)return{_id:s.id,_lookupMethod:s.lookupMethod,_track:s.track,_duplicate:s.duplicate,_active:s.active,_scale:s.scale,_position:Te(s.position,1/.6),_rotation:s.rotation,_localPosition:Te(s.localPosition,1/.6),_localRotation:s.localRotation,_lightID:(c=(l=s.components)==null?void 0:l.ILightWithId)==null?void 0:c.lightID};if(s.geometry)return((p=(h=s.components)==null?void 0:h.ILightWithId)!=null&&p.type||(u=(d=s.components)==null?void 0:d.ILightWithId)!=null&&u.lightID)&&J.tWarn(zi("fromV2"),"v2 geometry cannot be made assignable light to specific type"),{_geometry:s.geometry.type==="CUSTOM"?{_type:s.geometry.type,_mesh:{_vertices:s.geometry.mesh.vertices,_uv:s.geometry.mesh.uv,_triangles:s.geometry.mesh.triangles},_material:typeof s.geometry.material=="string"?s.geometry.material:{_shader:s.geometry.material.shader,_shaderKeywords:s.geometry.material.shaderKeywords,_collision:s.geometry.material.collision,_track:s.geometry.material.track,_color:s.geometry.material.color},_collision:s.geometry.collision}:{_type:s.geometry.type,_material:typeof s.geometry.material=="string"?s.geometry.material:{_shader:s.geometry.material.shader,_shaderKeywords:s.geometry.material.shaderKeywords,_collision:s.geometry.material.collision,_track:s.geometry.material.track,_color:s.geometry.material.color},_collision:s.geometry.collision},_track:s.track,_duplicate:s.duplicate,_active:s.active,_scale:s.scale,_position:Te(s.position,1/.6),_rotation:s.rotation,_localPosition:Te(s.localPosition,1/.6),_localRotation:s.localRotation,_lightID:(b=(m=s.components)==null?void 0:m.ILightWithId)==null?void 0:b.lightID};throw new Error("Error converting environment v3 to v2")}),delete t.difficulty.customData.environment;continue}if(a==="materials"){t.difficulty.customData._materials={};for(const s in t.difficulty.customData.materials)t.difficulty.customData._materials[s]={_shader:t.difficulty.customData.materials[s].shader,_shaderKeywords:t.difficulty.customData.materials[s].shaderKeywords,_collision:t.difficulty.customData.materials[s].collision,_track:t.difficulty.customData.materials[s].track,_color:t.difficulty.customData.materials[s].color};delete t.difficulty.customData.materials;continue}if(a==="pointDefinitions"){t.difficulty.customData._pointDefinitions=[];for(const s in t.difficulty.customData.pointDefinitions)t.difficulty.customData._pointDefinitions.push({_name:s,_points:t.difficulty.customData.pointDefinitions[s]});delete t.difficulty.customData.pointDefinitions;continue}if(a==="time"){t.difficulty.customData._time=t.difficulty.customData[a],delete t.difficulty.customData.time;continue}if(a==="BPMChanges"){t.difficulty.customData._BPMChanges=(o=t.difficulty.customData[a])==null?void 0:o.map(s=>({_time:s.b,_BPM:s.m,_beatsPerBar:s.p,_metronomeOffset:s.o})),delete t.difficulty.customData.BPMChanges;continue}if(a==="bookmarks"){t.difficulty.customData._bookmarks=(r=t.difficulty.customData[a])==null?void 0:r.map(s=>({_time:s.b,_name:s.n,_color:s.c})),delete t.difficulty.customData.bookmarks;continue}}if(t.difficulty.customData._environment){const a=[];for(const l of t.difficulty.customData._environment)l._track&&a.push(l._track);const s=[];if(t.difficulty.customData._customEvents){for(const l of t.difficulty.customData._customEvents)if(l._type==="AnimateTrack"){if(typeof l._data._track=="string"&&a.includes(l._data._track))s.push(l);else if(Array.isArray(l._data._track)){for(const c of l._data._track)if(a.includes(c)){s.push(l);break}}}}for(const l of s)typeof l._data._track=="string"?typeof l._data._position=="string"?J.tWarn(zi("fromV2"),"Cannot convert point definitions, unknown use."):Array.isArray(l._data._position)&&(uu(l._data._position)?Te(l._data._position,.6):l._data._position.forEach(c=>{c[0]*=.6,c[1]*=.6,c[2]*=.6})):J.tWarn(zi("fromV2"),"Environment animate track array conversion not yet implemented.")}}function hm(t){let e=!1;const i={},n=[t.arcs,t.bombNotes,t.chains,t.colorNotes,t.obstacles,t.waypoints].flat().sort(xt);for(let o=0;o<n.length;o++){const r=n[o];if(!(r.time in i))i[r.time]=r.laneRotation;else if(i[r.time]!==r.laneRotation){e=!0;break}}if(e)for(let o=0;o<n.length;o++){const r=n[o];r.laneRotation&&(r.customData._rotation=r.laneRotation)}else t.rotationEvents=[],t.addRotationEvents(...Object.entries(i).map(([o,r])=>({time:+o,rotation:r})));for(let o=0;o<n.length;o++){const r=n[o];r.laneRotation=0,r instanceof ni&&(r.tailLaneRotation=0)}}function ir(t){return["convert","toV2Info",t]}function mm(t,e=t.version){switch(J.tWarn(ir("main"),"Converting to beatmap v2 may lose certain data!"),e){case 1:case 2:case 3:case 4:t.environmentBase.normal=t.environmentBase.normal||t.environmentNames.find(i=>!ki(i))||"DefaultEnvironment",t.environmentBase.allDirections=t.environmentBase.allDirections||t.environmentNames.find(i=>ki(i))||"DefaultEnvironment",t.version=2;break;default:J.tWarn(ir("main"),"Unknown version: version not supported; misinput? Returning original data.")}return t}function Kn(t){if(!t)return{};const e={...t};return Object.keys(e).length?(ht(e,"_color","color"),ht(e,"_position","coordinates"),ht(e,"_disableNoteGravity","disableNoteGravity"),ht(e,"_disableNoteLook","disableNoteLook"),ht(e,"_flip","flip"),ht(e,"_localRotation","localRotation"),ht(e,"_noteJumpMovementSpeed","noteJumpMovementSpeed"),ht(e,"_noteJumpStartBeatOffset","noteJumpStartBeatOffset"),ht(e,"_scale","size"),ht(e,"_track","track"),ht(e,"_rotation","worldRotation"),e.spawnEffect??(e.spawnEffect=typeof e._disableSpawnEffect=="boolean"?!e._disableSpawnEffect:void 0),delete e._disableSpawnEffect,e.uninteractable??(e.uninteractable=typeof e._interactable=="boolean"?!e._interactable:void 0),delete e._interactable,e._animation&&(e.animation??(e.animation={color:e._animation._color,definitePosition:e._animation._definitePosition,dissolve:e._animation._dissolve,dissolveArrow:e._animation._dissolveArrow,interactable:e._animation._interactable,localRotation:e._animation._localRotation,offsetPosition:e._animation._position,offsetRotation:e._animation._rotation,scale:e._animation._scale,time:e._animation._time})),delete e._animation,e):{}}function fm(t){if(!t)return{};const e={...t};return Object.keys(e).length?(ht(e,"_color","color"),ht(e,"_lightID","lightID"),ht(e,"_easing","easing"),ht(e,"_lerpType","lerpType"),ht(e,"_nameFilter","nameFilter"),ht(e,"_rotation","rotation"),ht(e,"_step","step"),ht(e,"_prop","prop"),ht(e,"_direction","direction"),ht(e,"_lockPosition","lockRotation"),typeof e._preciseSpeed=="number"?e.speed=e._preciseSpeed:e.speed??(e.speed=e._speed),delete e._speed,delete e._preciseSpeed,delete e._propID,delete e._lightGradient,delete e._reset,delete e._counterSpin,delete e._stepMult,delete e._propMult,delete e._speedMult,e):{}}function fe(t){return["convert","toV3Beatmap",t]}function _u(t,e=t.version){switch(J.tWarn(fe("main"),"Converting to beatmap v3 may lose certain data!"),e){case 1:t.version=3,pm(t);break;case 2:t.version=3,dm(t);break;case 3:break;case 4:bm(t),t.version=3;break;default:J.tWarn(fe("main"),"Unknown version: version not supported; misinput? Returning original data.")}return t}function pm(t){var e,i;t.colorNotes.forEach(n=>{n.direction>=1e3&&(n.angleOffset=Math.abs(n.direction%1e3%360-360),n.direction=n.direction>=1e3||typeof n.customData._cutDirection=="number"?n.direction===8?8:1:au(n.direction,0,8))}),t.difficulty.customData.time=t.difficulty.customData._time,t.difficulty.customData.BPMChanges=(e=t.difficulty.customData._BPMChanges)==null?void 0:e.map(n=>({b:n._time,m:n._bpm??n._BPM,p:n._beatsPerBar,o:n._metronomeOffset})),t.difficulty.customData.bookmarks=(i=t.difficulty.customData._bookmarks)==null?void 0:i.map(n=>({b:n._time,n:n._name}))}function dm(t){var o,r,a;t.difficulty.customData.fakeColorNotes=[],t.difficulty.customData.fakeBombNotes=[],t.difficulty.customData.fakeObstacles=[];const e=[];t.colorNotes.forEach((s,l)=>{const c=Kn(s.customData);typeof s.customData._cutDirection=="number"&&J.tDebug(fe("fromV2"),`colorNotes[${l}] at time ${s.time} NE _cutDirection will be converted.`);let h=0;typeof s.customData._cutDirection=="number"?h=s.customData._cutDirection>0?s.customData._cutDirection%360:360+s.customData._cutDirection%360:s.direction>=1e3&&(h=Math.abs(s.direction%1e3%360-360));const p=s.direction>=1e3||typeof s.customData._cutDirection=="number"?s.direction===8?8:1:au(s.direction,0,8);s.customData._fake?t.difficulty.customData.fakeColorNotes.push({b:s.time,c:s.color,x:s.posX,y:s.posY,d:p,a:h,customData:c}):(s.direction=p,s.angleOffset=h,s.customData=c,e.push(s))}),t.colorNotes=e;const i=[];t.bombNotes.forEach((s,l)=>{const c=Kn(s.customData);typeof s.customData._cutDirection=="number"&&J.tDebug(fe("fromV2"),`bombNotes[${l}] at time ${s.time} NE _cutDirection will be converted.`),s.customData._fake?t.difficulty.customData.fakeBombNotes.push({b:s.time,x:s.posX,y:s.posY,customData:c}):(s.customData=c,i.push(s))}),t.bombNotes=i;const n=[];t.obstacles.forEach(s=>{const l=Kn(s.customData);s.customData._fake?t.difficulty.customData.fakeObstacles.push({b:s.time,x:s.posX,y:s.posY,d:s.duration,w:s.width,h:s.height,customData:l}):(s.customData=l,n.push(s))}),t.obstacles=n,t.basicEvents.forEach((s,l)=>{const c=fm(s.customData);s.isLightEvent()&&(s.customData._propID&&J.tWarn(fe("fromV2"),`events[${l}] at time ${s.time} Chroma _propID will be removed.`),s.customData._lightGradient&&J.tWarn(fe("fromV2"),`events[${l}] at time ${s.time} Chroma _lightGradient will be removed.`)),s.isRingEvent()&&(s.customData._reset&&J.tWarn(fe("fromV2"),`events[${l}] at time ${s.time} Chroma _reset will be removed.`),s.customData._counterSpin&&J.tWarn(fe("fromV2"),`events[${l}] at time ${s.time} Chroma _counterSpin will be removed.`),(s.customData._stepMult||s.customData._propMult||s.customData._speedMult)&&J.tWarn(fe("fromV2"),`events[${l}] at time ${s.time} Chroma _mult will be removed.`)),s.customData=c});for(const s in t.difficulty.customData){if(s==="_customEvents"){t.difficulty.customData.customEvents=[],t.difficulty.customData._customEvents.forEach(l=>{var c,h,p,d,u;l._type==="AnimateTrack"&&((c=t.difficulty.customData.customEvents)==null||c.push({b:l._time,t:"AnimateTrack",d:{track:l._data._track,duration:l._data._duration,easing:l._data._easing,position:l._data._position,rotation:l._data._rotation,localRotation:l._data._localRotation,scale:l._data._scale,dissolve:l._data._dissolve,dissolveArrow:l._data._dissolveArrow,color:l._data._color,interactable:l._data._interactable,time:l._data._time}})),l._type==="AssignPathAnimation"&&((h=t.difficulty.customData.customEvents)==null||h.push({b:l._time,t:"AssignPathAnimation",d:{track:l._data._track,easing:l._data._easing,position:l._data._position,rotation:l._data._rotation,localRotation:l._data._localRotation,scale:l._data._scale,dissolve:l._data._dissolve,dissolveArrow:l._data._dissolveArrow,color:l._data._color,interactable:l._data._interactable,definitePosition:l._data._definitePosition}})),l._type==="AssignTrackParent"&&((p=t.difficulty.customData.customEvents)==null||p.push({b:l._time,t:"AssignTrackParent",d:{childrenTracks:l._data._childrenTracks,parentTrack:l._data._parentTrack,worldPositionStays:l._data._worldPositionStays}})),l._type==="AssignPlayerToTrack"&&((d=t.difficulty.customData.customEvents)==null||d.push({b:l._time,t:"AssignPlayerToTrack",d:{track:l._data._track,target:l._data._target}})),l._type==="AssignFogTrack"&&((u=t.difficulty.customData.customEvents)==null||u.push({b:l._time,t:"AnimateComponent",d:{track:l._data._track,duration:l._data._duration||0,BloomFogEnvironment:{attenuation:typeof l._data._attenuation=="number"?[[l._data._attenuation,0]]:l._data._attenuation,height:typeof l._data._height=="number"?[[l._data._height,0]]:l._data._height,offset:typeof l._data._offset=="number"?[[l._data._offset,0]]:l._data._offset,startY:typeof l._data._startY=="number"?[[l._data._startY,0]]:l._data._startY}}}))}),delete t.difficulty.customData._customEvents;continue}if(s==="_environment"){t.difficulty.customData.environment=t.difficulty.customData._environment.map(l=>{let c={};if(l._lightID&&(c={ILightWithId:{lightID:l._lightID}}),l._id&&l._lookupMethod)return{id:l._id,lookupMethod:l._lookupMethod,track:l._track,duplicate:l._duplicate,active:l._active,scale:l._scale,position:Te(l._position,.6),rotation:l._rotation,localPosition:Te(l._localPosition,.6),localRotation:l._localRotation,components:c};if(l._geometry)return l._lightID&&c.ILightWithId&&(c.ILightWithId.type=0),{geometry:l._geometry._type==="CUSTOM"?{type:l._geometry._type,mesh:{vertices:l._geometry._mesh._vertices,uv:l._geometry._mesh._uv,triangles:l._geometry._mesh._triangles},material:typeof l._geometry._material=="string"?l._geometry._material:{shader:l._geometry._material._shader,shaderKeywords:l._geometry._material._shaderKeywords,collision:l._geometry._material._collision,track:l._geometry._material._track,color:l._geometry._material._color},collision:l._geometry._collision}:{type:l._geometry._type,material:typeof l._geometry._material=="string"?l._geometry._material:{shader:l._geometry._material._shader,shaderKeywords:l._geometry._material._shaderKeywords,collision:l._geometry._material._collision,track:l._geometry._material._track,color:l._geometry._material._color},collision:l._geometry._collision},track:l._track,duplicate:l._duplicate,active:l._active,scale:l._scale,position:Te(l._position,.6),rotation:l._rotation,localPosition:Te(l._localPosition,.6),localRotation:l._localRotation,components:c};throw new Error("Error converting environment v2 to v3")}),delete t.difficulty.customData._environment;continue}if(s==="_materials"){t.difficulty.customData.materials={};for(const l in t.difficulty.customData._materials)t.difficulty.customData.materials[l]={shader:t.difficulty.customData._materials[l]._shader,shaderKeywords:t.difficulty.customData._materials[l]._shaderKeywords,collision:t.difficulty.customData._materials[l]._collision,track:t.difficulty.customData._materials[l]._track,color:t.difficulty.customData._materials[l]._color};delete t.difficulty.customData._materials;continue}if(s==="_pointDefinitions"){t.difficulty.customData.pointDefinitions={},t.difficulty.customData._pointDefinitions.forEach(l=>{t.difficulty.customData.pointDefinitions[l._name]=l._points}),delete t.difficulty.customData._pointDefinitions;continue}if(s==="_time"){t.difficulty.customData.time=t.difficulty.customData[s],delete t.difficulty.customData._time;continue}if(s==="_BPMChanges"){t.difficulty.customData.BPMChanges=(o=t.difficulty.customData[s])==null?void 0:o.map(l=>({b:l._time,m:l._BPM,p:l._beatsPerBar,o:l._metronomeOffset})),delete t.difficulty.customData._BPMChanges;continue}if(s==="_bpmChanges"){t.difficulty.customData.BPMChanges=(r=t.difficulty.customData[s])==null?void 0:r.map(l=>({b:l._time,m:l._bpm,p:l._beatsPerBar,o:l._metronomeOffset})),delete t.difficulty.customData._bpmChanges;continue}if(s==="_bookmarks"){t.difficulty.customData.bookmarks=(a=t.difficulty.customData._bookmarks)==null?void 0:a.map(l=>({b:l._time,n:l._name,c:l._color})),delete t.difficulty.customData._bookmarks;continue}}if(t.difficulty.customData.environment){const s=[];for(const c of t.difficulty.customData.environment)c.track&&s.push(c.track);const l=[];if(t.difficulty.customData.customEvents){for(const c of t.difficulty.customData.customEvents)if(c.t==="AnimateTrack"){if(typeof c.d.track=="string"&&s.includes(c.d.track))l.push(c);else if(Array.isArray(c.d.track)){for(const h of c.d.track)if(s.includes(h)){l.push(c);break}}}}for(const c of l)typeof c.d.track=="string"?typeof c.d.position=="string"?J.tWarn(fe("fromV2"),"Cannot convert point definitions, unknown use."):Array.isArray(c.d.position)&&(uu(c.d.position)?Te(c.d.position,.6):c.d.position.forEach(h=>{typeof h!="string"&&(h[0]*=.6,h[1]*=.6,h[2]*=.6)})):J.tWarn(fe("fromV2"),"Environment animate track array conversion not yet implemented.")}t.lightshow.useNormalEventsAsCompatibleEvents=!0}function bm(t){let e=!1;const i={},n=[t.arcs,t.bombNotes,t.chains,t.colorNotes,t.obstacles,t.waypoints].flat().sort(xt);for(let o=0;o<n.length;o++){const r=n[o];if(!(r.time in i))i[r.time]=r.laneRotation;else if(i[r.time]!==r.laneRotation){e=!0;break}}if(e)for(let o=0;o<n.length;o++){const r=n[o];r.laneRotation&&(r.customData.worldRotation=r.laneRotation)}else t.rotationEvents=[],t.addRotationEvents(...Object.entries(i).map(([o,r])=>({time:+o,rotation:r})));for(let o=0;o<n.length;o++){const r=n[o];r.laneRotation=0,r instanceof ni&&(r.tailLaneRotation=0)}}function nr(t){return["convert","toV4Audio",t]}function gm(t,e=t.version){switch(J.tWarn(nr("main"),"Converting to beatmap v4 may lose certain data!"),e){case 1:case 2:case 3:case 4:t.version=4;break;default:J.tWarn(nr("main"),"Unknown version: version not supported; misinput? Returning original data.")}return t}function vm(t){return["convert","toV4Beatmap",t]}function _m(t,e=t.version){J.tWarn(vm("main"),"As v4 is similar to v3, the conversion will use v3 convertor alongside."),_u(t,e),t.version=4;const i=[t.arcs,t.bombNotes,t.chains,t.colorNotes,t.obstacles,t.waypoints].flat().sort(xt);if(t.rotationEvents.length){const n=[...t.rotationEvents].sort((r,a)=>r.executionTime-a.executionTime).sort(xt);let o=0;for(const r of n)o+=r.rotation;for(let r=i.length-1;r>=0;r--){const a=i[r];let s=n.at(-1);for(;s&&s.time>a.time;)n.pop(),o-=s.rotation,s=n.at(-1);if(!s)break;if(s.time===a.time&&s.executionTime===uo.EARLY){a.laneRotation=o%360,a instanceof ni&&(a.tailLaneRotation=a.laneRotation);continue}for(;s&&s.time>=a.time;)n.pop(),o-=s.rotation,s=n.at(-1);if(!s)break;a.laneRotation=o%360,a instanceof ni&&(a.tailLaneRotation=a.laneRotation)}t.rotationEvents=[]}for(let n=0;n<i.length;n++){const o=i[n];typeof o.customData.worldRotation=="number"&&(o.laneRotation=o.customData.worldRotation,o instanceof ni&&(o.tailLaneRotation=o.customData.worldRotation),delete o.customData.worldRotation)}return t}function or(t){return["convert","toV4Info",t]}function ym(t,e=t.version){switch(J.tWarn(or("main"),"Converting to beatmap v4 may lose certain data!"),e){case 1:t.environmentNames=[t.environmentBase.normal||"DefaultEnvironment"],t.difficulties.forEach(i=>{i.environmentId=0});case 2:case 3:case 4:t.version=4;break;default:J.tWarn(or("main"),"Unknown version: version not supported; misinput? Returning original data.")}return t}class jn extends Oe{constructor(){super(...arguments),Object.defineProperty(this,"filter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"beatDistribution",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"beatDistributionType",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"easing",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"affectFirst",{enumerable:!0,configurable:!0,writable:!0,value:0})}setFilter(e){return this.filter=e,this}setBeatDistribution(e){return this.beatDistribution=e,this}setBeatDistributionType(e){return this.beatDistributionType=e,this}setEasing(e){return this.easing=e,this}setAffectFirst(e){return this.affectFirst=e,this}isValid(e,i){return i?super.isValid(e,i):super.isValid(e,i)&&(this.beatDistributionType===1||this.beatDistributionType===2)&&this.easing>=-1&&this.easing<=103&&this.events.every(n=>typeof n=="number"||n.isValid())&&this.filter.isValid()}}class zn extends Ne{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:0})}isValid(e,i){return i?super.isValid(e,i):super.isValid(e,i)&&this.id>=0&&this.boxes.every(n=>n.isValid())}}class Ot extends ni{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"lengthMultiplier",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tailLengthMultiplier",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tailDirection",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"midAnchor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.time=e.time??Ot.defaultValue.time,this.posX=e.posX??Ot.defaultValue.posX,this.posY=e.posY??Ot.defaultValue.posY,this.color=e.color??Ot.defaultValue.color,this.direction=e.direction??Ot.defaultValue.direction,this.lengthMultiplier=e.lengthMultiplier??Ot.defaultValue.lengthMultiplier,this.tailTime=e.tailTime??Ot.defaultValue.tailTime,this.tailPosX=e.tailPosX??Ot.defaultValue.tailPosX,this.tailPosY=e.tailPosY??Ot.defaultValue.tailPosY,this.tailDirection=e.tailDirection??Ot.defaultValue.tailDirection,this.tailLengthMultiplier=e.tailLengthMultiplier??Ot.defaultValue.tailLengthMultiplier,this.midAnchor=e.midAnchor??Ot.defaultValue.midAnchor,this.laneRotation=e.laneRotation??Ot.defaultValue.laneRotation,this.tailLaneRotation=e.tailLaneRotation??Ot.defaultValue.tailLaneRotation,this.customData=W(e.customData??Ot.defaultValue.customData)}isValid(e,i){return i?super.isValid(e,i):super.isValid(e,i)&&!(this.isInverse()||this.posX<0||this.posX>3||this.tailPosX<0||this.tailPosX>3||this.posX===this.tailPosX&&this.posY===this.tailPosY&&this.time===this.tailTime)}setLengthMultiplier(e){return this.lengthMultiplier=e,this}setTailLengthMultiplier(e){return this.tailLengthMultiplier=e,this}setTailDirection(e){return this.tailDirection=e,this}setMidAnchor(e){return this.midAnchor=e,this}mirror(e=!0,i){switch(i==null||i(this),this.tailDirection){case 2:this.tailDirection=3;break;case 3:this.tailDirection=2;break;case 6:this.tailDirection=7;break;case 7:this.tailDirection=6;break;case 4:this.tailDirection=5;break;case 5:this.tailDirection=4;break}return this.midAnchor&&(this.midAnchor=this.midAnchor===1?2:1),super.mirror(e)}getTailAngle(e){return(e==null?void 0:e(this))||_e[this.tailDirection]||0}}Object.defineProperty(Ot,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,posX:0,posY:0,color:0,direction:0,lengthMultiplier:0,tailTime:0,tailPosX:0,tailPosY:0,tailDirection:0,tailLengthMultiplier:0,midAnchor:0,laneRotation:0,tailLaneRotation:0,customData:{}}});class pe extends Oe{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filename",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"audioChecksum",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sampleCount",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"frequency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"bpmData",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lufsData",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.version=e.version??pe.defaultValue.version,this.filename=e.filename??pe.defaultValue.filename,this.audioChecksum=e.audioChecksum??pe.defaultValue.audioChecksum,this.sampleCount=e.sampleCount??pe.defaultValue.sampleCount,this.frequency=e.frequency??pe.defaultValue.frequency,this.bpmData=(e.bpmData??pe.defaultValue.bpmData).map(i=>({startBeat:(i==null?void 0:i.startBeat)||0,startSampleIndex:(i==null?void 0:i.startSampleIndex)||0,endBeat:(i==null?void 0:i.endBeat)||0,endSampleIndex:(i==null?void 0:i.endSampleIndex)||0})),this.lufsData=(e.lufsData??pe.defaultValue.lufsData).map(i=>({startSampleIndex:(i==null?void 0:i.startSampleIndex)||0,endSampleIndex:(i==null?void 0:i.endSampleIndex)||0,lufs:(i==null?void 0:i.lufs)||0})),this.customData=W(e.customData??pe.defaultValue.customData)}isValid(e,i){return i?super.isValid(e,i):super.isValid(e,i)&&this.frequency>=0&&this.sampleCount>=0&&this.bpmData.every(n=>n.endBeat>n.startBeat&&n.endSampleIndex>n.startSampleIndex)}setFilename(e){return this.filename=e,this}setVersion(e){return this.version=e,this}setSampleCount(e){return this.sampleCount=e,this}setFrequency(e){return this.frequency=e,this}fromBpmEvents(e,i=44100,n){if(!e.length)return this;this.frequency=i,n&&(this.sampleCount=n),this.bpmData=[];for(let l=0;l<e.length-1;l++){const c=e[l],h=e[l+1];this.bpmData.push({startSampleIndex:Math.floor(c.time*this.frequency),endSampleIndex:Math.floor(h.time*this.frequency),startBeat:c.time,endBeat:h.time})}const o=e[e.length-1],r=Math.floor(o.time*this.frequency),s=(this.sampleCount-r)/this.frequency*(o.bpm/60);return this.bpmData.push({startSampleIndex:r,endSampleIndex:this.sampleCount,startBeat:o.time,endBeat:o.time+s}),this}getBpmEvents(){return this.bpmData.map(e=>{const i=e.endSampleIndex-e.startSampleIndex,n=(e.endBeat-e.startBeat)/(i/this.frequency)*60;return{time:e.startBeat,bpm:n,customData:{}}})}sort(){return this.bpmData.sort((e,i)=>e.startBeat-i.startBeat),this}}Object.defineProperty(pe,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{version:-1,filename:"AudioData.dat",audioChecksum:"",sampleCount:44100,frequency:0,bpmData:[],lufsData:[],customData:{}}});class pi extends Ne{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"bpm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.time=e.time??pi.defaultValue.time,this.bpm=e.bpm??pi.defaultValue.bpm,this.customData=W(e.customData??pi.defaultValue.customData)}isValid(e,i){return i?super.isValid(e,i):super.isValid(e,i)&&this.bpm>0}setBPM(e){return this.bpm=e,this}}Object.defineProperty(pi,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,bpm:0,customData:{}}});class Ke extends Ne{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"executionTime",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"rotation",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.time=e.time??Ke.defaultValue.time,this.executionTime=e.executionTime??Ke.defaultValue.executionTime,this.rotation=e.rotation??Ke.defaultValue.rotation,this.customData=W(e.customData??Ke.defaultValue.customData)}setExecutionTime(e){return this.executionTime=e,this}setRotation(e){return this.rotation=e,this}isValid(e,i){return i?super.isValid(e,i):super.isValid(e,i)&&(this.executionTime===0||this.executionTime===1)}}Object.defineProperty(Ke,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,executionTime:0,rotation:0,customData:{}}});class Wt extends Do{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"angleOffset",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.time=e.time??Wt.defaultValue.time,this.posX=e.posX??Wt.defaultValue.posX,this.posY=e.posY??Wt.defaultValue.posY,this.color=e.color??Wt.defaultValue.color,this.direction=e.direction??Wt.defaultValue.direction,this.angleOffset=e.angleOffset??Wt.defaultValue.angleOffset,this.laneRotation=e.laneRotation??Wt.defaultValue.laneRotation,this.customData=W(e.customData??Wt.defaultValue.customData)}isValid(e,i){return i?super.isValid(e,i):super.isValid(e,i)&&this.posX>=0&&this.posX<=3&&this.posY>=0&&this.posY<=2&&this.direction>=0&&this.direction<=8}setAngleOffset(e){return this.angleOffset=e,this}mirror(e=!0,i){return i==null||i(this),super.mirror(e)}getAngle(e){return(e==null?void 0:e(this))??(_e[this.direction]||0)+this.angleOffset}}Object.defineProperty(Wt,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,posX:0,posY:0,color:0,direction:0,angleOffset:0,laneRotation:0,customData:{}}});class ve extends Do{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),this.time=e.time??ve.defaultValue.time,this.posX=e.posX??ve.defaultValue.posX,this.posY=e.posY??ve.defaultValue.posY,this.color=-1,this.direction=e.direction??ve.defaultValue.direction,this.laneRotation=e.laneRotation??ve.defaultValue.laneRotation,this.customData=W(e.customData??ve.defaultValue.customData)}isValid(e,i){return i?super.isValid(e,i):super.isValid(e,i)&&this.posX>=0&&this.posX<=3&&this.posY>=0&&this.posY<=2}}Object.defineProperty(ve,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,posX:0,posY:0,color:-1,direction:0,laneRotation:0,customData:{}}});class Pt extends Eo{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"duration",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.time=e.time??Pt.defaultValue.time,this.posX=e.posX??Pt.defaultValue.posX,this.posY=e.posY??Pt.defaultValue.posY,this.width=e.width??Pt.defaultValue.width,this.height=e.height??Pt.defaultValue.height,this.duration=e.duration??Pt.defaultValue.duration,this.laneRotation=e.laneRotation??Pt.defaultValue.laneRotation,this.customData=W(e.customData??Pt.defaultValue.customData)}isValid(e,i){return i?super.isValid(e,i):super.isValid(e,i)&&!this.hasZero()&&!this.hasNegative()}setDuration(e){return this.duration=e,this}setWidth(e){return this.width=e,this}setHeight(e){return this.height=e,this}mirror(e,i){return i==null||i(this),this.posX=Fn-1-(this.posX+this.width-1),this}getPosition(e){return(e==null?void 0:e(this))??[this.posX-2,this.posY-.5]}isInteractive(){return this.posX<0&&this.width>1-this.posX||this.posX===0&&this.width>1||this.posX===1||this.posX===2}isLonger(e,i=0){return this.time+this.duration>e.time+e.duration+i}hasZero(){return this.duration===0||this.width===0||this.height===0}hasNegative(){return this.posY<0||this.duration<0||this.width<0||this.height<0}}Object.defineProperty(Pt,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,posX:0,posY:0,width:0,height:0,duration:0,laneRotation:0,customData:{}}});class Mt extends ni{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"sliceCount",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"squish",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.time=e.time??Mt.defaultValue.time,this.posX=e.posX??Mt.defaultValue.posX,this.posY=e.posY??Mt.defaultValue.posY,this.color=e.color??Mt.defaultValue.color,this.direction=e.direction??Mt.defaultValue.direction,this.laneRotation=e.laneRotation??Mt.defaultValue.laneRotation,this.tailTime=e.tailTime??Mt.defaultValue.tailTime,this.tailPosX=e.tailPosX??Mt.defaultValue.tailPosX,this.tailPosY=e.tailPosY??Mt.defaultValue.tailPosY,this.tailLaneRotation=e.tailLaneRotation??Mt.defaultValue.tailLaneRotation,this.sliceCount=e.sliceCount??Mt.defaultValue.sliceCount,this.squish=e.squish??Mt.defaultValue.squish,this.customData=W(e.customData??Mt.defaultValue.customData)}isValid(e,i){return i?super.isValid(e,i):super.isValid(e,i)&&(!this.isInverse()||this.posY>=0||this.posY<=2||this.tailPosY>=0||this.tailPosY<=2)}setSliceCount(e){return this.sliceCount=e,this}setSquish(e){return this.squish=e,this}}Object.defineProperty(Mt,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,posX:0,posY:0,color:0,direction:0,laneRotation:0,tailTime:0,tailPosX:0,tailPosY:0,tailLaneRotation:0,sliceCount:0,squish:0,customData:{}}});class de extends Oe{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"bpmEvents",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"rotationEvents",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"colorNotes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"bombNotes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"obstacles",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"arcs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"chains",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bpmEvents=(e.bpmEvents??de.defaultValue.bpmEvents).map(i=>new pi(i)),this.rotationEvents=(e.rotationEvents??de.defaultValue.rotationEvents).map(i=>new Ke(i)),this.colorNotes=(e.colorNotes??de.defaultValue.colorNotes).map(i=>new Wt(i)),this.bombNotes=(e.bombNotes??de.defaultValue.bombNotes).map(i=>new ve(i)),this.obstacles=(e.obstacles??de.defaultValue.obstacles).map(i=>new Pt(i)),this.arcs=(e.arcs??de.defaultValue.arcs).map(i=>new Ot(i)),this.chains=(e.chains??de.defaultValue.chains).map(i=>new Mt(i)),this.customData=W(e.customData??de.defaultValue.customData)}isValid(e,i){return i?super.isValid(e,i):super.isValid(e,i)&&this.bpmEvents.every(n=>n.isValid())&&this.rotationEvents.every(n=>n.isValid())&&this.colorNotes.every(n=>n.isValid())&&this.bombNotes.every(n=>n.isValid())&&this.obstacles.every(n=>n.isValid())&&this.arcs.every(n=>n.isValid())&&this.chains.every(n=>n.isValid())}sort(){return this.bpmEvents.sort(xt),this.rotationEvents.sort(xt),this.colorNotes.sort(Ti),this.bombNotes.sort(Ti),this.obstacles.sort(xt),this.arcs.sort(Ti),this.chains.sort(Ti),this}addBpmEvents(...e){for(const i of e)this.bpmEvents.push(new pi(i));return this}addRotationEvents(...e){for(const i of e)this.rotationEvents.push(new Ke(i));return this}addColorNotes(...e){for(const i of e)this.colorNotes.push(new Wt(i));return this}addBombNotes(...e){for(const i of e)this.bombNotes.push(new ve(i));return this}addObstacles(...e){for(const i of e)this.obstacles.push(new Pt(i));return this}addArcs(...e){for(const i of e)this.arcs.push(new Ot(i));return this}addChains(...e){for(const i of e)this.chains.push(new Mt(i));return this}}Object.defineProperty(de,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{bpmEvents:[],rotationEvents:[],colorNotes:[],bombNotes:[],obstacles:[],arcs:[],chains:[],customData:{}}});class Ce extends Eo{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"direction",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.time=e.time??Ce.defaultValue.time,this.posX=e.posX??Ce.defaultValue.posX,this.posY=e.posY??Ce.defaultValue.posY,this.direction=e.direction??Ce.defaultValue.direction,this.laneRotation=e.laneRotation??Ce.defaultValue.laneRotation,this.customData=W(e.customData??Ce.defaultValue.customData)}setDirection(e){return this.direction=e,this}mirror(e,i){switch(i==null||i(this),this.posX=Fn-1-this.posX,this.direction){case 2:this.direction=3;break;case 3:this.direction=2;break;case 6:this.direction=7;break;case 7:this.direction=6;break;case 4:this.direction=5;break;case 5:this.direction=4;break}return this}isValid(e,i){return i?super.isValid(e,i):super.isValid(e,i)&&this.direction>=0&&this.direction<=9&&this.direction!==8}}Object.defineProperty(Ce,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,posX:0,posY:0,direction:0,laneRotation:0,customData:{}}});class di extends Ne{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"toggle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.time=e.time??di.defaultValue.time,this.toggle=e.toggle??di.defaultValue.toggle,this.customData=W(e.customData??di.defaultValue.customData)}setToggle(e){return this.toggle=e,this}}Object.defineProperty(di,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,toggle:!1,customData:{}}});class Vt extends Oe{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"p0",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"p1",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reverse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"chunks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"limit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"limitAffectsType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"random",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"seed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.type=e.type??Vt.defaultValue.type,this.p0=e.p0??Vt.defaultValue.p0,this.p1=e.p1??Vt.defaultValue.p1,this.reverse=e.reverse??Vt.defaultValue.reverse,this.chunks=e.chunks??Vt.defaultValue.chunks,this.random=e.random??Vt.defaultValue.random,this.seed=e.seed??Vt.defaultValue.seed,this.limit=e.limit??Vt.defaultValue.limit,this.limitAffectsType=e.limitAffectsType??Vt.defaultValue.limitAffectsType,this.customData=W(e.customData??Vt.defaultValue.customData)}setType(e){return this.type=e,this}setP0(e){return this.p0=e,this}setP1(e){return this.p1=e,this}setReverse(e){return this.reverse=e,this}setChunks(e){return this.chunks=e,this}setRandom(e){return this.random=e,this}setSeed(e){return this.seed=e,this}setLimit(e){return this.limit=e,this}setLimitAffectsType(e){return this.limitAffectsType=e,this}isValid(e,i){return i?super.isValid(e,i):super.isValid(e,i)&&(this.type===1||this.type===2)&&this.p0>=0&&this.p1>=0&&(this.reverse===0||this.reverse===1)&&this.chunks>=0&&this.random>=0&&this.random<=lo.ALL&&this.limit>=0&&this.limit<=1&&this.limitAffectsType>=0&&this.limitAffectsType<=ao.ALL}}Object.defineProperty(Vt,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{type:1,p0:0,p1:0,reverse:0,chunks:0,random:0,seed:0,limit:0,limitAffectsType:0,customData:{}}});class ne extends Ne{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"previous",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"brightness",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"frequency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"strobeBrightness",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"strobeFade",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"easing",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.time=e.time??ne.defaultValue.time,this.previous=e.previous??ne.defaultValue.previous,this.color=e.color??ne.defaultValue.color,this.frequency=e.frequency??ne.defaultValue.frequency,this.brightness=e.brightness??ne.defaultValue.brightness,this.strobeBrightness=e.strobeBrightness??ne.defaultValue.strobeBrightness,this.strobeFade=e.strobeFade??ne.defaultValue.strobeFade,this.easing=e.easing??ne.defaultValue.easing,this.customData=W(e.customData??ne.defaultValue.customData)}setPrevious(e){return this.previous=e,this}setColor(e){return this.color=e,this}setBrightness(e){return this.brightness=e,this}setFrequency(e){return this.frequency=e,this}setStrobeBrightness(e){return this.strobeBrightness=e,this}setStrobeFade(e){return this.strobeFade=e,this}setEasing(e){return this.easing=e,this}isValid(e,i){return i?super.isValid(e,i):super.isValid(e,i)&&(this.previous===0||this.previous===1)&&this.easing>=-1&&this.easing<=103&&this.color>=-1&&this.color<=2&&this.brightness>=0&&this.frequency>=0}}Object.defineProperty(ne,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,previous:0,color:0,frequency:0,brightness:0,strobeBrightness:0,strobeFade:0,easing:0,customData:{}}});class oe extends jn{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"brightnessDistribution",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"brightnessDistributionType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.filter=new Vt(e.filter??oe.defaultValue.filter),this.beatDistribution=e.beatDistribution??oe.defaultValue.beatDistribution,this.beatDistributionType=e.beatDistributionType??oe.defaultValue.beatDistributionType,this.brightnessDistribution=e.brightnessDistribution??oe.defaultValue.brightnessDistribution,this.brightnessDistributionType=e.brightnessDistributionType??oe.defaultValue.brightnessDistributionType,this.affectFirst=e.affectFirst??oe.defaultValue.affectFirst,this.easing=e.easing??oe.defaultValue.easing,this.events=(e.events??oe.defaultValue.events).map(i=>new ne(i)),this.customData=W(e.customData??oe.defaultValue.customData)}setBrightnessDistribution(e){return this.brightnessDistribution=e,this}setBrightnessDistributionType(e){return this.brightnessDistributionType=e,this}setEvents(e){return this.events=e,this}isValid(e,i){return i?super.isValid(e,i):super.isValid(e,i)&&(this.brightnessDistributionType===1||this.brightnessDistributionType===2)&&(this.affectFirst===0||this.affectFirst===1)}}Object.defineProperty(oe,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{filter:{type:1,p0:0,p1:0,reverse:0,chunks:0,random:0,seed:0,limit:0,limitAffectsType:0,customData:{}},beatDistribution:0,beatDistributionType:1,brightnessDistribution:0,brightnessDistributionType:1,affectFirst:0,easing:0,events:[],customData:{}}});class Ze extends zn{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"boxes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.time=e.time??Ze.defaultValue.time,this.id=e.id??Ze.defaultValue.id,this.boxes=(e.boxes??Ze.defaultValue.boxes).map(i=>new oe(i)),this.customData=W(e.customData??Ze.defaultValue.customData)}}Object.defineProperty(Ze,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,id:0,boxes:[],customData:{}}});class Se extends Ne{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"previous",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"easing",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"loop",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"rotation",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"direction",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.time=e.time??Se.defaultValue.time,this.easing=e.easing??Se.defaultValue.easing,this.loop=e.loop??Se.defaultValue.loop,this.direction=e.direction??Se.defaultValue.direction,this.previous=e.previous??Se.defaultValue.previous,this.rotation=e.rotation??Se.defaultValue.rotation,this.customData=W(e.customData??Se.defaultValue.customData)}setPrevious(e){return this.previous=e,this}setEasing(e){return this.easing=e,this}setLoop(e){return this.loop=e,this}setRotation(e){return this.rotation=e,this}setDirection(e){return this.direction=e,this}isValid(e,i){return i?super.isValid(e,i):super.isValid(e,i)&&(this.previous===0||this.previous===1)&&this.easing>=-1&&this.easing<=103&&this.loop>=0&&this.direction>=0&&this.direction<=2}}Object.defineProperty(Se,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,easing:0,loop:0,direction:0,previous:0,rotation:0,customData:{}}});class Yt extends jn{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"rotationDistribution",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"rotationDistributionType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"axis",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"flip",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.filter=new Vt(e.filter??Yt.defaultValue.filter),this.axis=e.axis??Yt.defaultValue.axis,this.flip=e.flip??Yt.defaultValue.flip,this.beatDistribution=e.beatDistribution??Yt.defaultValue.beatDistribution,this.beatDistributionType=e.beatDistributionType??Yt.defaultValue.beatDistributionType,this.rotationDistribution=e.rotationDistribution??Yt.defaultValue.rotationDistribution,this.rotationDistributionType=e.rotationDistributionType??Yt.defaultValue.rotationDistributionType,this.affectFirst=e.affectFirst??Yt.defaultValue.affectFirst,this.easing=e.easing??Yt.defaultValue.easing,this.events=(e.events??Yt.defaultValue.events).map(i=>new Se(i)),this.customData=W(e.customData??Yt.defaultValue.customData)}setRotationDistribution(e){return this.rotationDistribution=e,this}setRotationDistributionType(e){return this.rotationDistributionType=e,this}setAxis(e){return this.axis=e,this}setFlip(e){return this.flip=e,this}setEvents(e){return this.events=e,this}isValid(e,i){return i?super.isValid(e,i):super.isValid(e,i)&&(this.rotationDistributionType===1||this.rotationDistributionType===2)&&(this.axis===0||this.axis===1||this.axis===2)&&(this.flip===0||this.flip===1)&&(this.affectFirst===0||this.affectFirst===1)}}Object.defineProperty(Yt,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{filter:{type:1,p0:0,p1:0,reverse:0,chunks:0,random:0,seed:0,limit:0,limitAffectsType:0,customData:{}},axis:0,flip:0,beatDistribution:0,beatDistributionType:1,rotationDistribution:0,rotationDistributionType:1,affectFirst:0,easing:0,events:[],customData:{}}});class Je extends zn{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"boxes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.time=e.time??Je.defaultValue.time,this.id=e.id??Je.defaultValue.id,this.boxes=(e.boxes??Je.defaultValue.boxes).map(i=>new Yt(i)),this.customData=W(e.customData??Je.defaultValue.customData)}}Object.defineProperty(Je,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,id:0,boxes:[],customData:{}}});class Xe extends Ne{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"previous",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"easing",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"translation",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.time=e.time??Xe.defaultValue.time,this.easing=e.easing??Xe.defaultValue.easing,this.previous=e.previous??Xe.defaultValue.previous,this.translation=e.translation??Xe.defaultValue.translation,this.customData=W(e.customData??Xe.defaultValue.customData)}setPrevious(e){return this.previous=e,this}setEasing(e){return this.easing=e,this}setTranslation(e){return this.translation=e,this}isValid(e,i){return i?super.isValid(e,i):super.isValid(e,i)&&(this.previous===0||this.previous===1)&&this.easing>=-1&&this.easing<=103}}Object.defineProperty(Xe,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,easing:0,previous:0,translation:0,customData:{}}});class Xt extends jn{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"gapDistribution",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"gapDistributionType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"axis",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"flip",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.filter=new Vt(e.filter??Xt.defaultValue.filter),this.axis=e.axis??Xt.defaultValue.axis,this.flip=e.flip??Xt.defaultValue.flip,this.beatDistribution=e.beatDistribution??Xt.defaultValue.beatDistribution,this.beatDistributionType=e.beatDistributionType??Xt.defaultValue.beatDistributionType,this.gapDistribution=e.gapDistribution??Xt.defaultValue.gapDistribution,this.gapDistributionType=e.gapDistributionType??Xt.defaultValue.gapDistributionType,this.affectFirst=e.affectFirst??Xt.defaultValue.affectFirst,this.easing=e.easing??Xt.defaultValue.easing,this.events=(e.events??Xt.defaultValue.events).map(i=>new Xe(i)),this.customData=W(e.customData??Xt.defaultValue.customData)}setGapDistribution(e){return this.gapDistribution=e,this}setGapDistributionType(e){return this.gapDistributionType=e,this}setAxis(e){return this.axis=e,this}setFlip(e){return this.flip=e,this}setEvents(e){return this.events=e,this}isValid(e,i){return i?super.isValid(e,i):super.isValid(e,i)&&(this.gapDistributionType===1||this.gapDistributionType===2)&&(this.axis===0||this.axis===1||this.axis===2)&&(this.flip===0||this.flip===1)&&(this.affectFirst===0||this.affectFirst===1)}}Object.defineProperty(Xt,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{filter:{type:1,p0:0,p1:0,reverse:0,chunks:0,random:0,seed:0,limit:0,limitAffectsType:0,customData:{}},axis:0,flip:0,beatDistribution:0,beatDistributionType:1,gapDistribution:0,gapDistributionType:1,affectFirst:0,easing:0,events:[],customData:{}}});class Qe extends zn{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"boxes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.time=e.time??Qe.defaultValue.time,this.id=e.id??Qe.defaultValue.id,this.boxes=(e.boxes??Qe.defaultValue.boxes).map(i=>new Xt(i)),this.customData=W(e.customData??Qe.defaultValue.customData)}}Object.defineProperty(Qe,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,id:0,boxes:[],customData:{}}});class qe extends Ne{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"easing",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"previous",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.time=e.time??qe.defaultValue.time,this.easing=e.easing??qe.defaultValue.easing,this.previous=e.previous??qe.defaultValue.previous,this.value=e.value??qe.defaultValue.value,this.customData=W(e.customData??qe.defaultValue.customData)}setEasing(e){return this.easing=e,this}setPrevious(e){return this.previous=e,this}setValue(e){return this.value=e,this}isValid(e,i){return i?super.isValid(e,i):super.isValid(e,i)&&(this.previous===0||this.previous===1)&&this.easing>=-1&&this.easing<=103}}Object.defineProperty(qe,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,easing:0,previous:0,value:0,customData:{}}});class re extends jn{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"fxDistribution",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fxDistributionType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.filter=new Vt(e.filter??re.defaultValue.filter),this.beatDistribution=e.beatDistribution??re.defaultValue.beatDistribution,this.beatDistributionType=e.beatDistributionType??re.defaultValue.beatDistributionType,this.fxDistribution=e.fxDistribution??re.defaultValue.fxDistribution,this.fxDistributionType=e.fxDistributionType??re.defaultValue.fxDistributionType,this.affectFirst=e.affectFirst??re.defaultValue.affectFirst,this.easing=e.easing??re.defaultValue.easing,this.events=(e.events??re.defaultValue.events).map(i=>new qe(i)),this.customData=W(e.customData??re.defaultValue.customData)}setFxDistribution(e){return this.fxDistribution=e,this}setFxDistributionType(e){return this.fxDistributionType=e,this}setEvents(e){return this.events=e,this}isValid(e,i){return i?super.isValid(e,i):super.isValid(e,i)&&(this.fxDistributionType===1||this.fxDistributionType===2)&&(this.affectFirst===0||this.affectFirst===1)}}Object.defineProperty(re,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{filter:{type:1,p0:0,p1:0,reverse:0,chunks:0,random:0,seed:0,limit:0,limitAffectsType:0,customData:{}},beatDistribution:0,beatDistributionType:1,fxDistribution:0,fxDistributionType:1,affectFirst:0,easing:0,events:[],customData:{}}});class ti extends zn{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"boxes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.time=e.time??ti.defaultValue.time,this.id=e.id??ti.defaultValue.id,this.boxes=(e.boxes??ti.defaultValue.boxes).map(i=>new re(i)),this.customData=W(e.customData??ti.defaultValue.customData)}}Object.defineProperty(ti,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,id:0,boxes:[],customData:{}}});class Ri extends Oe{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"keyword",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyword=e.keyword??Ri.defaultValue.keyword,this.events=(e.events??Ri.defaultValue.events).map(i=>i).filter(i=>i),this.customData=W(e.customData??Ri.defaultValue.customData)}setKeyword(e){return this.keyword=e,this}setEvents(e){return this.events=e,this}addEvent(e){return this.events.push(e),this}removeEvent(e){const i=this.events.indexOf(e,0);return i>-1&&this.events.splice(i,1),this}}Object.defineProperty(Ri,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{keyword:"",events:[],customData:{}}});class se extends Oe{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){var i;super(),Object.defineProperty(this,"waypoints",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"basicEvents",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"colorBoostEvents",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lightColorEventBoxGroups",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lightRotationEventBoxGroups",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lightTranslationEventBoxGroups",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fxEventBoxGroups",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"basicEventTypesWithKeywords",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"useNormalEventsAsCompatibleEvents",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.waypoints=(e.waypoints??se.defaultValue.waypoints).map(n=>new Ce(n)),this.basicEvents=(e.basicEvents??se.defaultValue.basicEvents).map(n=>new Pe(n)),this.colorBoostEvents=(e.colorBoostEvents??se.defaultValue.colorBoostEvents).map(n=>new di(n)),this.lightColorEventBoxGroups=(e.lightColorEventBoxGroups??se.defaultValue.lightColorEventBoxGroups).map(n=>new Ze(n)),this.lightRotationEventBoxGroups=(e.lightRotationEventBoxGroups??se.defaultValue.lightRotationEventBoxGroups).map(n=>new Je(n)),this.lightTranslationEventBoxGroups=(e.lightTranslationEventBoxGroups??se.defaultValue.lightTranslationEventBoxGroups).map(n=>new Qe(n)),this.fxEventBoxGroups=(e.fxEventBoxGroups??se.defaultValue.fxEventBoxGroups).map(n=>new ti(n)),this.basicEventTypesWithKeywords={list:(((i=e.basicEventTypesWithKeywords)==null?void 0:i.list)??se.defaultValue.basicEventTypesWithKeywords.list).map(n=>new Ri(n))},this.useNormalEventsAsCompatibleEvents=!!e.useNormalEventsAsCompatibleEvents,this.customData=W(e.customData??se.defaultValue.customData)}isValid(e,i){return i?super.isValid(e,i):super.isValid(e,i)&&this.waypoints.every(n=>n.isValid())&&this.basicEvents.every(n=>n.isValid())&&this.colorBoostEvents.every(n=>n.isValid())&&this.lightColorEventBoxGroups.every(n=>n.isValid())&&this.lightRotationEventBoxGroups.every(n=>n.isValid())&&this.lightTranslationEventBoxGroups.every(n=>n.isValid())&&this.fxEventBoxGroups.every(n=>n.isValid())&&this.basicEventTypesWithKeywords.list.every(n=>n.isValid())}sort(){this.waypoints.sort(xt),this.basicEvents.sort(xt),this.colorBoostEvents.sort(xt),this.lightColorEventBoxGroups.sort(xt),this.lightRotationEventBoxGroups.sort(xt),this.lightTranslationEventBoxGroups.sort(xt),this.fxEventBoxGroups.sort(xt);for(let e=0;e<this.lightColorEventBoxGroups.length;e++)for(let i=0;i<this.lightColorEventBoxGroups[e].boxes.length;i++)this.lightColorEventBoxGroups[e].boxes[i].events.sort(xt);for(let e=0;e<this.lightRotationEventBoxGroups.length;e++)for(let i=0;i<this.lightRotationEventBoxGroups[e].boxes.length;i++)this.lightRotationEventBoxGroups[e].boxes[i].events.sort(xt);for(let e=0;e<this.lightTranslationEventBoxGroups.length;e++)for(let i=0;i<this.lightTranslationEventBoxGroups[e].boxes.length;i++)this.lightTranslationEventBoxGroups[e].boxes[i].events.sort(xt);for(let e=0;e<this.fxEventBoxGroups.length;e++)for(let i=0;i<this.fxEventBoxGroups[e].boxes.length;i++)this.fxEventBoxGroups[e].boxes[i].events.sort(xt);return this}addWaypoints(...e){for(const i of e)this.waypoints.push(new Ce(i));return this}addBasicEvents(...e){for(const i of e)this.basicEvents.push(new Pe(i));return this}addColorBoostEvents(...e){for(const i of e)this.colorBoostEvents.push(new di(i));return this}addLightColorEventBoxGroups(...e){for(const i of e)this.lightColorEventBoxGroups.push(new Ze(i));return this}addLightRotationEventBoxGroups(...e){for(const i of e)this.lightRotationEventBoxGroups.push(new Je(i));return this}addLightTranslationEventBoxGroups(...e){for(const i of e)this.lightTranslationEventBoxGroups.push(new Qe(i));return this}addFxEventBoxGroups(...e){for(const i of e)this.fxEventBoxGroups.push(new ti(i));return this}}Object.defineProperty(se,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{waypoints:[],basicEvents:[],colorBoostEvents:[],lightColorEventBoxGroups:[],lightRotationEventBoxGroups:[],lightTranslationEventBoxGroups:[],fxEventBoxGroups:[],basicEventTypesWithKeywords:{list:[]},useNormalEventsAsCompatibleEvents:!1,customData:{}}});class Re extends Oe{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"difficulty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lightshow",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filename",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lightshowFilename",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.version=e.version??Re.defaultValue.version,this.filename=e.filename??Re.defaultValue.filename,this.lightshowFilename=e.lightshowFilename??Re.defaultValue.lightshowFilename,this.difficulty=new de(e.difficulty??Re.defaultValue.difficulty),this.lightshow=new se(e.lightshow??Re.defaultValue.lightshow)}isValid(e,i){return super.isValid(e)}get bpmEvents(){return this.difficulty.bpmEvents}set bpmEvents(e){this.difficulty.bpmEvents=e}get rotationEvents(){return this.difficulty.rotationEvents}set rotationEvents(e){this.difficulty.rotationEvents=e}get colorNotes(){return this.difficulty.colorNotes}set colorNotes(e){this.difficulty.colorNotes=e}get bombNotes(){return this.difficulty.bombNotes}set bombNotes(e){this.difficulty.bombNotes=e}get obstacles(){return this.difficulty.obstacles}set obstacles(e){this.difficulty.obstacles=e}get arcs(){return this.difficulty.arcs}set arcs(e){this.difficulty.arcs=e}get chains(){return this.difficulty.chains}set chains(e){this.difficulty.chains=e}get waypoints(){return this.lightshow.waypoints}set waypoints(e){this.lightshow.waypoints=e}get basicEvents(){return this.lightshow.basicEvents}set basicEvents(e){this.lightshow.basicEvents=e}get colorBoostEvents(){return this.lightshow.colorBoostEvents}set colorBoostEvents(e){this.lightshow.colorBoostEvents=e}get lightColorEventBoxGroups(){return this.lightshow.lightColorEventBoxGroups}set lightColorEventBoxGroups(e){this.lightshow.lightColorEventBoxGroups=e}get lightRotationEventBoxGroups(){return this.lightshow.lightRotationEventBoxGroups}set lightRotationEventBoxGroups(e){this.lightshow.lightRotationEventBoxGroups=e}get lightTranslationEventBoxGroups(){return this.lightshow.lightTranslationEventBoxGroups}set lightTranslationEventBoxGroups(e){this.lightshow.lightTranslationEventBoxGroups=e}get fxEventBoxGroups(){return this.lightshow.fxEventBoxGroups}set fxEventBoxGroups(e){this.lightshow.fxEventBoxGroups=e}get basicEventTypesWithKeywords(){return this.lightshow.basicEventTypesWithKeywords}set basicEventTypesWithKeywords(e){this.lightshow.basicEventTypesWithKeywords=e}get useNormalEventsAsCompatibleEvents(){return this.lightshow.useNormalEventsAsCompatibleEvents}set useNormalEventsAsCompatibleEvents(e){this.lightshow.useNormalEventsAsCompatibleEvents=e}setFilename(e){return this.filename=e,this}setLightshowFilename(e){return this.lightshowFilename=e,this}setVersion(e){return this.version=e,this}sort(e){return this.difficulty.sort(),this.lightshow.sort(),super.sort(e)}addBpmEvents(...e){return this.difficulty.addBpmEvents(...e),this}addRotationEvents(...e){return this.difficulty.addRotationEvents(...e),this}addColorNotes(...e){return this.difficulty.addColorNotes(...e),this}addBombNotes(...e){return this.difficulty.addBombNotes(...e),this}addObstacles(...e){return this.difficulty.addObstacles(...e),this}addArcs(...e){return this.difficulty.addArcs(...e),this}addChains(...e){return this.difficulty.addChains(...e),this}addWaypoints(...e){return this.lightshow.addWaypoints(...e),this}addBasicEvents(...e){return this.lightshow.addBasicEvents(...e),this}addColorBoostEvents(...e){return this.lightshow.addColorBoostEvents(...e),this}addLightColorEventBoxGroups(...e){return this.lightshow.addLightColorEventBoxGroups(...e),this}addLightRotationEventBoxGroups(...e){return this.lightshow.addLightRotationEventBoxGroups(...e),this}addLightTranslationEventBoxGroups(...e){return this.lightshow.addLightTranslationEventBoxGroups(...e),this}addFxEventBoxGroups(...e){return this.lightshow.addFxEventBoxGroups(...e),this}}Object.defineProperty(Re,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{version:-1,filename:"Unnamed.beatmap.dat",lightshowFilename:"Unnamed.lightshow.dat",customData:{},difficulty:{bpmEvents:[],rotationEvents:[],colorNotes:[],bombNotes:[],obstacles:[],arcs:[],chains:[],customData:{}},lightshow:{waypoints:[],basicEvents:[],colorBoostEvents:[],lightColorEventBoxGroups:[],lightRotationEventBoxGroups:[],lightTranslationEventBoxGroups:[],fxEventBoxGroups:[],basicEventTypesWithKeywords:{list:[]},useNormalEventsAsCompatibleEvents:!1,customData:{}}}});const rr={Standard:"Standard",NoArrows:"No Arrows",OneSaber:"One Saber",Legacy:"Legacy","360Degree":"360 Degree","90Degree":"90 Degree",Lightshow:"Lightshow",Lawless:"Lawless"},sr={Standard:0,NoArrows:1,OneSaber:2,Legacy:3,"360Degree":4,"90Degree":5,Lightshow:6,Lawless:7},kn={Easy:1,Normal:3,Hard:5,Expert:7,ExpertPlus:9,"Expert+":9},ei={Easy:"Easy",Normal:"Normal",Hard:"Hard",Expert:"Expert",ExpertPlus:"Expert+","Expert+":"Expert+"};class Ut extends Oe{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){var i,n;super(),Object.defineProperty(this,"characteristic",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"difficulty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filename",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lightshowFilename",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"authors",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"njs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"njsOffset",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"colorSchemeId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"environmentId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.characteristic=e.characteristic??Ut.defaultValue.characteristic,this.difficulty=e.difficulty??Ut.defaultValue.difficulty,this.filename=e.filename??Ut.defaultValue.filename,this.lightshowFilename=e.lightshowFilename??Ut.defaultValue.lightshowFilename,this.authors={mappers:(((i=e.authors)==null?void 0:i.mappers)??Ut.defaultValue.authors.mappers).map(o=>o),lighters:(((n=e.authors)==null?void 0:n.lighters)??Ut.defaultValue.authors.lighters).map(o=>o)},this.njs=e.njs??Ut.defaultValue.njs,this.njsOffset=e.njsOffset??Ut.defaultValue.njsOffset,this.colorSchemeId=e.colorSchemeId??Ut.defaultValue.colorSchemeId,this.environmentId=e.environmentId??Ut.defaultValue.environmentId,this.customData=W(e.customData??Ut.defaultValue.customData)}isValid(e,i){return i?super.isValid(e,i):super.isValid(e,i)&&this.njs>0&&this.colorSchemeId>=-1&&this.environmentId>=0}}Object.defineProperty(Ut,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{characteristic:"Standard",difficulty:"Easy",filename:"Unnamed.beatmap.dat",lightshowFilename:"Unnamed.lightshow.dat",authors:{mappers:[],lighters:[]},njs:10,njsOffset:0,colorSchemeId:-1,environmentId:0,customData:{}}});class St extends Oe{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(i=>new this(i)):[new this]}constructor(e={}){var i,n,o,r,a,s,l,c,h,p,d,u,m,b,y;super(),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filename",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"song",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"audio",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"songPreviewFilename",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"coverImageFilename",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"environmentBase",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"environmentNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"colorSchemes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"difficulties",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.version=e.version??St.defaultValue.version,this.filename=e.filename??St.defaultValue.filename,this.song={title:((i=e.song)==null?void 0:i.title)??St.defaultValue.song.title,subTitle:((n=e.song)==null?void 0:n.subTitle)??St.defaultValue.song.subTitle,author:((o=e.song)==null?void 0:o.author)??St.defaultValue.song.author},this.audio={filename:((r=e.audio)==null?void 0:r.filename)??St.defaultValue.audio.filename,duration:((a=e.audio)==null?void 0:a.duration)??St.defaultValue.audio.duration,audioDataFilename:((s=e.audio)==null?void 0:s.audioDataFilename)??St.defaultValue.audio.audioDataFilename,bpm:((l=e.audio)==null?void 0:l.bpm)??St.defaultValue.audio.bpm,lufs:((c=e.audio)==null?void 0:c.lufs)??St.defaultValue.audio.lufs,previewStartTime:((h=e.audio)==null?void 0:h.previewStartTime)??St.defaultValue.audio.previewStartTime,previewDuration:((p=e.audio)==null?void 0:p.previewDuration)??St.defaultValue.audio.previewDuration,audioOffset:((d=e.audio)==null?void 0:d.audioOffset)??St.defaultValue.audio.audioOffset,shuffle:((u=e.audio)==null?void 0:u.shuffle)??St.defaultValue.audio.shuffle,shufflePeriod:((m=e.audio)==null?void 0:m.shufflePeriod)??St.defaultValue.audio.shufflePeriod},this.songPreviewFilename=e.songPreviewFilename??St.defaultValue.songPreviewFilename,this.coverImageFilename=e.coverImageFilename??St.defaultValue.coverImageFilename,this.environmentBase={normal:((b=e.environmentBase)==null?void 0:b.normal)??St.defaultValue.environmentBase.normal,allDirections:((y=e.environmentBase)==null?void 0:y.allDirections)??St.defaultValue.environmentBase.allDirections},this.environmentNames=(e.environmentNames??St.defaultValue.environmentNames).map(v=>v),this.colorSchemes=(e.colorSchemes??St.defaultValue.colorSchemes).map(v=>{var w,C,T,P,A,V,O,Y,et,S,$,g,j,at,H,ct,X,st,N,B,nt,Q,Z,Et,kt,ft,vt,Tt,Dt,zt,$t,f,F,I,D,E;const _={useOverride:v.useOverride||!1,name:v.name||"",saberLeftColor:{r:((w=v.saberLeftColor)==null?void 0:w.r)||0,g:((C=v.saberLeftColor)==null?void 0:C.g)||0,b:((T=v.saberLeftColor)==null?void 0:T.b)||0,a:((P=v.saberLeftColor)==null?void 0:P.a)||0},saberRightColor:{r:((A=v.saberRightColor)==null?void 0:A.r)||0,g:((V=v.saberRightColor)==null?void 0:V.g)||0,b:((O=v.saberRightColor)==null?void 0:O.b)||0,a:((Y=v.saberRightColor)==null?void 0:Y.a)||0},environment0Color:{r:((et=v.environment0Color)==null?void 0:et.r)||0,g:((S=v.environment0Color)==null?void 0:S.g)||0,b:(($=v.environment0Color)==null?void 0:$.b)||0,a:((g=v.environment0Color)==null?void 0:g.a)||0},environment1Color:{r:((j=v.environment1Color)==null?void 0:j.r)||0,g:((at=v.environment1Color)==null?void 0:at.g)||0,b:((H=v.environment1Color)==null?void 0:H.b)||0,a:((ct=v.environment1Color)==null?void 0:ct.a)||0},environment0ColorBoost:{r:((X=v.environment0ColorBoost)==null?void 0:X.r)||0,g:((st=v.environment0ColorBoost)==null?void 0:st.g)||0,b:((N=v.environment0ColorBoost)==null?void 0:N.b)||0,a:((B=v.environment0ColorBoost)==null?void 0:B.a)||0},environment1ColorBoost:{r:((nt=v.environment1ColorBoost)==null?void 0:nt.r)||0,g:((Q=v.environment1ColorBoost)==null?void 0:Q.g)||0,b:((Z=v.environment1ColorBoost)==null?void 0:Z.b)||0,a:((Et=v.environment1ColorBoost)==null?void 0:Et.a)||0},obstaclesColor:{r:((kt=v.obstaclesColor)==null?void 0:kt.r)||0,g:((ft=v.obstaclesColor)==null?void 0:ft.g)||0,b:((vt=v.obstaclesColor)==null?void 0:vt.b)||0,a:((Tt=v.obstaclesColor)==null?void 0:Tt.a)||0}};return v.environmentWColor&&(_.environmentWColor={r:((Dt=v.environmentWColor)==null?void 0:Dt.r)||0,g:((zt=v.environmentWColor)==null?void 0:zt.g)||0,b:(($t=v.environmentWColor)==null?void 0:$t.b)||0,a:((f=v.environmentWColor)==null?void 0:f.a)||0}),v.environmentWColorBoost&&(_.environmentWColorBoost={r:((F=v.environmentWColorBoost)==null?void 0:F.r)||0,g:((I=v.environmentWColorBoost)==null?void 0:I.g)||0,b:((D=v.environmentWColorBoost)==null?void 0:D.b)||0,a:((E=v.environmentWColorBoost)==null?void 0:E.a)||0}),_}),this.difficulties=(e.difficulties??St.defaultValue.difficulties).map(v=>new Ut(v)),this.customData=W(e.customData??St.defaultValue.customData)}isValid(e,i){return i?super.isValid(e,i):super.isValid(e,i)&&this.audio.filename!==""&&this.audio.duration>0&&this.audio.previewDuration>0&&this.audio.previewStartTime>0&&this.audio.audioOffset>=0&&this.difficulties.every(n=>n.isValid())}clone(){return super.clone().setFilename(this.filename)}setFilename(e){return this.filename=e,this}setVersion(e){return this.version=e,this}sort(){return this.difficulties.sort((e,i)=>kn[e.difficulty]-kn[i.difficulty]).sort((e,i)=>(sr[e.characteristic]||0)-(sr[i.characteristic]||0)),this}addMap(e){return this.difficulties.push(new Ut(e)),this}}Object.defineProperty(St,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{version:-1,filename:"Info.dat",song:{title:"Untitled",subTitle:"",author:"NoAuthor"},audio:{filename:"",duration:0,audioDataFilename:"",bpm:0,lufs:0,previewStartTime:0,previewDuration:0,audioOffset:0,shuffle:0,shufflePeriod:.5},songPreviewFilename:"",coverImageFilename:"",environmentBase:{normal:null,allDirections:null},environmentNames:[],colorSchemes:[],difficulties:[],customData:{}}});function Em(t){return Array.isArray(t.customData._color)||typeof t.customData._lightID=="number"||Array.isArray(t.customData._lightID)||typeof t.customData._propID=="number"||typeof t.customData._lightGradient=="object"||typeof t.customData._easing=="string"||typeof t.customData._lerpType=="string"||typeof t.customData._nameFilter=="string"||typeof t.customData._reset=="boolean"||typeof t.customData._rotation=="number"||typeof t.customData._step=="number"||typeof t.customData._prop=="number"||typeof t.customData._speed=="number"||typeof t.customData._direction=="number"||typeof t.customData._counterSpin=="boolean"||typeof t.customData._stepMult=="number"||typeof t.customData._propMult=="number"||typeof t.customData._speedMult=="number"||typeof t.customData._lockPosition=="boolean"||typeof t.customData._speed=="number"||typeof t.customData._preciseSpeed=="number"||typeof t.customData._direction=="number"}function yu(t){return Array.isArray(t.customData._color)||typeof t.customData._disableSpawnEffect=="boolean"}function Eu(t){return Array.isArray(t.customData._animation)||typeof t.customData._cutDirection=="number"||typeof t.customData._disableNoteGravity=="boolean"||typeof t.customData._disableNoteLook=="boolean"||typeof t.customData._fake=="boolean"||Array.isArray(t.customData._flip)||typeof t.customData._interactable=="boolean"||Array.isArray(t.customData._localRotation)||typeof t.customData._noteJumpMovementSpeed=="number"||typeof t.customData._noteJumpStartBeatOffset=="number"||Array.isArray(t.customData._position)||Array.isArray(t.customData._rotation)}function Dm(t){return Array.isArray(t.customData._color)}function wm(t){return Array.isArray(t.customData._animation)||typeof t.customData._fake=="boolean"||typeof t.customData._interactable=="boolean"||Array.isArray(t.customData._localRotation)||typeof t.customData._noteJumpMovementSpeed=="number"||typeof t.customData._noteJumpStartBeatOffset=="number"||Array.isArray(t.customData._position)||Array.isArray(t.customData._rotation)||Array.isArray(t.customData._scale)}function Du(t){return t.posX<0||t.posX>3||t.width<0||t.width>4||t.posY<0||t.posY>2||t.posY===1||t.posY===0&&t.height!==5||t.posY===2&&t.height!==3}function Sm(t){return Array.isArray(t.customData.color)||typeof t.customData.lightID=="number"||Array.isArray(t.customData.lightID)||typeof t.customData.easing=="string"||typeof t.customData.lerpType=="string"||typeof t.customData.nameFilter=="string"||typeof t.customData.rotation=="number"||typeof t.customData.step=="number"||typeof t.customData.prop=="number"||typeof t.customData.speed=="number"||typeof t.customData.direction=="number"||typeof t.customData.lockRotation=="boolean"||typeof t.customData.speed=="number"||typeof t.customData.direction=="number"}function wu(t){return Array.isArray(t.customData.color)||typeof t.customData.spawnEffect=="boolean"||typeof t.customData.disableDebris=="boolean"}function Su(t){return Array.isArray(t.customData.animation)||typeof t.customData.disableNoteGravity=="boolean"||typeof t.customData.disableNoteLook=="boolean"||typeof t.customData.disableBadCutDirection=="boolean"||typeof t.customData.disableBadCutSaberType=="boolean"||typeof t.customData.disableBadCutSpeed=="boolean"||Array.isArray(t.customData.flip)||typeof t.customData.uninteractable=="boolean"||Array.isArray(t.customData.localRotation)||typeof t.customData.noteJumpMovementSpeed=="number"||typeof t.customData.noteJumpStartBeatOffset=="number"||Array.isArray(t.customData.coordinates)||Array.isArray(t.customData.worldRotation)||typeof t.customData.worldRotation=="number"||typeof t.customData.link=="string"}function Cm(t){return Array.isArray(t.customData.color)}function Tm(t){return Array.isArray(t.customData.animation)||typeof t.customData.uninteractable=="boolean"||Array.isArray(t.customData.localRotation)||typeof t.customData.noteJumpMovementSpeed=="number"||typeof t.customData.noteJumpStartBeatOffset=="number"||Array.isArray(t.customData.coordinates)||Array.isArray(t.customData.worldRotation)||Array.isArray(t.customData.size)}function Cu(t){return t.posY<0||t.posY>2||t.posX<=-1e3||t.posX>=1e3||t.width<=-1e3||t.width>=1e3||t.height<=-1e3||t.height>=1e3}function Rm(t){return t.posY>2||t.posY<0||t.posX<=-1e3||t.posX>=1e3||t.direction>=1e3&&t.direction<=1360||t.tailDirection>=1e3&&t.tailDirection<=1360}function Tu(t){return t.posX>3||t.posX<0||t.posY>2||t.posY<0}function km(t){return t.posY>2||t.posY<0||t.posX<=-1e3||t.posX>=1e3||t.direction>=1e3&&t.direction<=1360}function Ru(t){return t.posX>3||t.posX<0||t.posY>2||t.posY<0||t.direction>=1e3&&t.direction<=1360||t.direction>=2e3&&t.direction<=2360}function ar(t,e){const i=t.difficulty.colorNotes;return e?i.length/e:0}function Zn(t,e,i){let n=0,o=0;const r=t.difficulty.colorNotes;for(let a=0;a<r.length;a++){for(;r[a].time-r[o].time>e;)o++;n=Math.max(n,(a-o+1)/i.toRealTime(e))}return n}function wo(t){const e=[...t.difficulty.colorNotes,...t.difficulty.bombNotes,...t.difficulty.chains].sort(Ti);let i=Number.MAX_VALUE;e.length>0&&(i=e[0].time);const n=Lm(t);return Math.min(i,n)}function Wi(t){const e=[...t.difficulty.colorNotes,...t.difficulty.bombNotes,...t.difficulty.chains].sort(Ti);let i=0;e.length>0&&(i=e[e.length-1].time);const n=Bm(t);return Math.max(i,n)}function Lm(t){for(let e=0,i=t.obstacles.length;e<i;e++)if(t.obstacles[e].isInteractive())return t.obstacles[e].time;return Number.MAX_VALUE}function Bm(t){let e=0;for(let i=t.difficulty.obstacles.length-1;i>=0;i--)t.difficulty.obstacles[i].isInteractive()&&(e=Math.max(e,t.difficulty.obstacles[i].time+t.difficulty.obstacles[i].duration));return e}class qt{constructor(e,i=10,n=0){Object.defineProperty(this,"bpm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"offset",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bpm=e,this.value=i,this.offset=n}static create(e,i,n){return new qt(e,i,n)}get hjd(){return this.calcHjd()}get jd(){return this.calcJd()}get reactionTime(){return this.calcRtFromHjd()}calcHjd(e=this.offset){const n=60/this.bpm;let o=qt.HJD_START;for(;this.value*n*o>17.999;)o/=2;return o<1&&(o=1),Math.max(o+e,qt.HJD_MIN)}calcHjdFromJd(e=this.calcJd()){return e/(60/this.bpm*this.value*2)}calcHjdFromRt(e=this.calcRtFromHjd()){return e/(60/this.bpm)}calcJd(e=this.calcHjd()){return this.value*(60/this.bpm)*e*2}calcJdOptimal(){return[-(18/(this.value+1))+18,18*(1/1.07)**this.value+18]}calcRtFromJd(e=this.calcJd()){return e/(2*this.value)}calcRtFromHjd(e=this.calcHjd()){return 60/this.bpm*e}calcDistance(e){return this.value*60/this.bpm*e*2}}Object.defineProperty(qt,"HJD_START",{enumerable:!0,configurable:!0,writable:!0,value:4});Object.defineProperty(qt,"HJD_MIN",{enumerable:!0,configurable:!0,writable:!0,value:.25});Object.defineProperty(qt,"FallbackNJS",{enumerable:!0,configurable:!0,writable:!0,value:{"Expert+":16,ExpertPlus:16,Expert:12,Hard:10,Normal:10,Easy:10}});var ae;(function(t){t[t.NONE=0]="NONE",t[t.NORMAL=1]="NORMAL",t[t.ARC_HEAD=2]="ARC_HEAD",t[t.ARC_TAIL=3]="ARC_TAIL",t[t.CHAIN_HEAD=4]="CHAIN_HEAD",t[t.CHAIN_ELEMENT=5]="CHAIN_ELEMENT"})(ae||(ae={}));const xm={[ae.NONE]:0,[ae.NORMAL]:115,[ae.ARC_HEAD]:115,[ae.ARC_TAIL]:115,[ae.CHAIN_HEAD]:85,[ae.CHAIN_ELEMENT]:20};function Om(t){let e=0,i=1;const n=Nm(t);for(let o=0;o<n.length;o++)i<8&&o===-3+i*4&&(i*=2),e+=xm[n[o].type]*i;return e}function Nm(t){return[Im(t),Am(t.difficulty.chains)].flat().sort((e,i)=>e.time-i.time)}function Im(t){const e=new Map,i=new Map,n=new Map;for(let o=0;o<t.difficulty.arcs.length;o++){const r=t.difficulty.arcs[o];e.has(r.time)||e.set(r.time,[]),i.has(r.tailTime)||i.set(r.tailTime,[]),e.get(r.time).push(r),i.get(r.tailTime).push(r)}for(let o=0;o<t.difficulty.chains.length;o++){const r=t.difficulty.chains[o];n.has(r.time)||n.set(r.time,[]),n.get(r.time).push(r)}return t.difficulty.colorNotes.map(o=>{var s,l,c;return((s=e.get(o.time))==null?void 0:s.some(h=>h.color===o.color&&h.tailPosX===o.posX&&h.tailPosY===o.posY))||((l=i.get(o.time))==null?void 0:l.some(h=>h.color===o.color&&h.tailPosX===o.posX&&h.tailPosY===o.posY))?{type:ae.ARC_HEAD,time:o.time}:((c=n.get(o.time))==null?void 0:c.some(h=>h.color===o.color&&h.posX===o.posX&&h.posY===o.posY))?{type:ae.CHAIN_HEAD,time:o.time}:{type:ae.NORMAL,time:o.time}})}function Am(t){return t.flatMap(e=>e.sliceCount>1?Array(e.sliceCount-1).map((i,n)=>({type:ae.CHAIN_ELEMENT,time:Rn(Ih(n+1,0,e.sliceCount),e.time,e.tailTime)})):[])}function Pm(t){return["helpers","timeProcessor",t]}class Ln{constructor(e,i=[],n=0){Object.defineProperty(this,"bpm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_bpmChange",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_timeScale",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_offset",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bpm=e,this._offset=n/1e3,this._timeScale=this.getTimeScale(i.filter(o=>("m"in o||"bpm"in o||"timescale"in o)&&!("o"in o))),this._bpmChange=this.getBpmChangeTime(i.filter(o=>"BPM"in o&&"metronomeOffset"in o||("_bpm"in o||"_BPM"in o)&&"_metronomeOffset"in o||"m"in o&&"o"in o)),this._timeScale.length&&this._bpmChange.length&&J.tWarn(Pm("constructor"),"BPM change and BPM event should not be used along side together to avoid confusion between editors and in-game behaviour")}get change(){return this._bpmChange}set change(e){this._bpmChange=this.getBpmChangeTime(e)}get timescale(){return this._timeScale}set timescale(e){this._timeScale=this.getTimeScale(e)}get offset(){return this._offset*1e3}set offset(e){this._offset=e/1e3}getBpmChangeTime(e=[]){let i;const n=[];e=[...e].sort((o,r)=>(o.time??o._time??o.b)-(r.time??r._time??r.b));for(let o=0;o<e.length;o++){const r={time:e[o].time??e[o]._time??e[o].b,BPM:e[o].BPM??e[o]._BPM??e[o]._bpm??e[o].m,beatsPerBar:e[o].beatsPerBar??e[o]._beatsPerBar??e[o].p,metronomeOffset:e[o].metronomeOffset??e[o]._metronomeOffset??e[o].o,newTime:0};i?r.newTime=Math.ceil((r.time-i.time)/this.bpm*i.BPM+i.newTime-.01):r.newTime=Math.ceil(r.time-this._offset*this.bpm/60-.01),n.push(r),i=r}return n}getTimeScale(e=[]){return[...e].sort((i,n)=>(i.time??i.b)-(n.time??n.b)).map(i=>"scale"in i?i:"bpm"in i?{time:i.time,scale:this.bpm/i.bpm}:{time:i.b||0,scale:this.bpm/i.m})}offsetBegone(e){return this._offset===0?e:this.toBeatTime(this.toRealTime(e,!1)-this._offset)}toRealTime(e,i=!0){if(!i)return e/this.bpm*60;let n=0;for(let o=this._timeScale.length-1;o>=0;o--)e>this._timeScale[o].time&&(n+=(e-this._timeScale[o].time)*this._timeScale[o].scale,e=this._timeScale[o].time);return(e+n)/this.bpm*60}toBeatTime(e,i=!0){if(!i)return e*this.bpm/60;let n=0;for(let o=this._timeScale.length-1;o>=0;o--){const r=this.toRealTime(this._timeScale[o].time,i);e>r&&(n+=(e-r)/this._timeScale[o].scale,e=r)}return this.toBeatTime(e+n,!1)}toJsonTime(e){for(let i=this._bpmChange.length-1;i>=0;i--)if(e>this._bpmChange[i].newTime)return(e-this._bpmChange[i].newTime)/this._bpmChange[i].BPM*this.bpm+this._bpmChange[i].time;return this.toBeatTime(this.toRealTime(e,!1)+this._offset)}adjustTime(e){for(let i=this._bpmChange.length-1;i>=0;i--)if(e>this._bpmChange[i].time)return(e-this._bpmChange[i].time)/this.bpm*this._bpmChange[i].BPM+this._bpmChange[i].newTime;return this.offsetBegone(e)}}Object.defineProperty(Ln,"create",{enumerable:!0,configurable:!0,writable:!0,value:(t,e,i)=>new Ln(t,e,i)});function ku(t){switch(t){case"info":case"difficulty":return"2.0.0";case"lightshow":return"3.0.0";default:return"4.0.0"}}function Lu(t){const e=t._version??t.version;return typeof e!="string"?null:e}function Bu(t,e){const i=lr(t),n=lr(e);for(const o in i){if(i[o]<n[o])return-1;if(i[o]>n[o])return 1}return 0}function lr(t){return t.split(".").map(e=>parseInt(e))}const $m={1:am,2:mm,4:ym},Mm={2:lm,4:gm},ur={1:om,2:cm,3:_u,4:_m},cr={serialize(t){return{difficulty:t.difficulty,difficultyRank:kn[t.difficulty],audioPath:"",jsonPath:t.filename,characteristic:t.characteristic,offset:t.customData._editorOffset,oldOffset:t.customData._editorOldOffset,chromaToggle:t.customData._chromaToggle,customColors:t.customData._customColors,difficultyLabel:t.customData._difficultyLabel,colorLeft:Nt(t.customData._colorLeft),colorRight:Nt(t.customData._colorRight),envColorLeft:Nt(t.customData._envColorLeft),envColorRight:Nt(t.customData._envColorRight),obstacleColor:Nt(t.customData._obstacleColor)}},deserialize(t={}){return{difficulty:t.difficulty,filename:t.jsonPath,njs:0,njsOffset:0,characteristic:t.characteristic,customData:{_editorOffset:t.offset,_editorOldOffset:t.oldOffset,_chromaToggle:t.chromaToggle,_customColors:t.customColors,_difficultyLabel:t.difficultyLabel,_colorLeft:Nt(t.colorLeft),_colorRight:Nt(t.colorRight),_envColorLeft:Nt(t.envColorLeft),_envColorRight:Nt(t.envColorRight),_obstacleColor:Nt(t.obstacleColor)}}}},Fm={serialize(t){return{songName:t.song.title,songSubName:t.song.subTitle,authorName:t.song.author,beatsPerMinute:t.audio.bpm,previewStartTime:t.audio.previewStartTime,previewDuration:t.audio.previewDuration,coverImagePath:t.coverImageFilename,environmentName:t.environmentBase.normal||t.environmentNames.find(e=>!ki(e))||"DefaultEnvironment",difficultyLevels:t.difficulties.map(cr.serialize),oneSaber:t.difficulties.some(e=>e.characteristic==="OneSaber"),contributors:W(t.customData._contributors),customEnvironment:t.customData._customEnvironment,customEnvironmentHash:t.customData._customEnvironmentHash}},deserialize(t={}){var e,i,n,o,r;return{version:1,song:{title:t.songName,subTitle:t.songSubName,author:t.authorName},audio:{filename:(i=(e=t.difficultyLevels)==null?void 0:e.find(a=>a==null?void 0:a.audioPath))==null?void 0:i.audioPath,bpm:t.beatsPerMinute,previewStartTime:t.previewStartTime,previewDuration:t.previewDuration},songPreviewFilename:(o=(n=t.difficultyLevels)==null?void 0:n.find(a=>a==null?void 0:a.audioPath))==null?void 0:o.audioPath,coverImageFilename:t.coverImagePath,environmentBase:{normal:t.environmentName},difficulties:(r=t.difficultyLevels)==null?void 0:r.map(cr.deserialize),customData:{_contributors:t.contributors,_customEnvironment:t.customEnvironment,_customEnvironmentHash:t.customEnvironmentHash}}}},hr={serialize(t){return{_difficulty:t.difficulty,_difficultyRank:kn[t.difficulty],_beatmapFilename:t.filename,_noteJumpMovementSpeed:t.njs,_noteJumpStartBeatOffset:t.njsOffset,_beatmapColorSchemeIdx:t.colorSchemeId,_environmentNameIdx:t.environmentId,_customData:W(t.customData)}},deserialize(t={}){return{difficulty:t._difficulty,filename:t._beatmapFilename,njs:t._noteJumpMovementSpeed,njsOffset:t._noteJumpStartBeatOffset,colorSchemeId:t._beatmapColorSchemeIdx,environmentId:t._environmentNameIdx,customData:t._customData}}},jm={serialize(t){const e=new Set,i={_version:"2.1.0",_songName:t.song.title,_songSubName:t.song.subTitle,_songAuthorName:t.song.author,_levelAuthorName:"",_beatsPerMinute:t.audio.bpm,_songTimeOffset:t.audio.audioOffset,_shuffle:t.audio.shuffle,_shufflePeriod:t.audio.shufflePeriod,_previewStartTime:t.audio.previewStartTime,_previewDuration:t.audio.previewDuration,_songFilename:t.audio.filename,_coverImageFilename:t.coverImageFilename,_environmentName:t.environmentBase.normal||t.environmentNames.find(n=>!ki(n))||"DefaultEnvironment",_allDirectionsEnvironmentName:t.environmentBase.allDirections||t.environmentNames.find(n=>ki(n))||"GlassDesertEnvironment",_environmentNames:t.environmentNames.map(n=>n),_colorSchemes:t.colorSchemes.map(n=>{const o={useOverride:n.useOverride,colorScheme:{colorSchemeId:n.name,saberAColor:Nt(n.saberLeftColor),saberBColor:Nt(n.saberRightColor),environmentColor0:Nt(n.environment0Color),environmentColor1:Nt(n.environment1Color),obstaclesColor:Nt(n.obstaclesColor),environmentColor0Boost:Nt(n.environment0ColorBoost),environmentColor1Boost:Nt(n.environment1ColorBoost)}};return n.environmentWColor&&(o.colorScheme.environmentColorW=Nt(n.environmentWColor)),n.environmentWColorBoost&&(o.colorScheme.environmentColorWBoost=Nt(n.environmentWColorBoost)),o}),_customData:W(t.customData),_difficultyBeatmapSets:t.difficulties.reduce((n,o)=>{let r=n.find(a=>a._beatmapCharacteristicName===o.characteristic);return r||(r={_beatmapCharacteristicName:o.characteristic,_difficultyBeatmaps:[]},n.push(r)),o.authors.mappers.forEach(a=>e.add(a)),o.authors.lighters.forEach(a=>e.add(a)),r._difficultyBeatmaps.push(hr.serialize(o)),n},[])};return i._levelAuthorName=[...e].join(", "),i},deserialize(t={}){var i,n,o;return{version:2,song:{title:t._songName,subTitle:t._songSubName,author:t._songAuthorName},audio:{bpm:t._beatsPerMinute,previewStartTime:t._previewStartTime,previewDuration:t._previewDuration,filename:t._songFilename,audioOffset:t._songTimeOffset,shuffle:t._shuffle,shufflePeriod:t._shufflePeriod},songPreviewFilename:t._songFilename,coverImageFilename:t._coverImageFilename,environmentBase:{normal:t._environmentName,allDirections:t._allDirectionsEnvironmentName},environmentNames:(i=t._environmentNames)==null?void 0:i.map(r=>r),colorSchemes:(n=t._colorSchemes)==null?void 0:n.map(r=>{var s,l,c,h,p,d,u,m,b,y,v,_,w,C,T,P,A,V,O,Y,et,S,$,g,j,at,H,ct,X,st,N,B,nt,Q,Z,Et,kt,ft,vt,Tt,Dt,zt,$t,f,F,I,D,E,R,z,G,L,q,tt,K,ot,_t,gt,Ht,ze,Kt,Ve,Rt,si,vi,Qt,Ii,tn,en,nn,Ai,Ge,ai,Fo,jo;const a={useOverride:!!r.useOverride,name:(s=r.colorScheme)==null?void 0:s.colorSchemeId,saberLeftColor:{r:(c=(l=r.colorScheme)==null?void 0:l.saberAColor)==null?void 0:c.r,g:(p=(h=r.colorScheme)==null?void 0:h.saberAColor)==null?void 0:p.g,b:(u=(d=r.colorScheme)==null?void 0:d.saberAColor)==null?void 0:u.b,a:(b=(m=r.colorScheme)==null?void 0:m.saberAColor)==null?void 0:b.a},saberRightColor:{r:(v=(y=r.colorScheme)==null?void 0:y.saberBColor)==null?void 0:v.r,g:(w=(_=r.colorScheme)==null?void 0:_.saberBColor)==null?void 0:w.g,b:(T=(C=r.colorScheme)==null?void 0:C.saberBColor)==null?void 0:T.b,a:(A=(P=r.colorScheme)==null?void 0:P.saberBColor)==null?void 0:A.a},environment0Color:{r:(O=(V=r.colorScheme)==null?void 0:V.environmentColor0)==null?void 0:O.r,g:(et=(Y=r.colorScheme)==null?void 0:Y.environmentColor0)==null?void 0:et.g,b:($=(S=r.colorScheme)==null?void 0:S.environmentColor0)==null?void 0:$.b,a:(j=(g=r.colorScheme)==null?void 0:g.environmentColor0)==null?void 0:j.a},environment1Color:{r:(H=(at=r.colorScheme)==null?void 0:at.environmentColor1)==null?void 0:H.r,g:(X=(ct=r.colorScheme)==null?void 0:ct.environmentColor1)==null?void 0:X.g,b:(N=(st=r.colorScheme)==null?void 0:st.environmentColor1)==null?void 0:N.b,a:(nt=(B=r.colorScheme)==null?void 0:B.environmentColor1)==null?void 0:nt.a},obstaclesColor:{r:(Z=(Q=r.colorScheme)==null?void 0:Q.obstaclesColor)==null?void 0:Z.r,g:(kt=(Et=r.colorScheme)==null?void 0:Et.obstaclesColor)==null?void 0:kt.g,b:(vt=(ft=r.colorScheme)==null?void 0:ft.obstaclesColor)==null?void 0:vt.b,a:(Dt=(Tt=r.colorScheme)==null?void 0:Tt.obstaclesColor)==null?void 0:Dt.a},environment0ColorBoost:{r:($t=(zt=r.colorScheme)==null?void 0:zt.environmentColor0Boost)==null?void 0:$t.r,g:(F=(f=r.colorScheme)==null?void 0:f.environmentColor0Boost)==null?void 0:F.g,b:(D=(I=r.colorScheme)==null?void 0:I.environmentColor0Boost)==null?void 0:D.b,a:(R=(E=r.colorScheme)==null?void 0:E.environmentColor0Boost)==null?void 0:R.a},environment1ColorBoost:{r:(G=(z=r.colorScheme)==null?void 0:z.environmentColor1Boost)==null?void 0:G.r,g:(q=(L=r.colorScheme)==null?void 0:L.environmentColor1Boost)==null?void 0:q.g,b:(K=(tt=r.colorScheme)==null?void 0:tt.environmentColor1Boost)==null?void 0:K.b,a:(_t=(ot=r.colorScheme)==null?void 0:ot.environmentColor1Boost)==null?void 0:_t.a}};return(gt=r.colorScheme)!=null&&gt.environmentColorW&&(a.environmentWColor={r:(ze=(Ht=r.colorScheme)==null?void 0:Ht.environmentColorW)==null?void 0:ze.r,g:(Ve=(Kt=r.colorScheme)==null?void 0:Kt.environmentColorW)==null?void 0:Ve.g,b:(si=(Rt=r.colorScheme)==null?void 0:Rt.environmentColorW)==null?void 0:si.b,a:(Qt=(vi=r.colorScheme)==null?void 0:vi.environmentColorW)==null?void 0:Qt.a}),(Ii=r.colorScheme)!=null&&Ii.environmentColorWBoost&&(a.environmentWColorBoost={r:(en=(tn=r.colorScheme)==null?void 0:tn.environmentColorWBoost)==null?void 0:en.r,g:(Ai=(nn=r.colorScheme)==null?void 0:nn.environmentColorWBoost)==null?void 0:Ai.g,b:(ai=(Ge=r.colorScheme)==null?void 0:Ge.environmentColorWBoost)==null?void 0:ai.b,a:(jo=(Fo=r.colorScheme)==null?void 0:Fo.environmentColorWBoost)==null?void 0:jo.a}),a}),difficulties:(o=t._difficultyBeatmapSets)==null?void 0:o.flatMap(r=>{var a;return(a=r._difficultyBeatmaps)==null?void 0:a.map(s=>{const l=hr.deserialize(s);return l.characteristic=r._beatmapCharacteristicName,l.authors={mappers:[t._levelAuthorName]},l})}),customData:t._customData}}},mr={serialize(t){return{characteristic:t.characteristic,difficulty:t.difficulty,beatmapAuthors:{mappers:[...t.authors.mappers],lighters:[...t.authors.lighters]},environmentNameIdx:t.environmentId,beatmapColorSchemeIdx:t.colorSchemeId,noteJumpMovementSpeed:t.njs,noteJumpStartBeatOffset:t.njsOffset,lightshowDataFilename:t.lightshowFilename,beatmapDataFilename:t.filename,customData:W(t.customData)}},deserialize(t={}){var e,i,n,o;return{characteristic:t.characteristic,difficulty:t.difficulty,authors:{mappers:(i=(e=t.beatmapAuthors)==null?void 0:e.mappers)==null?void 0:i.map(r=>r),lighters:(o=(n=t.beatmapAuthors)==null?void 0:n.lighters)==null?void 0:o.map(r=>r)},filename:t.beatmapDataFilename,lightshowFilename:t.lightshowDataFilename,njs:t.noteJumpMovementSpeed,njsOffset:t.noteJumpStartBeatOffset,colorSchemeId:t.beatmapColorSchemeIdx,environmentId:t.environmentNameIdx,customData:t.customData}}},zm={serialize(t){return{version:"4.0.0",song:{author:t.song.author,title:t.song.title,subTitle:t.song.subTitle},audio:{songFilename:t.audio.filename,songDuration:t.audio.duration,audioDataFilename:t.audio.audioDataFilename,bpm:t.audio.bpm,lufs:t.audio.lufs,previewStartTime:t.audio.previewStartTime,previewDuration:t.audio.previewDuration},songPreviewFilename:t.songPreviewFilename,coverImageFilename:t.coverImageFilename,environmentNames:t.environmentNames.map(e=>e),colorSchemes:t.colorSchemes.map(e=>{const i={colorSchemeName:e.name,saberAColor:pt(e.saberLeftColor),saberBColor:pt(e.saberRightColor),environmentColor0:pt(e.environment0Color),environmentColor1:pt(e.environment1Color),obstaclesColor:pt(e.obstaclesColor),environmentColor0Boost:pt(e.environment0ColorBoost),environmentColor1Boost:pt(e.environment1ColorBoost)};return e.environmentWColor&&(i.environmentColorW=pt(e.environmentWColor)),e.environmentWColorBoost&&(i.environmentColorWBoost=pt(e.environmentWColorBoost)),i}),difficultyBeatmaps:t.difficulties.map(mr.serialize),customData:W(t.customData)}},deserialize(t={}){var e,i,n,o,r,a,s,l,c,h,p,d;return{version:4,song:{author:(e=t.song)==null?void 0:e.author,title:(i=t.song)==null?void 0:i.title,subTitle:(n=t.song)==null?void 0:n.subTitle},audio:{filename:(o=t.audio)==null?void 0:o.songFilename,duration:(r=t.audio)==null?void 0:r.songDuration,audioDataFilename:(a=t.audio)==null?void 0:a.audioDataFilename,bpm:(s=t.audio)==null?void 0:s.bpm,lufs:(l=t.audio)==null?void 0:l.lufs,previewStartTime:(c=t.audio)==null?void 0:c.previewStartTime,previewDuration:(h=t.audio)==null?void 0:h.previewDuration},songPreviewFilename:t.songPreviewFilename,coverImageFilename:t.coverImageFilename,environmentNames:(p=t.environmentNames)==null?void 0:p.map(u=>u),colorSchemes:(d=t.colorSchemes)==null?void 0:d.map(u=>{u=u;const m={useOverride:!0,name:u.colorSchemeName||"",saberLeftColor:ie(me(u.saberAColor),!0),saberRightColor:ie(me(u.saberBColor),!0),environment0Color:ie(me(u.environmentColor0),!0),environment1Color:ie(me(u.environmentColor1),!0),obstaclesColor:ie(me(u.obstaclesColor),!0),environment0ColorBoost:ie(me(u.environmentColor0Boost),!0),environment1ColorBoost:ie(me(u.environmentColor1Boost),!0)};return u.environmentColorW&&(m.environmentWColor=ie(me(u.environmentColorW),!0)),u.environmentColorWBoost&&(m.environmentWColorBoost=ie(me(u.environmentColorWBoost),!0)),m}),difficulties:(t.difficultyBeatmaps??[]).map(u=>mr.deserialize(u)),customData:t.customData}}},Vm={serialize(t){return{_version:"2.0.0",_songSampleCount:t.sampleCount,_songFrequency:t.frequency,_regions:t.bpmData.map(e=>({_startBeat:e.startBeat,_endBeat:e.endBeat,_startSampleIndex:e.startSampleIndex,_endSampleIndex:e.endSampleIndex}))}},deserialize(t={}){var e;return{version:2,sampleCount:t._songSampleCount,frequency:t._songFrequency,bpmData:(e=t._regions)==null?void 0:e.map(i=>({startBeat:i==null?void 0:i._startBeat,endBeat:i==null?void 0:i._endBeat,startSampleIndex:i==null?void 0:i._startSampleIndex,endSampleIndex:i==null?void 0:i._endSampleIndex}))}}},Gm={serialize(t){return{version:"4.0.0",songChecksum:t.audioChecksum,songSampleCount:t.sampleCount,songFrequency:t.frequency,bpmData:t.bpmData.map(e=>({sb:e.startBeat,eb:e.endBeat,si:e.startSampleIndex,ei:e.endSampleIndex})),lufsData:t.lufsData.map(e=>({l:e.lufs,si:e.startSampleIndex,ei:e.endSampleIndex}))}},deserialize(t={}){var e,i;return{version:4,audioChecksum:t.songChecksum,sampleCount:t.songSampleCount,frequency:t.songFrequency,bpmData:(e=t.bpmData)==null?void 0:e.map(n=>({startBeat:n==null?void 0:n.sb,endBeat:n==null?void 0:n.eb,startSampleIndex:n==null?void 0:n.si,endSampleIndex:n==null?void 0:n.ei})),lufsData:(i=t.lufsData)==null?void 0:i.map(n=>({lufs:n==null?void 0:n.l,startSampleIndex:n==null?void 0:n.si,endSampleIndex:n==null?void 0:n.ei}))}}},fr={serialize(t){return{_time:t.time,_lineIndex:t.posX,_lineLayer:t.posY,_type:3,_cutDirection:t.direction}},deserialize(t={}){return{time:t._time,posX:t._lineIndex,posY:t._lineLayer,direction:t._cutDirection}}},pr={serialize(t){return{_time:t.time,_lineIndex:t.posX,_lineLayer:t.posY,_type:t.color,_cutDirection:t.direction}},deserialize(t={}){return{time:t._time,posX:t._lineIndex,posY:t._lineLayer,color:t._type,direction:t._cutDirection}}},dr={serialize(t){return{_time:t.time,_type:t.type,_value:t.value}},deserialize(t={}){return{time:t._time,type:t._type,value:t._value,floatValue:1}}},br={serialize(t){return{_time:t.time,_type:5,_value:t.toggle?1:0}},deserialize(t={}){return{time:t._time,toggle:t._value===1}}},gr={serialize(t){let e=t.rotation%360;return e>=-60&&e<=60&&e%15===0&&e/15!==0?e=vu[e]||e+1360:e+=1360,{_time:t.time,_type:t.executionTime===1?15:14,_value:e}},deserialize(t={}){const e=t._value??0;return{time:t._time,executionTime:t._type===15?1:0,rotation:e>=1e3?(e-1360)%360:gu[e]??0}}},vr={serialize(t){return{_time:t.time,_type:100,_value:Math.round(t.bpm)}},deserialize(t={}){return{time:t._time,bpm:t._value}}},_r={serialize(t){let e=0;return t.height>=0&&t.posY>=0&&(e=t.height*1e3+t.posY+4001),{_time:t.time,_type:t.posY===2&&t.height===3?1:t.posY===0&&t.height===5?0:e,_lineIndex:t.posX,_duration:t.duration,_width:t.width}},deserialize(t={}){const e=t._type??0,i=e===1?3:e>=1e3&&e<=4e3?lu(e,1e3,4e3,0,15):e>4e3&&e<=4005e3?0:5,n=e===1?2:e>4e3&&e<=4005e3?Math.floor((e-4001)/1e3):0;return{time:t._time,posY:n,posX:t._lineIndex,duration:t._duration,width:t._width,height:i}}},Hm={serialize(t){return{_version:"1.5.0",_beatsPerMinute:120,_beatsPerBar:4,_shuffle:0,_shufflePeriod:.5,_noteJumpSpeed:10,_noteJumpStartBeatOffset:0,_notes:[...t.difficulty.colorNotes.map(pr.serialize),...t.difficulty.bombNotes.map(fr.serialize)],_obstacles:t.difficulty.obstacles.map(_r.serialize),_events:[...t.lightshow.basicEvents.map(dr.serialize),...t.lightshow.colorBoostEvents.map(br.serialize),...t.difficulty.rotationEvents.map(gr.serialize),...t.difficulty.bpmEvents.map(vr.serialize)],_time:t.difficulty.customData._time,_BPMChanges:t.difficulty.customData._bpmChanges,_bookmarks:t.difficulty.customData._bookmarks}},deserialize(t={}){var c;const e=[],i=[],n=t._notes||[];for(let h=0;h<n.length;h++){const p=n[h];(p==null?void 0:p._type)===3?i.push(fr.deserialize(p)):e.push(pr.deserialize(p))}const o=[],r=[],a=[],s=[],l=t._events||[];for(let h=0;h<l.length;h++){const p=l[h];switch(p==null?void 0:p._type){case 5:r.push(br.deserialize(p));break;case 14:case 15:a.push(gr.deserialize(p));break;case 100:case 10:s.push(vr.deserialize(p));break;default:o.push(dr.deserialize(p))}}return{version:1,difficulty:{colorNotes:e,bombNotes:i,obstacles:(c=t._obstacles)==null?void 0:c.map(_r.deserialize),bpmEvents:s,rotationEvents:a,customData:{_bpmChanges:t._BPMChanges,_bookmarks:t._bookmarks,_time:t._time}},lightshow:{basicEvents:o,colorBoostEvents:r}}}},yr={serialize(t){return{_time:t.time,_type:t.color,_lineIndex:t.posX,_lineLayer:t.posY,_cutDirection:t.direction,_customData:W(t.customData)}},deserialize(t={}){return{time:t._time,posX:t._lineIndex,posY:t._lineLayer,color:t._type,direction:t._cutDirection,customData:t._customData}}},Um={serialize(t){return{_colorType:t.color,_headTime:t.time,_headLineIndex:t.posX,_headLineLayer:t.posY,_headCutDirection:t.direction,_headControlPointLengthMultiplier:t.lengthMultiplier,_tailTime:t.tailTime,_tailLineIndex:t.tailPosX,_tailLineLayer:t.tailPosY,_tailCutDirection:t.tailDirection,_tailControlPointLengthMultiplier:t.tailLengthMultiplier,_sliderMidAnchorMode:t.midAnchor,_customData:W(t.customData)}},deserialize(t={}){return{color:t._colorType,time:t._headTime,posX:t._headLineIndex,posY:t._headLineLayer,direction:t._headCutDirection,lengthMultiplier:t._headControlPointLengthMultiplier,tailTime:t._tailTime,tailPosX:t._tailLineIndex,tailPosY:t._tailLineLayer,tailDirection:t._tailCutDirection,tailLengthMultiplier:t._tailControlPointLengthMultiplier,midAnchor:t._sliderMidAnchorMode,customData:t._customData}}},Er={serialize(t){let e=0;return t.height>=0&&t.posY>=0&&(e=Math.floor(t.height*1e3+t.posY+4001)),{_time:t.time,_type:t.posY===2&&t.height===3?1:t.posY===0&&t.height===5?0:e,_lineIndex:t.posX,_duration:t.duration,_width:t.width,_customData:W(t.customData)}},deserialize(t={}){const e=t._type??0,i=e===1?3:e>=1e3&&e<=4e3?lu(e,1e3,4e3,0,15):e>4e3&&e<=4005e3?0:5,n=e===1?2:e>4e3&&e<=4005e3?Math.floor((e-4001)/1e3):0;return{time:t._time,posY:n,posX:t._lineIndex,duration:t._duration,width:t._width,height:i,customData:t._customData}}},Dr={serialize(t){return{_time:t.time,_type:t.type,_value:t.value,_floatValue:t.floatValue,_customData:W(t.customData)}},deserialize(t={}){return{time:t._time,type:t._type,value:t._value,floatValue:t._floatValue,customData:t._customData}}},wr={serialize(t){return{_time:t.time,_lineIndex:t.posX,_lineLayer:t.posY,_offsetDirection:t.direction,_customData:W(t.customData)}},deserialize(t={}){return{time:t._time,posX:t._lineIndex,posY:t._lineLayer,direction:t._offsetDirection,customData:t._customData}}},Sr={serialize(t){return{_keyword:t.keyword,_specialEvents:t.events}},deserialize(t={}){return{keyword:t._keyword,events:t._specialEvents}}},Cr={serialize(t){return{_keywords:t.list.map(Sr.serialize)}},deserialize(t={}){var e;return{list:(e=t._keywords)==null?void 0:e.map(Sr.deserialize)}}},Tr={serialize(t){return{_time:t.time,_type:3,_lineIndex:t.posX,_lineLayer:t.posY,_cutDirection:t.direction,_customData:W(t.customData)}},deserialize(t={}){return{time:t._time,posX:t._lineIndex,posY:t._lineLayer,customData:t._customData}}},Rr={serialize(t){return{_time:t.time,_type:5,_value:t.toggle?1:0,_floatValue:0,_customData:W(t.customData)}},deserialize(t={}){return{time:t._time,toggle:t._value===1,customData:t._customData}}},kr={serialize(t){let e=t.rotation%360;const i=W(t.customData);return e>=-60&&e<=60&&e%15===0&&e/15!==0?e=vu[e]||e+1360:(i._rotation=e,e+=1360),{_time:t.time,_type:t.executionTime===1?15:14,_value:e,_floatValue:0,_customData:i}},deserialize(t={}){var i;const e=t._value??0;return{time:t._time,executionTime:t._type===15?1:0,rotation:typeof((i=t._customData)==null?void 0:i._rotation)=="number"?t._customData._rotation:e>=1e3?(e-1360)%360:gu[e]??0,customData:t._customData}}},Jn={serialize(t){return{_time:t.time,_type:100,_value:0,_floatValue:t.bpm,_customData:W(t.customData)}},deserialize(t={}){return{time:t._time,bpm:t._floatValue??t._value,customData:t._customData}}},Wm={serialize(t){return{_version:"2.6.0",_notes:[...t.difficulty.colorNotes.map(yr.serialize),...t.difficulty.bombNotes.map(Tr.serialize)].sort(nm),_sliders:t.difficulty.arcs.map(Um.serialize),_obstacles:t.difficulty.obstacles.map(Er.serialize),_events:[...t.lightshow.basicEvents.map(Dr.serialize),...t.lightshow.colorBoostEvents.map(Rr.serialize),...t.difficulty.rotationEvents.map(kr.serialize),...t.difficulty.bpmEvents.map(Jn.serialize)].sort(im),_waypoints:t.lightshow.waypoints.map(wr.serialize),_specialEventsKeywordFilters:Cr.serialize(t.lightshow.basicEventTypesWithKeywords),_customData:W(t.difficulty.customData)}},deserialize(t={}){var h,p;const e=[],i=[],n=t._notes||[];for(let d=0;d<n.length;d++){const u=n[d];(u==null?void 0:u._type)===3?i.push(Tr.deserialize(u)):e.push(yr.deserialize(u))}const o=Bu(t._version||"2.0.0","2.5.0"),r=[],a=[],s=[],l=[],c=t._events||[];for(let d=0;d<c.length;d++){const u=c[d];switch(u==null?void 0:u._type){case 5:a.push(Rr.deserialize(u));break;case 14:case 15:s.push(kr.deserialize(u));break;case 100:l.push(Jn.deserialize(u));break;default:{const m=Dr.deserialize(u);o<0?u._type===10?l.push(Jn.deserialize(u)):(m.floatValue=1,r.push(m)):r.push(m)}}}return{version:2,difficulty:{colorNotes:e,bombNotes:i,obstacles:(h=t._obstacles)==null?void 0:h.map(Er.deserialize),bpmEvents:l,rotationEvents:s,customData:t._customData},lightshow:{basicEvents:r,colorBoostEvents:a,waypoints:(p=t._waypoints)==null?void 0:p.map(wr.deserialize),basicEventTypesWithKeywords:Cr.deserialize(t._specialEventsKeywordFilters)}}}},Bn={serialize(t){return{b:t.time,et:t.type,i:t.value,f:t.floatValue,customData:W(t.customData)}},deserialize(t={}){return{time:t.b,type:t.et,value:t.i,floatValue:t.f,customData:t.customData}}},Lr={serialize(t){return{k:t.keyword,e:t.events.map(e=>e)}},deserialize(t={}){var e;return{keyword:t.k,events:(e=t.e)==null?void 0:e.map(i=>i)}}},xn={serialize(t){return{d:t.list.map(Lr.serialize)}},deserialize(t={}){var e;return{list:(e=t.d)==null?void 0:e.map(Lr.deserialize)}}},Br={serialize(t){return{b:t.time,x:t.posX,y:t.posY,customData:W(t.customData)}},deserialize(t={}){return{time:t.b,posX:t.x,posY:t.y,customData:t.customData}}},xr={serialize(t){return{b:t.time,m:t.bpm,customData:W(t.customData)}},deserialize(t={}){return{time:t.b,bpm:t.m,customData:t.customData}}},Or={serialize(t){return{b:t.time,c:t.color,x:t.posX,y:t.posY,d:t.direction,tb:t.tailTime,tx:t.tailPosX,ty:t.tailPosY,sc:t.sliceCount,s:t.squish,customData:W(t.customData)}},deserialize(t={}){return{time:t.b,color:t.c,posX:t.x,posY:t.y,direction:t.d,tailTime:t.tb,tailPosX:t.tx,tailPosY:t.ty,sliceCount:t.sc,squish:t.s,customData:t.customData}}},On={serialize(t){return{b:t.time,o:t.toggle,customData:W(t.customData)}},deserialize(t={}){return{time:t.b,toggle:t.o,customData:t.customData}}},Nr={serialize(t){return{b:t.time,c:t.color,x:t.posX,y:t.posY,d:t.direction,a:t.angleOffset,customData:W(t.customData)}},deserialize(t={}){return{time:t.b,posX:t.x,posY:t.y,color:t.c,direction:t.d,angleOffset:t.a,customData:t.customData}}},oi={serialize(t){return{f:t.type,p:t.p0,t:t.p1,r:t.reverse,c:t.chunks,n:t.random,s:t.seed,l:t.limit,d:t.limitAffectsType,customData:W(t.customData)}},deserialize(t={}){return{type:t.f,p0:t.p,p1:t.t,reverse:t.r,chunks:t.c,random:t.n,seed:t.s,limit:t.l,limitAffectsType:t.d,customData:t.customData}}},Ir={serialize(t){return{b:t.time,c:t.color,f:t.frequency,i:t.previous?ci.EXTEND:t.easing===ji.NONE?ci.INSTANT:ci.INTERPOLATE,s:t.brightness,sb:t.strobeBrightness,sf:t.strobeFade,customData:W(t.customData)}},deserialize(t={}){return{time:t.b,color:t.c,frequency:t.f,previous:t.i===ci.EXTEND?1:0,easing:t.i===ci.INTERPOLATE?ji.LINEAR:ji.NONE,brightness:t.s,strobeBrightness:t.sb,strobeFade:t.sf,customData:t.customData}}},Ar={serialize(t){return{f:oi.serialize(t.filter),w:t.beatDistribution,d:t.beatDistributionType,r:t.brightnessDistribution,t:t.brightnessDistributionType,b:t.affectFirst,i:t.easing,e:t.events.map(Ir.serialize),customData:W(t.customData)}},deserialize(t={}){var e;return{filter:oi.deserialize(t.f),beatDistribution:t.w,beatDistributionType:t.d,brightnessDistribution:t.r,brightnessDistributionType:t.t,affectFirst:t.b,easing:t.i,events:(e=t.e)==null?void 0:e.map(Ir.deserialize),customData:t.customData}}},Nn={serialize(t){return{b:t.time,g:t.id,e:t.boxes.map(Ar.serialize),customData:W(t.customData)}},deserialize(t={}){var e;return{time:t.b,id:t.g,boxes:(e=t.e)==null?void 0:e.map(Ar.deserialize),customData:t.customData}}},Pr={serialize(t){return{b:t.time,e:t.easing,l:t.loop,o:t.direction,p:t.previous,r:t.rotation,customData:W(t.customData)}},deserialize(t={}){return{time:t.b,easing:t.e,loop:t.l,direction:t.o,previous:t.p,rotation:t.r,customData:t.customData}}},$r={serialize(t){return{f:oi.serialize(t.filter),w:t.beatDistribution,d:t.beatDistributionType,s:t.rotationDistribution,t:t.rotationDistributionType,a:t.axis,r:t.flip,b:t.affectFirst,i:t.easing,l:t.events.map(Pr.serialize),customData:W(t.customData)}},deserialize(t={}){var e;return{filter:oi.deserialize(t.f),beatDistribution:t.w,beatDistributionType:t.d,rotationDistribution:t.s,rotationDistributionType:t.t,axis:t.a,flip:t.r,affectFirst:t.b,easing:t.i,events:(e=t.l)==null?void 0:e.map(Pr.deserialize),customData:t.customData}}},In={serialize(t){return{b:t.time,g:t.id,e:t.boxes.map($r.serialize),customData:W(t.customData)}},deserialize(t={}){var e;return{time:t.b,id:t.g,boxes:(e=t.e)==null?void 0:e.map($r.deserialize),customData:t.customData}}},Mr={serialize(t){return{b:t.time,e:t.easing,p:t.previous,t:t.translation,customData:W(t.customData)}},deserialize(t={}){return{time:t.b,easing:t.e,previous:t.p,translation:t.t,customData:t.customData}}},Fr={serialize(t){return{f:oi.serialize(t.filter),w:t.beatDistribution,d:t.beatDistributionType,s:t.gapDistribution,t:t.gapDistributionType,a:t.axis,r:t.flip,b:t.affectFirst,i:t.easing,l:t.events.map(Mr.serialize),customData:W(t.customData)}},deserialize(t={}){var e;return{filter:oi.deserialize(t.f),beatDistribution:t.w,beatDistributionType:t.d,gapDistribution:t.s,gapDistributionType:t.t,axis:t.a,flip:t.r,affectFirst:t.b,easing:t.i,events:(e=t.l)==null?void 0:e.map(Mr.deserialize),customData:t.customData}}},An={serialize(t){return{b:t.time,g:t.id,e:t.boxes.map(Fr.serialize),customData:W(t.customData)}},deserialize(t={}){var e;return{time:t.b,id:t.g,boxes:(e=t.e)==null?void 0:e.map(Fr.deserialize),customData:t.customData}}},jr={serialize(t){return{b:t.time,x:t.posX,y:t.posY,d:t.duration,w:t.width,h:t.height,customData:W(t.customData)}},deserialize(t={}){return{time:t.b,posX:t.x,posY:t.y,duration:t.d,width:t.w,height:t.h,customData:t.customData}}},zr={serialize(t){return{b:t.time,e:t.executionTime,r:t.rotation,customData:W(t.customData)}},deserialize(t={}){return{time:t.b,executionTime:t.e,rotation:t.r,customData:t.customData}}},Vr={serialize(t){return{b:t.time,c:t.color,x:t.posX,y:t.posY,d:t.direction,mu:t.lengthMultiplier,tb:t.tailTime,tx:t.tailPosX,ty:t.tailPosY,tc:t.tailDirection,tmu:t.tailLengthMultiplier,m:t.midAnchor,customData:W(t.customData)}},deserialize(t={}){return{time:t.b,color:t.c,posX:t.x,posY:t.y,direction:t.d,lengthMultiplier:t.mu,tailTime:t.tb,tailPosX:t.tx,tailPosY:t.ty,tailDirection:t.tc,tailLengthMultiplier:t.tmu,midAnchor:t.m,customData:t.customData}}},Gr={serialize(t){return{b:t.time,x:t.posX,y:t.posY,d:t.direction,customData:W(t.customData)}},deserialize(t={}){return{time:t.b,posX:t.x,posY:t.y,direction:t.d,customData:t.customData}}},Hr={serialize(t){return{b:t.time,i:t.easing,p:t.previous,v:t.value,customData:W(t.customData)}},deserialize(t={}){return{time:t.b,easing:t.i,previous:t.p,value:t.v,customData:t.customData}}},Ur={serialize(t){return{data:{f:oi.serialize(t.filter),w:t.beatDistribution,d:t.beatDistributionType,s:t.fxDistribution,t:t.fxDistributionType,b:t.affectFirst,i:t.easing,l:[],customData:W(t.customData)},eventData:t.events.map(Hr.serialize)}},deserialize(t={}){var e,i,n,o,r,a,s,l,c;return{filter:oi.deserialize((e=t.data)==null?void 0:e.f),beatDistribution:(i=t.data)==null?void 0:i.w,beatDistributionType:(n=t.data)==null?void 0:n.d,fxDistribution:(o=t.data)==null?void 0:o.s,fxDistributionType:(r=t.data)==null?void 0:r.t,affectFirst:(a=t.data)==null?void 0:a.b,easing:(s=t.data)==null?void 0:s.i,events:(l=t.eventData)==null?void 0:l.map(Hr.deserialize),customData:(c=t.data)==null?void 0:c.customData}}},Pn={serialize(t){return{object:{t:co.FLOAT,b:t.time,g:t.id,e:[],customData:W(t.customData)},boxData:t.boxes.map(Ur.serialize)}},deserialize(t={}){var i,n,o,r;const e={};return e.time=(i=t.object)==null?void 0:i.b,e.id=(n=t.object)==null?void 0:n.g,e.boxes=(o=t.boxData)==null?void 0:o.map(Ur.deserialize),e.customData=(r=t.object)==null?void 0:r.customData,e}},Ym={serialize(t){const e={version:"3.3.0",bpmEvents:t.difficulty.bpmEvents.map(xr.serialize),rotationEvents:t.difficulty.rotationEvents.map(zr.serialize),colorNotes:t.difficulty.colorNotes.map(Nr.serialize),bombNotes:t.difficulty.bombNotes.map(Br.serialize),obstacles:t.difficulty.obstacles.map(jr.serialize),sliders:t.difficulty.arcs.map(Vr.serialize),burstSliders:t.difficulty.chains.map(Or.serialize),waypoints:t.lightshow.waypoints.map(Gr.serialize),basicBeatmapEvents:t.lightshow.basicEvents.map(Bn.serialize),colorBoostBeatmapEvents:t.lightshow.colorBoostEvents.map(On.serialize),lightColorEventBoxGroups:t.lightshow.lightColorEventBoxGroups.map(Nn.serialize),lightRotationEventBoxGroups:t.lightshow.lightRotationEventBoxGroups.map(In.serialize),lightTranslationEventBoxGroups:t.lightshow.lightTranslationEventBoxGroups.map(An.serialize),vfxEventBoxGroups:[],basicEventTypesWithKeywords:xn.serialize(t.lightshow.basicEventTypesWithKeywords),_fxEventsCollection:{_fl:[],_il:[]},useNormalEventsAsCompatibleEvents:t.lightshow.useNormalEventsAsCompatibleEvents,customData:W(t.difficulty.customData)};for(const i of t.lightshow.fxEventBoxGroups.map(Pn.serialize)){e.vfxEventBoxGroups.push(i.object);for(const n of i.boxData){i.object.e.push(n.data);for(const o of n.eventData)n.data.l.push(e._fxEventsCollection._fl.length),e._fxEventsCollection._fl.push(o)}}return e},deserialize:function(t={}){var n,o,r,a,s,l,c,h,p,d,u,m,b,y,v;const e={version:3,difficulty:{},lightshow:{}};e.difficulty.bpmEvents=(n=t.bpmEvents)==null?void 0:n.map(xr.deserialize),e.difficulty.rotationEvents=(o=t.rotationEvents)==null?void 0:o.map(zr.deserialize),e.difficulty.colorNotes=(r=t.colorNotes)==null?void 0:r.map(Nr.deserialize),e.difficulty.bombNotes=(a=t.bombNotes)==null?void 0:a.map(Br.deserialize),e.difficulty.obstacles=(s=t.obstacles)==null?void 0:s.map(jr.deserialize),e.difficulty.arcs=(l=t.sliders)==null?void 0:l.map(Vr.deserialize),e.difficulty.chains=(c=t.burstSliders)==null?void 0:c.map(Or.deserialize),e.lightshow.waypoints=(h=t.waypoints)==null?void 0:h.map(Gr.deserialize),e.lightshow.basicEvents=(p=t.basicBeatmapEvents)==null?void 0:p.map(Bn.deserialize),e.lightshow.colorBoostEvents=(d=t.colorBoostBeatmapEvents)==null?void 0:d.map(On.deserialize),e.lightshow.lightColorEventBoxGroups=(u=t.lightColorEventBoxGroups)==null?void 0:u.map(Nn.deserialize),e.lightshow.lightRotationEventBoxGroups=(m=t.lightRotationEventBoxGroups)==null?void 0:m.map(In.deserialize),e.lightshow.lightTranslationEventBoxGroups=(b=t.lightTranslationEventBoxGroups)==null?void 0:b.map(An.deserialize);const i=(y=t._fxEventsCollection)==null?void 0:y._fl;return e.lightshow.fxEventBoxGroups=(v=t.vfxEventBoxGroups)==null?void 0:v.map(_=>{var w;return Pn.deserialize({object:_,boxData:(w=_.e)==null?void 0:w.map(C=>{var T;return{data:C,eventData:(T=C.l)==null?void 0:T.map(P=>i[P])}})})}),e.lightshow.basicEventTypesWithKeywords=xn.deserialize(t.basicEventTypesWithKeywords),e.lightshow.useNormalEventsAsCompatibleEvents=t.useNormalEventsAsCompatibleEvents,e.difficulty.customData=t.customData,e}},Wr={serialize(t){return{object:{b:t.time,i:0,r:t.laneRotation,customData:{}},data:{x:t.posX,y:t.posY,customData:W(t.customData)}}},deserialize(t={}){var e,i,n,o,r;return{time:(e=t.object)==null?void 0:e.b,laneRotation:(i=t.object)==null?void 0:i.r,posX:(n=t.data)==null?void 0:n.x,posY:(o=t.data)==null?void 0:o.y,customData:(r=t.data)==null?void 0:r.customData}}},Yr={serialize(t){return{object:{hb:t.time,hr:t.laneRotation,tb:t.tailTime,tr:t.tailLaneRotation,i:0,ci:0,customData:{}},data:{c:t.color,x:t.posX,y:t.posY,d:t.direction,a:0,customData:{}},chainData:{tx:t.tailPosX,ty:t.tailPosY,c:t.sliceCount,s:t.squish,customData:W(t.customData)}}},deserialize(t={}){var e,i,n,o,r,a,s,l,c,h,p,d,u;return{time:(e=t.object)==null?void 0:e.hb,laneRotation:(i=t.object)==null?void 0:i.hr,color:(n=t.data)==null?void 0:n.c,posX:(o=t.data)==null?void 0:o.x,posY:(r=t.data)==null?void 0:r.y,direction:(a=t.data)==null?void 0:a.d,tailTime:(s=t.object)==null?void 0:s.tb,tailLaneRotation:(l=t.object)==null?void 0:l.tr,tailPosX:(c=t.chainData)==null?void 0:c.tx,tailPosY:(h=t.chainData)==null?void 0:h.ty,sliceCount:(p=t.chainData)==null?void 0:p.c,squish:(d=t.chainData)==null?void 0:d.s,customData:(u=t.chainData)==null?void 0:u.customData}}},Xr={serialize(t){return{object:{b:t.time,i:0,r:t.laneRotation,customData:{}},data:{c:t.color,x:t.posX,y:t.posY,d:t.direction,a:t.angleOffset,customData:W(t.customData)}}},deserialize(t={}){var e,i,n,o,r,a,s,l;return{time:(e=t.object)==null?void 0:e.b,laneRotation:(i=t.object)==null?void 0:i.r,posX:(n=t.data)==null?void 0:n.x,posY:(o=t.data)==null?void 0:o.y,color:(r=t.data)==null?void 0:r.c,direction:(a=t.data)==null?void 0:a.d,angleOffset:(s=t.data)==null?void 0:s.a,customData:(l=t.data)==null?void 0:l.customData}}},qr={serialize(t){return{object:{b:t.time,i:0,r:t.laneRotation,customData:{}},data:{x:t.posX,y:t.posY,d:t.duration,w:t.width,h:t.height,customData:W(t.customData)}}},deserialize(t={}){var e,i,n,o,r,a,s,l;return{time:(e=t.object)==null?void 0:e.b,laneRotation:(i=t.object)==null?void 0:i.r,posX:(n=t.data)==null?void 0:n.x,posY:(o=t.data)==null?void 0:o.y,duration:(r=t.data)==null?void 0:r.d,width:(a=t.data)==null?void 0:a.w,height:(s=t.data)==null?void 0:s.h,customData:(l=t.data)==null?void 0:l.customData}}},Kr={serialize(t){return{object:{ai:0,hb:t.time,hi:0,hr:t.laneRotation,tb:t.tailTime,ti:0,tr:t.tailLaneRotation,customData:{}},data:{m:t.lengthMultiplier,tm:t.tailLengthMultiplier,a:t.midAnchor,customData:W(t.customData)},headData:{c:t.color,x:t.posX,y:t.posY,d:t.direction,a:0,customData:{}},tailData:{c:t.color,x:t.tailPosX,y:t.tailPosY,d:t.tailDirection,a:0,customData:{}}}},deserialize(t={}){var e,i,n,o,r,a,s,l,c,h,p,d,u,m,b;return{time:(e=t.object)==null?void 0:e.hb,laneRotation:(i=t.object)==null?void 0:i.hr,tailTime:(n=t.object)==null?void 0:n.tb,tailLaneRotation:(o=t.object)==null?void 0:o.tr,color:(r=t.headData)==null?void 0:r.c,posX:(a=t.headData)==null?void 0:a.x,posY:(s=t.headData)==null?void 0:s.y,direction:(l=t.headData)==null?void 0:l.d,lengthMultiplier:(c=t.data)==null?void 0:c.m,tailPosX:(h=t.tailData)==null?void 0:h.x,tailPosY:(p=t.tailData)==null?void 0:p.y,tailDirection:(d=t.tailData)==null?void 0:d.d,tailLengthMultiplier:(u=t.data)==null?void 0:u.tm,midAnchor:(m=t.data)==null?void 0:m.a,customData:(b=t.data)==null?void 0:b.customData}}},Zr={serialize(t){return{object:{b:t.time},data:{e:t.executionTime,r:t.rotation,customData:W(t.customData)}}},deserialize(t={}){var e,i,n,o;return{time:(e=t.object)==null?void 0:e.b,executionTime:(i=t.data)==null?void 0:i.e,rotation:(n=t.data)==null?void 0:n.r,customData:(o=t.data)==null?void 0:o.customData}}},Xm={serialize(t){const e={version:"4.0.0",colorNotes:[],bombNotes:[],obstacles:[],chains:[],arcs:[],spawnRotations:[],colorNotesData:[],bombNotesData:[],obstaclesData:[],chainsData:[],arcsData:[],spawnRotationsData:[],customData:W(t.difficulty.customData)};for(const i of t.difficulty.colorNotes.map(Xr.serialize))e.colorNotes.push(i.object),i.object.i=e.colorNotesData.length,e.colorNotesData.push(i.data);for(const i of t.difficulty.bombNotes.map(Wr.serialize))e.bombNotes.push(i.object),i.object.i=e.bombNotesData.length,e.bombNotesData.push(i.data);for(const i of t.difficulty.obstacles.map(qr.serialize))e.obstacles.push(i.object),i.object.i=e.obstaclesData.length,e.obstaclesData.push(i.data);for(const i of t.difficulty.arcs.map(Kr.serialize))e.arcs.push(i.object),i.object.ai=e.arcsData.length,e.arcsData.push(i.data),i.object.hi=e.colorNotesData.length,e.colorNotesData.push(i.headData),i.object.ti=e.colorNotesData.length,e.colorNotesData.push(i.tailData);for(const i of t.difficulty.chains.map(Yr.serialize))e.chains.push(i.object),i.object.i=e.colorNotesData.length,e.colorNotesData.push(i.data),i.object.ci=e.chainsData.length,e.chainsData.push(i.chainData);for(const i of t.difficulty.rotationEvents.map(Zr.serialize))e.spawnRotations.push(i.object),i.object.i=e.spawnRotationsData.length,e.spawnRotationsData.push(i.data);return e},deserialize(t={}){var e,i,n,o,r,a;return{version:4,difficulty:{colorNotes:(e=t.colorNotes)==null?void 0:e.map(s=>{var l;return Xr.deserialize({object:s,data:(l=t.colorNotesData)==null?void 0:l[(s==null?void 0:s.i)||0]})}),bombNotes:(i=t.bombNotes)==null?void 0:i.map(s=>{var l;return Wr.deserialize({object:s,data:(l=t.bombNotesData)==null?void 0:l[(s==null?void 0:s.i)||0]})}),obstacles:(n=t.obstacles)==null?void 0:n.map(s=>{var l;return qr.deserialize({object:s,data:(l=t.obstaclesData)==null?void 0:l[(s==null?void 0:s.i)||0]})}),arcs:(o=t.arcs)==null?void 0:o.map(s=>{var l,c,h;return Kr.deserialize({object:s,data:(l=t.arcsData)==null?void 0:l[(s==null?void 0:s.ai)||0],headData:(c=t.colorNotesData)==null?void 0:c[(s==null?void 0:s.hi)||0],tailData:(h=t.colorNotesData)==null?void 0:h[(s==null?void 0:s.ti)||0]})}),chains:(r=t.chains)==null?void 0:r.map(s=>{var l,c;return Yr.deserialize({object:s,data:(l=t.colorNotesData)==null?void 0:l[(s==null?void 0:s.i)||0],chainData:(c=t.chainsData)==null?void 0:c[(s==null?void 0:s.ci)||0]})}),rotationEvents:(a=t.spawnRotations)==null?void 0:a.map(s=>{var l;return Zr.deserialize({object:s,data:(l=t.spawnRotationsData)==null?void 0:l[(s==null?void 0:s.i)||0]})}),customData:t.customData}}}},qm={serialize(t){const e={basicBeatmapEvents:t.lightshow.basicEvents.map(Bn.serialize),colorBoostBeatmapEvents:t.lightshow.colorBoostEvents.map(On.serialize),lightColorEventBoxGroups:t.lightshow.lightColorEventBoxGroups.map(Nn.serialize),lightRotationEventBoxGroups:t.lightshow.lightRotationEventBoxGroups.map(In.serialize),lightTranslationEventBoxGroups:t.lightshow.lightTranslationEventBoxGroups.map(An.serialize),vfxEventBoxGroups:[],_fxEventsCollection:{_fl:[],_il:[]},customData:W(t.lightshow.customData)};for(const i of t.lightshow.fxEventBoxGroups.map(Pn.serialize)){e.vfxEventBoxGroups.push(i.object);for(const n of i.boxData){i.object.e.push(n.data);for(const o of n.eventData)n.data.l.push(e._fxEventsCollection._fl.length),e._fxEventsCollection._fl.push(o)}}return e},deserialize(t={}){var n,o,r,a,s,l,c;const e={version:3,lightshow:{}};e.lightshow.basicEvents=(n=t.basicBeatmapEvents)==null?void 0:n.map(Bn.deserialize),e.lightshow.colorBoostEvents=(o=t.colorBoostBeatmapEvents)==null?void 0:o.map(On.deserialize),e.lightshow.lightColorEventBoxGroups=(r=t.lightColorEventBoxGroups)==null?void 0:r.map(Nn.deserialize),e.lightshow.lightRotationEventBoxGroups=(a=t.lightRotationEventBoxGroups)==null?void 0:a.map(In.deserialize),e.lightshow.lightTranslationEventBoxGroups=(s=t.lightTranslationEventBoxGroups)==null?void 0:s.map(An.deserialize);const i=((l=t._fxEventsCollection)==null?void 0:l._fl)??[];return e.lightshow.fxEventBoxGroups=(c=t.vfxEventBoxGroups)==null?void 0:c.map(h=>{var p;return Pn.deserialize({object:h,boxData:(p=h.e)==null?void 0:p.map(d=>{var u;return{data:d,eventData:(u=d.l)==null?void 0:u.map(m=>i[m])}})})}),e.lightshow.customData=t.customData,e}},Jr={serialize(t){return{object:{b:t.time,i:0,r:t.laneRotation,customData:{}},data:{x:t.posX,y:t.posY,d:t.direction,customData:W(t.customData)}}},deserialize(t={}){var e,i,n,o,r,a;return{time:(e=t.object)==null?void 0:e.b,laneRotation:(i=t.object)==null?void 0:i.r,posX:(n=t.data)==null?void 0:n.x,posY:(o=t.data)==null?void 0:o.y,direction:(r=t.data)==null?void 0:r.d,customData:(a=t.data)==null?void 0:a.customData}}},Qr={serialize(t){return{object:{b:t.time,i:0,customData:{}},data:{t:t.type,i:t.value,f:t.floatValue,customData:W(t.customData)}}},deserialize(t={}){var e,i,n,o,r;return{time:(e=t.object)==null?void 0:e.b,type:(i=t.data)==null?void 0:i.t,value:(n=t.data)==null?void 0:n.i,floatValue:(o=t.data)==null?void 0:o.f,customData:(r=t.data)==null?void 0:r.customData}}},ts={serialize(t){return{object:{b:t.time,i:0,customData:{}},data:{b:t.toggle?1:0,customData:W(t.customData)}}},deserialize(t={}){var e,i,n;return{time:(e=t.object)==null?void 0:e.b,toggle:!!((i=t.data)!=null&&i.b),customData:(n=t.data)==null?void 0:n.customData}}},ri={serialize(t){return{f:t.type,p:t.p0,t:t.p1,r:t.reverse,c:t.chunks,n:t.random,s:t.seed,l:t.limit,d:t.limitAffectsType,customData:W(t.customData)}},deserialize(t={}){return{type:t.f,p0:t.p,p1:t.t,reverse:t.r,chunks:t.c,random:t.n,seed:t.s,limit:t.l,limitAffectsType:t.d,customData:t.customData}}},es={serialize(t){return{data:{p:t.previous,c:t.color,e:t.easing,b:t.brightness,f:t.frequency,sb:t.strobeBrightness,sf:t.strobeFade,customData:W(t.customData)},time:t.time}},deserialize(t={}){var e,i,n,o,r,a,s,l;return{time:t.time,previous:(e=t.data)==null?void 0:e.p,color:(i=t.data)==null?void 0:i.c,frequency:(n=t.data)==null?void 0:n.f,easing:(o=t.data)==null?void 0:o.e,brightness:(r=t.data)==null?void 0:r.b,strobeBrightness:(a=t.data)==null?void 0:a.sb,strobeFade:(s=t.data)==null?void 0:s.sf,customData:(l=t.data)==null?void 0:l.customData}}},is={serialize(t){return{data:{w:t.beatDistribution,d:t.beatDistributionType,s:t.brightnessDistribution,t:t.brightnessDistributionType,b:t.affectFirst,e:t.easing,customData:W(t.customData)},eventData:t.events.map(es.serialize),filterData:ri.serialize(t.filter)}},deserialize(t={}){var e,i,n,o,r,a,s,l;return{filter:ri.deserialize(t.filterData),beatDistribution:(e=t.data)==null?void 0:e.w,beatDistributionType:(i=t.data)==null?void 0:i.d,brightnessDistribution:(n=t.data)==null?void 0:n.s,brightnessDistributionType:(o=t.data)==null?void 0:o.t,affectFirst:(r=t.data)==null?void 0:r.b,easing:(a=t.data)==null?void 0:a.e,events:(s=t.eventData)==null?void 0:s.map(es.deserialize),customData:(l=t.data)==null?void 0:l.customData}}},ns={serialize(t){return{object:{t:ke.COLOR,b:t.time,g:t.id,e:[],customData:W(t.customData)},boxData:t.boxes.map(is.serialize)}},deserialize(t={}){var e,i,n,o;return{time:(e=t.object)==null?void 0:e.b,id:(i=t.object)==null?void 0:i.g,boxes:(n=t.boxData)==null?void 0:n.map(is.deserialize),customData:(o=t.object)==null?void 0:o.customData}}},os={serialize(t){return{data:{p:t.previous,l:t.loop,e:t.easing,r:t.rotation,d:t.direction,customData:W(t.customData)},time:t.time}},deserialize(t={}){var e,i,n,o,r,a;return{time:t.time,previous:(e=t.data)==null?void 0:e.p,easing:(i=t.data)==null?void 0:i.e,loop:(n=t.data)==null?void 0:n.l,rotation:(o=t.data)==null?void 0:o.r,direction:(r=t.data)==null?void 0:r.d,customData:(a=t.data)==null?void 0:a.customData}}},rs={serialize(t){return{data:{w:t.beatDistribution,d:t.beatDistributionType,s:t.rotationDistribution,t:t.rotationDistributionType,b:t.affectFirst,e:t.easing,a:t.axis,f:t.flip,customData:W(t.customData)},eventData:t.events.map(os.serialize),filterData:ri.serialize(t.filter)}},deserialize(t={}){var e,i,n,o,r,a,s,l,c,h;return{filter:ri.deserialize(t.filterData),beatDistribution:(e=t.data)==null?void 0:e.w,beatDistributionType:(i=t.data)==null?void 0:i.d,rotationDistribution:(n=t.data)==null?void 0:n.s,rotationDistributionType:(o=t.data)==null?void 0:o.t,affectFirst:(r=t.data)==null?void 0:r.b,easing:(a=t.data)==null?void 0:a.e,axis:(s=t.data)==null?void 0:s.a,flip:(l=t.data)==null?void 0:l.f,events:(c=t.eventData)==null?void 0:c.map(os.deserialize),customData:(h=t.data)==null?void 0:h.customData}}},ss={serialize(t){return{object:{t:ke.ROTATION,b:t.time,g:t.id,e:[],customData:W(t.customData)},boxData:t.boxes.map(rs.serialize)}},deserialize(t={}){var e,i,n,o;return{time:(e=t.object)==null?void 0:e.b,id:(i=t.object)==null?void 0:i.g,boxes:(n=t.boxData)==null?void 0:n.map(rs.deserialize),customData:(o=t.object)==null?void 0:o.customData}}},as={serialize(t){return{data:{p:t.previous,e:t.easing,t:t.translation,customData:W(t.customData)},time:t.time}},deserialize(t={}){var e,i,n,o;return{time:t.time,previous:(e=t.data)==null?void 0:e.p,easing:(i=t.data)==null?void 0:i.e,translation:(n=t.data)==null?void 0:n.t,customData:(o=t.data)==null?void 0:o.customData}}},ls={serialize(t){return{data:{w:t.beatDistribution,d:t.beatDistributionType,s:t.gapDistribution,t:t.gapDistributionType,b:t.affectFirst,e:t.easing,a:t.axis,f:t.flip,customData:W(t.customData)},eventData:t.events.map(as.serialize),filterData:ri.serialize(t.filter)}},deserialize(t={}){var e,i,n,o,r,a,s,l,c,h;return{filter:ri.deserialize(t.filterData),beatDistribution:(e=t.data)==null?void 0:e.w,beatDistributionType:(i=t.data)==null?void 0:i.d,gapDistribution:(n=t.data)==null?void 0:n.s,gapDistributionType:(o=t.data)==null?void 0:o.t,affectFirst:(r=t.data)==null?void 0:r.b,easing:(a=t.data)==null?void 0:a.e,axis:(s=t.data)==null?void 0:s.a,flip:(l=t.data)==null?void 0:l.f,events:(c=t.eventData)==null?void 0:c.map(as.deserialize),customData:(h=t.data)==null?void 0:h.customData}}},us={serialize(t){return{object:{t:ke.TRANSLATION,b:t.time,g:t.id,e:[],customData:W(t.customData)},boxData:t.boxes.map(ls.serialize)}},deserialize(t={}){var e,i,n,o;return{time:(e=t.object)==null?void 0:e.b,id:(i=t.object)==null?void 0:i.g,boxes:(n=t.boxData)==null?void 0:n.map(ls.deserialize),customData:(o=t.object)==null?void 0:o.customData}}},cs={serialize(t){return{data:{p:t.previous,e:t.easing,v:t.value,customData:W(t.customData)},time:t.time}},deserialize(t={}){var e,i,n,o;return{time:t.time,previous:(e=t.data)==null?void 0:e.p,easing:(i=t.data)==null?void 0:i.e,value:(n=t.data)==null?void 0:n.v,customData:(o=t.data)==null?void 0:o.customData}}},hs={serialize(t){return{data:{w:t.beatDistribution,d:t.beatDistributionType,s:t.fxDistribution,t:t.fxDistributionType,b:t.affectFirst,e:t.easing,customData:W(t.customData)},eventData:t.events.map(cs.serialize),filterData:ri.serialize(t.filter)}},deserialize(t={}){var e,i,n,o,r,a,s,l;return{filter:ri.deserialize(t.filterData),beatDistribution:(e=t.data)==null?void 0:e.w,beatDistributionType:(i=t.data)==null?void 0:i.d,fxDistribution:(n=t.data)==null?void 0:n.s,fxDistributionType:(o=t.data)==null?void 0:o.t,affectFirst:(r=t.data)==null?void 0:r.b,easing:(a=t.data)==null?void 0:a.e,events:(s=t.eventData)==null?void 0:s.map(cs.deserialize),customData:(l=t.data)==null?void 0:l.customData}}},ms={serialize(t){return{object:{t:ke.FX_FLOAT,b:t.time,g:t.id,e:[],customData:W(t.customData)},boxData:t.boxes.map(hs.serialize)}},deserialize(t={}){var e,i,n,o;return{time:(e=t.object)==null?void 0:e.b,id:(i=t.object)==null?void 0:i.g,boxes:(n=t.boxData)==null?void 0:n.map(hs.deserialize),customData:(o=t.object)==null?void 0:o.customData}}},Km={serialize(t){const e={version:"4.0.0",waypoints:[],waypointsData:[],basicEvents:[],basicEventsData:[],colorBoostEvents:[],colorBoostEventsData:[],eventBoxGroups:[],indexFilters:[],lightColorEventBoxes:[],lightColorEvents:[],lightRotationEventBoxes:[],lightRotationEvents:[],lightTranslationEventBoxes:[],lightTranslationEvents:[],fxEventBoxes:[],floatFxEvents:[],basicEventTypesWithKeywords:xn.serialize(t.lightshow.basicEventTypesWithKeywords),useNormalEventsAsCompatibleEvents:t.lightshow.useNormalEventsAsCompatibleEvents,customData:W(t.difficulty.customData)};for(const i of t.lightshow.waypoints.map(Jr.serialize))e.waypoints.push(i.object),i.object.i=e.waypointsData.length,e.waypointsData.push(i.data);for(const i of t.lightshow.basicEvents.map(Qr.serialize))e.basicEvents.push(i.object),i.object.i=e.basicEventsData.length,e.basicEventsData.push(i.data);for(const i of t.lightshow.colorBoostEvents.map(ts.serialize))e.colorBoostEvents.push(i.object),i.object.i=e.colorBoostEventsData.length,e.colorBoostEventsData.push(i.data);for(const i of t.lightshow.lightColorEventBoxGroups.map(ns.serialize)){e.eventBoxGroups.push(i.object);for(const n of i.boxData){const o=[];for(const r of n.eventData)o.push({b:r.time,i:e.lightColorEvents.length}),e.lightColorEvents.push(r.data);i.object.e.push({e:e.lightColorEventBoxes.length,f:e.indexFilters.length,l:o,customData:{}}),e.lightColorEventBoxes.push(n.data),e.indexFilters.push(n.filterData)}}for(const i of t.lightshow.lightRotationEventBoxGroups.map(ss.serialize)){e.eventBoxGroups.push(i.object);for(const n of i.boxData){const o=[];for(const r of n.eventData)o.push({b:r.time,i:e.lightRotationEvents.length}),e.lightRotationEvents.push(r.data);i.object.e.push({e:e.lightRotationEventBoxes.length,f:e.indexFilters.length,l:o,customData:{}}),e.lightRotationEventBoxes.push(n.data),e.indexFilters.push(n.filterData)}}for(const i of t.lightshow.lightTranslationEventBoxGroups.map(us.serialize)){e.eventBoxGroups.push(i.object);for(const n of i.boxData){const o=[];for(const r of n.eventData)o.push({b:r.time,i:e.lightTranslationEvents.length}),e.lightTranslationEvents.push(r.data);i.object.e.push({e:e.lightTranslationEventBoxes.length,f:e.indexFilters.length,l:o,customData:{}}),e.lightTranslationEventBoxes.push(n.data),e.indexFilters.push(n.filterData)}}for(const i of t.lightshow.fxEventBoxGroups.map(ms.serialize)){e.eventBoxGroups.push(i.object);for(const n of i.boxData){const o=[];for(const r of n.eventData)o.push({b:r.time,i:e.floatFxEvents.length}),e.floatFxEvents.push(r.data);i.object.e.push({e:e.fxEventBoxes.length,f:e.indexFilters.length,l:o,customData:{}}),e.fxEventBoxes.push(n.data),e.indexFilters.push(n.filterData)}}return e},deserialize(t={}){var p,d,u,m,b,y,v;const e={version:4,lightshow:{lightColorEventBoxGroups:[],lightRotationEventBoxGroups:[],lightTranslationEventBoxGroups:[],fxEventBoxGroups:[]}};e.lightshow.waypoints=(p=t.waypoints)==null?void 0:p.map(_=>{var w;return Jr.deserialize({object:_,data:(w=t.waypointsData)==null?void 0:w[(_==null?void 0:_.i)||0]})}),e.lightshow.basicEvents=(d=t.basicEvents)==null?void 0:d.map(_=>{var w;return Qr.deserialize({object:_,data:(w=t.basicEventsData)==null?void 0:w[(_==null?void 0:_.i)||0]})}),e.lightshow.colorBoostEvents=(u=t.colorBoostEvents)==null?void 0:u.map(_=>{var w;return ts.deserialize({object:_,data:(w=t.colorBoostEventsData)==null?void 0:w[(_==null?void 0:_.i)||0]})});const i=t.indexFilters??[],n=t.lightColorEventBoxes??[],o=t.lightColorEvents??[],r=t.lightRotationEventBoxes??[],a=t.lightRotationEvents??[],s=t.lightTranslationEventBoxes??[],l=t.lightTranslationEvents??[],c=t.fxEventBoxes??[],h=t.floatFxEvents??[];for(const _ of t.eventBoxGroups||[])switch((_==null?void 0:_.t)||0){case ke.COLOR:e.lightshow.lightColorEventBoxGroups.push(ns.deserialize({object:_,boxData:(m=_==null?void 0:_.e)==null?void 0:m.map(C=>{var T;return{data:n[C.e||0],filterData:i[C.f||0],eventData:(T=C.l)==null?void 0:T.map(P=>({time:P.b,data:o[P.i||0]}))}})}));break;case ke.ROTATION:e.lightshow.lightRotationEventBoxGroups.push(ss.deserialize({object:_,boxData:(b=_==null?void 0:_.e)==null?void 0:b.map(C=>{var T;return{data:r[C.e||0],filterData:i[C.f||0],eventData:(T=C.l)==null?void 0:T.map(P=>({time:P.b,data:a[P.i||0]}))}})}));break;case ke.TRANSLATION:e.lightshow.lightTranslationEventBoxGroups.push(us.deserialize({object:_,boxData:(y=_==null?void 0:_.e)==null?void 0:y.map(C=>{var T;return{data:s[C.e||0],filterData:i[C.f||0],eventData:(T=C.l)==null?void 0:T.map(P=>({time:P.b,data:l[P.i||0]}))}})}));break;case ke.FX_FLOAT:e.lightshow.fxEventBoxGroups.push(ms.deserialize({object:_,boxData:(v=_==null?void 0:_.e)==null?void 0:v.map(C=>{var T;return{data:c[C.e||0],filterData:i[C.f||0],eventData:(T=C.l)==null?void 0:T.map(P=>({time:P.b,data:h[P.i||0]}))}})}));break}return e.lightshow.basicEventTypesWithKeywords=xn.deserialize(t.basicEventTypesWithKeywords),e.lightshow.useNormalEventsAsCompatibleEvents=!!t.useNormalEventsAsCompatibleEvents,e.lightshow.customData=t.customData,e}},Zm={1:Fm,2:jm,4:zm},Jm={2:Vm,4:Gm},Qm={1:Hm,2:Wm,3:Ym,4:Xm},tf={3:qm,4:Km};function xu(){return["helpers","schemaCheck"]}function he(t,e,i){if(e)throw new Error(t);J.tWarn(xu(),t),i.push(t)}function yn(t,e,i,n,o,r=[]){if(J.tDebug(xu(),`Looking up ${i}`),Array.isArray(t)){for(let s=0;s<t.length;s++)yn(t[s],e,`${i}[${s}]`,n,o,r);return r}const a=Object.keys(e);if(!a.length)return r;for(const s in t)s in e||he(`Unused key ${s} found in ${i}`,o.unused,r);for(let s=0;s<a.length;s++){const l=a[s],c=e[l],h=t[l];if(h===void 0){if(!o.ignoreOptional&&e[l].optional||Bu(n,c.version)===-1)continue;he(`Missing ${l} in object ${i}!`,o.missing,r);continue}if(h===null){he(`${l} contain null value in object ${i}!`,o.nullish,r);continue}if(c.type==="array"){Array.isArray(h)||he(`${l} is not an array in object ${i}!`,o.wrongType,r),yn(h,c.check,`${i}.${l}`,n,o,r);continue}if(c.type==="object"){!Array.isArray(h)&&typeof h!="object"?he(`${l} is not an object in object ${i}!`,o.wrongType,r):yn(h,c.check,`${i}.${l}`,n,o,r);continue}if(c.array){if(!Array.isArray(h)){he(`${l} is not ${c.type} in object ${i}!`,o.wrongType,r);continue}h.every(p=>typeof p===c.type||c.type==="number"&&typeof p=="number"&&(isNaN(p)||(c.int?p%1!==0:!0)&&(c.unsigned?p<0:!0)))||he(`${l} is not ${c.type} in object ${i}!`,o.wrongType,r);continue}if(!c.array&&typeof h!==c.type){he(`${l} is not ${c.type} in object ${i}!`,o.wrongType,r);continue}if(c.type==="number"){if(isNaN(h)){he(`${i}.${l} is NaN!`,o.nullish,r);continue}if(c.int&&h%1!==0){he(`${i}.${l} cannot be float!`,o.notInt,r);continue}if(c.unsigned&&h<0){he(`${i}.${l} cannot be negative!`,o.notUnsigned,r);continue}}}return r}const ef={_time:{type:"number",version:"1.5.0"},_type:{type:"number",int:!0,unsigned:!0,version:"1.5.0"},_lineIndex:{type:"number",int:!0,version:"1.5.0"},_lineLayer:{type:"number",int:!0,version:"1.5.0"},_cutDirection:{type:"number",int:!0,unsigned:!0,version:"1.5.0"}},nf={_time:{type:"number",version:"1.5.0"},_lineIndex:{type:"number",int:!0,version:"1.5.0"},_type:{type:"number",int:!0,unsigned:!0,version:"1.5.0"},_duration:{type:"number",version:"1.5.0"},_width:{type:"number",int:!0,version:"1.5.0"}},of={_time:{type:"number",version:"1.5.0"},_type:{type:"number",int:!0,version:"1.5.0"},_value:{type:"number",int:!0,version:"1.5.0"}},rf={_version:{type:"string",version:"1.5.0"},_beatsPerMinute:{type:"number",version:"1.5.0"},_beatsPerBar:{type:"number",version:"1.5.0"},_shuffle:{type:"number",version:"1.5.0"},_shufflePeriod:{type:"number",version:"1.5.0"},_noteJumpSpeed:{type:"number",version:"1.5.0",optional:!0},_noteJumpStartBeatOffset:{type:"number",version:"1.5.0",optional:!0},_notes:{type:"array",version:"1.5.0",check:ef},_obstacles:{type:"array",version:"1.5.0",check:nf},_events:{type:"array",version:"1.5.0",check:of},_time:{type:"number",version:"1.5.0",optional:!0},_BPMChanges:{type:"array",version:"1.5.0",optional:!0,check:{}},_bookmarks:{type:"array",version:"1.5.0",optional:!0,check:{}}},sf={difficulty:{type:"string",version:"1.0.0"},difficultyRank:{type:"number",version:"1.0.0"},audioPath:{type:"string",version:"1.0.0"},jsonPath:{type:"string",version:"1.0.0"},characteristic:{type:"string",version:"1.0.0"},offset:{type:"number",version:"1.0.0",optional:!0},oldOffset:{type:"number",version:"1.0.0",optional:!0},chromaToggle:{type:"string",version:"1.0.0",optional:!0},customColors:{type:"boolean",version:"1.0.0",optional:!0},difficultyLabel:{type:"string",version:"1.0.0",optional:!0},colorLeft:{type:"object",version:"1.0.0",check:{},optional:!0},colorRight:{type:"object",version:"1.0.0",check:{},optional:!0},envColorLeft:{type:"object",version:"1.0.0",check:{},optional:!0},envColorRight:{type:"object",version:"1.0.0",check:{},optional:!0},obstacleColor:{type:"object",version:"1.0.0",check:{},optional:!0}},af={songName:{type:"string",version:"1.0.0"},songSubName:{type:"string",version:"1.0.0"},authorName:{type:"string",version:"1.0.0"},beatsPerMinute:{type:"number",version:"1.0.0"},previewStartTime:{type:"number",version:"1.0.0"},previewDuration:{type:"number",version:"1.0.0"},coverImagePath:{type:"string",version:"1.0.0"},environmentName:{type:"string",version:"1.0.0"},difficultyLevels:{type:"array",version:"1.0.0",check:sf},oneSaber:{type:"boolean",version:"1.0.0",optional:!0},contributors:{type:"array",version:"1.0.0",optional:!0,check:{}},customEnvironment:{type:"string",version:"1.0.0",optional:!0},customEnvironmentHash:{type:"string",version:"1.0.0",optional:!0}},lf={_time:{type:"number",version:"2.0.0",optional:!0},_type:{type:"number",int:!0,unsigned:!0,version:"2.0.0",optional:!0},_lineIndex:{type:"number",int:!0,version:"2.0.0",optional:!0},_lineLayer:{type:"number",int:!0,version:"2.0.0",optional:!0},_cutDirection:{type:"number",int:!0,unsigned:!0,version:"2.0.0",optional:!0},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},uf={_colorType:{type:"number",version:"2.0.0",optional:!0},_headTime:{type:"number",version:"2.0.0",optional:!0},_headLineIndex:{type:"number",int:!0,version:"2.0.0",optional:!0},_headLineLayer:{type:"number",int:!0,version:"2.0.0",optional:!0},_headCutDirection:{type:"number",int:!0,unsigned:!0,version:"2.0.0",optional:!0},_headControlPointLengthMultiplier:{type:"number",version:"2.0.0",optional:!0},_tailTime:{type:"number",version:"2.0.0",optional:!0},_tailLineIndex:{type:"number",int:!0,version:"2.0.0",optional:!0},_tailLineLayer:{type:"number",int:!0,version:"2.0.0",optional:!0},_tailCutDirection:{type:"number",int:!0,unsigned:!0,version:"2.0.0",optional:!0},_tailControlPointLengthMultiplier:{type:"number",version:"2.0.0",optional:!0},_sliderMidAnchorMode:{type:"number",version:"2.0.0",optional:!0},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},cf={_time:{type:"number",version:"2.0.0",optional:!0},_lineIndex:{type:"number",int:!0,version:"2.0.0",optional:!0},_type:{type:"number",int:!0,unsigned:!0,version:"2.0.0",optional:!0},_duration:{type:"number",version:"2.0.0",optional:!0},_width:{type:"number",int:!0,version:"2.0.0",optional:!0},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},hf={_time:{type:"number",version:"2.0.0",optional:!0},_type:{type:"number",int:!0,version:"2.0.0",optional:!0},_value:{type:"number",int:!0,version:"2.0.0",optional:!0},_floatValue:{type:"number",version:"2.5.0",optional:!0},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},mf={_time:{type:"number",version:"2.2.0",optional:!0},_lineIndex:{type:"number",int:!0,version:"2.2.0",optional:!0},_lineLayer:{type:"number",int:!0,version:"2.2.0",optional:!0},_offsetDirection:{type:"number",int:!0,version:"2.2.0",optional:!0},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},ff={_keyword:{type:"string",version:"2.4.0",optional:!0},_specialEvents:{type:"number",int:!0,array:!0,version:"2.4.0",optional:!0}},pf={_keywords:{type:"array",version:"2.4.0",check:ff,optional:!0}},df={_version:{type:"string",version:"2.0.0",optional:!0},_notes:{type:"array",version:"2.0.0",check:lf,optional:!0},_sliders:{type:"array",version:"2.6.0",check:uf,optional:!0},_obstacles:{type:"array",version:"2.0.0",check:cf,optional:!0},_events:{type:"array",version:"2.0.0",check:hf,optional:!0},_waypoints:{type:"array",version:"2.2.0",check:mf,optional:!0},_specialEventsKeywordFilters:{type:"object",version:"2.4.0",check:pf,optional:!0},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},bf={_difficulty:{type:"string",version:"2.0.0"},_difficultyRank:{type:"number",version:"2.0.0"},_beatmapFilename:{type:"string",version:"2.0.0"},_noteJumpMovementSpeed:{type:"number",version:"2.0.0"},_noteJumpStartBeatOffset:{type:"number",version:"2.0.0"},_beatmapColorSchemeIdx:{type:"number",version:"2.1.0"},_environmentNameIdx:{type:"number",version:"2.1.0"},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},gf={_beatmapCharacteristicName:{type:"string",version:"2.0.0"},_difficultyBeatmaps:{type:"array",version:"2.0.0",check:bf}},li={r:{type:"number",version:"2.1.0"},g:{type:"number",version:"2.1.0"},b:{type:"number",version:"2.1.0"},a:{type:"number",version:"2.1.0"}},vf={colorSchemeId:{type:"string",version:"2.1.0"},saberAColor:{type:"object",version:"2.1.0",check:li},saberBColor:{type:"object",version:"2.1.0",check:li},environmentColor0:{type:"object",version:"2.1.0",check:li},environmentColor1:{type:"object",version:"2.1.0",check:li},obstaclesColor:{type:"object",version:"2.1.0",check:li},environmentColor0Boost:{type:"object",version:"2.1.0",check:li},environmentColor1Boost:{type:"object",version:"2.1.0",check:li}},_f={useOverride:{type:"boolean",version:"2.1.0"},colorScheme:{type:"object",version:"2.1.0",check:vf}},yf={_version:{type:"string",version:"2.0.0",optional:!0},_songName:{type:"string",version:"2.0.0"},_songSubName:{type:"string",version:"2.0.0"},_songAuthorName:{type:"string",version:"2.0.0"},_levelAuthorName:{type:"string",version:"2.0.0"},_beatsPerMinute:{type:"number",version:"2.0.0"},_songTimeOffset:{type:"number",version:"2.0.0"},_shuffle:{type:"number",version:"2.0.0"},_shufflePeriod:{type:"number",version:"2.0.0"},_previewStartTime:{type:"number",version:"2.0.0"},_previewDuration:{type:"number",version:"2.0.0"},_songFilename:{type:"string",version:"2.0.0"},_coverImageFilename:{type:"string",version:"2.0.0"},_environmentName:{type:"string",version:"2.0.0"},_allDirectionsEnvironmentName:{type:"string",version:"2.0.0",optional:!0},_environmentNames:{type:"string",version:"2.1.0",array:!0},_colorSchemes:{type:"array",version:"2.1.0",check:_f},_customData:{type:"object",version:"2.0.0",check:{},optional:!0},_difficultyBeatmapSets:{type:"array",version:"2.0.0",check:gf}},Ef={_startSampleIndex:{type:"number",version:"2.0.0",int:!0,unsigned:!0},_endSampleIndex:{type:"number",version:"2.0.0",int:!0,unsigned:!0},_startBeat:{type:"number",version:"2.0.0"},_endBeat:{type:"number",version:"2.0.0"}},Df={_version:{type:"string",version:"2.0.0"},_songSampleCount:{type:"number",version:"2.0.0",int:!0,unsigned:!0},_songFrequency:{type:"number",version:"2.0.0",int:!0,unsigned:!0},_regions:{type:"object",version:"2.0.0",check:Ef,array:!0}},wf={b:{type:"number",version:"3.0.0",optional:!0},c:{type:"number",int:!0,version:"3.0.0",optional:!0},x:{type:"number",int:!0,version:"3.0.0",optional:!0},y:{type:"number",int:!0,version:"3.0.0",optional:!0},d:{type:"number",int:!0,version:"3.0.0",optional:!0},a:{type:"number",int:!0,version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Sf={b:{type:"number",version:"3.0.0",optional:!0},x:{type:"number",int:!0,version:"3.0.0",optional:!0},y:{type:"number",int:!0,version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Cf={b:{type:"number",version:"3.0.0",optional:!0},c:{type:"number",int:!0,version:"3.0.0",optional:!0},x:{type:"number",int:!0,version:"3.0.0",optional:!0},y:{type:"number",int:!0,version:"3.0.0",optional:!0},d:{type:"number",int:!0,version:"3.0.0",optional:!0},mu:{type:"number",version:"3.0.0",optional:!0},tb:{type:"number",version:"3.0.0",optional:!0},tx:{type:"number",int:!0,version:"3.0.0",optional:!0},ty:{type:"number",int:!0,version:"3.0.0",optional:!0},tc:{type:"number",int:!0,version:"3.0.0",optional:!0},tmu:{type:"number",version:"3.0.0",optional:!0},m:{type:"number",int:!0,version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Tf={b:{type:"number",version:"3.0.0",optional:!0},c:{type:"number",int:!0,version:"3.0.0",optional:!0},x:{type:"number",int:!0,version:"3.0.0",optional:!0},y:{type:"number",int:!0,version:"3.0.0",optional:!0},d:{type:"number",int:!0,version:"3.0.0",optional:!0},tb:{type:"number",version:"3.0.0",optional:!0},tx:{type:"number",int:!0,version:"3.0.0",optional:!0},ty:{type:"number",int:!0,version:"3.0.0",optional:!0},sc:{type:"number",int:!0,version:"3.0.0",optional:!0},s:{type:"number",version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Rf={b:{type:"number",version:"3.0.0",optional:!0},x:{type:"number",int:!0,version:"3.0.0",optional:!0},y:{type:"number",int:!0,version:"3.0.0",optional:!0},d:{type:"number",version:"3.0.0",optional:!0},w:{type:"number",int:!0,version:"3.0.0",optional:!0},h:{type:"number",int:!0,version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Ou={b:{type:"number",version:"3.0.0",optional:!0},et:{type:"number",int:!0,version:"3.0.0",optional:!0},i:{type:"number",int:!0,version:"3.0.0",optional:!0},f:{type:"number",version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},kf={b:{type:"number",version:"3.0.0",optional:!0},m:{type:"number",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Lf={b:{type:"number",version:"3.0.0",optional:!0},e:{type:"number",int:!0,version:"3.0.0",optional:!0},r:{type:"number",version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Nu={b:{type:"number",version:"3.0.0",optional:!0},o:{type:"boolean",version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Vn={f:{type:"number",int:!0,version:"3.0.0",optional:!0},p:{type:"number",version:"3.0.0",optional:!0},t:{type:"number",version:"3.0.0",optional:!0},r:{type:"number",int:!0,version:"3.0.0",optional:!0},c:{type:"number",int:!0,version:"3.1.0",optional:!0},l:{type:"number",version:"3.1.0",optional:!0},d:{type:"number",int:!0,version:"3.1.0",optional:!0},n:{type:"number",int:!0,version:"3.1.0",optional:!0},s:{type:"number",int:!0,version:"3.1.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Bf={b:{type:"number",version:"3.0.0",optional:!0},c:{type:"number",int:!0,version:"3.0.0",optional:!0},f:{type:"number",version:"3.0.0",optional:!0},i:{type:"number",int:!0,version:"3.0.0",optional:!0},s:{type:"number",version:"3.0.0",optional:!0},sb:{type:"number",version:"3.3.0",optional:!0},sf:{type:"number",int:!0,version:"3.3.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},xf={f:{type:"object",version:"3.0.0",check:Vn,optional:!0},w:{type:"number",version:"3.0.0",optional:!0},d:{type:"number",int:!0,version:"3.0.0",optional:!0},r:{type:"number",version:"3.0.0",optional:!0},t:{type:"number",int:!0,version:"3.0.0",optional:!0},e:{type:"array",version:"3.0.0",check:Bf,optional:!0},b:{type:"number",int:!0,version:"3.0.0",optional:!0},i:{type:"number",int:!0,version:"3.2.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Iu={b:{type:"number",version:"3.0.0",optional:!0},g:{type:"number",int:!0,version:"3.0.0",optional:!0},e:{type:"array",version:"3.0.0",check:xf,optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Of={b:{type:"number",version:"3.0.0",optional:!0},p:{type:"number",int:!0,version:"3.0.0",optional:!0},e:{type:"number",int:!0,version:"3.0.0",optional:!0},l:{type:"number",version:"3.0.0",optional:!0},r:{type:"number",version:"3.0.0",optional:!0},o:{type:"number",int:!0,version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Nf={f:{type:"object",version:"3.0.0",check:Vn,optional:!0},w:{type:"number",version:"3.0.0",optional:!0},d:{type:"number",int:!0,version:"3.0.0",optional:!0},s:{type:"number",version:"3.0.0",optional:!0},t:{type:"number",int:!0,version:"3.0.0",optional:!0},a:{type:"number",int:!0,version:"3.0.0",optional:!0},l:{type:"array",version:"3.0.0",check:Of,optional:!0},r:{type:"number",int:!0,version:"3.0.0",optional:!0},b:{type:"number",int:!0,version:"3.0.0",optional:!0},i:{type:"number",int:!0,version:"3.2.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Au={b:{type:"number",version:"3.0.0",optional:!0},g:{type:"number",int:!0,version:"3.0.0",optional:!0},e:{type:"array",version:"3.0.0",check:Nf,optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},If={b:{type:"number",version:"3.2.0",optional:!0},p:{type:"number",int:!0,version:"3.2.0",optional:!0},e:{type:"number",int:!0,version:"3.2.0",optional:!0},t:{type:"number",version:"3.2.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Af={f:{type:"object",version:"3.2.0",check:Vn,optional:!0},w:{type:"number",version:"3.2.0",optional:!0},d:{type:"number",int:!0,version:"3.2.0",optional:!0},s:{type:"number",version:"3.2.0",optional:!0},t:{type:"number",int:!0,version:"3.2.0",optional:!0},a:{type:"number",int:!0,version:"3.2.0",optional:!0},l:{type:"array",version:"3.2.0",check:If,optional:!0},r:{type:"number",int:!0,version:"3.2.0",optional:!0},b:{type:"number",int:!0,version:"3.2.0",optional:!0},i:{type:"number",int:!0,version:"3.2.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Pu={b:{type:"number",version:"3.2.0",optional:!0},g:{type:"number",int:!0,version:"3.2.0",optional:!0},e:{type:"array",version:"3.2.0",check:Af,optional:!0},customData:{type:"object",version:"3.2.0",check:{},optional:!0}},Pf={f:{type:"object",version:"3.3.0",check:Vn,optional:!0},w:{type:"number",version:"3.3.0",optional:!0},d:{type:"number",int:!0,version:"3.3.0",optional:!0},s:{type:"number",version:"3.3.0",optional:!0},t:{type:"number",int:!0,version:"3.3.0",optional:!0},l:{type:"number",int:!0,array:!0,version:"3.3.0",optional:!0},b:{type:"number",int:!0,version:"3.3.0",optional:!0},i:{type:"number",int:!0,version:"3.3.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},$u={b:{type:"number",version:"3.3.0",optional:!0},g:{type:"number",int:!0,version:"3.3.0",optional:!0},e:{type:"array",version:"3.3.0",check:Pf,optional:!0},t:{type:"number",int:!0,version:"3.3.0",optional:!0},customData:{type:"object",version:"3.3.0",check:{},optional:!0}},$f={k:{type:"string",version:"3.0.0",optional:!0},e:{type:"number",int:!0,array:!0,version:"3.0.0",optional:!0}},Mu={d:{type:"array",version:"3.0.0",check:$f,optional:!0}},Mf={b:{type:"number",version:"3.3.0",optional:!0},i:{type:"number",int:!0,version:"3.3.0",optional:!0},p:{type:"number",int:!0,version:"3.3.0",optional:!0},v:{type:"number",version:"3.3.0",optional:!0},customData:{type:"object",version:"3.3.0",check:{},optional:!0}},Ff={b:{type:"number",version:"3.3.0",optional:!0},p:{type:"number",int:!0,version:"3.3.0",optional:!0},v:{type:"number",int:!0,version:"3.3.0",optional:!0},customData:{type:"object",version:"3.3.0",check:{},optional:!0}},Fu={_fl:{type:"array",version:"3.3.0",check:Mf,optional:!0},_il:{type:"array",version:"3.3.0",check:Ff,optional:!0}},jf={b:{type:"number",version:"3.0.0",optional:!0},d:{type:"number",int:!0,version:"3.0.0",optional:!0},x:{type:"number",int:!0,version:"3.0.0",optional:!0},y:{type:"number",int:!0,version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},zf={version:{type:"string",version:"3.0.0",optional:!0},bpmEvents:{type:"array",version:"3.0.0",check:kf,optional:!0},rotationEvents:{type:"array",version:"3.0.0",check:Lf,optional:!0},colorNotes:{type:"array",version:"3.0.0",check:wf,optional:!0},bombNotes:{type:"array",version:"3.0.0",check:Sf,optional:!0},obstacles:{type:"array",version:"3.0.0",check:Rf,optional:!0},sliders:{type:"array",version:"3.0.0",check:Cf,optional:!0},burstSliders:{type:"array",version:"3.0.0",check:Tf,optional:!0},waypoints:{type:"array",version:"3.0.0",check:jf,optional:!0},basicBeatmapEvents:{type:"array",version:"3.0.0",check:Ou,optional:!0},colorBoostBeatmapEvents:{type:"array",version:"3.0.0",check:Nu,optional:!0},lightColorEventBoxGroups:{type:"array",version:"3.0.0",check:Iu,optional:!0},lightRotationEventBoxGroups:{type:"array",version:"3.0.0",check:Au,optional:!0},lightTranslationEventBoxGroups:{type:"array",version:"3.2.0",check:Pu,optional:!0},vfxEventBoxGroups:{type:"array",version:"3.3.0",check:$u,optional:!0},basicEventTypesWithKeywords:{type:"object",version:"3.0.0",check:Mu,optional:!0},_fxEventsCollection:{type:"object",version:"3.3.0",check:Fu,optional:!0},useNormalEventsAsCompatibleEvents:{type:"boolean",version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Vf={basicBeatmapEvents:{type:"array",version:"3.0.0",check:Ou,optional:!0},colorBoostBeatmapEvents:{type:"array",version:"3.0.0",check:Nu,optional:!0},lightColorEventBoxGroups:{type:"array",version:"3.0.0",check:Iu,optional:!0},lightRotationEventBoxGroups:{type:"array",version:"3.0.0",check:Au,optional:!0},lightTranslationEventBoxGroups:{type:"array",version:"3.2.0",check:Pu,optional:!0},vfxEventBoxGroups:{type:"array",version:"3.3.0",check:$u,optional:!0},_fxEventsCollection:{type:"object",version:"3.3.0",check:Fu,optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},mo={b:{type:"number",version:"4.0.0",optional:!0},i:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},En={b:{type:"number",version:"4.0.0",optional:!0},i:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},r:{type:"number",version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Gf={hb:{type:"number",version:"4.0.0",optional:!0},hr:{type:"number",version:"4.0.0",optional:!0},tb:{type:"number",version:"4.0.0",optional:!0},tr:{type:"number",version:"4.0.0",optional:!0},i:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},ci:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},fs={hb:{type:"number",version:"4.0.0",optional:!0},hi:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},hr:{type:"number",version:"4.0.0",optional:!0},tb:{type:"number",version:"4.0.0",optional:!0},ti:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},tr:{type:"number",version:"4.0.0",optional:!0},ai:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Hf={x:{type:"number",int:!0,version:"4.0.0",optional:!0},y:{type:"number",int:!0,version:"4.0.0",optional:!0},a:{type:"number",int:!0,version:"4.0.0",optional:!0},c:{type:"number",int:!0,version:"4.0.0",optional:!0},d:{type:"number",int:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Uf={x:{type:"number",int:!0,version:"4.0.0",optional:!0},y:{type:"number",int:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Wf={x:{type:"number",int:!0,version:"4.0.0",optional:!0},y:{type:"number",int:!0,version:"4.0.0",optional:!0},d:{type:"number",version:"4.0.0",optional:!0},w:{type:"number",int:!0,version:"4.0.0",optional:!0},h:{type:"number",int:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Yf={tx:{type:"number",int:!0,version:"4.0.0",optional:!0},ty:{type:"number",int:!0,version:"4.0.0",optional:!0},c:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},s:{type:"number",version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Xf={m:{type:"number",version:"4.0.0",optional:!0},tm:{type:"number",version:"4.0.0",optional:!0},a:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},qf={e:{type:"number",int:!0,version:"4.0.0",optional:!0},r:{type:"number",version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Kf={version:{type:"string",version:"4.0.0"},colorNotes:{type:"object",array:!0,version:"4.0.0",check:En,optional:!0},bombNotes:{type:"object",array:!0,version:"4.0.0",check:En,optional:!0},obstacles:{type:"object",array:!0,version:"4.0.0",check:En,optional:!0},chains:{type:"object",array:!0,version:"4.0.0",check:Gf,optional:!0},arcs:{type:"object",array:!0,version:"4.0.0",check:fs,optional:!0},spawnRotations:{type:"object",array:!0,version:"4.0.0",check:fs,optional:!0},colorNotesData:{type:"object",array:!0,version:"4.0.0",check:Hf,optional:!0},bombNotesData:{type:"object",array:!0,version:"4.0.0",check:Uf,optional:!0},obstaclesData:{type:"object",array:!0,version:"4.0.0",check:Wf,optional:!0},chainsData:{type:"object",array:!0,version:"4.0.0",check:Yf,optional:!0},arcsData:{type:"object",array:!0,version:"4.0.0",check:Xf,optional:!0},spawnRotationsData:{type:"object",array:!0,version:"4.0.0",check:qf,optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Zf={x:{type:"number",int:!0,version:"4.0.0",optional:!0},y:{type:"number",int:!0,version:"4.0.0",optional:!0},d:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Jf={t:{type:"number",int:!0,version:"4.0.0",optional:!0},i:{type:"number",int:!0,version:"4.0.0",optional:!0},f:{type:"number",version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Qf={b:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},tp={e:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},f:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},l:{type:"object",array:!0,version:"4.0.0",check:mo,optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},ep={t:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},b:{type:"number",version:"4.0.0",optional:!0},g:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},e:{type:"object",array:!0,version:"4.0.0",check:tp,optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},ip={f:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},p:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},t:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},r:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},c:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},n:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},s:{type:"number",int:!0,version:"4.0.0",optional:!0},l:{type:"number",unsigned:!0,version:"4.0.0",optional:!0},d:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},np={w:{type:"number",version:"4.0.0",optional:!0},d:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},s:{type:"number",version:"4.0.0",optional:!0},t:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},b:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},e:{type:"number",int:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},op={p:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},c:{type:"number",int:!0,version:"4.0.0",optional:!0},e:{type:"number",int:!0,version:"4.0.0",optional:!0},b:{type:"number",version:"4.0.0",optional:!0},f:{type:"number",int:!0,version:"4.0.0",optional:!0},sb:{type:"number",version:"4.0.0",optional:!0},sf:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},rp={w:{type:"number",version:"4.0.0",optional:!0},d:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},s:{type:"number",version:"4.0.0",optional:!0},t:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},b:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},e:{type:"number",int:!0,version:"4.0.0",optional:!0},a:{type:"number",int:!0,version:"4.0.0",optional:!0},f:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},sp={p:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},e:{type:"number",int:!0,version:"4.0.0",optional:!0},l:{type:"number",int:!0,version:"4.0.0",optional:!0},r:{type:"number",version:"4.0.0",optional:!0},d:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},ap={w:{type:"number",version:"4.0.0",optional:!0},d:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},s:{type:"number",version:"4.0.0",optional:!0},t:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},b:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},e:{type:"number",int:!0,version:"4.0.0",optional:!0},a:{type:"number",int:!0,version:"4.0.0",optional:!0},f:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},lp={p:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},e:{type:"number",int:!0,version:"4.0.0",optional:!0},t:{type:"number",version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},up={w:{type:"number",version:"4.0.0",optional:!0},d:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},s:{type:"number",version:"4.0.0",optional:!0},t:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},b:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},e:{type:"number",int:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},cp={p:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},e:{type:"number",int:!0,version:"4.0.0",optional:!0},v:{type:"number",version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},hp={version:{type:"string",version:"4.0.0"},waypoints:{type:"object",array:!0,version:"4.0.0",check:En,optional:!0},waypointsData:{type:"object",array:!0,version:"4.0.0",check:Zf,optional:!0},basicEvents:{type:"object",array:!0,version:"4.0.0",check:mo,optional:!0},basicEventsData:{type:"object",array:!0,version:"4.0.0",check:Jf,optional:!0},colorBoostEvents:{type:"object",array:!0,version:"4.0.0",check:mo,optional:!0},colorBoostEventsData:{type:"object",array:!0,version:"4.0.0",check:Qf,optional:!0},eventBoxGroups:{type:"object",array:!0,version:"4.0.0",check:ep,optional:!0},indexFilters:{type:"object",array:!0,version:"4.0.0",check:ip,optional:!0},lightColorEventBoxes:{type:"object",array:!0,version:"4.0.0",check:np,optional:!0},lightColorEvents:{type:"object",array:!0,version:"4.0.0",check:op,optional:!0},lightRotationEventBoxes:{type:"object",array:!0,version:"4.0.0",check:rp,optional:!0},lightRotationEvents:{type:"object",array:!0,version:"4.0.0",check:sp,optional:!0},lightTranslationEventBoxes:{type:"object",array:!0,version:"4.0.0",check:ap,optional:!0},lightTranslationEvents:{type:"object",array:!0,version:"4.0.0",check:lp,optional:!0},fxEventBoxes:{type:"object",array:!0,version:"4.0.0",check:up,optional:!0},floatFxEvents:{type:"object",array:!0,version:"4.0.0",check:cp,optional:!0},basicEventTypesWithKeywords:{type:"object",version:"4.0.0",check:Mu},useNormalEventsAsCompatibleEvents:{type:"boolean",version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},mp={title:{type:"string",version:"4.0.0",optional:!0},subTitle:{type:"string",version:"4.0.0",optional:!0},author:{type:"string",version:"4.0.0",optional:!0}},fp={songFilename:{type:"string",version:"4.0.0",optional:!0},songDuration:{type:"number",version:"4.0.0",optional:!0},audioDataFilename:{type:"string",version:"4.0.0",optional:!0},bpm:{type:"number",version:"4.0.0"},lufs:{type:"number",version:"4.0.0"},previewStartTime:{type:"number",version:"4.0.0",optional:!0},previewDuration:{type:"number",version:"4.0.0",optional:!0}},pp={colorSchemeName:{type:"string",version:"4.0.0",optional:!0},saberAColor:{type:"string",version:"4.0.0",optional:!0},saberBColor:{type:"string",version:"4.0.0",optional:!0},obstaclesColor:{type:"string",version:"4.0.0",optional:!0},environmentColor0:{type:"string",version:"4.0.0",optional:!0},environmentColor1:{type:"string",version:"4.0.0",optional:!0},environmentColorW:{type:"string",version:"4.0.0",optional:!0},environmentColor0Boost:{type:"string",version:"4.0.0",optional:!0},environmentColor1Boost:{type:"string",version:"4.0.0",optional:!0},environmentColorWBoost:{type:"string",version:"4.0.0",optional:!0}},dp={mappers:{type:"string",array:!0,version:"4.0.0"},lighters:{type:"string",array:!0,version:"4.0.0"}},bp={characteristic:{type:"string",version:"4.0.0",optional:!0},difficulty:{type:"string",version:"4.0.0",optional:!0},beatmapAuthors:{type:"object",version:"4.0.0",check:dp},environmentNameIdx:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},beatmapColorSchemeIdx:{type:"number",int:!0,version:"4.0.0",optional:!0},noteJumpMovementSpeed:{type:"number",version:"4.0.0",optional:!0},noteJumpStartBeatOffset:{type:"number",version:"4.0.0",optional:!0},lightshowDataFilename:{type:"string",version:"4.0.0",optional:!0},beatmapDataFilename:{type:"string",version:"4.0.0"},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},gp={version:{type:"string",version:"4.0.0"},song:{type:"object",version:"4.0.0",check:mp},audio:{type:"object",version:"4.0.0",check:fp},songPreviewFilename:{type:"string",version:"4.0.0",optional:!0},coverImageFilename:{type:"string",version:"4.0.0",optional:!0},environmentNames:{type:"string",array:!0,version:"4.0.0"},colorSchemes:{type:"object",array:!0,version:"4.0.0",check:pp},difficultyBeatmaps:{type:"object",array:!0,version:"4.0.0",check:bp},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},vp={si:{type:"number",version:"4.0.0",int:!0,unsigned:!0},ei:{type:"number",version:"4.0.0",int:!0,unsigned:!0},sb:{type:"number",version:"4.0.0"},eb:{type:"number",version:"4.0.0"}},_p={si:{type:"number",version:"4.0.0",int:!0,unsigned:!0},ei:{type:"number",version:"4.0.0",int:!0,unsigned:!0},l:{type:"number",version:"4.0.0"}},yp={version:{type:"string",version:"4.0.0"},songChecksum:{type:"string",version:"4.0.0"},songSampleCount:{type:"number",version:"4.0.0",int:!0,unsigned:!0},songFrequency:{type:"number",version:"4.0.0",int:!0,unsigned:!0},bpmData:{type:"object",version:"4.0.0",check:vp,array:!0},lufsData:{type:"object",version:"4.0.0",check:_p,array:!0}},Ep={1:af,2:yf,4:gp},Dp={2:Df,4:yp},wp={1:rf,2:df,3:zf,4:Kf},Sp={3:Vf,4:hp};function Cp(t){return["validator",t]}const ps={enabled:!0,throwOn:{unused:!1,missing:!0,ignoreOptional:!1,nullish:!0,wrongType:!0,notInt:!1,notUnsigned:!1}};function Tp(t,e,i,n){const o={enabled:(n==null?void 0:n.enabled)??ps.enabled,throwOn:{...ps.throwOn,...n==null?void 0:n.throwOn}};let r={};switch(t){case"info":r=Ep;break;case"audioData":r=Dp;break;case"difficulty":r=wp;break;case"lightshow":r=Sp;break}const a=Lu(e)??ku(t);return J.tInfo(Cp("validateJSON"),"Validating beatmap JSON for "+t+" with version",i),yn(e,r[i],t,a,o.throwOn),e}function hi(t){return["loader",t]}const Pi={forceConvert:!0,schemaCheck:{},sort:!0,preprocess:[],postprocess:[]};function So(t,e,i,n={}){var d;const o={forceConvert:n.forceConvert??Pi.forceConvert,schemaCheck:{...Pi.schemaCheck,...n.schemaCheck},sort:n.sort??Pi.sort,preprocess:n.preprocess??Pi.preprocess,postprocess:n.postprocess??Pi.postprocess};let r,a,s;switch(t){case"info":r=St,a=Zm,s=$m;break;case"audioData":r=pe,a=Jm,s=Mm;break;case"difficulty":r=Re,a=Qm,s=ur;break;case"lightshow":r=Re,a=tf,s=ur;break}o.preprocess.forEach((u,m)=>{J.tInfo(hi("loadBeatmap"),"Running preprocess function #"+(m+1)),e=u(e)});const l=(d=Lu(e))==null?void 0:d.at(0);let c;l?c=parseInt(l):(c=+ku(t).at(0),J.tWarn(hi("loadBeatmap"),"Could not identify beatmap version from JSON, assume implicit version",c));let h;const p=a[c];if(p)o.schemaCheck.enabled&&Tp(t,e,c,o.schemaCheck),h=new r(p.deserialize(e));else throw new Error(`Beatmap version ${c} is not supported, this may be an error in JSON or is newer than currently supported.`);if(i&&c!==i){if(!o.forceConvert)throw new Error(`Beatmap version unmatched, expected ${i} but received ${c}`);J.tWarn(hi("loadBeatmap"),"Beatmap version unmatched, expected",i,"but received",c,"for version; Converting to beatmap version",i),h=s[i](h,h.version)}return o.sort&&h.sort(),o.postprocess.forEach((u,m)=>{J.tInfo(hi("loadBeatmap"),"Running postprocess function #"+(m+1)),h=u(h)}),h}function Rp(t,e,i){const n=typeof e=="number"?e:null,o=(typeof e!="number"?e:i)??{};return J.tInfo(hi("loadDifficulty"),"Loading difficulty from JSON"),So("difficulty",t,n,o)}function kp(t,e,i){const n=typeof e=="number"?e:null,o=(typeof e!="number"?e:i)??{};return J.tInfo(hi("loadInfo"),"Loading info from JSON"),So("info",t,n,o)}function Lp(t,e,i){const n=typeof e=="number"?e:null,o=(typeof e!="number"?e:i)??{};return J.tInfo(hi("loadLightshow"),"Loading lightshow from JSON"),So("lightshow",t,n,o)}const fo={DefaultEnvironment:"The First",OriginsEnvironment:"Origins",TriangleEnvironment:"Triangle",NiceEnvironment:"Nice",BigMirrorEnvironment:"Big Mirror",DragonsEnvironment:"Dragons",KDAEnvironment:"K/DA",MonstercatEnvironment:"Monstercat",CrabRaveEnvironment:"Crab Rave",PanicEnvironment:"Panic",RocketEnvironment:"Rocket",GreenDayEnvironment:"Green Day",GreenDayGrenadeEnvironment:"Green Day Grenade",TimbalandEnvironment:"Timbaland",FitBeatEnvironment:"FitBeat",LinkinParkEnvironment:"Linkin Park",BTSEnvironment:"BTS",KaleidoscopeEnvironment:"Kaleidoscope",InterscopeEnvironment:"Interscope",SkrillexEnvironment:"Skrillex",BillieEnvironment:"Billie",HalloweenEnvironment:"Spooky",GagaEnvironment:"Gaga",WeaveEnvironment:"Weave",PyroEnvironment:"Pyro",EDMEnvironment:"EDM",TheSecondEnvironment:"The Second",LizzoEnvironment:"Lizzo",TheWeekndEnvironment:"The Weeknd",RockMixtapeEnvironment:"Rock Mixtape",Dragons2Environment:"Dragons 2.0",Panic2Environment:"Panic 2.0",QueenEnvironment:"Queen",LinkinPark2Environment:"Linkin Park 2.0",TheRollingStonesEnvironment:"The Rolling Stones",LatticeEnvironment:"Lattice",DaftPunkEnvironment:"Daft Punk",HipHopEnvironment:"Hip Hop Mixtape",ColliderEnvironment:"Collider",GlassDesertEnvironment:"Glass Desert",MultiplayerEnvironment:"Origins",BritneyEnvironment:"Britney Spears"},bi={DefaultEnvironment:[[0,1,2,3,4,8,9,12,13],[]],OriginsEnvironment:[[0,1,2,3,4,8,9,12,13],[]],TriangleEnvironment:[[0,1,2,3,4,8,9,12,13],[]],NiceEnvironment:[[0,1,2,3,4,8,9,12,13],[]],BigMirrorEnvironment:[[0,1,2,3,4,8,9,12,13],[]],DragonsEnvironment:[[0,1,2,3,4,8,9,12,13],[]],KDAEnvironment:[[0,1,2,3,4,8,9,12,13],[]],MonstercatEnvironment:[[0,1,2,3,4,8,9,12,13],[]],CrabRaveEnvironment:[[0,1,2,3,4,8,9,12,13],[]],PanicEnvironment:[[0,1,2,3,4,8,9,12,13],[]],RocketEnvironment:[[0,1,2,3,4,8,9,12,13],[]],GreenDayEnvironment:[[0,1,2,3,4,8,9,12,13],[]],GreenDayGrenadeEnvironment:[[0,1,2,3,4,8,9,12,13],[]],TimbalandEnvironment:[[0,1,2,3,4,8,9,12,13],[]],FitBeatEnvironment:[[0,1,2,3,4,8,9,12,13],[]],LinkinParkEnvironment:[[0,1,2,3,4,8,9,12,13],[]],BTSEnvironment:[[0,1,2,3,4,8,9,12,13],[]],KaleidoscopeEnvironment:[[0,1,2,3,4,8,9,12,13],[]],InterscopeEnvironment:[[0,1,2,3,4,6,7,8,9,12,13,16,17],[]],SkrillexEnvironment:[[0,1,2,3,4,6,7,8,9,12,13],[]],BillieEnvironment:[[0,1,2,3,4,6,7,8,9,10,11,12,13],[]],HalloweenEnvironment:[[0,1,2,3,4,8,9,12,13],[]],GagaEnvironment:[[0,1,2,3,4,6,7,8,9,10,11,12,13,16,17],[]],GlassDesertEnvironment:[[0,1,2,3,4,8,9,12,13],[]],MultiplayerEnvironment:[[4],[]],WeaveEnvironment:[[],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]],PyroEnvironment:[[0,1,2,3,4,6,40],[0,1,2,3,4,5,6,7,8,9,10,11,12,13]],EDMEnvironment:[[0,1,4],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]],TheSecondEnvironment:[[0,1,2,3,4,9],[0,1,2,3,4,5,6,7,8,9,10,11,12,13]],LizzoEnvironment:[[0,1,2,3,4,6,7,8,9,10,11,12,16,17],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]],TheWeekndEnvironment:[[0,1,6],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,29,30,31,32,33,34,35,36,37,38,40]],RockMixtapeEnvironment:[[3,4,6],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37]],Dragons2Environment:[[0,1,2,3,4,6],[0,1,2,3,4,5,6,7,8,9,10,11,12]],Panic2Environment:[[3],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]],QueenEnvironment:[[6,40],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]],LinkinPark2Environment:[[3,40,41],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]],TheRollingStonesEnvironment:[[6,40],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45]],LatticeEnvironment:[[6],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30]],DaftPunkEnvironment:[[6,40,41,42,43],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55]],HipHopEnvironment:[[6],[0,1,2,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41]],ColliderEnvironment:[[6],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27]],BritneyEnvironment:[[6,8,9,12],[0,1,2,3,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22]]},Bp={},xp=Object.freeze(Object.defineProperty({__proto__:null,default:Bp},Symbol.toStringTag,{value:"Module"}));function ds(){throw new Error("`path` function not provided; please supply `path` function inside the `path` object from the module")}const wi=xp,Op={resolve:(wi==null?void 0:wi.resolve)||ds,basename:(wi==null?void 0:wi.basename)||ds};function an(){throw new Error("`fs` function not provided; please supply `fs` function inside the `fs` object from the module")}typeof Deno<"u"?(Deno.readTextFile,Deno.readTextFileSync,Deno.writeTextFile,Deno.writeTextFileSync):typeof Bun<"u"&&Bun.write;var bs=function(t,e,i,n){if(i==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return i==="m"?n:i==="a"?n.call(t):n?n.value:e.get(t)},Np=function(t,e,i,n,o){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!o:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?o.call(t,i):o?o.value=i:e.set(t,i),i},Fi;function Ip(t){return["globals",t]}class Ap{constructor(){Fi.set(this,"./")}get directory(){return bs(this,Fi,"f")}set directory(e){e=Op.resolve(e.trim()),Np(this,Fi,e,"f"),J.tInfo(Ip("directory"),`Global map directory is set to ${bs(this,Fi,"f")}`)}}Fi=new WeakMap;new Ap;const Qn=document.querySelector(".info__level-author"),gs=document.querySelector(".info__environment"),to=document.querySelector(".info__editors"),vs=document.querySelector(".info__contributors");document.querySelector(".info__contributors-image");document.querySelector(".info__contributors-name");document.querySelector(".info__contributors-role");const ln=document.querySelector(".info__contributors-list");function ju(t,e){if(!t){Qn.textContent="";return}e!=null&&e.length?Qn.textContent="Mapped by "+t.join(", ")+" and lit by "+e.join(", "):Qn.textContent="Mapped by "+t.join(", ")}function zu(t){if(!t){gs.textContent="";return}gs.textContent=t.map(e=>(fo[e]||`Unknown (${e})`)+" Environment").join(", ")}function Vu(t){if(!t||!t._lastEditedBy){to.classList.add("hidden");return}to.classList.remove("hidden");const e=t._lastEditedBy||"Undefined";let i="Last edited on "+e;if(t[e]){const n=t[e];i+=" v"+n.version}to.textContent=i}function Gu(t){for(;ln.firstChild;)ln.removeChild(ln.firstChild);if(!t||!t.length){vs.classList.add("hidden");return}vs.classList.remove("hidden"),t.forEach((e,i)=>{const n=document.createElement("div");n.classList.add("info__contributors-card");const o=document.createElement("img");o.classList.add("info__contributors-image"),o.src=e._base64?"data:image;base64,"+e._base64:"./img/unknown.jpg",o.alt="contributor image: "+e._name;const r=document.createElement("div");r.classList.add("info__contributors-content");const a=document.createElement("span");a.classList.add("info__contributors-name"),a.textContent=e._name;const s=document.createElement("span");s.classList.add("info__contributors-role"),s.textContent=e._role,r.appendChild(a),r.appendChild(document.createElement("br")),r.appendChild(s),n.appendChild(o),n.appendChild(r),ln.appendChild(n)})}const $i={version:6,load:{audio:!0,imageCover:!0,imageContributor:!0},sorting:!0,beatNumbering:"beattime",infoRowCount:5,rounding:3,dataCheck:!0,deduplicateTime:!0,theme:"Dark",show:"info",aprilFooled:!1},it=new class{constructor(){this.property=W($i),this.stringify=()=>JSON.stringify({settings:this.property}),this.init=()=>{var i;if(localStorage==null)return;const e=localStorage.getItem("settings");if(e){const n=JSON.parse(e);if(!((i=n.settings)!=null&&i.version)){this.clear();return}this.property=n.settings??this.property;for(const o in $i)typeof this.property[o]>"u"&&(this.property[o]=$i[o]);this.property.version=$i.version,this.save()}},this.save=()=>{localStorage&&localStorage.setItem("settings",this.stringify())},this.clear=()=>{localStorage&&localStorage.clear()},this.reset=()=>{this.property=W($i)},this.init()}get version(){return this.property.version}get load(){return this.property.load}get sorting(){return this.property.sorting}set sorting(e){this.property.sorting=e}get beatNumbering(){return this.property.beatNumbering}set beatNumbering(e){this.property.beatNumbering=e}get infoRowCount(){return this.property.infoRowCount}set infoRowCount(e){this.property.infoRowCount=e}get rounding(){return this.property.rounding}set rounding(e){this.property.rounding=e}get dataCheck(){return this.property.dataCheck}set dataCheck(e){this.property.dataCheck=e}get deduplicateTime(){return this.property.deduplicateTime}set deduplicateTime(e){this.property.deduplicateTime=e}get theme(){return this.property.theme}set theme(e){this.property.theme=e}get show(){return this.property.show}set show(e){this.property.show=e}get aprilFooled(){return this.property.aprilFooled}set aprilFooled(e){this.property.aprilFooled=e}},_s=document.querySelector(".info__version"),ys=document.querySelector(".info__mappers"),Es=document.querySelector(".info__lighters"),Ds=document.querySelector(".info__environmentId"),ws=document.querySelector(".info__play-time"),Ss=document.querySelector(".info__time-spend"),Cs=document.querySelector(".info__color-scheme"),Ts=document.querySelector(".info__custom-color"),Rs=document.querySelector(".info__requirements"),ks=document.querySelector(".info__suggestions"),Ls=document.querySelector(".info__information"),Bs=document.querySelector(".info__warnings"),xs=document.querySelector(".info__bookmarks"),Os=document.querySelector(".info__bpm-changes"),Ns=document.querySelector(".info__environment-enhancement"),Is=document.querySelector(".info__point-definitions"),As=document.querySelector(".info__custom-events");document.querySelectorAll(".info__table-element");document.querySelectorAll(".info__table-contents");function Ft(t){const e=t.querySelector(".info__table-element"),i=e==null?void 0:e.querySelector(".info__table-content");i&&(i.innerHTML=""),t.classList.add("hidden")}let Gt={};function Pp(t,e){t.textContent=e}function $p(t,e){const i=Gt[t];return function(){i.page++,i.page*it.infoRowCount>=i.content.length&&(i.page=0),e()}}function Mp(t,e){const i=Gt[t];return function(){i.page--,i.page<0&&(i.page=Math.ceil(i.content.length/it.infoRowCount)-1),e()}}function Fp(t,e){const i=Gt[t];return function(){const o=i.content.slice(i.page*it.infoRowCount,i.page*it.infoRowCount+it.infoRowCount);for(Pp(e,`${i.page+1} / ${Math.ceil(i.content.length/it.infoRowCount)}`);i.html.firstChild;)i.html.removeChild(i.html.firstChild);o.forEach(r=>{if(typeof r=="string"){const a=document.createElement("div");a.textContent=r,i.html.appendChild(a)}else i.html.appendChild(r)})}}function jt(t,e,i=""){const n=t.querySelector(".info__table-element");if(!n)return;const o=n.querySelector(".info__table-content");if(o){for(;o.firstChild;)o.removeChild(o.firstChild);if(typeof e=="string")o.textContent=e;else if(i){const r=n.querySelector(".info__table-paginate-button--next"),a=n.querySelector(".info__table-paginate-button--prev"),s=n.querySelector(".info__table-paginate-total");s.textContent=`${e.length}`;const l=n.querySelector(".info__table-paginate-page");i in Gt&&(r.removeEventListener("click",Gt[i].nextCb),a.removeEventListener("click",Gt[i].prevCb)),Gt[i]={content:e,html:o,page:0,nextCb:null,prevCb:null,cb:null},Gt[i].cb=Fp(i,l);const c=$p(i,Gt[i].cb),h=Mp(i,Gt[i].cb);r&&(r.addEventListener("click",c),Gt[i].nextCb=c),a&&(a.addEventListener("click",h),Gt[i].prevCb=h),Gt[i].cb()}else{for(;o.firstChild;)o.removeChild(o.firstChild);e.forEach(r=>{if(typeof r=="string"){const a=document.createElement("div");a.textContent=r,o.appendChild(a)}else o.appendChild(r)})}}t.classList.remove("hidden")}function Hu(){Object.keys(Gt).forEach(t=>{var e,i;Gt[t].page=0,(i=(e=Gt[t]).cb)==null||i.call(e)})}function Uu(t,e){if(t==null||!t.length){Ft(xs);return}const i=[];t.forEach((n,o)=>{let r=n.b??n._time??0,a;const s=document.createElement("div"),l=document.createElement("div"),c=document.createElement("div");s.appendChild(l),s.appendChild(c),s.className="info__color",l.className="info__color-dot",l.style.backgroundColor="#000000",c.className="info__color-text";const h=n.n??n._name;typeof h!="string"&&(c.textContent=`Error parsing bookmarks[${o}]`,i.push(s)),e&&(r=e.adjustTime(r),a=e.toRealTime(r));const p=n.c??n._color;l.style.backgroundColor=p?pt({r:p[0],g:p[1],b:p[2]}):"#333333",c.textContent=`${M(r,it.rounding)}${a?" | "+Zt(a):""} -- ${h!=""?h:"**EMPTY NAME**"}`,i.push(s)}),jt(xs,i,"bookmarks")}function Wu(t){if(!t||!t.change.length){Ft(Os);return}const e=t.change.map(i=>{const n=M(i.newTime,it.rounding),o=t.toRealTime(i.time);return`${n} | ${Zt(o)} -- ${i.BPM}`});jt(Os,e,"bpmChanges")}function Yu(t,e){var c,h,p,d,u,m,b;if(!t||!t._colorLeft&&!t._colorRight&&!t._envColorLeft&&!t._envColorLeftBoost&&!t._envColorRight&&!t._envColorRightBoost&&!t._envColorWhite&&!t._envColorWhiteBoost&&!t._obstacleColor){Ft(Ts);return}e||(e="DefaultEnvironment");const i={_colorLeft:((c=ge[be[e]])==null?void 0:c._colorLeft)||null,_colorRight:((h=ge[be[e]])==null?void 0:h._colorRight)||null,_envColorLeft:((p=ge[be[e]])==null?void 0:p._envColorLeft)||null,_envColorRight:((d=ge[be[e]])==null?void 0:d._envColorRight)||null,_envColorWhite:null,_envColorLeftBoost:((u=ge[be[e]])==null?void 0:u._envColorLeftBoost)||null,_envColorRightBoost:((m=ge[be[e]])==null?void 0:m._envColorRightBoost)||null,_envColorWhiteBoost:null,_obstacleColor:((b=ge[be[e]])==null?void 0:b._obstacleColor)||null},n={_colorLeft:i._colorLeft?pt(i._colorLeft):null,_colorRight:i._colorRight?pt(i._colorRight):null,_envColorLeft:i._envColorLeft?pt(i._envColorLeft):null,_envColorRight:i._envColorRight?pt(i._envColorRight):null,_envColorWhite:null,_envColorLeftBoost:i._envColorLeftBoost?pt(i._envColorLeftBoost):null,_envColorRightBoost:i._envColorRightBoost?pt(i._envColorRightBoost):null,_envColorWhiteBoost:null,_obstacleColor:i._obstacleColor?pt(i._obstacleColor):null},o={noteColor:!!(t._colorLeft||t._colorRight),eventColor:!!(t._envColorLeft||t._envColorRight),eventBoostColor:!!(t._envColorLeftBoost||t._envColorRightBoost),obstacleColor:!!t._obstacleColor};t._colorLeft&&(n._colorLeft=pt(t._colorLeft)),t._colorRight&&(n._colorRight=pt(t._colorRight)),t._envColorLeft?n._envColorLeft=pt(t._envColorLeft):t._colorLeft&&(n._envColorLeft=pt(t._colorLeft)),t._envColorRight?n._envColorRight=pt(t._envColorRight):t._colorRight&&(n._envColorRight=pt(t._colorRight));let r,a,s=!1;t._envColorLeftBoost?(r=pt(t._envColorLeftBoost),s=!0):r=i._envColorLeftBoost?pt(i._envColorLeftBoost):n._envColorLeft,t._envColorRightBoost?(a=pt(t._envColorRightBoost),s=!0):a=i._envColorRightBoost?pt(i._envColorRightBoost):n._envColorRight,t._envColorWhite&&(n._envColorWhite=pt(t._envColorWhite)),t._envColorWhiteBoost&&(n._envColorWhiteBoost=pt(t._envColorWhiteBoost)),s&&(n._envColorLeftBoost=r,n._envColorRightBoost=a),t._obstacleColor&&(n._obstacleColor=pt(t._obstacleColor)),o.noteColor||(n._colorLeft=null,n._colorRight=null),o.eventColor||(n._envColorLeft=null,n._envColorRight=null),o.noteColor&&!o.eventColor&&(n._envColorLeft=n._colorLeft,n._envColorRight=n._colorRight),o.obstacleColor||(n._obstacleColor=null);const l=[];for(const y in n){if(!n[y])continue;const v=document.createElement("div"),_=document.createElement("div"),w=document.createElement("div"),C=document.createElement("div");v.className="info__color",_.className="info__color-dot",_.style.backgroundColor=n[y]||"#000000",w.className="info__color-text info__color-text--monospace",w.textContent=`${n[y]}`,C.className="info__color-text",C.textContent=` -- ${tm[y]}`,v.appendChild(_),v.appendChild(w),v.appendChild(C),l.push(v)}jt(Ts,l)}class jp{constructor(){Object.defineProperty(this,"_regex",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"_string",{enumerable:!0,configurable:!0,writable:!0,value:""})}get regex(){return this._regex}get string(){return this._string}}class un extends jp{constructor(e){super(),Object.defineProperty(this,"hasNested",{enumerable:!0,configurable:!0,writable:!0,value:!1}),e&&(this._string=e,this._regex=e)}static create(e){return e?new this(e):new this}name(e){return this._string+=e.trim(),this._regex+=e.trim(),this}id(e,i){return e!==null?(i?this._regex+=`( \\(${e}\\))?`:this._regex+=` \\(${e}\\)`,this._string+=` (${e})`):(i?this._regex+="( \\(\\d+\\))?":this._regex+=" \\(\\d+\\)",this._string+=" (1)"),this}space(e=1){for(let i=0;i<e;i++)this._string+=" ",this._regex+=" ";return this}clone(e=1){for(let i=0;i<e;i++)this._string+=" (Clone)",this._regex+=" \\(Clone\\)";return this}end(){return this._regex+="$",this}child(e){return this._string+=`.[${typeof e=="number"?e:1}]`,this._regex+=`\\.\\[${typeof e=="number"?e:"\\d+"}\\]`,this}}Object.defineProperty(un,"Preset",{enumerable:!0,configurable:!0,writable:!0,value:{ENVIRONMENT:new un().child().name("Environment").end(),CONSTRUCTION:new un("Environment").child().name("Construction").end(),SMOKE:new un().child().name("BigSmokePS").end()}});var po;(function(t){t.forehand="backhand",t.backhand="forehand"})(po||(po={}));function Xu(t,e,i){return t.direction===x.ANY&&e.direction===x.ANY&&i!==x.ANY&&(t.posX>e.posX&&(i===x.UP_RIGHT||i===x.RIGHT||i===x.DOWN_RIGHT)||t.posX<e.posX&&(i===x.DOWN_LEFT||i===x.LEFT||i===x.UP_LEFT)||t.posY>e.posY&&(i===x.UP_LEFT||i===x.UP||i===x.UP_RIGHT)||t.posY<e.posY&&(i===x.DOWN_LEFT||i===x.DOWN||i===x.DOWN_RIGHT))||t.posX>e.posX&&(t.direction===x.UP_RIGHT||t.direction===x.RIGHT||t.direction===x.DOWN_RIGHT||(e.direction===x.UP_RIGHT||e.direction===x.RIGHT||e.direction===x.DOWN_RIGHT)&&t.direction===x.ANY)||t.posX<e.posX&&(t.direction===x.DOWN_LEFT||t.direction===x.LEFT||t.direction===x.UP_LEFT||(e.direction===x.DOWN_LEFT||e.direction===x.LEFT||e.direction===x.UP_LEFT)&&t.direction===x.ANY)||t.posY>e.posY&&(t.direction===x.UP_LEFT||t.direction===x.UP||t.direction===x.UP_RIGHT||(e.direction===x.UP_LEFT||e.direction===x.UP||e.direction===x.UP_RIGHT)&&t.direction===x.ANY)||t.posY<e.posY&&(t.direction===x.DOWN_LEFT||t.direction===x.DOWN||t.direction===x.DOWN_RIGHT||(e.direction===x.DOWN_LEFT||e.direction===x.DOWN||e.direction===x.DOWN_RIGHT)&&t.direction===x.ANY)}function bo(t,e,i,n=!1){const[o,r]=t.getPosition(),[a,s]=e.getPosition(),l=n?540:360;let c=!1;if(t.direction!==8){const p=t.getAngle(),d=(oo(Math.atan2(r-s,o-a))+450)%360;for(const[u,m,b]of i){const y=b??0,v=(p+l-u+y)%360,_=(p+l+u+y)%360;if(c=m>=Math.sqrt(Math.pow(o-a,2)+Math.pow(r-s,2))&&(v<_&&v<=d&&d<=_||v>=_&&(d<=_||d>=v))||c,c)break}}let h=!1;if(e instanceof Wt&&e.direction!==8){const p=e.getAngle(),d=(oo(Math.atan2(s-r,a-o))+450)%360;for(const[u,m,b]of i){const y=b??0,v=(p+l-u+y)%360,_=(p+l+u+y)%360;if(h=m>=Math.sqrt(Math.pow(o-a,2)+Math.pow(r-s,2))&&(v<_&&v<=d&&d<=_||v>=_&&(d<=_||d>=v))||h,h)break}}return[c,h]}function Ps(t,e){if(Xu(t,e,x.ANY))return t.direction===x.ANY?e.direction:t.direction;if(t.direction!==x.ANY)return t.direction;if(t.time>e.time){if(t.posX>e.posX&&t.isHorizontal(e))return x.RIGHT;if(t.posX<e.posX&&t.isHorizontal(e))return x.LEFT;if(t.posY>e.posY){if(t.isVertical(e))return x.UP;if(t.posX>e.posX)return x.UP_RIGHT;if(t.posX<e.posX)return x.UP_LEFT}if(t.posY<e.posY){if(t.isVertical(e))return x.DOWN;if(t.posX>e.posX)return x.DOWN_RIGHT;if(t.posX<e.posX)return x.DOWN_LEFT}}return x.ANY}function Yi(t,e,i,n){let o,r;if(t===null||e===null)return!1;if(typeof t=="number")o=t;else{if(t.direction===x.ANY)return!1;o=t.getAngle()}if(typeof e=="number")r=e;else{if(e.direction===x.ANY)return!1;r=e.getAngle()}return n?Vo(o,r,360)<=i:Vo(o,r,360)>=i}const cn={[rt.RED]:{forehand:[x.DOWN,x.RIGHT,x.DOWN_LEFT,x.DOWN_RIGHT],backhand:[x.UP,x.LEFT,x.UP_LEFT,x.UP_RIGHT]},[rt.BLUE]:{forehand:[x.DOWN,x.LEFT,x.DOWN_LEFT,x.DOWN_RIGHT],backhand:[x.UP,x.RIGHT,x.UP_LEFT,x.UP_RIGHT]}},ui={[rt.RED]:[0,0,90,90,45,-45,45,-45],[rt.BLUE]:[0,0,-90,-90,-45,45,-45,45]},$s={0:{forehand:[180,0,-90,90,-135,135,-45,45],backhand:[0,180,90,-90,45,-45,135,-135]},1:{forehand:[-180,0,-90,90,-135,135,-45,45],backhand:[0,-180,90,-90,45,-45,135,-135]}};class ii{constructor(e,i,n,o,r,a,s){Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"rotation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"position",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"warningThreshold",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"errorThreshold",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"allowedRotation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.color=n,this.warningThreshold=o,this.errorThreshold=r,this.allowedRotation=a,s&&s!=="neutral"?(this.state=s,this.rotation=0):(this.state=this.predictStartState(e,i,n),this.rotation=this.predictStartRotation(e,n)),this.position=this.predictStartPosition(e,n)}check(e,i){if(this.state==="neutral")return"none";if(!e.length)throw new Error("no notes were given");const n=e[0].time,o=this.color;let r=this.state,a=this.rotation;i.forEach(h=>{h.time-.001>n||(h.posY===Lt.BOTTOM&&h.posX===(o?ut.MIDDLE_RIGHT:ut.MIDDLE_LEFT)&&(r="backhand",a=0),h.posY===Lt.TOP&&h.posX===(o?ut.MIDDLE_RIGHT:ut.MIDDLE_LEFT)&&(r="forehand",a=0))});let s,l=x.ANY;for(const h of e)h.direction!==x.ANY&&(l=h.direction),s&&l===x.ANY&&(l=Ps(h,s)),s=h;if(l===x.ANY)return"none";const c=$s[o][po[r]][l];return(a>c?a-c:c-a)>180||c<ii.CONSTRAINT_ROTATION[o][0]+this.errorThreshold||c>ii.CONSTRAINT_ROTATION[o][1]-this.errorThreshold?"error":c<ii.CONSTRAINT_ROTATION[o][0]+this.warningThreshold||c>ii.CONSTRAINT_ROTATION[o][1]-this.warningThreshold||(a>c?a-c:c-a)>this.allowedRotation?"warning":"none"}next(e,i){if(this.check(e,i)!=="error")switch(this.state){case"forehand":{this.state="backhand";break}case"backhand":{this.state="forehand";break}case"neutral":{for(let s=0;s<e.length;s++){const l=e[s];if(cn[l.color].forehand.includes(l.direction)){this.state="backhand";break}if(cn[l.color].backhand.includes(l.direction)){this.state="forehand";break}this.state==="neutral"&&l.direction===x.ANY&&(l.posY===0&&(this.state="backhand"),l.posY>0&&(this.state="forehand"))}break}}if(this.state==="neutral")throw new Error("parity unexpected input");const n=e[0].time,o=this.color;i.forEach(s=>{s.time-.001>n||(s.posY===Lt.BOTTOM&&s.posX===(o?ut.MIDDLE_RIGHT:ut.MIDDLE_LEFT)&&(this.state="forehand",this.rotation=0),s.posY===Lt.TOP&&s.posX===(o?ut.MIDDLE_RIGHT:ut.MIDDLE_LEFT)&&(this.state="backhand",this.rotation=0))});let r,a=x.ANY;for(const s of e)s.direction!==x.ANY&&(a=s.direction),r&&a===x.ANY&&(a=Ps(s,r)),r=s;a!==x.ANY&&(this.rotation=$s[this.color][this.state][a])}predictStartState(e,i,n){const o=[...e,...i].sort((a,s)=>a.time-s.time);let r="neutral";for(let a=0,s=o.length;a<s;a++){if(o[a]instanceof ve){o[a].posY===Lt.BOTTOM&&(o[a].posX===n?ut.MIDDLE_RIGHT:ut.MIDDLE_LEFT)&&(r="backhand"),o[a].posY===Lt.TOP&&(o[a].posX===n?ut.MIDDLE_RIGHT:ut.MIDDLE_LEFT)&&(r="forehand");continue}let l=o[a];if(l.color!==Math.abs(n-1)&&l.color===n){if(r!=="neutral")break;const c=l.time;for(let h=a;h<o.length&&!(o[h].time>l.time+.001&&c<l.time+.001);h++){if(l=o[h],cn[l.color].forehand.includes(l.direction))return"backhand";if(cn[l.color].backhand.includes(l.direction))return"forehand";r==="neutral"&&l.direction===x.ANY&&(l.posY===Lt.BOTTOM&&(r="backhand"),l.posY>Lt.BOTTOM&&(r="forehand"))}break}}return r}predictStartRotation(e,i){let n=0;for(let o=0,r=e.length;o<r;o++){let a=e[o];if(a.color===i&&a.color===i){const s=a.time;for(let l=o;l<e.length&&!(e[l].time>a.time+.001&&s<a.time+.001);l++){if(a=e[l],a.direction!==x.ANY)return ui[a.color][a.direction];a.direction===x.ANY&&(a.posY===Lt.BOTTOM&&(a.posX===ut.LEFT&&(n=ui[a.color][6]),a.posX===ut.RIGHT&&(n=ui[a.color][7])),a.posY===Lt.MIDDLE&&(a.posX===ut.LEFT&&(n=ui[a.color][2]),a.posX===ut.RIGHT&&(n=ui[a.color][3])),a.posY===Lt.BOTTOM&&(a.posX===ut.LEFT&&(n=ui[a.color][4]),a.posX===ut.RIGHT&&(n=ui[a.color][5])))}break}}return n}predictStartPosition(e,i){return i?[-.5,1]:[.5,1]}}Object.defineProperty(ii,"CONSTRAINT_ROTATION",{enumerable:!0,configurable:!0,writable:!0,value:[[-155,195],[-195,155]]});var go;(function(t){t.duplicate="D",t.active="A",t.scale="S",t.position="P",t.localPosition="Lp",t.rotation="R",t.localRotation="Lr",t.lightID="Li",t.track="T"})(go||(go={}));var vo;(function(t){t.childrenTracks="Ct",t.color="C",t.definitePosition="Dp",t.dissolve="D",t.dissolveArrow="Da",t.duration="Dur",t.easing="E",t.interactable="I",t.localRotation="Lr",t.parentTrack="Pt",t.position="P",t.rotation="R",t.scale="S",t.time="T",t.track="Tr",t.worldPositionStays="Wps"})(vo||(vo={}));const zp={0:"Back Lasers",1:"Ring Lights",2:"Left Lasers",3:"Right Lasers",4:"Center Lights",5:"Boost Colors",6:"Extra Left Lights",7:"Extra Right Lights",8:"Ring Rotation",9:"Ring Zoom",10:"Extra Left Lasers",11:"Extra Right Lasers",12:"Left Laser Speed",13:"Right Laser Speed",14:"Early Lane Rotation",15:"Late Lane Rotation",16:"Utility Event 1",17:"Utility Event 2",18:"Utility Event 3",19:"Utility Event 4",40:"Special Event 1",41:"Special Event 2",42:"Special Event 3",43:"Special Event 4"},Vp={LinkinParkEnvironment:{0:"Lane Light",1:"Ceiling Lights",8:"Laser Mode"},BTSEnvironment:{0:"Door Light",1:"Vertical Pillar Lights",8:"Distant Tower Spin",9:"Raise/Lower Pillars",40:"BTS Event 1",41:"BTS Event 2",42:"BTS Event 3",43:"BTS Event 4"},KaleidoscopeEnvironment:{0:"Spike Tip Lights",1:"Spike Mid Lights",2:"Spike Left Lights",3:"Spike Right Lights",4:"Distant Lasers and Spike Top Lights"},InterscopeEnvironment:{0:"Gate 1",1:"Gate 2",2:"Gate 3",3:"Gate 4",4:"Gate 5",6:"Extra 1",7:"Extra 2"},SkrillexEnvironment:{0:"Logo",1:"Top Lanes and 1st Ring Set",4:"Bottom Lanes and 2nd Ring Set",6:"Left Panel",7:"Right Panel",12:"Left Laser & Panel Speed",13:"Right Laser & Panel Speed"},BillieEnvironment:{0:"Water 4",1:"Water 1",2:"Left Sun Beams",3:"Right Sun Beams",4:"Sun",6:"Water 2",7:"Water 3",8:"Toggle Rain",9:"Sunbeam Mode",10:"Left Bottom Lasers",11:"Right Bottom Lasers",12:"Left Sun Beams Speed",13:"Right Sun Beams Speed"},HalloweenEnvironment:{0:"Sky Lasers",1:"Moon",4:"Lane + Castle Interior"},GagaEnvironment:{0:"Aurora 1",1:"Aurora 2",2:"Tower 1",3:"Tower 2",4:"Logo",6:"Tower 3",7:"Tower 4",10:"Tower 5",11:"Tower 6",14:"Tower 1 Height",15:"Tower 2 Height",16:"Tower 3 Height",17:"Tower 4 Height",18:"Tower 5 Height",19:"Tower 6 Height"},WeaveEnvironment:{4:"Player Space"},PyroEnvironment:{0:"Video Alpha",1:"Logo",2:"Left Projectors",3:"Right Projectors",4:"Platform",6:"Ambient",40:"Video Projection"},EDMEnvironment:{0:"Lane Lights Bottom",1:"Lane Lights Top",4:"Player Space & Spectrogram"},TheSecondEnvironment:{0:"Logo",1:"Runway",2:"Left Flags",3:"Right Flags",4:"Buildings"},LizzoEnvironment:{0:"Runway Left",1:"Runway Right",2:"Left Ring",3:"Right Ring",4:"Top Square",6:"Ambient",7:"Cherry Left",8:"Cherry Right",9:"LI Sign",10:"Z Left Sign",11:"Z Right Sign",12:"O Sign",16:"Left Balloon Particles",17:"Right Balloon Particles"},TheWeekndEnvironment:{0:"Runway Left",1:"Runway Right",6:"Ambient"},RockMixtapeEnvironment:{3:"BG Bloom",4:"Aurora",6:"Ambient"},Dragons2Environment:{0:"Inner Laser Left",1:"Inner Laser Right",2:"Outer Laser Left",3:"Outer Laser Right",4:"Logo",6:"Ambient"},Panic2Environment:{3:"Ambient"},QueenEnvironment:{6:"Ambient",40:"Silhouettes"},LinkinPark2Environment:{3:"Ambient",40:"Logos",41:"Floor Logos"},TheRollingStonesEnvironment:{6:"Ambient",40:"Logo"},LatticeEnvironment:{6:"Ambient"},DaftPunkEnvironment:{6:"Ambient",40:"Helmet 01 Switch",41:"Helmet 02 Switch",42:"Helmet 01 Text",43:"Helmet 02 Text"},HipHopEnvironment:{6:"Ambient"},ColliderEnvironment:{6:"Ambient"},BritneyEnvironment:{6:"Ambient",8:"Player Place",9:"Dust Particles",12:"Icons"}};function Gp(t,e){var i;return((i=Vp[e])==null?void 0:i[t])||zp[t]||"Unknown"}const Hp={WeaveEnvironment:{0:"Outer Square Bottom Left Laser",1:"Outer Square Bottom Right Laser",2:"Outer Square Top Left Laser",3:"Outer Square Top Right Laser",4:"Inner Square Bottom Left Laser",5:"Inner Square Bottom Right Laser",6:"Inner Square Top Left Laser",7:"Inner Square Top Right Laser",8:"Side Square Bottom Left Laser",9:"Side Square Bottom Right Laser",10:"Side Square Top Left Laser",11:"Side Square Top Right Laser",12:"Distant Square Top Laser",13:"Distant Square Bottom Laser",14:"Distant Square Left Laser",15:"Distant Square Right Laser"},PyroEnvironment:{0:"Stage Left Platform",1:"Stage Right Platform",2:"Top Stage Left Laser",3:"Top Stage Right Laser",4:"Top Stage Middle Laser",5:"Top Stage Light",6:"Side Panels Left Tower",7:"Side Panels Right Tower",8:"Stage Left Laser",9:"Stage Right Laser",10:"Side Panels Left Laser",11:"Side Panels Right Laser",12:"Fire Left",13:"Fire Right"},EDMEnvironment:{0:"Circles Top",1:"Circles Close",2:"Circles Distant",3:"Circles Distant 2",4:"Single Source Circles Left",5:"Single Source Circles Right",6:"Single Source Lasers Left (Up)",7:"Single Source Lasers Left (Out)",8:"Single Source Lasers Right (Up)",9:"Single Source Lasers Right (Out)",10:"Single Source Lasers Left (Down)",11:"Single Source Lasers Right (Down)",12:"Single Source Lasers Left (Down) / Circle Rotations Top",13:"Single Source Lasers Right (Up) / Circle Rotations Close",14:"Circle Rotations Distant",15:"Circle Rotations Distant 2",16:"Circle Rotations Single Source Left",17:"Circle Rotations Single Source Right"},TheSecondEnvironment:{0:"Rings Big",1:"Rings Small",2:"Runway Left",3:"Runway Right",4:"Spotlight Left",5:"Spotlight Right",6:"Top Lasers Left Bottom",7:"Top Lasers Right Bottom",8:"Top Lasers Left Top",9:"Top Lasers Right Top",10:"Bottom Lasers Left Bottom",11:"Bottom Lasers Right Bottom",12:"Bottom Lasers Left Top",13:"Bottom Lasers Right Top"},LizzoEnvironment:{0:"Main Floor",1:"Rainbow Arcs Inner",2:"Rainbow Arcs 2",3:"Rainbow Arcs 3",4:"Rainbow Arcs 4",5:"Rainbow Arcs Outer",6:"Rainbow Rings Left",7:"Rainbow Rings Right",8:"Rainbow Rings Lasers Left",9:"Rainbow Rings Lasers Right",10:"Main Top Lasers",11:"Environment Stands Left",12:"Environment Stands Right",13:"Environment Clouds Left",14:"Environment Clouds Right",15:"Main Left Lasers",16:"Main Right Lasers",17:"Environment Stand Lasers Left",18:"Environment Stand Lasers Right",19:"Rainbow Arcs Laser"},TheWeekndEnvironment:{0:"Lamps Poles Left",1:"Lamps Poles Right",2:"Lamps Rings Left",3:"Lamps Rings Right",4:"Environment Arrows",5:"Environment Side Lasers Left",6:"Environment Side Lasers Right",7:"Environment Runway Lane",8:"Environment Center Ring",9:"Environment Center Ring Lasers",10:"Windows Left 1 Front",11:"Windows Left 1 Side",12:"Windows Left 2 Side",13:"Windows Left 3 Front",14:"Windows Left 3 Side",15:"Windows Right 1 Front",16:"Windows Right 1 Side",17:"Windows Right 2 Side",18:"Windows Right 3 Front",19:"Windows Right 3 Side",20:"Buildings Left",21:"Buildings Right",22:"Buildings Roof Left",23:"Buildings Roof Right",29:"Lamp Rings Left 1",30:"Lamp Rings Left 2",31:"Lamp Rings Left 3",32:"Lamp Rings Left 4",33:"Lamp Rings Right 1",34:"Lamp Rings Right 2",35:"Lamp Rings Right 3",36:"Lamp Rings Right 4",37:"Buildings Background Left",38:"Buildings Background Right",40:"Buildings Side Buildings"},RockMixtapeEnvironment:{0:"Lasers Far Left",1:"Lasers Far Right",2:"Mountain 1",3:"Mountain 2",4:"Mountain 3",5:"Mountain 4",6:"Mountain 5",7:"Mountain 6",8:"Mountain 7",9:"Mountain 8",10:"Mountain 9",11:"Mountain 10",12:"Mountain 11",13:"Mountain 12",14:"Face Eyes",15:"Runway Frets",16:"Runway Strings",17:"Runway Tunnel",18:"Lasers Side Left",19:"Lasers Side Right",20:"Lasers Side Left Rotation",21:"Lasers Side Right Rotation",22:"Face Left",23:"Face Right",24:"Spikes Left",25:"Spikes Left Movement",26:"Spikes Right",27:"Spikes Right Movement",28:"Runway Dots",29:"Face Movement",30:"Runway Equilizer",31:"Screens Left 1",32:"Screens Left 2",33:"Screens Right 1",34:"Screens Right 2",35:"Screens Left Movement",36:"Screens Right Movement",37:"Lasers Side Z Translation"},Dragons2Environment:{0:"Small Rings (R/T)",1:"Small Rings (Colors)",2:"Underground",3:"Big Rings",4:"Top Spotlights",5:"Runway Left",6:"Runway Right",7:"Particles Left",8:"Particles Right",9:"Main Lasers Bottom Left",10:"Main Lasers Top Left",11:"Main Lasers Top Right",12:"Main Lasers Bottom Right"},Panic2Environment:{0:"Left Cones Local",1:"Right Cones Local",2:"Left Cones Global",3:"Right Cones Global",4:"Center Cones Local",5:"Center Cones Global",6:"Diamond Rings Local Left",7:"Diamond Rings Local Right",8:"Diamond Rings Global",9:"Lasers Bottom Left",10:"Lasers Bottom Right",11:"Lasers Top Left",12:"Lasers Top Right",13:"Runway Lasers Left",14:"Runway Lasers Right",15:"Runway Inner Laser",16:"Spectrogram Left",17:"Spectrogram Right",18:"Runway Lasers Left Transform Z",19:"Runway Lasers Right Transform Z",20:"Window Left Pirces",21:"Window Left Aura",22:"Window Right Pieces",23:"Window Right Aura"},QueenEnvironment:{0:"Vinyls Left",1:"Vinyl Left 1",2:"Vinyl Left 2",3:"Vinyl Left 3",4:"Vinyl Left 4",5:"Vinyls Right",6:"Vinyl Right 1",7:"Vinyl Right 2",8:"Vinyl Right 3",9:"Vinyl Right 4",10:"Tunnel Rings Wrapper",11:"Distant Circular Lasers Z",12:"Distant Circular Lasers",13:"Top Circular Lasers Rot Y",14:"Top Circular Lasers",15:"Platform Lane Left",16:"Platform Lane Right",17:"Silhouette Contour"},LinkinPark2Environment:{0:"Circular Lasers Global Distant",1:"Circular Lasers Local Distant",2:"Circular Lasers Global Close",3:"Circular Lasers Local Close",4:"Tunnels Rings",5:"Big Arcs Local",6:"Laser Beams Local Left",7:"Laser Beams Local Right",8:"Floor Lasers Left",9:"Floor Lasers Right",10:"Tunnels Lights",11:"Logo",12:"Big Arcs Global",13:"Spectrograms Floor Left",14:"Spectrograms Floor Right",15:"Spectrograms Tunnel Left",16:"Spectrograms Tunnel Right",17:"Laser Beams Global Left",18:"Laser Beams Global Right"},TheRollingStonesEnvironment:{0:"Cube Local Left",1:"Cube Local Right",2:"Columns Left 01",3:"Columns Left 02",4:"Columns Left 03",5:"Columns Left 04",6:"Columns Right 01",7:"Columns Right 02",8:"Columns Right 03",9:"Columns Right 04",10:"Floor Blocks Left",11:"Floor Blocks Right",12:"Heart Local Left",13:"Heart Local Right",14:"Lasers Left 01",15:"Lasers Left 02",16:"Lasers Left 03",17:"Lasers Left 04",18:"Lasers Right 01",19:"Lasers Right 02",20:"Lasers Right 03",21:"Lasers Right 04",22:"Columns Lasers 01",23:"Columns Lasers 02",24:"Lasers Left Sphere",25:"Lasers Right Sphere",26:"Cube Global",27:"Heart Global",28:"Logo Local",29:"Logo Global",30:"Splinters",31:"Cube Rot Z Left",32:"Cube Rot Z Right",33:"Heart Rot Z Left",34:"Heart Rot Z Right",35:"Floor Side Laser Left",36:"Floor Side Laser Right",37:"Cube Lasers",38:"Splinters Global Translation",39:"Floor Below Block",40:"Floor Inner Light Left",41:"Floor Inner Light Right",42:"Logo Iridescence",43:"Logo Color",44:"Floor Side Laser Bottom Left",45:"Floor Side Laser Bottom Right"},LatticeEnvironment:{0:"Bottom Left Global",1:"Bottom Left Cube",2:"Bottom Left Radial",3:"Bottom Left Spot 1",4:"Bottom Left Spot 2",5:"Bottom Left Laser 1",6:"Bottom Left Laser 2",7:"Bottom Right Global",8:"Bottom Right Cube",9:"Bottom Right Radial",10:"Bottom Right Spot 1",11:"Bottom Right Spot 2",12:"Bottom Right Laser 1",13:"Bottom Right Laser 2",14:"Top Left Global",15:"Top Left Cube",16:"Top Left Radial",17:"Top Left Spot 1",18:"Top Left Spot 2",19:"Top Left Laser 1",20:"Top Left Laser 2",21:"Top Right Global",22:"Top Right Cube",23:"Top Right Radial",24:"Top Right Spot 1",25:"Top Right Spot 2",26:"Top Right Laser 1",27:"Top Right Laser 2",28:"Runway Diagonals",29:"Runway Outline",30:"Runway Chevron"},DaftPunkEnvironment:{0:"Tris Wall Left",1:"Tris Wall Right",2:"Lasers Top Sideset 01 L",3:"Lasers Top Sideset 02 L",4:"Lasers Top Sideset 01 R",5:"Lasers Top Sideset 02 R",6:"Lasers Bottom Sideset 01 L",7:"Lasers Bottom Sideset 02 L",8:"Lasers Bottom Sideset 01 R",9:"Lasers Bottom Sideset 02 R",10:"Lasers Top Wall L",11:"Lasers Top Wall R",12:"Lasers Bottom Wall L",13:"Lasers Bottom Wall R",14:"Orbit 1",15:"Orbit 2",16:"Orbit 3",17:"Orbit 4",18:"Runway Middle",19:"Visor 01 Spectrogram",20:"Visor 02 Spectrogram",21:"Visor 01 Text",22:"Visor 02 Text",23:"Helmet 01",24:"Helmet 02",25:"Runway Left",26:"Runway Right",27:"Background Stars",28:"Orbit 1 Star 1",29:"Orbit 1 Star 2",30:"Orbit 1 Star 3",31:"Orbit 1 Star 4",32:"Orbit 2 Star 1",33:"Orbit 2 Star 2",34:"Orbit 2 Star 3",35:"Orbit 2 Star 4",36:"Orbit 3 Star 1",37:"Orbit 3 Star 2",38:"Orbit 3 Star 3",39:"Orbit 3 Star 4",40:"Orbit 4 Star 1",41:"Orbit 4 Star 2",42:"Orbit 4 Star 3",43:"Orbit 4 Star 4",44:"Orbit 1 Stars Transform",45:"Orbit 2 Stars Transform",46:"Orbit 3 Stars Transform",47:"Orbit 4 Stars Transform",48:"Visor 02 Offset X",49:"Visor 02 Offset Y",50:"Visor 02 Padding X",51:"Visor 02 Padding Y",52:"Visor 01 Offset X",53:"Visor 01 Offset Y",54:"Visor 01 Padding X",55:"Visor 01 Padding Y"},HipHopEnvironment:{0:"Environment Side Lasers Left",1:"Environment Side Lasers Right",2:"Ceiling Lights Left",5:"Ceiling Lights Right",6:"Trains Long 1 Transforms",7:"Trains Long 1 Color",8:"Trains Long 2 Transforms",9:"Trains Long 2 Color",10:"Trains Short L Transforms",11:"Trains Short L Color",12:"Trains Short R Transforms",13:"Trains Short R Color",14:"Geo Walls",15:"Geo Roof",16:"Geo Platforms",17:"Geo Pillars Left",18:"Geo Pillars Right",19:"Environment Runway Ring",20:"Hoops L1",21:"Hoops Pieces L1",22:"Balls L1",23:"Hoops L2",24:"Hoops Pieces L2",25:"Balls L2",26:"Hoops R1",27:"Hoops Pieces R1",28:"Balls R1",29:"Hoops R2",30:"Hoops Pieces R2",31:"Balls R2",32:"Graffiti Floating Graffiti R",33:"Graffiti Floating Graffiti L",34:"Graffiti Boombox",35:"Graffiti Boombox Shards",36:"Environment Spectrogram Left",37:"Environment Spectrogram Right",38:"Trains Short L Graffiti",39:"Trains Short R Graffiti",40:"Environment Runway Lights",41:"Environment Spectrogram Y"},ColliderEnvironment:{0:"Center Blocks Local",1:"Center Blocks Global",2:"Center Blocks Inner Lasers",3:"Center Blocks Outer Lasers",4:"Center Blocks Side 01 Lasers",5:"Center Blocks Side 02 Lasers",6:"Colliders Diamonds",7:"Side Blocks Set 01 (Left) Local",8:"Side Blocks Set 02 (Right) Local",9:"Side Blocks Set 01 (Left) Global",10:"Side Blocks Set 02 (Right) Global",11:"Side Blocks Set 01 (Left) Inner Lasers",12:"Side Blocks Set 02 (Right) Inner Lasers",13:"Side Blocks Set 01 (Left) Outer Lasers",14:"Side Blocks Set 02 (Right) Outer Lasers",15:"Side Blocks Set 01 (Left) Side 01 Lasers",16:"Side Blocks Set 02 (Right) Side 01 Lasers",17:"Side Blocks Set 01 (Left) Side 02 Lasers",18:"Side Blocks Set 02 (Right) Side 02 Lasers",19:"Runway Left",20:"Runway Right",21:"Colliders Left",22:"Colliders Right",23:"Chevron Local",24:"Chevron Mask Strength",25:"Center Blocks Mask Strength",26:"Side Blocks Set 01 (Left) Mask Strength",27:"Side Blocks Set 02 (Right) Mask Strength"},BritneyEnvironment:{0:"Cubes Local Left",1:"Cubes Global Left",2:"Cubes Local Right",3:"Cubes Global Right",5:"Display Local",6:"Top Lasers Set 01 Global",7:"Top Lasers Set 01 Local",8:"Top Lasers Set 02 Global",9:"Top Lasers Set 02 Local",10:"Chevron",11:"Outer Cylinders Bottom Lasers",12:"Runway",13:"Stage Mask Offset",14:"Outer Cylinders Local",15:"Spirals Local",16:"Stage Top",17:"Stage Sides",18:"Cubes Speaker Lights L",19:"Cubes Speaker Lights R",20:"Display Mask Strength",21:"Stars Color",22:"Chevron Mask Strength"}};function Up(t,e){var i;return((i=Hp[e])==null?void 0:i[t])||"Unknown"}function Wp(t,e,i="DefaultEnvironment",n=2){var s;const o=((s=bi[i])==null?void 0:s[0])??bi.DefaultEnvironment[0],r={};for(let l=o.length-1;l>=0;l--)r[o[l]]={total:0,chroma:0,chromaOld:0};const a=n>=3?Sm:Em;r[5]={total:e.length,chroma:0,chromaOld:0};for(let l=t.length-1;l>=0;l--)t[l].isValidType()&&(r[t[l].type]||(r[t[l].type]={total:0,chroma:0,chromaOld:0}),r[t[l].type].total++,a(t[l])&&r[t[l].type].chroma++,t[l].isOldChroma()&&r[t[l].type].chromaOld++);return r}function hn(t,e="DefaultEnvironment"){var o;const i=((o=bi[e])==null?void 0:o[1])??bi.DefaultEnvironment[1],n={};for(let r=i.length-1;r>=0;r--)n[i[r]]={groups:0,boxes:0,bases:0};for(let r=t.length-1;r>=0;r--)n[t[r].id]||(n[t[r].id]={groups:0,boxes:0,bases:0}),n[t[r].id].groups++,n[t[r].id].boxes+=t[r].boxes.length,n[t[r].id].bases+=t[r].boxes.reduce((a,s)=>a+s.events.length,0);return n}function eo(t,e=2){const i={red:{total:0,chroma:0,noodleExtensions:0,mappingExtensions:0},blue:{total:0,chroma:0,noodleExtensions:0,mappingExtensions:0}},n=e>=3?wu:yu,o=e>=3?Su:Eu;for(let r=t.length-1;r>=0;r--){if(t[r].color!==0&&t[r].color!==1)continue;const a=t[r].color?"blue":"red";i[a].total++,n(t[r])&&i[a].chroma++,o(t[r])&&i[a].noodleExtensions++,Ru(t[r])&&i[a].mappingExtensions++}return i}function Yp(t,e=2){const i={total:0,chroma:0,noodleExtensions:0,mappingExtensions:0},n=e>=3?wu:yu,o=e>=3?Su:Eu;for(let r=t.length-1;r>=0;r--)i.total++,n(t[r])&&i.chroma++,o(t[r])&&i.noodleExtensions++,Tu(t[r])&&i.mappingExtensions++;return i}function mn(t,e){return t.filter(i=>i.posX===e).length}function Xp(t,e){return t.filter(i=>i.posY===e).length}function qp(t,e,i){return t.filter(n=>n.posX===e&&n.posY===i).length}function Kp(t,e){return t.filter(i=>i.direction===e).length}function Zp(t,e=2){const i={total:0,interactive:0,chroma:0,noodleExtensions:0,mappingExtensions:0},n=e>=3?Cm:Dm,o=e>=3?Tm:wm,r=e>=3?Cu:Du;for(let a=t.length-1;a>-1;a--)i.total++,t[a].isInteractive()&&i.interactive++,n(t[a])&&i.chroma++,o(t[a])&&i.noodleExtensions++,r(t[a])&&i.mappingExtensions++;return i}function Jp(t){return Math.max(...t.map(e=>e.ebpm),0)}function Qp(t){return Math.max(...t.map(e=>e.ebpmSwing),0)}function td(t,e){const i=[];let n=0,o=0,r,a;const s={},l={},c={0:[],1:[]};for(const h of t)r=0,a=Number.MAX_SAFE_INTEGER,l[h.color]?ce(h,l[h.color],e,c[h.color])&&(r=Fs(c[h.color],e),a=js(c[h.color],e),r>0&&a!==1/0||(r=0,a=0),o=Ms(h,s[h.color],e),n=Ms(h,l[h.color],e),i.push({time:s[h.color].time,duration:l[h.color].time-s[h.color].time,data:c[h.color],ebpm:n,ebpmSwing:o,maxSpeed:a,minSpeed:r}),s[h.color]=h,c[h.color]=[]):s[h.color]=h,l[h.color]=h,c[h.color].push(h);for(let h=0;h<2;h++)l[h]&&(r=Fs(c[h],e),a=js(c[h],e),r>0&&a!==1/0||(r=0,a=0),i.push({time:s[h].time,duration:l[h].time-s[h].time,data:c[h],ebpm:n,ebpmSwing:o,maxSpeed:a,minSpeed:r}));return i}function ce(t,e,i,n){if(n&&n.length>0&&i.toRealTime(e.time)+.005<i.toRealTime(t.time)&&t.direction!==x.ANY){for(const o of n)if(o.direction!==x.ANY&&Yi(t,o,90,!1))return!0}if(n&&n.length>0){for(const o of n)if(t.isInline(o))return!0}return t.isWindow(e)&&i.toRealTime(t.time-e.time)>.08||i.toRealTime(t.time-e.time)>.07}function Ms(t,e,i){return i.bpm/(i.toBeatTime(i.toRealTime(t.time)-i.toRealTime(e.time),!1)*2)}function Fs(t,e){let i=!1,n=!1,o=0;const r=e.toRealTime(Math.max(...t.map((a,s)=>s===0?0:((t[s].isHorizontal(t[s-1])||t[s].isVertical(t[s-1]))&&!i&&(i=!0,o=(t[s].time-t[s-1].time)/(t[s].getDistance(t[s-1])||1)),n=t[s].isDiagonal(t[s-1])||t[s].isSlantedWindow(t[s-1])||n,(t[s].time-t[s-1].time)/(t[s].getDistance(t[s-1])||1)))));return i&&n?e.toRealTime(o):r}function js(t,e){let i=!1,n=!1,o=Number.MAX_SAFE_INTEGER;const r=e.toRealTime(Math.min(...t.map((a,s)=>s===0?Number.MAX_SAFE_INTEGER:((t[s].isHorizontal(t[s-1])||t[s].isVertical(t[s-1]))&&!i&&(i=!0,o=(t[s].time-t[s-1].time)/(t[s].getDistance(t[s-1])||1)),n=t[s].isDiagonal(t[s-1])||t[s].isSlantedWindow(t[s-1])||n,(t[s].time-t[s-1].time)/(t[s].getDistance(t[s-1])||1)))));return i&&n?e.toRealTime(o):r}function ed(t,e,i){const n={left:new Array(Math.floor(e+1)).fill(0),right:new Array(Math.floor(e+1)).fill(0)};let o,r;for(const a of t){const s=i.toRealTime(a.time);a.color===0&&(o?ce(a,o,i)&&n.left[Math.floor(s)]++:n.left[Math.floor(s)]++,o=a),a.color===1&&(r?ce(a,r,i)&&n.right[Math.floor(s)]++:n.right[Math.floor(s)]++,r=a)}return n}function io(t,e){if(!t.length)return 0;if(t.length<e)return t.reduce((o,r)=>o+r)/t.length;let i=t.slice(0,e).reduce((o,r)=>o+r),n=i;for(let o=0;o<t.length-e;o++)i=i-t[o]+t[o+e],n=Math.max(n,i);return n/e}function id(t,e,i,n){const r={characteristic:i,difficulty:n,red:{perSecond:0,peak:0,median:0,total:0},blue:{perSecond:0,peak:0,median:0,total:0},total:{perSecond:0,peak:0,median:0,total:0},container:td(t.colorNotes,e)},a=Math.max(e.toRealTime(Wi(t)-wo(t)),0),s=Math.max(e.toRealTime(Wi(t)),0),l=ed(t.colorNotes,s,e),c=l.left.map((u,m)=>u+l.right[m]);if(c.reduce((u,m)=>u+m)===0)return r;const h=[],p=[],d=[];for(let u=0,m=Math.ceil(c.length/10);u<m;u++){const b=u*10;let y=10;y+b>c.length&&(y=c.length-b);const v=l.left.slice(b,b+y),_=l.right.slice(b,b+y),w=c.slice(b,b+y);h.push(v.reduce((C,T)=>C+T)/y),p.push(_.reduce((C,T)=>C+T)/y),d.push(w.reduce((C,T)=>C+T)/y)}return r.red.total=l.left.reduce((u,m)=>u+m),r.red.perSecond=l.left.reduce((u,m)=>u+m)/a,r.red.peak=io(l.left,10),r.red.median=Yn(h),r.blue.total=l.right.reduce((u,m)=>u+m),r.blue.perSecond=l.right.reduce((u,m)=>u+m)/a,r.blue.peak=io(l.right,10),r.blue.median=Yn(p),r.total.total=r.red.total+r.blue.total,r.total.perSecond=c.reduce((u,m)=>u+m)/a,r.total.peak=io(c,10),r.total.median=Yn(d),r}function nd(t,e){let i=0,n=0,o;for(const r of t){const a=r.total.perSecond;if(n>0&&a>0&&(i=Math.abs(1-n/a)*100),n=a>0?a:n,n>e&&i>40)return{result:r,comparedTo:o};o=r}return null}function od(t,e){let i=Number.MAX_SAFE_INTEGER,n=0,o;for(const r of t){const a=r.total.perSecond;if(n>0&&a>0&&(i=Math.abs(1-n/a)*100),n=a>0?a:n,n>e&&i<10)return{result:r,comparedTo:o};o=r}return null}function rd(t){let e=0,i=Number.MAX_SAFE_INTEGER;return t.forEach(n=>{const o=n.total.perSecond;o>0&&(e=Math.max(e,o),i=Math.min(i,o))}),e||e&&i?(1-i/e)*100:0}function zs(t){return Math.min(...t.map(e=>e.total.perSecond),Number.MAX_SAFE_INTEGER)}function Vs(t){return Math.max(...t.map(e=>e.total.perSecond),0)}function sd(t){return Math.max(...t.map(e=>e.minSpeed),0)}function ad(t){const e=t.map(i=>i.maxSpeed).filter(i=>i!==0);return e.length?Math.min(...e):0}function qu(t,e){if(t==null||!t.length){Ft(As);return}const i=t.map((n,o)=>{var p,d;let r=n.b??n._time??0,a;e&&(r=e.adjustTime(r),a=e.toRealTime(r));const s=[],l=n.d??n._data;if(!l)return`Error parsing customEvents[${o}]`;for(const u in l){if(u=="_duration"||u=="_easing"||u=="_track"||u=="duration"||u=="easing"||u=="track")continue;const m=vo[u];l[u]!=null&&s.push(m)}const c=n.t??n._type,h=((p=n.d)==null?void 0:p.track)??((d=n._data)==null?void 0:d._track);return`${M(r,it.rounding)}${a?" | "+Zt(a):""} -- ${c} -> [${s.join("")}]${c!=="AssignTrackParent"?`(${h})`:""}`});jt(As,i,"customEvents")}function Ku(t){if(t==null||!t.length){Ft(Ns);return}const e=t.map((i,n)=>{const o=[];if(!i.id&&!i.geometry&&!i._id&&!i._geometry)return`Error parsing environment[${n}]`;for(const l in i){if(l=="lookupMethod"||l=="id"||l=="geometry"||l=="_lookupMethod"||l=="_id"||l=="_geometry")continue;const c=go[l];i[l]!=null&&o.push(c)}const r=i.geometry||i._geometry,a=i.track||i._track,s=i.id||i._id;return`${r?"Geometry":i.lookupMethod||i._lookupMethod} [${o.join("")}]${a?`(${a})`:""} -> ${r?r.type||r._type:s}`});jt(Ns,e,"environments")}function Zu(t){if(t==null){Ft(_s);return}jt(_s,t)}function Ju(t){if(t==null||!t.length){Ft(ys);return}let e=t.join(", ");jt(ys,e)}function Qu(t){if(t==null||!t.length){Ft(Es);return}let e=t.join(", ");jt(Es,e)}function tc(t){if(t==null){Ft(Ds);return}let e=(fo[t]||"Unknown")+" Environment";fo[t]||(e+=` (${t})`),jt(Ds,e)}function ec(t){if(t==null){Ft(Ss);return}jt(Ss,Mh(t))}function ic(t){if(t==null||!t.length){Ft(Rs);return}jt(Rs,t,"requirements")}function nc(t){if(t==null||!t.length){Ft(ks);return}jt(ks,t,"suggestions")}function oc(t){if(t==null||!t.length){Ft(Ls);return}jt(Ls,t,"informations")}function rc(t){if(t==null||!t.length){Ft(Bs);return}jt(Bs,t,"warnings")}function sc(t){if(t==null){Ft(Is);return}const e=[];if(Array.isArray(t))for(const i of t)i||e.push("Error parsing pointDefinitions"),e.push(`${i._name} -- ${i._points.length} point${i._points.length>1?"s":""}`);else{t=t;for(const i in t){t[i]||e.push(`Error parsing pointDefinitions[${i}]`);const n=t[i];Array.isArray(n)||e.push(`Error parsing pointDefinitions[${i}]`),e.push(`${i} -- ${n.length} point${n.length>1?"s":""}`)}}jt(Is,e,"pointDefinitions")}const $e=new class{constructor(){this.loading={nested:!1,info:!1,difficulty:!1,analysis:!1,audio:!1,coverImage:!1,contributorImage:!1,finished:!1}}resetLoad(){this.loading.nested=!1,this.loading.info=!1,this.loading.difficulty=!1,this.loading.analysis=!1,this.loading.audio=!1,this.loading.coverImage=!1,this.loading.contributorImage=!1,this.loading.finished=!1}},mt=new class{constructor(){this.beatmapInfo=null,this.beatmaps=[],this.contributors=[],this.analysis=null,this.duration=null}clear(){$e.loading.finished=!1,this.beatmapInfo=null,this.beatmaps=[],this.contributors=[],this.analysis=null,this.duration=null}};function ac(t,e){if(t==null||e==null){Ft(ws);return}jt(ws,`${Zt(t)} to ${Zt(e)}${mt.duration?` -- [ ${Zt(e-t)} / ${Zt(mt.duration)} ]`:""}`)}function lc(t){if(!t||!t.saberLeftColor&&!t.saberRightColor&&!t.environment0Color&&!t.environment0ColorBoost&&!t.environment1Color&&!t.environment1ColorBoost&&!t.environmentWColor&&!t.environmentWColorBoost&&!t.obstaclesColor){Ft(Cs);return}const e={};e.saberLeftColor=pt(t.saberLeftColor),e.saberRightColor=pt(t.saberRightColor),e.environment0Color=pt(t.environment0Color),e.environment1Color=pt(t.environment1Color),e.environment0ColorBoost=pt(t.environment0ColorBoost),e.environment1ColorBoost=pt(t.environment1ColorBoost),e.obstaclesColor=pt(t.obstaclesColor),t.environmentWColor&&(e.environmentWColor=pt(t.environmentWColor)),t.environmentWColorBoost&&(e.environmentWColorBoost=pt(t.environmentWColorBoost));const i=[];for(const n in e){if(!e[n])continue;const o=document.createElement("div"),r=document.createElement("div"),a=document.createElement("div"),s=document.createElement("div");o.className="info__color",r.className="info__color-dot",r.style.backgroundColor=e[n]||"#000000",a.className="info__color-text info__color-text--monospace",a.textContent=`${e[n]}`,s.className="info__color-text",s.textContent=` -- ${em[n]}`,o.appendChild(r),o.appendChild(a),o.appendChild(s),i.push(o)}jt(Cs,i)}function ld(t){At.setSongName(t.song.title),At.setSongSubname(t.song.subTitle),At.setSongAuthor(t.song.author),At.setSongBPM(t.audio.bpm);const e=new Set,i=new Set,n=new Set([t.environmentBase.normal,t.environmentBase.allDirections]);t.difficulties.forEach(o=>{o.authors.mappers.forEach(r=>e.add(r)),o.authors.lighters.forEach(r=>i.add(r)),n.add(t.environmentNames.at(o.environmentId))}),ju([...e],[...i]),zu([...n].filter(o=>o)),Vu(t.customData._editors)}function uc(t,e){Zu(e.rawData._version||e.rawData.version||"Unknown"),Ju(e.settings.authors.mappers),Qu(e.settings.authors.lighters),tc(t.environmentNames.at(e.settings.environmentId)),lc(t.colorSchemes.at(e.settings.colorSchemeId)),Yu(e.settings.customData),ic(e.settings.customData._requirements),nc(e.settings.customData._suggestions),oc(e.settings.customData._information),rc(e.settings.customData._warnings);const i=e.timeProcessor;ec(e.data.difficulty.customData.time??e.data.difficulty.customData._time),Uu(e.data.difficulty.customData.bookmarks??e.data.difficulty.customData._bookmarks,i),Wu(i),Ku(e.data.difficulty.customData.environment??e.data.difficulty.customData._environment),sc(e.data.difficulty.customData.pointDefinitions??e.data.difficulty.customData._pointDefinitions),qu(e.data.difficulty.customData.customEvents??e.data.difficulty.customData._customEvents,i),ac(e.timeProcessor.toRealTime(wo(e.data)),e.timeProcessor.toRealTime(Wi(e.data)))}function ud(){ju(),zu(),Vu(),Gu(),Zu(),Ju(),Qu(),tc(),ac(),ec(),lc(),Yu(),ic(),nc(),oc(),rc(),Uu(),Wu(),Ku(),sc(),qu()}const fn={enable:t=>{document.querySelectorAll(".input-toggle").forEach(i=>{i.disabled=!t})}},Mi=document.querySelector(".loading__bar"),Gs="loading__bar--error",Hs="loading__bar--download",cd=document.querySelector(".loading__text");function cc(t,e,i=100){cd.textContent=e,Mi.style.width=`${i}%`,t==="error"?Mi.classList.add(Gs):Mi.classList.remove(Gs),t==="download"?Mi.classList.add(Hs):Mi.classList.remove(Hs)}function hd(){cc("info","No map loaded",0)}const Ct={status:cc,reset:hd};var dt=(t=>(t[t.APRIL_FOOLS=0]="APRIL_FOOLS",t[t.GENERAL_ZIP=1]="GENERAL_ZIP",t[t.GENERAL_AUDIO=2]="GENERAL_AUDIO",t[t.GENERAL_COVER_IMAGE=3]="GENERAL_COVER_IMAGE",t[t.GENERAL_PREVIEW_TIME=4]="GENERAL_PREVIEW_TIME",t[t.GENERAL_PROGRESSION=5]="GENERAL_PROGRESSION",t[t.OTHERS_INVALID_OBJECT=6]="OTHERS_INVALID_OBJECT",t[t.OTHERS_OUTSIDE_PLAYABLE=7]="OTHERS_OUTSIDE_PLAYABLE",t[t.OTHERS_HOT_START=8]="OTHERS_HOT_START",t[t.OTHERS_NJS=9]="OTHERS_NJS",t[t.OTHERS_DIFFICULTY_LABEL=10]="OTHERS_DIFFICULTY_LABEL",t[t.EVENTS_INSUFFICIENT_LIGHT=11]="EVENTS_INSUFFICIENT_LIGHT",t[t.EVENTS_INVALID_EVENT_BOX=12]="EVENTS_INVALID_EVENT_BOX",t[t.EVENTS_UNLIT_BOMB=13]="EVENTS_UNLIT_BOMB",t[t.NOTES_EFFECTIVE_BPM=14]="NOTES_EFFECTIVE_BPM",t[t.NOTES_ACCEPTABLE_PRECISION=15]="NOTES_ACCEPTABLE_PRECISION",t[t.NOTES_PARITY=16]="NOTES_PARITY",t[t.NOTES_VARY_SWING=17]="NOTES_VARY_SWING",t[t.NOTES_SLOW_SLIDER=18]="NOTES_SLOW_SLIDER",t[t.NOTES_INLINE_ANGLE=19]="NOTES_INLINE_ANGLE",t[t.NOTES_SHRADO_ANGLE=20]="NOTES_SHRADO_ANGLE",t[t.NOTES_SPEED_PAUSE=21]="NOTES_SPEED_PAUSE",t[t.NOTES_IMPROPER_ARC=22]="NOTES_IMPROPER_ARC",t[t.NOTES_IMPROPER_CHAIN=23]="NOTES_IMPROPER_CHAIN",t[t.NOTES_IMPROPER_WINDOW=24]="NOTES_IMPROPER_WINDOW",t[t.NOTES_HITBOX_STAIR=25]="NOTES_HITBOX_STAIR",t[t.NOTES_HITBOX_REVERSE_STAIR=26]="NOTES_HITBOX_REVERSE_STAIR",t[t.NOTES_HITBOX_INLINE=27]="NOTES_HITBOX_INLINE",t[t.NOTES_HITBOX_PATH=28]="NOTES_HITBOX_PATH",t[t.NOTES_ONE_SABER=29]="NOTES_ONE_SABER",t[t.NOTES_COLOR_CHECK=30]="NOTES_COLOR_CHECK",t[t.NOTES_STACKED_NOTE=31]="NOTES_STACKED_NOTE",t[t.NOTES_DOUBLE_DIRECTIONAL=32]="NOTES_DOUBLE_DIRECTIONAL",t[t.NOTES_VISION_BLOCK=33]="NOTES_VISION_BLOCK",t[t.OBSTACLES_SHORT=34]="OBSTACLES_SHORT",t[t.OBSTACLES_CENTER=35]="OBSTACLES_CENTER",t[t.OBSTACLES_ZERO=36]="OBSTACLES_ZERO",t[t.OBSTACLES_NEGATIVE=37]="OBSTACLES_NEGATIVE",t))(dt||{}),bt=(t=>(t[t.APRIL_FOOLS=0]="APRIL_FOOLS",t[t.GENERAL_ZIP=1]="GENERAL_ZIP",t[t.GENERAL_AUDIO=2]="GENERAL_AUDIO",t[t.GENERAL_COVER_IMAGE=3]="GENERAL_COVER_IMAGE",t[t.GENERAL_PREVIEW_TIME=4]="GENERAL_PREVIEW_TIME",t[t.GENERAL_PROGRESSION=5]="GENERAL_PROGRESSION",t[t.OTHERS_INVALID_OBJECT=6]="OTHERS_INVALID_OBJECT",t[t.OTHERS_OUTSIDE_PLAYABLE=7]="OTHERS_OUTSIDE_PLAYABLE",t[t.OTHERS_HOT_START=8]="OTHERS_HOT_START",t[t.OTHERS_NJS=9]="OTHERS_NJS",t[t.OTHERS_DIFFICULTY_LABEL=10]="OTHERS_DIFFICULTY_LABEL",t[t.EVENTS_INSUFFICIENT_LIGHT=11]="EVENTS_INSUFFICIENT_LIGHT",t[t.EVENTS_INVALID_EVENT_BOX=12]="EVENTS_INVALID_EVENT_BOX",t[t.EVENTS_UNLIT_BOMB=13]="EVENTS_UNLIT_BOMB",t[t.NOTES_ONE_SABER=14]="NOTES_ONE_SABER",t[t.NOTES_COLOR_CHECK=15]="NOTES_COLOR_CHECK",t[t.NOTES_EFFECTIVE_BPM=16]="NOTES_EFFECTIVE_BPM",t[t.NOTES_ACCEPTABLE_PRECISION=17]="NOTES_ACCEPTABLE_PRECISION",t[t.NOTES_PARITY=18]="NOTES_PARITY",t[t.NOTES_VARY_SWING=19]="NOTES_VARY_SWING",t[t.NOTES_SLOW_SLIDER=20]="NOTES_SLOW_SLIDER",t[t.NOTES_INLINE_ANGLE=21]="NOTES_INLINE_ANGLE",t[t.NOTES_SHRADO_ANGLE=22]="NOTES_SHRADO_ANGLE",t[t.NOTES_SPEED_PAUSE=23]="NOTES_SPEED_PAUSE",t[t.NOTES_IMPROPER_ARC=24]="NOTES_IMPROPER_ARC",t[t.NOTES_IMPROPER_CHAIN=25]="NOTES_IMPROPER_CHAIN",t[t.NOTES_IMPROPER_WINDOW=26]="NOTES_IMPROPER_WINDOW",t[t.NOTES_HITBOX_STAIR=27]="NOTES_HITBOX_STAIR",t[t.NOTES_HITBOX_REVERSE_STAIR=28]="NOTES_HITBOX_REVERSE_STAIR",t[t.NOTES_HITBOX_INLINE=29]="NOTES_HITBOX_INLINE",t[t.NOTES_HITBOX_PATH=30]="NOTES_HITBOX_PATH",t[t.NOTES_STACKED_NOTE=31]="NOTES_STACKED_NOTE",t[t.NOTES_DOUBLE_DIRECTIONAL=32]="NOTES_DOUBLE_DIRECTIONAL",t[t.NOTES_VISION_BLOCK=33]="NOTES_VISION_BLOCK",t[t.OBSTACLES_SHORT=34]="OBSTACLES_SHORT",t[t.OBSTACLES_CENTER=35]="OBSTACLES_CENTER",t[t.OBSTACLES_ZERO=36]="OBSTACLES_ZERO",t[t.OBSTACLES_NEGATIVE=37]="OBSTACLES_NEGATIVE",t))(bt||{}),hc=(t=>(t.tiny="panel--tiny",t["x-small"]="panel--x-small",t.small="panel--small",t.medium="panel--medium",t.large="panel--large",t["x-large"]="panel--x-large",t.max="panel--max",t))(hc||{}),mc=(t=>(t.normal="panel--offset",t.half="panel--offset-half",t.none="",t))(mc||{});const md="April Fools",fd="xdd.",pd=!0,dd={name:md,description:fd,type:"general",order:{input:dt.APRIL_FOOLS,output:bt.APRIL_FOOLS},input:{enabled:pd,params:{}},run:bd};function bd(t){const e=new Date("01 April 1984"),i=new Date,n=e.getDate()===i.getDate()&&e.getMonth()===i.getMonth();if(!it.aprilFooled&&n){const o=document.createElement("div"),r=document.createElement("a");return r.text="this link for more info.",r.href="https://youtu.be/dQw4w9WgXcQ",r.addEventListener("click",function(){it.aprilFooled=!0,it.save()}),o.innerHTML='<b><span title="Info: no action necessary, take note."> ⚠️ </span>AI generated content detected:</b> this may violate TOS, please refer to ',o.append(r),[{type:"html",label:"",value:[o]}]}return[]}let pn=0;const U={createBlock:function(...t){const e=document.createElement("div");for(const i of t)if(Array.isArray(i))for(const n of i)e.append(n);else e.appendChild(i);return e},createText:function(t,e,i){const n=`input-${pn++}`,o=document.createElement("input"),r=document.createElement("label");return o.id="input__gen-"+n,o.className="input-toggle input--small",o.type="text",o.value=i,o.addEventListener("change",t),e&&(r.textContent=e,r.htmlFor="input__gen-"+n),[o,r]},createNumber:function(t,e,i,n,o,r){const a=`input-${pn++}`,s=document.createElement("input"),l=document.createElement("label");return s.id="input__gen-"+a,s.className="input-toggle input--small",s.type="text",s.value=i.toString(),s.addEventListener("change",t),e&&(l.textContent=e,l.htmlFor="input__gen-"+a),typeof n=="number"&&(s.min=n.toString()),typeof o=="number"&&(s.max=o.toString()),typeof r=="number"&&(s.step=r.toString()),[l,s]},createCheckbox:function(t,e,i,n){const o=`input-${pn++}`,r=document.createElement("input"),a=document.createElement("label");return a.textContent=" "+e,a.title=i,a.htmlFor="input__gen-"+o,r.id="input__gen-"+o,r.className="input-toggle",r.type="checkbox",r.checked=n,r.addEventListener("change",t),[r,a]},createRadio:function(t,e,i,n,o){const r=`input-${pn++}`,a=document.createElement("input"),s=document.createElement("label");return s.textContent=e,s.htmlFor="input__gen-"+r,a.id="input__gen-"+r,a.name=i,a.className="input-toggle",a.type="radio",a.checked=o,a.value=n,a.addEventListener("change",t),[s,a]}},Us="Beatmap ZIP",Ws="Entrypoint not in root directory.",Ys=!0,fc={name:Us,description:Ws,type:"general",order:{input:dt.GENERAL_ZIP,output:bt.GENERAL_ZIP},input:{enabled:Ys,params:{},html:U.createBlock(U.createCheckbox(function(){fc.input.enabled=this.checked},Us,Ws,Ys))},run:gd};function gd(t){return $e.loading.nested?[{type:"string",label:"Beatmap in folder ZIP",value:"Info file and the rest should be in the root of zip file.",symbol:"error"}]:[]}const Xs="Audio Duration",qs="For ranking purpose, check for audio duration.",Ks=!0,pc={name:Xs,description:qs,type:"general",order:{input:dt.GENERAL_AUDIO,output:bt.GENERAL_AUDIO},input:{enabled:Ks,params:{},html:U.createBlock(U.createCheckbox(function(){pc.input.enabled=this.checked},Xs,qs,Ks))},run:vd};function vd(t){const e=t.audioDuration;return e&&e<20?[{type:"string",label:"Unrankable audio length",value:`too short (${Zt(e)}s)`,symbol:"rank"}]:$e.loading.audio?[]:[{type:"string",label:"No audio",value:it.load.audio?"could not be loaded or not found":"no audio mode is enabled"}]}const Zs="Validate Cover Image",Js="Validate cover image.",Qs=!0,dc={name:Zs,description:Js,type:"general",order:{input:dt.GENERAL_COVER_IMAGE,output:bt.GENERAL_COVER_IMAGE},input:{enabled:Qs,params:{},html:U.createBlock(U.createCheckbox(function(){dc.input.enabled=this.checked},Zs,Js,Qs))},run:_d};function _d(){const t=new Image,e=At.getCoverImage(),i=[];return $e.loading.coverImage&&e!==null?(t.src=e,t.width!==t.height&&i.push({type:"string",label:"Cover image is not square",value:"resize to fit square",symbol:"error"}),(t.width<256||t.height<256)&&i.push({type:"string",label:"Cover image is too small",value:"require at least 256x256",symbol:"error"})):i.push({type:"string",label:"No cover image",value:it.load.imageCover?"could not be loaded or found":"no cover image option is enabled"}),i}const ta="Preview Time",ea="Warn default editor preview time.",ia=!0,bc={name:ta,description:ea,type:"general",order:{input:dt.GENERAL_PREVIEW_TIME,output:bt.GENERAL_PREVIEW_TIME},input:{enabled:ia,params:{},html:U.createBlock(U.createCheckbox(function(){bc.input.enabled=this.checked},ta,ea,ia))},run:yd};function yd(t){const{previewStartTime:e,previewDuration:i}=t.info.audio;return e===12&&i===10?[{type:"string",label:"Default preview time",value:"strongly recommended to set for audience's 1st impression",symbol:"info"}]:[]}const na="Difficulty Progression",oa="For ranking purpose, check difficuly progression to fit rankability criteria.",ra=!0,gc=document.createElement("ul"),Ed=["ExpertPlus","Expert","Hard","Normal","Easy"];for(const t of Ed)gc.appendChild(U.createBlock(U.createCheckbox(function(){Gn.input.params[t]=this.checked},ei[t],`Toggle check progression for Standard ${ei[t]}`,!0)));const Gn={name:na,description:oa,type:"general",order:{input:dt.GENERAL_PROGRESSION,output:bt.GENERAL_PROGRESSION},input:{enabled:ra,params:{"Expert+":!0,ExpertPlus:!0,Expert:!0,Hard:!0,Normal:!0,Easy:!0},html:U.createBlock(U.createBlock(U.createCheckbox(function(){Gn.input.enabled=this.checked},na,oa,ra)),gc)},run:Dd};function Dd(t){var s,l,c,h,p,d,u,m;const e=t.audioDuration;if(!e)return[];const i=mt.beatmaps.filter(b=>b.settings.characteristic==="Standard").map(b=>b.swingAnalysis).filter(b=>Gn.input.params[b.difficulty]&&b.total.total>0).sort((b,y)=>y.total.perSecond-b.total.perSecond);if(!i.length)return[];const n=Math.max(e<120?3.2:e<240?4.2:5.2,M(Vs(i)*.4,2)),o=[];e<360&&zs(i)>n&&(i.forEach(b=>b.total.perSecond),o.push({type:"string",label:`Minimum SPS not met (<${n})`,value:`lowest SPS is ${M(zs(i),2)}, ${M(rd(i),2)}% drop from highest SPS (${M(Vs(i),2)})`,symbol:"rank"}));const r=nd(i,n),a=od(i,n);return r&&e<360&&o.push({type:"string",label:"Violates progression",value:`${ei[r.result.difficulty]} exceeded 40% SPS drop, ${M(r.result.total.perSecond,2)} from ${M(((l=(s=r.comparedTo)==null?void 0:s.total)==null?void 0:l.perSecond)||0,2)} ${ei[r.comparedTo.difficulty]}, acceptable range (${M((((h=(c=r.comparedTo)==null?void 0:c.total)==null?void 0:h.perSecond)||0)*.6,2)}-${M((((p=r.comparedTo)==null?void 0:p.total.perSecond)||0)*.9,2)})`,symbol:"rank"}),a&&e<360&&o.push({type:"string",label:"Violates progression",value:`${ei[a.result.difficulty]} has less than 10% SPS drop, ${M(a.result.total.perSecond,2)} from ${M(((d=a.comparedTo)==null?void 0:d.total.perSecond)||0,2)} ${ei[a.comparedTo.difficulty]}, acceptable range (${M((((u=a.comparedTo)==null?void 0:u.total.perSecond)||0)*.6,2)}-${M((((m=a.comparedTo)==null?void 0:m.total.perSecond)||0)*.9,2)})`,symbol:"rank"}),o}const sa=Object.freeze(Object.defineProperty({__proto__:null,aprilFools:dd,audio:pc,coverImage:dc,previewTime:bc,progression:Gn,zip:fc},Symbol.toStringTag,{value:"Module"})),aa="Acceptable Beat Precision",la=`Validate note timing placement is within timing precision.
i.e: 1/8 1/6 1/x`,ua=!0,ca=[8,6],Vi={name:aa,description:la,type:"note",order:{input:dt.NOTES_ACCEPTABLE_PRECISION,output:bt.NOTES_ACCEPTABLE_PRECISION},input:{enabled:ua,params:{prec:[...ca]},html:U.createBlock(U.createCheckbox(function(){Vi.input.enabled=this.checked},aa+": ",la,ua),U.createText(function(){Vi.input.params.prec=this.value.trim().split(" ").map(t=>parseInt(t)).filter(t=>t>0?!Number.isNaN(t):!1),this.value=Vi.input.params.prec.join(" ")},"",ca.join(" ")))},run:Sd};function wd(t){const e=t.swingAnalysis.container,{prec:i}=Vi.input.params;return e.map(n=>n.data.sort(xt)[0]).filter(n=>{if(!i.length)return!1;const o=n.customData.__mapcheck_beattime;for(let r=0;r<i.length;r++)if((o+.001)%(1/i[r])<.01)return!1;return!0})}function Sd(t){const e=wd(t.beatmap);return e.length?[{type:"time",label:"Off-beat precision",value:e,symbol:"warning"}]:[]}const ha="Color Check",ma="Compare note color with other colored note and the arrow on itself.",fa=!0,pa=[1,1,1],da={1:"Indistinguishable",5:"Hardly perceivable",10:"Close apparent",20:"Mildly similar",40:"Different",90:"Discernible",100:"Opposite"};function ba(t,e){let i=Object.keys(t).find(o=>parseFloat(o)>=e)??"100",n=parseFloat(i);return t[n]}const vc={name:ha,description:ma,type:"note",order:{input:dt.NOTES_COLOR_CHECK,output:bt.NOTES_COLOR_CHECK},input:{enabled:fa,params:{},html:U.createBlock(U.createCheckbox(function(){vc.input.enabled=this.checked},ha+" (EXPERIMENTAL)",ma,fa))},run:Rd};function Cd(t){var o,r,a,s;const e=t.info.colorSchemes[t.beatmap.settings.colorSchemeId],i=((r=(o=t.beatmap)==null?void 0:o.settings.customData)==null?void 0:r._colorLeft)??e.saberLeftColor??ge[be[t.beatmap.environment]??"The First"]._colorLeft,n=((s=(a=t.beatmap)==null?void 0:a.settings.customData)==null?void 0:s._colorRight)??e.saberRightColor??ge[be[t.beatmap.environment]??"The First"]._colorRight;return i&&n?ro(ue(i),ue(n)):100}function Td(t){var a,s,l,c;const e=t.info.colorSchemes[t.beatmap.settings.colorSchemeId];let i=100,n=100;const o=((s=(a=t.beatmap)==null?void 0:a.settings.customData)==null?void 0:s._colorLeft)??e.saberLeftColor??ge[be[t.beatmap.environment]??"The First"]._colorLeft,r=((c=(l=t.beatmap)==null?void 0:l.settings.customData)==null?void 0:c._colorRight)??e.saberRightColor??ge[be[t.beatmap.environment]??"The First"]._colorRight;return o&&(i=ro(pa,ue(o))),r&&(n=ro(pa,ue(r))),Math.min(i,n)}function Rd(t){var r,a;const e=t.info.colorSchemes[t.beatmap.settings.colorSchemeId];if(!((r=t.beatmap.settings.customData)!=null&&r._colorLeft)&&!((a=t.beatmap.settings.customData)!=null&&a._colorRight)&&!e)return[];const i=Cd(t),n=Td(t),o=[];return i<=20&&o.push({type:"string",label:`${ba(da,i)} note color (dE${M(i,1)})`,value:"suggest change to better differentiate between 2 note colour",symbol:"warning"}),n<=20&&o.push({type:"string",label:`${ba(da,n)} arrow note color (dE${M(n,1)})`,value:"may be difficult to see the arrow",symbol:"warning"}),o}var lt=(t=>(t[t.OBJECT=-1]="OBJECT",t[t.COLOR=0]="COLOR",t[t.BOMB=1]="BOMB",t[t.ARC=2]="ARC",t[t.CHAIN=3]="CHAIN",t))(lt||{});const ga="Double-directional",va="Check double-directional note swing (this may not mean parity break).",_a=!0,_c={name:ga,description:va,type:"note",order:{input:dt.NOTES_DOUBLE_DIRECTIONAL,output:bt.NOTES_DOUBLE_DIRECTIONAL},input:{enabled:_a,params:{},html:U.createBlock(U.createCheckbox(function(){_c.input.enabled=this.checked},ga,va,_a))},run:Ld};function kd(t){const e=t.timeProcessor,i=t.noteContainer,n={},o={},r={},a={[rt.RED]:[],[rt.BLUE]:[]},s=[];for(let l=0,c=i.length;l<c;l++){const h=i[l];h.type===lt.COLOR&&n[h.data.color]?ce(h.data,n[h.data.color],e,a[h.data.color])?(r[h.data.color]&&(r[h.data.color]=null,o[h.data.color]=(o[h.data.color]+180)%360),Yi(h.data,o[h.data.color],45,!0)&&s.push(h.data),h.data.direction===x.ANY?r[h.data.color]=h.data:o[h.data.color]=h.data.getAngle(),a[h.data.color]=[]):(r[h.data.color]&&Yi(h.data,o[h.data.color],45,!0)&&(s.push(h.data),r[h.data.color]=null,o[h.data.color]=h.data.getAngle()),h.data.direction!==x.ANY&&(r[h.data.color]=null,o[h.data.color]=h.data.getAngle())):h.type===lt.COLOR&&(o[h.data.color]=h.data.getAngle()),h.type===lt.COLOR&&(n[h.data.color]=h.data,a[h.data.color].push(h.data)),h.type===lt.BOMB&&(h.data.posY===Lt.BOTTOM&&(h.data.posX===ut.MIDDLE_LEFT&&(o[rt.RED]=_e[x.UP],r[rt.RED]=null),h.data.posX===ut.MIDDLE_RIGHT&&(o[rt.BLUE]=_e[x.UP],r[rt.BLUE]=null)),h.data.posY===Lt.TOP&&(h.data.posX===ut.MIDDLE_LEFT&&(o[rt.RED]=_e[x.DOWN],r[rt.RED]=null),h.data.posX===ut.MIDDLE_RIGHT&&(o[rt.BLUE]=_e[x.DOWN],r[rt.BLUE]=null)))}return s}function Ld(t){const e=kd(t.beatmap);return e.length?[{type:"time",label:"Double-directional",value:e,symbol:"warning"}]:[]}const ya="Effective BPM",Ea=`Effective BPM is calculated by one hand making 1/2 precision movement relative to the BPM.
EBPM starts from previous end note to next start note (typically for sliders).
EBPM Swing starts from previous start note to next start note.`,Da=!0,Co=450,To=350,yc=U.createNumber(function(){le.input.params.ebpmThres=M(Math.abs(parseFloat(this.value)),1),this.value=le.input.params.ebpmThres.toString()},": ",Co,0),Ec=U.createNumber(function(){le.input.params.ebpmsThres=M(Math.abs(parseFloat(this.value)),1),this.value=le.input.params.ebpmsThres.toString()}," (swing): ",To,0),le={name:ya,description:Ea,type:"note",order:{input:dt.NOTES_EFFECTIVE_BPM,output:bt.NOTES_EFFECTIVE_BPM},input:{enabled:Da,params:{ebpmThres:Co,ebpmsThres:To},html:U.createBlock(U.createCheckbox(function(){le.input.enabled=this.checked},ya+" threshold",Ea,Da),yc,Ec),adjustTime:Bd},run:Od};function Bd(t){le.input.params.ebpmThres=M(Math.min(Co,t.bpm*2*1.285714),1),le.input.params.ebpmsThres=M(Math.min(To,t.bpm*2),1),yc[1].value=le.input.params.ebpmThres.toString(),Ec[1].value=le.input.params.ebpmsThres.toString()}function xd(t){const{swingAnalysis:e}=t.beatmap;let{ebpmThres:i,ebpmsThres:n}=le.input.params;i+=.001,n+=.001;const o=e.container.filter(a=>a.ebpm>i).map(a=>a.data[0]),r=e.container.filter(a=>a.ebpmSwing>n).map(a=>a.data[0]);return{base:o,swing:r}}function Od(t){const e=xd(t),{ebpmThres:i,ebpmsThres:n}=le.input.params,o=[];return e.base.length&&o.push({type:"time",label:`>${i}EBPM warning`,value:e.base,symbol:"warning"}),e.swing.length&&o.push({type:"time",label:`>${n}EBPM (swing) warning`,value:e.swing,symbol:"warning"}),o}const wa="Hitbox Inline",Sa="Check for overlapping note hitbox for inline note.",Ca=!0,Dc={name:wa,description:Sa,type:"note",order:{input:dt.NOTES_HITBOX_INLINE,output:bt.NOTES_HITBOX_INLINE},input:{enabled:Ca,params:{},html:U.createBlock(U.createCheckbox(function(){Dc.input.enabled=this.checked},wa,Sa,Ca))},run:Ad},Nd=0;function Id(t){const{timeProcessor:e,njs:i}=t.beatmap,n={},o={[rt.RED]:[],[rt.BLUE]:[]},r=[];for(let a=0,s=t.beatmap.data.colorNotes.length;a<s;a++){const l=t.beatmap.data.colorNotes[a];n[l.color]&&ce(l,n[l.color],e,o[l.color])&&(o[l.color]=[]);for(const c of o[(l.color+1)%2])if(i.value<1.425/(60*(l.time-c.time)/e.bpm+Nd)&&l.isInline(c)){r.push(l);break}n[l.color]=l,o[l.color].push(l)}return r}function Ad(t){const e=Id(t);return e.length?[{type:"time",label:"Hitbox inline",value:e,symbol:"rank"}]:[]}const Ta="Hitbox Path",Ra="Check for overlapping pre-swing note hitbox at same time.",ka=!0,wc={name:Ta,description:Ra,type:"note",order:{input:dt.NOTES_HITBOX_PATH,output:bt.NOTES_HITBOX_PATH},input:{enabled:ka,params:{},html:U.createBlock(U.createCheckbox(function(){wc.input.enabled=this.checked},Ta,Ra,ka))},run:$d};function Pd(t){t.beatmap.timeProcessor;const e=t.beatmap.noteContainer.filter(o=>o.type===lt.BOMB||o.type===lt.COLOR),i=[];let n=0;for(let o=0,r=e.length;o<r;o++){const a=e[o];if(!(a.type!==lt.COLOR||a.data.customData.__mapcheck_secondtime<n+.01))for(let s=o+1;s<r;s++){const l=e[s];if(l.data.customData.__mapcheck_secondtime>a.data.customData.__mapcheck_secondtime+.01)break;l.type===lt.COLOR&&a.data.color===l.data.color||((a.data.isHorizontal(l.data)||a.data.isVertical(l.data))&&bo(a.data,l.data,[[45,1],[15,2]]).some(c=>c)||a.data.isDiagonal(l.data)&&bo(a.data,l.data,[[45,1],[15,1.5]]).some(c=>c))&&(i.push(a.data),n=a.data.customData.__mapcheck_secondtime)}}return i}function $d(t){const e=Pd(t);return e.length?[{type:"time",label:"Hitbox path",value:e,symbol:"error"}]:[]}const La="Hitbox Reverse Staircase",Ba="Check for overlapping pre-swing hitbox with note hitbox during swing.",xa=!0,Sc={name:La,description:Ba,type:"note",order:{input:dt.NOTES_HITBOX_REVERSE_STAIR,output:bt.NOTES_HITBOX_REVERSE_STAIR},input:{enabled:xa,params:{},html:U.createBlock(U.createCheckbox(function(){Sc.input.enabled=this.checked},La,Ba,xa))},run:zd},Md=.03414823529,Fd=.03414823529;function jd(t){const{timeProcessor:e,njs:i,noteContainer:n}=t.beatmap,o={},r={[rt.RED]:[],[rt.BLUE]:[]},a=[];for(let s=0,l=n.length;s<l;s++){if(n[s].type!==lt.COLOR)continue;const c=n[s];o[c.data.color]&&ce(c.data,o[c.data.color],e,r[c.data.color])&&(r[c.data.color]=[]);for(const h of r[(c.data.color+1)%2])if(h.direction!==x.ANY){if(!(e.toRealTime(c.data.time)>e.toRealTime(h.time)+.01))continue;const p=h.getAngle()%90>15&&h.getAngle()%90<75;if(i.value<1.425/(60*(c.data.time-h.time)/e.bpm+(p?Fd:Md))&&bo(c.data,h,[[15,1.5]])[1]){a.push(h);break}}o[c.data.color]=c.data,r[c.data.color].push(c.data)}return a}function zd(t){const e=jd(t);return e.length?[{type:"time",label:"Hitbox reverse Staircase",value:e,symbol:"rank"}]:[]}const Oa="Hitbox Staircase",Na="Check for overlapping post-swing hitbox with note hitbox during swing.",Ia=!0,Cc={name:Oa,description:Na,type:"note",order:{input:dt.NOTES_HITBOX_STAIR,output:bt.NOTES_HITBOX_STAIR},input:{enabled:Ia,params:{},html:U.createBlock(U.createCheckbox(function(){Cc.input.enabled=this.checked},Oa,Na,Ia))},run:Hd};function Vd(t,e,i){for(let n=i,o=e.length;n<o;n++){if(e[n].time<t.time+.01&&e[n].color!==t.color)return!0;if(e[n].time>t.time+.01)return!1}return!1}function Gd(t){var h,p;const{timeProcessor:e}=t.beatmap,i=t.beatmap.data.colorNotes,n=e.toBeatTime(.15,!1),o={},r={},a={},s={[rt.RED]:[],[rt.BLUE]:[]},l={[rt.RED]:new Wt,[rt.BLUE]:new Wt({color:1})},c=[];for(let d=0,u=i.length;d<u;d++){const m=i[d],b=qn[m.direction]||[0,0];o[m.color]?(ce(m,o[m.color],e,s[m.color])?(a[m.color]=m.time-o[m.color].time,m.direction!==x.ANY?(l[m.color].posX=m.posX+b[0],l[m.color].posY=m.posY+b[1]):(l[m.color].posX=-1,l[m.color].posY=-1),s[m.color]=[],r[m.color]=m.direction):Xu(m,o[m.color],r[m.color])&&(m.direction!==x.ANY?(l[m.color].posX=m.posX+b[0],l[m.color].posY=m.posY+b[1],r[m.color]=m.direction):(l[m.color].posX=m.posX+(((h=qn[r[m.color]])==null?void 0:h[0])||0),l[m.color].posY=m.posY+(((p=qn[r[m.color]])==null?void 0:p[1])||0))),o[(m.color+1)%2]&&m.time-o[(m.color+1)%2].time!==0&&m.time-o[(m.color+1)%2].time<Math.min(n,a[(m.color+1)%2])&&m.posX===l[(m.color+1)%2].posX&&m.posY===l[(m.color+1)%2].posY&&!Vd(m,t.beatmap.data.colorNotes,d)&&c.push(m)):(m.direction!==x.ANY?(l[m.color].posX=m.posX+b[0],l[m.color].posY=m.posY+b[1]):(l[m.color].posX=-1,l[m.color].posY=-1),r[m.color]=m.direction),o[m.color]=m,s[m.color].push(m)}return c}function Hd(t){const e=Gd(t);return e.length?[{type:"time",label:"Hitbox staircase",value:e,symbol:"rank"}]:[]}const Aa="Improper Arc",Pa="Check for correct use of arc.",$a=!0,Tc={name:Aa,description:Pa,type:"note",order:{input:dt.NOTES_IMPROPER_ARC,output:bt.NOTES_IMPROPER_ARC},input:{enabled:$a,params:{},html:U.createBlock(U.createCheckbox(function(){Tc.input.enabled=this.checked},Aa,Pa,$a))},run:Wd};function Ud(t){const e=[...t.beatmap.noteContainer].sort((n,o)=>n.type!==lt.ARC?1:o.type!==lt.ARC?-1:0).sort((n,o)=>n.data.time-o.data.time),i=[];for(let n=0,o=!0,r=e.length;n<r;n++){const a=e[n],s=e.at(-1).data.time;if(a.type===lt.ARC){o=!0;for(let l=n,c=!1;l<r;l++){const h=e[l];if(h.type===lt.COLOR&&a.data.posX===h.data.posX&&a.data.posY===h.data.posY&&h.data.time<=a.data.time+.001&&a.data.color===h.data.color&&(h.data.direction===x.ANY||a.data.direction===h.data.direction)){for(let p=l;p<r;p++){const d=e[l];if(d.type===lt.BOMB&&a.data.posX===d.data.posX&&a.data.posY===d.data.posY&&d.data.time<=a.data.time+.001){c=!0;break}if(!(d.type!==lt.COLOR||d.data.time<a.data.tailTime)){if(a.data.posX===h.data.posX&&a.data.posY===h.data.posY&&h.data.time<=a.data.time+.001&&(a.data.color!==h.data.color||(h.data.direction===x.ANY||a.data.direction!==h.data.direction))){c=!0;break}if(h.data.time>a.data.tailTime+.001)break}}o=c||!1;break}if(h.type===lt.COLOR&&a.data.posX===h.data.posX&&a.data.posY===h.data.posY&&h.data.time<=a.data.time+.001)break;if(h.data.time>a.data.time+.001){o=!1;break}(h.type===lt.ARC||h.type===lt.CHAIN)&&h.data.time+.001>s&&(o=!1)}o&&i.push(a.data)}}return i}function Wd(t){const e=Ud(t);return e.length?[{type:"time",label:"Improper arc",value:e,symbol:"error"}]:[]}const Ma="Improper Chain",Fa="Check for correct use of chain.",ja=!0,Rc={name:Ma,description:Fa,type:"note",order:{input:dt.NOTES_IMPROPER_CHAIN,output:bt.NOTES_IMPROPER_CHAIN},input:{enabled:ja,params:{},html:U.createBlock(U.createCheckbox(function(){Rc.input.enabled=this.checked},Ma,Fa,ja))},run:Xd};function Yd(t){const e=[...t.beatmap.noteContainer].sort((n,o)=>n.type!==lt.CHAIN?1:o.type!==lt.CHAIN?-1:0).sort((n,o)=>n.data.time-o.data.time),i=[];for(let n=0,o=!0,r=e.length;n<r;n++){const a=e[n];if(a.type===lt.CHAIN){o=!0;for(let s=n;s<r;s++){const l=e[s];if(l.type===lt.COLOR&&a.data.posX===l.data.posX&&a.data.posY===l.data.posY&&l.data.time<=a.data.time+.001&&a.data.color===l.data.color&&(l.data.direction===x.ANY||a.data.direction===l.data.direction)){o=!1;break}if(l.type===lt.BOMB&&a.data.posX===l.data.posX&&a.data.posY===l.data.posY&&l.data.time<=a.data.time+.001||l.data.time>a.data.time+.001)break}o&&i.push(a)}}return i}function Xd(t){const e=Yd(t);return e.length?[{type:"time",label:"Improper chain",value:e.map(i=>i.data),symbol:"error"}]:[]}const za="Improper Window Snap",Va="Check for slanted window snap timing.",Ga=!0,kc={name:za,description:Va,type:"note",order:{input:dt.NOTES_IMPROPER_WINDOW,output:bt.NOTES_IMPROPER_WINDOW},input:{enabled:Ga,params:{},html:U.createBlock(U.createCheckbox(function(){kc.input.enabled=this.checked},za,Va,Ga))},run:Kd};function qd(t){const{timeProcessor:e,noteContainer:i}=t.beatmap,n={},o={[rt.RED]:[],[rt.BLUE]:[]},r=[];for(let a=0,s=i.length;a<s;a++){if(i[a].type!==lt.COLOR)continue;const l=i[a].data;n[l.color]?ce(l,n[l.color],e,o[l.color])?(n[l.color]=l,o[l.color]=[]):l.isSlantedWindow(n[l.color])&&l.time-n[l.color].time>=.001&&l.direction===n[l.color].direction&&l.direction!==x.ANY&&n[l.color].direction!==x.ANY&&r.push(n[l.color]):n[l.color]=l,o[l.color].push(l)}return r}function Kd(t){const e=qd(t);return e.length?[{type:"time",label:"Improper window snap",value:e,symbol:"error"}]:[]}const Ha="Inline Sharp Angle",Ua="Check for angle changes within inline note.",Wa=!0,Lc=.15;let Li;const[Zd,Bc]=U.createNumber(function(){Me.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=M(Me.input.params.maxTime*1e3,1).toString(),Li&&(Ro.value=M(Li.toBeatTime(Me.input.params.maxTime,!1),2).toString())},"max time (ms): ",M(Lc*1e3,1),0),[Jd,Ro]=U.createNumber(function(){if(!Li){this.value="0";return}let t=M(Math.abs(parseFloat(this.value)),2)||1;Me.input.params.maxTime=Li.toRealTime(t),Bc.value=M(Me.input.params.maxTime*1e3,1).toString(),this.value=t.toString()}," (beat): ",0,0,null,.1),Me={name:Ha,description:Ua,type:"note",order:{input:dt.NOTES_INLINE_ANGLE,output:bt.NOTES_INLINE_ANGLE},input:{enabled:Wa,params:{maxTime:Lc},html:U.createBlock(U.createCheckbox(function(){Me.input.enabled=this.checked},Ha,Ua,Wa),document.createElement("br"),Zd,Bc,Jd,Ro),adjustTime:Qd},run:e0};function Qd(t){Li=t,Ro.value=M(Li.toBeatTime(Me.input.params.maxTime,!1),2).toString()}function t0(t){const{timeProcessor:e}=t.beatmap,i=t.beatmap.noteContainer,{maxTime:n}=Me.input.params,o=e.toBeatTime(n,!1)+.001,r={},a={},s={},l={[rt.RED]:[],[rt.BLUE]:[]},c=[];let h=0;for(let p=0,d=i.length;p<d;p++){const u=i[p];u.type===lt.COLOR&&r[u.data.color]?ce(u.data,r[u.data.color],e,l[u.data.color])?(s[u.data.color]&&(s[u.data.color]=null,a[u.data.color]=(a[u.data.color]+180)%360),Ya(u.data,i,h,o)&&Yi(u.data,a[u.data.color],90,!0)&&c.push(u.data),u.data.direction===x.ANY?s[u.data.color]=u.data:a[u.data.color]=u.data.getAngle(),l[u.data.color]=[]):(s[u.data.color]&&Ya(u.data,i,h,o)&&Yi(u.data,a[u.data.color],90,!0)&&(c.push(s[u.data.color]),s[u.data.color]=null),u.data.direction!==x.ANY&&(a[u.data.color]=u.data.getAngle())):u.type===lt.COLOR&&(a[u.data.color]=u.data.getAngle()),u.type===lt.COLOR&&(r[u.data.color]=u.data,l[u.data.color].push(u.data)),u.type===lt.BOMB&&(u.data.posY===Lt.BOTTOM&&(u.data.posX===ut.MIDDLE_LEFT&&(a[rt.RED]=_e[x.UP],s[rt.RED]=null),u.data.posX===ut.MIDDLE_RIGHT&&(a[rt.BLUE]=_e[x.UP],s[rt.BLUE]=null)),u.data.posY===Lt.TOP&&(u.data.posX===ut.MIDDLE_LEFT&&(a[rt.RED]=_e[x.DOWN],s[rt.RED]=null),u.data.posX===ut.MIDDLE_RIGHT&&(a[rt.BLUE]=_e[x.DOWN],s[rt.BLUE]=null)))}return c}function Ya(t,e,i,n){for(let o=i;e[o].data.time<t.time;o++){const r=e[o];if(r.type===lt.COLOR&&t.isInline(r.data)&&t.time-e[o].data.time<=n)return!0}return!1}function e0(t){const e=t0(t);return e.length?[{type:"time",label:"Inline sharp angle",value:e,symbol:"warning"}]:[]}const Xa="One Saber",qa="Check for one saber.",Ka=!0,xc={name:Xa,description:qa,type:"note",order:{input:dt.NOTES_ONE_SABER,output:bt.NOTES_ONE_SABER},input:{enabled:Ka,params:{},html:U.createBlock(U.createCheckbox(function(){xc.input.enabled=this.checked},Xa,qa,Ka))},run:i0};function i0(t){let e,i=!1;if(t.beatmap.settings.characteristic==="OneSaber"||t.beatmap.settings.customData.oneSaber)e=t.beatmap.data.colorNotes.filter(o=>o.isRed());else{const o=t.beatmap.data.colorNotes.filter(a=>a.isBlue()).length>0,r=t.beatmap.data.colorNotes.filter(a=>a.isRed()).length>0;i=o?!r:r}return e!=null&&e.length?[{type:"time",label:"Wrong One Saber Note",value:e,symbol:"error"}]:i?[{type:"string",label:"Unintended One Saber",value:"One Saber gameplay outside of One Saber characteristic",symbol:"rank"}]:[]}const qi={create:(t,e,i,n,...o)=>{const r=document.createElement(i);r.className=n;const a=document.createElement("select");a.className="input-toggle",a.id=t,o.forEach(l=>{const c=document.createElement("option");c.textContent=l.text,c.value=l.value,a.append(c)});const s=document.createElement("label");return s.htmlFor=t,s.innerHTML=`<span>${e}</span>`,r.append(s),r.append(a),r}},Oc="Parity Check",Nc="Perform parity check.",Ic=!1,Ac=document.createElement("div");qi.create("input__checks-parity-rotation","Wrist rotation type: ","div","",{text:"Normal",value:"90"},{text:"Extended",value:"135"},{text:"Squid",value:"180"});qi.create("input__checks-parity-left","Left hand parity: ","div","",{text:"Auto",value:"auto"},{text:"Forehand",value:"forehand"},{text:"Backhand",value:"backhand"});qi.create("input__checks-parity-right","Right hand parity: ","div","",{text:"Auto",value:"auto"},{text:"Forehand",value:"forehand"},{text:"Backhand",value:"backhand"});Ac.appendChild(U.createBlock(U.createCheckbox(function(){ko.input.enabled=this.checked},Oc+" (EXPERIMENTAL)",Nc,Ic)));const ko={name:Oc,description:Nc,type:"note",order:{input:dt.NOTES_PARITY,output:bt.NOTES_PARITY},input:{enabled:Ic,params:{warningThres:90,errorThres:45,allowedRot:90},html:Ac},run:o0};function n0(t){const{timeProcessor:e,noteContainer:i}=t.beatmap,{warningThres:n,errorThres:o,allowedRot:r}=ko.input.params,a={},s={[rt.RED]:[],[rt.BLUE]:[]},l={[rt.RED]:[],[rt.BLUE]:[]},c={[rt.RED]:[],[rt.BLUE]:[]},h={[rt.RED]:new ii(t.beatmap.data.colorNotes,t.beatmap.data.bombNotes,0,n,o,r),[rt.BLUE]:new ii(t.beatmap.data.colorNotes,t.beatmap.data.bombNotes,1,n,o,r)},p={warning:[],error:[]};for(let d=0,u=i.length;d<u;d++){const m=i[d];if(m.type===lt.COLOR&&a[m.data.color]&&ce(m.data,a[m.data.color],e,s[m.data.color])){switch(h[m.data.color].check(s[m.data.color],c[m.data.color])){case"warning":{p.warning.push(s[m.data.color][0]);break}case"error":{p.error.push(s[m.data.color][0]);break}}h[m.data.color].next(s[m.data.color],c[m.data.color]),c[m.data.color]=l[m.data.color],l[m.data.color]=[],s[m.data.color]=[]}m.type===lt.BOMB&&(l[rt.RED].push(m.data),l[rt.BLUE].push(m.data)),m.type===lt.COLOR&&(a[m.data.color]=m.data,s[m.data.color].push(m.data))}for(let d=0;d<2;d++)if(a[d])switch(h[d].check(s[d],l[d])){case"warning":{p.warning.push(s[d][0]);break}case"error":{p.error.push(s[d][0]);break}}return p}function o0(t){const e=n0(t);e.warning=e.warning,e.error=e.error;const i=[];return e.warning.length&&i.push({type:"time",label:"Parity warning",value:e.warning,symbol:"warning"}),e.error.length&&i.push({type:"time",label:"Parity error",value:e.error,symbol:"error"}),i}const Za="shrado Angle",Ja="Look for common negative curvature pattern.",Qa=!1,Pc=.15,r0=1;let Bi;const[s0,$c]=U.createNumber(function(){ye.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=M(ye.input.params.maxTime*1e3,1).toString(),Bi&&(Lo.value=M(Bi.toBeatTime(ye.input.params.maxTime,!1),2).toString())},"max time (ms): ",M(Pc*1e3,1),0),[a0,Lo]=U.createNumber(function(){if(!Bi){this.value="0";return}let t=M(Math.abs(parseFloat(this.value)),2)||1;ye.input.params.maxTime=Bi.toRealTime(t),$c.value=M(ye.input.params.maxTime*1e3,1).toString(),this.value=t.toString()}," (beat): ",0,0,null,.1),ye={name:Za,description:Ja,type:"note",order:{input:dt.NOTES_SHRADO_ANGLE,output:bt.NOTES_SHRADO_ANGLE},input:{enabled:Qa,params:{distance:r0,maxTime:Pc},html:U.createBlock(U.createCheckbox(function(){ye.input.enabled=this.checked},Za,Ja,Qa),document.createElement("br"),U.createNumber(function(){ye.input.params.distance=Math.max(parseInt(this.value),0),this.value=ye.input.params.distance.toString()},"min distance: ",0,0),document.createElement("br"),s0,$c,a0,Lo),adjustTime:l0},run:c0};function l0(t){Bi=t,Lo.value=M(Bi.toBeatTime(ye.input.params.maxTime,!1),2).toString()}function u0(t){const{timeProcessor:e,noteContainer:i}=t.beatmap,{maxTime:n,distance:o}=ye.input.params,r=e.toBeatTime(n,!1)+.001,a={},s={},l={},c={[rt.RED]:[],[rt.BLUE]:[]},h=[];for(let p=0,d=i.length;p<d;p++){if(i[p].type!==lt.COLOR)continue;const u=i[p].data;a[u.color]?ce(u,a[u.color],e,c[u.color])?(l[u.color]&&(l[u.color]=null,s[u.color]=Qh[s[u.color]]??8),u.getDistance(a[u.color])>=o&&tl(u.direction,s[u.color],u.color)&&u.time-a[u.color].time<=r&&h.push(u),u.direction===x.ANY?l[u.color]=u:s[u.color]=u.direction,c[u.color]=[]):(l[u.color]&&u.getDistance(a[u.color])>=o&&tl(u.direction,s[u.color],u.color)&&u.time-a[u.color].time<=r&&(h.push(l[u.color]),l[u.color]=null),u.direction!==x.ANY&&(s[u.color]=u.direction)):s[u.color]=u.direction,a[u.color]=u,c[u.color].push(u)}return h}function tl(t,e,i){return t===8||e===8?!1:(i===0?e===7:e===6)&&t===0}function c0(t){const e=u0(t);return e.length?[{type:"time",label:"Shrado angle",value:e,symbol:"warning"}]:[]}const el="Slow Slider",il="Look for slider that require slow swing.",nl=!0,Mc=.025;let xi;const[h0,Fc]=U.createNumber(function(){Be.input.params.minSpeed=Math.abs(parseFloat(this.value))/1e3,this.value=M(Be.input.params.minSpeed*1e3,1).toString(),xi&&(Bo.value=M(1/xi.toBeatTime(Be.input.params.minSpeed,!1),2).toString())},"min speed (ms): ",M(Mc*1e3,1),0),[m0,Bo]=U.createNumber(function(){if(!xi){this.value="0";return}let t=M(Math.abs(parseFloat(this.value)),2)||1;Be.input.params.minSpeed=xi.toRealTime(1/t),Fc.value=M(Be.input.params.minSpeed*1e3,1).toString(),this.value=t.toString()}," (prec): ",0,0),Be={name:el,description:il,type:"note",order:{input:dt.NOTES_SLOW_SLIDER,output:bt.NOTES_SLOW_SLIDER},input:{enabled:nl,params:{minSpeed:Mc},html:U.createBlock(U.createCheckbox(function(){Be.input.enabled=this.checked},el,il,nl),document.createElement("br"),h0,Fc,m0,Bo),adjustTime:f0},run:d0};function f0(t){xi=t,Bo.value=M(1/xi.toBeatTime(Be.input.params.minSpeed,!1),2).toString()}function p0(t){const{swingAnalysis:e}=t.beatmap,{minSpeed:i}=Be.input.params;return e.container.filter(n=>n.maxSpeed>i||n.minSpeed>i)}function d0(t){const{minSpeed:e}=Be.input.params,i=p0(t);return i.length?[{type:"time",label:`Slow slider (>${M(e*1e3,1)}ms)`,value:i.map(n=>n.data[0]),symbol:"warning"}]:[]}const ol="Speed Pause",rl="Look for stream/burst containing timing gap causing sudden change of pace.",sl=!1,jc=.075;let Oi;const[b0,zc]=U.createNumber(function(){Fe.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=M(Fe.input.params.maxTime*1e3,1).toString(),Oi&&(xo.value=M(1/Oi.toBeatTime(Fe.input.params.maxTime,!1),2).toString())},"stream speed (ms): ",M(jc*1e3,1),0),[g0,xo]=U.createNumber(function(){if(!Oi){this.value="0";return}let e=M(Math.abs(parseFloat(this.value)),2)||1;Fe.input.params.maxTime=Oi.toRealTime(1/e),zc.value=M(Fe.input.params.maxTime*1e3,1).toString(),this.value=e.toString()}," (prec): ",0,0),Fe={name:ol,description:rl,type:"note",order:{input:dt.NOTES_SPEED_PAUSE,output:bt.NOTES_SPEED_PAUSE},input:{enabled:sl,params:{maxTime:jc},html:U.createBlock(U.createCheckbox(function(){Fe.input.enabled=this.checked},ol,rl,sl),document.createElement("br"),b0,zc,g0,xo),adjustTime:v0},run:y0};function v0(t){Oi=t,xo.value=M(1/Oi.toBeatTime(Fe.input.params.maxTime,!1),2).toString()}function _0(t){const e=t.timeProcessor,i=t.data.colorNotes,{maxTime:n}=Fe.input.params,o=e.toBeatTime(n,!1)+.001,r={},a={},s={[rt.RED]:!1,[rt.BLUE]:!1},l={[rt.RED]:[],[rt.BLUE]:[]},c=[];for(let h=0,p=i.length;h<p;h++){const d=i[h];r[d.color]?ce(d,r[d.color],e,l[d.color])&&(d.time-r[d.color].time<=o*2?(s[rt.RED]&&s[rt.BLUE]&&r[d.color].time-a[d.color].time<=o*3&&c.push(r[d.color]),s[d.color]=!1):s[d.color]||(s[d.color]=!0,a[d.color]=r[d.color]),l[d.color]=[],r[d.color]=d):r[d.color]=d,l[d.color].push(d)}return c}function y0(t){const e=_0(t.beatmap);return e.length?[{type:"time",label:"Speed pause",value:e,symbol:"warning"}]:[]}const al="Stacked Note",ll="Look for stacked note.",ul=!0,Vc={name:al,description:ll,type:"note",order:{input:dt.NOTES_STACKED_NOTE,output:bt.NOTES_STACKED_NOTE},input:{enabled:ul,params:{},html:U.createBlock(U.createCheckbox(function(){Vc.input.enabled=this.checked},al,ll,ul))},run:w0};function E0(t){const e=t.data.colorNotes,i=[];let n=0;for(let o=0,r=e.length;o<r;o++)if(!(e[o].customData.__mapcheck_secondtime<n+.01))for(let a=o+1;a<r&&!(e[a].customData.__mapcheck_secondtime>e[o].customData.__mapcheck_secondtime+.01);a++)e[a].isInline(e[o])&&(i.push(e[o]),n=e[o].customData.__mapcheck_secondtime);return i}function D0(t){const e=t.timeProcessor,i=t.njs,n=t.data.bombNotes,o=[];for(let r=0,a=n.length;r<a;r++)for(let s=r+1;s<a&&!(n[s].customData.__mapcheck_secondtime>n[r].customData.__mapcheck_secondtime+1);s++)n[r].isInline(n[s])&&(i.value<e.bpm/(120*(n[s].time-n[r].time))||n[s].customData.__mapcheck_secondtime<n[r].customData.__mapcheck_secondtime+.02)&&o.push(n[r]);return o}function w0(t){const e=E0(t.beatmap),i=D0(t.beatmap),n=[];return e.length&&n.push({type:"time",label:"Stacked note",value:e,symbol:"error"}),i.length&&n.push({type:"time",label:"Stacked bomb",value:i,symbol:"error"}),n}const cl="Varying Swing Speed",hl="Check for varying swing speed due to changes in slider distance.",ml=!0,Gc={name:cl,description:hl,type:"note",order:{input:dt.NOTES_VARY_SWING,output:bt.NOTES_VARY_SWING},input:{enabled:ml,params:{},html:U.createBlock(U.createCheckbox(function(){Gc.input.enabled=this.checked},cl,hl,ml))},run:C0};function S0(t){const{swingAnalysis:e}=t;return e.container.filter(i=>Math.abs(i.minSpeed-i.maxSpeed)>.002)}function C0(t){const e=S0(t.beatmap);return e.length?[{type:"time",label:"Varying swing speed",value:e.map(i=>i.data[0]),symbol:"error"}]:[]}const fl="Vision Block",pl="Check for vision block caused by center note.",dl=!0,Hc=.1,Uc=.5;let Jt;const bl={Easy:{min:.025,max:1.2},Normal:{min:.05,max:1},Hard:{min:.08,max:.75},Expert:{min:.1,max:.625},ExpertPlus:{min:.1,max:.5}},[T0,R0]=U.createRadio(Yc," VB time specific ","vb-spec","time",!1),[k0,L0]=U.createRadio(Yc," VB difficulty specific ","vb-spec","difficulty",!0),[B0,Wc]=U.createNumber(function(){yt.input.params.minTime=Math.abs(parseFloat(this.value))/1e3,this.value=M(yt.input.params.minTime*1e3,1).toString(),Jt&&(Oo.value=M(Jt.toBeatTime(yt.input.params.minTime,!1),2).toString(),yt.input.params.minTime>yt.input.params.maxTime&&(yt.input.params.maxTime=yt.input.params.minTime,Hn.value=M(yt.input.params.maxTime*1e3,1).toString(),Ki.value=M(Jt.toBeatTime(yt.input.params.maxTime,!1),2).toString()))},"min time (ms): ",M(Hc*1e3,1),0),[x0,Oo]=U.createNumber(function(){if(!Jt){this.value="0";return}const t=Math.abs(parseFloat(this.value))||1;yt.input.params.minTime=Jt.toRealTime(t),Wc.value=M(yt.input.params.minTime*1e3,1).toString(),this.value=M(t,2).toString(),yt.input.params.minTime>yt.input.params.maxTime&&(yt.input.params.maxTime=yt.input.params.minTime,Hn.value=M(yt.input.params.maxTime*1e3,1).toString(),Ki.value=M(Jt.toBeatTime(yt.input.params.maxTime,!1),2).toString())}," (beat): ",0,0,null,.1),[O0,Hn]=U.createNumber(function(){yt.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=M(yt.input.params.maxTime*1e3,1).toString(),Jt&&(Ki.value=M(Jt.toBeatTime(yt.input.params.maxTime,!1),2).toString())},"max time (ms): ",M(Uc*1e3,1),0),[N0,Ki]=U.createNumber(function(){if(!Jt){this.value="0";return}const t=Math.abs(parseFloat(this.value))||1;yt.input.params.maxTime=Jt.toRealTime(t),Hn.value=M(yt.input.params.maxTime*1e3,1).toString(),this.value=M(t,2).toString()}," (beat): ",0,0,null,.1),yt={name:fl,description:pl,type:"note",order:{input:dt.NOTES_VISION_BLOCK,output:bt.NOTES_VISION_BLOCK},input:{enabled:dl,params:{specific:"difficulty",minTime:Hc,maxTime:Uc},html:U.createBlock(U.createCheckbox(function(){yt.input.enabled=this.checked},fl,pl,dl),document.createElement("br"),R0,T0,L0,k0,document.createElement("br"),B0,Wc,x0,Oo,document.createElement("br"),O0,Hn,N0,Ki),adjustTime:I0},run:P0};function I0(t){Jt=t,Oo.value=M(Jt.toBeatTime(yt.input.params.minTime,!1),2).toString(),Ki.value=M(Jt.toBeatTime(yt.input.params.maxTime,!1),2).toString()}function Yc(){yt.input.params.specific=this.value}function A0(t){const{timeProcessor:e,njs:i}=t.beatmap,n=t.beatmap.noteContainer.filter(d=>d.type!==lt.ARC),{minTime:o,maxTime:r,specific:a}=yt.input.params,s=a==="time"?e.toBeatTime(o,!1):e.toBeatTime(bl[t.beatmap.settings.difficulty].min,!1),l=a==="time"?e.toBeatTime(r,!1):Math.min(i.hjd,e.toBeatTime(bl[t.beatmap.settings.difficulty].max,!1));let c=null,h=null;const p=[];for(let d=0,u=n.length;d<u;d++){const m=n[d];c&&(m.data.time-c.data.time>=s&&m.data.time-c.data.time<=l?m.data.posX<ut.MIDDLE_RIGHT&&p.push(m):m.data.time-c.data.time>l&&(c=null)),h&&(m.data.time-h.data.time>=s&&m.data.time-h.data.time<=l?m.data.posX>ut.MIDDLE_LEFT&&p.push(m):m.data.time-h.data.time>l&&(h=null)),m.data.posY===Lt.MIDDLE&&m.data.posX===ut.MIDDLE_LEFT&&(c=m),m.data.posY===Lt.MIDDLE&&m.data.posX===ut.MIDDLE_RIGHT&&(h=m)}return p}function P0(t){const e=A0(t);return e.length?[{type:"time",label:"Vision block",value:e.map(i=>i.data),symbol:"warning"}]:[]}const gl=Object.freeze(Object.defineProperty({__proto__:null,acceptablePrec:Vi,colorCheck:vc,doubleDirectional:_c,effectiveBPM:le,hitboxInline:Dc,hitboxPath:wc,hitboxReverseStair:Sc,hitboxStair:Cc,improperArc:Tc,improperChain:Rc,improperWindow:kc,inlineAngle:Me,oneSaber:xc,parity:ko,shradoAngle:ye,slowSlider:Be,speedPause:Fe,stackedNote:Vc,varySwing:Gc,visionBlock:yt},Symbol.toStringTag,{value:"Module"})),vl="<15ms Obstacle",_l=`Look for obstacle with inadequate duration.
This causes player to not take damage when in collision with obstacle.`,yl=!0,No={name:vl,description:_l,type:"obstacle",order:{input:dt.OBSTACLES_SHORT,output:bt.OBSTACLES_SHORT},input:{enabled:yl,params:{minDur:.015},html:U.createBlock(U.createCheckbox(function(){No.input.enabled=this.checked},vl,_l,yl))},run:M0};function $0(t){const{obstacles:e}=t.beatmap.data,{timeProcessor:i}=t.beatmap,{minDur:n}=No.input.params,o=i.toBeatTime(n,!1),r=[];let a=new Pt,s=new Pt,l=new Pt,c=new Pt;for(let h=0;h<e.length;h++){const p=e[h];p.posY===Lt.BOTTOM&&p.height>2&&p.duration>0?p.width>2||p.width>1&&p.posX===1?(p.isLonger(a)&&(p.duration<o&&r.push(p),a=p),p.isLonger(s)&&(p.duration<o&&r.push(p),s=p)):p.width===2?p.posX===ut.LEFT?p.isLonger(a)&&(p.duration<o&&r.push(p),a=p):p.posX===ut.MIDDLE_RIGHT&&p.isLonger(s)&&(p.duration<o&&r.push(p),s=p):p.width===1&&(p.posX===ut.MIDDLE_LEFT?p.isLonger(a)&&(p.duration<o&&r.push(p),a=p):p.posX===ut.MIDDLE_RIGHT&&p.isLonger(s)&&(p.duration<o&&r.push(p),s=p)):p.posY===Lt.TOP&&p.height>2&&p.duration>0&&(p.width>2||p.width>1&&p.posX===ut.MIDDLE_LEFT?(p.isLonger(l)&&(p.duration<o&&p.isLonger(a,o)&&p.isLonger(l,o)&&r.push(p),l=p),p.isLonger(c)&&(p.duration<o&&p.isLonger(s,o)&&p.isLonger(c,o)&&r.push(p),c=p)):p.width===2?p.posX===ut.LEFT?p.isLonger(l)&&(p.duration<o&&p.isLonger(a,o)&&p.isLonger(l,o)&&r.push(p),l=p):p.posX===ut.MIDDLE_RIGHT&&p.isLonger(c)&&(p.duration<o&&p.isLonger(s,o)&&p.isLonger(c,o)&&r.push(p),c=p):p.width===1&&(p.posX===ut.MIDDLE_LEFT?p.isLonger(l)&&(p.duration<o&&p.isLonger(a,o)&&p.isLonger(l,o)&&r.push(p),l=p):p.posX===ut.MIDDLE_RIGHT&&p.isLonger(c)&&(p.duration<o&&p.isLonger(s,o)&&p.isLonger(c,o)&&r.push(p),c=p)))}return r}function M0(t){const e=$0(t);return e.length?[{type:"time",label:"<15ms obstacle",value:e,symbol:"warning"}]:[]}const El="2-wide Center Obstacle",Dl="Look for 2-wide center obstacle including obstacles that are relatively close to each other.",wl=!0,Xc=.25;let Ni;const[F0,qc]=U.createNumber(function(){xe.input.params.recovery=Math.abs(parseFloat(this.value))/1e3,this.value=M(xe.input.params.recovery*1e3,1).toString(),Ni&&(Io.value=M(Ni.toBeatTime(xe.input.params.recovery,!1),2).toString())},"recovery time (ms): ",M(Xc*1e3,1),0),[j0,Io]=U.createNumber(function(){if(!Ni){this.value="0";return}let t=M(Math.abs(parseFloat(this.value)),2)||1;xe.input.params.recovery=Ni.toRealTime(t,!0),qc.value=M(xe.input.params.recovery*1e3,1).toString(),this.value=t.toString()}," (beat): ",0,0,.1),xe={name:El,description:Dl,type:"obstacle",order:{input:dt.OBSTACLES_CENTER,output:bt.OBSTACLES_CENTER},input:{enabled:wl,params:{recovery:Xc},html:U.createBlock(U.createCheckbox(function(){xe.input.enabled=this.checked},El,Dl,wl),document.createElement("br"),F0,qc,j0,Io),adjustTime:z0},run:G0};function z0(t){Ni=t,Io.value=M(Ni.toBeatTime(xe.input.params.recovery,!1),2).toString()}function V0(t){const{obstacles:e}=t.beatmap.data,{timeProcessor:i}=t.beatmap,{recovery:n}=xe.input.params,o=[];let r=new Pt,a=new Pt;for(let s=0;s<e.length;s++){const l=e[s];l.posY<Lt.TOP&&l.height>1&&(l.width>2&&(o.push(l),l.isLonger(r)&&(r=l),l.isLonger(a)&&(a=l)),l.width===2&&(l.posX===ut.LEFT&&l.isLonger(r)&&(l.customData.__mapcheck_secondtime>a.customData.__mapcheck_secondtime-n&&l.customData.__mapcheck_secondtime<a.customData.__mapcheck_secondtime+i.toRealTime(a.duration)+n&&o.push(l),r=l),l.posX===ut.MIDDLE_LEFT&&(o.push(l),l.isLonger(r)&&(r=l),l.isLonger(a)&&(a=l)),l.posX===ut.MIDDLE_RIGHT&&l.isLonger(a)&&(l.customData.__mapcheck_secondtime>r.customData.__mapcheck_secondtime-n&&l.customData.__mapcheck_secondtime<r.customData.__mapcheck_secondtime+i.toRealTime(r.duration)+n&&o.push(l),a=l)),l.width===1&&(l.posX===ut.MIDDLE_LEFT&&l.isLonger(r)&&(l.customData.__mapcheck_secondtime>a.customData.__mapcheck_secondtime-n&&l.customData.__mapcheck_secondtime<a.customData.__mapcheck_secondtime+i.toRealTime(a.duration)+n&&o.push(l),r=l),l.posX===ut.MIDDLE_RIGHT&&l.isLonger(a)&&(l.customData.__mapcheck_secondtime>r.customData.__mapcheck_secondtime-n&&l.customData.__mapcheck_secondtime<r.customData.__mapcheck_secondtime+i.toRealTime(r.duration)+n&&o.push(l),a=l)))}return o}function G0(t){const e=V0(t),{recovery:i}=xe.input.params;return e.length?[{type:"time",label:`2-wide center obstacle (<${M(i*1e3)}ms)`,value:e,symbol:"error"}]:[]}const Sl="Zero Obstacle",Cl="Look for obstacle with zero value.",Tl=!0,Kc={name:Sl,description:Cl,type:"obstacle",order:{input:dt.OBSTACLES_ZERO,output:bt.OBSTACLES_ZERO},input:{enabled:Tl,params:{},html:U.createBlock(U.createCheckbox(function(){Kc.input.enabled=this.checked},Sl,Cl,Tl))},run:U0};function H0(t){const{obstacles:e}=t.beatmap.data;return e.filter(i=>i.hasZero())}function U0(t){const e=H0(t);return e.length?[{type:"time",label:"Zero value obstacle",value:e,symbol:"error"}]:[]}const Rl=Object.freeze(Object.defineProperty({__proto__:null,centerObstacle:xe,shortObstacle:No,zeroObstacle:Kc},Symbol.toStringTag,{value:"Module"})),kl="Insufficient Lighting Event",Ll="Check if there is enough light event.",Bl=!0,Zc={name:kl,description:Ll,type:"event",order:{input:dt.EVENTS_INSUFFICIENT_LIGHT,output:bt.EVENTS_INSUFFICIENT_LIGHT},input:{enabled:Bl,params:{},html:U.createBlock(U.createCheckbox(function(){Zc.input.enabled=this.checked},kl,Ll,Bl))},run:Y0};function W0(t,e){let i=0;for(let n=t.length-1;n>=0;n--)if(t[n].isLightEvent(e)&&!t[n].isOff()&&(i++,i>10))return!0;return!1}function Y0(t){const e=t.beatmap.environment;if(!W0(t.beatmap.data.basicEvents,e))switch(e){case"DefaultEnvironment":case"OriginsEnvironment":case"TriangleEnvironment":case"NiceEnvironment":case"BigMirrorEnvironment":case"DragonsEnvironment":case"KDAEnvironment":case"MonstercatEnvironment":case"CrabRaveEnvironment":case"PanicEnvironment":case"RocketEnvironment":case"GreenDayEnvironment":case"GreenDayGrenadeEnvironment":case"TimbalandEnvironment":case"FitBeatEnvironment":case"LinkinParkEnvironment":case"BTSEnvironment":case"KaleidoscopeEnvironment":case"InterscopeEnvironment":case"SkrillexEnvironment":case"BillieEnvironment":case"HalloweenEnvironment":case"GagaEnvironment":case"GlassDesertEnvironment":return[{type:"string",label:"Insufficient light event",value:"",symbol:"rank"}];default:return[{type:"string",label:"Unknown light event",value:"v3 environment light should be manually checked",symbol:"rank"}]}return[]}const xl="Invalid Event Box",Ol="Check for valid event box group usage.",Nl=!0,Jc={name:xl,description:Ol,type:"event",order:{input:dt.EVENTS_INVALID_EVENT_BOX,output:bt.EVENTS_INVALID_EVENT_BOX},input:{enabled:Nl,params:{},html:U.createBlock(U.createCheckbox(function(){Jc.input.enabled=this.checked},xl,Ol,Nl))},run:q0},Il={EDMEnvironment:{0:24,1:24,2:24,3:24,4:24,5:24,6:10,7:10,8:10,9:10,10:10,11:10,12:10,13:10,14:1,15:1,16:1,17:1},LizzoEnvironment:{0:40,1:16,2:16,3:16,4:16,5:16,6:1,7:1,8:12,9:12,10:12,11:6,12:6,13:14,14:14,15:4,16:4,17:3,18:3,19:14},PyroEnvironment:{0:3,1:3,2:5,3:5,4:3,5:12,6:48,7:48,8:4,9:4,10:3,11:3,12:10,13:10},TheSecondEnvironment:{0:15,1:24,2:12,3:12,4:12,5:12,6:4,7:4,8:4,9:4,10:4,11:4,12:4,13:4},TheWeekndEnvironment:{0:4,1:4,2:4,3:4,4:8,5:4,6:4,7:12,8:1,9:6,10:25,11:25,12:25,13:25,14:25,15:25,16:25,17:25,18:25,19:25,20:3,21:3,22:8,23:8,29:3,30:3,31:3,32:3,33:3,34:3,35:3,36:3,37:6,38:6,40:2},RockMixtapeEnvironment:{0:5,1:5,2:10,3:10,4:10,5:10,6:10,7:10,8:10,9:10,10:10,11:10,12:10,13:10,14:3,15:10,16:5,17:5,18:24,19:24,20:12,21:12,22:8,23:8,24:36,25:3,26:36,27:3,28:5,29:2,30:16,31:4,32:4,33:4,34:4,35:2,36:2,37:2},WeaveEnvironment:{0:8,1:8,2:8,3:8,4:8,5:8,6:8,7:8,8:8,9:8,10:8,11:8,12:12,13:12,14:8,15:8},Dragons2Environment:{0:24,1:96,2:35,3:15,4:8,5:12,6:12,7:5,8:5,9:5,10:5,11:5,12:5},Panic2Environment:{0:7,1:7,2:7,3:7,4:8,5:8,6:24,7:24,8:24,9:6,10:6,11:6,12:6,13:14,14:14,15:2,16:28,17:28,18:1,19:1,20:12,21:1,22:12,23:1}};function X0(t,e){const i=[],n=[];if(!Il[e])return{defectID:[],defectFilter:[]};const o=e,r=bi[o][1],a=[...t.lightColorEventBoxGroups,...t.lightRotationEventBoxGroups,...t.lightTranslationEventBoxGroups];for(const s of a){r.includes(s.id)||i.push(s);for(const l of s.boxes){const c=l.filter;c.type===so.STEP_AND_OFFSET&&c.p0>Il[o][s.id]&&n.push(s)}}return{defectID:i,defectFilter:n}}function q0(t){const e=X0(t.beatmap.data,t.beatmap.environment),i=[];return e.defectID.length&&i.push({type:"time",label:"Invalid event box group ID",value:e.defectID,symbol:"error"}),e.defectFilter.length&&i.push({type:"time",label:"Invalid event box filter",value:e.defectFilter,symbol:"error"}),i}const Al="Unlit Bomb",Pl="Check for lighting around bomb.",$l=!0,Qc={name:Al,description:Pl,type:"event",order:{input:dt.EVENTS_UNLIT_BOMB,output:bt.EVENTS_UNLIT_BOMB},input:{enabled:$l,params:{},html:U.createBlock(U.createCheckbox(function(){Qc.input.enabled=this.checked},Al,Pl,$l))},run:Z0},K0=(t,e,i,n)=>{var p;if(!e.length)return[];const o=[],r=((p=bi[n])==null?void 0:p[0])??bi.DefaultEnvironment[0],a=e.filter(d=>d.isLightEvent(n)&&r.includes(d.type)).sort((d,u)=>d.type-u.type),s={0:{state:"off",time:0,fadeTime:0},1:{state:"off",time:0,fadeTime:0},2:{state:"off",time:0,fadeTime:0},3:{state:"off",time:0,fadeTime:0},4:{state:"off",time:0,fadeTime:0},6:{state:"off",time:0,fadeTime:0},7:{state:"off",time:0,fadeTime:0},10:{state:"off",time:0,fadeTime:0},11:{state:"off",time:0,fadeTime:0}},l={};r.forEach(d=>l[d]=[[0,!1]]);const c=i.toBeatTime(1,!1),h=i.toBeatTime(.25,!1);for(let d=0,u=a.length;d<u;d++){const m=a[d];if((m.isOn()||m.isFlash())&&s[m.type].state!=="on"){s[m.type]={state:"on",time:m.time,fadeTime:0};const b=l[m.type].find(y=>y[0]>=m.time);b?(b[0]=m.time,b[1]=!0):l[m.type].push([m.time,!0])}if(m.isFade()){s[m.type]={state:"off",time:m.time,fadeTime:c};const b=l[m.type].find(y=>y[0]>=m.time);b?(b[0]=m.time,b[1]=!0):l[m.type].push([m.time,!0]),l[m.type].push([m.time+c,!1])}(((m==null?void 0:m.floatValue)??1)<.25||m.isOff()||m.customData._color&&(typeof m.customData._color[3]=="number"&&m.customData._color[3]<.25||Math.max(m.customData._color[0],m.customData._color[1],m.customData._color[2])<.25)||m.customData.color&&(typeof m.customData.color[3]=="number"&&m.customData.color[3]<.25||Math.max(m.customData.color[0],m.customData.color[1],m.customData.color[2])<.25))&&s[m.type].state!=="off"&&(s[m.type]={state:"off",time:m.time,fadeTime:s[m.type].state==="on"?h:Math.min(h,s[m.type].fadeTime)},l[m.type].push([m.time+(s[m.type].state==="on"?h:Math.min(h,s[m.type].fadeTime)),!1]))}for(const d in l)l[d].reverse();for(let d=0,u=t.length,m=!1;d<u;d++){const b=t[d];m=!1;for(const y in l){const v=l[y].find(_=>_[0]<=b.time);v&&(m=m||v[1])}m||o.push(b)}return o};function Z0(t){const e=K0(t.beatmap.data.bombNotes,t.beatmap.data.basicEvents,t.beatmap.timeProcessor,t.beatmap.environment);return e.length?[{type:"time",label:"Unlit bomb",value:e,symbol:"warning"}]:[]}const Ml=Object.freeze(Object.defineProperty({__proto__:null,insufficientLight:Zc,invalidEventBox:Jc,unlitBomb:Qc},Symbol.toStringTag,{value:"Module"})),Fl="Hot Start",jl="Check for first interactive object starting from start time.",zl=!0,Vl=1.5,Gi={name:Fl,description:jl,type:"other",order:{input:dt.OTHERS_HOT_START,output:bt.OTHERS_HOT_START},input:{enabled:zl,params:{time:Vl},html:U.createBlock(U.createCheckbox(function(){Gi.input.enabled=this.checked},Fl+" (s): ",jl,zl),U.createNumber(function(){Gi.input.params.time=M(Math.abs(parseFloat(this.value)),3),this.value=Gi.input.params.time.toString()},"",Vl,0,null,.1))},run:J0};function J0(t){const{time:e}=Gi.input.params,i=t.beatmap.timeProcessor.toRealTime(wo(t.beatmap.data));return i<e?[{type:"string",label:"Hot start",value:`${M(i,2)}s`,symbol:"warning"}]:[]}const Gl="Difficulty Label Check",Hl="For ranking purpose, check difficulty label to fit rankability criteria.",Ul=!0,th={name:Gl,description:Hl,type:"other",order:{input:dt.OTHERS_DIFFICULTY_LABEL,output:bt.OTHERS_DIFFICULTY_LABEL},input:{enabled:Ul,params:{},html:U.createBlock(U.createCheckbox(function(){th.input.enabled=this.checked},Gl,Hl,Ul))},run:Q0};function Q0(t){const e=t.beatmap.settings.customData._difficultyLabel;return e&&e.length>30?[{type:"string",label:`Difficulty label is too long (${e.length} characters)`,value:"exceeded 30 max characters by ranking criteria",symbol:"rank"}]:[]}const Wl="NJS Check",Yl="Check note jump speed for suitable value.",Xl=!0,eh={name:Wl,description:Yl,type:"other",order:{input:dt.OTHERS_NJS,output:bt.OTHERS_NJS},input:{enabled:Xl,params:{},html:U.createBlock(U.createCheckbox(function(){eh.input.enabled=this.checked},Wl,Yl,Xl))},run:tb};function tb(t){const{njs:e,timeProcessor:i}=t.beatmap,n=[];return t.beatmap.settings.njs===0&&n.push({type:"string",label:"Unset NJS",value:"fallback NJS is used",symbol:"error"}),e.value>23&&n.push({type:"string",label:`NJS is too high (${M(e.value,2)})`,value:"use lower whenever possible",symbol:"warning"}),e.value<3&&n.push({type:"string",label:`NJS is too low (${M(e.value,2)})`,value:"timing is less significant below this",symbol:"warning"}),e.jd>36&&n.push({type:"string",label:"Very high jump distance",value:`${M(e.jd,2)}`,symbol:"warning"}),e.jd<18&&n.push({type:"string",label:"Very low jump distance",value:`${M(e.jd,2)}`,symbol:"warning"}),e.jd>e.calcJdOptimal()[1]&&n.push({type:"string",label:`High jump distance warning (>${M(e.calcJdOptimal()[1],2)})`,value:"NJS & offset may be uncomfortable to play",symbol:"warning"}),i.toRealTime(e.hjd,!1)<.42&&n.push({type:"string",label:`Very quick reaction time (${M(i.toRealTime(e.hjd,!1)*1e3)}ms)`,value:"may lead to suboptimal gameplay",symbol:"warning"}),e.calcHjd(0)+e.offset<qt.HJD_MIN&&n.push({type:"string",label:"Unnecessary negative offset",value:`will not drop below ${qt.HJD_MIN}`,symbol:"warning"}),n}const ql="Outside Playable Object",Kl="Look for any object starting before and after song timer.",Zl=!0,ih={name:ql,description:Kl,type:"other",order:{input:dt.OTHERS_OUTSIDE_PLAYABLE,output:bt.OTHERS_OUTSIDE_PLAYABLE},input:{enabled:Zl,params:{},html:U.createBlock(U.createCheckbox(function(){ih.input.enabled=this.checked},ql,Kl,Zl))},run:eb};function te(t,e,i){e.length&&e[0].time<0&&i.push({type:"string",label:t+"(s) before start time",value:`${M(e[0].time,3)} (${Zt(e[0].customData.__mapcheck_secondtime)}`,symbol:"error"})}function ee(t,e,i,n){e.length&&e[e.length-1].time>i&&n.push({type:"string",label:t+"(s) after end time",value:`${M(e[e.length-1].time,3)} (${Zt(e[e.length-1].customData.__mapcheck_secondtime)})`,symbol:"error"})}function eb(t){const e=t.audioDuration,i=t.beatmap.timeProcessor,{colorNotes:n,bombNotes:o,obstacles:r,arcs:a,chains:s,basicEvents:l,colorBoostEvents:c,waypoints:h,lightColorEventBoxGroups:p,lightRotationEventBoxGroups:d,lightTranslationEventBoxGroups:u,fxEventBoxGroups:m}=t.beatmap.data,b=[];if(e){let y=i.toBeatTime(e,!0);te("Note",n,b),te("Bomb",o,b),te("Obstacle",r,b),te("Arc",a,b),te("Chain",s,b),te("Event",l,b),te("Color Boost",c,b),te("Waypoint",h,b),te("Light Color Event Box Group",p,b),te("Light Rotation Event Box Group",d,b),te("Light Translation Event Box Group",u,b),te("FX Event Box Group",m,b),ee("Note",n,y,b),ee("Bomb",o,y,b),ee("Obstacle",r,y,b),ee("Arc",a,y,b),ee("Chain",s,y,b),ee("Event",l,y,b),ee("Color Boost",c,y,b),ee("Waypoint",h,y,b),ee("Light Color Event Box Group",p,y,b),ee("Light Rotation Event Box Group",d,y,b),ee("Light Translation Event Box Group",u,y,b),ee("FX Event Box Group",m,y,b)}return b}const Jl="Invalid Object",Ql="Validate beatmap object to be compatible with vanilla (ignores for modded).",tu=!0,nh={name:Jl,description:Ql,type:"other",order:{input:dt.OTHERS_INVALID_OBJECT,output:bt.OTHERS_INVALID_OBJECT},input:{enabled:tu,params:{},html:U.createBlock(U.createCheckbox(function(){nh.input.enabled=this.checked},Jl,Ql,tu))},run:ib};function ib(t){var Y,et;const{colorNotes:e,bombNotes:i,obstacles:n,arcs:o,chains:r,waypoints:a,basicEvents:s,colorBoostEvents:l,lightColorEventBoxGroups:c,lightRotationEventBoxGroups:h,lightTranslationEventBoxGroups:p,fxEventBoxGroups:d}=t.beatmap.data;let u=[],m=[],b=[],y=[],v=[];if(!((Y=t.beatmap.settings.customData._requirements)!=null&&Y.includes("Mapping Extensions")))if((et=t.beatmap.settings.customData._requirements)!=null&&et.includes("Noodle Extensions")){const S=t.beatmap.rawVersion===2?Du:Cu;u=e.filter(Ru),m=n.filter(S),b=i.filter(Tu),y=o.filter(Rm),v=r.filter(km)}else u=e.filter(S=>!S.isValid()),m=n.filter(S=>!S.isValid()),b=i.filter(S=>!S.isValid()),y=o.filter(S=>!S.isValid()),v=r.filter(S=>!S.isValid());const _=a.filter(S=>!S.isValid()),w=s.filter(S=>!S.isValid()),C=l.filter(S=>!S.isValid()),T=c.filter(S=>!S.isValid()),P=h.filter(S=>!S.isValid()),A=p.filter(S=>!S.isValid()),V=d.filter(S=>!S.isValid()),O=[];return u.length&&O.push({type:"time",label:"Invalid note",value:u,symbol:"error"}),b.length&&O.push({type:"time",label:"Invalid bomb",value:b,symbol:"error"}),y.length&&O.push({type:"time",label:"Invalid arc",value:y,symbol:"error"}),v.length&&O.push({type:"time",label:"Invalid chain",value:v,symbol:"error"}),m.length&&O.push({type:"time",label:"Invalid obstacle",value:m,symbol:"error"}),_.length&&O.push({type:"time",label:"Invalid waypoint",value:_,symbol:"error"}),w.length&&O.push({type:"time",label:"Invalid event",value:w,symbol:"error"}),C.length&&O.push({type:"time",label:"Invalid color boost",value:C,symbol:"error"}),T.length&&O.push({type:"time",label:"Invalid light color event",value:T,symbol:"error"}),P.length&&O.push({type:"time",label:"Invalid light rotation event",value:P,symbol:"error"}),A.length&&O.push({type:"time",label:"Invalid light translation event",value:A,symbol:"error"}),V.length&&O.push({type:"time",label:"Invalid FX event",value:V,symbol:"error"}),O}const eu=Object.freeze(Object.defineProperty({__proto__:null,difficultyLabel:th,hotStart:Gi,invalidObject:nh,njs:eh,outsidePlayable:ih},Symbol.toStringTag,{value:"Module"}));class oh{constructor(){}static getNote(){return Object.keys(gl).map(e=>gl[e])}static getObstacle(){return Object.keys(Rl).map(e=>Rl[e])}static getEvent(){return Object.keys(Ml).map(e=>Ml[e])}static getOther(){return Object.keys(eu).map(e=>eu[e])}static getGeneral(){return Object.keys(sa).map(e=>sa[e])}static getDifficulty(){return[...this.getNote(),...this.getObstacle(),...this.getEvent(),...this.getOther()]}static getAll(){return[...this.getNote(),...this.getObstacle(),...this.getEvent(),...this.getOther(),...this.getGeneral()]}}function mi(t){return["analyzer",t]}const rh=oh.getAll().sort((t,e)=>t.order.input-e.order.input),sh=[...rh].sort((t,e)=>t.order.output-e.order.output);function ah(){mt.analysis={general:{output:[]},beatmap:[]}}function nb(){var n;const t=mt.beatmapInfo;if(!t)return J.tError(mi("runGeneral"),"Could not analyse, missing map info"),[];mt.analysis||ah();const e=(n=mt.analysis)==null?void 0:n.general;J.tInfo(mi("runGeneral"),"Analysing general");const i=[];return sh.filter(o=>o.type==="general").forEach(o=>{if(o.input.enabled)try{const r=o.run({audioDuration:mt.duration??null,mapDuration:0,beatmap:null,info:t});i.push(...r)}catch(r){J.tError(mi("runGeneral"),r)}}),e&&(e.output=i),i}function lh(t,e){var a,s,l;const i=mt.beatmapInfo;if(!i)return J.tError(mi("runDifficulty"),"Could not analyse, missing map info"),[];mt.analysis||ah();const n=(a=mt.beatmaps)==null?void 0:a.find(c=>c.settings.characteristic===t&&c.settings.difficulty===e);if(!n)return J.tError(mi("runDifficulty"),"Could not analyse, missing map data"),[];const o=(s=mt.analysis)==null?void 0:s.beatmap.find(c=>c.difficulty===e&&c.characteristic===t);qt.create(n.timeProcessor.bpm,n.settings.njs||qt.FallbackNJS[n.settings.difficulty],n.settings.njsOffset),J.tInfo(mi("runDifficulty"),`Analysing ${t} ${e}`);const r=[];return sh.filter(c=>c.type!=="general").forEach(c=>{if(c.input.enabled)try{const h=c.run({audioDuration:mt.duration??null,mapDuration:n.timeProcessor.toRealTime(Wi(n.data)),beatmap:n,info:i});r.push(...h)}catch(h){J.tError(mi("runDifficulty"),h)}}),o?o.output=r:(l=mt.analysis)==null||l.beatmap.push({characteristic:t,difficulty:e,output:r}),r}function ob(t){oh.getDifficulty().sort((i,n)=>i.order.output-n.order.output).forEach(i=>{i.input.adjustTime&&i.input.adjustTime(t)})}function rb(){var t;(t=mt.beatmaps)==null||t.forEach(e=>lh(e.settings.characteristic,e.settings.difficulty))}const gi={toolListInput:rh,runGeneral:nb,runDifficulty:lh,adjustTime:ob,applyAll:rb};function uh(t,e,i,n,o,r){const a=document.createElement("div");a.className="tabs__container";const s=document.createElement("input");s.className="tabs__radio",s.type="radio",s.id=t,s.name=i,s.value=n,s.checked=o,s.addEventListener("change",r),a.appendChild(s);const l=document.createElement("label");l.className="tabs__label tabs__label-block unselectable",l.htmlFor=t;const c=document.createElement("div"),h=e.split(`
`);for(let p=0;p<h.length;p++){const d=h[p],u=document.createElement("span");u.textContent=d,c.appendChild(u),p!==h.length-1&&c.appendChild(document.createElement("br"))}return l.appendChild(c),a.appendChild(l),a}const sb=document.getElementById("tabs__info"),ab=document.getElementById("tabs__checks"),lb=document.getElementById("tabs__stats"),ub=document.getElementById("tabs__settings");function cb(t){sb.checked=t==="info",ab.checked=t==="checks",lb.checked=t==="stats",ub.checked=t==="settings"}const Si=document.querySelector("#select-characteristic"),Ae=document.querySelector("#select-difficulty");let Dn=[],Hi=[];const Un=[];function ch(t){for(;Si.firstChild;)Si.removeChild(Si.firstChild);for(Dn=[];Ae.firstChild;)Ae.removeChild(Ae.firstChild);if(Hi=[],!t){const n=document.createElement("div");n.className="selection__content";const o=document.createElement("span");o.textContent="Empty",n.appendChild(o),Si.appendChild(n),wn();return}let e=!0;const i=new Set;if(t.difficulties.forEach(n=>{var s;if(i.has(n.characteristic))return;i.add(n.characteristic);const o=(s=t.customData._characteristics)==null?void 0:s.find(l=>l.characteristic===n.characteristic),r=o?`${o.label}
(${rr[n.characteristic]||n.characteristic})`:rr[n.characteristic]||n.characteristic,a=uh(`select-${n.characteristic}`,r,"select-characteristic",n.characteristic,e,hb);Dn.push(a.firstChild),Si.appendChild(a),e&&(wn(n.characteristic),e=!1)}),Dn.length===0){const n=document.createElement("div");n.className="selection__content";const o=document.createElement("span");o.textContent="Empty",n.appendChild(o),Si.appendChild(n),wn()}}function wn(t){const e=mt.beatmapInfo;let i=Ji();for(;Ae.firstChild;)Ae.removeChild(Ae.firstChild);if(Hi=[],!t||!e){const o=document.createElement("div");o.className="selection__content";const r=document.createElement("span");r.textContent="Empty",o.appendChild(r),Ae.appendChild(o);return}const n=e.difficulties.findIndex(o=>o.difficulty===i&&o.characteristic===t);for(let o=0;o<e.difficulties.length;o++){const r=e.difficulties[o];if(t!==r.characteristic)continue;const a=r.customData._difficultyLabel?`${r.customData._difficultyLabel}
(${ei[r.difficulty]||r.difficulty})`:ei[r.difficulty]||r.difficulty,s=uh(`select-${r.difficulty}`,a,"select-difficulty",r.difficulty,n===-1||o===n,mb);if(Hi.push(s.firstChild),Ae.appendChild(s),n===-1||o===n){const l=mt.beatmaps.find(c=>c.settings.difficulty===r.difficulty&&c.settings.characteristic===e.difficulties[o].characteristic);if(!l)throw new Error("missing data");uc(mt.beatmapInfo,l),Un.forEach(c=>c(r.characteristic,r.difficulty))}}if(Hi.length===0){const o=document.createElement("div");o.className="selection__content";const r=document.createElement("span");r.textContent="Empty",o.appendChild(r),Ae.appendChild(o)}}function hb(t){var n;const e=t.target,i=(n=mt.beatmapInfo)==null?void 0:n.difficulties.find(o=>o.characteristic===e.value);wn(i==null?void 0:i.characteristic)}function mb(t){var o,r;const e=t.target,i=(o=mt.beatmapInfo)==null?void 0:o.difficulties.find(a=>a.characteristic===Zi());if(!i)throw new Error("aaaaaaaaaaaaaaaaaaa");const n=(r=mt.beatmaps)==null?void 0:r.find(a=>a.settings.difficulty===e.value&&a.settings.characteristic===i.characteristic);n&&(uc(mt.beatmapInfo,n),Un.forEach(a=>a(n.settings.characteristic,n.settings.difficulty)))}function Zi(){var t;return((t=Dn.filter(e=>e.checked)[0])==null?void 0:t.value)??null}function Ji(){var t;return((t=Hi.filter(e=>e.checked)[0])==null?void 0:t.value)??null}function fb(){ch()}const hh={populateSelectCharacteristic:ch,reset:fb};function mh(t,e){switch(e){case"rank":t='<span title="Ranking: for rankability reason."> 🚧 </span>'+t;break;case"error":t='<span title="Error: should be fixed unless you know what you are doing."> ❌ </span>'+t;break;case"warning":t='<span title="Warning: not necessarily needed to be fixed, worth considering."> ❗ </span>'+t;break;case"info":t='<span title="Info: no action necessary, take note."> ⚠️ </span>'+t;break}return t}function iu(t,e,i){const n=document.createElement("div");return t=mh(t,i),e?n.innerHTML=`<b>${t}:</b> ${e}`:n.innerHTML=`<b>${t}</b>`,n}function pb(t,e,i){return e===0||t.time!==i[e-1].time}function db(t,e,i){const n=document.createElement("div");return it.deduplicateTime&&(e=e.filter(pb)),t=mh(t,i),n.innerHTML=`<b>${t} [${e.length}]:</b> ${e.map(o=>{switch(it.beatNumbering){case"realtime":return`<span title="Beat ${M(o.customData.__mapcheck_beattime,it.rounding)}">${Zt(o.customData.__mapcheck_secondtime)}</span>`;case"realtimems":return`<span title="Beat ${M(o.customData.__mapcheck_beattime,it.rounding)}">${gn(o.customData.__mapcheck_secondtime)}</span>`;case"jsontime":return`<span title="Time ${gn(o.customData.__mapcheck_secondtime)}">${M(o.time,it.rounding)}</span>`;case"beattime":default:return`<span title="Time ${gn(o.customData.__mapcheck_secondtime)}">${M(o.customData.__mapcheck_beattime,it.rounding)}</span>`}}).join(", ")}`,n}const Qi="UI Checks: ",bb=document.querySelectorAll(".difficulty__label"),gb=document.querySelector(".checks__note-content"),vb=document.querySelector(".checks__obstacle-content"),_b=document.querySelector(".checks__event-content"),yb=document.querySelector(".checks__other-content"),Eb=document.querySelector(".checks__general-content"),We=document.querySelector(".checks__output-diff"),Ye=document.querySelector(".checks__output-general"),Db=document.querySelector(".checks__apply-this"),wb=document.querySelector(".checks__apply-all"),Sb=document.querySelector(".checks__apply-general");Db.addEventListener("click",Lb);wb.addEventListener("click",Bb);Sb.addEventListener("click",xb);function fh(t){switch(t.type){case"string":return iu(t.label,t.value,t.symbol);case"number":return iu(t.label,t.value.join(", "),t.symbol);case"time":return db(t.label,t.value,t.symbol);case"html":const e=document.createElement("div");return t.value.forEach(i=>e.appendChild(i)),e;default:throw new Error("Unexpected result type")}}function ph(){var e;const t=(e=mt.analysis)==null?void 0:e.general;if(!t){Ye.textContent="ERROR: could not find analysis for general";return}if(!t.output){Ye.textContent="ERROR: could not find HTML for general";return}Ye.innerHTML="",t.output.forEach(i=>Ye.appendChild(fh(i))),Ye.firstChild||(Ye.textContent="No issues found.")}function Wn(t,e){var n;if(!t&&!e&&(t=Zi(),e=Ji()),!t||!e)throw new Error(Qi+"something went wrong!");We.innerHTML="";const i=(n=mt.analysis)==null?void 0:n.beatmap.find(o=>o.difficulty===e&&o.characteristic===t);if(!i){We.textContent="ERROR: could not find analysis for "+t+" "+e;return}if(!i.output){We.textContent="ERROR: could not find HTML for "+t+" "+e;return}i.output.forEach(o=>We.appendChild(fh(o))),We.firstChild||(We.textContent="No issues found.")}function dh(t){bb.forEach(e=>e.textContent=t)}function Cb(){const t=mt.beatmapInfo;if(!t)throw new Error(Qi+"could not find map info");const e=Ln.create(t.audio.bpm);gi.adjustTime(e)}function Tb(){gi.toolListInput.forEach(t=>{if(t.input.html)switch(t.type){case"note":{gb.appendChild(t.input.html);break}case"obstacle":{vb.appendChild(t.input.html);break}case"event":{_b.appendChild(t.input.html);break}case"other":{yb.appendChild(t.input.html);break}case"general":{Eb.appendChild(t.input.html);break}default:console.error(Qi+"could not recognise type "+t.type+" for "+t.name)}})}function Rb(){Ye&&(Ye.innerHTML="No output."),We&&(We.innerHTML="No output.")}function kb(){Rb(),dh("Difficulty Label")}function Lb(){const t=Zi(),e=Ji();if(!t||!e)throw new Error(Qi+"characteristic/difficulty does not exist");Ct.status("info",`Re-analysing ${t} ${e}`),gi.runDifficulty(t,e),Ct.status("info",`Re-analysed ${t} ${e}`),Wn(t,e)}function Bb(){const t=Zi(),e=Ji();if(!t||!e)throw new Error(Qi+"characteristic/difficulty does not exist");Ct.status("info","Re-analysing all difficulties"),gi.applyAll(),Ct.status("info","Re-analysed all difficulties"),Wn(t,e)}function xb(){Ct.status("info","Re-analysing general"),gi.runGeneral(),Ct.status("info","Re-analysed general"),ph()}Un.push(Wn);const Ui={displayOutputGeneral:ph,displayOutputDifficulty:Wn,setDifficultyLabel:dh,adjustBeatTime:Cb,populateTool:Tb,reset:kb};function Le(t){return["load",t]}async function Ob(t,e,i=""){if(t.version===4){const o=e.file(i+t.audio.audioDataFilename);if(J.tInfo(Le("extractBPMInfo"),"loading",t.audio.audioDataFilename),o){const r=await o.async("string").then(JSON.parse);return{duration:r.songSampleCount/r.songFrequency,bpm:r.bpmData.map(a=>({time:a.sb,bpm:(a.eb-a.sb)/((a.ei-a.si)/r.songFrequency)*60}))}}}const n=e.file(i+"BPMInfo.dat");if(J.tInfo(Le("extractBPMInfo"),"loading BPMInfo.dat"),n){const o=await n.async("string").then(JSON.parse);return{duration:o._songSampleCount/o._songFrequency,bpm:o._regions.map(r=>({time:r._startBeat,bpm:(r._endBeat-r._startBeat)/((r._endSampleIndex-r._startSampleIndex)/o._songFrequency)*60}))}}return null}async function Nb(t,e=""){const i=t.file(e+"Info.dat")||t.file(e+"info.dat")||t.file(e+"Info.json")||t.file(e+"info.json");if(!i)throw new Error("Couldn't find Info.dat");return J.tInfo(Le("extractInfo"),"loading info"),i.async("string").then(JSON.parse).then(kp)}async function Ib(t,e,i=""){const n=t.file(i+e.lightshowFilename);n||J.tError(Le("extractBeatmaps"),`Missing ${e.lightshowFilename} lightshow file for ${e.characteristic} ${e.difficulty}, ignoring.`),J.tInfo(Le("extractBeatmaps"),`Loading ${e.characteristic} ${e.difficulty} lightshow`);try{const o=await n.async("string").then(JSON.parse),r=Lp(o,{sort:it.sorting,schemaCheck:{enabled:it.dataCheck}});return[o,r]}catch(o){J.tError(Le("extractBeatmaps"),`Could not load ${e.lightshowFilename} lightshow file; ${o}`)}return null}function Ab(t,e,i=""){const n={};return t.difficulties.map(async o=>{var b;const r=o,a=e.file(i+r.filename);if(!a)return J.tError(Le("extractBeatmaps"),`Missing ${r.filename} file for ${r.characteristic} ${r.difficulty}, ignoring.`),null;J.tInfo(Le("extractBeatmaps"),`Loading ${r.characteristic} ${r.difficulty}`);let s;try{s=await a.async("string").then(JSON.parse)}catch(y){throw new Error(`${r.characteristic} ${r.difficulty} ${y}`)}let l=typeof s._version=="string"?s._version.at(0):typeof s.version=="string"?s.version.at(0):null,c;l?c=parseInt(l):(J.tWarn(Le("extractBeatmaps"),"Could not identify beatmap version from JSON, assume implicit version",2),c=2),s._notes&&s.version&&J.tError(Le("extractBeatmaps"),`${r.characteristic} ${r.difficulty} contains 2 version of the map in the same file, attempting to load v3 instead`);let h=Rp(s,{sort:it.sorting,schemaCheck:{enabled:it.dataCheck}}),p=c===4?new Re:h,d;if(c===4){n[r.lightshowFilename]||(n[r.lightshowFilename]=Ib(e,r,i));const y=await n[r.lightshowFilename];y&&(d=y[0],p=y[1])}h.lightshow=p.lightshow;const u=Ln.create(t.audio.bpm,c===3?[...h.customData.BPMChanges??[],...(s.bpmEvents??[]).map(y=>y)]:c===2?h.customData._BPMChanges??h.customData._bpmChanges:c===1?s._BPMChanges:[],(b=r.customData)==null?void 0:b._editorOffset);$b(h,u);const m=t.environmentNames.at(r.environmentId)||(r.characteristic==="360Degree"||r.characteristic==="90Degree"?t.environmentBase.allDirections:t.environmentBase.normal)||"DefaultEnvironment";return{settings:r,environment:m,timeProcessor:u,njs:new qt(u.bpm,r.njs,r.njsOffset),data:h,noteContainer:Pb(h),swingAnalysis:id(h,u,r.characteristic,r.difficulty),score:Om(h),stats:{basicEvents:Wp(h.basicEvents,h.colorBoostEvents,m),lightColorEventBoxGroups:hn(h.lightColorEventBoxGroups,m),lightRotationEventBoxGroups:hn(h.lightRotationEventBoxGroups,m),lightTranslationEventBoxGroups:hn(h.lightTranslationEventBoxGroups,m),fxEventBoxGroups:hn(h.fxEventBoxGroups,m),notes:eo(h.colorNotes),bombs:Yp(h.bombNotes),arcs:eo(h.arcs),chains:eo(h.chains),obstacles:Zp(h.obstacles)},rawVersion:c,rawData:s,rawLightshow:d}})}function Pb(t){return[...t.colorNotes.map(e=>({data:e,type:lt.COLOR})),...t.bombNotes.map(e=>({data:e,type:lt.BOMB})),...t.chains.map(e=>({data:e,type:lt.CHAIN})),...t.arcs.map(e=>({data:e,type:lt.ARC}))].sort((e,i)=>e.data.time-i.data.time)}function $b(t,e){const i=Mb(e);t.difficulty.customData.__mapcheck_precalculatetime||(t.bpmEvents.forEach(i),t.rotationEvents.forEach(i),t.colorNotes.forEach(i),t.bombNotes.forEach(i),t.obstacles.forEach(i),t.arcs.forEach(i),t.chains.forEach(i),t.difficulty.customData.__mapcheck_precalculatetime=!0),t.lightshow.customData.__mapcheck_precalculatetimelightshow||(t.waypoints.forEach(i),t.basicEvents.forEach(i),t.colorBoostEvents.forEach(i),t.lightColorEventBoxGroups.forEach(i),t.lightRotationEventBoxGroups.forEach(i),t.lightTranslationEventBoxGroups.forEach(i),t.fxEventBoxGroups.forEach(i),t.lightshow.customData.__mapcheck_precalculatetimelightshow=!0)}function Mb(t){return function(e){e.customData.__mapcheck_secondtime=t.toRealTime(e.time,!0),e.customData.__mapcheck_beattime=t.adjustTime(e.time)}}async function bh(t){return new Promise(function(e,i){const n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="json",n.timeout=5e3;let o=Date.now();n.onprogress=()=>{n.timeout+=Date.now()-o},n.onload=()=>{n.status===200&&e(n.response),n.status===404&&i("Error 404: Map does not exist"),n.status===403&&i("Error 403: Forbidden"),i(`Error ${n.status}`)},n.onerror=()=>{i("Error downloading")},n.ontimeout=()=>{i("Connection timeout")},n.send()})}async function Fb(t){const e=`https://api.beatsaver.com/maps/id/${t}`,i=await bh(e);if(i!=null&&i.versions.length)return i.versions[i.versions.length-1].downloadURL;throw new Error("could not find map download link")}async function jb(t){const e=`https://api.beatsaver.com/maps/hash/${t}`,i=await bh(e);if(i!=null&&i.versions.length)return i.versions[i.versions.length-1].downloadURL;throw new Error("could not find map download link")}function gh(t){const e=/^(http|ftp|https):\/\/([\w_-]+(?:(?:\.[\w_-]+)+))([\w.,@?^=%&:/~+#-]*[\w@?^=%&/~+#-])?/;if(t=t.trim(),/^http:\/\//.test(t)&&(t=t.replace("http://","https://")),e.test(t))return t;throw new Error("Invalid URL")}function vh(t){const e=/^[0-9a-fA-F]{1,6}$/;if(t=t.trim(),/^!bsr /.test(t)&&(t=t.replace("!bsr ","")),e.test(t))return t;throw new Error("Invalid ID")}function nu(t){return new Promise(e=>setTimeout(e,t))}function Xi(t){return["download",t]}async function Ao(t){return new Promise(function(e,i){const n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.timeout=5e3;let o=Date.now();n.onprogress=r=>{n.timeout+=Date.now()-o,Ct.status("download",`Downloading map: ${M(r.loaded/1024/1024,1)}MB / ${M(r.total/1024/1024,1)}MB`,r.loaded/r.total*100)},n.onload=()=>{n.status===200&&e(n.response),n.status===404&&i("Error 404: Map/link does not exist"),n.status===403&&i("Error 403: Forbidden"),i(`Error ${n.status}`)},n.onerror=()=>{i("Error downloading")},n.ontimeout=()=>{i("Connection timeout")},n.send()})}async function _h(t){const e=vh(t);J.tInfo(Xi("downloadFromID"),`fetching download URL from BeatSaver for map ID ${e}`),Ct.status("info","Fetching download URL from BeatSaver",0);const i=await Fb(e);J.tInfo(Xi("downloadFromID"),`downloading from BeatSaver for map ID ${e}`),Ct.status("info","Requesting download from BeatSaver",0);const n=await Ao(i);return At.setCoverLink("https://beatsaver.com/maps/"+e,e),n}async function zb(t){const e=gh(t);if(e.match(/^(https?:\/\/)?(www\.)?beatsaver\.com\/maps\//))return _h(e.replace(/^https?:\/\/(www\.)?beatsaver\.com\/maps\//,"").match(/[a-fA-F0-9]*/)[0]);Ct.status("info","Requesting download from link",0),J.tInfo(Xi("downloadFromURL"),`downloading from ${e}`);let i=await Ao("https://cors.bsmg.dev/"+e);return At.setCoverLink(e),i}async function Vb(t){let e;if(yo(t.trim()))e=t.trim();else throw new Error("invalid hash");J.tInfo(Xi("downloadFromHash"),`fetching download URL from BeatSaver for map hash ${e}`),Ct.status("info","Fetching download URL from BeatSaver",0);const i=await jb(e);return J.tInfo(Xi("downloadFromHash"),`downloading from BeatSaver for map hash ${e}`),Ct.status("info","Requesting download from BeatSaver",0),await Ao(i)}var dn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Gb(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function bn(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var yh={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(t,e){(function(i){t.exports=i()})(function(){return function i(n,o,r){function a(c,h){if(!o[c]){if(!n[c]){var p=typeof bn=="function"&&bn;if(!h&&p)return p(c,!0);if(s)return s(c,!0);var d=new Error("Cannot find module '"+c+"'");throw d.code="MODULE_NOT_FOUND",d}var u=o[c]={exports:{}};n[c][0].call(u.exports,function(m){var b=n[c][1][m];return a(b||m)},u,u.exports,i,n,o,r)}return o[c].exports}for(var s=typeof bn=="function"&&bn,l=0;l<r.length;l++)a(r[l]);return a}({1:[function(i,n,o){var r=i("./utils"),a=i("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";o.encode=function(l){for(var c,h,p,d,u,m,b,y=[],v=0,_=l.length,w=_,C=r.getTypeOf(l)!=="string";v<l.length;)w=_-v,p=C?(c=l[v++],h=v<_?l[v++]:0,v<_?l[v++]:0):(c=l.charCodeAt(v++),h=v<_?l.charCodeAt(v++):0,v<_?l.charCodeAt(v++):0),d=c>>2,u=(3&c)<<4|h>>4,m=1<w?(15&h)<<2|p>>6:64,b=2<w?63&p:64,y.push(s.charAt(d)+s.charAt(u)+s.charAt(m)+s.charAt(b));return y.join("")},o.decode=function(l){var c,h,p,d,u,m,b=0,y=0,v="data:";if(l.substr(0,v.length)===v)throw new Error("Invalid base64 input, it looks like a data url.");var _,w=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===s.charAt(64)&&w--,l.charAt(l.length-2)===s.charAt(64)&&w--,w%1!=0)throw new Error("Invalid base64 input, bad content length.");for(_=a.uint8array?new Uint8Array(0|w):new Array(0|w);b<l.length;)c=s.indexOf(l.charAt(b++))<<2|(d=s.indexOf(l.charAt(b++)))>>4,h=(15&d)<<4|(u=s.indexOf(l.charAt(b++)))>>2,p=(3&u)<<6|(m=s.indexOf(l.charAt(b++))),_[y++]=c,u!==64&&(_[y++]=h),m!==64&&(_[y++]=p);return _}},{"./support":30,"./utils":32}],2:[function(i,n,o){var r=i("./external"),a=i("./stream/DataWorker"),s=i("./stream/Crc32Probe"),l=i("./stream/DataLengthProbe");function c(h,p,d,u,m){this.compressedSize=h,this.uncompressedSize=p,this.crc32=d,this.compression=u,this.compressedContent=m}c.prototype={getContentWorker:function(){var h=new a(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),p=this;return h.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),h},getCompressedWorker:function(){return new a(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(h,p,d){return h.pipe(new s).pipe(new l("uncompressedSize")).pipe(p.compressWorker(d)).pipe(new l("compressedSize")).withStreamInfo("compression",p)},n.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(i,n,o){var r=i("./stream/GenericWorker");o.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},o.DEFLATE=i("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(i,n,o){var r=i("./utils"),a=function(){for(var s,l=[],c=0;c<256;c++){s=c;for(var h=0;h<8;h++)s=1&s?3988292384^s>>>1:s>>>1;l[c]=s}return l}();n.exports=function(s,l){return s!==void 0&&s.length?r.getTypeOf(s)!=="string"?function(c,h,p,d){var u=a,m=d+p;c^=-1;for(var b=d;b<m;b++)c=c>>>8^u[255&(c^h[b])];return-1^c}(0|l,s,s.length,0):function(c,h,p,d){var u=a,m=d+p;c^=-1;for(var b=d;b<m;b++)c=c>>>8^u[255&(c^h.charCodeAt(b))];return-1^c}(0|l,s,s.length,0):0}},{"./utils":32}],5:[function(i,n,o){o.base64=!1,o.binary=!1,o.dir=!1,o.createFolders=!0,o.date=null,o.compression=null,o.compressionOptions=null,o.comment=null,o.unixPermissions=null,o.dosPermissions=null},{}],6:[function(i,n,o){var r=null;r=typeof Promise<"u"?Promise:i("lie"),n.exports={Promise:r}},{lie:37}],7:[function(i,n,o){var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=i("pako"),s=i("./utils"),l=i("./stream/GenericWorker"),c=r?"uint8array":"array";function h(p,d){l.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=d,this.meta={}}o.magic="\b\0",s.inherits(h,l),h.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(c,p.data),!1)},h.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},h.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},h.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(d){p.push({data:d,meta:p.meta})}},o.compressWorker=function(p){return new h("Deflate",p)},o.uncompressWorker=function(){return new h("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(i,n,o){function r(u,m){var b,y="";for(b=0;b<m;b++)y+=String.fromCharCode(255&u),u>>>=8;return y}function a(u,m,b,y,v,_){var w,C,T=u.file,P=u.compression,A=_!==c.utf8encode,V=s.transformTo("string",_(T.name)),O=s.transformTo("string",c.utf8encode(T.name)),Y=T.comment,et=s.transformTo("string",_(Y)),S=s.transformTo("string",c.utf8encode(Y)),$=O.length!==T.name.length,g=S.length!==Y.length,j="",at="",H="",ct=T.dir,X=T.date,st={crc32:0,compressedSize:0,uncompressedSize:0};m&&!b||(st.crc32=u.crc32,st.compressedSize=u.compressedSize,st.uncompressedSize=u.uncompressedSize);var N=0;m&&(N|=8),A||!$&&!g||(N|=2048);var B=0,nt=0;ct&&(B|=16),v==="UNIX"?(nt=798,B|=function(Z,Et){var kt=Z;return Z||(kt=Et?16893:33204),(65535&kt)<<16}(T.unixPermissions,ct)):(nt=20,B|=function(Z){return 63&(Z||0)}(T.dosPermissions)),w=X.getUTCHours(),w<<=6,w|=X.getUTCMinutes(),w<<=5,w|=X.getUTCSeconds()/2,C=X.getUTCFullYear()-1980,C<<=4,C|=X.getUTCMonth()+1,C<<=5,C|=X.getUTCDate(),$&&(at=r(1,1)+r(h(V),4)+O,j+="up"+r(at.length,2)+at),g&&(H=r(1,1)+r(h(et),4)+S,j+="uc"+r(H.length,2)+H);var Q="";return Q+=`
\0`,Q+=r(N,2),Q+=P.magic,Q+=r(w,2),Q+=r(C,2),Q+=r(st.crc32,4),Q+=r(st.compressedSize,4),Q+=r(st.uncompressedSize,4),Q+=r(V.length,2),Q+=r(j.length,2),{fileRecord:p.LOCAL_FILE_HEADER+Q+V+j,dirRecord:p.CENTRAL_FILE_HEADER+r(nt,2)+Q+r(et.length,2)+"\0\0\0\0"+r(B,4)+r(y,4)+V+j+et}}var s=i("../utils"),l=i("../stream/GenericWorker"),c=i("../utf8"),h=i("../crc32"),p=i("../signature");function d(u,m,b,y){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=m,this.zipPlatform=b,this.encodeFileName=y,this.streamFiles=u,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(d,l),d.prototype.push=function(u){var m=u.meta.percent||0,b=this.entriesCount,y=this._sources.length;this.accumulate?this.contentBuffer.push(u):(this.bytesWritten+=u.data.length,l.prototype.push.call(this,{data:u.data,meta:{currentFile:this.currentFile,percent:b?(m+100*(b-y-1))/b:100}}))},d.prototype.openedSource=function(u){this.currentSourceOffset=this.bytesWritten,this.currentFile=u.file.name;var m=this.streamFiles&&!u.file.dir;if(m){var b=a(u,m,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:b.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(u){this.accumulate=!1;var m=this.streamFiles&&!u.file.dir,b=a(u,m,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(b.dirRecord),m)this.push({data:function(y){return p.DATA_DESCRIPTOR+r(y.crc32,4)+r(y.compressedSize,4)+r(y.uncompressedSize,4)}(u),meta:{percent:100}});else for(this.push({data:b.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var u=this.bytesWritten,m=0;m<this.dirRecords.length;m++)this.push({data:this.dirRecords[m],meta:{percent:100}});var b=this.bytesWritten-u,y=function(v,_,w,C,T){var P=s.transformTo("string",T(C));return p.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(v,2)+r(v,2)+r(_,4)+r(w,4)+r(P.length,2)+P}(this.dirRecords.length,b,u,this.zipComment,this.encodeFileName);this.push({data:y,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(u){this._sources.push(u);var m=this;return u.on("data",function(b){m.processChunk(b)}),u.on("end",function(){m.closedSource(m.previous.streamInfo),m._sources.length?m.prepareNextSource():m.end()}),u.on("error",function(b){m.error(b)}),this},d.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(u){var m=this._sources;if(!l.prototype.error.call(this,u))return!1;for(var b=0;b<m.length;b++)try{m[b].error(u)}catch{}return!0},d.prototype.lock=function(){l.prototype.lock.call(this);for(var u=this._sources,m=0;m<u.length;m++)u[m].lock()},n.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(i,n,o){var r=i("../compressions"),a=i("./ZipFileWorker");o.generateWorker=function(s,l,c){var h=new a(l.streamFiles,c,l.platform,l.encodeFileName),p=0;try{s.forEach(function(d,u){p++;var m=function(_,w){var C=_||w,T=r[C];if(!T)throw new Error(C+" is not a valid compression method !");return T}(u.options.compression,l.compression),b=u.options.compressionOptions||l.compressionOptions||{},y=u.dir,v=u.date;u._compressWorker(m,b).withStreamInfo("file",{name:d,dir:y,date:v,comment:u.comment||"",unixPermissions:u.unixPermissions,dosPermissions:u.dosPermissions}).pipe(h)}),h.entriesCount=p}catch(d){h.error(d)}return h}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(i,n,o){function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new r;for(var s in this)typeof this[s]!="function"&&(a[s]=this[s]);return a}}(r.prototype=i("./object")).loadAsync=i("./load"),r.support=i("./support"),r.defaults=i("./defaults"),r.version="3.10.1",r.loadAsync=function(a,s){return new r().loadAsync(a,s)},r.external=i("./external"),n.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(i,n,o){var r=i("./utils"),a=i("./external"),s=i("./utf8"),l=i("./zipEntries"),c=i("./stream/Crc32Probe"),h=i("./nodejsUtils");function p(d){return new a.Promise(function(u,m){var b=d.decompressed.getContentWorker().pipe(new c);b.on("error",function(y){m(y)}).on("end",function(){b.streamInfo.crc32!==d.decompressed.crc32?m(new Error("Corrupted zip : CRC32 mismatch")):u()}).resume()})}n.exports=function(d,u){var m=this;return u=r.extend(u||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),h.isNode&&h.isStream(d)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",d,!0,u.optimizedBinaryString,u.base64).then(function(b){var y=new l(u);return y.load(b),y}).then(function(b){var y=[a.Promise.resolve(b)],v=b.files;if(u.checkCRC32)for(var _=0;_<v.length;_++)y.push(p(v[_]));return a.Promise.all(y)}).then(function(b){for(var y=b.shift(),v=y.files,_=0;_<v.length;_++){var w=v[_],C=w.fileNameStr,T=r.resolve(w.fileNameStr);m.file(T,w.decompressed,{binary:!0,optimizedBinaryString:!0,date:w.date,dir:w.dir,comment:w.fileCommentStr.length?w.fileCommentStr:null,unixPermissions:w.unixPermissions,dosPermissions:w.dosPermissions,createFolders:u.createFolders}),w.dir||(m.file(T).unsafeOriginalName=C)}return y.zipComment.length&&(m.comment=y.zipComment),m})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(i,n,o){var r=i("../utils"),a=i("../stream/GenericWorker");function s(l,c){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}r.inherits(s,a),s.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(h){c.push({data:h,meta:{percent:0}})}).on("error",function(h){c.isPaused?this.generatedError=h:c.error(h)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},s.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(i,n,o){var r=i("readable-stream").Readable;function a(s,l,c){r.call(this,l),this._helper=s;var h=this;s.on("data",function(p,d){h.push(p)||h._helper.pause(),c&&c(d)}).on("error",function(p){h.emit("error",p)}).on("end",function(){h.push(null)})}i("../utils").inherits(a,r),a.prototype._read=function(){this._helper.resume()},n.exports=a},{"../utils":32,"readable-stream":16}],14:[function(i,n,o){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(r,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(r,a);if(typeof r=="number")throw new Error('The "data" argument must not be a number');return new Buffer(r,a)},allocBuffer:function(r){if(Buffer.alloc)return Buffer.alloc(r);var a=new Buffer(r);return a.fill(0),a},isBuffer:function(r){return Buffer.isBuffer(r)},isStream:function(r){return r&&typeof r.on=="function"&&typeof r.pause=="function"&&typeof r.resume=="function"}}},{}],15:[function(i,n,o){function r(T,P,A){var V,O=s.getTypeOf(P),Y=s.extend(A||{},h);Y.date=Y.date||new Date,Y.compression!==null&&(Y.compression=Y.compression.toUpperCase()),typeof Y.unixPermissions=="string"&&(Y.unixPermissions=parseInt(Y.unixPermissions,8)),Y.unixPermissions&&16384&Y.unixPermissions&&(Y.dir=!0),Y.dosPermissions&&16&Y.dosPermissions&&(Y.dir=!0),Y.dir&&(T=v(T)),Y.createFolders&&(V=y(T))&&_.call(this,V,!0);var et=O==="string"&&Y.binary===!1&&Y.base64===!1;A&&A.binary!==void 0||(Y.binary=!et),(P instanceof p&&P.uncompressedSize===0||Y.dir||!P||P.length===0)&&(Y.base64=!1,Y.binary=!0,P="",Y.compression="STORE",O="string");var S=null;S=P instanceof p||P instanceof l?P:m.isNode&&m.isStream(P)?new b(T,P):s.prepareContent(T,P,Y.binary,Y.optimizedBinaryString,Y.base64);var $=new d(T,S,Y);this.files[T]=$}var a=i("./utf8"),s=i("./utils"),l=i("./stream/GenericWorker"),c=i("./stream/StreamHelper"),h=i("./defaults"),p=i("./compressedObject"),d=i("./zipObject"),u=i("./generate"),m=i("./nodejsUtils"),b=i("./nodejs/NodejsStreamInputAdapter"),y=function(T){T.slice(-1)==="/"&&(T=T.substring(0,T.length-1));var P=T.lastIndexOf("/");return 0<P?T.substring(0,P):""},v=function(T){return T.slice(-1)!=="/"&&(T+="/"),T},_=function(T,P){return P=P!==void 0?P:h.createFolders,T=v(T),this.files[T]||r.call(this,T,null,{dir:!0,createFolders:P}),this.files[T]};function w(T){return Object.prototype.toString.call(T)==="[object RegExp]"}var C={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(T){var P,A,V;for(P in this.files)V=this.files[P],(A=P.slice(this.root.length,P.length))&&P.slice(0,this.root.length)===this.root&&T(A,V)},filter:function(T){var P=[];return this.forEach(function(A,V){T(A,V)&&P.push(V)}),P},file:function(T,P,A){if(arguments.length!==1)return T=this.root+T,r.call(this,T,P,A),this;if(w(T)){var V=T;return this.filter(function(Y,et){return!et.dir&&V.test(Y)})}var O=this.files[this.root+T];return O&&!O.dir?O:null},folder:function(T){if(!T)return this;if(w(T))return this.filter(function(O,Y){return Y.dir&&T.test(O)});var P=this.root+T,A=_.call(this,P),V=this.clone();return V.root=A.name,V},remove:function(T){T=this.root+T;var P=this.files[T];if(P||(T.slice(-1)!=="/"&&(T+="/"),P=this.files[T]),P&&!P.dir)delete this.files[T];else for(var A=this.filter(function(O,Y){return Y.name.slice(0,T.length)===T}),V=0;V<A.length;V++)delete this.files[A[V].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(T){var P,A={};try{if((A=s.extend(T||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=A.type.toLowerCase(),A.compression=A.compression.toUpperCase(),A.type==="binarystring"&&(A.type="string"),!A.type)throw new Error("No output type specified.");s.checkSupport(A.type),A.platform!=="darwin"&&A.platform!=="freebsd"&&A.platform!=="linux"&&A.platform!=="sunos"||(A.platform="UNIX"),A.platform==="win32"&&(A.platform="DOS");var V=A.comment||this.comment||"";P=u.generateWorker(this,A,V)}catch(O){(P=new l("error")).error(O)}return new c(P,A.type||"string",A.mimeType)},generateAsync:function(T,P){return this.generateInternalStream(T).accumulate(P)},generateNodeStream:function(T,P){return(T=T||{}).type||(T.type="nodebuffer"),this.generateInternalStream(T).toNodejsStream(P)}};n.exports=C},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(i,n,o){n.exports=i("stream")},{stream:void 0}],17:[function(i,n,o){var r=i("./DataReader");function a(s){r.call(this,s);for(var l=0;l<this.data.length;l++)s[l]=255&s[l]}i("../utils").inherits(a,r),a.prototype.byteAt=function(s){return this.data[this.zero+s]},a.prototype.lastIndexOfSignature=function(s){for(var l=s.charCodeAt(0),c=s.charCodeAt(1),h=s.charCodeAt(2),p=s.charCodeAt(3),d=this.length-4;0<=d;--d)if(this.data[d]===l&&this.data[d+1]===c&&this.data[d+2]===h&&this.data[d+3]===p)return d-this.zero;return-1},a.prototype.readAndCheckSignature=function(s){var l=s.charCodeAt(0),c=s.charCodeAt(1),h=s.charCodeAt(2),p=s.charCodeAt(3),d=this.readData(4);return l===d[0]&&c===d[1]&&h===d[2]&&p===d[3]},a.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},n.exports=a},{"../utils":32,"./DataReader":18}],18:[function(i,n,o){var r=i("../utils");function a(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(){},readInt:function(s){var l,c=0;for(this.checkOffset(s),l=this.index+s-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=s,c},readString:function(s){return r.transformTo("string",this.readData(s))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},n.exports=a},{"../utils":32}],19:[function(i,n,o){var r=i("./Uint8ArrayReader");function a(s){r.call(this,s)}i("../utils").inherits(a,r),a.prototype.readData=function(s){this.checkOffset(s);var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},n.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(i,n,o){var r=i("./DataReader");function a(s){r.call(this,s)}i("../utils").inherits(a,r),a.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},a.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},a.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},a.prototype.readData=function(s){this.checkOffset(s);var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},n.exports=a},{"../utils":32,"./DataReader":18}],21:[function(i,n,o){var r=i("./ArrayReader");function a(s){r.call(this,s)}i("../utils").inherits(a,r),a.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},n.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(i,n,o){var r=i("../utils"),a=i("../support"),s=i("./ArrayReader"),l=i("./StringReader"),c=i("./NodeBufferReader"),h=i("./Uint8ArrayReader");n.exports=function(p){var d=r.getTypeOf(p);return r.checkSupport(d),d!=="string"||a.uint8array?d==="nodebuffer"?new c(p):a.uint8array?new h(r.transformTo("uint8array",p)):new s(r.transformTo("array",p)):new l(p)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(i,n,o){o.LOCAL_FILE_HEADER="PK",o.CENTRAL_FILE_HEADER="PK",o.CENTRAL_DIRECTORY_END="PK",o.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",o.ZIP64_CENTRAL_DIRECTORY_END="PK",o.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(i,n,o){var r=i("./GenericWorker"),a=i("../utils");function s(l){r.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(s,r),s.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},n.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(i,n,o){var r=i("./GenericWorker"),a=i("../crc32");function s(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}i("../utils").inherits(s,r),s.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},n.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(i,n,o){var r=i("../utils"),a=i("./GenericWorker");function s(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}r.inherits(s,a),s.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}a.prototype.processChunk.call(this,l)},n.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(i,n,o){var r=i("../utils"),a=i("./GenericWorker");function s(l){a.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(h){c.dataIsReady=!0,c.data=h,c.max=h&&h.length||0,c.type=r.getTypeOf(h),c.isPaused||c._tickAndRepeat()},function(h){c.error(h)})}r.inherits(s,a),s.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(i,n,o){function r(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,s){return this._listeners[a].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,s){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,s)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var s=this;return a.on("data",function(l){s.processChunk(l)}),a.on("end",function(){s.end()}),a.on("error",function(l){s.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,s){return this.extraStreamInfo[a]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},n.exports=r},{}],29:[function(i,n,o){var r=i("../utils"),a=i("./ConvertWorker"),s=i("./GenericWorker"),l=i("../base64"),c=i("../support"),h=i("../external"),p=null;if(c.nodestream)try{p=i("../nodejs/NodejsStreamOutputAdapter")}catch{}function d(m,b){return new h.Promise(function(y,v){var _=[],w=m._internalType,C=m._outputType,T=m._mimeType;m.on("data",function(P,A){_.push(P),b&&b(A)}).on("error",function(P){_=[],v(P)}).on("end",function(){try{var P=function(A,V,O){switch(A){case"blob":return r.newBlob(r.transformTo("arraybuffer",V),O);case"base64":return l.encode(V);default:return r.transformTo(A,V)}}(C,function(A,V){var O,Y=0,et=null,S=0;for(O=0;O<V.length;O++)S+=V[O].length;switch(A){case"string":return V.join("");case"array":return Array.prototype.concat.apply([],V);case"uint8array":for(et=new Uint8Array(S),O=0;O<V.length;O++)et.set(V[O],Y),Y+=V[O].length;return et;case"nodebuffer":return Buffer.concat(V);default:throw new Error("concat : unsupported type '"+A+"'")}}(w,_),T);y(P)}catch(A){v(A)}_=[]}).resume()})}function u(m,b,y){var v=b;switch(b){case"blob":case"arraybuffer":v="uint8array";break;case"base64":v="string"}try{this._internalType=v,this._outputType=b,this._mimeType=y,r.checkSupport(v),this._worker=m.pipe(new a(v)),m.lock()}catch(_){this._worker=new s("error"),this._worker.error(_)}}u.prototype={accumulate:function(m){return d(this,m)},on:function(m,b){var y=this;return m==="data"?this._worker.on(m,function(v){b.call(y,v.data,v.meta)}):this._worker.on(m,function(){r.delay(b,arguments,y)}),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(m){if(r.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},m)}},n.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(i,n,o){if(o.base64=!0,o.array=!0,o.string=!0,o.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",o.nodebuffer=typeof Buffer<"u",o.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")o.blob=!1;else{var r=new ArrayBuffer(0);try{o.blob=new Blob([r],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(r),o.blob=a.getBlob("application/zip").size===0}catch{o.blob=!1}}}try{o.nodestream=!!i("readable-stream").Readable}catch{o.nodestream=!1}},{"readable-stream":16}],31:[function(i,n,o){for(var r=i("./utils"),a=i("./support"),s=i("./nodejsUtils"),l=i("./stream/GenericWorker"),c=new Array(256),h=0;h<256;h++)c[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;c[254]=c[254]=1;function p(){l.call(this,"utf-8 decode"),this.leftOver=null}function d(){l.call(this,"utf-8 encode")}o.utf8encode=function(u){return a.nodebuffer?s.newBufferFrom(u,"utf-8"):function(m){var b,y,v,_,w,C=m.length,T=0;for(_=0;_<C;_++)(64512&(y=m.charCodeAt(_)))==55296&&_+1<C&&(64512&(v=m.charCodeAt(_+1)))==56320&&(y=65536+(y-55296<<10)+(v-56320),_++),T+=y<128?1:y<2048?2:y<65536?3:4;for(b=a.uint8array?new Uint8Array(T):new Array(T),_=w=0;w<T;_++)(64512&(y=m.charCodeAt(_)))==55296&&_+1<C&&(64512&(v=m.charCodeAt(_+1)))==56320&&(y=65536+(y-55296<<10)+(v-56320),_++),y<128?b[w++]=y:(y<2048?b[w++]=192|y>>>6:(y<65536?b[w++]=224|y>>>12:(b[w++]=240|y>>>18,b[w++]=128|y>>>12&63),b[w++]=128|y>>>6&63),b[w++]=128|63&y);return b}(u)},o.utf8decode=function(u){return a.nodebuffer?r.transformTo("nodebuffer",u).toString("utf-8"):function(m){var b,y,v,_,w=m.length,C=new Array(2*w);for(b=y=0;b<w;)if((v=m[b++])<128)C[y++]=v;else if(4<(_=c[v]))C[y++]=65533,b+=_-1;else{for(v&=_===2?31:_===3?15:7;1<_&&b<w;)v=v<<6|63&m[b++],_--;1<_?C[y++]=65533:v<65536?C[y++]=v:(v-=65536,C[y++]=55296|v>>10&1023,C[y++]=56320|1023&v)}return C.length!==y&&(C.subarray?C=C.subarray(0,y):C.length=y),r.applyFromCharCode(C)}(u=r.transformTo(a.uint8array?"uint8array":"array",u))},r.inherits(p,l),p.prototype.processChunk=function(u){var m=r.transformTo(a.uint8array?"uint8array":"array",u.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var b=m;(m=new Uint8Array(b.length+this.leftOver.length)).set(this.leftOver,0),m.set(b,this.leftOver.length)}else m=this.leftOver.concat(m);this.leftOver=null}var y=function(_,w){var C;for((w=w||_.length)>_.length&&(w=_.length),C=w-1;0<=C&&(192&_[C])==128;)C--;return C<0||C===0?w:C+c[_[C]]>w?C:w}(m),v=m;y!==m.length&&(a.uint8array?(v=m.subarray(0,y),this.leftOver=m.subarray(y,m.length)):(v=m.slice(0,y),this.leftOver=m.slice(y,m.length))),this.push({data:o.utf8decode(v),meta:u.meta})},p.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:o.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},o.Utf8DecodeWorker=p,r.inherits(d,l),d.prototype.processChunk=function(u){this.push({data:o.utf8encode(u.data),meta:u.meta})},o.Utf8EncodeWorker=d},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(i,n,o){var r=i("./support"),a=i("./base64"),s=i("./nodejsUtils"),l=i("./external");function c(b){return b}function h(b,y){for(var v=0;v<b.length;++v)y[v]=255&b.charCodeAt(v);return y}i("setimmediate"),o.newBlob=function(b,y){o.checkSupport("blob");try{return new Blob([b],{type:y})}catch{try{var v=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return v.append(b),v.getBlob(y)}catch{throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(b,y,v){var _=[],w=0,C=b.length;if(C<=v)return String.fromCharCode.apply(null,b);for(;w<C;)y==="array"||y==="nodebuffer"?_.push(String.fromCharCode.apply(null,b.slice(w,Math.min(w+v,C)))):_.push(String.fromCharCode.apply(null,b.subarray(w,Math.min(w+v,C)))),w+=v;return _.join("")},stringifyByChar:function(b){for(var y="",v=0;v<b.length;v++)y+=String.fromCharCode(b[v]);return y},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}}()}};function d(b){var y=65536,v=o.getTypeOf(b),_=!0;if(v==="uint8array"?_=p.applyCanBeUsed.uint8array:v==="nodebuffer"&&(_=p.applyCanBeUsed.nodebuffer),_)for(;1<y;)try{return p.stringifyByChunk(b,v,y)}catch{y=Math.floor(y/2)}return p.stringifyByChar(b)}function u(b,y){for(var v=0;v<b.length;v++)y[v]=b[v];return y}o.applyFromCharCode=d;var m={};m.string={string:c,array:function(b){return h(b,new Array(b.length))},arraybuffer:function(b){return m.string.uint8array(b).buffer},uint8array:function(b){return h(b,new Uint8Array(b.length))},nodebuffer:function(b){return h(b,s.allocBuffer(b.length))}},m.array={string:d,array:c,arraybuffer:function(b){return new Uint8Array(b).buffer},uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return s.newBufferFrom(b)}},m.arraybuffer={string:function(b){return d(new Uint8Array(b))},array:function(b){return u(new Uint8Array(b),new Array(b.byteLength))},arraybuffer:c,uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return s.newBufferFrom(new Uint8Array(b))}},m.uint8array={string:d,array:function(b){return u(b,new Array(b.length))},arraybuffer:function(b){return b.buffer},uint8array:c,nodebuffer:function(b){return s.newBufferFrom(b)}},m.nodebuffer={string:d,array:function(b){return u(b,new Array(b.length))},arraybuffer:function(b){return m.nodebuffer.uint8array(b).buffer},uint8array:function(b){return u(b,new Uint8Array(b.length))},nodebuffer:c},o.transformTo=function(b,y){if(y=y||"",!b)return y;o.checkSupport(b);var v=o.getTypeOf(y);return m[v][b](y)},o.resolve=function(b){for(var y=b.split("/"),v=[],_=0;_<y.length;_++){var w=y[_];w==="."||w===""&&_!==0&&_!==y.length-1||(w===".."?v.pop():v.push(w))}return v.join("/")},o.getTypeOf=function(b){return typeof b=="string"?"string":Object.prototype.toString.call(b)==="[object Array]"?"array":r.nodebuffer&&s.isBuffer(b)?"nodebuffer":r.uint8array&&b instanceof Uint8Array?"uint8array":r.arraybuffer&&b instanceof ArrayBuffer?"arraybuffer":void 0},o.checkSupport=function(b){if(!r[b.toLowerCase()])throw new Error(b+" is not supported by this platform")},o.MAX_VALUE_16BITS=65535,o.MAX_VALUE_32BITS=-1,o.pretty=function(b){var y,v,_="";for(v=0;v<(b||"").length;v++)_+="\\x"+((y=b.charCodeAt(v))<16?"0":"")+y.toString(16).toUpperCase();return _},o.delay=function(b,y,v){setImmediate(function(){b.apply(v||null,y||[])})},o.inherits=function(b,y){function v(){}v.prototype=y.prototype,b.prototype=new v},o.extend=function(){var b,y,v={};for(b=0;b<arguments.length;b++)for(y in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],y)&&v[y]===void 0&&(v[y]=arguments[b][y]);return v},o.prepareContent=function(b,y,v,_,w){return l.Promise.resolve(y).then(function(C){return r.blob&&(C instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(C))!==-1)&&typeof FileReader<"u"?new l.Promise(function(T,P){var A=new FileReader;A.onload=function(V){T(V.target.result)},A.onerror=function(V){P(V.target.error)},A.readAsArrayBuffer(C)}):C}).then(function(C){var T=o.getTypeOf(C);return T?(T==="arraybuffer"?C=o.transformTo("uint8array",C):T==="string"&&(w?C=a.decode(C):v&&_!==!0&&(C=function(P){return h(P,r.uint8array?new Uint8Array(P.length):new Array(P.length))}(C))),C):l.Promise.reject(new Error("Can't read the data of '"+b+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(i,n,o){var r=i("./reader/readerFor"),a=i("./utils"),s=i("./signature"),l=i("./zipEntry"),c=i("./support");function h(p){this.files=[],this.loadOptions=p}h.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var d=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(d)+", expected "+a.pretty(p)+")")}},isSignature:function(p,d){var u=this.reader.index;this.reader.setIndex(p);var m=this.reader.readString(4)===d;return this.reader.setIndex(u),m},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),d=c.uint8array?"uint8array":"array",u=a.transformTo(d,p);this.zipComment=this.loadOptions.decodeFileName(u)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p,d,u,m=this.zip64EndOfCentralSize-44;0<m;)p=this.reader.readInt(2),d=this.reader.readInt(4),u=this.reader.readData(d),this.zip64ExtensibleData[p]={id:p,length:d,value:u}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,d;for(p=0;p<this.files.length;p++)d=this.files[p],this.reader.setIndex(d.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),d.readLocalPart(this.reader),d.handleUTF8(),d.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(p=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(p<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(p);var d=p;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(p=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var u=this.centralDirOffset+this.centralDirSize;this.zip64&&(u+=20,u+=12+this.zip64EndOfCentralSize);var m=d-u;if(0<m)this.isSignature(d,s.CENTRAL_FILE_HEADER)||(this.reader.zero=m);else if(m<0)throw new Error("Corrupted zip: missing "+Math.abs(m)+" bytes.")},prepareReader:function(p){this.reader=r(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=h},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(i,n,o){var r=i("./reader/readerFor"),a=i("./utils"),s=i("./compressedObject"),l=i("./crc32"),c=i("./utf8"),h=i("./compressions"),p=i("./support");function d(u,m){this.options=u,this.loadOptions=m}d.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(u){var m,b;if(u.skip(22),this.fileNameLength=u.readInt(2),b=u.readInt(2),this.fileName=u.readData(this.fileNameLength),u.skip(b),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((m=function(y){for(var v in h)if(Object.prototype.hasOwnProperty.call(h,v)&&h[v].magic===y)return h[v];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,m,u.readData(this.compressedSize))},readCentralPart:function(u){this.versionMadeBy=u.readInt(2),u.skip(2),this.bitFlag=u.readInt(2),this.compressionMethod=u.readString(2),this.date=u.readDate(),this.crc32=u.readInt(4),this.compressedSize=u.readInt(4),this.uncompressedSize=u.readInt(4);var m=u.readInt(2);if(this.extraFieldsLength=u.readInt(2),this.fileCommentLength=u.readInt(2),this.diskNumberStart=u.readInt(2),this.internalFileAttributes=u.readInt(2),this.externalFileAttributes=u.readInt(4),this.localHeaderOffset=u.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");u.skip(m),this.readExtraFields(u),this.parseZIP64ExtraField(u),this.fileComment=u.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var u=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),u==0&&(this.dosPermissions=63&this.externalFileAttributes),u==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var u=r(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=u.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=u.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=u.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=u.readInt(4))}},readExtraFields:function(u){var m,b,y,v=u.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});u.index+4<v;)m=u.readInt(2),b=u.readInt(2),y=u.readData(b),this.extraFields[m]={id:m,length:b,value:y};u.setIndex(v)},handleUTF8:function(){var u=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var m=this.findExtraFieldUnicodePath();if(m!==null)this.fileNameStr=m;else{var b=a.transformTo(u,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(b)}var y=this.findExtraFieldUnicodeComment();if(y!==null)this.fileCommentStr=y;else{var v=a.transformTo(u,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(v)}}},findExtraFieldUnicodePath:function(){var u=this.extraFields[28789];if(u){var m=r(u.value);return m.readInt(1)!==1||l(this.fileName)!==m.readInt(4)?null:c.utf8decode(m.readData(u.length-5))}return null},findExtraFieldUnicodeComment:function(){var u=this.extraFields[25461];if(u){var m=r(u.value);return m.readInt(1)!==1||l(this.fileComment)!==m.readInt(4)?null:c.utf8decode(m.readData(u.length-5))}return null}},n.exports=d},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(i,n,o){function r(m,b,y){this.name=m,this.dir=y.dir,this.date=y.date,this.comment=y.comment,this.unixPermissions=y.unixPermissions,this.dosPermissions=y.dosPermissions,this._data=b,this._dataBinary=y.binary,this.options={compression:y.compression,compressionOptions:y.compressionOptions}}var a=i("./stream/StreamHelper"),s=i("./stream/DataWorker"),l=i("./utf8"),c=i("./compressedObject"),h=i("./stream/GenericWorker");r.prototype={internalStream:function(m){var b=null,y="string";try{if(!m)throw new Error("No output type specified.");var v=(y=m.toLowerCase())==="string"||y==="text";y!=="binarystring"&&y!=="text"||(y="string"),b=this._decompressWorker();var _=!this._dataBinary;_&&!v&&(b=b.pipe(new l.Utf8EncodeWorker)),!_&&v&&(b=b.pipe(new l.Utf8DecodeWorker))}catch(w){(b=new h("error")).error(w)}return new a(b,y,"")},async:function(m,b){return this.internalStream(m).accumulate(b)},nodeStream:function(m,b){return this.internalStream(m||"nodebuffer").toNodejsStream(b)},_compressWorker:function(m,b){if(this._data instanceof c&&this._data.compression.magic===m.magic)return this._data.getCompressedWorker();var y=this._decompressWorker();return this._dataBinary||(y=y.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(y,m,b)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof h?this._data:new s(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},u=0;u<p.length;u++)r.prototype[p[u]]=d;n.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(i,n,o){(function(r){var a,s,l=r.MutationObserver||r.WebKitMutationObserver;if(l){var c=0,h=new l(m),p=r.document.createTextNode("");h.observe(p,{characterData:!0}),a=function(){p.data=c=++c%2}}else if(r.setImmediate||r.MessageChannel===void 0)a="document"in r&&"onreadystatechange"in r.document.createElement("script")?function(){var b=r.document.createElement("script");b.onreadystatechange=function(){m(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},r.document.documentElement.appendChild(b)}:function(){setTimeout(m,0)};else{var d=new r.MessageChannel;d.port1.onmessage=m,a=function(){d.port2.postMessage(0)}}var u=[];function m(){var b,y;s=!0;for(var v=u.length;v;){for(y=u,u=[],b=-1;++b<v;)y[b]();v=u.length}s=!1}n.exports=function(b){u.push(b)!==1||s||a()}}).call(this,typeof dn<"u"?dn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(i,n,o){var r=i("immediate");function a(){}var s={},l=["REJECTED"],c=["FULFILLED"],h=["PENDING"];function p(v){if(typeof v!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,v!==a&&b(this,v)}function d(v,_,w){this.promise=v,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof w=="function"&&(this.onRejected=w,this.callRejected=this.otherCallRejected)}function u(v,_,w){r(function(){var C;try{C=_(w)}catch(T){return s.reject(v,T)}C===v?s.reject(v,new TypeError("Cannot resolve promise with itself")):s.resolve(v,C)})}function m(v){var _=v&&v.then;if(v&&(typeof v=="object"||typeof v=="function")&&typeof _=="function")return function(){_.apply(v,arguments)}}function b(v,_){var w=!1;function C(A){w||(w=!0,s.reject(v,A))}function T(A){w||(w=!0,s.resolve(v,A))}var P=y(function(){_(T,C)});P.status==="error"&&C(P.value)}function y(v,_){var w={};try{w.value=v(_),w.status="success"}catch(C){w.status="error",w.value=C}return w}(n.exports=p).prototype.finally=function(v){if(typeof v!="function")return this;var _=this.constructor;return this.then(function(w){return _.resolve(v()).then(function(){return w})},function(w){return _.resolve(v()).then(function(){throw w})})},p.prototype.catch=function(v){return this.then(null,v)},p.prototype.then=function(v,_){if(typeof v!="function"&&this.state===c||typeof _!="function"&&this.state===l)return this;var w=new this.constructor(a);return this.state!==h?u(w,this.state===c?v:_,this.outcome):this.queue.push(new d(w,v,_)),w},d.prototype.callFulfilled=function(v){s.resolve(this.promise,v)},d.prototype.otherCallFulfilled=function(v){u(this.promise,this.onFulfilled,v)},d.prototype.callRejected=function(v){s.reject(this.promise,v)},d.prototype.otherCallRejected=function(v){u(this.promise,this.onRejected,v)},s.resolve=function(v,_){var w=y(m,_);if(w.status==="error")return s.reject(v,w.value);var C=w.value;if(C)b(v,C);else{v.state=c,v.outcome=_;for(var T=-1,P=v.queue.length;++T<P;)v.queue[T].callFulfilled(_)}return v},s.reject=function(v,_){v.state=l,v.outcome=_;for(var w=-1,C=v.queue.length;++w<C;)v.queue[w].callRejected(_);return v},p.resolve=function(v){return v instanceof this?v:s.resolve(new this(a),v)},p.reject=function(v){var _=new this(a);return s.reject(_,v)},p.all=function(v){var _=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var w=v.length,C=!1;if(!w)return this.resolve([]);for(var T=new Array(w),P=0,A=-1,V=new this(a);++A<w;)O(v[A],A);return V;function O(Y,et){_.resolve(Y).then(function(S){T[et]=S,++P!==w||C||(C=!0,s.resolve(V,T))},function(S){C||(C=!0,s.reject(V,S))})}},p.race=function(v){var _=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var w=v.length,C=!1;if(!w)return this.resolve([]);for(var T=-1,P=new this(a);++T<w;)A=v[T],_.resolve(A).then(function(V){C||(C=!0,s.resolve(P,V))},function(V){C||(C=!0,s.reject(P,V))});var A;return P}},{immediate:36}],38:[function(i,n,o){var r={};(0,i("./lib/utils/common").assign)(r,i("./lib/deflate"),i("./lib/inflate"),i("./lib/zlib/constants")),n.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(i,n,o){var r=i("./zlib/deflate"),a=i("./utils/common"),s=i("./utils/strings"),l=i("./zlib/messages"),c=i("./zlib/zstream"),h=Object.prototype.toString,p=0,d=-1,u=0,m=8;function b(v){if(!(this instanceof b))return new b(v);this.options=a.assign({level:d,method:m,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},v||{});var _=this.options;_.raw&&0<_.windowBits?_.windowBits=-_.windowBits:_.gzip&&0<_.windowBits&&_.windowBits<16&&(_.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var w=r.deflateInit2(this.strm,_.level,_.method,_.windowBits,_.memLevel,_.strategy);if(w!==p)throw new Error(l[w]);if(_.header&&r.deflateSetHeader(this.strm,_.header),_.dictionary){var C;if(C=typeof _.dictionary=="string"?s.string2buf(_.dictionary):h.call(_.dictionary)==="[object ArrayBuffer]"?new Uint8Array(_.dictionary):_.dictionary,(w=r.deflateSetDictionary(this.strm,C))!==p)throw new Error(l[w]);this._dict_set=!0}}function y(v,_){var w=new b(_);if(w.push(v,!0),w.err)throw w.msg||l[w.err];return w.result}b.prototype.push=function(v,_){var w,C,T=this.strm,P=this.options.chunkSize;if(this.ended)return!1;C=_===~~_?_:_===!0?4:0,typeof v=="string"?T.input=s.string2buf(v):h.call(v)==="[object ArrayBuffer]"?T.input=new Uint8Array(v):T.input=v,T.next_in=0,T.avail_in=T.input.length;do{if(T.avail_out===0&&(T.output=new a.Buf8(P),T.next_out=0,T.avail_out=P),(w=r.deflate(T,C))!==1&&w!==p)return this.onEnd(w),!(this.ended=!0);T.avail_out!==0&&(T.avail_in!==0||C!==4&&C!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(a.shrinkBuf(T.output,T.next_out))):this.onData(a.shrinkBuf(T.output,T.next_out)))}while((0<T.avail_in||T.avail_out===0)&&w!==1);return C===4?(w=r.deflateEnd(this.strm),this.onEnd(w),this.ended=!0,w===p):C!==2||(this.onEnd(p),!(T.avail_out=0))},b.prototype.onData=function(v){this.chunks.push(v)},b.prototype.onEnd=function(v){v===p&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},o.Deflate=b,o.deflate=y,o.deflateRaw=function(v,_){return(_=_||{}).raw=!0,y(v,_)},o.gzip=function(v,_){return(_=_||{}).gzip=!0,y(v,_)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(i,n,o){var r=i("./zlib/inflate"),a=i("./utils/common"),s=i("./utils/strings"),l=i("./zlib/constants"),c=i("./zlib/messages"),h=i("./zlib/zstream"),p=i("./zlib/gzheader"),d=Object.prototype.toString;function u(b){if(!(this instanceof u))return new u(b);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},b||{});var y=this.options;y.raw&&0<=y.windowBits&&y.windowBits<16&&(y.windowBits=-y.windowBits,y.windowBits===0&&(y.windowBits=-15)),!(0<=y.windowBits&&y.windowBits<16)||b&&b.windowBits||(y.windowBits+=32),15<y.windowBits&&y.windowBits<48&&!(15&y.windowBits)&&(y.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var v=r.inflateInit2(this.strm,y.windowBits);if(v!==l.Z_OK)throw new Error(c[v]);this.header=new p,r.inflateGetHeader(this.strm,this.header)}function m(b,y){var v=new u(y);if(v.push(b,!0),v.err)throw v.msg||c[v.err];return v.result}u.prototype.push=function(b,y){var v,_,w,C,T,P,A=this.strm,V=this.options.chunkSize,O=this.options.dictionary,Y=!1;if(this.ended)return!1;_=y===~~y?y:y===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof b=="string"?A.input=s.binstring2buf(b):d.call(b)==="[object ArrayBuffer]"?A.input=new Uint8Array(b):A.input=b,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new a.Buf8(V),A.next_out=0,A.avail_out=V),(v=r.inflate(A,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&O&&(P=typeof O=="string"?s.string2buf(O):d.call(O)==="[object ArrayBuffer]"?new Uint8Array(O):O,v=r.inflateSetDictionary(this.strm,P)),v===l.Z_BUF_ERROR&&Y===!0&&(v=l.Z_OK,Y=!1),v!==l.Z_STREAM_END&&v!==l.Z_OK)return this.onEnd(v),!(this.ended=!0);A.next_out&&(A.avail_out!==0&&v!==l.Z_STREAM_END&&(A.avail_in!==0||_!==l.Z_FINISH&&_!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(w=s.utf8border(A.output,A.next_out),C=A.next_out-w,T=s.buf2string(A.output,w),A.next_out=C,A.avail_out=V-C,C&&a.arraySet(A.output,A.output,w,C,0),this.onData(T)):this.onData(a.shrinkBuf(A.output,A.next_out)))),A.avail_in===0&&A.avail_out===0&&(Y=!0)}while((0<A.avail_in||A.avail_out===0)&&v!==l.Z_STREAM_END);return v===l.Z_STREAM_END&&(_=l.Z_FINISH),_===l.Z_FINISH?(v=r.inflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===l.Z_OK):_!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(A.avail_out=0))},u.prototype.onData=function(b){this.chunks.push(b)},u.prototype.onEnd=function(b){b===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},o.Inflate=u,o.inflate=m,o.inflateRaw=function(b,y){return(y=y||{}).raw=!0,m(b,y)},o.ungzip=m},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(i,n,o){var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";o.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var h=c.shift();if(h){if(typeof h!="object")throw new TypeError(h+"must be non-object");for(var p in h)h.hasOwnProperty(p)&&(l[p]=h[p])}}return l},o.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var a={arraySet:function(l,c,h,p,d){if(c.subarray&&l.subarray)l.set(c.subarray(h,h+p),d);else for(var u=0;u<p;u++)l[d+u]=c[h+u]},flattenChunks:function(l){var c,h,p,d,u,m;for(c=p=0,h=l.length;c<h;c++)p+=l[c].length;for(m=new Uint8Array(p),c=d=0,h=l.length;c<h;c++)u=l[c],m.set(u,d),d+=u.length;return m}},s={arraySet:function(l,c,h,p,d){for(var u=0;u<p;u++)l[d+u]=c[h+u]},flattenChunks:function(l){return[].concat.apply([],l)}};o.setTyped=function(l){l?(o.Buf8=Uint8Array,o.Buf16=Uint16Array,o.Buf32=Int32Array,o.assign(o,a)):(o.Buf8=Array,o.Buf16=Array,o.Buf32=Array,o.assign(o,s))},o.setTyped(r)},{}],42:[function(i,n,o){var r=i("./common"),a=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var l=new r.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function h(p,d){if(d<65537&&(p.subarray&&s||!p.subarray&&a))return String.fromCharCode.apply(null,r.shrinkBuf(p,d));for(var u="",m=0;m<d;m++)u+=String.fromCharCode(p[m]);return u}l[254]=l[254]=1,o.string2buf=function(p){var d,u,m,b,y,v=p.length,_=0;for(b=0;b<v;b++)(64512&(u=p.charCodeAt(b)))==55296&&b+1<v&&(64512&(m=p.charCodeAt(b+1)))==56320&&(u=65536+(u-55296<<10)+(m-56320),b++),_+=u<128?1:u<2048?2:u<65536?3:4;for(d=new r.Buf8(_),b=y=0;y<_;b++)(64512&(u=p.charCodeAt(b)))==55296&&b+1<v&&(64512&(m=p.charCodeAt(b+1)))==56320&&(u=65536+(u-55296<<10)+(m-56320),b++),u<128?d[y++]=u:(u<2048?d[y++]=192|u>>>6:(u<65536?d[y++]=224|u>>>12:(d[y++]=240|u>>>18,d[y++]=128|u>>>12&63),d[y++]=128|u>>>6&63),d[y++]=128|63&u);return d},o.buf2binstring=function(p){return h(p,p.length)},o.binstring2buf=function(p){for(var d=new r.Buf8(p.length),u=0,m=d.length;u<m;u++)d[u]=p.charCodeAt(u);return d},o.buf2string=function(p,d){var u,m,b,y,v=d||p.length,_=new Array(2*v);for(u=m=0;u<v;)if((b=p[u++])<128)_[m++]=b;else if(4<(y=l[b]))_[m++]=65533,u+=y-1;else{for(b&=y===2?31:y===3?15:7;1<y&&u<v;)b=b<<6|63&p[u++],y--;1<y?_[m++]=65533:b<65536?_[m++]=b:(b-=65536,_[m++]=55296|b>>10&1023,_[m++]=56320|1023&b)}return h(_,m)},o.utf8border=function(p,d){var u;for((d=d||p.length)>p.length&&(d=p.length),u=d-1;0<=u&&(192&p[u])==128;)u--;return u<0||u===0?d:u+l[p[u]]>d?u:d}},{"./common":41}],43:[function(i,n,o){n.exports=function(r,a,s,l){for(var c=65535&r|0,h=r>>>16&65535|0,p=0;s!==0;){for(s-=p=2e3<s?2e3:s;h=h+(c=c+a[l++]|0)|0,--p;);c%=65521,h%=65521}return c|h<<16|0}},{}],44:[function(i,n,o){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(i,n,o){var r=function(){for(var a,s=[],l=0;l<256;l++){a=l;for(var c=0;c<8;c++)a=1&a?3988292384^a>>>1:a>>>1;s[l]=a}return s}();n.exports=function(a,s,l,c){var h=r,p=c+l;a^=-1;for(var d=c;d<p;d++)a=a>>>8^h[255&(a^s[d])];return-1^a}},{}],46:[function(i,n,o){var r,a=i("../utils/common"),s=i("./trees"),l=i("./adler32"),c=i("./crc32"),h=i("./messages"),p=0,d=4,u=0,m=-2,b=-1,y=4,v=2,_=8,w=9,C=286,T=30,P=19,A=2*C+1,V=15,O=3,Y=258,et=Y+O+1,S=42,$=113,g=1,j=2,at=3,H=4;function ct(f,F){return f.msg=h[F],F}function X(f){return(f<<1)-(4<f?9:0)}function st(f){for(var F=f.length;0<=--F;)f[F]=0}function N(f){var F=f.state,I=F.pending;I>f.avail_out&&(I=f.avail_out),I!==0&&(a.arraySet(f.output,F.pending_buf,F.pending_out,I,f.next_out),f.next_out+=I,F.pending_out+=I,f.total_out+=I,f.avail_out-=I,F.pending-=I,F.pending===0&&(F.pending_out=0))}function B(f,F){s._tr_flush_block(f,0<=f.block_start?f.block_start:-1,f.strstart-f.block_start,F),f.block_start=f.strstart,N(f.strm)}function nt(f,F){f.pending_buf[f.pending++]=F}function Q(f,F){f.pending_buf[f.pending++]=F>>>8&255,f.pending_buf[f.pending++]=255&F}function Z(f,F){var I,D,E=f.max_chain_length,R=f.strstart,z=f.prev_length,G=f.nice_match,L=f.strstart>f.w_size-et?f.strstart-(f.w_size-et):0,q=f.window,tt=f.w_mask,K=f.prev,ot=f.strstart+Y,_t=q[R+z-1],gt=q[R+z];f.prev_length>=f.good_match&&(E>>=2),G>f.lookahead&&(G=f.lookahead);do if(q[(I=F)+z]===gt&&q[I+z-1]===_t&&q[I]===q[R]&&q[++I]===q[R+1]){R+=2,I++;do;while(q[++R]===q[++I]&&q[++R]===q[++I]&&q[++R]===q[++I]&&q[++R]===q[++I]&&q[++R]===q[++I]&&q[++R]===q[++I]&&q[++R]===q[++I]&&q[++R]===q[++I]&&R<ot);if(D=Y-(ot-R),R=ot-Y,z<D){if(f.match_start=F,G<=(z=D))break;_t=q[R+z-1],gt=q[R+z]}}while((F=K[F&tt])>L&&--E!=0);return z<=f.lookahead?z:f.lookahead}function Et(f){var F,I,D,E,R,z,G,L,q,tt,K=f.w_size;do{if(E=f.window_size-f.lookahead-f.strstart,f.strstart>=K+(K-et)){for(a.arraySet(f.window,f.window,K,K,0),f.match_start-=K,f.strstart-=K,f.block_start-=K,F=I=f.hash_size;D=f.head[--F],f.head[F]=K<=D?D-K:0,--I;);for(F=I=K;D=f.prev[--F],f.prev[F]=K<=D?D-K:0,--I;);E+=K}if(f.strm.avail_in===0)break;if(z=f.strm,G=f.window,L=f.strstart+f.lookahead,q=E,tt=void 0,tt=z.avail_in,q<tt&&(tt=q),I=tt===0?0:(z.avail_in-=tt,a.arraySet(G,z.input,z.next_in,tt,L),z.state.wrap===1?z.adler=l(z.adler,G,tt,L):z.state.wrap===2&&(z.adler=c(z.adler,G,tt,L)),z.next_in+=tt,z.total_in+=tt,tt),f.lookahead+=I,f.lookahead+f.insert>=O)for(R=f.strstart-f.insert,f.ins_h=f.window[R],f.ins_h=(f.ins_h<<f.hash_shift^f.window[R+1])&f.hash_mask;f.insert&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[R+O-1])&f.hash_mask,f.prev[R&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=R,R++,f.insert--,!(f.lookahead+f.insert<O)););}while(f.lookahead<et&&f.strm.avail_in!==0)}function kt(f,F){for(var I,D;;){if(f.lookahead<et){if(Et(f),f.lookahead<et&&F===p)return g;if(f.lookahead===0)break}if(I=0,f.lookahead>=O&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+O-1])&f.hash_mask,I=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart),I!==0&&f.strstart-I<=f.w_size-et&&(f.match_length=Z(f,I)),f.match_length>=O)if(D=s._tr_tally(f,f.strstart-f.match_start,f.match_length-O),f.lookahead-=f.match_length,f.match_length<=f.max_lazy_match&&f.lookahead>=O){for(f.match_length--;f.strstart++,f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+O-1])&f.hash_mask,I=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart,--f.match_length!=0;);f.strstart++}else f.strstart+=f.match_length,f.match_length=0,f.ins_h=f.window[f.strstart],f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+1])&f.hash_mask;else D=s._tr_tally(f,0,f.window[f.strstart]),f.lookahead--,f.strstart++;if(D&&(B(f,!1),f.strm.avail_out===0))return g}return f.insert=f.strstart<O-1?f.strstart:O-1,F===d?(B(f,!0),f.strm.avail_out===0?at:H):f.last_lit&&(B(f,!1),f.strm.avail_out===0)?g:j}function ft(f,F){for(var I,D,E;;){if(f.lookahead<et){if(Et(f),f.lookahead<et&&F===p)return g;if(f.lookahead===0)break}if(I=0,f.lookahead>=O&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+O-1])&f.hash_mask,I=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart),f.prev_length=f.match_length,f.prev_match=f.match_start,f.match_length=O-1,I!==0&&f.prev_length<f.max_lazy_match&&f.strstart-I<=f.w_size-et&&(f.match_length=Z(f,I),f.match_length<=5&&(f.strategy===1||f.match_length===O&&4096<f.strstart-f.match_start)&&(f.match_length=O-1)),f.prev_length>=O&&f.match_length<=f.prev_length){for(E=f.strstart+f.lookahead-O,D=s._tr_tally(f,f.strstart-1-f.prev_match,f.prev_length-O),f.lookahead-=f.prev_length-1,f.prev_length-=2;++f.strstart<=E&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+O-1])&f.hash_mask,I=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart),--f.prev_length!=0;);if(f.match_available=0,f.match_length=O-1,f.strstart++,D&&(B(f,!1),f.strm.avail_out===0))return g}else if(f.match_available){if((D=s._tr_tally(f,0,f.window[f.strstart-1]))&&B(f,!1),f.strstart++,f.lookahead--,f.strm.avail_out===0)return g}else f.match_available=1,f.strstart++,f.lookahead--}return f.match_available&&(D=s._tr_tally(f,0,f.window[f.strstart-1]),f.match_available=0),f.insert=f.strstart<O-1?f.strstart:O-1,F===d?(B(f,!0),f.strm.avail_out===0?at:H):f.last_lit&&(B(f,!1),f.strm.avail_out===0)?g:j}function vt(f,F,I,D,E){this.good_length=f,this.max_lazy=F,this.nice_length=I,this.max_chain=D,this.func=E}function Tt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=_,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*A),this.dyn_dtree=new a.Buf16(2*(2*T+1)),this.bl_tree=new a.Buf16(2*(2*P+1)),st(this.dyn_ltree),st(this.dyn_dtree),st(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(V+1),this.heap=new a.Buf16(2*C+1),st(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*C+1),st(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Dt(f){var F;return f&&f.state?(f.total_in=f.total_out=0,f.data_type=v,(F=f.state).pending=0,F.pending_out=0,F.wrap<0&&(F.wrap=-F.wrap),F.status=F.wrap?S:$,f.adler=F.wrap===2?0:1,F.last_flush=p,s._tr_init(F),u):ct(f,m)}function zt(f){var F=Dt(f);return F===u&&function(I){I.window_size=2*I.w_size,st(I.head),I.max_lazy_match=r[I.level].max_lazy,I.good_match=r[I.level].good_length,I.nice_match=r[I.level].nice_length,I.max_chain_length=r[I.level].max_chain,I.strstart=0,I.block_start=0,I.lookahead=0,I.insert=0,I.match_length=I.prev_length=O-1,I.match_available=0,I.ins_h=0}(f.state),F}function $t(f,F,I,D,E,R){if(!f)return m;var z=1;if(F===b&&(F=6),D<0?(z=0,D=-D):15<D&&(z=2,D-=16),E<1||w<E||I!==_||D<8||15<D||F<0||9<F||R<0||y<R)return ct(f,m);D===8&&(D=9);var G=new Tt;return(f.state=G).strm=f,G.wrap=z,G.gzhead=null,G.w_bits=D,G.w_size=1<<G.w_bits,G.w_mask=G.w_size-1,G.hash_bits=E+7,G.hash_size=1<<G.hash_bits,G.hash_mask=G.hash_size-1,G.hash_shift=~~((G.hash_bits+O-1)/O),G.window=new a.Buf8(2*G.w_size),G.head=new a.Buf16(G.hash_size),G.prev=new a.Buf16(G.w_size),G.lit_bufsize=1<<E+6,G.pending_buf_size=4*G.lit_bufsize,G.pending_buf=new a.Buf8(G.pending_buf_size),G.d_buf=1*G.lit_bufsize,G.l_buf=3*G.lit_bufsize,G.level=F,G.strategy=R,G.method=I,zt(f)}r=[new vt(0,0,0,0,function(f,F){var I=65535;for(I>f.pending_buf_size-5&&(I=f.pending_buf_size-5);;){if(f.lookahead<=1){if(Et(f),f.lookahead===0&&F===p)return g;if(f.lookahead===0)break}f.strstart+=f.lookahead,f.lookahead=0;var D=f.block_start+I;if((f.strstart===0||f.strstart>=D)&&(f.lookahead=f.strstart-D,f.strstart=D,B(f,!1),f.strm.avail_out===0)||f.strstart-f.block_start>=f.w_size-et&&(B(f,!1),f.strm.avail_out===0))return g}return f.insert=0,F===d?(B(f,!0),f.strm.avail_out===0?at:H):(f.strstart>f.block_start&&(B(f,!1),f.strm.avail_out),g)}),new vt(4,4,8,4,kt),new vt(4,5,16,8,kt),new vt(4,6,32,32,kt),new vt(4,4,16,16,ft),new vt(8,16,32,32,ft),new vt(8,16,128,128,ft),new vt(8,32,128,256,ft),new vt(32,128,258,1024,ft),new vt(32,258,258,4096,ft)],o.deflateInit=function(f,F){return $t(f,F,_,15,8,0)},o.deflateInit2=$t,o.deflateReset=zt,o.deflateResetKeep=Dt,o.deflateSetHeader=function(f,F){return f&&f.state?f.state.wrap!==2?m:(f.state.gzhead=F,u):m},o.deflate=function(f,F){var I,D,E,R;if(!f||!f.state||5<F||F<0)return f?ct(f,m):m;if(D=f.state,!f.output||!f.input&&f.avail_in!==0||D.status===666&&F!==d)return ct(f,f.avail_out===0?-5:m);if(D.strm=f,I=D.last_flush,D.last_flush=F,D.status===S)if(D.wrap===2)f.adler=0,nt(D,31),nt(D,139),nt(D,8),D.gzhead?(nt(D,(D.gzhead.text?1:0)+(D.gzhead.hcrc?2:0)+(D.gzhead.extra?4:0)+(D.gzhead.name?8:0)+(D.gzhead.comment?16:0)),nt(D,255&D.gzhead.time),nt(D,D.gzhead.time>>8&255),nt(D,D.gzhead.time>>16&255),nt(D,D.gzhead.time>>24&255),nt(D,D.level===9?2:2<=D.strategy||D.level<2?4:0),nt(D,255&D.gzhead.os),D.gzhead.extra&&D.gzhead.extra.length&&(nt(D,255&D.gzhead.extra.length),nt(D,D.gzhead.extra.length>>8&255)),D.gzhead.hcrc&&(f.adler=c(f.adler,D.pending_buf,D.pending,0)),D.gzindex=0,D.status=69):(nt(D,0),nt(D,0),nt(D,0),nt(D,0),nt(D,0),nt(D,D.level===9?2:2<=D.strategy||D.level<2?4:0),nt(D,3),D.status=$);else{var z=_+(D.w_bits-8<<4)<<8;z|=(2<=D.strategy||D.level<2?0:D.level<6?1:D.level===6?2:3)<<6,D.strstart!==0&&(z|=32),z+=31-z%31,D.status=$,Q(D,z),D.strstart!==0&&(Q(D,f.adler>>>16),Q(D,65535&f.adler)),f.adler=1}if(D.status===69)if(D.gzhead.extra){for(E=D.pending;D.gzindex<(65535&D.gzhead.extra.length)&&(D.pending!==D.pending_buf_size||(D.gzhead.hcrc&&D.pending>E&&(f.adler=c(f.adler,D.pending_buf,D.pending-E,E)),N(f),E=D.pending,D.pending!==D.pending_buf_size));)nt(D,255&D.gzhead.extra[D.gzindex]),D.gzindex++;D.gzhead.hcrc&&D.pending>E&&(f.adler=c(f.adler,D.pending_buf,D.pending-E,E)),D.gzindex===D.gzhead.extra.length&&(D.gzindex=0,D.status=73)}else D.status=73;if(D.status===73)if(D.gzhead.name){E=D.pending;do{if(D.pending===D.pending_buf_size&&(D.gzhead.hcrc&&D.pending>E&&(f.adler=c(f.adler,D.pending_buf,D.pending-E,E)),N(f),E=D.pending,D.pending===D.pending_buf_size)){R=1;break}R=D.gzindex<D.gzhead.name.length?255&D.gzhead.name.charCodeAt(D.gzindex++):0,nt(D,R)}while(R!==0);D.gzhead.hcrc&&D.pending>E&&(f.adler=c(f.adler,D.pending_buf,D.pending-E,E)),R===0&&(D.gzindex=0,D.status=91)}else D.status=91;if(D.status===91)if(D.gzhead.comment){E=D.pending;do{if(D.pending===D.pending_buf_size&&(D.gzhead.hcrc&&D.pending>E&&(f.adler=c(f.adler,D.pending_buf,D.pending-E,E)),N(f),E=D.pending,D.pending===D.pending_buf_size)){R=1;break}R=D.gzindex<D.gzhead.comment.length?255&D.gzhead.comment.charCodeAt(D.gzindex++):0,nt(D,R)}while(R!==0);D.gzhead.hcrc&&D.pending>E&&(f.adler=c(f.adler,D.pending_buf,D.pending-E,E)),R===0&&(D.status=103)}else D.status=103;if(D.status===103&&(D.gzhead.hcrc?(D.pending+2>D.pending_buf_size&&N(f),D.pending+2<=D.pending_buf_size&&(nt(D,255&f.adler),nt(D,f.adler>>8&255),f.adler=0,D.status=$)):D.status=$),D.pending!==0){if(N(f),f.avail_out===0)return D.last_flush=-1,u}else if(f.avail_in===0&&X(F)<=X(I)&&F!==d)return ct(f,-5);if(D.status===666&&f.avail_in!==0)return ct(f,-5);if(f.avail_in!==0||D.lookahead!==0||F!==p&&D.status!==666){var G=D.strategy===2?function(L,q){for(var tt;;){if(L.lookahead===0&&(Et(L),L.lookahead===0)){if(q===p)return g;break}if(L.match_length=0,tt=s._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++,tt&&(B(L,!1),L.strm.avail_out===0))return g}return L.insert=0,q===d?(B(L,!0),L.strm.avail_out===0?at:H):L.last_lit&&(B(L,!1),L.strm.avail_out===0)?g:j}(D,F):D.strategy===3?function(L,q){for(var tt,K,ot,_t,gt=L.window;;){if(L.lookahead<=Y){if(Et(L),L.lookahead<=Y&&q===p)return g;if(L.lookahead===0)break}if(L.match_length=0,L.lookahead>=O&&0<L.strstart&&(K=gt[ot=L.strstart-1])===gt[++ot]&&K===gt[++ot]&&K===gt[++ot]){_t=L.strstart+Y;do;while(K===gt[++ot]&&K===gt[++ot]&&K===gt[++ot]&&K===gt[++ot]&&K===gt[++ot]&&K===gt[++ot]&&K===gt[++ot]&&K===gt[++ot]&&ot<_t);L.match_length=Y-(_t-ot),L.match_length>L.lookahead&&(L.match_length=L.lookahead)}if(L.match_length>=O?(tt=s._tr_tally(L,1,L.match_length-O),L.lookahead-=L.match_length,L.strstart+=L.match_length,L.match_length=0):(tt=s._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++),tt&&(B(L,!1),L.strm.avail_out===0))return g}return L.insert=0,q===d?(B(L,!0),L.strm.avail_out===0?at:H):L.last_lit&&(B(L,!1),L.strm.avail_out===0)?g:j}(D,F):r[D.level].func(D,F);if(G!==at&&G!==H||(D.status=666),G===g||G===at)return f.avail_out===0&&(D.last_flush=-1),u;if(G===j&&(F===1?s._tr_align(D):F!==5&&(s._tr_stored_block(D,0,0,!1),F===3&&(st(D.head),D.lookahead===0&&(D.strstart=0,D.block_start=0,D.insert=0))),N(f),f.avail_out===0))return D.last_flush=-1,u}return F!==d?u:D.wrap<=0?1:(D.wrap===2?(nt(D,255&f.adler),nt(D,f.adler>>8&255),nt(D,f.adler>>16&255),nt(D,f.adler>>24&255),nt(D,255&f.total_in),nt(D,f.total_in>>8&255),nt(D,f.total_in>>16&255),nt(D,f.total_in>>24&255)):(Q(D,f.adler>>>16),Q(D,65535&f.adler)),N(f),0<D.wrap&&(D.wrap=-D.wrap),D.pending!==0?u:1)},o.deflateEnd=function(f){var F;return f&&f.state?(F=f.state.status)!==S&&F!==69&&F!==73&&F!==91&&F!==103&&F!==$&&F!==666?ct(f,m):(f.state=null,F===$?ct(f,-3):u):m},o.deflateSetDictionary=function(f,F){var I,D,E,R,z,G,L,q,tt=F.length;if(!f||!f.state||(R=(I=f.state).wrap)===2||R===1&&I.status!==S||I.lookahead)return m;for(R===1&&(f.adler=l(f.adler,F,tt,0)),I.wrap=0,tt>=I.w_size&&(R===0&&(st(I.head),I.strstart=0,I.block_start=0,I.insert=0),q=new a.Buf8(I.w_size),a.arraySet(q,F,tt-I.w_size,I.w_size,0),F=q,tt=I.w_size),z=f.avail_in,G=f.next_in,L=f.input,f.avail_in=tt,f.next_in=0,f.input=F,Et(I);I.lookahead>=O;){for(D=I.strstart,E=I.lookahead-(O-1);I.ins_h=(I.ins_h<<I.hash_shift^I.window[D+O-1])&I.hash_mask,I.prev[D&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=D,D++,--E;);I.strstart=D,I.lookahead=O-1,Et(I)}return I.strstart+=I.lookahead,I.block_start=I.strstart,I.insert=I.lookahead,I.lookahead=0,I.match_length=I.prev_length=O-1,I.match_available=0,f.next_in=G,f.input=L,f.avail_in=z,I.wrap=R,u},o.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(i,n,o){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(i,n,o){n.exports=function(r,a){var s,l,c,h,p,d,u,m,b,y,v,_,w,C,T,P,A,V,O,Y,et,S,$,g,j;s=r.state,l=r.next_in,g=r.input,c=l+(r.avail_in-5),h=r.next_out,j=r.output,p=h-(a-r.avail_out),d=h+(r.avail_out-257),u=s.dmax,m=s.wsize,b=s.whave,y=s.wnext,v=s.window,_=s.hold,w=s.bits,C=s.lencode,T=s.distcode,P=(1<<s.lenbits)-1,A=(1<<s.distbits)-1;t:do{w<15&&(_+=g[l++]<<w,w+=8,_+=g[l++]<<w,w+=8),V=C[_&P];e:for(;;){if(_>>>=O=V>>>24,w-=O,(O=V>>>16&255)===0)j[h++]=65535&V;else{if(!(16&O)){if(!(64&O)){V=C[(65535&V)+(_&(1<<O)-1)];continue e}if(32&O){s.mode=12;break t}r.msg="invalid literal/length code",s.mode=30;break t}Y=65535&V,(O&=15)&&(w<O&&(_+=g[l++]<<w,w+=8),Y+=_&(1<<O)-1,_>>>=O,w-=O),w<15&&(_+=g[l++]<<w,w+=8,_+=g[l++]<<w,w+=8),V=T[_&A];i:for(;;){if(_>>>=O=V>>>24,w-=O,!(16&(O=V>>>16&255))){if(!(64&O)){V=T[(65535&V)+(_&(1<<O)-1)];continue i}r.msg="invalid distance code",s.mode=30;break t}if(et=65535&V,w<(O&=15)&&(_+=g[l++]<<w,(w+=8)<O&&(_+=g[l++]<<w,w+=8)),u<(et+=_&(1<<O)-1)){r.msg="invalid distance too far back",s.mode=30;break t}if(_>>>=O,w-=O,(O=h-p)<et){if(b<(O=et-O)&&s.sane){r.msg="invalid distance too far back",s.mode=30;break t}if($=v,(S=0)===y){if(S+=m-O,O<Y){for(Y-=O;j[h++]=v[S++],--O;);S=h-et,$=j}}else if(y<O){if(S+=m+y-O,(O-=y)<Y){for(Y-=O;j[h++]=v[S++],--O;);if(S=0,y<Y){for(Y-=O=y;j[h++]=v[S++],--O;);S=h-et,$=j}}}else if(S+=y-O,O<Y){for(Y-=O;j[h++]=v[S++],--O;);S=h-et,$=j}for(;2<Y;)j[h++]=$[S++],j[h++]=$[S++],j[h++]=$[S++],Y-=3;Y&&(j[h++]=$[S++],1<Y&&(j[h++]=$[S++]))}else{for(S=h-et;j[h++]=j[S++],j[h++]=j[S++],j[h++]=j[S++],2<(Y-=3););Y&&(j[h++]=j[S++],1<Y&&(j[h++]=j[S++]))}break}}break}}while(l<c&&h<d);l-=Y=w>>3,_&=(1<<(w-=Y<<3))-1,r.next_in=l,r.next_out=h,r.avail_in=l<c?c-l+5:5-(l-c),r.avail_out=h<d?d-h+257:257-(h-d),s.hold=_,s.bits=w}},{}],49:[function(i,n,o){var r=i("../utils/common"),a=i("./adler32"),s=i("./crc32"),l=i("./inffast"),c=i("./inftrees"),h=1,p=2,d=0,u=-2,m=1,b=852,y=592;function v(S){return(S>>>24&255)+(S>>>8&65280)+((65280&S)<<8)+((255&S)<<24)}function _(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function w(S){var $;return S&&S.state?($=S.state,S.total_in=S.total_out=$.total=0,S.msg="",$.wrap&&(S.adler=1&$.wrap),$.mode=m,$.last=0,$.havedict=0,$.dmax=32768,$.head=null,$.hold=0,$.bits=0,$.lencode=$.lendyn=new r.Buf32(b),$.distcode=$.distdyn=new r.Buf32(y),$.sane=1,$.back=-1,d):u}function C(S){var $;return S&&S.state?(($=S.state).wsize=0,$.whave=0,$.wnext=0,w(S)):u}function T(S,$){var g,j;return S&&S.state?(j=S.state,$<0?(g=0,$=-$):(g=1+($>>4),$<48&&($&=15)),$&&($<8||15<$)?u:(j.window!==null&&j.wbits!==$&&(j.window=null),j.wrap=g,j.wbits=$,C(S))):u}function P(S,$){var g,j;return S?(j=new _,(S.state=j).window=null,(g=T(S,$))!==d&&(S.state=null),g):u}var A,V,O=!0;function Y(S){if(O){var $;for(A=new r.Buf32(512),V=new r.Buf32(32),$=0;$<144;)S.lens[$++]=8;for(;$<256;)S.lens[$++]=9;for(;$<280;)S.lens[$++]=7;for(;$<288;)S.lens[$++]=8;for(c(h,S.lens,0,288,A,0,S.work,{bits:9}),$=0;$<32;)S.lens[$++]=5;c(p,S.lens,0,32,V,0,S.work,{bits:5}),O=!1}S.lencode=A,S.lenbits=9,S.distcode=V,S.distbits=5}function et(S,$,g,j){var at,H=S.state;return H.window===null&&(H.wsize=1<<H.wbits,H.wnext=0,H.whave=0,H.window=new r.Buf8(H.wsize)),j>=H.wsize?(r.arraySet(H.window,$,g-H.wsize,H.wsize,0),H.wnext=0,H.whave=H.wsize):(j<(at=H.wsize-H.wnext)&&(at=j),r.arraySet(H.window,$,g-j,at,H.wnext),(j-=at)?(r.arraySet(H.window,$,g-j,j,0),H.wnext=j,H.whave=H.wsize):(H.wnext+=at,H.wnext===H.wsize&&(H.wnext=0),H.whave<H.wsize&&(H.whave+=at))),0}o.inflateReset=C,o.inflateReset2=T,o.inflateResetKeep=w,o.inflateInit=function(S){return P(S,15)},o.inflateInit2=P,o.inflate=function(S,$){var g,j,at,H,ct,X,st,N,B,nt,Q,Z,Et,kt,ft,vt,Tt,Dt,zt,$t,f,F,I,D,E=0,R=new r.Buf8(4),z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!S||!S.state||!S.output||!S.input&&S.avail_in!==0)return u;(g=S.state).mode===12&&(g.mode=13),ct=S.next_out,at=S.output,st=S.avail_out,H=S.next_in,j=S.input,X=S.avail_in,N=g.hold,B=g.bits,nt=X,Q=st,F=d;t:for(;;)switch(g.mode){case m:if(g.wrap===0){g.mode=13;break}for(;B<16;){if(X===0)break t;X--,N+=j[H++]<<B,B+=8}if(2&g.wrap&&N===35615){R[g.check=0]=255&N,R[1]=N>>>8&255,g.check=s(g.check,R,2,0),B=N=0,g.mode=2;break}if(g.flags=0,g.head&&(g.head.done=!1),!(1&g.wrap)||(((255&N)<<8)+(N>>8))%31){S.msg="incorrect header check",g.mode=30;break}if((15&N)!=8){S.msg="unknown compression method",g.mode=30;break}if(B-=4,f=8+(15&(N>>>=4)),g.wbits===0)g.wbits=f;else if(f>g.wbits){S.msg="invalid window size",g.mode=30;break}g.dmax=1<<f,S.adler=g.check=1,g.mode=512&N?10:12,B=N=0;break;case 2:for(;B<16;){if(X===0)break t;X--,N+=j[H++]<<B,B+=8}if(g.flags=N,(255&g.flags)!=8){S.msg="unknown compression method",g.mode=30;break}if(57344&g.flags){S.msg="unknown header flags set",g.mode=30;break}g.head&&(g.head.text=N>>8&1),512&g.flags&&(R[0]=255&N,R[1]=N>>>8&255,g.check=s(g.check,R,2,0)),B=N=0,g.mode=3;case 3:for(;B<32;){if(X===0)break t;X--,N+=j[H++]<<B,B+=8}g.head&&(g.head.time=N),512&g.flags&&(R[0]=255&N,R[1]=N>>>8&255,R[2]=N>>>16&255,R[3]=N>>>24&255,g.check=s(g.check,R,4,0)),B=N=0,g.mode=4;case 4:for(;B<16;){if(X===0)break t;X--,N+=j[H++]<<B,B+=8}g.head&&(g.head.xflags=255&N,g.head.os=N>>8),512&g.flags&&(R[0]=255&N,R[1]=N>>>8&255,g.check=s(g.check,R,2,0)),B=N=0,g.mode=5;case 5:if(1024&g.flags){for(;B<16;){if(X===0)break t;X--,N+=j[H++]<<B,B+=8}g.length=N,g.head&&(g.head.extra_len=N),512&g.flags&&(R[0]=255&N,R[1]=N>>>8&255,g.check=s(g.check,R,2,0)),B=N=0}else g.head&&(g.head.extra=null);g.mode=6;case 6:if(1024&g.flags&&(X<(Z=g.length)&&(Z=X),Z&&(g.head&&(f=g.head.extra_len-g.length,g.head.extra||(g.head.extra=new Array(g.head.extra_len)),r.arraySet(g.head.extra,j,H,Z,f)),512&g.flags&&(g.check=s(g.check,j,Z,H)),X-=Z,H+=Z,g.length-=Z),g.length))break t;g.length=0,g.mode=7;case 7:if(2048&g.flags){if(X===0)break t;for(Z=0;f=j[H+Z++],g.head&&f&&g.length<65536&&(g.head.name+=String.fromCharCode(f)),f&&Z<X;);if(512&g.flags&&(g.check=s(g.check,j,Z,H)),X-=Z,H+=Z,f)break t}else g.head&&(g.head.name=null);g.length=0,g.mode=8;case 8:if(4096&g.flags){if(X===0)break t;for(Z=0;f=j[H+Z++],g.head&&f&&g.length<65536&&(g.head.comment+=String.fromCharCode(f)),f&&Z<X;);if(512&g.flags&&(g.check=s(g.check,j,Z,H)),X-=Z,H+=Z,f)break t}else g.head&&(g.head.comment=null);g.mode=9;case 9:if(512&g.flags){for(;B<16;){if(X===0)break t;X--,N+=j[H++]<<B,B+=8}if(N!==(65535&g.check)){S.msg="header crc mismatch",g.mode=30;break}B=N=0}g.head&&(g.head.hcrc=g.flags>>9&1,g.head.done=!0),S.adler=g.check=0,g.mode=12;break;case 10:for(;B<32;){if(X===0)break t;X--,N+=j[H++]<<B,B+=8}S.adler=g.check=v(N),B=N=0,g.mode=11;case 11:if(g.havedict===0)return S.next_out=ct,S.avail_out=st,S.next_in=H,S.avail_in=X,g.hold=N,g.bits=B,2;S.adler=g.check=1,g.mode=12;case 12:if($===5||$===6)break t;case 13:if(g.last){N>>>=7&B,B-=7&B,g.mode=27;break}for(;B<3;){if(X===0)break t;X--,N+=j[H++]<<B,B+=8}switch(g.last=1&N,B-=1,3&(N>>>=1)){case 0:g.mode=14;break;case 1:if(Y(g),g.mode=20,$!==6)break;N>>>=2,B-=2;break t;case 2:g.mode=17;break;case 3:S.msg="invalid block type",g.mode=30}N>>>=2,B-=2;break;case 14:for(N>>>=7&B,B-=7&B;B<32;){if(X===0)break t;X--,N+=j[H++]<<B,B+=8}if((65535&N)!=(N>>>16^65535)){S.msg="invalid stored block lengths",g.mode=30;break}if(g.length=65535&N,B=N=0,g.mode=15,$===6)break t;case 15:g.mode=16;case 16:if(Z=g.length){if(X<Z&&(Z=X),st<Z&&(Z=st),Z===0)break t;r.arraySet(at,j,H,Z,ct),X-=Z,H+=Z,st-=Z,ct+=Z,g.length-=Z;break}g.mode=12;break;case 17:for(;B<14;){if(X===0)break t;X--,N+=j[H++]<<B,B+=8}if(g.nlen=257+(31&N),N>>>=5,B-=5,g.ndist=1+(31&N),N>>>=5,B-=5,g.ncode=4+(15&N),N>>>=4,B-=4,286<g.nlen||30<g.ndist){S.msg="too many length or distance symbols",g.mode=30;break}g.have=0,g.mode=18;case 18:for(;g.have<g.ncode;){for(;B<3;){if(X===0)break t;X--,N+=j[H++]<<B,B+=8}g.lens[z[g.have++]]=7&N,N>>>=3,B-=3}for(;g.have<19;)g.lens[z[g.have++]]=0;if(g.lencode=g.lendyn,g.lenbits=7,I={bits:g.lenbits},F=c(0,g.lens,0,19,g.lencode,0,g.work,I),g.lenbits=I.bits,F){S.msg="invalid code lengths set",g.mode=30;break}g.have=0,g.mode=19;case 19:for(;g.have<g.nlen+g.ndist;){for(;vt=(E=g.lencode[N&(1<<g.lenbits)-1])>>>16&255,Tt=65535&E,!((ft=E>>>24)<=B);){if(X===0)break t;X--,N+=j[H++]<<B,B+=8}if(Tt<16)N>>>=ft,B-=ft,g.lens[g.have++]=Tt;else{if(Tt===16){for(D=ft+2;B<D;){if(X===0)break t;X--,N+=j[H++]<<B,B+=8}if(N>>>=ft,B-=ft,g.have===0){S.msg="invalid bit length repeat",g.mode=30;break}f=g.lens[g.have-1],Z=3+(3&N),N>>>=2,B-=2}else if(Tt===17){for(D=ft+3;B<D;){if(X===0)break t;X--,N+=j[H++]<<B,B+=8}B-=ft,f=0,Z=3+(7&(N>>>=ft)),N>>>=3,B-=3}else{for(D=ft+7;B<D;){if(X===0)break t;X--,N+=j[H++]<<B,B+=8}B-=ft,f=0,Z=11+(127&(N>>>=ft)),N>>>=7,B-=7}if(g.have+Z>g.nlen+g.ndist){S.msg="invalid bit length repeat",g.mode=30;break}for(;Z--;)g.lens[g.have++]=f}}if(g.mode===30)break;if(g.lens[256]===0){S.msg="invalid code -- missing end-of-block",g.mode=30;break}if(g.lenbits=9,I={bits:g.lenbits},F=c(h,g.lens,0,g.nlen,g.lencode,0,g.work,I),g.lenbits=I.bits,F){S.msg="invalid literal/lengths set",g.mode=30;break}if(g.distbits=6,g.distcode=g.distdyn,I={bits:g.distbits},F=c(p,g.lens,g.nlen,g.ndist,g.distcode,0,g.work,I),g.distbits=I.bits,F){S.msg="invalid distances set",g.mode=30;break}if(g.mode=20,$===6)break t;case 20:g.mode=21;case 21:if(6<=X&&258<=st){S.next_out=ct,S.avail_out=st,S.next_in=H,S.avail_in=X,g.hold=N,g.bits=B,l(S,Q),ct=S.next_out,at=S.output,st=S.avail_out,H=S.next_in,j=S.input,X=S.avail_in,N=g.hold,B=g.bits,g.mode===12&&(g.back=-1);break}for(g.back=0;vt=(E=g.lencode[N&(1<<g.lenbits)-1])>>>16&255,Tt=65535&E,!((ft=E>>>24)<=B);){if(X===0)break t;X--,N+=j[H++]<<B,B+=8}if(vt&&!(240&vt)){for(Dt=ft,zt=vt,$t=Tt;vt=(E=g.lencode[$t+((N&(1<<Dt+zt)-1)>>Dt)])>>>16&255,Tt=65535&E,!(Dt+(ft=E>>>24)<=B);){if(X===0)break t;X--,N+=j[H++]<<B,B+=8}N>>>=Dt,B-=Dt,g.back+=Dt}if(N>>>=ft,B-=ft,g.back+=ft,g.length=Tt,vt===0){g.mode=26;break}if(32&vt){g.back=-1,g.mode=12;break}if(64&vt){S.msg="invalid literal/length code",g.mode=30;break}g.extra=15&vt,g.mode=22;case 22:if(g.extra){for(D=g.extra;B<D;){if(X===0)break t;X--,N+=j[H++]<<B,B+=8}g.length+=N&(1<<g.extra)-1,N>>>=g.extra,B-=g.extra,g.back+=g.extra}g.was=g.length,g.mode=23;case 23:for(;vt=(E=g.distcode[N&(1<<g.distbits)-1])>>>16&255,Tt=65535&E,!((ft=E>>>24)<=B);){if(X===0)break t;X--,N+=j[H++]<<B,B+=8}if(!(240&vt)){for(Dt=ft,zt=vt,$t=Tt;vt=(E=g.distcode[$t+((N&(1<<Dt+zt)-1)>>Dt)])>>>16&255,Tt=65535&E,!(Dt+(ft=E>>>24)<=B);){if(X===0)break t;X--,N+=j[H++]<<B,B+=8}N>>>=Dt,B-=Dt,g.back+=Dt}if(N>>>=ft,B-=ft,g.back+=ft,64&vt){S.msg="invalid distance code",g.mode=30;break}g.offset=Tt,g.extra=15&vt,g.mode=24;case 24:if(g.extra){for(D=g.extra;B<D;){if(X===0)break t;X--,N+=j[H++]<<B,B+=8}g.offset+=N&(1<<g.extra)-1,N>>>=g.extra,B-=g.extra,g.back+=g.extra}if(g.offset>g.dmax){S.msg="invalid distance too far back",g.mode=30;break}g.mode=25;case 25:if(st===0)break t;if(Z=Q-st,g.offset>Z){if((Z=g.offset-Z)>g.whave&&g.sane){S.msg="invalid distance too far back",g.mode=30;break}Et=Z>g.wnext?(Z-=g.wnext,g.wsize-Z):g.wnext-Z,Z>g.length&&(Z=g.length),kt=g.window}else kt=at,Et=ct-g.offset,Z=g.length;for(st<Z&&(Z=st),st-=Z,g.length-=Z;at[ct++]=kt[Et++],--Z;);g.length===0&&(g.mode=21);break;case 26:if(st===0)break t;at[ct++]=g.length,st--,g.mode=21;break;case 27:if(g.wrap){for(;B<32;){if(X===0)break t;X--,N|=j[H++]<<B,B+=8}if(Q-=st,S.total_out+=Q,g.total+=Q,Q&&(S.adler=g.check=g.flags?s(g.check,at,Q,ct-Q):a(g.check,at,Q,ct-Q)),Q=st,(g.flags?N:v(N))!==g.check){S.msg="incorrect data check",g.mode=30;break}B=N=0}g.mode=28;case 28:if(g.wrap&&g.flags){for(;B<32;){if(X===0)break t;X--,N+=j[H++]<<B,B+=8}if(N!==(4294967295&g.total)){S.msg="incorrect length check",g.mode=30;break}B=N=0}g.mode=29;case 29:F=1;break t;case 30:F=-3;break t;case 31:return-4;case 32:default:return u}return S.next_out=ct,S.avail_out=st,S.next_in=H,S.avail_in=X,g.hold=N,g.bits=B,(g.wsize||Q!==S.avail_out&&g.mode<30&&(g.mode<27||$!==4))&&et(S,S.output,S.next_out,Q-S.avail_out)?(g.mode=31,-4):(nt-=S.avail_in,Q-=S.avail_out,S.total_in+=nt,S.total_out+=Q,g.total+=Q,g.wrap&&Q&&(S.adler=g.check=g.flags?s(g.check,at,Q,S.next_out-Q):a(g.check,at,Q,S.next_out-Q)),S.data_type=g.bits+(g.last?64:0)+(g.mode===12?128:0)+(g.mode===20||g.mode===15?256:0),(nt==0&&Q===0||$===4)&&F===d&&(F=-5),F)},o.inflateEnd=function(S){if(!S||!S.state)return u;var $=S.state;return $.window&&($.window=null),S.state=null,d},o.inflateGetHeader=function(S,$){var g;return S&&S.state&&2&(g=S.state).wrap?((g.head=$).done=!1,d):u},o.inflateSetDictionary=function(S,$){var g,j=$.length;return S&&S.state?(g=S.state).wrap!==0&&g.mode!==11?u:g.mode===11&&a(1,$,j,0)!==g.check?-3:et(S,$,j,j)?(g.mode=31,-4):(g.havedict=1,d):u},o.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(i,n,o){var r=i("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(h,p,d,u,m,b,y,v){var _,w,C,T,P,A,V,O,Y,et=v.bits,S=0,$=0,g=0,j=0,at=0,H=0,ct=0,X=0,st=0,N=0,B=null,nt=0,Q=new r.Buf16(16),Z=new r.Buf16(16),Et=null,kt=0;for(S=0;S<=15;S++)Q[S]=0;for($=0;$<u;$++)Q[p[d+$]]++;for(at=et,j=15;1<=j&&Q[j]===0;j--);if(j<at&&(at=j),j===0)return m[b++]=20971520,m[b++]=20971520,v.bits=1,0;for(g=1;g<j&&Q[g]===0;g++);for(at<g&&(at=g),S=X=1;S<=15;S++)if(X<<=1,(X-=Q[S])<0)return-1;if(0<X&&(h===0||j!==1))return-1;for(Z[1]=0,S=1;S<15;S++)Z[S+1]=Z[S]+Q[S];for($=0;$<u;$++)p[d+$]!==0&&(y[Z[p[d+$]]++]=$);if(A=h===0?(B=Et=y,19):h===1?(B=a,nt-=257,Et=s,kt-=257,256):(B=l,Et=c,-1),S=g,P=b,ct=$=N=0,C=-1,T=(st=1<<(H=at))-1,h===1&&852<st||h===2&&592<st)return 1;for(;;){for(V=S-ct,Y=y[$]<A?(O=0,y[$]):y[$]>A?(O=Et[kt+y[$]],B[nt+y[$]]):(O=96,0),_=1<<S-ct,g=w=1<<H;m[P+(N>>ct)+(w-=_)]=V<<24|O<<16|Y|0,w!==0;);for(_=1<<S-1;N&_;)_>>=1;if(_!==0?(N&=_-1,N+=_):N=0,$++,--Q[S]==0){if(S===j)break;S=p[d+y[$]]}if(at<S&&(N&T)!==C){for(ct===0&&(ct=at),P+=g,X=1<<(H=S-ct);H+ct<j&&!((X-=Q[H+ct])<=0);)H++,X<<=1;if(st+=1<<H,h===1&&852<st||h===2&&592<st)return 1;m[C=N&T]=at<<24|H<<16|P-b|0}}return N!==0&&(m[P+N]=S-ct<<24|64<<16|0),v.bits=at,0}},{"../utils/common":41}],51:[function(i,n,o){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(i,n,o){var r=i("../utils/common"),a=0,s=1;function l(E){for(var R=E.length;0<=--R;)E[R]=0}var c=0,h=29,p=256,d=p+1+h,u=30,m=19,b=2*d+1,y=15,v=16,_=7,w=256,C=16,T=17,P=18,A=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],V=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],O=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],et=new Array(2*(d+2));l(et);var S=new Array(2*u);l(S);var $=new Array(512);l($);var g=new Array(256);l(g);var j=new Array(h);l(j);var at,H,ct,X=new Array(u);function st(E,R,z,G,L){this.static_tree=E,this.extra_bits=R,this.extra_base=z,this.elems=G,this.max_length=L,this.has_stree=E&&E.length}function N(E,R){this.dyn_tree=E,this.max_code=0,this.stat_desc=R}function B(E){return E<256?$[E]:$[256+(E>>>7)]}function nt(E,R){E.pending_buf[E.pending++]=255&R,E.pending_buf[E.pending++]=R>>>8&255}function Q(E,R,z){E.bi_valid>v-z?(E.bi_buf|=R<<E.bi_valid&65535,nt(E,E.bi_buf),E.bi_buf=R>>v-E.bi_valid,E.bi_valid+=z-v):(E.bi_buf|=R<<E.bi_valid&65535,E.bi_valid+=z)}function Z(E,R,z){Q(E,z[2*R],z[2*R+1])}function Et(E,R){for(var z=0;z|=1&E,E>>>=1,z<<=1,0<--R;);return z>>>1}function kt(E,R,z){var G,L,q=new Array(y+1),tt=0;for(G=1;G<=y;G++)q[G]=tt=tt+z[G-1]<<1;for(L=0;L<=R;L++){var K=E[2*L+1];K!==0&&(E[2*L]=Et(q[K]++,K))}}function ft(E){var R;for(R=0;R<d;R++)E.dyn_ltree[2*R]=0;for(R=0;R<u;R++)E.dyn_dtree[2*R]=0;for(R=0;R<m;R++)E.bl_tree[2*R]=0;E.dyn_ltree[2*w]=1,E.opt_len=E.static_len=0,E.last_lit=E.matches=0}function vt(E){8<E.bi_valid?nt(E,E.bi_buf):0<E.bi_valid&&(E.pending_buf[E.pending++]=E.bi_buf),E.bi_buf=0,E.bi_valid=0}function Tt(E,R,z,G){var L=2*R,q=2*z;return E[L]<E[q]||E[L]===E[q]&&G[R]<=G[z]}function Dt(E,R,z){for(var G=E.heap[z],L=z<<1;L<=E.heap_len&&(L<E.heap_len&&Tt(R,E.heap[L+1],E.heap[L],E.depth)&&L++,!Tt(R,G,E.heap[L],E.depth));)E.heap[z]=E.heap[L],z=L,L<<=1;E.heap[z]=G}function zt(E,R,z){var G,L,q,tt,K=0;if(E.last_lit!==0)for(;G=E.pending_buf[E.d_buf+2*K]<<8|E.pending_buf[E.d_buf+2*K+1],L=E.pending_buf[E.l_buf+K],K++,G===0?Z(E,L,R):(Z(E,(q=g[L])+p+1,R),(tt=A[q])!==0&&Q(E,L-=j[q],tt),Z(E,q=B(--G),z),(tt=V[q])!==0&&Q(E,G-=X[q],tt)),K<E.last_lit;);Z(E,w,R)}function $t(E,R){var z,G,L,q=R.dyn_tree,tt=R.stat_desc.static_tree,K=R.stat_desc.has_stree,ot=R.stat_desc.elems,_t=-1;for(E.heap_len=0,E.heap_max=b,z=0;z<ot;z++)q[2*z]!==0?(E.heap[++E.heap_len]=_t=z,E.depth[z]=0):q[2*z+1]=0;for(;E.heap_len<2;)q[2*(L=E.heap[++E.heap_len]=_t<2?++_t:0)]=1,E.depth[L]=0,E.opt_len--,K&&(E.static_len-=tt[2*L+1]);for(R.max_code=_t,z=E.heap_len>>1;1<=z;z--)Dt(E,q,z);for(L=ot;z=E.heap[1],E.heap[1]=E.heap[E.heap_len--],Dt(E,q,1),G=E.heap[1],E.heap[--E.heap_max]=z,E.heap[--E.heap_max]=G,q[2*L]=q[2*z]+q[2*G],E.depth[L]=(E.depth[z]>=E.depth[G]?E.depth[z]:E.depth[G])+1,q[2*z+1]=q[2*G+1]=L,E.heap[1]=L++,Dt(E,q,1),2<=E.heap_len;);E.heap[--E.heap_max]=E.heap[1],function(gt,Ht){var ze,Kt,Ve,Rt,si,vi,Qt=Ht.dyn_tree,Ii=Ht.max_code,tn=Ht.stat_desc.static_tree,en=Ht.stat_desc.has_stree,nn=Ht.stat_desc.extra_bits,Ai=Ht.stat_desc.extra_base,Ge=Ht.stat_desc.max_length,ai=0;for(Rt=0;Rt<=y;Rt++)gt.bl_count[Rt]=0;for(Qt[2*gt.heap[gt.heap_max]+1]=0,ze=gt.heap_max+1;ze<b;ze++)Ge<(Rt=Qt[2*Qt[2*(Kt=gt.heap[ze])+1]+1]+1)&&(Rt=Ge,ai++),Qt[2*Kt+1]=Rt,Ii<Kt||(gt.bl_count[Rt]++,si=0,Ai<=Kt&&(si=nn[Kt-Ai]),vi=Qt[2*Kt],gt.opt_len+=vi*(Rt+si),en&&(gt.static_len+=vi*(tn[2*Kt+1]+si)));if(ai!==0){do{for(Rt=Ge-1;gt.bl_count[Rt]===0;)Rt--;gt.bl_count[Rt]--,gt.bl_count[Rt+1]+=2,gt.bl_count[Ge]--,ai-=2}while(0<ai);for(Rt=Ge;Rt!==0;Rt--)for(Kt=gt.bl_count[Rt];Kt!==0;)Ii<(Ve=gt.heap[--ze])||(Qt[2*Ve+1]!==Rt&&(gt.opt_len+=(Rt-Qt[2*Ve+1])*Qt[2*Ve],Qt[2*Ve+1]=Rt),Kt--)}}(E,R),kt(q,_t,E.bl_count)}function f(E,R,z){var G,L,q=-1,tt=R[1],K=0,ot=7,_t=4;for(tt===0&&(ot=138,_t=3),R[2*(z+1)+1]=65535,G=0;G<=z;G++)L=tt,tt=R[2*(G+1)+1],++K<ot&&L===tt||(K<_t?E.bl_tree[2*L]+=K:L!==0?(L!==q&&E.bl_tree[2*L]++,E.bl_tree[2*C]++):K<=10?E.bl_tree[2*T]++:E.bl_tree[2*P]++,q=L,_t=(K=0)===tt?(ot=138,3):L===tt?(ot=6,3):(ot=7,4))}function F(E,R,z){var G,L,q=-1,tt=R[1],K=0,ot=7,_t=4;for(tt===0&&(ot=138,_t=3),G=0;G<=z;G++)if(L=tt,tt=R[2*(G+1)+1],!(++K<ot&&L===tt)){if(K<_t)for(;Z(E,L,E.bl_tree),--K!=0;);else L!==0?(L!==q&&(Z(E,L,E.bl_tree),K--),Z(E,C,E.bl_tree),Q(E,K-3,2)):K<=10?(Z(E,T,E.bl_tree),Q(E,K-3,3)):(Z(E,P,E.bl_tree),Q(E,K-11,7));q=L,_t=(K=0)===tt?(ot=138,3):L===tt?(ot=6,3):(ot=7,4)}}l(X);var I=!1;function D(E,R,z,G){Q(E,(c<<1)+(G?1:0),3),function(L,q,tt,K){vt(L),nt(L,tt),nt(L,~tt),r.arraySet(L.pending_buf,L.window,q,tt,L.pending),L.pending+=tt}(E,R,z)}o._tr_init=function(E){I||(function(){var R,z,G,L,q,tt=new Array(y+1);for(L=G=0;L<h-1;L++)for(j[L]=G,R=0;R<1<<A[L];R++)g[G++]=L;for(g[G-1]=L,L=q=0;L<16;L++)for(X[L]=q,R=0;R<1<<V[L];R++)$[q++]=L;for(q>>=7;L<u;L++)for(X[L]=q<<7,R=0;R<1<<V[L]-7;R++)$[256+q++]=L;for(z=0;z<=y;z++)tt[z]=0;for(R=0;R<=143;)et[2*R+1]=8,R++,tt[8]++;for(;R<=255;)et[2*R+1]=9,R++,tt[9]++;for(;R<=279;)et[2*R+1]=7,R++,tt[7]++;for(;R<=287;)et[2*R+1]=8,R++,tt[8]++;for(kt(et,d+1,tt),R=0;R<u;R++)S[2*R+1]=5,S[2*R]=Et(R,5);at=new st(et,A,p+1,d,y),H=new st(S,V,0,u,y),ct=new st(new Array(0),O,0,m,_)}(),I=!0),E.l_desc=new N(E.dyn_ltree,at),E.d_desc=new N(E.dyn_dtree,H),E.bl_desc=new N(E.bl_tree,ct),E.bi_buf=0,E.bi_valid=0,ft(E)},o._tr_stored_block=D,o._tr_flush_block=function(E,R,z,G){var L,q,tt=0;0<E.level?(E.strm.data_type===2&&(E.strm.data_type=function(K){var ot,_t=4093624447;for(ot=0;ot<=31;ot++,_t>>>=1)if(1&_t&&K.dyn_ltree[2*ot]!==0)return a;if(K.dyn_ltree[18]!==0||K.dyn_ltree[20]!==0||K.dyn_ltree[26]!==0)return s;for(ot=32;ot<p;ot++)if(K.dyn_ltree[2*ot]!==0)return s;return a}(E)),$t(E,E.l_desc),$t(E,E.d_desc),tt=function(K){var ot;for(f(K,K.dyn_ltree,K.l_desc.max_code),f(K,K.dyn_dtree,K.d_desc.max_code),$t(K,K.bl_desc),ot=m-1;3<=ot&&K.bl_tree[2*Y[ot]+1]===0;ot--);return K.opt_len+=3*(ot+1)+5+5+4,ot}(E),L=E.opt_len+3+7>>>3,(q=E.static_len+3+7>>>3)<=L&&(L=q)):L=q=z+5,z+4<=L&&R!==-1?D(E,R,z,G):E.strategy===4||q===L?(Q(E,2+(G?1:0),3),zt(E,et,S)):(Q(E,4+(G?1:0),3),function(K,ot,_t,gt){var Ht;for(Q(K,ot-257,5),Q(K,_t-1,5),Q(K,gt-4,4),Ht=0;Ht<gt;Ht++)Q(K,K.bl_tree[2*Y[Ht]+1],3);F(K,K.dyn_ltree,ot-1),F(K,K.dyn_dtree,_t-1)}(E,E.l_desc.max_code+1,E.d_desc.max_code+1,tt+1),zt(E,E.dyn_ltree,E.dyn_dtree)),ft(E),G&&vt(E)},o._tr_tally=function(E,R,z){return E.pending_buf[E.d_buf+2*E.last_lit]=R>>>8&255,E.pending_buf[E.d_buf+2*E.last_lit+1]=255&R,E.pending_buf[E.l_buf+E.last_lit]=255&z,E.last_lit++,R===0?E.dyn_ltree[2*z]++:(E.matches++,R--,E.dyn_ltree[2*(g[z]+p+1)]++,E.dyn_dtree[2*B(R)]++),E.last_lit===E.lit_bufsize-1},o._tr_align=function(E){Q(E,2,3),Z(E,w,et),function(R){R.bi_valid===16?(nt(R,R.bi_buf),R.bi_buf=0,R.bi_valid=0):8<=R.bi_valid&&(R.pending_buf[R.pending++]=255&R.bi_buf,R.bi_buf>>=8,R.bi_valid-=8)}(E)}},{"../utils/common":41}],53:[function(i,n,o){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(i,n,o){(function(r){(function(a,s){if(!a.setImmediate){var l,c,h,p,d=1,u={},m=!1,b=a.document,y=Object.getPrototypeOf&&Object.getPrototypeOf(a);y=y&&y.setTimeout?y:a,l={}.toString.call(a.process)==="[object process]"?function(C){process.nextTick(function(){_(C)})}:function(){if(a.postMessage&&!a.importScripts){var C=!0,T=a.onmessage;return a.onmessage=function(){C=!1},a.postMessage("","*"),a.onmessage=T,C}}()?(p="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",w,!1):a.attachEvent("onmessage",w),function(C){a.postMessage(p+C,"*")}):a.MessageChannel?((h=new MessageChannel).port1.onmessage=function(C){_(C.data)},function(C){h.port2.postMessage(C)}):b&&"onreadystatechange"in b.createElement("script")?(c=b.documentElement,function(C){var T=b.createElement("script");T.onreadystatechange=function(){_(C),T.onreadystatechange=null,c.removeChild(T),T=null},c.appendChild(T)}):function(C){setTimeout(_,0,C)},y.setImmediate=function(C){typeof C!="function"&&(C=new Function(""+C));for(var T=new Array(arguments.length-1),P=0;P<T.length;P++)T[P]=arguments[P+1];var A={callback:C,args:T};return u[d]=A,l(d),d++},y.clearImmediate=v}function v(C){delete u[C]}function _(C){if(m)setTimeout(_,0,C);else{var T=u[C];if(T){m=!0;try{(function(P){var A=P.callback,V=P.args;switch(V.length){case 0:A();break;case 1:A(V[0]);break;case 2:A(V[0],V[1]);break;case 3:A(V[0],V[1],V[2]);break;default:A.apply(s,V)}})(T)}finally{v(C),m=!1}}}}function w(C){C.source===a&&typeof C.data=="string"&&C.data.indexOf(p)===0&&_(+C.data.slice(p.length))}})(typeof self>"u"?r===void 0?this:r:self)}).call(this,typeof dn<"u"?dn:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(yh);var Hb=yh.exports;const Ub=Gb(Hb);async function Wb(t){return Ub.loadAsync(t)}function De(){return["main"]}async function Yb(t){if(t.file)return t.file;if(t.link)return zb(gh(decodeURI(t.link)));if(t.id)return _h(vh(decodeURI(t.id)));if(t.hash&&yo(decodeURI(t.hash).trim()))return Vb(decodeURI(t.hash).trim());throw new Error("Could not search for file.")}const je=async t=>{let e=0;try{let i=function(){Ct.status("info",`Loading ${[...p].join(", ")}... [${l}/${c-2}]`,Rn(l/c,15,80))};console.time("loading time"),e=performance.now(),fn.enable(!1);let n=await Yb(t);Ct.status("info","Extracting zip",0),At.switchHeader(!1);const o=await Wb(n),r=o.filter(_=>_.endsWith("Info.dat")||_.endsWith("info.dat")||_.endsWith("Info.json")||_.endsWith("info.json")).map(_=>_.name.split("/")).filter(_=>_.length<=2).sort((_,w)=>_.length-w.length);if(r.length===0)throw new Error("Couldn't find Info.dat");let a=r[0].slice(0,-1).join("/");a&&($e.loading.nested=!0,a+="/"),fn.enable(!1),Ct.status("info","Parsing map info...",10),J.tInfo(De(),"Parsing map info");const s=await Nb(o,a);mt.beatmapInfo=s,ld(s),s.audio.duration&&(mt.duration=s.audio.duration,At.setSongDuration(s.audio.duration));let l=0,c=0,h=0;const p=new Set(["map","cover image","contributors image","audio","audio/BPM data"]),d=[new Promise(async _=>{J.tInfo(De(),"Loading cover image");const w=o.file(s.coverImageFilename);if(it.load.imageCover&&w){let C=await w.async("base64");At.setCoverImage("data:image;base64,"+C),$e.loading.coverImage=!0}else J.tError(De(),`${s.coverImageFilename} does not exists.`);l++,p.delete("cover image"),i(),_(null)}),new Promise(async _=>{if(mt.contributors=[],s.customData._contributors)for(const w of s.customData._contributors){J.tInfo(De(),"Loading contributor image "+w._name);const C=o.file(w._iconPath);let T=null;it.load.imageContributor&&C?T=await C.async("base64"):J.tError(De(),`${w._iconPath} does not exists.`),mt.contributors.push({...w,_base64:T})}Gu(mt.contributors),l++,p.delete("contributors image"),i(),_(null)}),new Promise(async _=>{J.tInfo(De(),"Loading audio");let w=o.file(s.audio.filename);if(it.load.audio&&w){let C=!1;setTimeout(()=>{!C&&!$e.loading.finished&&Ct.status("info","Loading audio... (this may take a while)",Rn(l/c,15,80))},1e4);let T=await w.async("arraybuffer");At.setAudio(T),await new AudioContext().decodeAudioData(T).then(A=>{C=!0;let V=A.duration;mt.duration=V,At.setSongDuration(V),$e.loading.audio=!0}).catch(function(A){At.setSongDuration(),J.tError(De(),A)})}else mt.duration||At.setSongDuration(),J.tError(De(),`${s.audio.filename} does not exist.`);l+=2,p.delete("Audio"),i(),_(null)}),new Promise(async _=>{const w=await Ob(s,o,a);l++,p.delete("audio/BPM data"),w&&($e.loading.audio||(mt.duration=w.duration),At.setSongDuration(w.duration),i()),_(w)}),...Ab(s,o,a).map(async(_,w,C)=>{const T=await _;return l++,h++,T===null?null:(C.length===h&&p.delete("map"),i(),T)})];c=d.length+2,i();const u=await Promise.allSettled(d);mt.beatmaps=u.slice(4).map(_=>_.status==="fulfilled"?_.value:null).filter(_=>_);const m=u[3].status==="fulfilled"?u[3].value:null;let b=Math.min(s.audio.bpm,...((m==null?void 0:m.bpm)??[]).map(_=>_.bpm)),y=Math.max(s.audio.bpm,...((m==null?void 0:m.bpm)??[]).map(_=>_.bpm));mt.beatmaps.forEach(_=>{_.rawVersion===4&&(_.timeProcessor.timescale=m.bpm);const w=_.timeProcessor.change.map(T=>T.BPM),C=_.timeProcessor.timescale.map(T=>_.timeProcessor.bpm/T.scale);b=Math.min(b,...w,...C),y=Math.max(y,...w,...C)}),b!==y&&At.setSongBPM(s.audio.bpm,b,y),Ui.adjustBeatTime(),hh.populateSelectCharacteristic(s),J.tInfo(De(),"Analysing map"),Ct.status("info","Analysing general...",85),gi.runGeneral(),Ui.displayOutputGeneral(),await nu(5),Ct.status("info","Analysing difficulty...",90),gi.applyAll(),Ui.displayOutputDifficulty(),await nu(5),fn.enable(!0);let v=performance.now();Ct.status("info",`Completed! (took ${M((v-e)/1e3,2)}s)`)}catch(i){Ct.status("error",i),J.tError(De(),i),mt.clear(),fn.enable(!0),At.switchHeader(!0)}finally{console.timeEnd("loading time")}},Sn=document.querySelector(".input__intro-url"),Cn=document.querySelector(".input__intro-id"),Tn=document.querySelector(".input__intro-hash"),Xb=document.querySelector(".input__search-button"),qb=document.querySelector(".input__file"),Eh=document.querySelector(".input__file-zone");Sn.addEventListener("keydown",Po);Cn.addEventListener("keydown",Po);Tn.addEventListener("keydown",Po);Xb.addEventListener("click",Kb);qb.addEventListener("change",Zb);Eh.addEventListener("drop",Jb);Eh.addEventListener("dragover",Qb);async function Po(t){const e=t.target;t.key==="Enter"&&e.value!==""&&(e.classList.contains("input__intro-url")&&await je({link:e.value}),e.classList.contains("input__intro-id")&&await je({id:e.value}),e.classList.contains("input__intro-hash")&&await je({hash:e.value}))}async function Kb(t){if(Sn&&Sn.value!==""){await je({link:Sn.value});return}if(Cn&&Cn.value!==""){await je({id:Cn.value});return}if(Tn&&Tn.value!==""){await je({hash:Tn.value});return}}async function Zb(t){const e=t.target;Ct.status("info","Reading file input",0);const i=e.files?e.files[0]:null;try{if(i==null)throw Ct.status("info","No file input",0),new Error("No file input");if(i&&(i.name.substr(-4)===".zip"||i.name.substr(-4)===".bsl")){const n=new FileReader;n.readAsArrayBuffer(i),n.addEventListener("load",async()=>{await je({file:i})})}else throw new Error("Unsupported file format, please enter zip file")}catch(n){Ct.status("error",n,0),console.error(n)}}async function Jb(t){t.preventDefault(),t.stopPropagation();try{if(t.dataTransfer==null)throw new Error("No file input");if(t.dataTransfer.items){if(!t.dataTransfer.items[0])throw new Error("Failed to retrieve file from drag & drop");if(t.dataTransfer.items[0].kind==="file"){let e=t.dataTransfer.items[0].getAsFile();if(e&&(e.name.substring(e.name.length-4)===".zip"||e.name.substring(e.name.length-4)===".bsl")){const i=new FileReader;i.readAsArrayBuffer(e),i.addEventListener("load",async()=>{await je({file:e})})}else throw new Error("Unsupported file format, please enter zip file")}}}catch(e){Ct.status("error",e,0),console.error(e)}}async function Qb(t){t.preventDefault(),t.stopPropagation()}const tg=document.querySelector("body"),eg=["Dark","Light","Monochrome"],$o={list:eg,set(t){tg.className="theme-"+t.toLowerCase().replace(" ","")}},Mo=document.querySelector(".settings__theme"),Dh=document.querySelector(".settings__beat-numbering"),wh=document.querySelector(".settings__rounding"),Sh=document.querySelector(".settings__info-count"),Ch=document.querySelector(".settings__data-check"),Th=document.querySelectorAll(".settings__load"),_o=document.querySelector(".settings__sort"),Rh=document.querySelectorAll(".settings__show"),ig=document.querySelector(".settings__clear-button");Mo.addEventListener("change",ng);$o.list.forEach(t=>{const e=document.createElement("option");e.value=t,e.textContent=t,Mo.add(e)});Dh.addEventListener("change",og);wh.addEventListener("change",rg);Sh.addEventListener("change",sg);Ch.addEventListener("change",ag);Th.forEach(t=>t.addEventListener("change",mg));_o.addEventListener("change",cg);Rh.forEach(t=>t.addEventListener("change",lg));ig.addEventListener("click",kh);function ng(t){const e=t.target;it.theme=e.options[e.options.selectedIndex].value,$o.set(it.theme),it.save()}function og(t){const e=t.target;it.beatNumbering=e.options[e.options.selectedIndex].value,it.save()}function rg(t){const e=t.target;it.rounding=parseInt(e.value),it.save()}function sg(t){const e=t.target;it.infoRowCount=parseInt(e.value),Hu(),it.save()}function ag(t){const e=t.target;it.dataCheck=e.checked,it.save()}function lg(t){const i=t.target.id.replace("settings__show-","");it.show=i,it.save()}function ug(t){Rh.forEach(e=>{e.id.endsWith(t)&&(e.checked=!0)})}function cg(t){const e=t.target;it.sorting=e.checked,it.save()}function hg(t){_o&&(_o.checked=t)}function mg(t){const e=t.target,i=e.name;it.load[i]=e.checked,it.save()}function fg(t,e){Th.forEach(i=>{i.name===t&&(i.checked=e)})}function pg(t){Mo.value=t}function dg(t){Dh.value=t}function bg(t){wh.value=t.toString()}function gg(t){Sh.value=t.toString(),Hu()}function vg(t){Ch.checked=t}function kh(){it.clear(),it.reset(),location.reload()}const Ue={setShowCheck:ug,setSortCheck:hg,setLoadCheck:fg,setTheme:pg,setBeatNumbering:dg,setRounding:bg,setInfoRow:gg,setDataCheck:vg,clear:kh},no={create:(t,e,i,n)=>{const o=document.createElement("div");return o.className=`panel ${hc[t]}`,e&&e!=="none"&&o.classList.add(mc[e]),i&&o.classList.add("panel--flex"+n?"-column":""),o}},$n="UI Stats: ",k="stats__";function _g(t,e){const i=e.timeProcessor,n=mt.duration||0,o=i.toRealTime(Wi(e.data)),r=document.createElement("table");return r.className=k+"table",r.innerHTML=`<caption class="${k}table-caption">Note Per Seconds (NPS):</caption><tr><th class="${k}table-header" colspan="2">Overall</th><td class="${k}table-element">${M(ar(e.data,n),2)}</td></tr><tr><th class="${k}table-header" colspan="2">Mapped</th><td class="${k}table-element">${M(ar(e.data,o),2)}</td></tr><tr><th class="${k}table-header" rowspan="3">Peak</th><th class="${k}table-header">16-beat</th><td class="${k}table-element">${M(Zn(e.data,16,i),2)}</td></tr><tr><th class="${k}table-header">8-beat</th><td class="${k}table-element">${M(Zn(e.data,8,i),2)}</td></tr><tr><th class="${k}table-header">4-beat</th><td class="${k}table-element">${M(Zn(e.data,4,i),2)}</td></tr>`,r}function yg(t,e){const i=qt.create(t.audio.bpm,e.settings.njs||qt.FallbackNJS[e.settings.difficulty],e.settings.njsOffset),n=document.createElement("table");return n.className=k+"table",n.innerHTML=`<caption class="${k}table-caption">Map Settings:</caption><tr><th class="${k}table-header" colspan="2">Note Jump Speed</th><td class="${k}table-element">${M(i.value,3)}</td></tr><tr><th class="${k}table-header" colspan="2">Spawn Distance Modifier</th><td class="${k}table-element">${M(i.offset,3)}</td></tr><tr><th class="${k}table-header" colspan="2">Half Jump Duration</th><td class="${k}table-element">${M(i.hjd,3)}</td></tr><tr><th class="${k}table-header" colspan="2">Jump Distance</th><td class="${k}table-element">${M(i.jd,3)}</td></tr><tr><th class="${k}table-header" colspan="2">Reaction Time</th><td class="${k}table-element">${M(i.reactionTime*1e3)}ms</td></tr>`,n}function Eg(t,e){const i=e.swingAnalysis,n=document.createElement("table");return n.className=k+"table",n.innerHTML=`<caption class="${k}table-caption">Swing Per Seconds (SPS):</caption><tr><th class="${k}table-header"></th><th class="${k}table-header">Total</th><th class="${k}table-header">Red</th><th class="${k}table-header">Blue</th></tr><tr><th class="${k}table-header">Average</th><td class="${k}table-element">${M(i.total.perSecond,2)}</td><td class="${k}table-element">${M(i.red.perSecond,2)}</td><td class="${k}table-element">${M(i.blue.perSecond,2)}</td></tr><tr><th class="${k}table-header">Median</th><td class="${k}table-element">${M(i.total.median,2)}</td><td class="${k}table-element">${M(i.red.median,2)}</td><td class="${k}table-element">${M(i.blue.median,2)}</td></tr><tr><th class="${k}table-header">Peak</th><td class="${k}table-element">${M(i.total.peak,2)}</td><td class="${k}table-element">${M(i.red.peak,2)}</td><td class="${k}table-element">${M(i.blue.peak,2)}</td></tr><tr><th class="${k}table-header">Total</th><td class="${k}table-element">${i.total.total}</td><td class="${k}table-element">${i.red.total}</td><td class="${k}table-element">${i.blue.total}</td></tr>`,n}function Lh(t,e){switch(e){case"note":return t.filter(i=>i.type===lt.COLOR);case"red":return t.filter(i=>i.type===lt.COLOR&&i.data.color===0);case"blue":return t.filter(i=>i.type===lt.COLOR&&i.data.color===1);case"arc":return t.filter(i=>i.type===lt.ARC);case"arc0":return t.filter(i=>i.type===lt.ARC&&i.data.color===0);case"arc1":return t.filter(i=>i.type===lt.ARC&&i.data.color===1);case"chain":return t.filter(i=>i.type===lt.CHAIN);case"chain0":return t.filter(i=>i.type===lt.CHAIN&&i.data.color===0);case"chain1":return t.filter(i=>i.type===lt.CHAIN&&i.data.color===1);case"bomb":return t.filter(i=>i.type===lt.BOMB);default:return t}}function Dg(t){var l;const e=t.target,i=e.id.replace(`${k}table-select-angle-`,"").split("-"),n=i[0],o=i[1],r=(l=mt.beatmaps.find(c=>c.settings.characteristic===n&&c.settings.difficulty===o))==null?void 0:l.noteContainer;if(!r){console.error($n+"note could not be found");return}const a=Lh(r,e.value).map(c=>c.data),s=document.querySelector(`#${k}table-angle-${n}-${o}`);s.innerHTML=Bh(a)}function Bh(t){const e=t.length||1,i=[4,0,5,2,8,3,6,1,7];let n="";for(let o=0;o<3;o++){n+="<tr>";for(let r=0;r<3;r++){let a=Kp(t,i[o*3+r]);n+=`<td class="${k}table-element">${a}<br>(${M(a/e*100,1)}%)</td>`}n+="</tr>"}return n}function wg(t,e){var r;const i=qi.create(`${k}table-select-angle-${e.settings.characteristic}-${e.settings.difficulty}`,"Note Angle: ","caption",`${k}table-caption`,{text:"All",value:"all"},{text:"Note Only",value:"note"},{text:"Red Note",value:"red"},{text:"Blue Note",value:"blue"},{text:"Arc Only",value:"arc"},{text:"Red Arc",value:"redArc"},{text:"Blue Arc",value:"blueArc"},{text:"Chain Only",value:"chain"},{text:"Red Chain",value:"redChain"},{text:"Blue Chain",value:"blueChain"});(r=i.querySelector("select"))==null||r.addEventListener("change",Dg);let n=`<tbody id="${k}table-angle-${e.settings.characteristic}-${e.settings.difficulty}">${Bh(e.noteContainer.map(a=>a.data))}</tbody>`;const o=document.createElement("table");return o.className=k+"table",o.innerHTML=n,o.prepend(i),o}function Sg(t,e){const i=e.environment,n=e.stats.basicEvents;let o=0,r=0,a=`<caption class="${k}table-caption">Events: ${Object.values(n).reduce((l,{total:c})=>l+c,0)}</caption>`;for(const l in n)o+=n[l].chroma,r+=n[l].chromaOld,a+=`<tr><th class="${k}table-header">${l}</th><th class="${k}table-header" colspan="4">${Gp(parseInt(l),i)}</th><td class="${k}table-element">${n[l].total}</td></tr>`;o&&(a+=`<tr><th class="${k}table-header" colspan="5">Chroma</th><td class="${k}table-element">${o}</td></tr>`),r&&(a+=`<tr><th class="${k}table-header" colspan="5">OG Chroma</th><td class="${k}table-element">${r}</td></tr>`);const s=document.createElement("table");return s.className=k+"table",s.innerHTML=a,s}function Cg(...t){for(const e of t)for(const i in e)for(const n of t)n[i]||(n[i]={groups:0,boxes:0,bases:0})}function Tg(t,e){const i=e.environment,n=e.stats.lightColorEventBoxGroups,o=e.stats.lightRotationEventBoxGroups,r=e.stats.lightTranslationEventBoxGroups,a=e.stats.fxEventBoxGroups;Cg(n,o,r,a);let s=`<caption class="${k}table-caption">Event Box Group:</caption><tr><th class="${k}table-header"></th><th class="${k}table-header">Group</th><th class="${k}table-header">Box</th><th class="${k}table-header">Base</th><tr><th class="${k}table-header">Color</th><td class="${k}table-element">${Object.values(n).reduce((d,{groups:u})=>d+u,0)}</td><td class="${k}table-element">${Object.values(n).reduce((d,{boxes:u})=>d+u,0)}</td><td class="${k}table-element">${Object.values(n).reduce((d,{bases:u})=>d+u,0)}</td></tr><tr><th class="${k}table-header">Rotate</th><td class="${k}table-element">${Object.values(o).reduce((d,{groups:u})=>d+u,0)}</td><td class="${k}table-element">${Object.values(o).reduce((d,{boxes:u})=>d+u,0)}</td><td class="${k}table-element">${Object.values(o).reduce((d,{bases:u})=>d+u,0)}</td></tr><tr><th class="${k}table-header">Translate</th><td class="${k}table-element">${Object.values(r).reduce((d,{groups:u})=>d+u,0)}</td><td class="${k}table-element">${Object.values(r).reduce((d,{boxes:u})=>d+u,0)}</td><td class="${k}table-element">${Object.values(r).reduce((d,{bases:u})=>d+u,0)}</td></tr><tr><th class="${k}table-header">FX</th><td class="${k}table-element">${Object.values(a).reduce((d,{groups:u})=>d+u,0)}</td><td class="${k}table-element">${Object.values(a).reduce((d,{boxes:u})=>d+u,0)}</td><td class="${k}table-element">${Object.values(a).reduce((d,{bases:u})=>d+u,0)}</td></tr><tr><th class="${k}table-header">Total</th><td class="${k}table-element">${Object.values(n).reduce((d,{groups:u})=>d+u,0)+Object.values(o).reduce((d,{groups:u})=>d+u,0)+Object.values(r).reduce((d,{groups:u})=>d+u,0)+Object.values(a).reduce((d,{groups:u})=>d+u,0)}</td><td class="${k}table-element">${Object.values(n).reduce((d,{boxes:u})=>d+u,0)+Object.values(o).reduce((d,{boxes:u})=>d+u,0)+Object.values(r).reduce((d,{boxes:u})=>d+u,0)+Object.values(a).reduce((d,{boxes:u})=>d+u,0)}</td><td class="${k}table-element">${Object.values(n).reduce((d,{bases:u})=>d+u,0)+Object.values(o).reduce((d,{bases:u})=>d+u,0)+Object.values(r).reduce((d,{bases:u})=>d+u,0)+Object.values(a).reduce((d,{bases:u})=>d+u,0)}</td></tr>`,l=`<caption class="${k}table-caption">Event Box Group ID:</caption>`;for(const d in n)l+=`<tr><th class="${k}table-header">${d}</th><th class="${k}table-header" colspan="5">${Up(parseInt(d),i)}</th><td class="${k}table-element" title="${n[d].groups} Box (${n[d].bases} Base)">${n[d].groups}</td><td class="${k}table-element" title="${o[d].boxes} Box (${o[d].bases} Base)">${o[d].groups}</td><td class="${k}table-element" title="${r[d].boxes} Box (${r[d].bases} Base)">${r[d].groups}</td><td class="${k}table-element" title="${a[d].groups} Box (${a[d].bases} Base)">${a[d].groups}</td></tr>`;const c=document.createElement("table");c.className=k+"table",c.innerHTML=s;const h=document.createElement("table");h.className=k+"table",h.innerHTML=l;const p=document.createElement("div");return p.appendChild(c),p.appendChild(document.createElement("br")),p.appendChild(h),p}function Rg(t,e){const i=e.stats.notes;let n=`<caption class="${k}table-caption">Note Information:</caption><tr><th class="${k}table-header" colspan="2">R/B Ratio</th><td class="${k}table-element">${M(i.red.total/i.blue.total,2)}</td></tr><tr><th class="${k}table-header" colspan="2">Max Score</th><td class="${k}table-element">${Oh(e.score)}</td></tr><tr><th class="${k}table-header" colspan="2">Effective BPM</th><td class="${k}table-element">${M(Jp(e.swingAnalysis.container),2)}</td></tr><tr><th class="${k}table-header" colspan="2">Effective BPM (swing)</th><td class="${k}table-element">${M(Qp(e.swingAnalysis.container),2)}</td></tr>`,o=M(sd(e.swingAnalysis.container)*1e3,1),r=M(ad(e.swingAnalysis.container)*1e3,1);o&&r&&(n+=`<tr><th class="${k}table-header" colspan="2">Min. Slider Speed</th><td class="${k}table-element">${o}ms</td></tr><tr><th class="${k}table-header" colspan="2">Max. Slider Speed</th><td class="${k}table-element">${r}ms</td></tr>`);const a=document.createElement("table");return a.className=k+"table",a.innerHTML=n,a}function kg(t,e){const i=e.stats.notes,n=e.stats.arcs,o=e.stats.chains,r=e.stats.bombs;let a=`<caption class="${k}table-caption">Note Count:</caption><tr><th class="${k}table-header"></th><th class="${k}table-header">Note</th><th class="${k}table-header">Arc</th><th class="${k}table-header">Chain</th><th class="${k}table-header">Bomb</th></tr><tr><th class="${k}table-header">Total</th><td class="${k}table-element">${i.red.total+i.blue.total}</td><td class="${k}table-element">${n.red.total+n.blue.total}</td><td class="${k}table-element">${o.red.total+o.blue.total}</td><td class="${k}table-element">${r.total}</td></tr><tr><th class="${k}table-header">Red</th><td class="${k}table-element">${i.red.total}</td><td class="${k}table-element">${n.red.total}</td><td class="${k}table-element">${o.red.total}</td><td class="${k}table-element">0</td></tr><tr><th class="${k}table-header">Blue</th><td class="${k}table-element">${i.blue.total}</td><td class="${k}table-element">${n.blue.total}</td><td class="${k}table-element">${o.blue.total}</td><td class="${k}table-element">0</td></tr>`;(i.red.chroma||i.blue.chroma||n.red.chroma||n.blue.chroma||o.red.chroma||o.blue.chroma||r.chroma)&&(a+=`<tr><th class="${k}table-header">Chroma</th><td class="${k}table-element">${i.red.chroma+i.blue.chroma}</td><td class="${k}table-element">${n.red.chroma+n.blue.chroma}</td><td class="${k}table-element">${o.red.chroma+o.blue.chroma}</td><td class="${k}table-element">${r.chroma}</td></tr>`),(i.red.noodleExtensions||i.blue.noodleExtensions||n.red.noodleExtensions||n.blue.noodleExtensions||o.red.noodleExtensions||o.blue.noodleExtensions||r.noodleExtensions)&&(a+=`<tr><th class="${k}table-header">NE</th><td class="${k}table-element">${i.red.noodleExtensions+i.blue.noodleExtensions}</td><td class="${k}table-element">${n.red.noodleExtensions+n.blue.noodleExtensions}</td><td class="${k}table-element">${o.red.noodleExtensions+o.blue.noodleExtensions}</td><td class="${k}table-element">${r.noodleExtensions}</td></tr></tr>`),(i.red.mappingExtensions||i.blue.mappingExtensions||n.red.mappingExtensions||n.blue.mappingExtensions||o.red.mappingExtensions||o.blue.mappingExtensions||r.mappingExtensions)&&(a+=`<tr><th class="${k}table-header">ME</th><td class="${k}table-element">${i.red.mappingExtensions+i.blue.mappingExtensions}</td><td class="${k}table-element">${n.red.mappingExtensions+n.blue.mappingExtensions}</td><td class="${k}table-element">${o.red.mappingExtensions+o.blue.mappingExtensions}</td><td class="${k}table-element">${r.mappingExtensions}</td></tr></tr>`);const s=document.createElement("table");return s.className=k+"table",s.innerHTML=a,s}function Lg(t){var l;const e=t.target,i=e.id.replace(`${k}table-select-placement-`,"").split("-"),n=i[0],o=i[1],r=(l=mt.beatmaps.find(c=>c.settings.characteristic===n&&c.settings.difficulty===o))==null?void 0:l.noteContainer;if(!r){console.error($n+"note could not be found");return}const a=Lh(r,e.value).map(c=>c.data),s=document.querySelector(`#${k}table-placement-${n}-${o}`);s.innerHTML=xh(a)}function xh(t){const e=t.length||1;let i="";for(let n=2;n>=0;n--){i+="<tr>";for(let o=0;o<=3;o++)i+=`<td class="${k}table-element">${qp(t,o,n)}</td>`;i+=`<td class="${k}table-element ${k}table--no-border">${M(Xp(t,n)/e*100,1)}%</td>
        </tr>`}return i+=`<tr><td class="${k}table-element ${k}table--no-border">${M(mn(t,0)/e*100,1)}%</td><td class="${k}table-element ${k}table--no-border">${M(mn(t,1)/e*100,1)}%</td><td class="${k}table-element ${k}table--no-border">${M(mn(t,2)/e*100,1)}%</td><td class="${k}table-element ${k}table--no-border">${M(mn(t,3)/e*100,1)}%</td></tr>`,i}function Bg(t,e){var r;const i=qi.create(`${k}table-select-placement-${e.settings.characteristic}-${e.settings.difficulty}`,"Note Placement: ","caption",`${k}table-caption`,{text:"All",value:"all"},{text:"Note Only",value:"note"},{text:"Red Note",value:"red"},{text:"Blue Note",value:"blue"},{text:"Arc Only",value:"arc"},{text:"Red Arc",value:"redArc"},{text:"Blue Arc",value:"blueArc"},{text:"Chain Only",value:"chain"},{text:"Red Chain",value:"redChain"},{text:"Blue Chain",value:"blueChain"},{text:"Bomb",value:"bomb"});(r=i.querySelector("select"))==null||r.addEventListener("change",Lg);let n=`<tbody id="${k}table-placement-${e.settings.characteristic}-${e.settings.difficulty}">${xh(e.noteContainer.map(a=>a.data))}</tbody>`;const o=document.createElement("table");return o.className=k+"table",o.innerHTML=n,o.prepend(i),o}function xg(t,e){const i=e.stats.obstacles;let n=`<caption class="${k}table-caption">Obstacles: ${i.total}</caption>`;i.interactive&&(n+=`<tr><th class="${k}table-header" colspan="2">Interactive</th><td class="${k}table-element">${i.interactive}</td></tr>`),i.chroma&&(n+=`<tr><th class="${k}table-header" colspan="2">Chroma</th><td class="${k}table-element">${i.chroma}</td></tr>`),i.noodleExtensions&&(n+=`<tr><th class="${k}table-header" colspan="2">Noodle Extensions</th><td class="${k}table-element">${i.noodleExtensions}</td></tr>`),i.mappingExtensions&&(n+=`<tr><th class="${k}table-header" colspan="2">Mapping Extensions</th><td class="${k}table-element">${i.mappingExtensions}</td></tr>`);const o=document.createElement("table");return o.className=k+"table",o.innerHTML=n,o}const fi=document.querySelector(".stats__content");function Og(){var l;if(!mt.beatmapInfo)throw new Error($n+"map info could not be found in loadedData");const t=mt.beatmapInfo,e={};for(const c of t.difficulties)e[l=c.characteristic]||(e[l]=[]),e[c.characteristic].push(c);const i=Zi(),n=Ji(),o=mt.beatmaps.find(c=>c.settings.characteristic===i&&c.settings.difficulty===n);if(!o)throw new Error($n+"Could not find map data");const r=no.create("small","half"),a=no.create("small","half"),s=no.create("small","half");fi.innerHTML="",r.append(yg(t,o)),r.append(document.createElement("br")),r.append(_g(t,o)),r.append(document.createElement("br")),r.append(Eg(t,o)),a.append(Rg(t,o)),a.append(document.createElement("br")),a.append(kg(t,o)),a.append(document.createElement("br")),a.append(Bg(t,o)),a.append(document.createElement("br")),a.append(wg(t,o)),s.append(Sg(t,o)),s.append(document.createElement("br")),s.append(Tg(t,o)),s.append(document.createElement("br")),s.append(xg(t,o)),fi.appendChild(r),fi.appendChild(a),fi.appendChild(s)}function Ng(){for(;fi.firstChild;)fi.removeChild(fi.firstChild)}Un.push(Og);const Ig=document.querySelectorAll(".input__reset-button");Ig.forEach(t=>t.addEventListener("click",Ag));function Ag(){Ct.reset(),At.reset(),ud(),Ui.reset(),Ng(),hh.reset(),mt.clear()}const Pg="2.7.0",$g="Kival Evan",ou=new class{constructor(){this._version=Pg+"-beta-c",this._wm=$g}get value(){return this._version}get watermark(){return this._wm}},Mg=document.querySelectorAll(".link__watermark"),Fg=document.querySelectorAll(".link__version");function ru(){const t=new Date;return t.getMonth()==5&&t.getDate()==10}const su={setWatermark:t=>{Mg.forEach(e=>{e.textContent=(ru()?"Happy Birthday, ":"")+t,ru()&&(e.title=`Happy ${new Date().getFullYear()-new Date("1999-06-10").getFullYear()} Birthday, 10th June`)})},setVersion:t=>{Fg.forEach(e=>e.textContent=t)}},jg=function(){let t=!1;return function(){if(!t){t=!0,su.setWatermark(ou.watermark),su.setVersion(ou.value),Ui.populateTool(),Ue.setTheme(it.theme),Ue.setBeatNumbering(it.beatNumbering),Ue.setRounding(it.rounding),Ue.setInfoRow(it.infoRowCount),Ue.setDataCheck(it.dataCheck);for(const e in it.load)Ue.setLoadCheck(e,it.load[e]);Ue.setSortCheck(it.sorting),cb(it.show),Ue.setShowCheck(it.show),$o.set(it.theme),J.tInfo(["init"],"User interface initialised")}}}();(async function(){jg();const t=new URL(location.href),e=t.searchParams.get("url"),i=t.searchParams.get("id"),n=t.searchParams.get("hash");(i||e||n)&&await je({link:e,id:i,hash:n})})();
