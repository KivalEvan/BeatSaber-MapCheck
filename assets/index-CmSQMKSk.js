var Yr=(i,t,e)=>{if(!t.has(i))throw TypeError("Cannot "+e)};var ri=(i,t,e)=>(Yr(i,t,"read from private field"),e?e.call(i):t.get(i)),Js=(i,t,e)=>{if(t.has(i))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(i):t.set(i,e)},us=(i,t,e,o)=>(Yr(i,t,"write to private field"),o?o.call(i,e):t.set(i,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function e(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(s){if(s.ep)return;s.ep=!0;const n=e(s);fetch(s.href,n)}})();var Hu=(i=>(i.none="",i.ExpertPlus="accordion__label--bg-expertplus",i.Expert="accordion__label--bg-expert",i.Hard="accordion__label--bg-hard",i.Normal="accordion__label--bg-normal",i.Easy="accordion__label--bg-easy",i))(Hu||{});const Ws="accordion__",hf=document.querySelectorAll(".accordion__button"),Yu={create:function(i,t,e,o=!1){const s=document.createElement("div");s.className="accordion";const n=document.createElement("input");n.className=Ws+"button",n.id=i,n.setAttribute("type","checkbox");const r=document.createElement("label");r.className=Ws+"label unselectable",r.htmlFor=i,r.textContent=t,e&&r.classList.add(Hu[e]);const a=document.createElement("div");return a.className=o?Ws+"collapsible-flex":Ws+"collapsible",a.id=i+"-content",s.appendChild(n),s.appendChild(r),s.appendChild(a),s},show:function(i,t){hf.forEach(e=>{e.id.endsWith(i)&&(e.checked=t)})}};function ff(i){return i.toString().split(".").map((t,e)=>e?t:t.replace(/\B(?=(\d{3})+(?!\d))/g,",")).join(".")}mf(Math.random());function mf(i){i=i.toString();let t=0;for(let e=0;e<i.length;e++)t=(t<<5)-t+i.charCodeAt(e),t|=0;return t}function M(i,t=0){const e=Math.pow(10,t);return Math.round(i*e)/e}function rr(i){return i*(180/Math.PI)}function Fo(i){return i*(Math.PI/180)}function cn(i,t){t<0&&(t=-t);const e=i%t;return e<0?e+t:e}function Vr(i,t,e){return Math.min(cn(i-t,e),cn(t-i,e))}function Zn(i){if(!i.length)return 0;const t=i.map(o=>o).sort((o,s)=>o-s),e=Math.floor(t.length/2);return t.length%2?t[e]:(t[e-1]+t[e])/2}function ar(i,t,e){return Math.min(Math.max(t,i),e)}function zr(i,t,e,o){return o||(o=s=>s),t+(e-t)*o(i)}function xt(i){return i==null||typeof i!="object"?i:Array.isArray(i)?[...i]:{...i}}function C(i){if(i==null||typeof i!="object")return i;const t=Array.isArray(i)?Array(i.length):{};for(const e in i)t[e]=C(i[e]);return t}function Dr(i){return/^[a-fA-F0-9]+$/g.test(i)}function Hi(i){return parseInt(i,16)}function Xs(i,t,e,o){Array.isArray(i)&&(o=i[3],e=i[2],t=i[1],i=i[0]),i=i,t=t,e=e;let s=0;const n=Math.max(i,t,e),r=Math.min(i,t,e),a=n-r,l=n===0?0:a/n,f=n;switch(n){case r:break;case i:s=t-e+a*(t<e?6:0),s/=6*a;break;case t:s=e-i+a*2,s/=6*a;break;case e:s=i-t+a*4,s/=6*a;break}const h=[s*360,l,f];return typeof o=="number"&&h.push(o),h}function pf(i,t,e,o){Array.isArray(i)&&(o=i[3],e=i[2],t=i[1],i=i[0]),i=i/360,t=t,e=e,i<0&&(i+=Math.abs(Math.floor(i)));let s=0,n=0,r=0;const a=Math.floor(i*6),l=i*6-a,f=e*(1-t),h=e*(1-l*t),p=e*(1-(1-l)*t);switch(a%6){case 0:s=e,n=p,r=f;break;case 1:s=h,n=e,r=f;break;case 2:s=f,n=e,r=p;break;case 3:s=f,n=h,r=e;break;case 4:s=p,n=f,r=e;break;case 5:s=e,n=f,r=h;break}const c=[s,n,r];return typeof o=="number"&&c.push(o),c}function Hs(i){const t=i.toString(16);return t.length===1?"0"+t:t}function df(i){return Math.round(i*255)}function ki(i){return i/255}function Kt(i,t){if(Array.isArray(i)){const o={r:i[0],g:i[1],b:i[2]};return typeof i[3]=="number"&&(o.a=i[3]),t&&(o.a??(o.a=1)),o}if(typeof i=="string"||"type"in i)return Kt(ei(i),t);const e={r:i.r,g:i.g,b:i.b};return typeof i.a=="number"&&(e.a=i.a),t&&(e.a??(e.a=1)),e}function pt(i){const t=Kt(i);let e=1;for(const o in t)e=Math.max(Math.abs(t[o]),e);for(const o in t)t[o]=df(t[o]/e);return`#${Hs(t.r)}${Hs(t.g)}${Hs(t.b)}${typeof t.a=="number"?Hs(t.a):""}`}function ie(i){if(i=i.trim(),i.startsWith("#")&&(i=i.substring(1)),!Dr(i))throw new Error("Not valid hexadecimal");let t=[0,0,0];if(i.length===3||i.length===4)t=[ki(Hi(i.slice(0,1)+i.slice(0,1))),ki(Hi(i.slice(1,2)+i.slice(1,2))),ki(Hi(i.slice(2,3)+i.slice(2,3)))],i.length===4&&t.push(ki(Hi(i.slice(3,4)+i.slice(3,4))));else if(i.length===6||i.length===8)t=[ki(Hi(i.slice(0,2))),ki(Hi(i.slice(2,4))),ki(Hi(i.slice(4,6)))],i.length===8&&t.push(ki(Hi(i.slice(6,8))));else throw new Error("Not valid colour hexadecimal");return t}function Go(i,t="rgba",e="rgba"){if(typeof i=="string"){const o=ie(i);return e==="hsva"?Xs(o):o}else if(Array.isArray(i)){if(t==="hsva")return e==="hsva"?[...i]:pf(i);const o=t==="rgba255"?i.map(s=>ki(s)):[...i];return e==="hsva"?Xs(o):o}else if("type"in i){let o;switch(i.type){case"hsva":o=ei(i.value,"hsva");break;case"rgba":o=ei(i.value,"rgba");break;case"rgba255":o=ei(i.value,"rgba255")}return e==="hsva"?Xs(o):o}else{const o=[i.r,i.g,i.b];return typeof i.a=="number"&&o.push(i.a),e==="hsva"?Xs(o):o}}function Ur(i){let t=i[0],e=i[1],o=i[2],s,n,r;t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,o=o>.04045?Math.pow((o+.055)/1.055,2.4):o/12.92,s=(t*.4124+e*.3576+o*.1805)/.95047,n=(t*.2126+e*.7152+o*.0722)/1,r=(t*.0193+e*.1192+o*.9505)/1.08883,s=s>.008856?Math.pow(s,1/3):7.787*s+16/116,n=n>.008856?Math.pow(n,1/3):7.787*n+16/116,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116;const a=[116*n-16,500*(s-n),200*(n-r)];return typeof i[3]=="number"&&a.push(i[3]),a}function qr(i,t){let e=0;return i>=0&&t===0?0:i<0&&t===0?180:i===0&&t>0?90:i===0&&t<0?270:(i>0&&t>0&&(e=0),i<0&&(e=180),i>0&&t<0&&(e=360),rr(Math.atan(t/i))+e)}function lr(i,t){const[e,o,s]=Ur(i),[n,r,a]=Ur(t),l=1,f=1,h=1;let p,c,u,b,d,v,y,E,S,x,N,F,$,X,O,V,it,_,P,g;return p=Math.sqrt(o*o+s*s),c=Math.sqrt(r*r+a*a),u=(p+c)/2,d=.5*(1-Math.sqrt((u^7)/((u^7)+30))),S=(1+d)*o,p=Math.sqrt(S*S+s*s),v=qr(S,s),S=(1+d)*r,c=Math.sqrt(S*S+a*a),y=qr(S,a),_=n-e,P=c-p,p*c==0?g=0:(S=M(y-v,12),Math.abs(S)<=180?g=y-v:S>180?g=y-v-360:g=y-v+360),g=2*Math.sqrt(p*c)*Math.sin(Fo(g/2)),x=(e+n)/2,b=(p+c)/2,p*c==0?E=v+y:(S=Math.abs(M(v-y,12)),S>180?y+v<360?E=v+y+360:E=v+y-360:E=v+y,E/=2),N=1-.17*Math.cos(Fo(E-30))+.24*Math.cos(Fo(2*E))+.32*Math.cos(Fo(3*E+6))-.2*Math.cos(Fo(4*E-63)),O=30*Math.exp(-((E-275)/25)*((E-275)/25)),V=2*Math.sqrt((b^7)/((b^7)+30)),F=1+.015*((x-50)*(x-50))/Math.sqrt(20+(x-50)*(x-50)),$=1+.045*b,X=1+.015*b*N,it=-Math.sin(Fo(2*O))*V,_=_/(l*F),P=P/(f*$),g=g/(h*X),Math.sqrt(_*_+P*P+g*g+it*P*g)}function ei(){const i=arguments;if(typeof i[0]=="number"&&typeof i[1]=="number"&&typeof i[2]=="number"){let t=[i[0],i[1],i[2]];return typeof i[3]=="number"&&t.push(i[3]),typeof i[3]=="string"&&(i[3]==="hsva"&&(t=Go(t,"hsva")),i[3]==="rgba255"&&(t=Go(t,"rgba255"))),typeof i[4]=="string"&&(i[4]==="hsva"&&(t=Go(t,"hsva")),i[4]==="rgba255"&&(t=Go(t,"rgba255"))),t}if(typeof i[0]=="number")return typeof i[1]=="boolean"&&i[1]?[i[0]/255,i[0]/255,i[0]/255]:typeof i[1]=="number"?[i[0],i[0],i[0],i[1]]:[i[0],i[0],i[0]];if(typeof i[0]=="string")return ie(i[0]);if(Array.isArray(i[0])){const t=i[0];let e=[t[0],t[1],t[2]];if(!e.every(o=>typeof o=="number"))throw new Error("Unable to parse color; array contain undefined or non-numeric value");return typeof t[3]=="number"&&e.push(t[3]),typeof i[1]=="string"&&(i[1]==="hsva"&&(e=Go(e,"hsva")),i[1]==="rgba255"&&(e=Go(e,"rgba255"))),e}if(typeof i[0]=="object"){const t=i[0];if("type"in t)switch(t.type){case"hsva":return ei(t.value,"hsva");case"rgba":return ei(t.value,"rgba");case"rgba255":return ei(t.value,"rgba255")}if("r"in t&&"g"in t&&"b"in t){const e=[t.r,t.g,t.b];if(!e.every(o=>typeof o=="number"))throw new Error("Unable to parse color; array contain undefined or non-numeric value");return typeof t.a=="number"&&e.push(t.a),e}}throw new Error("Unable to parse color; input is invalid")}function Xe(i){if(!i)return"0:00";const t=Math.floor(i),e=t/60,o=e<0?`-${Math.ceil(e).toString()}`:Math.floor(e).toString(),s=Math.abs(t%60).toString().padStart(2,"0");return`${o}:${s}`}function bf(i){if(!i)return"0:00:00";const t=Math.abs(Math.round(i*60%60)).toString().padStart(2,"0");return`${Xe(i>0?Math.floor(i):Math.ceil(i))}:${t}`}function on(i){var e;if(!i)return"0:00.000";const t=((e=(i%1).toString().split(".")[1])==null?void 0:e.padEnd(3,"0").slice(0,3))||"000";return`${Xe(i>0?Math.floor(i):Math.ceil(i))}.${t}`}function ne(i){return Array.isArray(i)&&i.length===3&&i.every(t=>typeof t=="number")}function Vu(i){const t=/^(http|ftp|https):\/\/([\w_-]+(?:(?:\.[\w_-]+)+))([\w.,@?^=%&:/~+#-]*[\w@?^=%&/~+#-])?/;if(i=i.trim(),/^http:\/\//.test(i)&&(i=i.replace("http://","https://")),t.test(i))return i;throw new Error("Invalid URL")}function zu(i){const t=/^[0-9a-fA-F]{1,6}$/;if(i=i.trim(),/^!bsr /.test(i)&&(i=i.replace("!bsr ","")),t.test(i))return i;throw new Error("Invalid ID")}function ur(i){for(let t=i.options.length-1;t>=0;t--)i.remove(t)}const Kr=document.querySelector(".intro"),Zr=document.querySelector(".metadata"),jo=document.querySelector(".cover__link"),Uu=document.querySelector(".cover__image"),gf=document.querySelector(".metadata__song-name"),vf=document.querySelector(".metadata__song-subname"),yf=document.querySelector(".metadata__song-author"),_f=document.querySelector(".metadata__song-bpm"),Qn=document.querySelector(".metadata__song-duration"),qu=document.querySelector(".audio");function Ku(i){i?(Kr.classList.remove("hidden"),Zr.classList.add("hidden")):(Kr.classList.add("hidden"),Zr.classList.remove("hidden"))}function Zu(i){Uu.src=i||"./img/unknown.jpg"}function Df(){return Uu.src}function Qu(i,t){if(i==null&&t==null){jo.textContent="",jo.href="",jo.classList.add("disabled");return}i!=null&&(jo.textContent=t??"Download Link",jo.href=i,jo.classList.remove("disabled"))}function Ef(i){gf.textContent=i}function wf(i){vf.textContent=i}function Sf(i){yf.textContent=i}function Cf(i,t,e){t==null&&typeof e=="number"&&(t=Math.min(i,e)),e==null&&typeof t=="number"&&(e=Math.max(i,t));let o=M(i,2).toString()+"BPM";t&&e&&(o+=` (${M(t,2)}-${M(e,2)})`),_f.textContent=o}function tc(i){typeof i=="number"?Qn.textContent=on(i):typeof i=="string"?Qn.textContent=i:Qn.textContent="No audio"}async function xf(i){const t=new Blob([i],{type:"audio/ogg"});qu.src=window.URL.createObjectURL(t)}function ec(){qu.src="",window.URL.revokeObjectURL("")}function Tf(){Ku(!0),Zu(null),Qu(),tc(0),ec()}const fe={switchHeader:Ku,setCoverImage:Zu,getCoverImage:Df,setCoverLink:Qu,setSongName:Ef,setSongSubname:wf,setSongAuthor:Sf,setSongBPM:Cf,setSongDuration:tc,setAudio:xf,unloadAudio:ec,reset:Tf},co=new class{constructor(){this.loading={info:!1,difficulty:!1,analysis:!1,audio:!1,coverImage:!1,contributorImage:!1,finished:!1}}resetLoad(){this.loading.info=!1,this.loading.difficulty=!1,this.loading.analysis=!1,this.loading.audio=!1,this.loading.coverImage=!1,this.loading.contributorImage=!1,this.loading.finished=!1}},lt=new class{constructor(){this.beatmapInfo=null,this.beatmapDifficulty=[],this.contributors=[],this.analysis=null,this.duration=null}retrieveSafe(){if(!this.beatmapInfo)throw new Error("Beatmap info is not loaded.");if(!this.analysis)throw new Error("Beatmap analysis is not loaded.");if(this.duration===null)throw new Error("Audio is not loaded.");if(co.loading.finished)return{beatmapInfo:this.beatmapInfo,beatmapDifficulty:this.beatmapDifficulty,contributors:this.contributors,analysis:this.analysis,duration:this.duration};throw new Error("Could not retrieve saved data, loading process is not finished.")}clear(){co.loading.finished=!1,this.beatmapInfo=null,this.beatmapDifficulty=[],this.contributors=[],this.analysis=null,this.duration=null}};var ic=(i=>(i[i.VERBOSE=0]="VERBOSE",i[i.DEBUG=1]="DEBUG",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.NONE=5]="NONE",i))(ic||{}),Bo,Rs,di;const Co=class Co{constructor(){Js(this,Bo,2);Js(this,Rs,(t,e)=>`${Co.LogPrefixes.get(e)} > [${t.join("::")}]`);Js(this,di,"script")}set logLevel(t){us(this,Bo,t),this.tInfo(["logger","logLevel"],`Log level set to ${Co.LogPrefixes.get(t)}`)}get logLevel(){return ri(this,Bo)}set tagPrint(t){us(this,Rs,t),this.tInfo(["logger","tagPrint"],"Update tag print function")}get tagPrint(){return ri(this,Rs)}set untagged(t){us(this,di,t.trim()),this.tInfo(["logger","untagged"],`Update untagged string to ${ri(this,di)}`)}get untagged(){return ri(this,di)}log(t,e,...o){if(t<ri(this,Bo))return;const s=[this.tagPrint(e,t),...o];switch(t){case 1:return console.debug(...s);case 2:return console.info(...s);case 3:return console.warn(...s);case 4:return console.error(...s);default:return console.log(...s)}}setLevel(t){t=Math.min(Math.max(t,0),5),us(this,Bo,t),this.tInfo(["logger","setLevel"],`Log level set to ${Co.LogPrefixes.get(t)}`)}tVerbose(t,...e){this.log(0,t,...e)}tDebug(t,...e){this.log(1,t,...e)}tInfo(t,...e){this.log(2,t,...e)}tWarn(t,...e){this.log(3,t,...e)}tError(t,...e){this.log(4,t,...e)}verbose(...t){this.tVerbose([ri(this,di)],...t)}debug(...t){this.tDebug([ri(this,di)],...t)}info(...t){this.tInfo([ri(this,di)],...t)}warn(...t){this.tWarn([ri(this,di)],...t)}error(...t){this.tError([ri(this,di)],...t)}};Bo=new WeakMap,Rs=new WeakMap,di=new WeakMap,Co.LogLevels=ic,Co.LogPrefixes=new Map([[0,"VERBOSE"],[1,"DEBUG"],[2,"INFO"],[3,"WARN"],[4,"!!ERROR!!"],[5,"NONE"]]);let cr=Co;const W=new cr;function Lf(i){return["beatmap","shared","bpm",i]}const Gn=class Gn{constructor(t,e=[],o=0){this._bpm=t,this._offset=o/1e3,this._timeScale=this.getTimeScale(e.filter(s=>("m"in s||"bpm"in s||"timescale"in s)&&!("o"in s))),this._bpmChange=this.getBpmChangeTime(e.filter(s=>"BPM"in s&&"metronomeOffset"in s||("_bpm"in s||"_BPM"in s)&&"_metronomeOffset"in s||"m"in s&&"o"in s)),this._timeScale.length&&this._bpmChange.length&&W.tWarn(Lf("constructor"),"BPM change and BPM event should not be used along side together to avoid confusion between editors and in-game behaviour")}get value(){return this._bpm}set value(t){this._bpm=t}get change(){return this._bpmChange}set change(t){this._bpmChange=this.getBpmChangeTime(t)}get timescale(){return this._timeScale}set timescale(t){this._timeScale=this.getTimeScale(t)}get offset(){return this._offset*1e3}set offset(t){this._offset=t/1e3}getBpmChangeTime(t=[]){let e;const o=[];t=[...t].sort((s,n)=>(s.time??s._time??s.b)-(n.time??n._time??n.b));for(let s=0;s<t.length;s++){const n={time:t[s].time??t[s]._time??t[s].b,BPM:t[s].BPM??t[s]._BPM??t[s]._bpm??t[s].m,beatsPerBar:t[s].beatsPerBar??t[s]._beatsPerBar??t[s].p,metronomeOffset:t[s].metronomeOffset??t[s]._metronomeOffset??t[s].o,newTime:0};e?n.newTime=Math.ceil((n.time-e.time)/this._bpm*e.BPM+e.newTime-.01):n.newTime=Math.ceil(n.time-this._offset*this._bpm/60-.01),o.push(n),e=n}return o}getTimeScale(t=[]){return[...t].sort((e,o)=>(e.time??e.b)-(o.time??o.b)).map(e=>"scale"in e?e:"bpm"in e?{time:e.time,scale:this._bpm/e.bpm}:{time:e.b||0,scale:this._bpm/e.m})}offsetBegone(t){return this.toBeatTime(this.toRealTime(t,!1)-this._offset)}toRealTime(t,e=!0){if(!e)return t/this._bpm*60;let o=0;for(let s=this._timeScale.length-1;s>=0;s--)t>this._timeScale[s].time&&(o+=(t-this._timeScale[s].time)*this._timeScale[s].scale,t=this._timeScale[s].time);return(t+o)/this._bpm*60}toBeatTime(t,e=!1){if(!e)return t*this._bpm/60;let o=0;for(let s=this._timeScale.length-1;s>=0;s--){const n=this.toRealTime(this._timeScale[s].time);t>n&&(o+=(t-n)/this._timeScale[s].scale,t=n)}return this.toBeatTime(t+o)}toJsonTime(t){for(let e=this._bpmChange.length-1;e>=0;e--)if(t>this._bpmChange[e].newTime)return(t-this._bpmChange[e].newTime)/this._bpmChange[e].BPM*this._bpm+this._bpmChange[e].time;return this.toBeatTime(this.toRealTime(t,!1)+this._offset)}adjustTime(t){for(let e=this._bpmChange.length-1;e>=0;e--)if(t>this._bpmChange[e].time)return(t-this._bpmChange[e].time)/this._bpm*this._bpmChange[e].BPM+this._bpmChange[e].newTime;return this.offsetBegone(t)}};Gn.create=(t,e,o)=>new Gn(t,e,o);let Gi=Gn;const hr={DefaultEnvironment:"The First",OriginsEnvironment:"Origins",TriangleEnvironment:"Triangle",NiceEnvironment:"Nice",BigMirrorEnvironment:"Big Mirror",DragonsEnvironment:"Dragons",KDAEnvironment:"K/DA",MonstercatEnvironment:"Monstercat",CrabRaveEnvironment:"Crab Rave",PanicEnvironment:"Panic",RocketEnvironment:"Rocket",GreenDayEnvironment:"Green Day",GreenDayGrenadeEnvironment:"Green Day Grenade",TimbalandEnvironment:"Timbaland",FitBeatEnvironment:"FitBeat",LinkinParkEnvironment:"Linkin Park",BTSEnvironment:"BTS",KaleidoscopeEnvironment:"Kaleidoscope",InterscopeEnvironment:"Interscope",SkrillexEnvironment:"Skrillex",BillieEnvironment:"Billie",HalloweenEnvironment:"Spooky",GagaEnvironment:"Gaga",WeaveEnvironment:"Weave",PyroEnvironment:"Pyro",EDMEnvironment:"EDM",TheSecondEnvironment:"The Second",LizzoEnvironment:"Lizzo",TheWeekndEnvironment:"The Weeknd",RockMixtapeEnvironment:"Rock Mixtape",Dragons2Environment:"Dragons 2.0",Panic2Environment:"Panic 2.0",QueenEnvironment:"Queen",LinkinPark2Environment:"Linkin Park 2.0",TheRollingStonesEnvironment:"The Rolling Stones",LatticeEnvironment:"Lattice",DaftPunkEnvironment:"Daft Punk",HipHopEnvironment:"Hip Hop Mixtape",GlassDesertEnvironment:"Glass Desert",MultiplayerEnvironment:"Origins"},Io={DefaultEnvironment:[[0,1,2,3,4,8,9,12,13],[]],OriginsEnvironment:[[0,1,2,3,4,8,9,12,13],[]],TriangleEnvironment:[[0,1,2,3,4,8,9,12,13],[]],NiceEnvironment:[[0,1,2,3,4,8,9,12,13],[]],BigMirrorEnvironment:[[0,1,2,3,4,8,9,12,13],[]],DragonsEnvironment:[[0,1,2,3,4,8,9,12,13],[]],KDAEnvironment:[[0,1,2,3,4,8,9,12,13],[]],MonstercatEnvironment:[[0,1,2,3,4,8,9,12,13],[]],CrabRaveEnvironment:[[0,1,2,3,4,8,9,12,13],[]],PanicEnvironment:[[0,1,2,3,4,8,9,12,13],[]],RocketEnvironment:[[0,1,2,3,4,8,9,12,13],[]],GreenDayEnvironment:[[0,1,2,3,4,8,9,12,13],[]],GreenDayGrenadeEnvironment:[[0,1,2,3,4,8,9,12,13],[]],TimbalandEnvironment:[[0,1,2,3,4,8,9,12,13],[]],FitBeatEnvironment:[[0,1,2,3,4,8,9,12,13],[]],LinkinParkEnvironment:[[0,1,2,3,4,8,9,12,13],[]],BTSEnvironment:[[0,1,2,3,4,8,9,12,13],[]],KaleidoscopeEnvironment:[[0,1,2,3,4,8,9,12,13],[]],InterscopeEnvironment:[[0,1,2,3,4,6,7,8,9,12,13,16,17],[]],SkrillexEnvironment:[[0,1,2,3,4,6,7,8,9,12,13],[]],BillieEnvironment:[[0,1,2,3,4,6,7,8,9,10,11,12,13],[]],HalloweenEnvironment:[[0,1,2,3,4,8,9,12,13],[]],GagaEnvironment:[[0,1,2,3,4,6,7,8,9,10,11,12,13,16,17],[]],GlassDesertEnvironment:[[0,1,2,3,4,8,9,12,13],[]],MultiplayerEnvironment:[[4],[]],WeaveEnvironment:[[],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]],PyroEnvironment:[[0,1,2,3,4,6,40],[0,1,2,3,4,5,6,7,8,9,10,11,12,13]],EDMEnvironment:[[0,1,4],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]],TheSecondEnvironment:[[0,1,2,3,4,9],[0,1,2,3,4,5,6,7,8,9,10,11,12,13]],LizzoEnvironment:[[0,1,2,3,4,6,7,8,9,10,11,12,16,17],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]],TheWeekndEnvironment:[[0,1,6],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,29,30,31,32,33,34,35,36,37,38,40]],RockMixtapeEnvironment:[[3,4,6],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37]],Dragons2Environment:[[0,1,2,3,4,6],[0,1,2,3,4,5,6,7,8,9,10,11,12]],Panic2Environment:[[3],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]],QueenEnvironment:[[6,40],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]],LinkinPark2Environment:[[3,40,41],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]],TheRollingStonesEnvironment:[[6,40],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45]],LatticeEnvironment:[[6],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30]],DaftPunkEnvironment:[[6,40,41,42,43],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55]],HipHopEnvironment:[[6],[0,1,2,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41]]},tr=document.querySelector(".info__level-author"),Qr=document.querySelector(".info__environment"),er=document.querySelector(".info__editors"),ta=document.querySelector(".info__contributors"),fr=document.querySelector(".info__contributors-select"),Nf=document.querySelector(".info__contributors-image"),Bf=document.querySelector(".info__contributors-name"),kf=document.querySelector(".info__contributors-role");fr.addEventListener("change",If);function oc(i,t){if(!i){tr.textContent="";return}t!=null&&t.length?tr.textContent="Mapped by "+i.join(", ")+" and lit by "+t.join(", "):tr.textContent="Mapped by "+i.join(", ")}function sc(i){if(!i){Qr.textContent="";return}Qr.textContent=i.map(t=>(hr[t]||`Unknown (${t})`)+" Environment").join(", ")}function nc(i){if(!i||!i._lastEditedBy){er.classList.add("hidden");return}er.classList.remove("hidden");const t=i._lastEditedBy||"Undefined";let e="Last edited on "+t;if(i[t]){const o=i[t];e+=" v"+o.version}er.textContent=e}function Rf(i){Nf.src=i||"./img/unknown.jpg"}function Of(i){Bf.textContent=i}function Af(i){kf.textContent=i}function rc(i){Rf(i._base64?"data:image;base64,"+i._base64:null),Of(i._name),Af(i._role)}function ac(i){if(!i||!i.length){ta.classList.add("hidden"),ur(fr);return}ta.classList.remove("hidden");let t=!0;i.forEach((e,o)=>{t&&(t=!1,rc(e));const s=document.createElement("option");s.value=o.toString(),s.text=e._name+" -- "+e._role,fr.add(s)})}function If(i){const t=i.target;rc(lt.contributors[parseInt(t.value)])}const cs={version:4,load:{audio:!0,imageCover:!0,imageContributor:!0},sorting:!0,beatNumbering:"beattime",infoRowHeight:4,rounding:3,dataCheck:!0,dataError:!0,theme:"Dark",onLoad:{stats:!1},show:{info:!1,tools:!1,stats:!1,settings:!1},aprilFooled:!1},et=new class{constructor(){this.property=C(cs),this.stringify=()=>JSON.stringify({settings:this.property}),this.init=()=>{var e;if(localStorage==null)return;const t=localStorage.getItem("settings");if(t){const o=JSON.parse(t);if(!((e=o.settings)!=null&&e.version)){this.clear();return}this.property=o.settings??this.property;for(const s in cs)typeof this.property[s]>"u"&&(this.property[s]=cs[s]);this.property.version=cs.version,this.save()}},this.save=()=>{localStorage&&localStorage.setItem("settings",this.stringify())},this.clear=()=>{localStorage&&localStorage.clear()},this.reset=()=>{this.property=C(cs)},this.init()}get version(){return this.property.version}get load(){return this.property.load}get sorting(){return this.property.sorting}set sorting(t){this.property.sorting=t}get beatNumbering(){return this.property.beatNumbering}set beatNumbering(t){this.property.beatNumbering=t}get infoRowHeight(){return this.property.infoRowHeight}set infoRowHeight(t){this.property.infoRowHeight=t}get rounding(){return this.property.rounding}set rounding(t){this.property.rounding=t}get dataCheck(){return this.property.dataCheck}set dataCheck(t){this.property.dataCheck=t}get dataError(){return this.property.dataError}set dataError(t){this.property.dataError=t}get theme(){return this.property.theme}set theme(t){this.property.theme=t}get onLoad(){return this.property.onLoad}get show(){return this.property.show}get aprilFooled(){return this.property.aprilFooled}set aprilFooled(t){this.property.aprilFooled=t}};var lc=(i=>(i.tiny="panel--tiny",i.small="panel--small",i.medium="panel--medium",i.large="panel--large",i.max="panel--max",i))(lc||{}),uc=(i=>(i.normal="panel--offset",i.half="panel--offset-half",i.none="",i))(uc||{});const Qo={create:(i,t,e,o)=>{const s=document.createElement("div");return s.className=`panel ${lc[i]}`,t&&t!=="none"&&s.classList.add(uc[t]),e&&s.classList.add("panel--flex"+o?"-column":""),s}},ea=document.querySelector(".info__version"),ia=document.querySelector(".info__mappers"),oa=document.querySelector(".info__lighters"),sa=document.querySelector(".info__environmentId"),na=document.querySelector(".info__play-time"),ra=document.querySelector(".info__time-spend"),aa=document.querySelector(".info__color-scheme"),la=document.querySelector(".info__custom-color"),ua=document.querySelector(".info__requirements"),ca=document.querySelector(".info__suggestions"),ha=document.querySelector(".info__information"),fa=document.querySelector(".info__warnings"),ma=document.querySelector(".info__bookmarks"),pa=document.querySelector(".info__bpm-changes"),da=document.querySelector(".info__environment-enhancement"),ba=document.querySelector(".info__point-definitions"),ga=document.querySelector(".info__custom-events"),Pf=document.querySelectorAll(".info__table-element");function ye(i){const t=i.querySelector(".info__table-element");t&&(t.innerHTML=""),i.classList.add("hidden")}function _e(i,t){const e=i.querySelector(".info__table-element");if(e){for(;e.firstChild;)e.removeChild(e.firstChild);typeof t=="string"?e.textContent=t:(t.forEach(o=>{if(typeof o=="string"){const s=document.createElement("span");s.textContent=o,e.appendChild(s),e.appendChild(document.createElement("br"))}else e.appendChild(o),e.appendChild(document.createElement("br"))}),e.lastChild&&e.removeChild(e.lastChild))}i.classList.remove("hidden")}function cc(i){Pf.forEach(t=>t.style.maxHeight=`${i}rem`)}function hc(i,t){if(i==null||!i.length){ye(ma);return}const e=Qo.create("max","none",!0);i.forEach((o,s)=>{let n=o.b,r;const a=document.createElement("div"),l=document.createElement("div"),f=document.createElement("div");a.appendChild(l),a.appendChild(f),l.className="info__color-dot",l.style.backgroundColor="#000000",f.className="info__color-text",typeof o.n!="string"&&(f.textContent=`Error parsing bookmarks[${s}]`,e.appendChild(a)),t&&(n=t.adjustTime(n),r=t.toRealTime(n)),l.style.backgroundColor=o.c?pt({r:o.c[0],g:o.c[1],b:o.c[2]}):"#333333",f.textContent=`${M(o.b,et.rounding)}${r?" | "+Xe(r):""} -- ${o.n!=""?o.n:"**EMPTY NAME**"}`,e.appendChild(a)}),_e(ma,[e])}function fc(i){if(!i||!i.change.length){ye(pa);return}const t=i.change.map(e=>{const o=M(e.newTime,et.rounding),s=i.toRealTime(e.time);return`${o} | ${Xe(s)} -- ${e.BPM}`});_e(pa,t)}const bi={DefaultEnvironment:"The First",OriginsEnvironment:"Origins",TriangleEnvironment:"The First",NiceEnvironment:"The First",BigMirrorEnvironment:"The First",DragonsEnvironment:"The First",KDAEnvironment:"KDA",MonstercatEnvironment:"The First",CrabRaveEnvironment:"Crab Rave",PanicEnvironment:"The First",RocketEnvironment:"Rocket",GreenDayEnvironment:"Green Day",GreenDayGrenadeEnvironment:"Green Day",TimbalandEnvironment:"Timbaland",FitBeatEnvironment:"FitBeat",LinkinParkEnvironment:"Linkin Park",BTSEnvironment:"BTS",KaleidoscopeEnvironment:"Kaleidoscope",InterscopeEnvironment:"Interscope",SkrillexEnvironment:"Skrillex",BillieEnvironment:"Billie Eilish",HalloweenEnvironment:"Spooky",GagaEnvironment:"Gaga",WeaveEnvironment:"Weave",PyroEnvironment:"Pyro",EDMEnvironment:"EDM",TheSecondEnvironment:"The Second",LizzoEnvironment:"Lizzo",TheWeekndEnvironment:"The Weeknd",RockMixtapeEnvironment:"Rock Mixtape",Dragons2Environment:"Dragons 2.0",Panic2Environment:"Panic 2.0",QueenEnvironment:"Queen",LinkinPark2Environment:"Linkin Park 2.0",TheRollingStonesEnvironment:"The Rolling Stones",LatticeEnvironment:"Lattice",DaftPunkEnvironment:"Daft Punk",HipHopEnvironment:"Hip Hop Mixtape",GlassDesertEnvironment:"Glass Desert",MultiplayerEnvironment:"Origins"},$f={_colorLeft:"Left Note Color",_colorRight:"Right Note Color",_envColorLeft:"Left Environment Color",_envColorRight:"Right Environment Color",_envColorWhite:"White Environment Color",_envColorLeftBoost:"Left Environment Boost Color",_envColorRightBoost:"Right Environment Boost Color",_envColorWhiteBoost:"White Environment Boost Color",_obstacleColor:"Obstacle Color"},Mf={saberLeftColor:"Left Note Color",saberRightColor:"Right Note Color",environment0Color:"Left Environment Color",environment1Color:"Right Environment Color",environmentWColor:"White Environment Color",environment0ColorBoost:"Left Environment Boost Color",environment1ColorBoost:"Right Environment Boost Color",environmentWColorBoost:"White Environment Boost Color",obstaclesColor:"Obstacle Color"},gi={"Default Custom":{_colorLeft:{r:.7529412,g:.1882353,b:.1882353},_colorRight:{r:.1254902,g:.3921569,b:.6588235},_envColorLeft:{r:.7529412,g:.1882353,b:.1882353},_envColorRight:{r:.1882353,g:.5960785,b:1},_obstacleColor:{r:1,g:.1882353,b:.1882353}},"The First":{_colorLeft:{r:.7843137,g:.07843138,b:.07843138},_colorRight:{r:.1568627,g:.5568627,b:.8235294},_envColorLeft:{r:.85,g:.08499997,b:.08499997},_envColorRight:{r:.1882353,g:.675294,b:1},_obstacleColor:{r:1,g:.1882353,b:.1882353}},Origins:{_colorLeft:{r:.6792453,g:.5712628,b:0},_colorRight:{r:.7075472,g:0,b:.5364411},_envColorLeft:{r:.4910995,g:.6862745,b:.7},_envColorRight:{r:.03844783,g:.6862745,b:.9056604},_obstacleColor:{r:.06167676,g:.2869513,b:.3962264}},KDA:{_colorLeft:{r:.6588235,g:.2627451,b:.1607843},_colorRight:{r:.5019608,g:.08235294,b:.572549},_envColorLeft:{r:1,g:.3960785,b:.2431373},_envColorRight:{r:.7607844,g:.1254902,b:.8666667},_obstacleColor:{r:1,g:.3960785,b:.2431373}},"Crab Rave":{_colorLeft:{r:0,g:.7130001,b:.07806564},_colorRight:{r:.04805952,g:.5068096,b:.734},_envColorLeft:{r:.134568,g:.756,b:.1557533},_envColorRight:{r:.05647058,g:.6211764,b:.9},_obstacleColor:{r:0,g:.8117648,b:.09019608}},Noir:{_colorLeft:{r:.1792453,g:.1792453,b:.1792453},_colorRight:{r:.5943396,g:.5943396,b:.5943396},_envColorLeft:{r:.4056604,g:.4056604,b:.4056604},_envColorRight:{r:.6037736,g:.6037736,b:.6037736},_obstacleColor:{r:.2358491,g:.2358491,b:.2358491}},Rocket:{_colorLeft:{r:1,g:.4980392,b:0},_colorRight:{r:0,g:.5294118,b:1},_envColorLeft:{r:.9,g:.4866279,b:.3244186},_envColorRight:{r:.4,g:.7180724,b:1},_obstacleColor:{r:.3176471,g:.6117647,b:.7254902}},"Green Day":{_colorLeft:{r:.2588235,g:.7843138,b:.01960784},_colorRight:{r:0,g:.7137255,b:.6705883},_envColorLeft:{r:0,g:.7137255,b:.6705883},_envColorRight:{r:.2588235,g:.7843137,b:.01960784},_obstacleColor:{r:0,g:.8117648,b:.09019608}},Timbaland:{_colorLeft:{r:.5019608,g:.5019608,b:.5019608},_colorRight:{r:.1,g:.5517647,b:1},_envColorLeft:{r:.1,g:.5517647,b:1},_envColorRight:{r:.1,g:.5517647,b:1},_obstacleColor:{r:.5,g:.5,b:.5}},FitBeat:{_colorLeft:{r:.8000001,g:.6078432,b:.1568628},_colorRight:{r:.7921569,g:.1607843,b:.682353},_envColorLeft:{r:.8,g:.5594772,b:.5594772},_envColorRight:{r:.5594772,g:.5594772,b:.8},_obstacleColor:{r:.2784314,g:.2784314,b:.4}},"Linkin Park":{_colorLeft:{r:.6627451,g:.1643608,b:.1690187},_colorRight:{r:.3870196,g:.5168997,b:.5568628},_envColorLeft:{r:.7529412,g:.672753,b:.5925647},_envColorRight:{r:.6241197,g:.6890281,b:.709},_envColorLeftBoost:{r:.922,g:.5957885,b:.255394},_envColorRightBoost:{r:.282353,g:.4586275,b:.6235294},_obstacleColor:{r:.6627451,g:.1647059,b:.172549}},BTS:{_colorLeft:{r:1,g:.09019607,b:.4059771},_colorRight:{r:.8018868,g:0,b:.7517689},_envColorLeft:{r:.7843137,g:.1254902,b:.5010797},_envColorRight:{r:.6941177,g:.1254902,b:.8666667},_envColorLeftBoost:{r:.9019608,g:.5411765,b:1},_envColorRightBoost:{r:.3490196,g:.8078431,b:1},_obstacleColor:{r:.6698113,g:.1800908,b:.5528399}},Kaleidoscope:{_colorLeft:{r:.65882355,g:.1254902,b:.1254902},_colorRight:{r:.28235295,g:.28235295,b:.28235295},_envColorLeft:{r:.65882355,g:.1254902,b:.1254902},_envColorRight:{r:.47058824,g:.47058824,b:.47058824},_envColorLeftBoost:{r:.50196081,g:0,b:0},_envColorRightBoost:{r:.49244517,g:0,b:.53725493},_obstacleColor:{r:.25098041,g:.25098041,b:.25098041}},Interscope:{_colorLeft:{r:.726415,g:.62691,b:.31181},_colorRight:{r:.589571,g:.297888,b:.723},_envColorLeft:{r:.724254,g:.319804,b:.913725},_envColorRight:{r:.764706,g:.758971,b:.913725},_envColorLeftBoost:{r:.792453,g:.429686,b:.429868},_envColorRightBoost:{r:.7038,g:.715745,b:.765},_obstacleColor:{r:.588235,g:.298039,b:.721569}},Skrillex:{_colorLeft:{r:.69803923,g:.14117648,b:.36862746},_colorRight:{r:.32933334,g:.32299998,b:.38},_envColorLeft:{r:.80000001,g:.28000003,b:.58594489},_envColorRight:{r:.06525807,g:.57800001,b:.56867743},_envColorLeftBoost:{r:.81176478,g:.30588236,b:.30588236},_envColorRightBoost:{r:.27843139,g:.80000001,b:.44597632},_obstacleColor:{r:.15686275,g:.60392159,b:.60392159}},"Billie Eilish":{_colorLeft:{r:.80000001,g:.64481932,b:.43200001},_colorRight:{r:.54808509,g:.61276591,b:.63999999},_envColorLeft:{r:.81960785,g:.442,b:.184},_envColorRight:{r:.94117647,g:.70677096,b:.56470591},_obstacleColor:{r:.71325314,g:.56140977,b:.78301889},_envColorLeftBoost:{r:.80000001,g:0,b:0},_envColorRightBoost:{r:.55686277,g:.7019608,b:.77647066}},Spooky:{_colorLeft:{r:.81960785,g:.49807876,b:.27702752},_colorRight:{r:.37894738,g:.35789475,b:.40000001},_envColorLeft:{r:.90196079,g:.23009226,b:0},_envColorRight:{r:.46005884,g:.56889427,b:.92941177},_obstacleColor:{r:.81960791,g:.44313729,b:.18431373},_envColorLeftBoost:{r:.33768433,g:.63207543,b:.33690813},_envColorRightBoost:{r:.60209066,g:.3280082,b:.85849059}},Gaga:{_colorLeft:{r:.85,g:.4333333,b:.7833334},_colorRight:{r:.4705882,g:.8,b:.4078431},_envColorLeft:{r:.706,g:.649,b:.2394706},_envColorRight:{r:.894,g:.1625455,b:.7485644},_obstacleColor:{r:.9921569,g:0,b:.7719755},_envColorLeftBoost:{r:.754717,g:.3610244,b:.22071921},_envColorRightBoost:{r:0,g:.7058824,b:1}},Weave:{_colorLeft:{r:.7843137,g:.07843138,b:.07843138},_colorRight:{r:.1568627,g:.5568627,b:.8235294},_envColorLeft:{r:.85,g:.08499997,b:.08499997},_envColorRight:{r:.1882353,g:.675294,b:1},_envColorLeftBoost:{r:.8218409,g:.08627451,b:.8509804},_envColorRightBoost:{r:.5320754,g:.5320754,b:.5320754},_obstacleColor:{r:1,g:.1882353,b:.1882353}},Pyro:{_colorLeft:{r:.5764706,g:0,b:.03921569},_colorRight:{r:1,g:.6705883,b:0},_envColorLeft:{r:1,g:.1098039,b:.2039216},_envColorRight:{r:.8862745,g:.7372549,b:.2627451},_envColorLeftBoost:{r:1,g:0,b:.1764706},_envColorRightBoost:{r:.7647059,g:.7647059,b:.7647059},_obstacleColor:{r:.8490566,g:.7037643,b:.4285333}},EDM:{_colorLeft:{r:.6320754,g:.6320754,b:.6320754},_colorRight:{r:.1764706,g:.6980392,b:.8784314},_envColorLeft:{r:.08220173,g:.7169812,b:0},_envColorRight:{r:0,g:.3671638,b:.7169812},_envColorLeftBoost:{r:.735849,g:0,b:.1758632},_envColorRightBoost:{r:.4284593,g:0,b:.754717},_obstacleColor:{r:.1764706,g:.6980392,b:.8784314}},"The Second":{_colorLeft:{r:.7843137,g:.07843138,b:.07843138},_colorRight:{r:.1568627,g:.5568627,b:.8235294},_envColorLeft:{r:.85,g:.08499997,b:.08499997},_envColorRight:{r:.1882353,g:.675294,b:1},_envColorLeftBoost:{r:.8235294,g:.08627451,b:.8509804},_envColorRightBoost:{r:0,g:1,b:.6478302},_obstacleColor:{r:1,g:.1882353,b:.1882353}},Lizzo:{_colorLeft:{r:1,g:.8132076,b:.3773585},_colorRight:{r:.6705883,g:.254902,b:.8980392},_envColorLeft:{r:.8392157,g:.6470588,b:.2156863},_envColorRight:{r:.8196079,g:.2392157,b:.8784314},_envColorLeftBoost:{r:1,g:.4,b:.5529412},_envColorRightBoost:{r:.3686275,g:.7960784,b:1},_obstacleColor:{r:1,g:.5020987,b:.1882353}},"The Weeknd":{_colorLeft:{r:.5843138,g:.1294118,b:.1294118},_colorRight:{r:.2235294,g:.2901961,b:.3294118},_envColorLeft:{r:1,g:.2979701,b:.1411765},_envColorRight:{r:.1668743,g:.3753689,b:.7075472},_envColorWhite:{r:.8773585,g:.8773585,b:.8773585},_envColorLeftBoost:{r:.9568628,g:.6039216,b:.1215686},_envColorRightBoost:{r:.5254902,g:.8274511,b:.9921569},_envColorWhiteBoost:{r:.9811321,g:.9308866,b:.8608046},_obstacleColor:{r:.9176471,g:.2980392,b:.007843138}},"Rock Mixtape":{_colorLeft:{r:.6,g:.4233,b:.042},_colorRight:{r:.6006,g:.7441199,b:.78},_envColorLeft:{r:.75,g:.12,b:.162},_envColorRight:{r:.95,g:.5820333,b:.1615},_envColorLeftBoost:{r:.96,g:.1344,b:.9187202},_envColorRightBoost:{r:.378,g:.813,b:.9},_obstacleColor:{r:1,g:1,b:1}},"Dragons 2.0":{_colorLeft:{r:.7264151,g:.6587077,b:.2809719},_colorRight:{r:.2509804,g:.7647059,b:.405098},_envColorLeft:{r:.01960784,g:.9960785,b:.06666667},_envColorRight:{r:0,g:.05490196,b:1},_envColorLeftBoost:{r:.9764706,g:.03137255,b:.01960784},_envColorRightBoost:{r:1,g:.8292086,b:.2264151},_obstacleColor:{r:.5548979,g:.2470588,b:1}},"Panic 2.0":{_colorLeft:{r:.9019608,g:.3333333,b:.5686275},_colorRight:{r:.1529412,g:.5568628,b:.4862745},_envColorLeft:{r:.6980392,g:.1137255,b:.372549},_envColorRight:{r:.1882353,g:.6196079,b:.6235294},_envColorWhite:{r:.8329412,g:.9008105,b:.9254902},_envColorLeftBoost:{r:.9019608,g:.4470589,b:.06666667},_envColorRightBoost:{r:.6365692,g:.4373443,b:.8584906},_envColorWhiteBoost:{r:.8803849,g:.8313726,b:.9254902},_obstacleColor:{r:.9686275,g:.3803922,b:.2745098}},Queen:{_colorLeft:{r:.58,g:.5675714,b:.5551428},_colorRight:{r:.5236231,g:.1345675,b:.6792453},_envColorLeft:{r:.9333334,g:.6392157,b:.1215686},_envColorRight:{r:.04313726,g:.7176471,b:.8980393},_envColorLeftBoost:{r:.7686275,g:.145098,b:.07450981},_envColorRightBoost:{r:.4,g:.007843138,b:.7254902},_obstacleColor:{r:.9333334,g:.6392157,b:.1215686}},"Linkin Park 2.0":{_colorLeft:{r:.6627451,g:.1643608,b:.1690187},_colorRight:{r:.3870196,g:.5168997,b:.5568628},_envColorLeft:{r:.6627451,g:.1647059,b:.172549},_envColorRight:{r:.6235294,g:.6901961,b:.7098039},_envColorWhite:{r:.7529413,g:.6745098,b:.5921569},_envColorLeftBoost:{r:.922,g:.5957885,b:.255394},_envColorRightBoost:{r:.282353,g:.4586275,b:.6235294},_obstacleColor:{r:.6627451,g:.1647059,b:.172549}},"The Rolling Stones":{_colorLeft:{r:.8980392,g:0,b:.1150319},_colorRight:{r:.5254902,g:.1333333,b:.6784314},_envColorLeft:{r:.9529412,g:.01176471,b:.4039216},_envColorRight:{r:.4784314,g:.4039216,b:1},_envColorLeftBoost:{r:.5647059,g:.4622677,b:0},_envColorRightBoost:{r:.003921554,g:.6383545,b:.6705883},_obstacleColor:{r:.9529412,g:.01176471,b:.4039216}},Lattice:{_colorLeft:{r:.8392157,g:.172549,b:.5456773},_colorRight:{r:0,g:.6717121,b:.9803922},_envColorLeft:{r:.8941177,g:.1607843,b:.7490196},_envColorRight:{r:.1960784,g:.5843138,b:.7960785},_envColorLeftBoost:{r:.5450981,g:.1333333,b:.8156863},_envColorRightBoost:{r:.4039216,g:.9176471,b:.9176471},_obstacleColor:{r:.4685534,g:.7095922,b:1}},"Daft Punk":{_colorLeft:{r:.7215686,g:.2254902,b:.1803922},_colorRight:{r:.1215686,g:.6980392,b:.6901961},_envColorLeft:{r:1,g:.7017543,b:.2515723},_envColorRight:{r:.5215687,g:.3294118,b:.8196079},_envColorWhite:{r:.4784314,g:.8117647,b:1},_envColorLeftBoost:{r:.8588235,g:0,b:.4784314},_envColorRightBoost:{r:0,g:.8196079,b:.8039216},_envColorWhiteBoost:{r:1,g:.834256,b:.4874213},_obstacleColor:{r:.6068091,g:0,b:1}},"Hip Hop Mixtape":{_colorLeft:{r:1,g:.583857,b:.3137255},_colorRight:{r:.01542656,g:.6132076,b:.5896002},_envColorLeft:{r:.9137256,g:.4941177,b:0},_envColorRight:{r:.05882353,g:.8039216,b:.1843137},_envColorWhite:{r:.8000001,g:.7568628,b:.7058824},_envColorLeftBoost:{r:.1411765,g:1,b:.9686275},_envColorRightBoost:{r:.227451,g:.2745098,b:1},_envColorWhiteBoost:{r:.8784314,g:.8784314,b:.8784314},_obstacleColor:{r:1,g:.3137255,b:.5529412}},"Glass Desert":{_colorLeft:{r:.6792453,g:.5712628,b:0},_colorRight:{r:.7075472,g:0,b:.5364411},_envColorLeft:{r:.32222217,g:.6111111,b:.75},_envColorRight:{r:.03844783,g:.62239975,b:.90566039},_obstacleColor:{r:.06167676,g:.2869513,b:.3962264}}};function mc(i,t){var f,h,p,c,u,b,d;if(!i||!i._colorLeft&&!i._colorRight&&!i._envColorLeft&&!i._envColorLeftBoost&&!i._envColorRight&&!i._envColorRightBoost&&!i._envColorWhite&&!i._envColorWhiteBoost&&!i._obstacleColor){ye(la);return}t||(t="DefaultEnvironment");const e={_colorLeft:((f=gi[bi[t]])==null?void 0:f._colorLeft)||null,_colorRight:((h=gi[bi[t]])==null?void 0:h._colorRight)||null,_envColorLeft:((p=gi[bi[t]])==null?void 0:p._envColorLeft)||null,_envColorRight:((c=gi[bi[t]])==null?void 0:c._envColorRight)||null,_envColorWhite:null,_envColorLeftBoost:((u=gi[bi[t]])==null?void 0:u._envColorLeftBoost)||null,_envColorRightBoost:((b=gi[bi[t]])==null?void 0:b._envColorRightBoost)||null,_envColorWhiteBoost:null,_obstacleColor:((d=gi[bi[t]])==null?void 0:d._obstacleColor)||null},o={_colorLeft:e._colorLeft?pt(e._colorLeft):null,_colorRight:e._colorRight?pt(e._colorRight):null,_envColorLeft:e._envColorLeft?pt(e._envColorLeft):null,_envColorRight:e._envColorRight?pt(e._envColorRight):null,_envColorWhite:null,_envColorLeftBoost:e._envColorLeftBoost?pt(e._envColorLeftBoost):null,_envColorRightBoost:e._envColorRightBoost?pt(e._envColorRightBoost):null,_envColorWhiteBoost:null,_obstacleColor:e._obstacleColor?pt(e._obstacleColor):null},s={noteColor:!!(i._colorLeft||i._colorRight),eventColor:!!(i._envColorLeft||i._envColorRight),eventBoostColor:!!(i._envColorLeftBoost||i._envColorRightBoost),obstacleColor:!!i._obstacleColor};i._colorLeft&&(o._colorLeft=pt(i._colorLeft)),i._colorRight&&(o._colorRight=pt(i._colorRight)),i._envColorLeft?o._envColorLeft=pt(i._envColorLeft):i._colorLeft&&(o._envColorLeft=pt(i._colorLeft)),i._envColorRight?o._envColorRight=pt(i._envColorRight):i._colorRight&&(o._envColorRight=pt(i._colorRight));let n,r,a=!1;i._envColorLeftBoost?(n=pt(i._envColorLeftBoost),a=!0):n=e._envColorLeftBoost?pt(e._envColorLeftBoost):o._envColorLeft,i._envColorRightBoost?(r=pt(i._envColorRightBoost),a=!0):r=e._envColorRightBoost?pt(e._envColorRightBoost):o._envColorRight,i._envColorWhite&&(o._envColorWhite=pt(i._envColorWhite)),i._envColorWhiteBoost&&(o._envColorWhiteBoost=pt(i._envColorWhiteBoost)),a&&(o._envColorLeftBoost=n,o._envColorRightBoost=r),i._obstacleColor&&(o._obstacleColor=pt(i._obstacleColor)),s.noteColor||(o._colorLeft=null,o._colorRight=null),s.eventColor||(o._envColorLeft=null,o._envColorRight=null),s.noteColor&&!s.eventColor&&(o._envColorLeft=o._colorLeft,o._envColorRight=o._colorRight),s.obstacleColor||(o._obstacleColor=null);const l=Qo.create("max","none",!0);for(const v in o){if(!o[v])continue;const y=document.createElement("div"),E=document.createElement("div"),S=document.createElement("div"),x=document.createElement("div");E.className="info__color-dot",E.style.backgroundColor=o[v]||"#000000",S.className="info__color-text info__color-text--monospace",S.textContent=`${o[v]}`,x.className="info__color-text",x.textContent=` -- ${$f[v]}`,y.appendChild(E),y.appendChild(S),y.appendChild(x),l.appendChild(y)}_e(la,[l])}var pc=(i=>(i.duplicate="D",i.active="A",i.scale="S",i.position="P",i.localPosition="Lp",i.rotation="R",i.localRotation="Lr",i.lightID="Li",i.track="T",i))(pc||{}),dc=(i=>(i.childrenTracks="Ct",i.color="C",i.definitePosition="Dp",i.dissolve="D",i.dissolveArrow="Da",i.duration="Dur",i.easing="E",i.interactable="I",i.localRotation="Lr",i.parentTrack="Pt",i.position="P",i.rotation="R",i.scale="S",i.time="T",i.track="Tr",i.worldPositionStays="Wps",i))(dc||{});function bc(i,t){if(i==null||!i.length){ye(ga);return}const e=i.map((o,s)=>{let n=o.b,r;t&&(n=t.adjustTime(n),r=t.toRealTime(n));const a=[];if(!o.d)return`Error parsing customEvents[${s}]`;for(const l in o.d){if(l=="_duration"||l=="_easing"||l=="_track"||l=="duration"||l=="easing"||l=="track")continue;const f=dc[l];o.d[l]!=null&&a.push(f)}return`${M(o.b,et.rounding)}${r?" | "+Xe(r):""} -- ${o.t} -> [${a.join("")}]${o.t!=="AssignTrackParent"?`(${o.d.track})`:""}`});_e(ga,e)}function gc(i){if(i==null||!i.length){ye(da);return}const t=i.map((e,o)=>{const s=[];if(!e.id&&!e.geometry)return`Error parsing environment[${o}]`;for(const n in e){if(n=="lookupMethod"||n=="id"||n=="geometry")continue;const r=pc[n];e[n]!=null&&s.push(r)}return`${e.geometry?"Geometry":e.lookupMethod} [${s.join("")}]${e.track?`(${e.track})`:""} -> ${e.geometry?e.geometry.type:e.id}`});_e(da,t)}function vc(i){if(i==null){ye(ea);return}_e(ea,i)}function Ff(i){if(i==null||!i.length){ye(ia);return}let t=i.join(", ");_e(ia,t)}function Gf(i){if(i==null||!i.length){ye(oa);return}let t=i.join(", ");_e(oa,t)}function yc(i){if(i==null){ye(sa);return}let t=(hr[i]||"Unknown")+" Environment";hr[i]||(t+=` (${i})`),_e(sa,t)}function _c(i){if(i==null){ye(ra);return}_e(ra,bf(i))}function Dc(i){if(i==null||!i.length){ye(ua);return}_e(ua,i.join(", "))}function Ec(i){if(i==null||!i.length){ye(ca);return}_e(ca,i.join(", "))}function wc(i){if(i==null||!i.length){ye(ha);return}_e(ha,i)}function Sc(i){if(i==null||!i.length){ye(fa);return}_e(fa,i)}function Cc(i){if(i==null){ye(ba);return}const t=[];for(const e in i){i[e]||t.push(`Error parsing pointDefinitions[${e}]`);const o=i[e];Array.isArray(o)||t.push(`Error parsing pointDefinitions[${e}]`),t.push(`${e} -- ${o.length} point${o.length>1?"s":""}`)}_e(ba,t)}function xc(i,t){if(i==null||t==null){ye(na);return}_e(na,`${Xe(i)} to ${Xe(t)}${lt.duration?` -- [ ${Xe(t-i)} / ${Xe(lt.duration)} ]`:""}`)}function Tc(i){if(!i||!i.saberLeftColor&&!i.saberRightColor&&!i.environment0Color&&!i.environment0ColorBoost&&!i.environment1Color&&!i.environment1ColorBoost&&!i.environmentWColor&&!i.environmentWColorBoost&&!i.obstaclesColor){ye(aa);return}const t={};t.saberLeftColor=pt(i.saberLeftColor),t.saberRightColor=pt(i.saberRightColor),t.environment0Color=pt(i.environment0Color),t.environment1Color=pt(i.environment1Color),t.environment0ColorBoost=pt(i.environment0ColorBoost),t.environment1ColorBoost=pt(i.environment1ColorBoost),t.obstaclesColor=pt(i.obstaclesColor),i.environmentWColor&&(t.environmentWColor=pt(i.environmentWColor)),i.environmentWColorBoost&&(t.environmentWColorBoost=pt(i.environmentWColorBoost));const e=Qo.create("max","none",!0);for(const o in t){if(!t[o])continue;const s=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div"),a=document.createElement("div");n.className="info__color-dot",n.style.backgroundColor=t[o]||"#000000",r.className="info__color-text info__color-text--monospace",r.textContent=`${t[o]}`,a.className="info__color-text",a.textContent=` -- ${Mf[o]}`,s.appendChild(n),s.appendChild(r),s.appendChild(a),e.appendChild(s)}_e(aa,[e])}function jf(i){fe.setSongName(i.song.title),fe.setSongSubname(i.song.subTitle),fe.setSongAuthor(i.song.author),fe.setSongBPM(i.audio.bpm);const t=new Set,e=new Set,o=new Set;i.difficulties.forEach(s=>{s.authors.mappers.forEach(n=>t.add(n)),s.authors.lighters.forEach(n=>e.add(n)),o.add(i.environmentNames.at(s.environmentId))}),oc([...t],[...e]),sc([...o].filter(s=>s)),nc(i.customData._editors)}function Lc(i,t){var e,o;if(vc(t.rawData._version||t.rawData.version||"Unknown"),Ff(t.info.authors.mappers),Gf(t.info.authors.lighters),yc(i.environmentNames.at(t.info.environmentId)),Tc(i.colorSchemes.at(t.info.colorSchemeId)),t.info.customData&&(mc(t.info.customData),Dc(t.info.customData._requirements),Ec(t.info.customData._suggestions),wc(t.info.customData._information),Sc(t.info.customData._warnings)),(e=t.data)!=null&&e.customData){const s=(o=lt.beatmapInfo)!=null&&o.audio.bpm?Gi.create(lt.beatmapInfo.audio.bpm,t.data.customData._bpmChanges||t.data.customData._BPMChanges||t.data.customData.BPMChanges):null;_c(t.data.customData._time??t.data.customData.time),hc(t.data.customData._bookmarks??t.data.customData._bookmarks,s),fc(s),gc(t.data.customData.environment),Cc(t.data.customData.pointDefinitions),bc(t.data.customData.customEvents,s)}xc(t.bpm.toRealTime(t.data.getFirstInteractiveTime()),t.bpm.toRealTime(t.data.getLastInteractiveTime()))}function Jf(){oc(),sc(),nc(),ac(),vc(),yc(),xc(),_c(),Tc(),mc(),Dc(),Ec(),wc(),Sc(),hc(),fc(),gc(),Cc(),bc()}const Ys={enable:i=>{document.querySelectorAll(".input-toggle").forEach(e=>{e.disabled=!i})}},hs=document.querySelector(".loading__bar"),va="loading__bar--error",ya="loading__bar--download",Wf=document.querySelector(".loading__text");function Nc(i,t,e=100){Wf.textContent=t,hs.style.width=`${e}%`,i==="error"?hs.classList.add(va):hs.classList.remove(va),i==="download"?hs.classList.add(ya):hs.classList.remove(ya)}function Xf(){Nc("info","No map loaded",0)}const It={status:Nc,reset:Xf};var bt=(i=>(i[i.APRIL_FOOLS=0]="APRIL_FOOLS",i[i.GENERAL_AUDIO=1]="GENERAL_AUDIO",i[i.GENERAL_COVER_IMAGE=2]="GENERAL_COVER_IMAGE",i[i.GENERAL_PREVIEW_TIME=3]="GENERAL_PREVIEW_TIME",i[i.GENERAL_PROGRESSION=4]="GENERAL_PROGRESSION",i[i.OTHERS_INVALID_OBJECT=5]="OTHERS_INVALID_OBJECT",i[i.OTHERS_OUTSIDE_PLAYABLE=6]="OTHERS_OUTSIDE_PLAYABLE",i[i.OTHERS_HOT_START=7]="OTHERS_HOT_START",i[i.OTHERS_NJS=8]="OTHERS_NJS",i[i.OTHERS_DIFFICULTY_LABEL=9]="OTHERS_DIFFICULTY_LABEL",i[i.EVENTS_INSUFFICIENT_LIGHT=10]="EVENTS_INSUFFICIENT_LIGHT",i[i.EVENTS_INVALID_EVENT_BOX=11]="EVENTS_INVALID_EVENT_BOX",i[i.EVENTS_UNLIT_BOMB=12]="EVENTS_UNLIT_BOMB",i[i.NOTES_EFFECTIVE_BPM=13]="NOTES_EFFECTIVE_BPM",i[i.NOTES_ACCEPTABLE_PRECISION=14]="NOTES_ACCEPTABLE_PRECISION",i[i.NOTES_PARITY=15]="NOTES_PARITY",i[i.NOTES_VARY_SWING=16]="NOTES_VARY_SWING",i[i.NOTES_SLOW_SLIDER=17]="NOTES_SLOW_SLIDER",i[i.NOTES_INLINE_ANGLE=18]="NOTES_INLINE_ANGLE",i[i.NOTES_SHRADO_ANGLE=19]="NOTES_SHRADO_ANGLE",i[i.NOTES_SPEED_PAUSE=20]="NOTES_SPEED_PAUSE",i[i.NOTES_IMPROPER_ARC=21]="NOTES_IMPROPER_ARC",i[i.NOTES_IMPROPER_CHAIN=22]="NOTES_IMPROPER_CHAIN",i[i.NOTES_IMPROPER_WINDOW=23]="NOTES_IMPROPER_WINDOW",i[i.NOTES_HITBOX_STAIR=24]="NOTES_HITBOX_STAIR",i[i.NOTES_HITBOX_REVERSE_STAIR=25]="NOTES_HITBOX_REVERSE_STAIR",i[i.NOTES_HITBOX_INLINE=26]="NOTES_HITBOX_INLINE",i[i.NOTES_HITBOX_PATH=27]="NOTES_HITBOX_PATH",i[i.NOTES_ONE_SABER=28]="NOTES_ONE_SABER",i[i.NOTES_COLOR_CHECK=29]="NOTES_COLOR_CHECK",i[i.NOTES_STACKED_NOTE=30]="NOTES_STACKED_NOTE",i[i.NOTES_DOUBLE_DIRECTIONAL=31]="NOTES_DOUBLE_DIRECTIONAL",i[i.NOTES_VISION_BLOCK=32]="NOTES_VISION_BLOCK",i[i.OBSTACLES_SHORT=33]="OBSTACLES_SHORT",i[i.OBSTACLES_CENTER=34]="OBSTACLES_CENTER",i[i.OBSTACLES_ZERO=35]="OBSTACLES_ZERO",i[i.OBSTACLES_NEGATIVE=36]="OBSTACLES_NEGATIVE",i))(bt||{}),gt=(i=>(i[i.APRIL_FOOLS=0]="APRIL_FOOLS",i[i.GENERAL_AUDIO=1]="GENERAL_AUDIO",i[i.GENERAL_COVER_IMAGE=2]="GENERAL_COVER_IMAGE",i[i.GENERAL_PREVIEW_TIME=3]="GENERAL_PREVIEW_TIME",i[i.GENERAL_PROGRESSION=4]="GENERAL_PROGRESSION",i[i.OTHERS_INVALID_OBJECT=5]="OTHERS_INVALID_OBJECT",i[i.OTHERS_OUTSIDE_PLAYABLE=6]="OTHERS_OUTSIDE_PLAYABLE",i[i.OTHERS_HOT_START=7]="OTHERS_HOT_START",i[i.OTHERS_NJS=8]="OTHERS_NJS",i[i.OTHERS_DIFFICULTY_LABEL=9]="OTHERS_DIFFICULTY_LABEL",i[i.EVENTS_INSUFFICIENT_LIGHT=10]="EVENTS_INSUFFICIENT_LIGHT",i[i.EVENTS_INVALID_EVENT_BOX=11]="EVENTS_INVALID_EVENT_BOX",i[i.EVENTS_UNLIT_BOMB=12]="EVENTS_UNLIT_BOMB",i[i.NOTES_ONE_SABER=13]="NOTES_ONE_SABER",i[i.NOTES_COLOR_CHECK=14]="NOTES_COLOR_CHECK",i[i.NOTES_EFFECTIVE_BPM=15]="NOTES_EFFECTIVE_BPM",i[i.NOTES_ACCEPTABLE_PRECISION=16]="NOTES_ACCEPTABLE_PRECISION",i[i.NOTES_PARITY=17]="NOTES_PARITY",i[i.NOTES_VARY_SWING=18]="NOTES_VARY_SWING",i[i.NOTES_SLOW_SLIDER=19]="NOTES_SLOW_SLIDER",i[i.NOTES_INLINE_ANGLE=20]="NOTES_INLINE_ANGLE",i[i.NOTES_SHRADO_ANGLE=21]="NOTES_SHRADO_ANGLE",i[i.NOTES_SPEED_PAUSE=22]="NOTES_SPEED_PAUSE",i[i.NOTES_IMPROPER_ARC=23]="NOTES_IMPROPER_ARC",i[i.NOTES_IMPROPER_CHAIN=24]="NOTES_IMPROPER_CHAIN",i[i.NOTES_IMPROPER_WINDOW=25]="NOTES_IMPROPER_WINDOW",i[i.NOTES_HITBOX_STAIR=26]="NOTES_HITBOX_STAIR",i[i.NOTES_HITBOX_REVERSE_STAIR=27]="NOTES_HITBOX_REVERSE_STAIR",i[i.NOTES_HITBOX_INLINE=28]="NOTES_HITBOX_INLINE",i[i.NOTES_HITBOX_PATH=29]="NOTES_HITBOX_PATH",i[i.NOTES_STACKED_NOTE=30]="NOTES_STACKED_NOTE",i[i.NOTES_DOUBLE_DIRECTIONAL=31]="NOTES_DOUBLE_DIRECTIONAL",i[i.NOTES_VISION_BLOCK=32]="NOTES_VISION_BLOCK",i[i.OBSTACLES_SHORT=33]="OBSTACLES_SHORT",i[i.OBSTACLES_CENTER=34]="OBSTACLES_CENTER",i[i.OBSTACLES_ZERO=35]="OBSTACLES_ZERO",i[i.OBSTACLES_NEGATIVE=36]="OBSTACLES_NEGATIVE",i))(gt||{});const Hf="April Fools",Yf="xdd.",Vf=!0,mr={name:Hf,description:Yf,type:"general",order:{input:bt.APRIL_FOOLS,output:gt.APRIL_FOOLS},input:{enabled:Vf,params:{}},output:{html:null},run:zf};function zf(i){const t=new Date("01 April 1984"),e=new Date,o=t.getDate()===e.getDate()&&t.getMonth()===e.getMonth();if(!et.aprilFooled&&o){const s=document.createElement("div"),n=document.createElement("a");n.text="this link for more info.",n.href="https://youtu.be/dQw4w9WgXcQ",n.addEventListener("click",function(){et.aprilFooled=!0,et.save()}),s.innerHTML='<b><span title="Info: no action necessary, take note."> ⚠️ </span>AI generated content detected:</b> this may violate TOS, please refer to ',s.append(n),mr.output.html=s}else mr.output.html=null}function Bc(i,t){switch(t){case"rank":i='<span title="Ranking: for rankability reason."> 🚧 </span>'+i;break;case"error":i='<span title="Error: should be fixed unless you know what you are doing."> ❌ </span>'+i;break;case"warning":i='<span title="Warning: not necessarily needed to be fixed, worth considering."> ❗ </span>'+i;break;case"info":i='<span title="Info: no action necessary, take note."> ⚠️ </span>'+i;break}return i}function Pt(i,t,e){const o=document.createElement("div");return i=Bc(i,e),t?o.innerHTML=`<b>${i}:</b> ${t}`:o.innerHTML=`<b>${i}</b>`,o}function mt(i,t,e,o){const s=document.createElement("div");return i=Bc(i,o),s.innerHTML=`<b>${i} [${t.length}]:</b> ${t.map(n=>{switch(et.beatNumbering){case"realtime":return`<span title="Beat ${M(e.adjustTime(n),et.rounding)}">${Xe(e.toRealTime(n))}</span>`;case"realtimems":return`<span title="Beat ${M(e.adjustTime(n),et.rounding)}">${on(e.toRealTime(n))}</span>`;case"jsontime":return`<span title="Time ${on(e.toRealTime(n))}">${M(n,et.rounding)}</span>`;case"beattime":default:return`<span title="Time ${on(e.toRealTime(n))}">${M(e.adjustTime(n),et.rounding)}</span>`}}).join(", ")}`,s}let Vs=0;const U={createBlock:function(...i){const t=document.createElement("div");for(const e of i)if(Array.isArray(e))for(const o of e)t.append(o);else t.appendChild(e);return t},createText:function(i,t,e){const o=`input-${Vs++}`,s=document.createElement("input"),n=document.createElement("label");return s.id="input__gen-"+o,s.className="input-toggle input--small",s.type="text",s.value=e,s.addEventListener("change",i),t&&(n.textContent=t,n.htmlFor="input__gen-"+o),[s,n]},createNumber:function(i,t,e,o,s,n){const r=`input-${Vs++}`,a=document.createElement("input"),l=document.createElement("label");return a.id="input__gen-"+r,a.className="input-toggle input--small",a.type="text",a.value=e.toString(),a.addEventListener("change",i),t&&(l.textContent=t,l.htmlFor="input__gen-"+r),typeof o=="number"&&(a.min=o.toString()),typeof s=="number"&&(a.max=s.toString()),typeof n=="number"&&(a.step=n.toString()),[l,a]},createCheckbox:function(i,t,e,o){const s=`input-${Vs++}`,n=document.createElement("input"),r=document.createElement("label");return r.textContent=" "+t,r.title=e,r.htmlFor="input__gen-"+s,n.id="input__gen-"+s,n.className="input-toggle",n.type="checkbox",n.checked=o,n.addEventListener("change",i),[n,r]},createRadio:function(i,t,e,o,s){const n=`input-${Vs++}`,r=document.createElement("input"),a=document.createElement("label");return a.textContent=t,a.htmlFor="input__gen-"+n,r.id="input__gen-"+n,r.name=e,r.className="input-toggle",r.type="radio",r.checked=s,r.value=o,r.addEventListener("change",i),[a,r]}},_a="Audio Duration",Da="For ranking purpose, check for audio duration.",Ea=!0,fs={name:_a,description:Da,type:"general",order:{input:bt.GENERAL_AUDIO,output:gt.GENERAL_AUDIO},input:{enabled:Ea,params:{},html:U.createBlock(U.createCheckbox(function(){fs.input.enabled=this.checked},_a,Da,Ea))},output:{html:null},run:Uf};function Uf(i){const{audioDuration:t}=i.settings;t&&t<20?fs.output.html=Pt("Unrankable audio length",`too short (${Xe(t)}s)`,"rank"):co.loading.audio?fs.output.html=null:fs.output.html=Pt("No audio",et.load.audio?"could not be loaded or not found":"no audio mode is enabled")}const wa="Validate Cover Image",Sa="Validate cover image.",Ca=!0,hn={name:wa,description:Sa,type:"general",order:{input:bt.GENERAL_COVER_IMAGE,output:gt.GENERAL_COVER_IMAGE},input:{enabled:Ca,params:{},html:U.createBlock(U.createCheckbox(function(){hn.input.enabled=this.checked},wa,Sa,Ca))},output:{html:null},run:qf};function qf(){const i=new Image,t=fe.getCoverImage(),e=[];if(co.loading.coverImage&&t!==null?(i.src=t,i.width!==i.height&&e.push(Pt("Cover image is not square","resize to fit square","error")),(i.width<256||i.height<256)&&e.push(Pt("Cover image is too small","require at least 256x256","error"))):e.push(Pt("No cover image",et.load.imageCover?"could not be loaded or found":"no cover image option is enabled")),e.length){const o=document.createElement("div");e.forEach(s=>o.append(s)),hn.output.html=o}else hn.output.html=null}const xa="Preview Time",Ta="Warn default editor preview time.",La=!0,fn={name:xa,description:Ta,type:"general",order:{input:bt.GENERAL_PREVIEW_TIME,output:gt.GENERAL_PREVIEW_TIME},input:{enabled:La,params:{},html:U.createBlock(U.createCheckbox(function(){fn.input.enabled=this.checked},xa,Ta,La))},output:{html:null},run:Kf};function Kf(i){const{previewStartTime:t,previewDuration:e}=i.info.audio;t===12&&e===10?fn.output.html=Pt("Default preview time","strongly recommended to set for audience's 1st impression","info"):fn.output.html=null}function Zf(i){return Math.max(...i.map(t=>t.ebpm),0)}function Qf(i){return Math.max(...i.map(t=>t.ebpmSwing),0)}var nt=(i=>(i[i.RED=0]="RED",i[i.BLUE=1]="BLUE",i))(nt||{}),R=(i=>(i[i.UP=0]="UP",i[i.DOWN=1]="DOWN",i[i.LEFT=2]="LEFT",i[i.RIGHT=3]="RIGHT",i[i.UP_LEFT=4]="UP_LEFT",i[i.UP_RIGHT=5]="UP_RIGHT",i[i.DOWN_LEFT=6]="DOWN_LEFT",i[i.DOWN_RIGHT=7]="DOWN_RIGHT",i[i.ANY=8]="ANY",i))(R||{}),ut=(i=>(i[i.LEFT=0]="LEFT",i[i.MIDDLE_LEFT=1]="MIDDLE_LEFT",i[i.MIDDLE_RIGHT=2]="MIDDLE_RIGHT",i[i.RIGHT=3]="RIGHT",i))(ut||{}),te=(i=>(i[i.BOTTOM=0]="BOTTOM",i[i.MIDDLE=1]="MIDDLE",i[i.TOP=2]="TOP",i))(te||{});const kc={0:-60,1:-45,2:-30,3:-15,4:15,5:30,6:45,7:60};var Rc=(i=>(i[i.DIVISION=1]="DIVISION",i[i.STEP_AND_OFFSET=2]="STEP_AND_OFFSET",i))(Rc||{}),Oc=(i=>(i[i.NONE=0]="NONE",i[i.DURATION=1]="DURATION",i[i.DISTRIBUTION=2]="DISTRIBUTION",i[i.ALL=3]="ALL",i))(Oc||{}),Ac=(i=>(i[i.NO_RANDOM=0]="NO_RANDOM",i[i.KEEP_ORDER=1]="KEEP_ORDER",i[i.RANDOM_ELEMENTS=2]="RANDOM_ELEMENTS",i[i.ALL=3]="ALL",i))(Ac||{}),pr=(i=>(i[i.INT=0]="INT",i[i.FLOAT=1]="FLOAT",i[i.BOOL=2]="BOOL",i))(pr||{}),He=(i=>(i[i.NONE=0]="NONE",i[i.COLOR=1]="COLOR",i[i.ROTATION=2]="ROTATION",i[i.TRANSLATION=3]="TRANSLATION",i[i.FX_FLOAT=4]="FX_FLOAT",i))(He||{});const jn=4,Si={[R.UP]:180,[R.DOWN]:0,[R.LEFT]:270,[R.RIGHT]:90,[R.UP_LEFT]:225,[R.UP_RIGHT]:135,[R.DOWN_LEFT]:315,[R.DOWN_RIGHT]:45,[R.ANY]:0},tm={[R.UP]:R.DOWN,[R.DOWN]:R.UP,[R.LEFT]:R.RIGHT,[R.RIGHT]:R.LEFT,[R.UP_LEFT]:R.DOWN_RIGHT,[R.UP_RIGHT]:R.DOWN_LEFT,[R.DOWN_LEFT]:R.UP_RIGHT,[R.DOWN_RIGHT]:R.UP_LEFT,[R.ANY]:R.ANY},Yi={[R.UP]:[0,1],[R.DOWN]:[0,-1],[R.LEFT]:[-1,0],[R.RIGHT]:[1,0],[R.UP_LEFT]:[-1,1],[R.UP_RIGHT]:[1,1],[R.DOWN_LEFT]:[-1,-1],[R.DOWN_RIGHT]:[1,-1],[R.ANY]:[0,0]},Ic={"-60":0,"-45":1,"-30":2,"-15":3,15:4,30:5,45:6,60:7};class Er{serialize(){return JSON.stringify(this.toJSON())}clone(){return new this.constructor(this)}}class $o extends Er{get customData(){return this._customData}set customData(t){this._customData=t}setCustomData(t){return this.customData=t,this}resetCustomData(){return this.customData={},this}removeCustomData(t){return typeof t=="string"?delete this.customData[t]:t.forEach(e=>delete this.customData[e]),this}addCustomData(t){for(const e in t)this.customData[e]=t[e];return this}func(t,...e){return t(this,...e),this}isChroma(){return!1}isNoodleExtensions(){return!1}isMappingExtensions(){return!1}}class Ti extends $o{get time(){return this._time}set time(t){this._time=t}setTime(t){return this.time=t,this}}class Jn extends Ti{constructor(){super(...arguments),this._laneRotation=0}get posX(){return this._posX}set posX(t){this._posX=t}get posY(){return this._posY}set posY(t){this._posY=t}get laneRotation(){return this._laneRotation}set laneRotation(t){this._laneRotation=t}setPosX(t){return this.posX=t,this}setPosY(t){return this.posY=t,this}setLaneRotation(t){return this.laneRotation=t,this}mirror(t,e){return this.posX=jn-1-this.posX,this}getPosition(t){return[this.posX-2,this.posY]}getDistance(t,e){const[o,s]=this.getPosition(e),[n,r]=t.getPosition(e);return Math.sqrt(Math.pow(n-o,2)+Math.pow(r-s,2))}isVertical(t,e){const[o]=this.getPosition(e),[s]=t.getPosition(e),n=o-s;return n>-.001&&n<.001}isHorizontal(t,e){const[o,s]=this.getPosition(e),[n,r]=t.getPosition(e),a=s-r;return a>-.001&&a<.001}isDiagonal(t,e){const[o,s]=this.getPosition(e),[n,r]=t.getPosition(e),a=Math.abs(o-n),l=Math.abs(s-r);return a===l}isInline(t,e,o){return e??(e=.5),this.getDistance(t,o)<=e}isAdjacent(t,e){const o=this.getDistance(t,e);return o>.499&&o<1.001}isWindow(t,e,o){return e??(e=1.8),this.getDistance(t,o)>e}isSlantedWindow(t,e){return this.isWindow(t,null,e)&&!this.isDiagonal(t,e)&&!this.isHorizontal(t,e)&&!this.isVertical(t,e)}}class Pc extends Jn{get color(){return this._color}set color(t){this._color=t}get direction(){return this._direction}set direction(t){this._direction=t}setColor(t){return this.color=t,this}setDirection(t){return this.direction=t,this}mirror(t=!0,e){switch(t&&(this.color=(1+this.color)%2),this.direction){case 2:this.direction=3;break;case 3:this.direction=2;break;case 6:this.direction=7;break;case 7:this.direction=6;break;case 4:this.direction=5;break;case 5:this.direction=4;break}return super.mirror(t)}isRed(){return this.color===0}isBlue(){return this.color===1}getAngle(t){return Si[this.direction]||0}isDouble(t,e=.01){return t.time>this.time-e&&t.time<this.time+e&&this.color!==t.color}isValidDirection(){return this.direction>=0&&this.direction<=8}isValid(){return!this.isMappingExtensions()&&this.isValidDirection()}}class As extends Pc{constructor(){super(...arguments),this._angleOffset=0}get type(){return this._type}set type(t){this._type=t}get angleOffset(){return this._angleOffset}set angleOffset(t){this._angleOffset=t}setType(t){return this.type=t,this}setAngleOffset(t){return this.angleOffset=t,this}mirror(t=!0,e){return super.mirror(t)}isNote(){return this.type===0||this.type===1}isBomb(){return this.type===3}getAngle(t){return(Si[this.direction]||0)+this.angleOffset}isMappingExtensions(){return this.posX>3||this.posX<0||this.posY>2||this.posY<0||this.direction>=1e3&&this.direction<=1360||this.direction>=2e3&&this.direction<=2360}}function $c(i,t,e){return i.direction===R.ANY&&t.direction===R.ANY&&e!==R.ANY&&(i.posX>t.posX&&(e===R.UP_RIGHT||e===R.RIGHT||e===R.DOWN_RIGHT)||i.posX<t.posX&&(e===R.DOWN_LEFT||e===R.LEFT||e===R.UP_LEFT)||i.posY>t.posY&&(e===R.UP_LEFT||e===R.UP||e===R.UP_RIGHT)||i.posY<t.posY&&(e===R.DOWN_LEFT||e===R.DOWN||e===R.DOWN_RIGHT))||i.posX>t.posX&&(i.direction===R.UP_RIGHT||i.direction===R.RIGHT||i.direction===R.DOWN_RIGHT||(t.direction===R.UP_RIGHT||t.direction===R.RIGHT||t.direction===R.DOWN_RIGHT)&&i.direction===R.ANY)||i.posX<t.posX&&(i.direction===R.DOWN_LEFT||i.direction===R.LEFT||i.direction===R.UP_LEFT||(t.direction===R.DOWN_LEFT||t.direction===R.LEFT||t.direction===R.UP_LEFT)&&i.direction===R.ANY)||i.posY>t.posY&&(i.direction===R.UP_LEFT||i.direction===R.UP||i.direction===R.UP_RIGHT||(t.direction===R.UP_LEFT||t.direction===R.UP||t.direction===R.UP_RIGHT)&&i.direction===R.ANY)||i.posY<t.posY&&(i.direction===R.DOWN_LEFT||i.direction===R.DOWN||i.direction===R.DOWN_RIGHT||(t.direction===R.DOWN_LEFT||t.direction===R.DOWN||t.direction===R.DOWN_RIGHT)&&i.direction===R.ANY)}function dr(i,t,e,o=!1){const[s,n]=i.getPosition(),[r,a]=t.getPosition(),l=o?540:360;let f=!1;if(i.direction!==8){const p=i.getAngle(),c=(rr(Math.atan2(n-a,s-r))+450)%360;for(const[u,b,d]of e){const v=d??0,y=(p+l-u+v)%360,E=(p+l+u+v)%360;if(f=b>=Math.sqrt(Math.pow(s-r,2)+Math.pow(n-a,2))&&(y<E&&y<=c&&c<=E||y>=E&&(c<=E||c>=y))||f,f)break}}let h=!1;if(t instanceof As&&t.direction!==8){const p=t.getAngle(),c=(rr(Math.atan2(a-n,r-s))+450)%360;for(const[u,b,d]of e){const v=d??0,y=(p+l-u+v)%360,E=(p+l+u+v)%360;if(h=b>=Math.sqrt(Math.pow(s-r,2)+Math.pow(n-a,2))&&(y<E&&y<=c&&c<=E||y>=E&&(c<=E||c>=y))||h,h)break}}return[f,h]}function Na(i,t){if($c(i,t,R.ANY))return i.direction===R.ANY?t.direction:i.direction;if(i.direction!==R.ANY)return i.direction;if(i.time>t.time){if(i.posX>t.posX&&i.isHorizontal(t))return R.RIGHT;if(i.posX<t.posX&&i.isHorizontal(t))return R.LEFT;if(i.posY>t.posY){if(i.isVertical(t))return R.UP;if(i.posX>t.posX)return R.UP_RIGHT;if(i.posX<t.posX)return R.UP_LEFT}if(i.posY<t.posY){if(i.isVertical(t))return R.DOWN;if(i.posX>t.posX)return R.DOWN_RIGHT;if(i.posX<t.posX)return R.DOWN_LEFT}}return R.ANY}function Ts(i,t,e,o){let s,n;if(i===null||t===null)return!1;if(typeof i=="number")s=i;else{if(i.direction===R.ANY)return!1;s=i.getAngle()}if(typeof t=="number")n=t;else{if(t.direction===R.ANY)return!1;n=t.getAngle()}return o?Vr(s,n,360)<=e:Vr(s,n,360)>=e}class ni{constructor(t){this.time=t.time,this.duration=t.duration,this.minSpeed=t.minSpeed,this.maxSpeed=t.maxSpeed,this.ebpm=t.ebpm,this.ebpmSwing=t.ebpmSwing,this.data=t.data}static generate(t,e){const o=[];let s=0,n=0,r,a;const l={},f={},h={0:[],1:[]};for(const p of t)p.type==="note"&&(r=0,a=Number.MAX_SAFE_INTEGER,f[p.data.color]?this.next(p,f[p.data.color],e,h[p.data.color])&&(r=this.calcMinSliderSpeed(h[p.data.color],e),a=this.calcMaxSliderSpeed(h[p.data.color],e),r>0&&a!==1/0||(r=0,a=0),n=this.calcEBPMBetweenObject(p.data,l[p.data.color].data,e),s=this.calcEBPMBetweenObject(p.data,f[p.data.color].data,e),o.push({time:l[p.data.color].data.time,duration:f[p.data.color].data.time-l[p.data.color].data.time,data:h[p.data.color],ebpm:s,ebpmSwing:n,maxSpeed:a,minSpeed:r}),l[p.data.color]=p,h[p.data.color]=[]):l[p.data.color]=p,f[p.data.color]=p,h[p.data.color].push(p));for(let p=0;p<2;p++)f[p]&&(r=this.calcMinSliderSpeed(h[p],e),a=this.calcMaxSliderSpeed(h[p],e),r>0&&a!==1/0||(r=0,a=0),o.push({time:l[p].data.time,duration:f[p].data.time-l[p].data.time,data:h[p],ebpm:s,ebpmSwing:n,maxSpeed:a,minSpeed:r}));return o}static next(t,e,o,s){if(t.type==="bomb"||e.type==="bomb")throw new Error("Invalid type");if(s&&s.length>0&&o.toRealTime(e.data.time)+.005<o.toRealTime(t.data.time)&&t.data.direction!==R.ANY){for(const n of s)if(n.type==="note"&&n.data.direction!==R.ANY&&Ts(t.data,n.data,90,!1))return!0}if(s&&s.length>0){for(const n of s)if(n.type==="note"&&t.data.isInline(n.data))return!0}return t.data.isWindow(e.data)&&o.toRealTime(t.data.time-e.data.time)>.08||o.toRealTime(t.data.time-e.data.time)>.07}static calcEBPMBetweenObject(t,e,o){return o.value/(o.toBeatTime(o.toRealTime(t.time)-o.toRealTime(e.time))*2)}static calcMinSliderSpeed(t,e){let o=!1,s=!1,n=0;const r=e.toRealTime(Math.max(...t.map((a,l)=>l===0?0:((t[l].data.isHorizontal(t[l-1].data)||t[l].data.isVertical(t[l-1].data))&&!o&&(o=!0,n=(t[l].data.time-t[l-1].data.time)/(t[l].data.getDistance(t[l-1].data)||1)),s=t[l].data.isDiagonal(t[l-1].data)||t[l].data.isSlantedWindow(t[l-1].data)||s,(t[l].data.time-t[l-1].data.time)/(t[l].data.getDistance(t[l-1].data)||1)))));return o&&s?e.toRealTime(n):r}static calcMaxSliderSpeed(t,e){let o=!1,s=!1,n=Number.MAX_SAFE_INTEGER;const r=e.toRealTime(Math.min(...t.map((a,l)=>l===0?Number.MAX_SAFE_INTEGER:((t[l].data.isHorizontal(t[l-1].data)||t[l].data.isVertical(t[l-1].data))&&!o&&(o=!0,n=(t[l].data.time-t[l-1].data.time)/(t[l].data.getDistance(t[l-1].data)||1)),s=t[l].data.isDiagonal(t[l-1].data)||t[l].data.isSlantedWindow(t[l-1].data)||s,(t[l].data.time-t[l-1].data.time)/(t[l].data.getDistance(t[l-1].data)||1)))));return o&&s?e.toRealTime(n):r}}function em(i,t,e){const o={left:new Array(Math.floor(t+1)).fill(0),right:new Array(Math.floor(t+1)).fill(0)};let s,n;for(const r of i){if(r.type!=="note")continue;const a=e.toRealTime(r.data.time);r.data.color===0&&(s?ni.next(r,s,e)&&o.left[Math.floor(a)]++:o.left[Math.floor(a)]++,s=r),r.data.color===1&&(n?ni.next(r,n,e)&&o.right[Math.floor(a)]++:o.right[Math.floor(a)]++,n=r)}return o}function ir(i,t){if(!i.length)return 0;if(i.length<t)return i.reduce((s,n)=>s+n)/i.length;let e=i.slice(0,t).reduce((s,n)=>s+n),o=e;for(let s=0;s<i.length-t;s++)e=e-i[s]+i[s+t],o=Math.max(o,e);return o/t}function im(i,t,e,o){const n={characteristic:e,difficulty:o,red:{average:0,peak:0,median:0,total:0},blue:{average:0,peak:0,median:0,total:0},total:{average:0,peak:0,median:0,total:0},container:ni.generate(i.getNoteContainer(),t)},r=Math.max(t.toRealTime(i.getLastInteractiveTime()-i.getFirstInteractiveTime()),0),a=Math.max(t.toRealTime(i.getLastInteractiveTime()),0),l=em(i.getNoteContainer(),a,t),f=l.left.map((u,b)=>u+l.right[b]);if(f.reduce((u,b)=>u+b)===0)return n;const h=[],p=[],c=[];for(let u=0,b=Math.ceil(f.length/10);u<b;u++){const d=u*10;let v=10;v+d>f.length&&(v=f.length-d);const y=l.left.slice(d,d+v),E=l.right.slice(d,d+v),S=f.slice(d,d+v);h.push(y.reduce((x,N)=>x+N)/v),p.push(E.reduce((x,N)=>x+N)/v),c.push(S.reduce((x,N)=>x+N)/v)}return n.red.total=l.left.reduce((u,b)=>u+b),n.red.average=l.left.reduce((u,b)=>u+b)/r,n.red.peak=ir(l.left,10),n.red.median=Zn(h),n.blue.total=l.right.reduce((u,b)=>u+b),n.blue.average=l.right.reduce((u,b)=>u+b)/r,n.blue.peak=ir(l.right,10),n.blue.median=Zn(p),n.total.total=n.red.total+n.blue.total,n.total.average=f.reduce((u,b)=>u+b)/r,n.total.peak=ir(f,10),n.total.median=Zn(c),n}function om(i,t){let e=0,o=0,s;for(const n of i){const r=n.total.average;if(o>0&&r>0&&(e=Math.abs(1-o/r)*100),o=r>0?r:o,o>t&&e>40)return{result:n,comparedTo:s};s=n}return null}function sm(i,t){let e=Number.MAX_SAFE_INTEGER,o=0,s;for(const n of i){const r=n.total.average;if(o>0&&r>0&&(e=Math.abs(1-o/r)*100),o=r>0?r:o,o>t&&e<10)return{result:n,comparedTo:s};s=n}return null}function nm(i){let t=0,e=Number.MAX_SAFE_INTEGER;return i.forEach(o=>{const s=o.total.average;s>0&&(t=Math.max(t,s),e=Math.min(e,s))}),t||t&&e?(1-e/t)*100:0}function Ba(i){return Math.min(...i.map(t=>t.total.average),Number.MAX_SAFE_INTEGER)}function ka(i){return Math.max(...i.map(t=>t.total.average),0)}function rm(i){return Math.max(...i.map(t=>t.minSpeed),0)}function am(i){const t=i.map(e=>e.maxSpeed).filter(e=>e!==0);return t.length?Math.min(...t):0}const mn={Easy:1,Normal:3,Hard:5,Expert:7,ExpertPlus:9},Bi={Easy:"Easy",Normal:"Normal",Hard:"Hard",Expert:"Expert",ExpertPlus:"Expert+"},Ra="Difficulty Progression",Oa="For ranking purpose, check difficuly progression to fit rankability criteria.",Aa=!0,Mc=document.createElement("ul"),lm=["ExpertPlus","Expert","Hard","Normal","Easy"];for(const i of lm)Mc.appendChild(U.createBlock(U.createCheckbox(function(){uo.input.params[i]=this.checked},Bi[i],`Toggle check progression for Standard ${Bi[i]}`,!0)));const uo={name:Ra,description:Oa,type:"general",order:{input:bt.GENERAL_PROGRESSION,output:gt.GENERAL_PROGRESSION},input:{enabled:Aa,params:{ExpertPlus:!0,Expert:!0,Hard:!0,Normal:!0,Easy:!0},html:U.createBlock(U.createBlock(U.createCheckbox(function(){uo.input.enabled=this.checked},Ra,Oa,Aa)),Mc)},output:{html:null},run:um};function um(i){var a,l,f,h,p,c,u,b;const{audioDuration:t}=i.settings;if(!t){uo.output.html=null;return}const e=lt.beatmapDifficulty.filter(d=>d.characteristic==="Standard").map(d=>d.swingAnalysis).filter(d=>uo.input.params[d.difficulty]&&d.total.total>0).sort((d,v)=>v.total.average-d.total.average);if(!e.length){uo.output.html=null;return}const o=Math.max(t<120?3.2:t<240?4.2:5.2,M(ka(e)*.4,2)),s=[];t<360&&Ba(e)>o&&(e.forEach(d=>d.total.average),s.push(Pt(`Minimum SPS not met (<${o})`,`lowest SPS is ${M(Ba(e),2)}, ${M(nm(e),2)}% drop from highest SPS (${M(ka(e),2)})`,"rank")));const n=om(e,o),r=sm(e,o);if(n&&t<360&&s.push(Pt("Violates progression",`${Bi[n.result.difficulty]} exceeded 40% SPS drop, ${M(n.result.total.average,2)} from ${M(((l=(a=n.comparedTo)==null?void 0:a.total)==null?void 0:l.average)||0,2)} ${Bi[n.comparedTo.difficulty]}, acceptable range (${M((((h=(f=n.comparedTo)==null?void 0:f.total)==null?void 0:h.average)||0)*.6,2)}-${M((((p=n.comparedTo)==null?void 0:p.total.average)||0)*.9,2)})`,"rank")),r&&t<360&&s.push(Pt("Violates progression",`${Bi[r.result.difficulty]} has less than 10% SPS drop, ${M(r.result.total.average,2)} from ${M(((c=r.comparedTo)==null?void 0:c.total.average)||0,2)} ${Bi[r.comparedTo.difficulty]}, acceptable range (${M((((u=r.comparedTo)==null?void 0:u.total.average)||0)*.6,2)}-${M((((b=r.comparedTo)==null?void 0:b.total.average)||0)*.9,2)})`,"rank")),s.length){const d=document.createElement("div");s.forEach(v=>d.append(v)),uo.output.html=d}else uo.output.html=null}const Ia=Object.freeze(Object.defineProperty({__proto__:null,aprilFools:mr,audio:fs,coverImage:hn,previewTime:fn,progression:uo},Symbol.toStringTag,{value:"Module"})),Pa="Acceptable Beat Precision",$a=`Validate note timing placement is within timing precision.
i.e: 1/8 1/6 1/x`,Ma=!0,Fa=[8,6],ko={name:Pa,description:$a,type:"note",order:{input:bt.NOTES_ACCEPTABLE_PRECISION,output:gt.NOTES_ACCEPTABLE_PRECISION},input:{enabled:Ma,params:{prec:[...Fa]},html:U.createBlock(U.createCheckbox(function(){ko.input.enabled=this.checked},Pa+": ",$a,Ma),U.createText(function(){ko.input.params.prec=this.value.trim().split(" ").map(i=>parseInt(i)).filter(i=>i>0?!Number.isNaN(i):!1),this.value=ko.input.params.prec.join(" ")},"",Fa.join(" ")))},output:{html:null},run:hm};function cm(i,t){const{bpm:e}=i,o=t.swingAnalysis.container,{prec:s}=ko.input.params;return o.map(n=>n.time).filter((n,r,a)=>!r||n!==a[r-1]).filter(n=>{if(!s.length)return!1;for(let r=0;r<s.length;r++)if((e.adjustTime(n)+.001)%(1/s[r])<.01)return!1;return!0})}function hm(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=cm(i.settings,i.difficulty);t.length?ko.output.html=mt("Off-beat precision",t,i.settings.bpm,"warning"):ko.output.html=null}const Ga="Color Check",ja="Compare note color with other colored note and the arrow on itself.",Ja=!0,Wa=[1,1,1],Xa={1:"Indistinguishable",5:"Hardly perceivable",10:"Close apparent",20:"Mildly similar",40:"Different",90:"Discernible",100:"Opposite"};function Ha(i,t){let e=Object.keys(i).find(s=>parseFloat(s)>=t)??"100",o=parseFloat(e);return i[o]}const pn={name:Ga,description:ja,type:"note",order:{input:bt.NOTES_COLOR_CHECK,output:gt.NOTES_COLOR_CHECK},input:{enabled:Ja,params:{},html:U.createBlock(U.createCheckbox(function(){pn.input.enabled=this.checked},Ga+" (EXPERIMENTAL)",ja,Ja))},output:{html:null},run:pm};function fm(i){var o,s,n,r;const t=((s=(o=i.difficulty)==null?void 0:o.info.customData)==null?void 0:s._colorLeft)??gi[bi[i.difficulty.environment]??"The First"]._colorLeft,e=((r=(n=i.difficulty)==null?void 0:n.info.customData)==null?void 0:r._colorRight)??gi[bi[i.difficulty.environment]??"The First"]._colorRight;return t&&e?lr(ei(t),ei(e)):100}function mm(i){var n,r,a,l;let t=100,e=100;const o=((r=(n=i.difficulty)==null?void 0:n.info.customData)==null?void 0:r._colorLeft)??gi[bi[i.difficulty.environment]??"The First"]._colorLeft,s=((l=(a=i.difficulty)==null?void 0:a.info.customData)==null?void 0:l._colorRight)??gi[bi[i.difficulty.environment]??"The First"]._colorRight;return o&&(t=lr(Wa,ei(o))),s&&(e=lr(Wa,ei(s))),Math.min(t,e)}function pm(i){var s,n,r,a;if(!((n=(s=i.difficulty)==null?void 0:s.info.customData)!=null&&n._colorLeft)&&!((a=(r=i.difficulty)==null?void 0:r.info.customData)!=null&&a._colorRight))return;const t=fm(i),e=mm(i),o=[];if(t<=20&&o.push(Pt(`${Ha(Xa,t)} note color (dE${M(t,1)})`,"suggest change to better differentiate between 2 note colour","warning")),e<=20&&o.push(Pt(`${Ha(Xa,e)} arrow note color (dE${M(e,1)})`,"may be difficult to see the arrow","warning")),o.length){const l=document.createElement("div");o.forEach(f=>l.append(f)),pn.output.html=l}else pn.output.html=null}const Ya="Double-directional",Va="Check double-directional note swing (this may not mean parity break).",za=!0,dn={name:Ya,description:Va,type:"note",order:{input:bt.NOTES_DOUBLE_DIRECTIONAL,output:gt.NOTES_DOUBLE_DIRECTIONAL},input:{enabled:za,params:{},html:U.createBlock(U.createCheckbox(function(){dn.input.enabled=this.checked},Ya,Va,za))},output:{html:null},run:bm};function dm(i,t){const{bpm:e}=i,o=t.noteContainer,s={},n={},r={},a={[nt.RED]:[],[nt.BLUE]:[]},l=[];for(let f=0,h=o.length;f<h;f++){const p=o[f];p.type==="note"&&s[p.data.color]?ni.next(p,s[p.data.color],e,a[p.data.color])?(r[p.data.color]&&(r[p.data.color]=null,n[p.data.color]=(n[p.data.color]+180)%360),Ts(p.data,n[p.data.color],45,!0)&&l.push(p.data),p.data.direction===R.ANY?r[p.data.color]=p.data:n[p.data.color]=p.data.getAngle(),a[p.data.color]=[]):(r[p.data.color]&&Ts(p.data,n[p.data.color],45,!0)&&(l.push(p.data),r[p.data.color]=null,n[p.data.color]=p.data.getAngle()),p.data.direction!==R.ANY&&(r[p.data.color]=null,n[p.data.color]=p.data.getAngle())):p.type==="note"&&(n[p.data.color]=p.data.getAngle()),p.type==="note"&&(s[p.data.color]=p,a[p.data.color].push(p)),p.type==="bomb"&&(p.data.posY===te.BOTTOM&&(p.data.posX===ut.MIDDLE_LEFT&&(n[nt.RED]=Si[R.UP],r[nt.RED]=null),p.data.posX===ut.MIDDLE_RIGHT&&(n[nt.BLUE]=Si[R.UP],r[nt.BLUE]=null)),p.data.posY===te.TOP&&(p.data.posX===ut.MIDDLE_LEFT&&(n[nt.RED]=Si[R.DOWN],r[nt.RED]=null),p.data.posX===ut.MIDDLE_RIGHT&&(n[nt.BLUE]=Si[R.DOWN],r[nt.BLUE]=null)))}return l.map(f=>f.time).filter(function(f,h,p){return!h||f!==p[h-1]})}function bm(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=dm(i.settings,i.difficulty);t.length?dn.output.html=mt("Double-directional",t,i.settings.bpm,"warning"):dn.output.html=null}const Ua="Effective BPM",qa=`Effective BPM is calculated by one hand making 1/2 precision movement relative to the BPM.
EBPM starts from previous end note to next start note (typically for sliders).
EBPM Swing starts from previous start note to next start note.`,Ka=!0,wr=450,Sr=350,Fc=U.createNumber(function(){Re.input.params.ebpmThres=M(Math.abs(parseFloat(this.value)),1),this.value=Re.input.params.ebpmThres.toString()},": ",wr,0),Gc=U.createNumber(function(){Re.input.params.ebpmsThres=M(Math.abs(parseFloat(this.value)),1),this.value=Re.input.params.ebpmsThres.toString()}," (swing): ",Sr,0),Re={name:Ua,description:qa,type:"note",order:{input:bt.NOTES_EFFECTIVE_BPM,output:gt.NOTES_EFFECTIVE_BPM},input:{enabled:Ka,params:{ebpmThres:wr,ebpmsThres:Sr},html:U.createBlock(U.createCheckbox(function(){Re.input.enabled=this.checked},Ua+" threshold",qa,Ka),Fc,Gc),adjustTime:gm},output:{html:null},run:ym};function gm(i){Re.input.params.ebpmThres=M(Math.min(wr,i.value*2*1.285714),1),Re.input.params.ebpmsThres=M(Math.min(Sr,i.value*2),1),Fc[1].value=Re.input.params.ebpmThres.toString(),Gc[1].value=Re.input.params.ebpmsThres.toString()}function vm(i){const{swingAnalysis:t}=i.difficulty;let{ebpmThres:e,ebpmsThres:o}=Re.input.params;e+=.001,o+=.001;const s=t.container.filter(r=>r.ebpm>e).map(r=>r.time),n=t.container.filter(r=>r.ebpmSwing>o).map(r=>r.time);return{base:s,swing:n}}function ym(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=vm(i),{ebpmThres:e,ebpmsThres:o}=Re.input.params,s=[];if(t.base.length&&s.push(mt(`>${e}EBPM warning`,t.base,i.settings.bpm,"warning")),t.swing.length&&s.push(mt(`>${o}EBPM (swing) warning`,t.swing,i.settings.bpm,"warning")),s.length){const n=document.createElement("div");s.forEach(r=>n.append(r)),Re.output.html=n}else Re.output.html=null}const Za="Hitbox Inline",Qa="Check for overlapping note hitbox for inline note.",tl=!0,bn={name:Za,description:Qa,type:"note",order:{input:bt.NOTES_HITBOX_INLINE,output:gt.NOTES_HITBOX_INLINE},input:{enabled:tl,params:{},html:U.createBlock(U.createCheckbox(function(){bn.input.enabled=this.checked},Za,Qa,tl))},output:{html:null},run:Em},_m=0;function Dm(i){const{bpm:t,njs:e}=i.settings,{noteContainer:o}=i.difficulty,s={},n={[nt.RED]:[],[nt.BLUE]:[]},r=[];for(let a=0,l=o.length;a<l;a++){if(o[a].type!=="note")continue;const f=o[a];s[f.data.color]&&ni.next(f,s[f.data.color],t,n[f.data.color])&&(n[f.data.color]=[]);for(const h of n[(f.data.color+1)%2])if(h.type==="note"&&e.value<1.425/(60*(f.data.time-h.data.time)/t.value+_m)&&f.data.isInline(h.data)){r.push(f);break}s[f.data.color]=f,n[f.data.color].push(f)}return r.map(a=>a.data.time).filter(function(a,l,f){return!l||a!==f[l-1]})}function Em(i){const t=Dm(i);t.length?bn.output.html=mt("Hitbox inline",t,i.settings.bpm,"rank"):bn.output.html=null}const el="Hitbox Path",il="Check for overlapping pre-swing note hitbox at same time.",ol=!0,gn={name:el,description:il,type:"note",order:{input:bt.NOTES_HITBOX_PATH,output:gt.NOTES_HITBOX_PATH},input:{enabled:ol,params:{},html:U.createBlock(U.createCheckbox(function(){gn.input.enabled=this.checked},el,il,ol))},output:{html:null},run:Sm};function wm(i){const{bpm:t}=i.settings,e=i.difficulty.noteContainer.filter(n=>n.type==="bomb"||n.type==="note"),o=[];let s=0;for(let n=0,r=e.length;n<r;n++){const a=e[n];if(!(a.type==="bomb"||a.type==="arc"||a.type==="chain"||t.toRealTime(a.data.time)<s+.01))for(let l=n+1;l<r;l++){const f=e[l];if(t.toRealTime(f.data.time)>t.toRealTime(a.data.time)+.01)break;f.type==="note"&&a.data.color===f.data.color||((a.data.isHorizontal(f.data)||a.data.isVertical(f.data))&&dr(a.data,f.data,[[45,1],[15,2]]).some(h=>h)||a.data.isDiagonal(f.data)&&dr(a.data,f.data,[[45,1],[15,1.5]]).some(h=>h))&&(o.push(a.data),s=t.toRealTime(a.data.time))}}return o.map(n=>n.time).filter(function(n,r,a){return!r||n!==a[r-1]})}function Sm(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=wm(i);t.length?gn.output.html=mt("Hitbox path",t,i.settings.bpm,"error"):gn.output.html=null}const sl="Hitbox Reverse Staircase",nl="Check for overlapping pre-swing hitbox with note hitbox during swing.",rl=!0,vn={name:sl,description:nl,type:"note",order:{input:bt.NOTES_HITBOX_REVERSE_STAIR,output:gt.NOTES_HITBOX_REVERSE_STAIR},input:{enabled:rl,params:{},html:U.createBlock(U.createCheckbox(function(){vn.input.enabled=this.checked},sl,nl,rl))},output:{html:null},run:Lm},Cm=.03414823529,xm=.03414823529;function Tm(i){const{bpm:t,njs:e}=i.settings,{noteContainer:o}=i.difficulty,s={},n={[nt.RED]:[],[nt.BLUE]:[]},r=[];for(let a=0,l=o.length;a<l;a++){if(o[a].type!=="note")continue;const f=o[a];s[f.data.color]&&ni.next(f,s[f.data.color],t,n[f.data.color])&&(n[f.data.color]=[]);for(const h of n[(f.data.color+1)%2])if(h.type==="note"&&h.data.direction!==R.ANY){if(!(t.toRealTime(f.data.time)>t.toRealTime(h.data.time)+.01))continue;const p=h.data.getAngle()%90>15&&h.data.getAngle()%90<75;if(e.value<1.425/(60*(f.data.time-h.data.time)/t.value+(p?xm:Cm))&&dr(f.data,h.data,[[15,1.5]])[1]){r.push(h);break}}s[f.data.color]=f,n[f.data.color].push(f)}return r.map(a=>a.data.time).filter(function(a,l,f){return!l||a!==f[l-1]})}function Lm(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=Tm(i);t.length?vn.output.html=mt("Hitbox reverse Staircase",t,i.settings.bpm,"rank"):vn.output.html=null}var le;let Ui=(le=class extends As{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??le.default.b,this._posX=t.posX??le.default.x,this._posY=t.posY??le.default.y,this._color=t.color??(t.type===0||t.type===1?t.type:le.default.c),this._direction=t.direction??le.default.d,this._angleOffset=t.angleOffset??le.default.a,this._customData=C(t.customData??le.default.customData)}static fromJSON(t={}){const e=new this;return e._time=t.b??le.default.b,e._posX=t.x??le.default.x,e._posY=t.y??le.default.y,e._color=t.c??le.default.c,e._direction=t.d??le.default.d,e._angleOffset=t.a??le.default.a,e._customData=C(t.customData??le.default.customData),e}toJSON(){return{b:this.time,c:this.color,x:this.posX,y:this.posY,d:this.direction,a:this.angleOffset,customData:C(this.customData)}}get type(){return this._color}set type(t){this._color=t}get customData(){return this._customData}set customData(t){this._customData=t}mirror(t=!0,e){return e&&(this.customData.coordinates&&(this.customData.coordinates[0]=-1-this.customData.coordinates[0]),this.customData.flip&&(this.customData.flip[0]=-1-this.customData.flip[0]),this.customData.animation&&(Array.isArray(this.customData.animation.definitePosition)&&(ne(this.customData.animation.definitePosition)?this.customData.animation.definitePosition[0]=-this.customData.animation.definitePosition[0]:this.customData.animation.definitePosition.forEach(o=>{Array.isArray(o)&&(o[0]=-o[0])})),Array.isArray(this.customData.animation.offsetPosition)&&(ne(this.customData.animation.offsetPosition)?this.customData.animation.offsetPosition[0]=-this.customData.animation.offsetPosition[0]:this.customData.animation.offsetPosition.forEach(o=>{Array.isArray(o)&&(o[0]=-o[0])})))),super.mirror(t)}getPosition(t){switch(t){case"vanilla":return super.getPosition();case"ne":if(this.customData.coordinates)return[this.customData.coordinates[0],this.customData.coordinates[1]];case"me":default:return[(this.posX<=-1e3?this.posX/1e3+1:this.posX>=1e3?this.posX/1e3-1:this.posX)-2,this.posY<=-1e3?this.posY/1e3:this.posY>=1e3?this.posY/1e3:this.posY]}}getAngle(t){switch(t){case"vanilla":case"ne":return super.getAngle();case"me":default:return this.direction>=1e3?Math.abs(this.direction%1e3%360-360):super.getAngle()}}isChroma(){return Array.isArray(this.customData.color)||typeof this.customData.spawnEffect=="boolean"||typeof this.customData.disableDebris=="boolean"}isNoodleExtensions(){return Array.isArray(this.customData.animation)||typeof this.customData.disableNoteGravity=="boolean"||typeof this.customData.disableNoteLook=="boolean"||typeof this.customData.disableBadCutDirection=="boolean"||typeof this.customData.disableBadCutSaberType=="boolean"||typeof this.customData.disableBadCutSpeed=="boolean"||Array.isArray(this.customData.flip)||typeof this.customData.uninteractable=="boolean"||Array.isArray(this.customData.localRotation)||typeof this.customData.noteJumpMovementSpeed=="number"||typeof this.customData.noteJumpStartBeatOffset=="number"||Array.isArray(this.customData.coordinates)||Array.isArray(this.customData.worldRotation)||typeof this.customData.worldRotation=="number"||typeof this.customData.link=="string"}},le.default={b:0,c:0,x:0,y:0,d:0,a:0,customData:{}},le);const al="Hitbox Staircase",ll="Check for overlapping post-swing hitbox with note hitbox during swing.",ul=!0,yn={name:al,description:ll,type:"note",order:{input:bt.NOTES_HITBOX_STAIR,output:gt.NOTES_HITBOX_STAIR},input:{enabled:ul,params:{},html:U.createBlock(U.createCheckbox(function(){yn.input.enabled=this.checked},al,ll,ul))},output:{html:null},run:km};function Nm(i,t,e){for(let o=e,s=t.length;o<s;o++)if(t[o].type==="note"){if(t[o].data.time<i.data.time+.01&&t[o].data.color!==i.data.color)return!0;if(t[o].data.time>i.data.time+.01)return!1}return!1}function Bm(i){const{bpm:t}=i.settings,{noteContainer:e}=i.difficulty,o=t.toBeatTime(.15),s={},n={},r={},a={[nt.RED]:[],[nt.BLUE]:[]},l={[nt.RED]:new Ui,[nt.BLUE]:new Ui({color:1})},f=[];for(let h=0,p=e.length;h<p;h++){if(e[h].type!=="note")continue;const c=e[h];s[c.data.color]?(ni.next(c,s[c.data.color],t,a[c.data.color])?(r[c.data.color]=c.data.time-s[c.data.color].data.time,c.data.direction!==R.ANY?(l[c.data.color].posX=c.data.posX+Yi[c.data.direction][0],l[c.data.color].posY=c.data.posY+Yi[c.data.direction][1]):(l[c.data.color].posX=-1,l[c.data.color].posY=-1),a[c.data.color]=[],n[c.data.color]=c.data.direction):$c(c.data,s[c.data.color].data,n[c.data.color])&&(c.data.direction!==R.ANY?(l[c.data.color].posX=c.data.posX+Yi[c.data.direction][0],l[c.data.color].posY=c.data.posY+Yi[c.data.direction][1],n[c.data.color]=c.data.direction):(l[c.data.color].posX=c.data.posX+Yi[n[c.data.color]][0],l[c.data.color].posY=c.data.posY+Yi[n[c.data.color]][1])),s[(c.data.color+1)%2]&&c.data.time-s[(c.data.color+1)%2].data.time!==0&&c.data.time-s[(c.data.color+1)%2].data.time<Math.min(o,r[(c.data.color+1)%2])&&c.data.posX===l[(c.data.color+1)%2].posX&&c.data.posY===l[(c.data.color+1)%2].posY&&!Nm(c,e,h)&&f.push(c)):(c.data.direction!==R.ANY?(l[c.data.color].posX=c.data.posX+Yi[c.data.direction][0],l[c.data.color].posY=c.data.posY+Yi[c.data.direction][1]):(l[c.data.color].posX=-1,l[c.data.color].posY=-1),n[c.data.color]=c.data.direction),s[c.data.color]=c,a[c.data.color].push(c)}return f.map(h=>h.data.time).filter(function(h,p,c){return!p||h!==c[p-1]})}function km(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=Bm(i);t.length?yn.output.html=mt("Hitbox staircase",t,i.settings.bpm,"rank"):yn.output.html=null}const cl="Improper Arc",hl="Check for correct use of arc.",fl=!0,_n={name:cl,description:hl,type:"note",order:{input:bt.NOTES_IMPROPER_ARC,output:gt.NOTES_IMPROPER_ARC},input:{enabled:fl,params:{},html:U.createBlock(U.createCheckbox(function(){_n.input.enabled=this.checked},cl,hl,fl))},output:{html:null},run:Om};function Rm(i){const t=[...i.difficulty.noteContainer].sort((o,s)=>o.type!=="arc"?1:s.type!=="arc"?-1:0).sort((o,s)=>o.data.time-s.data.time),e=[];for(let o=0,s=!0,n=t.length;o<n;o++){const r=t[o],a=t.at(-1).data.time;if(r.type==="arc"){s=!0;for(let l=o,f=!1;l<n;l++){const h=t[l];if(h.type==="note"&&r.data.posX===h.data.posX&&r.data.posY===h.data.posY&&h.data.time<=r.data.time+.001&&r.data.color===h.data.color&&(h.data.direction===R.ANY||r.data.direction===h.data.direction)){for(let p=l;p<n;p++){const c=t[l];if(c.type==="bomb"&&r.data.posX===c.data.posX&&r.data.posY===c.data.posY&&c.data.time<=r.data.time+.001){f=!0;break}if(!(c.type!=="note"||c.data.time<r.data.tailTime)){if(r.data.posX===h.data.posX&&r.data.posY===h.data.posY&&h.data.time<=r.data.time+.001&&(r.data.color!==h.data.color||(h.data.direction===R.ANY||r.data.direction!==h.data.direction))){f=!0;break}if(h.data.time>r.data.tailTime+.001)break}}s=f||!1;break}if(h.type==="bomb"&&r.data.posX===h.data.posX&&r.data.posY===h.data.posY&&h.data.time<=r.data.time+.001)break;if(h.data.time>r.data.time+.001){s=!1;break}(h.type==="arc"||h.type==="chain")&&h.data.time+.001>a&&(s=!1)}s&&e.push(r)}}return e.map(o=>o.data.time).filter(function(o,s,n){return!s||o!==n[s-1]})}function Om(i){const t=Rm(i);t.length?_n.output.html=mt("Improper arc",t,i.settings.bpm,"error"):_n.output.html=null}const ml="Improper Chain",pl="Check for correct use of chain.",dl=!0,Dn={name:ml,description:pl,type:"note",order:{input:bt.NOTES_IMPROPER_CHAIN,output:gt.NOTES_IMPROPER_CHAIN},input:{enabled:dl,params:{},html:U.createBlock(U.createCheckbox(function(){Dn.input.enabled=this.checked},ml,pl,dl))},output:{html:null},run:Im};function Am(i){const t=[...i.difficulty.noteContainer].sort((o,s)=>o.type!=="chain"?1:s.type!=="chain"?-1:0).sort((o,s)=>o.data.time-s.data.time),e=[];for(let o=0,s=!0,n=t.length;o<n;o++){const r=t[o];if(r.type==="chain"){s=!0;for(let a=o;a<n;a++){const l=t[a];if(l.type==="note"&&r.data.posX===l.data.posX&&r.data.posY===l.data.posY&&l.data.time<=r.data.time+.001&&r.data.color===l.data.color&&(l.data.direction===R.ANY||r.data.direction===l.data.direction)){s=!1;break}if(l.type==="bomb"&&r.data.posX===l.data.posX&&r.data.posY===l.data.posY&&l.data.time<=r.data.time+.001||l.data.time>r.data.time+.001)break}s&&e.push(r)}}return e.map(o=>o.data.time).filter(function(o,s,n){return!s||o!==n[s-1]})}function Im(i){const t=Am(i);t.length?Dn.output.html=mt("Improper chain",t,i.settings.bpm,"error"):Dn.output.html=null}const bl="Improper Window Snap",gl="Check for slanted window snap timing.",vl=!0,En={name:bl,description:gl,type:"note",order:{input:bt.NOTES_IMPROPER_WINDOW,output:gt.NOTES_IMPROPER_WINDOW},input:{enabled:vl,params:{},html:U.createBlock(U.createCheckbox(function(){En.input.enabled=this.checked},bl,gl,vl))},output:{html:null},run:$m};function Pm(i){const{bpm:t}=i.settings,{noteContainer:e}=i.difficulty,o={},s={[nt.RED]:[],[nt.BLUE]:[]},n=[];for(let r=0,a=e.length;r<a;r++){if(e[r].type!=="note")continue;const l=e[r];o[l.data.color]?ni.next(l,o[l.data.color],t,s[l.data.color])?(o[l.data.color]=l,s[l.data.color]=[]):l.data.isSlantedWindow(o[l.data.color].data)&&l.data.time-o[l.data.color].data.time>=.001&&l.data.direction===o[l.data.color].data.direction&&l.data.direction!==R.ANY&&o[l.data.color].data.direction!==R.ANY&&n.push(o[l.data.color]):o[l.data.color]=l,s[l.data.color].push(l)}return n.map(r=>r.data.time).filter(function(r,a,l){return!a||r!==l[a-1]})}function $m(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=Pm(i);t.length?En.output.html=mt("Improper window snap",t,i.settings.bpm,"error"):En.output.html=null}const yl="Inline Sharp Angle",_l="Check for angle changes within inline note.",Dl=!0,jc=.15;let es;const[Mm,Jc]=U.createNumber(function(){Ci.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=M(Ci.input.params.maxTime*1e3,1).toString(),es&&(Cr.value=M(es.toBeatTime(Ci.input.params.maxTime),2).toString())},"max time (ms): ",M(jc*1e3,1),0),[Fm,Cr]=U.createNumber(function(){if(!es){this.value="0";return}let i=M(Math.abs(parseFloat(this.value)),2)||1;Ci.input.params.maxTime=es.toRealTime(i),Jc.value=M(Ci.input.params.maxTime*1e3,1).toString(),this.value=i.toString()}," (beat): ",0,0,null,.1),Ci={name:yl,description:_l,type:"note",order:{input:bt.NOTES_INLINE_ANGLE,output:gt.NOTES_INLINE_ANGLE},input:{enabled:Dl,params:{maxTime:jc},html:U.createBlock(U.createCheckbox(function(){Ci.input.enabled=this.checked},yl,_l,Dl),document.createElement("br"),Mm,Jc,Fm,Cr),adjustTime:Gm},output:{html:null},run:Jm};function Gm(i){es=i,Cr.value=M(es.toBeatTime(Ci.input.params.maxTime),2).toString()}function jm(i){const{bpm:t}=i.settings,e=i.difficulty.noteContainer,{maxTime:o}=Ci.input.params,s=t.toBeatTime(o)+.001,n={},r={},a={},l={[nt.RED]:[],[nt.BLUE]:[]},f=[];let h=0;for(let p=0,c=e.length;p<c;p++){const u=e[p];u.type==="note"&&n[u.data.color]?ni.next(u,n[u.data.color],t,l[u.data.color])?(a[u.data.color]&&(a[u.data.color]=null,r[u.data.color]=(r[u.data.color]+180)%360),El(u.data,e,h,s)&&Ts(u.data,r[u.data.color],90,!0)&&f.push(u.data),u.data.direction===R.ANY?a[u.data.color]=u.data:r[u.data.color]=u.data.getAngle(),l[u.data.color]=[]):(a[u.data.color]&&El(u.data,e,h,s)&&Ts(u.data,r[u.data.color],90,!0)&&(f.push(a[u.data.color]),a[u.data.color]=null),u.data.direction!==R.ANY&&(r[u.data.color]=u.data.getAngle())):u.type==="note"&&(r[u.data.color]=u.data.getAngle()),u.type==="note"&&(n[u.data.color]=u,l[u.data.color].push(u)),u.type==="bomb"&&(u.data.posY===te.BOTTOM&&(u.data.posX===ut.MIDDLE_LEFT&&(r[nt.RED]=Si[R.UP],a[nt.RED]=null),u.data.posX===ut.MIDDLE_RIGHT&&(r[nt.BLUE]=Si[R.UP],a[nt.BLUE]=null)),u.data.posY===te.TOP&&(u.data.posX===ut.MIDDLE_LEFT&&(r[nt.RED]=Si[R.DOWN],a[nt.RED]=null),u.data.posX===ut.MIDDLE_RIGHT&&(r[nt.BLUE]=Si[R.DOWN],a[nt.BLUE]=null)))}return f.map(p=>p.time).filter(function(p,c,u){return!c||p!==u[c-1]})}function El(i,t,e,o){for(let s=e;t[s].data.time<i.time;s++){const n=t[s];if(n.type==="note"&&i.isInline(n.data)&&i.time-t[s].data.time<=o)return!0}return!1}function Jm(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=jm(i);t.length?Ci.output.html=mt("Inline sharp angle",t,i.settings.bpm,"warning"):Ci.output.html=null}const wl="One Saber",Sl="Check for one saber.",Cl=!0,ms={name:wl,description:Sl,type:"note",order:{input:bt.NOTES_ONE_SABER,output:gt.NOTES_ONE_SABER},input:{enabled:Cl,params:{},html:U.createBlock(U.createCheckbox(function(){ms.input.enabled=this.checked},wl,Sl,Cl))},output:{html:null},run:Wm};function Wm(i){let t,e=!1;if(i.difficulty.characteristic==="OneSaber"||i.difficulty.info.customData.oneSaber)t=i.difficulty.data.colorNotes.filter(s=>s.isRed()).map(s=>s.time);else{const s=i.difficulty.data.colorNotes.filter(r=>r.isBlue()).length>0,n=i.difficulty.data.colorNotes.filter(r=>r.isRed()).length>0;e=s?!n:n}t!=null&&t.length?ms.output.html=mt("Wrong One Saber Note",t,i.settings.bpm,"error"):e?ms.output.html=Pt("Unintended One Saber","One Saber gameplay outside of One Saber characteristic","rank"):ms.output.html=null}const Is={create:(i,t,e,o,...s)=>{const n=document.createElement(e);n.className=o;const r=document.createElement("select");r.className="input-toggle",r.id=i,s.forEach(l=>{const f=document.createElement("option");f.textContent=l.text,f.value=l.value,r.append(f)});const a=document.createElement("label");return a.htmlFor=i,a.innerHTML=`<span>${t}</span>`,n.append(a),n.append(r),n}};var Wc=(i=>(i.forehand="backhand",i.backhand="forehand",i))(Wc||{});const zs={[nt.RED]:{forehand:[R.DOWN,R.RIGHT,R.DOWN_LEFT,R.DOWN_RIGHT],backhand:[R.UP,R.LEFT,R.UP_LEFT,R.UP_RIGHT]},[nt.BLUE]:{forehand:[R.DOWN,R.LEFT,R.DOWN_LEFT,R.DOWN_RIGHT],backhand:[R.UP,R.RIGHT,R.UP_LEFT,R.UP_RIGHT]}},bo={[nt.RED]:[0,0,90,90,45,-45,45,-45],[nt.BLUE]:[0,0,-90,-90,-45,45,-45,45]},xl={0:{forehand:[180,0,-90,90,-135,135,-45,45],backhand:[0,180,90,-90,45,-45,135,-135]},1:{forehand:[-180,0,-90,90,-135,135,-45,45],backhand:[0,-180,90,-90,45,-45,135,-135]}},xo=class xo{constructor(t,e,o,s,n,r){this.color=e,this.warningThreshold=o,this.errorThreshold=s,this.allowedRotation=n,r&&r!=="neutral"?(this.state=r,this.rotation=0):(this.state=this.predictStartState(t,e),this.rotation=this.predictStartRotation(t,e)),this.position=this.predictStartPosition(t,e)}check(t,e){if(this.state==="neutral")return"none";if(!t.length)throw new Error("no notes were given");const o=t[0].data.time,s=this.color;let n=this.state,r=this.rotation;e.forEach(h=>{h.data.time-.001>o||(h.data.posY===te.BOTTOM&&h.data.posX===(s?ut.MIDDLE_RIGHT:ut.MIDDLE_LEFT)&&(n="backhand",r=0),h.data.posY===te.TOP&&h.data.posX===(s?ut.MIDDLE_RIGHT:ut.MIDDLE_LEFT)&&(n="forehand",r=0))});let a,l=R.ANY;for(const h of t)h.type==="note"&&(h.data.direction!==R.ANY&&(l=h.data.direction),a&&l===R.ANY&&(l=Na(h.data,a.data)),a=h);if(l===R.ANY)return"none";const f=xl[s][Wc[n]][l];return(r>f?r-f:f-r)>180||f<xo.CONSTRAINT_ROTATION[s][0]+this.errorThreshold||f>xo.CONSTRAINT_ROTATION[s][1]-this.errorThreshold?"error":f<xo.CONSTRAINT_ROTATION[s][0]+this.warningThreshold||f>xo.CONSTRAINT_ROTATION[s][1]-this.warningThreshold||(r>f?r-f:f-r)>this.allowedRotation?"warning":"none"}next(t,e){if(this.check(t,e)!=="error")switch(this.state){case"forehand":{this.state="backhand";break}case"backhand":{this.state="forehand";break}case"neutral":{for(let a=0;a<t.length;a++){if(t[a].type!=="note")continue;const l=t[a];if(zs[l.data.color].forehand.includes(l.data.direction)){this.state="backhand";break}if(zs[l.data.color].backhand.includes(l.data.direction)){this.state="forehand";break}this.state==="neutral"&&l.data.direction===R.ANY&&(l.data.posY===0&&(this.state="backhand"),l.data.posY>0&&(this.state="forehand"))}break}}if(this.state==="neutral")throw new Error("parity unexpected input");const o=t[0].data.time,s=this.color;e.forEach(a=>{a.data.time-.001>o||(a.data.posY===te.BOTTOM&&a.data.posX===(s?ut.MIDDLE_RIGHT:ut.MIDDLE_LEFT)&&(this.state="forehand",this.rotation=0),a.data.posY===te.TOP&&a.data.posX===(s?ut.MIDDLE_RIGHT:ut.MIDDLE_LEFT)&&(this.state="backhand",this.rotation=0))});let n,r=R.ANY;for(const a of t)a.type==="note"&&(a.data.direction!==R.ANY&&(r=a.data.direction),n&&r===R.ANY&&(r=Na(a.data,n.data)),n=a);r!==R.ANY&&(this.rotation=xl[this.color][this.state][r])}predictStartState(t,e){let o="neutral";for(let s=0,n=t.length;s<n;s++){if(t[s].type==="bomb"&&(t[s].data.posY===te.BOTTOM&&(t[s].data.posX===e?ut.MIDDLE_RIGHT:ut.MIDDLE_LEFT)&&(o="backhand"),t[s].data.posY===te.TOP&&(t[s].data.posX===e?ut.MIDDLE_RIGHT:ut.MIDDLE_LEFT)&&(o="forehand")),t[s].type!=="note")continue;let r=t[s];if(r.data.color!==Math.abs(e-1)&&r.data.color===e){if(o!=="neutral")break;const a=r.data.time;for(let l=s;l<t.length&&!(t[l].data.time>r.data.time+.001&&a<r.data.time+.001);l++){if(r=t[l],zs[r.data.color].forehand.includes(r.data.direction))return"backhand";if(zs[r.data.color].backhand.includes(r.data.direction))return"forehand";o==="neutral"&&r.data.direction===R.ANY&&(r.data.posY===te.BOTTOM&&(o="backhand"),r.data.posY>te.BOTTOM&&(o="forehand"))}break}}return o}predictStartRotation(t,e){let o=0;for(let s=0,n=t.length;s<n;s++){if(t[s].type!=="note")continue;let r=t[s];if(r.data.color===e&&r.data.color===e){const a=r.data.time;for(let l=s;l<t.length&&!(t[l].data.time>r.data.time+.001&&a<r.data.time+.001);l++){if(r=t[l],r.data.direction!==R.ANY)return bo[r.data.color][r.data.direction];r.data.direction===R.ANY&&(r.data.posY===te.BOTTOM&&(r.data.posX===ut.LEFT&&(o=bo[r.data.color][6]),r.data.posX===ut.RIGHT&&(o=bo[r.data.color][7])),r.data.posY===te.MIDDLE&&(r.data.posX===ut.LEFT&&(o=bo[r.data.color][2]),r.data.posX===ut.RIGHT&&(o=bo[r.data.color][3])),r.data.posY===te.BOTTOM&&(r.data.posX===ut.LEFT&&(o=bo[r.data.color][4]),r.data.posX===ut.RIGHT&&(o=bo[r.data.color][5])))}break}}return o}predictStartPosition(t,e){return e?[-.5,1]:[.5,1]}};xo.CONSTRAINT_ROTATION=[[-155,195],[-195,155]];let wn=xo;const Xc="Parity Check",Hc="Perform parity check.",Yc=!1,Vc=document.createElement("div");Is.create("input__tools-parity-rotation","Wrist rotation type: ","div","",{text:"Normal",value:"90"},{text:"Extended",value:"135"},{text:"Squid",value:"180"});Is.create("input__tools-parity-left","Left hand parity: ","div","",{text:"Auto",value:"auto"},{text:"Forehand",value:"forehand"},{text:"Backhand",value:"backhand"});Is.create("input__tools-parity-right","Right hand parity: ","div","",{text:"Auto",value:"auto"},{text:"Forehand",value:"forehand"},{text:"Backhand",value:"backhand"});Vc.appendChild(U.createBlock(U.createCheckbox(function(){Ls.input.enabled=this.checked},Xc+" (EXPERIMENTAL)",Hc,Yc)));const Ls={name:Xc,description:Hc,type:"note",order:{input:bt.NOTES_PARITY,output:gt.NOTES_PARITY},input:{enabled:Yc,params:{warningThres:90,errorThres:45,allowedRot:90},html:Vc},output:{html:null},run:Hm};function Xm(i){const{bpm:t}=i.settings,{noteContainer:e}=i.difficulty,{warningThres:o,errorThres:s,allowedRot:n}=Ls.input.params,r={},a={[nt.RED]:[],[nt.BLUE]:[]},l={[nt.RED]:[],[nt.BLUE]:[]},f={[nt.RED]:[],[nt.BLUE]:[]},h={[nt.RED]:new wn(e,0,o,s,n),[nt.BLUE]:new wn(e,1,o,s,n)},p={warning:[],error:[]};for(let c=0,u=e.length;c<u;c++){const b=e[c];if(b.type==="note"&&r[b.data.color]&&ni.next(b,r[b.data.color],t,a[b.data.color])){switch(h[b.data.color].check(a[b.data.color],f[b.data.color])){case"warning":{p.warning.push(a[b.data.color][0].data.time);break}case"error":{p.error.push(a[b.data.color][0].data.time);break}}h[b.data.color].next(a[b.data.color],f[b.data.color]),f[b.data.color]=l[b.data.color],l[b.data.color]=[],a[b.data.color]=[]}b.type==="bomb"&&(l[nt.RED].push(b),l[nt.BLUE].push(b)),b.type==="note"&&(r[b.data.color]=b,a[b.data.color].push(b))}for(let c=0;c<2;c++)if(r[c])switch(h[c].check(a[c],l[c])){case"warning":{p.warning.push(a[c][0].data.time);break}case"error":{p.error.push(a[c][0].data.time);break}}return p}function Hm(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=Xm(i);t.warning=t.warning.filter(function(o,s,n){return!s||o!==n[s-1]}).sort((o,s)=>o-s),t.error=t.error.filter(function(o,s,n){return!s||o!==n[s-1]}).sort((o,s)=>o-s);const e=[];if(t.warning.length&&e.push(mt("Parity warning",t.warning,i.settings.bpm,"warning")),t.error.length&&e.push(mt("Parity error",t.error,i.settings.bpm,"error")),e.length){const o=document.createElement("div");e.forEach(s=>o.append(s)),Ls.output.html=o}else Ls.output.html=null}const Tl="shrado Angle",Ll="Look for common negative curvature pattern.",Nl=!1,zc=.15,Ym=1;let is;const[Vm,Uc]=U.createNumber(function(){Ye.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=M(Ye.input.params.maxTime*1e3,1).toString(),is&&(xr.value=M(is.toBeatTime(Ye.input.params.maxTime),2).toString())},"max time (ms): ",M(zc*1e3,1),0),[zm,xr]=U.createNumber(function(){if(!is){this.value="0";return}let i=M(Math.abs(parseFloat(this.value)),2)||1;Ye.input.params.maxTime=is.toRealTime(i),Uc.value=M(Ye.input.params.maxTime*1e3,1).toString(),this.value=i.toString()}," (beat): ",0,0,null,.1),Ye={name:Tl,description:Ll,type:"note",order:{input:bt.NOTES_SHRADO_ANGLE,output:gt.NOTES_SHRADO_ANGLE},input:{enabled:Nl,params:{distance:Ym,maxTime:zc},html:U.createBlock(U.createCheckbox(function(){Ye.input.enabled=this.checked},Tl,Ll,Nl),document.createElement("br"),U.createNumber(function(){Ye.input.params.distance=Math.max(parseInt(this.value),0),this.value=Ye.input.params.distance.toString()},"min distance: ",0,0),document.createElement("br"),Vm,Uc,zm,xr),adjustTime:Um},output:{html:null},run:Km};function Um(i){is=i,xr.value=M(is.toBeatTime(Ye.input.params.maxTime),2).toString()}function qm(i){const{bpm:t}=i.settings,{noteContainer:e}=i.difficulty,{maxTime:o,distance:s}=Ye.input.params,n=t.toBeatTime(o)+.001,r={},a={},l={},f={[nt.RED]:[],[nt.BLUE]:[]},h=[];for(let p=0,c=e.length;p<c;p++){if(e[p].type!=="note")continue;const u=e[p];r[u.data.color]?ni.next(u,r[u.data.color],t,f[u.data.color])?(l[u.data.color]&&(l[u.data.color]=null,a[u.data.color]=tm[a[u.data.color]]??8),u.data.getDistance(r[u.data.color].data)>=s&&Bl(u.data.direction,a[u.data.color],u.data.color)&&u.data.time-r[u.data.color].data.time<=n&&h.push(u),u.data.direction===R.ANY?l[u.data.color]=u:a[u.data.color]=u.data.direction,f[u.data.color]=[]):(l[u.data.color]&&u.data.getDistance(r[u.data.color].data)>=s&&Bl(u.data.direction,a[u.data.color],u.data.color)&&u.data.time-r[u.data.color].data.time<=n&&(h.push(l[u.data.color]),l[u.data.color]=null),u.data.direction!==R.ANY&&(a[u.data.color]=u.data.direction)):a[u.data.color]=u.data.direction,r[u.data.color]=u,f[u.data.color].push(u)}return h.map(p=>p.data.time).filter(function(p,c,u){return!c||p!==u[c-1]})}function Bl(i,t,e){return i===8||t===8?!1:(e===0?t===7:t===6)&&i===0}function Km(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=qm(i);t.length?Ye.output.html=mt("Shrado angle",t,i.settings.bpm,"warning"):Ye.output.html=null}const kl="Slow Slider",Rl="Look for slider that require slow swing.",Ol=!0,qc=.025;let os;const[Zm,Kc]=U.createNumber(function(){ii.input.params.minSpeed=Math.abs(parseFloat(this.value))/1e3,this.value=M(ii.input.params.minSpeed*1e3,1).toString(),os&&(Tr.value=M(1/os.toBeatTime(ii.input.params.minSpeed),2).toString())},"min speed (ms): ",M(qc*1e3,1),0),[Qm,Tr]=U.createNumber(function(){if(!os){this.value="0";return}let i=M(Math.abs(parseFloat(this.value)),2)||1;ii.input.params.minSpeed=os.toRealTime(1/i),Kc.value=M(ii.input.params.minSpeed*1e3,1).toString(),this.value=i.toString()}," (prec): ",0,0),ii={name:kl,description:Rl,type:"note",order:{input:bt.NOTES_SLOW_SLIDER,output:gt.NOTES_SLOW_SLIDER},input:{enabled:Ol,params:{minSpeed:qc},html:U.createBlock(U.createCheckbox(function(){ii.input.enabled=this.checked},kl,Rl,Ol),document.createElement("br"),Zm,Kc,Qm,Tr),adjustTime:tp},output:{html:null},run:ip};function tp(i){os=i,Tr.value=M(1/os.toBeatTime(ii.input.params.minSpeed),2).toString()}function ep(i){const{swingAnalysis:t}=i.difficulty,{minSpeed:e}=ii.input.params;return t.container.filter(o=>o.maxSpeed>e||o.minSpeed>e).map(o=>o.time).filter((o,s,n)=>!s||o!==n[s-1])}function ip(i){if(!i.difficulty){console.error("Something went wrong!");return}const{minSpeed:t}=ii.input.params,e=ep(i);e.length?ii.output.html=mt(`Slow slider (>${M(t*1e3,1)}ms)`,e,i.settings.bpm,"warning"):ii.output.html=null}const Al="Speed Pause",Il="Look for stream/burst containing timing gap causing sudden change of pace.",Pl=!1,Zc=.075;let ss;const[op,Qc]=U.createNumber(function(){xi.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=M(xi.input.params.maxTime*1e3,1).toString(),ss&&(Lr.value=M(1/ss.toBeatTime(xi.input.params.maxTime),2).toString())},"stream speed (ms): ",M(Zc*1e3,1),0),[sp,Lr]=U.createNumber(function(){if(!ss){this.value="0";return}let t=M(Math.abs(parseFloat(this.value)),2)||1;xi.input.params.maxTime=ss.toRealTime(1/t),Qc.value=M(xi.input.params.maxTime*1e3,1).toString(),this.value=t.toString()}," (prec): ",0,0),xi={name:Al,description:Il,type:"note",order:{input:bt.NOTES_SPEED_PAUSE,output:gt.NOTES_SPEED_PAUSE},input:{enabled:Pl,params:{maxTime:Zc},html:U.createBlock(U.createCheckbox(function(){xi.input.enabled=this.checked},Al,Il,Pl),document.createElement("br"),op,Qc,sp,Lr),adjustTime:np},output:{html:null},run:ap};function np(i){ss=i,Lr.value=M(1/ss.toBeatTime(xi.input.params.maxTime),2).toString()}function rp(i,t){const{bpm:e}=i,{noteContainer:o}=t,{maxTime:s}=xi.input.params,n=e.toBeatTime(s)+.001,r={},a={},l={[nt.RED]:!1,[nt.BLUE]:!1},f={[nt.RED]:[],[nt.BLUE]:[]},h=[];for(let p=0,c=o.length;p<c;p++){if(o[p].type!=="note")continue;const u=o[p];r[u.data.color]?ni.next(u,r[u.data.color],e,f[u.data.color])&&(u.data.time-r[u.data.color].data.time<=n*2?(l[nt.RED]&&l[nt.BLUE]&&r[u.data.color].data.time-a[u.data.color].data.time<=n*3&&h.push(r[u.data.color]),l[u.data.color]=!1):l[u.data.color]||(l[u.data.color]=!0,a[u.data.color]=r[u.data.color]),f[u.data.color]=[],r[u.data.color]=u):r[u.data.color]=u,f[u.data.color].push(u)}return h.map(p=>p.data.time).filter(function(p,c,u){return!c||p!==u[c-1]})}function ap(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=rp(i.settings,i.difficulty);t.length?xi.output.html=mt("Speed pause",t,i.settings.bpm,"warning"):xi.output.html=null}const $l="Stacked Note",Ml="Look for stacked note.",Fl=!0,Sn={name:$l,description:Ml,type:"note",order:{input:bt.NOTES_STACKED_NOTE,output:gt.NOTES_STACKED_NOTE},input:{enabled:Fl,params:{},html:U.createBlock(U.createCheckbox(function(){Sn.input.enabled=this.checked},$l,Ml,Fl))},output:{html:null},run:cp};function lp(i,t){const{bpm:e}=i,{colorNotes:o}=t.data,s=[];let n=0;for(let r=0,a=o.length;r<a;r++)if(!(e.toRealTime(o[r].time)<n+.01))for(let l=r+1;l<a&&!(e.toRealTime(o[l].time)>e.toRealTime(o[r].time)+.01);l++)o[l].isInline(o[r])&&(s.push(o[r]),n=e.toRealTime(o[r].time));return s.map(r=>r.time).filter(function(r,a,l){return!a||r!==l[a-1]})}function up(i,t){const{bpm:e,njs:o}=i,{bombNotes:s}=t.data,n=[];for(let r=0,a=s.length;r<a;r++)for(let l=r+1;l<a&&!(e.toRealTime(s[l].time)>e.toRealTime(s[r].time)+1);l++)s[r].isInline(s[l])&&(o.value<e.value/(120*(s[l].time-s[r].time))||e.toRealTime(s[l].time)<e.toRealTime(s[r].time)+.02)&&n.push(s[r]);return n.map(r=>r.time).filter(function(r,a,l){return!a||r!==l[a-1]})}function cp(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=lp(i.settings,i.difficulty),e=up(i.settings,i.difficulty),o=[];if(t.length&&o.push(mt("Stacked note",t,i.settings.bpm,"error")),e.length&&o.push(mt("Stacked bomb",e,i.settings.bpm,"error")),o.length){const s=document.createElement("div");o.forEach(n=>s.append(n)),Sn.output.html=s}else Sn.output.html=null}const Gl="Varying Swing Speed",jl="Check for varying swing speed due to changes in slider distance.",Jl=!0,Cn={name:Gl,description:jl,type:"note",order:{input:bt.NOTES_VARY_SWING,output:gt.NOTES_VARY_SWING},input:{enabled:Jl,params:{},html:U.createBlock(U.createCheckbox(function(){Cn.input.enabled=this.checked},Gl,jl,Jl))},output:{html:null},run:fp};function hp(i){const{swingAnalysis:t}=i;return t.container.filter(e=>Math.abs(e.minSpeed-e.maxSpeed)>.002).map(e=>e.time).filter((e,o,s)=>!o||e!==s[o-1])}function fp(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=hp(i.difficulty);t.length?Cn.output.html=mt("Varying swing speed",t,i.settings.bpm,"error"):Cn.output.html=null}const Wl="Vision Block",Xl="Check for vision block caused by center note.",Hl=!0,th=.1,eh=.5;let Ve;const Yl={Easy:{min:.025,max:1.2},Normal:{min:.05,max:1},Hard:{min:.08,max:.75},Expert:{min:.1,max:.625},ExpertPlus:{min:.1,max:.5}},[mp,pp]=U.createRadio(oh," VB time specific ","vb-spec","time",!1),[dp,bp]=U.createRadio(oh," VB difficulty specific ","vb-spec","difficulty",!0),[gp,ih]=U.createNumber(function(){St.input.params.minTime=Math.abs(parseFloat(this.value))/1e3,this.value=M(St.input.params.minTime*1e3,1).toString(),Ve&&(Nr.value=M(Ve.toBeatTime(St.input.params.minTime),2).toString(),St.input.params.minTime>St.input.params.maxTime&&(St.input.params.maxTime=St.input.params.minTime,Wn.value=M(St.input.params.maxTime*1e3,1).toString(),Ps.value=M(Ve.toBeatTime(St.input.params.maxTime),2).toString()))},"min time (ms): ",M(th*1e3,1),0),[vp,Nr]=U.createNumber(function(){if(!Ve){this.value="0";return}const i=Math.abs(parseFloat(this.value))||1;St.input.params.minTime=Ve.toRealTime(i),ih.value=M(St.input.params.minTime*1e3,1).toString(),this.value=M(i,2).toString(),St.input.params.minTime>St.input.params.maxTime&&(St.input.params.maxTime=St.input.params.minTime,Wn.value=M(St.input.params.maxTime*1e3,1).toString(),Ps.value=M(Ve.toBeatTime(St.input.params.maxTime),2).toString())}," (beat): ",0,0,null,.1),[yp,Wn]=U.createNumber(function(){St.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=M(St.input.params.maxTime*1e3,1).toString(),Ve&&(Ps.value=M(Ve.toBeatTime(St.input.params.maxTime),2).toString())},"max time (ms): ",M(eh*1e3,1),0),[_p,Ps]=U.createNumber(function(){if(!Ve){this.value="0";return}const i=Math.abs(parseFloat(this.value))||1;St.input.params.maxTime=Ve.toRealTime(i),Wn.value=M(St.input.params.maxTime*1e3,1).toString(),this.value=M(i,2).toString()}," (beat): ",0,0,null,.1),St={name:Wl,description:Xl,type:"note",order:{input:bt.NOTES_VISION_BLOCK,output:gt.NOTES_VISION_BLOCK},input:{enabled:Hl,params:{specific:"difficulty",minTime:th,maxTime:eh},html:U.createBlock(U.createCheckbox(function(){St.input.enabled=this.checked},Wl,Xl,Hl),document.createElement("br"),pp,mp,bp,dp,document.createElement("br"),gp,ih,vp,Nr,document.createElement("br"),yp,Wn,_p,Ps),adjustTime:Dp},output:{html:null},run:wp};function Dp(i){Ve=i,Nr.value=M(Ve.toBeatTime(St.input.params.minTime),2).toString(),Ps.value=M(Ve.toBeatTime(St.input.params.maxTime),2).toString()}function oh(){St.input.params.specific=this.value}function Ep(i){const{bpm:t,njs:e}=i.settings,o=i.difficulty.data.getNoteContainer().filter(c=>c.type!=="arc"),{minTime:s,maxTime:n,specific:r}=St.input.params,a=r==="time"?t.toBeatTime(s):t.toBeatTime(Yl[i.difficulty.difficulty].min),l=r==="time"?t.toBeatTime(n):Math.min(e.hjd,t.toBeatTime(Yl[i.difficulty.difficulty].max));let f=null,h=null;const p=[];for(let c=0,u=o.length;c<u;c++){const b=o[c];f&&(b.data.time-f.data.time>=a&&b.data.time-f.data.time<=l?b.data.posX<ut.MIDDLE_RIGHT&&p.push(b):b.data.time-f.data.time>l&&(f=null)),h&&(b.data.time-h.data.time>=a&&b.data.time-h.data.time<=l?b.data.posX>ut.MIDDLE_LEFT&&p.push(b):b.data.time-h.data.time>l&&(h=null)),b.data.posY===te.MIDDLE&&b.data.posX===ut.MIDDLE_LEFT&&(f=b),b.data.posY===te.MIDDLE&&b.data.posX===ut.MIDDLE_RIGHT&&(h=b)}return p.map(c=>c.data.time).filter(function(c,u,b){return!u||c!==b[u-1]})}function wp(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=Ep(i);t.length?St.output.html=mt("Vision block",t,i.settings.bpm,"warning"):St.output.html=null}const Vl=Object.freeze(Object.defineProperty({__proto__:null,acceptablePrec:ko,colorCheck:pn,doubleDirectional:dn,effectiveBPM:Re,hitboxInline:bn,hitboxPath:gn,hitboxReverseStair:vn,hitboxStair:yn,improperArc:_n,improperChain:Dn,improperWindow:En,inlineAngle:Ci,oneSaber:ms,parity:Ls,shradoAngle:Ye,slowSlider:ii,speedPause:xi,stackedNote:Sn,varySwing:Cn,visionBlock:St},Symbol.toStringTag,{value:"Module"}));class Xn extends Jn{get duration(){return this._duration}set duration(t){this._duration=t}get width(){return this._width}set width(t){this._width=t}get height(){return this._height}set height(t){this._height=t}setDuration(t){return this.duration=t,this}setWidth(t){return this.width=t,this}setHeight(t){return this.height=t,this}mirror(t,e){return this.posX=jn-1-(this.posX+this.width-1),this}getPosition(t){return[this.posX-2,this.posY-.5]}isInteractive(t){return this.posX<0&&this.width>1-this.posX||this.posX===0&&this.width>1||this.posX===1||this.posX===2}isLonger(t,e=0,o){return this.time+this.duration>t.time+t.duration+e}hasZero(){return this.duration===0||this.width===0||this.height===0}hasNegative(){return this.posY<0||this.duration<0||this.width<0||this.height<0}isValid(){return!this.isMappingExtensions()&&!this.hasZero()&&!this.hasNegative()}}var Zt;let Ze=(Zt=class extends Xn{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??Zt.default.object.b,this._laneRotation=t.laneRotation??Zt.default.object.r,this._posX=t.posX??Zt.default.data.x,this._posY=t.posY??Zt.default.data.y,this._duration=t.duration??Zt.default.data.d,this._width=t.width??Zt.default.data.w,this._height=t.height??Zt.default.data.h,this._customData=C(t.customData??Zt.default.data.customData)}static fromJSON(t={},e={}){const o=new this;return o._time=t.b??Zt.default.object.b,o._laneRotation=t.r??Zt.default.object.r,o._posX=e.x??Zt.default.data.x,o._posY=e.y??Zt.default.data.y,o._duration=e.d??Zt.default.data.d,o._width=e.w??Zt.default.data.w,o._height=e.h??Zt.default.data.h,o._customData=C(e.customData??Zt.default.data.customData),o}toJSON(){return{object:{b:this.time,i:0,r:this.laneRotation,customData:{}},data:{x:this.posX,y:this.posY,d:this.duration,w:this.width,h:this.height,customData:C(this.customData)}}}get customData(){return this._customData}set customData(t){this._customData=t}mirror(t,e){var o;if(e){const s=((o=this.customData.size)==null?void 0:o[0])??this.width;this.customData.coordinates&&(this.customData.coordinates[0]=-1-this.customData.coordinates[0]),this.customData.animation&&(Array.isArray(this.customData.animation.definitePosition)&&(ne(this.customData.animation.definitePosition)?this.customData.animation.definitePosition[0]=-this.customData.animation.definitePosition[0]-(this.posX+s-1):this.customData.animation.definitePosition.forEach(n=>{Array.isArray(n)&&(n[0]=-n[0]-(this.posX+s-1))})),Array.isArray(this.customData.animation.offsetPosition)&&(ne(this.customData.animation.offsetPosition)?this.customData.animation.offsetPosition[0]=-this.customData.animation.offsetPosition[0]-(this.posX+s-1):this.customData.animation.offsetPosition.forEach(n=>{Array.isArray(n)&&(n[0]=-n[0]-(this.posX+s-1))})))}return super.mirror()}getPosition(t){switch(t){case"vanilla":return super.getPosition();case"ne":if(this.customData.coordinates)return[this.customData.coordinates[0],this.customData.coordinates[1]];case"me":default:return[(this.posX<=-1e3?this.posX/1e3+1:this.posX>=1e3?this.posX/1e3-1:this.posX)-2,(this.posY<=-1e3?this.posY/1e3:this.posY>=1e3?this.posY/1e3:this.posY)-.5]}}isChroma(){return Array.isArray(this.customData.color)}isNoodleExtensions(){return Array.isArray(this.customData.animation)||typeof this.customData.uninteractable=="boolean"||Array.isArray(this.customData.localRotation)||typeof this.customData.noteJumpMovementSpeed=="number"||typeof this.customData.noteJumpStartBeatOffset=="number"||Array.isArray(this.customData.coordinates)||Array.isArray(this.customData.worldRotation)||Array.isArray(this.customData.size)}isMappingExtensions(){return this.posY<0||this.posY>2||this.posX<=-1e3||this.posX>=1e3||this.width<=-1e3||this.width>=1e3||this.height<=-1e3||this.height>=1e3}},Zt.default={object:{b:0,i:0,r:0,customData:{}},data:{x:0,y:0,d:0,w:0,h:0,customData:{}}},Zt);const zl="<15ms Obstacle",Ul=`Look for obstacle with inadequate duration.
This causes player to not take damage when in collision with obstacle.`,ql=!0,Ns={name:zl,description:Ul,type:"obstacle",order:{input:bt.OBSTACLES_SHORT,output:gt.OBSTACLES_SHORT},input:{enabled:ql,params:{minDur:.015},html:U.createBlock(U.createCheckbox(function(){Ns.input.enabled=this.checked},zl,Ul,ql))},output:{html:null},run:Cp};function Sp(i){const{obstacles:t}=i.difficulty.data,{bpm:e}=i.settings,{minDur:o}=Ns.input.params,s=e.toBeatTime(o),n=[];let r=new Ze,a=new Ze,l=new Ze,f=new Ze;return t.forEach(h=>{h.posY===te.BOTTOM&&h.height>2&&h.duration>0?h.width>2||h.width>1&&h.posX===1?(h.isLonger(r)&&(h.duration<s&&n.push(h),r=h),h.isLonger(a)&&(h.duration<s&&n.push(h),a=h)):h.width===2?h.posX===ut.LEFT?h.isLonger(r)&&(h.duration<s&&n.push(h),r=h):h.posX===ut.MIDDLE_RIGHT&&h.isLonger(a)&&(h.duration<s&&n.push(h),a=h):h.width===1&&(h.posX===ut.MIDDLE_LEFT?h.isLonger(r)&&(h.duration<s&&n.push(h),r=h):h.posX===ut.MIDDLE_RIGHT&&h.isLonger(a)&&(h.duration<s&&n.push(h),a=h)):h.posY===te.TOP&&h.height>2&&h.duration>0&&(h.width>2||h.width>1&&h.posX===ut.MIDDLE_LEFT?(h.isLonger(l)&&(h.duration<s&&h.isLonger(r,s)&&h.isLonger(l,s)&&n.push(h),l=h),h.isLonger(f)&&(h.duration<s&&h.isLonger(a,s)&&h.isLonger(f,s)&&n.push(h),f=h)):h.width===2?h.posX===ut.LEFT?h.isLonger(l)&&(h.duration<s&&h.isLonger(r,s)&&h.isLonger(l,s)&&n.push(h),l=h):h.posX===ut.MIDDLE_RIGHT&&h.isLonger(f)&&(h.duration<s&&h.isLonger(a,s)&&h.isLonger(f,s)&&n.push(h),f=h):h.width===1&&(h.posX===ut.MIDDLE_LEFT?h.isLonger(l)&&(h.duration<s&&h.isLonger(r,s)&&h.isLonger(l,s)&&n.push(h),l=h):h.posX===ut.MIDDLE_RIGHT&&h.isLonger(f)&&(h.duration<s&&h.isLonger(a,s)&&h.isLonger(f,s)&&n.push(h),f=h)))}),n.map(h=>h.time).filter(function(h,p,c){return!p||h!==c[p-1]})}function Cp(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=Sp(i);t.length?Ns.output.html=mt("<15ms obstacle",t,i.settings.bpm,"warning"):Ns.output.html=null}const Kl="2-wide Center Obstacle",Zl="Look for 2-wide center obstacle including obstacles that are relatively close to each other.",Ql=!0,sh=.25;let ns;const[xp,nh]=U.createNumber(function(){oi.input.params.recovery=Math.abs(parseFloat(this.value))/1e3,this.value=M(oi.input.params.recovery*1e3,1).toString(),ns&&(Br.value=M(ns.toBeatTime(oi.input.params.recovery),2).toString())},"recovery time (ms): ",M(sh*1e3,1),0),[Tp,Br]=U.createNumber(function(){if(!ns){this.value="0";return}let i=M(Math.abs(parseFloat(this.value)),2)||1;oi.input.params.recovery=ns.toRealTime(i),nh.value=M(oi.input.params.recovery*1e3,1).toString(),this.value=i.toString()}," (beat): ",0,0,.1),oi={name:Kl,description:Zl,type:"obstacle",order:{input:bt.OBSTACLES_CENTER,output:gt.OBSTACLES_CENTER},input:{enabled:Ql,params:{recovery:sh},html:U.createBlock(U.createCheckbox(function(){oi.input.enabled=this.checked},Kl,Zl,Ql),document.createElement("br"),xp,nh,Tp,Br),adjustTime:Lp},output:{html:null},run:Bp};function Lp(i){ns=i,Br.value=M(ns.toBeatTime(oi.input.params.recovery),2).toString()}function Np(i){const{obstacles:t}=i.difficulty.data,{bpm:e}=i.settings,{recovery:o}=oi.input.params,s=[];let n=new Ze,r=new Ze;return t.forEach(a=>{a.posY<te.TOP&&a.height>1&&(a.width>2&&(s.push(a),a.isLonger(n)&&(n=a),a.isLonger(r)&&(r=a)),a.width===2&&(a.posX===ut.LEFT&&a.isLonger(n)&&(e.toRealTime(a.time)>e.toRealTime(r.time)-o&&e.toRealTime(a.time)<e.toRealTime(r.time+r.duration)+o&&s.push(a),n=a),a.posX===ut.MIDDLE_LEFT&&(s.push(a),a.isLonger(n)&&(n=a),a.isLonger(r)&&(r=a)),a.posX===ut.MIDDLE_RIGHT&&a.isLonger(r)&&(e.toRealTime(a.time)>e.toRealTime(n.time)-o&&e.toRealTime(a.time)<e.toRealTime(n.time+n.duration)+o&&s.push(a),r=a)),a.width===1&&(a.posX===ut.MIDDLE_LEFT&&a.isLonger(n)&&(e.toRealTime(a.time)>e.toRealTime(r.time)-o&&e.toRealTime(a.time)<e.toRealTime(r.time+r.duration)+o&&s.push(a),n=a),a.posX===ut.MIDDLE_RIGHT&&a.isLonger(r)&&(e.toRealTime(a.time)>e.toRealTime(n.time)-o&&e.toRealTime(a.time)<e.toRealTime(n.time+n.duration)+o&&s.push(a),r=a)))}),s.map(a=>a.time).filter(function(a,l,f){return!l||a!==f[l-1]})}function Bp(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=Np(i),{recovery:e}=oi.input.params;t.length?oi.output.html=mt(`2-wide center obstacle (<${M(e*1e3)}ms)`,t,i.settings.bpm,"error"):oi.output.html=null}const tu="Zero Obstacle",eu="Look for obstacle with zero value.",iu=!0,xn={name:tu,description:eu,type:"obstacle",order:{input:bt.OBSTACLES_ZERO,output:gt.OBSTACLES_ZERO},input:{enabled:iu,params:{},html:U.createBlock(U.createCheckbox(function(){xn.input.enabled=this.checked},tu,eu,iu))},output:{html:null},run:Rp};function kp(i){const{obstacles:t}=i.difficulty.data;return t.filter(e=>e.hasZero()).map(e=>e.time)}function Rp(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=kp(i);t.length?xn.output.html=mt("Zero value obstacle",t,i.settings.bpm,"error"):xn.output.html=null}const ou=Object.freeze(Object.defineProperty({__proto__:null,centerObstacle:oi,shortObstacle:Ns,zeroObstacle:xn},Symbol.toStringTag,{value:"Module"})),su="Insufficient Lighting Event",nu="Check if there is enough light event.",ru=!0,ps={name:su,description:nu,type:"event",order:{input:bt.EVENTS_INSUFFICIENT_LIGHT,output:gt.EVENTS_INSUFFICIENT_LIGHT},input:{enabled:ru,params:{},html:U.createBlock(U.createCheckbox(function(){ps.input.enabled=this.checked},su,nu,ru))},output:{html:null},run:Ap};function Op(i,t){let e=0;for(let o=i.length-1;o>=0;o--)if(i[o].isLightEvent(t)&&!i[o].isOff()&&(e++,e>10))return!0;return!1}function Ap(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=i.difficulty.environment;if(Op(i.difficulty.lightshow.basicEvents,t))ps.output.html=null;else switch(t){case"DefaultEnvironment":case"OriginsEnvironment":case"TriangleEnvironment":case"NiceEnvironment":case"BigMirrorEnvironment":case"DragonsEnvironment":case"KDAEnvironment":case"MonstercatEnvironment":case"CrabRaveEnvironment":case"PanicEnvironment":case"RocketEnvironment":case"GreenDayEnvironment":case"GreenDayGrenadeEnvironment":case"TimbalandEnvironment":case"FitBeatEnvironment":case"LinkinParkEnvironment":case"BTSEnvironment":case"KaleidoscopeEnvironment":case"InterscopeEnvironment":case"SkrillexEnvironment":case"BillieEnvironment":case"HalloweenEnvironment":case"GagaEnvironment":case"GlassDesertEnvironment":ps.output.html=Pt("Insufficient light event","","rank");break;default:ps.output.html=Pt("Unknown light event","v3 environment light should be manually checked","rank")}}const rh={Standard:"Standard",NoArrows:"No Arrows",OneSaber:"One Saber",Legacy:"Legacy","360Degree":"360 Degree","90Degree":"90 Degree",Lightshow:"Lightshow",Lawless:"Lawless"},au={Standard:0,NoArrows:1,OneSaber:2,Legacy:3,"360Degree":4,"90Degree":5,Lightshow:6,Lawless:7};function Vt(i,t){return i.time-t.time}function Us(i,t){return Array.isArray(i.customData.coordinates)&&Array.isArray(t.customData.coordinates)?i.time-t.time||i.customData.coordinates[0]-t.customData.coordinates[0]||i.customData.coordinates[1]-t.customData.coordinates[1]:Array.isArray(i.customData._position)&&Array.isArray(t.customData._position)?i.time-t.time||i.customData._position[0]-t.customData._position[0]||i.customData._position[1]-t.customData._position[1]:i.time-t.time||i.posX-t.posX||i.posY-t.posY}const lo=class lo{constructor(t,e=10,o=0){this._bpm=typeof t=="number"?new Gi(t):t,this._njs=e,this._sdm=o}static create(t,e,o){return new lo(t,e,o)}get value(){return this._njs}set value(t){this._njs=t}get offset(){return this._sdm}set offset(t){this._sdm=t}get hjd(){return this.calcHjd()}get jd(){return this.calcJd()}get reactionTime(){return this.calcRtFromHjd()}get bpm(){return this._bpm}calcHjd(t=this.offset){const o=60/this._bpm.value;let s=lo.HJD_START;for(;this._njs*o*s>17.999;)s/=2;return s<1&&(s=1),Math.max(s+t,lo.HJD_MIN)}calcHjdFromJd(t=this.calcJd()){return t/(60/this._bpm.value*this._njs*2)}calcHjdFromRt(t=this.calcRtFromHjd()){return t/(60/this._bpm.value)}calcJd(t=this.calcHjd()){return this._njs*(60/this._bpm.value)*t*2}calcJdOptimal(){return[-(18/(this._njs+1))+18,18*(1/1.07)**this._njs+18]}calcRtFromJd(t=this.calcJd()){return t/(2*this._njs)}calcRtFromHjd(t=this.calcHjd()){return 60/this._bpm.value*t}calcDistance(t){return this._njs*60/this._bpm.value*t*2}};lo.HJD_START=4,lo.HJD_MIN=.25,lo.FallbackNJS={ExpertPlus:16,Expert:12,Hard:10,Normal:10,Easy:10};let ji=lo;function ah(i,t){const e=lu(i),o=lu(t);for(const s in e){if(e[s]<o[s])return"old";if(e[s]>o[s])return"new"}return"current"}function lu(i){return i.replace("v","").split(".").map(t=>parseInt(t))}class lh extends Pc{constructor(){super(...arguments),this._tailLaneRotation=0}get tailTime(){return this._tailTime}set tailTime(t){this._tailTime=t}get tailPosX(){return this._tailPosX}set tailPosX(t){this._tailPosX=t}get tailPosY(){return this._tailPosY}set tailPosY(t){this._tailPosY=t}get tailLaneRotation(){return this._tailLaneRotation}set tailLaneRotation(t){this._tailLaneRotation=t}setTailTime(t){return this.tailTime=t,this}setTailPosX(t){return this.tailPosX=t,this}setTailPosY(t){return this.tailPosY=t,this}setTailLaneRotation(t){return this.tailLaneRotation=t,this}mirror(t=!0,e){return this.tailPosX=jn-1-this.tailPosX,super.mirror(t)}getTailPosition(t){return[this.tailPosX-2,this.tailPosY]}isInverse(){return this.time>this.tailTime}}class kr extends lh{get lengthMultiplier(){return this._lengthMultiplier}set lengthMultiplier(t){this._lengthMultiplier=t}get tailLengthMultiplier(){return this._tailLengthMultiplier}set tailLengthMultiplier(t){this._tailLengthMultiplier=t}get tailDirection(){return this._tailDirection}set tailDirection(t){this._tailDirection=t}get midAnchor(){return this._midAnchor}set midAnchor(t){this._midAnchor=t}setLengthMultiplier(t){return this.lengthMultiplier=t,this}setTailLengthMultiplier(t){return this.tailLengthMultiplier=t,this}setTailDirection(t){return this.tailDirection=t,this}setMidAnchor(t){return this.midAnchor=t,this}mirror(t=!0,e){switch(this.tailDirection){case 2:this.tailDirection=3;break;case 3:this.tailDirection=2;break;case 6:this.tailDirection=7;break;case 7:this.tailDirection=6;break;case 4:this.tailDirection=5;break;case 5:this.tailDirection=4;break}return this.midAnchor&&(this.midAnchor=this.midAnchor===1?2:1),super.mirror(t)}getTailAngle(t){return Si[this.tailDirection]||0}isMappingExtensions(){return this.posY>2||this.posY<0||this.posX<=-1e3||this.posX>=1e3||this.direction>=1e3&&this.direction<=1360||this.tailDirection>=1e3&&this.tailDirection<=1360}isValid(){return!(this.isMappingExtensions()||this.isInverse()||this.posX<0||this.posX>3||this.tailPosX<0||this.tailPosX>3||this.posX===this.tailPosX&&this.posY===this.tailPosY&&this.time===this.tailTime)}}class uh extends Jn{isMappingExtensions(){return this.posX>3||this.posX<0||this.posY>2||this.posY<0}isValid(){return!this.isMappingExtensions()}}class Ip extends Ti{get bpm(){return this._bpm}set bpm(t){this._bpm=t}setBPM(t){return this.bpm=t,this}isValid(){return this.bpm>0}}class ch extends lh{get sliceCount(){return this._sliceCount}set sliceCount(t){this._sliceCount=t}get squish(){return this._squish}set squish(t){this._squish=t}setSliceCount(t){return this.sliceCount=t,this}setSquish(t){return this.squish=t,this}isMappingExtensions(){return this.posY>2||this.posY<0||this.posX<=-1e3||this.posX>=1e3||this.direction>=1e3&&this.direction<=1360}isValid(){return!(this.isMappingExtensions()||this.isInverse()||this.posX<0||this.posX>3||this.tailPosX<0||this.tailPosX>3)&&!(this.posX===this.tailPosX&&this.posY===this.tailPosY)}}class hh extends Ti{get toggle(){return this._toggle}set toggle(t){this._toggle=t}setToggle(t){return this.toggle=t,this}isValid(){return!0}}class Hn extends $o{constructor(){super(...arguments),this._filename="UnnamedDifficulty.dat"}clone(){return super.clone().setFilename(this.filename)}set filename(t){this._filename=t.trim()}get filename(){return this._filename}setFilename(t){return this.filename=t,this}sort(){return this.bpmEvents.sort(Vt),this.rotationEvents.sort(Vt),this.colorNotes.sort(Us),this.bombNotes.sort(Us),this.obstacles.sort(Vt),this.arcs.sort(Us),this.chains.sort(Us),this.waypoints.sort(Vt),this.basicEvents.sort(Vt),this.colorBoostEvents.sort(Vt),this.lightColorEventBoxGroups.sort(Vt),this.lightRotationEventBoxGroups.sort(Vt),this.lightTranslationEventBoxGroups.sort(Vt),this.fxEventBoxGroups.sort(Vt),this.lightColorEventBoxGroups.forEach(t=>t.boxes.forEach(e=>e.events.sort(Vt))),this.lightRotationEventBoxGroups.forEach(t=>t.boxes.forEach(e=>e.events.sort(Vt))),this.lightTranslationEventBoxGroups.forEach(t=>t.boxes.forEach(e=>e.events.sort(Vt))),this}createOrKeep(t,e,o){return o&&e instanceof t?e:new t(e)}checkClass(t,e){return e instanceof t}nps(t){const e=this.getNoteContainer().filter(o=>o.type!=="bomb");return t?e.length/t:0}peak(t,e){let o=0,s=0;e=typeof e=="number"?new Gi(e):e;const n=this.getNoteContainer().filter(r=>r.type!=="bomb");for(let r=0;r<n.length;r++){for(;n[r].data.time-n[s].data.time>t;)s++;o=Math.max(o,(r-s+1)/e.toRealTime(t))}return o}getFirstInteractiveTime(){const t=this.getNoteContainer().filter(s=>s.type!=="arc");let e=Number.MAX_VALUE;t.length>0&&(e=t[0].data.time);const o=this.findFirstInteractiveObstacleTime();return Math.min(e,o)}getLastInteractiveTime(){const t=this.getNoteContainer().filter(s=>s.type!=="arc");let e=0;t.length>0&&(e=t[t.length-1].data.time);const o=this.findLastInteractiveObstacleTime();return Math.max(e,o)}findFirstInteractiveObstacleTime(){for(let t=0,e=this.obstacles.length;t<e;t++)if(this.obstacles[t].isInteractive())return this.obstacles[t].time;return Number.MAX_VALUE}findLastInteractiveObstacleTime(){let t=0;for(let e=this.obstacles.length-1;e>=0;e--)this.obstacles[e].isInteractive()&&(t=Math.max(t,this.obstacles[e].time+this.obstacles[e].duration));return t}getNoteContainer(){const t=[];return this.colorNotes.forEach(e=>t.push({type:"note",data:e})),this.arcs.forEach(e=>t.push({type:"arc",data:e})),this.chains.forEach(e=>t.push({type:"chain",data:e})),this.bombNotes.forEach(e=>t.push({type:"bomb",data:e})),t.sort((e,o)=>e.data.time-o.data.time)}getEventContainer(){const t=[];return this.basicEvents.forEach(e=>t.push({type:"basicEvent",data:e})),this.colorBoostEvents.forEach(e=>t.push({type:"boost",data:e})),t.sort((e,o)=>e.data.time-o.data.time)}}class Yn extends Ti{get type(){return this._type}set type(t){this._type=t}get value(){return this._value}set value(t){this._value=t}get floatValue(){return this._floatValue}set floatValue(t){this._floatValue=t}setType(t){return this.type=t,this}setValue(t){return this.value=t,this}setFloatValue(t){return this.floatValue=t,this}isOff(){return this.value===0}isOn(){return this.value===1||this.value===5||this.value===9}isFlash(){return this.value===2||this.value===6||this.value===10}isFade(){return this.value===3||this.value===7||this.value===11}isTransition(){return this.value===4||this.value===8||this.value===12}isBlue(){return this.value===1||this.value===2||this.value===3||this.value===4}isRed(){return this.value===5||this.value===6||this.value===7||this.value===8}isWhite(){return this.value===9||this.value===10||this.value===11||this.value===12}isLightEvent(t){switch(t){case"LizzoEnvironment":return this.type===0||this.type===1||this.type===2||this.type===3||this.type===4||this.type===6||this.type===7||this.type===8||this.type===9||this.type===10||this.type===11||this.type===12;default:return this.type===0||this.type===1||this.type===2||this.type===3||this.type===4||this.type===6||this.type===7||this.type===10||this.type===11}}isColorBoost(){return this.type===5}isRingEvent(t){switch(t){case"LizzoEnvironment":return!1;default:return this.type===8||this.type===9}}isLaserRotationEvent(t){switch(t){case"LizzoEnvironment":return!1;default:return this.type===12||this.type===13}}isLaneRotationEvent(t){return this.type===14||this.type===15}isExtraEvent(t){return this.type===16||this.type===17||this.type===18||this.type===19}isSpecialEvent(t){return this.type===40||this.type===41||this.type===42||this.type===43}isBpmEvent(){return this.type===100}isLightingEvent(t){return this.isLightEvent(t)||this.isRingEvent(t)||this.isLaserRotationEvent(t)||this.isExtraEvent(t)}isOldChroma(){return this.value>=2e9}isValidType(){return this.type>=0&&this.type<=19||this.type>=40&&this.type<=43||this.type===100}isValid(){return this.isValidType()&&this.value>=0&&!(!this.isLaserRotationEvent()&&this.value>12&&!this.isOldChroma())}}class Vn extends $o{get filter(){return this._filter}set filter(t){this._filter=t}get beatDistribution(){return this._beatDistribution}set beatDistribution(t){this._beatDistribution=t}get beatDistributionType(){return this._beatDistributionType}set beatDistributionType(t){this._beatDistributionType=t}get easing(){return this._easing}set easing(t){this._easing=t}get affectFirst(){return this._affectFirst}set affectFirst(t){this._affectFirst=t}get events(){return this._events}set events(t){this._events=t}setFilter(t){return this.filter=t,this}setBeatDistribution(t){return this.beatDistribution=t,this}setBeatDistributionType(t){return this.beatDistributionType=t,this}setEasing(t){return this.easing=t,this}setAffectFirst(t){return this.affectFirst=t,this}isValid(){return(this.beatDistributionType===1||this.beatDistributionType===2)&&this.easing>=0&&this.easing<=3&&this.events.every(t=>typeof t=="number"||t.isValid())&&this.filter.isValid()}}class zn extends Ti{get id(){return this._id}set id(t){this._id=t}get boxes(){return this._boxes}set boxes(t){this._boxes=t}isValid(){return this.id>=0&&this.boxes.every(t=>t.isValid())}}class fh extends Er{get keyword(){return this._keyword}set keyword(t){this._keyword=t}get events(){return this._events}set events(t){this._events=t}setKeyword(t){return this.keyword=t,this}setEvents(t){return this.events=t,this}addEvent(t){return this.events.push(t),this}removeEvent(t){const e=this.events.indexOf(t,0);return e>-1&&this.events.splice(e,1),this}}class Un extends Er{get list(){return this._list}set list(t){this._list=t}setList(t){return this.list=t,this}removeData(t){return this.list=this.list.filter(e=>e.keyword!==t),this}}class mh extends Vn{get fxDistribution(){return this._fxDistribution}set fxDistribution(t){this._fxDistribution=t}get fxDistributionType(){return this._fxDistributionType}set fxDistributionType(t){this._fxDistributionType=t}get events(){return this._events}set events(t){this._events=t}setFxDistribution(t){return this.fxDistribution=t,this}setFxDistributionType(t){return this.fxDistributionType=t,this}isValid(){return super.isValid()&&(this.fxDistributionType===1||this.fxDistributionType===2)&&(this.affectFirst===0||this.affectFirst===1)}}class ph extends zn{get boxes(){return this._boxes}set boxes(t){this._boxes=t}}class dh extends Ti{get easing(){return this._easing}set easing(t){this._easing=t}get previous(){return this._previous}set previous(t){this._previous=t}get value(){return this._value}set value(t){this._value=t}setEasing(t){return this.easing=t,this}setPrevious(t){return this.previous=t,this}setValue(t){return this.value=t,this}isValid(){return(this.previous===0||this.previous===1)&&this.easing>=-1&&this.easing<=103}}class Pp extends Ti{get previous(){return this._previous}set previous(t){this._previous=t}get value(){return this._value}set value(t){this._value=t}setPrevious(t){return this.previous=t,this}setValue(t){return this.value=t,this}isValid(){return this.previous===0||this.previous===1}}class bh extends $o{get type(){return this._type}set type(t){this._type=t}get p0(){return this._p0}set p0(t){this._p0=t}get p1(){return this._p1}set p1(t){this._p1=t}get reverse(){return this._reverse}set reverse(t){this._reverse=t}get chunks(){return this._chunks}set chunks(t){this._chunks=t}get limit(){return this._limit}set limit(t){this._limit=t}get limitAffectsType(){return this._limitAffectsType}set limitAffectsType(t){this._limitAffectsType=t}get random(){return this._random}set random(t){this._random=t}get seed(){return this._seed}set seed(t){this._seed=t}setType(t){return this.type=t,this}setP0(t){return this.p0=t,this}setP1(t){return this.p1=t,this}setReverse(t){return this.reverse=t,this}setChunks(t){return this.chunks=t,this}setRandom(t){return this.random=t,this}setSeed(t){return this.seed=t,this}setLimit(t){return this.limit=t,this}setLimitAffectsType(t){return this.limitAffectsType=t,this}isValid(){return(this.type===1||this.type===2)&&this.p0>=0&&this.p1>=0&&(this.reverse===0||this.reverse===1)&&this.chunks>=0&&this.random>=0&&this.random<=Ac.ALL&&this.limit>=0&&this.limit<=0&&this.limitAffectsType>=0&&this.limitAffectsType<=Oc.ALL}}class Rr extends $o{constructor(){super(...arguments),this._filename="Info.dat"}clone(){return super.clone().setFilename(this.filename)}set filename(t){this._filename=t.trim()}get filename(){return this._filename}setFilename(t){return this.filename=t,this}sort(){return this.difficulties.sort((t,e)=>mn[t.difficulty]-mn[e.difficulty]).sort((t,e)=>(au[t.characteristic]||0)-(au[e.characteristic]||0)),this}listMap(){return this.difficulties.map(t=>[t.characteristic,t])}}class Or extends $o{}class gh extends Ti{constructor(){super(...arguments),this._easing=0}get previous(){return this._previous}set previous(t){this._previous=t}get transition(){return this._transition}set transition(t){this._transition=t}get color(){return this._color}set color(t){this._color=t}get brightness(){return this._brightness}set brightness(t){this._brightness=t}get frequency(){return this._frequency}set frequency(t){this._frequency=t}get strobeBrightness(){return this._strobeBrightness}set strobeBrightness(t){this._strobeBrightness=t}get strobeFade(){return this._strobeFade}set strobeFade(t){this._strobeFade=t}get easing(){return this._easing}set easing(t){this._easing=t}setPrevious(t){return this.previous=t,this}setTransition(t){return this.transition=t,this}setColor(t){return this.color=t,this}setBrightness(t){return this.brightness=t,this}setFrequency(t){return this.frequency=t,this}setStrobeBrightness(t){return this.strobeBrightness=t,this}setStrobeFade(t){return this.strobeFade=t,this}setEasing(t){return this.easing=t,this}isValid(){return(this.previous===0||this.previous===1)&&this.easing>=-1&&this.easing<=103&&this.transition>=0&&this.transition<=2&&this.color>=-1&&this.color<=2&&this.brightness>=0&&this.frequency>=0}}class vh extends Vn{get brightnessDistribution(){return this._brightnessDistribution}set brightnessDistribution(t){this._brightnessDistribution=t}get brightnessDistributionType(){return this._brightnessDistributionType}set brightnessDistributionType(t){this._brightnessDistributionType=t}get events(){return this._events}set events(t){this._events=t}setBrightnessDistribution(t){return this.brightnessDistribution=t,this}setBrightnessDistributionType(t){return this.brightnessDistributionType=t,this}isValid(){return super.isValid()&&(this.brightnessDistributionType===1||this.brightnessDistributionType===2)&&(this.affectFirst===0||this.affectFirst===1)}}class yh extends zn{get boxes(){return this._boxes}set boxes(t){this._boxes=t}}class _h extends Ti{get previous(){return this._previous}set previous(t){this._previous=t}get easing(){return this._easing}set easing(t){this._easing=t}get loop(){return this._loop}set loop(t){this._loop=t}get rotation(){return this._rotation}set rotation(t){this._rotation=t}get direction(){return this._direction}set direction(t){this._direction=t}setPrevious(t){return this.previous=t,this}setEasing(t){return this.easing=t,this}setLoop(t){return this.loop=t,this}setRotation(t){return this.rotation=t,this}setDirection(t){return this.direction=t,this}isValid(){return(this.previous===0||this.previous===1)&&this.easing>=-1&&this.easing<=103&&(this.loop===0||this.loop===1)&&this.direction>=0&&this.direction<=2}}class Dh extends Vn{get rotationDistribution(){return this._rotationDistribution}set rotationDistribution(t){this._rotationDistribution=t}get rotationDistributionType(){return this._rotationDistributionType}set rotationDistributionType(t){this._rotationDistributionType=t}get axis(){return this._axis}set axis(t){this._axis=t}get flip(){return this._flip}set flip(t){this._flip=t}get events(){return this._events}set events(t){this._events=t}setRotationDistribution(t){return this.rotationDistribution=t,this}setRotationDistributionType(t){return this.rotationDistributionType=t,this}setAxis(t){return this.axis=t,this}setFlip(t){return this.flip=t,this}isValid(){return super.isValid()&&(this.rotationDistributionType===1||this.rotationDistributionType===2)&&(this.axis===0||this.axis===1)&&(this.flip===0||this.flip===1)&&(this.affectFirst===0||this.affectFirst===1)}}class Eh extends zn{get boxes(){return this._boxes}set boxes(t){this._boxes=t}}class wh extends $o{constructor(){super(...arguments),this._filename="UnnamedLightshow.dat"}clone(){return super.clone().setFilename(this.filename)}set filename(t){this._filename=t.trim()}get filename(){return this._filename}setFilename(t){return this.filename=t,this}sort(){return this.basicEvents.sort(Vt),this.colorBoostEvents.sort(Vt),this.lightColorEventBoxGroups.sort(Vt),this.lightRotationEventBoxGroups.sort(Vt),this.lightTranslationEventBoxGroups.sort(Vt),this.fxEventBoxGroups.sort(Vt),this.lightColorEventBoxGroups.forEach(t=>t.boxes.forEach(e=>e.events.sort(Vt))),this.lightRotationEventBoxGroups.forEach(t=>t.boxes.forEach(e=>e.events.sort(Vt))),this.lightTranslationEventBoxGroups.forEach(t=>t.boxes.forEach(e=>e.events.sort(Vt))),this}createOrKeep(t,e,o){return o&&e instanceof t?e:new t(e)}checkClass(t,e){return e instanceof t}getEventContainer(){const t=[];return this.basicEvents.forEach(e=>t.push({type:"basicEvent",data:e})),this.colorBoostEvents.forEach(e=>t.push({type:"boost",data:e})),t.sort((e,o)=>e.data.time-o.data.time)}}class Sh extends Ti{get previous(){return this._previous}set previous(t){this._previous=t}get easing(){return this._easing}set easing(t){this._easing=t}get translation(){return this._translation}set translation(t){this._translation=t}setPrevious(t){return this.previous=t,this}setEasing(t){return this.easing=t,this}setTranslation(t){return this.translation=t,this}isValid(){return(this.previous===0||this.previous===1)&&this.easing>=-1&&this.easing<=103}}class Ch extends Vn{get gapDistribution(){return this._translationDistribution}set gapDistribution(t){this._translationDistribution=t}get gapDistributionType(){return this._translationDistributionType}set gapDistributionType(t){this._translationDistributionType=t}get axis(){return this._axis}set axis(t){this._axis=t}get flip(){return this._flip}set flip(t){this._flip=t}get events(){return this._events}set events(t){this._events=t}setGapDistribution(t){return this.gapDistribution=t,this}setGapDistributionType(t){return this.gapDistributionType=t,this}setAxis(t){return this.axis=t,this}setFlip(t){return this.flip=t,this}isValid(){return super.isValid()&&(this.gapDistributionType===1||this.gapDistributionType===2)&&(this.axis===0||this.axis===1)&&(this.flip===0||this.flip===1)&&(this.affectFirst===0||this.affectFirst===1)}}class xh extends zn{get boxes(){return this._boxes}set boxes(t){this._boxes=t}}class Th extends Ti{get executionTime(){return this._executionTime}set executionTime(t){this._executionTime=t}get rotation(){return this._rotation}set rotation(t){this._rotation=t}setExecutionTime(t){return this.executionTime=t,this}setRotation(t){return this.rotation=t,this}isValid(){return this.executionTime===0||this.executionTime===1}}class Ar extends Jn{get direction(){return this._direction}set direction(t){this._direction=t}setDirection(t){return this.direction=t,this}mirror(t,e){switch(this.posX=jn-1-this.posX,this.direction){case 2:this.direction=3;break;case 3:this.direction=2;break;case 6:this.direction=7;break;case 7:this.direction=6;break;case 4:this.direction=5;break;case 5:this.direction=4;break}return this}isValid(){return this.direction>=0&&this.direction<=9&&this.direction!==8}}function uu(i){return["beatmap","v1","note",i]}var Te;let go=(Te=class extends As{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??Te.default._time,this._posX=t.posX??Te.default._lineIndex,this._posY=t.posY??Te.default._lineLayer,this._type=t.type??t.color??Te.default._type,this._direction=t.direction??Te.default._cutDirection}static fromJSON(t={}){const e=new this;return e._time=t._time??Te.default._time,e._posX=t._lineIndex??Te.default._lineIndex,e._posY=t._lineLayer??Te.default._lineLayer,e._type=t._type??Te.default._type,e._direction=t._cutDirection??Te.default._cutDirection,e}toJSON(){return{_time:this.time,_type:this.type,_lineIndex:this.posX,_lineLayer:this.posY,_cutDirection:this.direction}}get color(){return this._type}set color(t){this._type=t}get angleOffset(){return 0}set angleOffset(t){W.tWarn(uu("customData"),"Note angle offset does not exist in beatmap V1")}get customData(){return{}}set customData(t){W.tWarn(uu("customData"),"Note custom data does not exist in beatmap V1")}getPosition(t){switch(t){case"vanilla":case"ne":return super.getPosition();case"me":default:return[(this.posX<=-1e3?this.posX/1e3+1:this.posX>=1e3?this.posX/1e3-1:this.posX)-2,this.posY<=-1e3?this.posY/1e3:this.posY>=1e3?this.posY/1e3:this.posY]}}getAngle(t){switch(t){case"vanilla":case"ne":return super.getAngle(t);case"me":default:return this.direction>=1e3?Math.abs(this.direction%1e3%360-360):super.getAngle()}}},Te.default={_time:0,_lineIndex:0,_lineLayer:0,_type:0,_cutDirection:0},Te);function $p(i){return["beatmap","v1","obstacle",i]}var ve;let Jo=(ve=class extends Xn{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??ve.default._time,t instanceof ve?this._type=t.type??ve.default._type:this._type=t.posY===2&&t.height===3?1:t.posY===0&&t.height===5?0:ve.default._type,this._posX=t.posX??ve.default._lineIndex,this._duration=t.duration??ve.default._duration,this._width=t.width??ve.default._width}static fromJSON(t={}){const e=new this;return e._time=t._time??ve.default._time,e._type=t._type??ve.default._type,e._posX=t._lineIndex??ve.default._lineIndex,e._duration=t._duration??ve.default._duration,e._width=t._width??ve.default._width,e}toJSON(){return{_time:this.time,_type:this.type,_lineIndex:this.posX,_duration:this.duration,_width:this.width}}get type(){return this._type}set type(t){this._type=t}get posY(){return this.type==1?2:0}set posY(t){switch(t){case 2:this.type=1;break;default:this.type=0}}get height(){return this.type==1?3:5}set height(t){switch(t){case 3:this.type=1;break;default:this.type=0}}get customData(){return{}}set customData(t){W.tWarn($p("customData"),"Obstacle custom data does not exist in beatmap V1")}getPosition(t){switch(t){case"vanilla":case"ne":return super.getPosition();case"me":default:return[(this.posX<=-1e3?this.posX/1e3+1:this.posX>=1e3?this.posX/1e3-1:this.posX)-2,(this.posY<=-1e3?this.posY/1e3:this.posY>=1e3?this.posY/1e3:this.posY)-.5]}}isMappingExtensions(){return this.type>1||this.posX<0||this.posX>3||this.width<0||this.width>3}},ve.default={_time:0,_lineIndex:0,_type:0,_duration:0,_width:0},ve);function cu(i){return["beatmap","v1","event",i]}var vi;let Vi=(vi=class extends Yn{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??vi.default._time,this._type=t.type??vi.default._type,this._value=t.value??vi.default._value}static fromJSON(t={}){const e=new this;return e._time=t._time??vi.default._time,e._type=t._type??vi.default._type,e._value=t._value??vi.default._value,e}toJSON(){return{_time:this.time,_type:this.type,_value:this.value}}get floatValue(){return 1}set floatValue(t){W.tWarn(cu("floatValue"),"Event float value does not exist in beatmap V1")}get customData(){return{}}set customData(t){W.tWarn(cu("customData"),"Event custom data does not exist in beatmap V1")}isMappingExtensions(){return this.isLaneRotationEvent()&&this.value>=1e3&&this.value<=1720}},vi.default={_time:0,_type:0,_value:0},vi);var Os;let Mp=(Os=class extends Un{constructor(t={}){super(),this.list=[]}static create(t={}){return new this(t)}static fromJSON(t){return new this}toJSON(){return{_keywords:[]}}get list(){return this._list}set list(t){this._list=t}addList(t){return this._list.push(t),this}},Os.default={_keywords:[]},Os);function Li(i){return["beatmap","v1","difficulty",i]}var Ot;let Ir=(Ot=class extends Hn{constructor(t={}){super(),this.version="1.5.0",this.bpmEvents=[],this.rotationEvents=[],this.colorNotes=[],this.bombNotes=[],this.obstacles=[],this.arcs=[],this.chains=[],this.waypoints=[],this.basicEvents=[],this.colorBoostEvents=[],this.lightColorEventBoxGroups=[],this.lightRotationEventBoxGroups=[],this.lightTranslationEventBoxGroups=[],this.fxEventBoxGroups=[],this.eventTypesWithKeywords=new Mp,this.useNormalEventsAsCompatibleEvents=!0,this.beatsPerMinute=Ot.default._beatsPerMinute,this.beatsPerBar=Ot.default._beatsPerBar,this.shuffle=Ot.default._shuffle,this.shufflePeriod=Ot.default._shufflePeriod,this.noteJumpSpeed=Ot.default._noteJumpSpeed,this.noteJumpStartBeatOffset=Ot.default._noteJumpStartBeatOffset,this.time=Ot.default._time,this.BPMChanges=Ot.default._BPMChanges,this.bookmarks=Ot.default._bookmarks,this.filename=t.filename??this.filename,t instanceof Ot&&(this.beatsPerMinute=t.beatsPerMinute,this.beatsPerBar=t.beatsPerBar,this.shuffle=t.shuffle,this.shufflePeriod=t.shufflePeriod,this.noteJumpSpeed=t.noteJumpSpeed,this.noteJumpStartBeatOffset=t.noteJumpStartBeatOffset,this.time=t.time,this.BPMChanges=t.BPMChanges,this.bookmarks=t.bookmarks),t.colorNotes?this.colorNotes=t.colorNotes.map(e=>new go(e)):this.colorNotes=Ot.default._notes.map(e=>go.fromJSON(e)),t.obstacles?this.obstacles=t.obstacles.map(e=>new Jo(e)):this.obstacles=Ot.default._obstacles.map(e=>Jo.fromJSON(e)),t.basicEvents?this.basicEvents=t.basicEvents.map(e=>new Vi(e)):this.basicEvents=Ot.default._events.map(e=>Vi.fromJSON(e))}static create(t){return new this(t)}static fromJSON(t={}){const e=new this;return e.beatsPerMinute=t._beatsPerMinute??Ot.default._beatsPerMinute,e.beatsPerBar=t._beatsPerBar??Ot.default._beatsPerBar,e.shuffle=t._shuffle??Ot.default._shuffle,e.shufflePeriod=t._shufflePeriod??Ot.default._shufflePeriod,e.noteJumpSpeed=t._noteJumpSpeed??Ot.default._noteJumpSpeed,e.noteJumpStartBeatOffset=t._noteJumpStartBeatOffset??0,e.colorNotes=(t._notes??[]).map(o=>go.fromJSON(o)),e.obstacles=(t._obstacles??[]).map(o=>Jo.fromJSON(o)),e.basicEvents=(t._events??[]).map(o=>Vi.fromJSON(o)),e.time=t._time??Ot.default._time,e.BPMChanges=t._BPMChanges??Ot.default._BPMChanges,e.bookmarks=t._bookmarks??Ot.default._bookmarks,e}toJSON(){return{_version:this.version,_beatsPerMinute:this.beatsPerMinute,_beatsPerBar:this.beatsPerBar,_shuffle:this.shuffle,_shufflePeriod:this.shufflePeriod,_noteJumpSpeed:this.noteJumpSpeed,_noteJumpStartBeatOffset:this.noteJumpStartBeatOffset,_notes:this.colorNotes.map(t=>t.toJSON()),_obstacles:this.obstacles.map(t=>t.toJSON()),_events:this.basicEvents.map(t=>t.toJSON()),_time:this.time,_BPMChanges:this.BPMChanges,_bookmarks:this.bookmarks}}get customData(){return{}}set customData(t){W.tWarn(Li("customData"),"Custom data does not exist in beatmap V1")}reparse(t){return this.colorNotes=this.colorNotes.map(e=>this.createOrKeep(go,e,t)),this.obstacles=this.obstacles.map(e=>this.createOrKeep(Jo,e,t)),this.basicEvents=this.basicEvents.map(e=>this.createOrKeep(Vi,e,t)),this}addBpmEvents(...t){return W.tWarn(Li("addBpmEvents"),"BPM Event does not exist in beatmap V1"),this}addRotationEvents(...t){for(const e of t)this.basicEvents.push(new Vi({...e,type:e.executionTime===0?14:15,value:Ic[(e.rotation||0)%360]??cn(e.rotation||0,360)+1e3}));return W.tWarn(Li("addRotationEvents"),"This may not work correctly"),this}addColorNotes(...t){for(const e of t)this.colorNotes.push(new go(e));return this}addBombNotes(...t){for(const e of t)this.colorNotes.push(new go({...e,type:3}));return this}addObstacles(...t){for(const e of t)this.obstacles.push(new Jo(e));return this}addArcs(...t){return W.tWarn(Li("addArcs"),"Arc does not exist in beatmap V1"),this}addChains(...t){return W.tWarn(Li("addChains"),"Chain does not exist in beatmap V1"),this}addWaypoints(...t){return W.tWarn(Li("addWaypoints"),"Waypoint does not exist in beatmap V1"),this}addBasicEvents(...t){for(const e of t)this.basicEvents.push(new Vi(e));return this}addColorBoostEvents(...t){for(const e of t)this.basicEvents.push(new Vi({...e,value:e.toggle?1:0}));return this}addLightColorEventBoxGroups(...t){return W.tWarn(Li("addLightColorEventBoxGroups"),"Light Color Event Box Group does not exist in beatmap V1"),this}addLightRotationEventBoxGroups(...t){return W.tWarn(Li("addLightRotationEventBoxGroups"),"Light Rotation Event Box Group does not exist in beatmap V1"),this}addLightTranslationEventBoxGroups(...t){return W.tWarn(Li("addLightTranslationEventBoxGroups"),"Light Translation Event Box Group does not exist in beatmap V1"),this}addFxEventBoxGroups(...t){return W.tWarn(Li("addFxEventBoxGroups"),"FX Event Box Group does not exist in beatmap V1"),this}isValid(){return this.colorNotes.every(t=>this.checkClass(go,t))&&this.obstacles.every(t=>this.checkClass(Jo,t))&&this.basicEvents.every(t=>this.checkClass(Vi,t))}},Ot.default={_version:"1.5.0",_beatsPerMinute:120,_beatsPerBar:4,_shuffle:0,_shufflePeriod:0,_noteJumpSpeed:0,_noteJumpStartBeatOffset:0,_notes:[],_obstacles:[],_events:[],_time:0,_BPMChanges:[],_bookmarks:[]},Ot);function Lh(i){return["beatmap","v1","info",i]}var Nt;let Nh=(Nt=class extends Rr{constructor(t={}){var e,o,s,n,r,a,l,f;super(),this.version="1.0.0",this.contentChecksum="",this.song={title:"",subTitle:"",author:""},this.audio={filename:"",duration:0,audioDataFilename:"",bpm:0,lufs:0,previewStartTime:0,previewDuration:0},this.songPreviewFilename="",this.songTimeOffset=0,this.shuffle=0,this.shufflePeriod=.5,this.allDirectionsEnvironmentName="GlassDesertEnvironment",this.environmentNames=[],this.colorSchemes=[],this.filename=t.filename??this.filename,this.songName=((e=t.song)==null?void 0:e.title)??Nt.default.songName,this.songSubName=((o=t.song)==null?void 0:o.subTitle)??Nt.default.songSubName,this.songAuthorName=((s=t.song)==null?void 0:s.author)??Nt.default.authorName,this.beatsPerMinute=((n=t.audio)==null?void 0:n.bpm)??Nt.default.beatsPerMinute,this.previewStartTime=((r=t.audio)==null?void 0:r.previewStartTime)??Nt.default.previewStartTime,this.previewDuration=((a=t.audio)==null?void 0:a.previewDuration)??Nt.default.previewDuration,this.coverImageFilename=t.coverImageFilename??Nt.default.coverImagePath,this.environmentName=t.environmentName||((l=t.environmentNames)==null?void 0:l[0])||"DefaultEnvironment",this.contributors=C(t.contributors??Nt.default.contributors),this.customEnvironment=t.customEnvironment??Nt.default.customEnvironment,this.customEnvironmentHash=t.customEnvironmentHash??Nt.default.customEnvironmentHash,this.difficulties=[],(f=t.difficulties)==null||f.forEach(h=>{this.addMap(h)}),this.songFilename||(this.songFilename="song.ogg"),this.oneSaber=this.difficulties.some(h=>h.characteristic==="OneSaber")}get songName(){return this.song.title}set songName(t){this.song.title=t}get songSubName(){return this.song.subTitle}set songSubName(t){this.song.subTitle=t}get songAuthorName(){return this.song.author}set songAuthorName(t){this.song.author=t}get songFilename(){return this.audio.filename}set songFilename(t){this.audio.filename=t}get beatsPerMinute(){return this.audio.bpm}set beatsPerMinute(t){this.audio.bpm=t}get previewStartTime(){return this.audio.previewStartTime}set previewStartTime(t){this.audio.previewStartTime=t}get previewDuration(){return this.audio.previewDuration}set previewDuration(t){this.audio.previewDuration=t}static create(t={}){return new this(t)}static fromJSON(t={}){const e=new this;return e.songName=t.songName??Nt.default.songName,e.songSubName=t.songSubName??Nt.default.songSubName,e.songAuthorName=t.authorName??Nt.default.authorName,e.beatsPerMinute=t.beatsPerMinute??Nt.default.beatsPerMinute,e.previewStartTime=t.previewStartTime??Nt.default.previewStartTime,e.previewDuration=t.previewDuration??Nt.default.previewDuration,e.coverImageFilename=t.coverImagePath??Nt.default.coverImagePath,e.environmentName=t.environmentName??Nt.default.environmentName,e.difficulties=[],(t.difficultyLevels??Nt.default.difficultyLevels).forEach(o=>{e.addMap(o)}),e.songFilename||(e.songFilename="song.ogg"),e.oneSaber=e.difficulties.some(o=>o.characteristic==="OneSaber"),e.contributors=C(t.contributors??Nt.default.contributors),e.customEnvironment=t.customEnvironment??Nt.default.customEnvironment,e.customEnvironmentHash=t.customEnvironmentHash??Nt.default.customEnvironmentHash,e}toJSON(){return{songName:this.songName,songSubName:this.songSubName,authorName:this.songAuthorName,beatsPerMinute:this.beatsPerMinute,previewStartTime:this.previewStartTime,previewDuration:this.previewDuration,coverImagePath:this.coverImageFilename,environmentName:this.environmentName,difficultyLevels:this.listMap().reduce((t,[e,o])=>(t.push(o.toJSON()),t),[]),oneSaber:this.difficulties.some(t=>t.characteristic==="OneSaber"),contributors:this.contributors,customEnvironment:this.customEnvironment,customEnvironmentHash:this.customEnvironmentHash}}get customData(){return{}}set customData(t){W.tWarn(Lh("customData"),"Custom data does not exist in beatmap V1")}addMap(t,e){return t.audioPath||(t.audioPath=this.songFilename),this.difficulties.push(new Fp(t,e)),this}listMap(){return super.listMap()}isValid(){throw new Error("Method not implemented.")}},Nt.default={songName:"Untitled",songSubName:"",authorName:"NoAuthor",beatsPerMinute:120,previewStartTime:0,previewDuration:0,coverImagePath:"cover.jpg",environmentName:"DefaultEnvironment",difficultyLevels:[],oneSaber:!1,contributors:[],customEnvironment:"",customEnvironmentHash:""},Nt),Fp=class extends Or{constructor(t={},e,o){super(),this.lightshowFilename="",this.authors={mappers:[],lighters:[]},this.colorSchemeId=0,this.environmentId=0,this.difficulty=t.difficulty??"Easy",this.rank=t.difficultyRank??1,this.filename=t.jsonPath??"UnnamedFile.dat",this.njs=0,this.njsOffset=0,this.audioPath=e??"song.ogg",this.characteristic=o||"Standard",this.offset=t.offset,this.oldOffset=t.oldOffset,this.chromaToggle=t.chromaToggle,this.customColors=t.customColors,this.difficultyLabel=t.difficultyLabel,this.colorLeft=t.colorLeft,this.colorRight=t.colorRight,this.envColorLeft=t.envColorLeft,this.envColorRight=t.envColorRight,this.obstacleColor=t.obstacleColor}static create(t={},e,o){return new this(t,e,o)}static fromJSON(t={},e,o){const s=new this;return s.difficulty=t.difficulty??"Easy",s.rank=t.difficultyRank??1,s.filename=t.jsonPath??"UnnamedFile.dat",s.njs=0,s.njsOffset=0,s.audioPath=e??"song.ogg",s.characteristic=o||"Standard",s.offset=t.offset,s.oldOffset=t.oldOffset,s.chromaToggle=t.chromaToggle,s.customColors=t.customColors,s.difficultyLabel=t.difficultyLabel,s.colorLeft=xt(t.colorLeft),s.colorRight=xt(t.colorRight),s.envColorLeft=xt(t.envColorLeft),s.envColorRight=xt(t.envColorRight),s.obstacleColor=xt(t.obstacleColor),s}toJSON(){return{difficulty:this.difficulty,difficultyRank:this.rank,audioPath:this.audioPath,jsonPath:this.filename,characteristic:this.characteristic,offset:this.offset,oldOffset:this.oldOffset,chromaToggle:this.chromaToggle,customColors:this.customColors,difficultyLabel:this.difficultyLabel,colorLeft:this.colorLeft,colorRight:this.colorRight,envColorLeft:this.envColorLeft,envColorRight:this.envColorRight,obstacleColor:this.obstacleColor}}get customData(){return{}}set customData(t){W.tWarn(Lh("customData"),"Custom data does not exist in beatmap V1")}copyColorScheme(t,e){if(typeof t=="number"){if(e.colorSchemes.length<t)return this;const o=e.colorSchemes[t];return this.copyColorScheme(o)}return this.colorLeft=Object.entries(t.saberLeftColor).reduce((o,s)=>(s[0]!=="a"&&(o[s[0]]=s[1]),o),{r:0,g:0,b:0}),this.colorRight=Object.entries(t.saberRightColor).reduce((o,s)=>(s[0]!=="a"&&(o[s[0]]=s[1]),o),{r:0,g:0,b:0}),this.envColorLeft=Object.entries(t.environment0Color).reduce((o,s)=>(s[0]!=="a"&&(o[s[0]]=s[1]),o),{r:0,g:0,b:0}),this.envColorRight=Object.entries(t.environment1Color).reduce((o,s)=>(s[0]!=="a"&&(o[s[0]]=s[1]),o),{r:0,g:0,b:0}),this.obstacleColor=Object.entries(t.obstaclesColor).reduce((o,s)=>(s[0]!=="a"&&(o[s[0]]=s[1]),o),{r:0,g:0,b:0}),this}isValid(){throw new Error("Method not implemented.")}};function Bh(i){return["shared","dataCheck",i]}function ai(i,t,e){if(t)throw new Error(i);W.tWarn(Bh("deepCheck"),i),e.push(i)}function si(i,t,e,o,s=!0,n=[]){if(W.tVerbose(Bh("deepCheck"),`Looking up ${e}`),Array.isArray(i))return i.forEach((a,l)=>si(a,t,`${e}[${l}]`,o,s,n)),n;const r=Object.keys(t);if(!r.length)return n;for(const a in i)a in t||ai(`Unused key ${a} found in ${e}`,!1,n);for(let a=0;a<r.length;a++){const l=r[a],f=t[l],h=i[l];if(h===void 0){if(t[l].optional||ah(o,f.version)==="old")continue;ai(`Missing ${l} in object ${e}!`,s,n);continue}if(h===null){ai(`${l} contain null value in object ${e}!`,s,n);continue}if(f.type==="array"){Array.isArray(h)||ai(`${l} is not an array in object ${e}!`,s,n),si(h,f.check,`${e}.${l}`,o,s,n);continue}if(f.type==="object"){!Array.isArray(h)&&typeof h!="object"?ai(`${l} is not an object in object ${e}!`,s,n):si(h,f.check,`${e}.${l}`,o,s,n);continue}if(f.array){if(!Array.isArray(h)){ai(`${l} is not ${f.type} in object ${e}!`,s,n);continue}h.every(p=>typeof p===f.type||f.type==="number"&&typeof p=="number"&&(isNaN(p)||(f.int?p%1!==0:!0)&&(f.unsigned?p<0:!0)))||ai(`${l} is not ${f.type} in object ${e}!`,s,n);continue}if(!f.array&&typeof h!==f.type){ai(`${l} is not ${f.type} in object ${e}!`,s,n);continue}if(f.type==="number"){if(isNaN(h)){ai(`${e}.${l} is NaN!`,s,n);continue}if(f.int&&h%1!==0){ai(`${e}.${l} cannot be float!`,!1,n);continue}if(f.unsigned&&h<0){ai(`${e}.${l} cannot be negative!`,!1,n);continue}}}return n}const Gp={_time:{type:"number",version:"1.5.0"},_type:{type:"number",int:!0,unsigned:!0,version:"1.5.0"},_lineIndex:{type:"number",int:!0,version:"1.5.0"},_lineLayer:{type:"number",int:!0,version:"1.5.0"},_cutDirection:{type:"number",int:!0,unsigned:!0,version:"1.5.0"}},jp={_time:{type:"number",version:"1.5.0"},_lineIndex:{type:"number",int:!0,version:"1.5.0"},_type:{type:"number",int:!0,unsigned:!0,version:"1.5.0"},_duration:{type:"number",version:"1.5.0"},_width:{type:"number",int:!0,version:"1.5.0"}},Jp={_time:{type:"number",version:"1.5.0"},_type:{type:"number",int:!0,version:"1.5.0"},_value:{type:"number",int:!0,version:"1.5.0"}},Wp={_version:{type:"string",version:"1.5.0"},_beatsPerMinute:{type:"number",version:"1.5.0"},_beatsPerBar:{type:"number",version:"1.5.0"},_shuffle:{type:"number",version:"1.5.0"},_shufflePeriod:{type:"number",version:"1.5.0"},_noteJumpSpeed:{type:"number",version:"1.5.0",optional:!0},_noteJumpStartBeatOffset:{type:"number",version:"1.5.0",optional:!0},_notes:{type:"array",version:"1.5.0",check:Gp},_obstacles:{type:"array",version:"1.5.0",check:jp},_events:{type:"array",version:"1.5.0",check:Jp},_time:{type:"number",version:"1.5.0",optional:!0},_BPMChanges:{type:"array",version:"1.5.0",optional:!0,check:{}},_bookmarks:{type:"array",version:"1.5.0",optional:!0,check:{}}},Xp={difficulty:{type:"string",version:"1.0.0"},difficultyRank:{type:"number",version:"1.0.0"},audioPath:{type:"string",version:"1.0.0"},jsonPath:{type:"string",version:"1.0.0"},characteristic:{type:"string",version:"1.0.0"},offset:{type:"number",version:"1.0.0",optional:!0},oldOffset:{type:"number",version:"1.0.0",optional:!0},chromaToggle:{type:"string",version:"1.0.0",optional:!0},customColors:{type:"boolean",version:"1.0.0",optional:!0},difficultyLabel:{type:"string",version:"1.0.0",optional:!0},colorLeft:{type:"object",version:"1.0.0",check:{},optional:!0},colorRight:{type:"object",version:"1.0.0",check:{},optional:!0},envColorLeft:{type:"object",version:"1.0.0",check:{},optional:!0},envColorRight:{type:"object",version:"1.0.0",check:{},optional:!0},obstacleColor:{type:"object",version:"1.0.0",check:{},optional:!0}},Hp={songName:{type:"string",version:"1.0.0"},songSubName:{type:"string",version:"1.0.0"},authorName:{type:"string",version:"1.0.0"},beatsPerMinute:{type:"number",version:"1.0.0"},previewStartTime:{type:"number",version:"1.0.0"},previewDuration:{type:"number",version:"1.0.0"},coverImagePath:{type:"string",version:"1.0.0"},environmentName:{type:"string",version:"1.0.0"},difficultyLevels:{type:"array",version:"1.0.0",check:Xp},oneSaber:{type:"boolean",version:"1.0.0",optional:!0},contributors:{type:"array",version:"1.0.0",optional:!0,check:{}},customEnvironment:{type:"string",version:"1.0.0",optional:!0},customEnvironmentHash:{type:"string",version:"1.0.0",optional:!0}};function br(i){return["v1","parse",i]}function Yp(i,t={enabled:!0,throwError:!0}){var e;return W.tInfo(br("difficulty"),"Parsing beatmap difficulty v1.x.x"),xt(i),(e=i._version)!=null&&e.startsWith("1")||(W.tWarn(br("difficulty"),"Unidentified beatmap version"),i._version="1.5.0"),t.enabled&&si(i,Wp,"difficulty",i._version,t.throwError),Ir.fromJSON(i)}function Vp(i,t={enabled:!0,throwError:!0}){return W.tInfo(br("info"),"Parsing beatmap info v1.x.x"),t.enabled&&si(i,Hp,"info","1.0.0",t.throwError),Nh.fromJSON(i)}var Et;let Wo=(Et=class extends kr{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._color=t.color??Et.default._colorType,this._time=t.time??Et.default._headTime,this._posX=t.posX??Et.default._headLineIndex,this._posY=t.posY??Et.default._headLineLayer,this._direction=t.direction??Et.default._headCutDirection,this._lengthMultiplier=t.lengthMultiplier??Et.default._headControlPointLengthMultiplier,this._tailTime=t.tailTime??Et.default._tailTime,this._tailPosX=t.tailPosX??Et.default._tailLineIndex,this._tailPosY=t.tailPosY??Et.default._tailLineLayer,this._tailDirection=t.tailDirection??Et.default._tailCutDirection,this._tailLengthMultiplier=t.tailLengthMultiplier??Et.default._tailControlPointLengthMultiplier,this._midAnchor=t.midAnchor??Et.default._sliderMidAnchorMode,this._customData=C(t.customData??Et.default._customData)}static fromJSON(t={}){const e=new this;return e._color=t._colorType??Et.default._colorType,e._time=t._headTime??Et.default._headTime,e._posX=t._headLineIndex??Et.default._headLineIndex,e._posY=t._headLineLayer??Et.default._headLineLayer,e._direction=t._headCutDirection??Et.default._headCutDirection,e._lengthMultiplier=t._headControlPointLengthMultiplier??Et.default._headControlPointLengthMultiplier,e._tailTime=t._tailTime??Et.default._tailTime,e._tailPosX=t._tailLineIndex??Et.default._tailLineIndex,e._tailPosY=t._tailLineLayer??Et.default._tailLineLayer,e._tailDirection=t._tailCutDirection??Et.default._tailCutDirection,e._tailLengthMultiplier=t._tailControlPointLengthMultiplier??Et.default._tailControlPointLengthMultiplier,e._midAnchor=t._sliderMidAnchorMode??Et.default._sliderMidAnchorMode,e._customData=C(t._customData??Et.default._customData),e}toJSON(){return{_colorType:this.color,_headTime:this.time,_headLineIndex:this.posX,_headLineLayer:this.posY,_headCutDirection:this.direction,_headControlPointLengthMultiplier:this.lengthMultiplier,_tailTime:this.tailTime,_tailLineIndex:this.tailPosX,_tailLineLayer:this.tailPosY,_tailCutDirection:this.tailDirection,_tailControlPointLengthMultiplier:this.tailLengthMultiplier,_sliderMidAnchorMode:this.midAnchor,_customData:C(this.customData)}}get customData(){return this._customData}set customData(t){this._customData=t}},Et.default={_colorType:0,_headTime:0,_headLineIndex:0,_headLineLayer:0,_headCutDirection:0,_headControlPointLengthMultiplier:0,_tailTime:0,_tailLineIndex:0,_tailLineLayer:0,_tailCutDirection:0,_tailControlPointLengthMultiplier:0,_sliderMidAnchorMode:0,_customData:{}},Et);function zp(i){return["beatmap","v2","note",i]}const Ce=class Ce extends As{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??Ce.default._time,this._posX=t.posX??Ce.default._lineIndex,this._posY=t.posY??Ce.default._lineLayer,this._type=t.type??t.color??Ce.default._type,this._direction=t.direction??Ce.default._cutDirection,this._customData=C(t.customData??Ce.default._customData)}static fromJSON(t={}){const e=new this;return e._time=t._time??Ce.default._time,e._posX=t._lineIndex??Ce.default._lineIndex,e._posY=t._lineLayer??Ce.default._lineLayer,e._type=t._type??Ce.default._type,e._direction=t._cutDirection??Ce.default._cutDirection,e._customData=C(t._customData??Ce.default._customData),e}toJSON(){return{_time:this.time,_type:this.type,_lineIndex:this.posX,_lineLayer:this.posY,_cutDirection:this.direction,_customData:C(this.customData)}}get color(){return this._type}set color(t){this._type=t}get angleOffset(){return 0}set angleOffset(t){W.tWarn(zp("customData"),"Note angle offset does not exist in beatmap V2")}get customData(){return this._customData}set customData(t){this._customData=t}getPosition(t){switch(t){case"vanilla":return super.getPosition();case"ne":if(this.customData._position)return[this.customData._position[0],this.customData._position[1]];case"me":default:return[(this.posX<=-1e3?this.posX/1e3+1:this.posX>=1e3?this.posX/1e3-1:this.posX)-2,this.posY<=-1e3?this.posY/1e3:this.posY>=1e3?this.posY/1e3:this.posY]}}getAngle(t){switch(t){case"vanilla":return super.getAngle(t);case"ne":if(this.customData._cutDirection)return this.customData._cutDirection>0?this.customData._cutDirection%360:360+this.customData._cutDirection%360;case"me":default:return this.direction>=1e3?Math.abs(this.direction%1e3%360-360):super.getAngle()}}isChroma(){return Array.isArray(this.customData._color)||typeof this.customData._disableSpawnEffect=="boolean"}isNoodleExtensions(){return Array.isArray(this.customData._animation)||typeof this.customData._cutDirection=="number"||typeof this.customData._disableNoteGravity=="boolean"||typeof this.customData._disableNoteLook=="boolean"||typeof this.customData._fake=="boolean"||Array.isArray(this.customData._flip)||typeof this.customData._interactable=="boolean"||Array.isArray(this.customData._localRotation)||typeof this.customData._noteJumpMovementSpeed=="number"||typeof this.customData._noteJumpStartBeatOffset=="number"||Array.isArray(this.customData._position)||Array.isArray(this.customData._rotation)}};Ce.default={_time:0,_lineIndex:0,_lineLayer:0,_type:0,_cutDirection:0,_customData:{}};let Ri=Ce;var he;let Xo=(he=class extends Xn{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??he.default._time,t instanceof he?this._type=t.type:this._type=t.posY===2&&t.height===3?1:t.posY===0&&t.height===5?0:he.default._type,this._posX=t.posX??he.default._lineIndex,this._duration=t.duration??he.default._duration,this._width=t.width??he.default._width,this._customData=C(t.customData??he.default._customData)}static fromJSON(t={}){const e=new this;return e._time=t._time??he.default._time,e._type=t._type??he.default._type,e._posX=t._lineIndex??he.default._lineIndex,e._duration=t._duration??he.default._duration,e._width=t._width??he.default._width,e._customData=C(t._customData??he.default._customData),e}toJSON(){return{_time:this.time,_type:this.type,_lineIndex:this.posX,_duration:this.duration,_width:this.width,_customData:C(this.customData)}}get type(){return this._type}set type(t){this._type=t}get posY(){return this.type==1?2:0}set posY(t){switch(t){case 2:this.type=1;break;default:this.type=0}}get height(){return this.type==1?3:5}set height(t){switch(t){case 3:this.type=1;break;default:this.type=0}}get customData(){return this._customData}set customData(t){this._customData=t}getPosition(t){switch(t){case"vanilla":return super.getPosition();case"ne":if(this.customData._position)return[this.customData._position[0],this.customData._position[1]];case"me":default:return[(this.posX<=-1e3?this.posX/1e3+1:this.posX>=1e3?this.posX/1e3-1:this.posX)-2,(this.posY<=-1e3?this.posY/1e3:this.posY>=1e3?this.posY/1e3:this.posY)-.5]}}isChroma(){return Array.isArray(this.customData._color)}isNoodleExtensions(){return Array.isArray(this.customData._animation)||typeof this.customData._fake=="boolean"||typeof this.customData._interactable=="boolean"||Array.isArray(this.customData._localRotation)||typeof this.customData._noteJumpMovementSpeed=="number"||typeof this.customData._noteJumpStartBeatOffset=="number"||Array.isArray(this.customData._position)||Array.isArray(this.customData._rotation)||Array.isArray(this.customData._scale)}isMappingExtensions(){return this.type>1||this.posX<0||this.posX>3||this.width<0||this.width>3}},he.default={_time:0,_lineIndex:0,_type:0,_duration:0,_width:0,_customData:{}},he);const Ae=class Ae extends Yn{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??Ae.default._time,this._type=t.type??Ae.default._type,this._value=t.value??Ae.default._value,this._floatValue=t.floatValue??Ae.default._floatValue,this._customData=C(t.customData??Ae.default._customData)}static fromJSON(t={}){const e=new this;return e._time=t._time??Ae.default._time,e._type=t._type??Ae.default._type,e._value=t._value??Ae.default._value,e._floatValue=t._floatValue??Ae.default._floatValue,e._customData=C(t._customData??Ae.default._customData),e}toJSON(){return{_time:this.time,_type:this.type,_value:this.value,_floatValue:this.floatValue,_customData:C(this.customData)}}get customData(){return this._customData}set customData(t){this._customData=t}isLightEvent(t){return super.isLightEvent(t)}isRingEvent(t){return super.isRingEvent(t)}isLaserRotationEvent(t){return super.isLaserRotationEvent(t)}isLaneRotationEvent(t){return super.isLaneRotationEvent(t)}isChroma(){const t=this;return t.isLightEvent()?Array.isArray(this.customData._color)||typeof this.customData._lightID=="number"||Array.isArray(this.customData._lightID)||typeof this.customData._propID=="number"||typeof this.customData._lightGradient=="object"||typeof this.customData._easing=="string"||typeof this.customData._lerpType=="string":t.isRingEvent()?typeof this.customData._nameFilter=="string"||typeof this.customData._reset=="boolean"||typeof this.customData._rotation=="number"||typeof this.customData._step=="number"||typeof this.customData._prop=="number"||typeof this.customData._speed=="number"||typeof this.customData._direction=="number"||typeof this.customData._counterSpin=="boolean"||typeof this.customData._stepMult=="number"||typeof this.customData._propMult=="number"||typeof this.customData._speedMult=="number":t.isLaserRotationEvent()?typeof this.customData._lockPosition=="boolean"||typeof this.customData._speed=="number"||typeof this.customData._preciseSpeed=="number"||typeof this.customData._direction=="number":!1}isNoodleExtensions(){return this.isLaneRotationEvent()&&typeof this.customData._rotation=="number"}isMappingExtensions(){return this.isLaneRotationEvent()&&this.value>=1e3&&this.value<=1720}};Ae.default={_time:0,_type:0,_value:0,_floatValue:0,_customData:{}};let ui=Ae;var Le;let Ho=(Le=class extends Ar{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??Le.default._time,this._posX=t.posX??Le.default._lineIndex,this._posY=t.posY??Le.default._lineLayer,this._direction=t.direction??Le.default._offsetDirection,this._customData=C(t.customData??Le.default._customData)}static fromJSON(t={}){const e=new this;return e._time=t._time??Le.default._time,e._posX=t._lineIndex??Le.default._lineIndex,e._posY=t._lineLayer??Le.default._lineLayer,e._direction=t._offsetDirection??Le.default._offsetDirection,e._customData=C(t._customData??Le.default._customData),e}toJSON(){return{_time:this.time,_lineIndex:this.posX,_lineLayer:this.posY,_offsetDirection:this.direction,_customData:C(this.customData)}}get customData(){return this._customData}set customData(t){this._customData=t}},Le.default={_time:0,_lineIndex:0,_lineLayer:0,_offsetDirection:0,_customData:{}},Le);const To=class To extends fh{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._keyword=t.keyword??To.default._keyword,this._events=(t.events??To.default._specialEvents).filter(e=>typeof e=="number")}static fromJSON(t={}){const e=new this;return e._keyword=t._keyword??To.default._keyword,e._events=(t._specialEvents??To.default._specialEvents).filter(o=>typeof o=="number"),e}toJSON(){return{_keyword:this.keyword,_specialEvents:this.events}}};To.default={_keyword:"",_specialEvents:[]};let ds=To;const Cs=class Cs extends Un{static create(t={}){return new this(t)}constructor(t={}){super(),t.list?this._list=t.list.map(e=>new ds(e)):this._list=Cs.default._keywords.map(e=>ds.fromJSON(e))}static fromJSON(t={}){const e=new this;return e._list=(t._keywords??Cs.default._keywords).map(o=>ds.fromJSON(o)),e}toJSON(){return{_keywords:this.list.map(t=>t.toJSON())}}get list(){return this._list}set list(t){this._list=t}addList(t){return this._list.push(t),this}};Cs.default={_keywords:[]};let yo=Cs;function Yo(i){return["beatmap","v2","difficulty",i]}var ue;let Pr=(ue=class extends Hn{constructor(t={}){super(),this.version="2.6.0",this.bpmEvents=[],this.rotationEvents=[],this.bombNotes=[],this.chains=[],this.colorBoostEvents=[],this.lightColorEventBoxGroups=[],this.lightRotationEventBoxGroups=[],this.lightTranslationEventBoxGroups=[],this.fxEventBoxGroups=[],this.useNormalEventsAsCompatibleEvents=!0,this.filename=t.filename??this.filename,t.colorNotes?this.colorNotes=t.colorNotes.map(e=>new Ri(e)):this.colorNotes=ue.default._notes.map(e=>Ri.fromJSON(e)),t.arcs?this.arcs=t.arcs.map(e=>new Wo(e)):this.arcs=ue.default._sliders.map(e=>Wo.fromJSON(e)),t.obstacles?this.obstacles=t.obstacles.map(e=>new Xo(e)):this.obstacles=ue.default._obstacles.map(e=>Xo.fromJSON(e)),t.basicEvents?this.basicEvents=t.basicEvents.map(e=>new ui(e)):this.basicEvents=ue.default._events.map(e=>ui.fromJSON(e)),t.waypoints?this.waypoints=t.waypoints.map(e=>new Ho(e)):this.waypoints=ue.default._waypoints.map(e=>Ho.fromJSON(e)),t.eventTypesWithKeywords?this.eventTypesWithKeywords=new yo(t.eventTypesWithKeywords):this.eventTypesWithKeywords=yo.fromJSON(ue.default._specialEventsKeywordFilters),this.customData=C(t.customData??ue.default._customData??{})}static create(t={}){return new this(t)}static fromJSON(t={}){const e=new this;return e.colorNotes=(t._notes??ue.default._notes).map(o=>Ri.fromJSON(o)),e.arcs=(t._sliders??ue.default._sliders).map(o=>Wo.fromJSON(o)),e.obstacles=(t._obstacles??ue.default._obstacles).map(o=>Xo.fromJSON(o)),e.basicEvents=(t._events??ue.default._events).map(o=>ui.fromJSON(o)),e.waypoints=(t._waypoints??ue.default._waypoints).map(o=>Ho.fromJSON(o)),e.eventTypesWithKeywords=yo.fromJSON(t._specialEventsKeywordFilters??ue.default._specialEventsKeywordFilters),e.customData=C(t._customData??ue.default._customData),e}toJSON(){return{_version:this.version,_notes:this.colorNotes.map(t=>t.toJSON()),_sliders:this.arcs.map(t=>t.toJSON()),_obstacles:this.obstacles.map(t=>t.toJSON()),_events:this.basicEvents.map(t=>t.toJSON()),_waypoints:this.waypoints.map(t=>t.toJSON()),_specialEventsKeywordFilters:this.eventTypesWithKeywords.toJSON(),_customData:C(this.customData)}}get customData(){return this._customData}set customData(t){this._customData=t}reparse(t){return this.colorNotes=this.colorNotes.map(e=>this.createOrKeep(Ri,e,t)),this.obstacles=this.obstacles.map(e=>this.createOrKeep(Xo,e,t)),this.basicEvents=this.basicEvents.map(e=>this.createOrKeep(ui,e,t)),this.waypoints=this.waypoints.map(e=>this.createOrKeep(Ho,e,t)),this.arcs=this.arcs.map(e=>this.createOrKeep(Wo,e,t)),this.eventTypesWithKeywords=new yo(this.eventTypesWithKeywords),this}addBpmEvents(...t){for(const e of t)this.basicEvents.push(new ui({...e,type:100,value:e.bpm}));return this}addRotationEvents(...t){for(const e of t)this.basicEvents.push(new ui({...e,type:e.executionTime===0?14:15,value:Ic[(e.rotation||0)%360]??cn(e.rotation||0,360)+1e3}));return W.tWarn(Yo("addRotationEvents"),"This may not work correctly"),this}addColorNotes(...t){for(const e of t)this.colorNotes.push(new Ri(e));return this}addBombNotes(...t){for(const e of t)this.colorNotes.push(new Ri({...e,type:3}));return this}addObstacles(...t){for(const e of t)this.obstacles.push(new Xo(e));return this}addArcs(...t){for(const e of t)this.arcs.push(new Wo(e));return this}addChains(...t){return W.tWarn(Yo("addChains"),"Chain does not exist in beatmap V2"),this}addWaypoints(...t){for(const e of t)this.waypoints.push(new Ho(e));return this}addBasicEvents(...t){for(const e of t)this.basicEvents.push(new ui(e));return this}addColorBoostEvents(...t){for(const e of t)this.basicEvents.push(new ui({...e,value:e.toggle?1:0}));return this}addLightColorEventBoxGroups(...t){return W.tWarn(Yo("addLightColorEventBoxGroups"),"Light Color Event Box Group does not exist in beatmap V2"),this}addLightRotationEventBoxGroups(...t){return W.tWarn(Yo("addLightRotationEventBoxGroups"),"Light Rotation Event Box Group does not exist in beatmap V2"),this}addLightTranslationEventBoxGroups(...t){return W.tWarn(Yo("addLightTranslationEventBoxGroups"),"Light Translation Event Box Group does not exist in beatmap V2"),this}addFxEventBoxGroups(...t){return W.tWarn(Yo("addFxEventBoxGroups"),"FX Event Box Group does not exist in beatmap V2"),this}isValid(){return this.colorNotes.every(t=>this.checkClass(Ri,t))&&this.obstacles.every(t=>this.checkClass(Xo,t))&&this.basicEvents.every(t=>this.checkClass(ui,t))&&this.waypoints.every(t=>this.checkClass(Ho,t))&&this.arcs.every(t=>this.checkClass(Wo,t))&&this.eventTypesWithKeywords instanceof yo}},ue.default={_version:"2.6.0",_notes:[],_sliders:[],_obstacles:[],_events:[],_waypoints:[],_specialEventsKeywordFilters:{},_customData:{}},ue);var oe;let kh=(oe=class extends Rr{constructor(t={}){var e,o,s,n,r,a,l,f,h,p;super(),this.version="2.1.0",this.contentChecksum="",this.song={title:"",subTitle:"",author:""},this.audio={filename:"",duration:0,audioDataFilename:"",bpm:0,lufs:0,previewStartTime:0,previewDuration:0},this.songPreviewFilename="",this.difficulties=[],this.filename=t.filename??this.filename,this.songName=((e=t.song)==null?void 0:e.title)??oe.default._songName,this.songSubName=((o=t.song)==null?void 0:o.subTitle)??oe.default._songSubName,this.songAuthorName=((s=t.song)==null?void 0:s.author)??oe.default._songAuthorName,this.levelAuthorName=t.levelAuthorName??oe.default._levelAuthorName,this.beatsPerMinute=((n=t.audio)==null?void 0:n.bpm)??oe.default._beatsPerMinute,this.songTimeOffset=t.songTimeOffset??oe.default._songTimeOffset,this.shuffle=t.shuffle??oe.default._shuffle,this.shufflePeriod=t.shufflePeriod??oe.default._shufflePeriod,this.previewStartTime=((r=t.audio)==null?void 0:r.previewStartTime)??oe.default._previewStartTime,this.previewDuration=((a=t.audio)==null?void 0:a.previewDuration)??oe.default._previewDuration,this.songFilename=((l=t.audio)==null?void 0:l.filename)??oe.default._songFilename,this.coverImageFilename=t.coverImageFilename??oe.default._coverImageFilename,this.environmentName=t.environmentName??oe.default._environmentName,this.allDirectionsEnvironmentName=t.allDirectionsEnvironmentName??oe.default._allDirectionsEnvironmentName,this.environmentNames=((f=t.environmentNames)==null?void 0:f.map(c=>c))??[],this.colorSchemes=((h=t.colorSchemes)==null?void 0:h.map(c=>{var b,d,v,y,E,S,x,N,F,$,X,O,V,it,_,P,g,j,at,Y,ct,z,rt,A,k,ot,Q,Z,Tt,Yt,ht,vt,Gt,Lt,De,pe;c=c;const u={useOverride:!!c.useOverride,name:c.name||"",saberLeftColor:{r:((b=c.saberLeftColor)==null?void 0:b.r)||0,g:((d=c.saberLeftColor)==null?void 0:d.g)||0,b:((v=c.saberLeftColor)==null?void 0:v.b)||0,a:((y=c.saberLeftColor)==null?void 0:y.a)||0},saberRightColor:{r:((E=c.saberRightColor)==null?void 0:E.r)||0,g:((S=c.saberRightColor)==null?void 0:S.g)||0,b:((x=c.saberRightColor)==null?void 0:x.b)||0,a:((N=c.saberRightColor)==null?void 0:N.a)||0},environment0Color:{r:((F=c.environment0Color)==null?void 0:F.r)||0,g:(($=c.environment0Color)==null?void 0:$.g)||0,b:((X=c.environment0Color)==null?void 0:X.b)||0,a:((O=c.environment0Color)==null?void 0:O.a)||0},environment1Color:{r:((V=c.environment1Color)==null?void 0:V.r)||0,g:((it=c.environment1Color)==null?void 0:it.g)||0,b:((_=c.environment1Color)==null?void 0:_.b)||0,a:((P=c.environment1Color)==null?void 0:P.a)||0},obstaclesColor:{r:((g=c.obstaclesColor)==null?void 0:g.r)||0,g:((j=c.obstaclesColor)==null?void 0:j.g)||0,b:((at=c.obstaclesColor)==null?void 0:at.b)||0,a:((Y=c.obstaclesColor)==null?void 0:Y.a)||0},environment0ColorBoost:{r:((ct=c.environment0ColorBoost)==null?void 0:ct.r)||0,g:((z=c.environment0ColorBoost)==null?void 0:z.g)||0,b:((rt=c.environment0ColorBoost)==null?void 0:rt.b)||0,a:((A=c.environment0ColorBoost)==null?void 0:A.a)||0},environment1ColorBoost:{r:((k=c.environment1ColorBoost)==null?void 0:k.r)||0,g:((ot=c.environment1ColorBoost)==null?void 0:ot.g)||0,b:((Q=c.environment1ColorBoost)==null?void 0:Q.b)||0,a:((Z=c.environment1ColorBoost)==null?void 0:Z.a)||0}};return c.environmentWColor&&(u.environmentWColor={r:((Tt=c.environmentWColor)==null?void 0:Tt.r)||0,g:((Yt=c.environmentWColor)==null?void 0:Yt.g)||0,b:((ht=c.environmentWColor)==null?void 0:ht.b)||0,a:((vt=c.environmentWColor)==null?void 0:vt.a)||0}),c.environmentWColorBoost&&(u.environmentWColorBoost={r:((Gt=c.environmentWColorBoost)==null?void 0:Gt.r)||0,g:((Lt=c.environmentWColorBoost)==null?void 0:Lt.g)||0,b:((De=c.environmentWColorBoost)==null?void 0:De.b)||0,a:((pe=c.environmentWColorBoost)==null?void 0:pe.a)||0}),u}))??[],this.customData=C(t.customData??oe.default._customData),(p=t.difficulties)==null||p.forEach(c=>{this.addMap(c,c.characteristic)})}get songName(){return this.song.title}set songName(t){this.song.title=t}get songSubName(){return this.song.subTitle}set songSubName(t){this.song.subTitle=t}get songAuthorName(){return this.song.author}set songAuthorName(t){this.song.author=t}get songFilename(){return this.audio.filename}set songFilename(t){this.audio.filename=t}get beatsPerMinute(){return this.audio.bpm}set beatsPerMinute(t){this.audio.bpm=t}get previewStartTime(){return this.audio.previewStartTime}set previewStartTime(t){this.audio.previewStartTime=t}get previewDuration(){return this.audio.previewDuration}set previewDuration(t){this.audio.previewDuration=t}static create(t={}){return new this(t)}static fromJSON(t={}){var o,s,n;const e=new this;return e.songName=t._songName??"SongName",e.songSubName=t._songSubName??"",e.songAuthorName=t._songAuthorName??"SongAuthor",e.levelAuthorName=t._levelAuthorName??"",e.beatsPerMinute=t._beatsPerMinute??120,e.songTimeOffset=t._songTimeOffset??0,e.shuffle=t._shuffle??0,e.shufflePeriod=t._shufflePeriod??.5,e.previewStartTime=t._previewStartTime??12,e.previewDuration=t._previewDuration??10,e.songFilename=t._songFilename??"song.ogg",e.coverImageFilename=t._coverImageFilename??"",e.environmentName=t._environmentName??"DefaultEnvironment",e.allDirectionsEnvironmentName=t._allDirectionsEnvironmentName??"GlassDesertEnvironment",e.environmentNames=((o=t._environmentNames)==null?void 0:o.map(r=>r))??[],e.colorSchemes=((s=t._colorSchemes)==null?void 0:s.map(r=>{var l,f,h,p,c,u,b,d,v,y,E,S,x,N,F,$,X,O,V,it,_,P,g,j,at,Y,ct,z,rt,A,k,ot,Q,Z,Tt,Yt,ht,vt,Gt,Lt,De,pe,m,G,I,w,D,T,J,H,B,q,tt,K,st,Ct,dt,Se,Ji,Oe,Wi,jt,mo,Mo,ze,as,Fs,Gs,js,ls,Xi,po,Wr,Xr,Hr;const a={useOverride:!!r.useOverride,name:((l=r.colorScheme)==null?void 0:l.colorSchemeId)||"",saberLeftColor:{r:((h=(f=r.colorScheme)==null?void 0:f.saberAColor)==null?void 0:h.r)||0,g:((c=(p=r.colorScheme)==null?void 0:p.saberAColor)==null?void 0:c.g)||0,b:((b=(u=r.colorScheme)==null?void 0:u.saberAColor)==null?void 0:b.b)||0,a:((v=(d=r.colorScheme)==null?void 0:d.saberAColor)==null?void 0:v.a)||0},saberRightColor:{r:((E=(y=r.colorScheme)==null?void 0:y.saberBColor)==null?void 0:E.r)||0,g:((x=(S=r.colorScheme)==null?void 0:S.saberBColor)==null?void 0:x.g)||0,b:((F=(N=r.colorScheme)==null?void 0:N.saberBColor)==null?void 0:F.b)||0,a:((X=($=r.colorScheme)==null?void 0:$.saberBColor)==null?void 0:X.a)||0},environment0Color:{r:((V=(O=r.colorScheme)==null?void 0:O.environmentColor0)==null?void 0:V.r)||0,g:((_=(it=r.colorScheme)==null?void 0:it.environmentColor0)==null?void 0:_.g)||0,b:((g=(P=r.colorScheme)==null?void 0:P.environmentColor0)==null?void 0:g.b)||0,a:((at=(j=r.colorScheme)==null?void 0:j.environmentColor0)==null?void 0:at.a)||0},environment1Color:{r:((ct=(Y=r.colorScheme)==null?void 0:Y.environmentColor1)==null?void 0:ct.r)||0,g:((rt=(z=r.colorScheme)==null?void 0:z.environmentColor1)==null?void 0:rt.g)||0,b:((k=(A=r.colorScheme)==null?void 0:A.environmentColor1)==null?void 0:k.b)||0,a:((Q=(ot=r.colorScheme)==null?void 0:ot.environmentColor1)==null?void 0:Q.a)||0},obstaclesColor:{r:((Tt=(Z=r.colorScheme)==null?void 0:Z.obstaclesColor)==null?void 0:Tt.r)||0,g:((ht=(Yt=r.colorScheme)==null?void 0:Yt.obstaclesColor)==null?void 0:ht.g)||0,b:((Gt=(vt=r.colorScheme)==null?void 0:vt.obstaclesColor)==null?void 0:Gt.b)||0,a:((De=(Lt=r.colorScheme)==null?void 0:Lt.obstaclesColor)==null?void 0:De.a)||0},environment0ColorBoost:{r:((m=(pe=r.colorScheme)==null?void 0:pe.environmentColor0Boost)==null?void 0:m.r)||0,g:((I=(G=r.colorScheme)==null?void 0:G.environmentColor0Boost)==null?void 0:I.g)||0,b:((D=(w=r.colorScheme)==null?void 0:w.environmentColor0Boost)==null?void 0:D.b)||0,a:((J=(T=r.colorScheme)==null?void 0:T.environmentColor0Boost)==null?void 0:J.a)||0},environment1ColorBoost:{r:((B=(H=r.colorScheme)==null?void 0:H.environmentColor1Boost)==null?void 0:B.r)||0,g:((tt=(q=r.colorScheme)==null?void 0:q.environmentColor1Boost)==null?void 0:tt.g)||0,b:((st=(K=r.colorScheme)==null?void 0:K.environmentColor1Boost)==null?void 0:st.b)||0,a:((dt=(Ct=r.colorScheme)==null?void 0:Ct.environmentColor1Boost)==null?void 0:dt.a)||0}};return(Se=r.colorScheme)!=null&&Se.environmentColorW&&(a.environmentWColor={r:((Oe=(Ji=r.colorScheme)==null?void 0:Ji.environmentColorW)==null?void 0:Oe.r)||0,g:((jt=(Wi=r.colorScheme)==null?void 0:Wi.environmentColorW)==null?void 0:jt.g)||0,b:((Mo=(mo=r.colorScheme)==null?void 0:mo.environmentColorW)==null?void 0:Mo.b)||0,a:((as=(ze=r.colorScheme)==null?void 0:ze.environmentColorW)==null?void 0:as.a)||0}),(Fs=r.colorScheme)!=null&&Fs.environmentColorWBoost&&(a.environmentWColorBoost={r:((js=(Gs=r.colorScheme)==null?void 0:Gs.environmentColorWBoost)==null?void 0:js.r)||0,g:((Xi=(ls=r.colorScheme)==null?void 0:ls.environmentColorWBoost)==null?void 0:Xi.g)||0,b:((Wr=(po=r.colorScheme)==null?void 0:po.environmentColorWBoost)==null?void 0:Wr.b)||0,a:((Hr=(Xr=r.colorScheme)==null?void 0:Xr.environmentColorWBoost)==null?void 0:Hr.a)||0}),a}))??[],e.customData=C(t._customData??{}),(n=t._difficultyBeatmapSets)==null||n.forEach(r=>{var a;(a=r._difficultyBeatmaps)==null||a.forEach(l=>e.difficulties.push(hu.fromJSON(l,r._beatmapCharacteristicName)))}),e}toJSON(){return{_version:this.version,_songName:this.songName,_songSubName:this.songSubName,_songAuthorName:this.songAuthorName,_levelAuthorName:this.levelAuthorName,_beatsPerMinute:this.beatsPerMinute,_songTimeOffset:this.songTimeOffset,_shuffle:this.shuffle,_shufflePeriod:this.shufflePeriod,_previewStartTime:this.previewStartTime,_previewDuration:this.previewDuration,_songFilename:this.songFilename,_coverImageFilename:this.coverImageFilename,_environmentName:this.environmentName,_allDirectionsEnvironmentName:this.allDirectionsEnvironmentName,_environmentNames:this.environmentNames.map(t=>t),_colorSchemes:this.colorSchemes.map(t=>{const e={useOverride:t.useOverride,colorScheme:{colorSchemeId:t.name,saberAColor:xt(t.saberLeftColor),saberBColor:xt(t.saberRightColor),environmentColor0:xt(t.environment0Color),environmentColor1:xt(t.environment1Color),obstaclesColor:xt(t.obstaclesColor),environmentColor0Boost:xt(t.environment0ColorBoost),environmentColor1Boost:xt(t.environment1ColorBoost)}};return t.environmentWColor&&(e.colorScheme.environmentColorW=xt(t.environmentWColor)),t.environmentWColorBoost&&(e.colorScheme.environmentColorWBoost=xt(t.environmentWColorBoost)),e}),_customData:C(this.customData),_difficultyBeatmapSets:this.difficulties.reduce((t,e)=>{let o=t.find(s=>s._beatmapCharacteristicName===e.characteristic);return o||(o={_beatmapCharacteristicName:e.characteristic,_difficultyBeatmaps:[]},t.push(o)),o._difficultyBeatmaps.push(e.toJSON()),t},[])}}get customData(){return this._customData}set customData(t){this._customData=t}addMap(t,e){return this.difficulties.push(new hu(t,e)),this}listMap(){return super.listMap()}isValid(){throw new Error("Method not implemented.")}},oe.default={_version:"2.1.0",_songName:"Untitled",_songSubName:"",_songAuthorName:"NoAuthor",_levelAuthorName:"NoAuthor",_beatsPerMinute:120,_shuffle:0,_shufflePeriod:.5,_previewStartTime:0,_previewDuration:0,_songFilename:"song.ogg",_coverImageFilename:"cover.jpg",_environmentName:"DefaultEnvironment",_allDirectionsEnvironmentName:"GlassDesertEnvironment",_environmentNames:[],_colorSchemes:[],_songTimeOffset:0,_customData:{},_difficultyBeatmapSets:[]},oe);var Qt;let hu=(Qt=class extends Or{constructor(t={},e="Standard"){super(),this.lightshowFilename="",this.authors={mappers:[],lighters:[]},this.characteristic=e,this.difficulty=t.difficulty??Qt.default._difficulty,this.rank=t.rank??Qt.default.rank,this.filename=t.filename??Qt.default._beatmapFilename,this.njs=t.njs??Qt.default._noteJumpMovementSpeed,this.njsOffset=t.njsOffset??Qt.default._noteJumpStartBeatOffset,this.colorSchemeId=t.colorSchemeId??Qt.default._beatmapColorSchemeIdx,this.environmentId=t.environmentId??Qt.default._environmentNameIdx,this.customData=C(t.customData??Qt.default._customData)}static create(t={}){return new this(t)}static fromJSON(t,e="Standard"){const o=new this;return o.characteristic=e,o.difficulty=t._difficulty??Qt.default._difficulty,o.rank=t._difficultyRank??Qt.default._difficultyRank,o.filename=t._beatmapFilename??Qt.default._beatmapFilename,o.njs=t._noteJumpMovementSpeed??Qt.default._noteJumpMovementSpeed,o.njsOffset=t._noteJumpStartBeatOffset??Qt.default._noteJumpStartBeatOffset,o.colorSchemeId=t._beatmapColorSchemeIdx??Qt.default._beatmapColorSchemeIdx,o.environmentId=t._environmentNameIdx??Qt.default._environmentNameIdx,o.customData=C(t._customData??Qt.default._customData),o}toJSON(){return{_difficulty:this.difficulty,_difficultyRank:this.rank,_beatmapFilename:this.filename,_noteJumpMovementSpeed:this.njs,_noteJumpStartBeatOffset:this.njsOffset,_beatmapColorSchemeIdx:this.colorSchemeId,_environmentNameIdx:this.environmentId,_customData:C(this.customData)}}get customData(){return this._customData}set customData(t){this._customData=t}copyColorScheme(t,e){if(typeof t=="number"){if(e.colorSchemes.length<t)return this;const o=e.colorSchemes[t];return this.copyColorScheme(o)}return this.customData._colorLeft=Object.entries(t.saberLeftColor).reduce((o,s)=>(o[s[0]]=s[1],o),{r:0,g:0,b:0}),this.customData._colorRight=Object.entries(t.saberRightColor).reduce((o,s)=>(o[s[0]]=s[1],o),{r:0,g:0,b:0}),this.customData._envColorLeft=Object.entries(t.environment0Color).reduce((o,s)=>(o[s[0]]=s[1],o),{r:0,g:0,b:0}),this.customData._envColorRight=Object.entries(t.environment1Color).reduce((o,s)=>(o[s[0]]=s[1],o),{r:0,g:0,b:0}),this.customData._envColorLeftBoost=Object.entries(t.environment0ColorBoost).reduce((o,s)=>(o[s[0]]=s[1],o),{r:0,g:0,b:0}),this.customData._envColorRightBoost=Object.entries(t.environment1ColorBoost).reduce((o,s)=>(o[s[0]]=s[1],o),{r:0,g:0,b:0}),this.customData._obstacleColor=Object.entries(t.obstaclesColor).reduce((o,s)=>(o[s[0]]=s[1],o),{r:0,g:0,b:0}),this}isValid(){throw new Error("Method not implemented.")}},Qt.default={_difficulty:"Easy",_difficultyRank:1,_beatmapFilename:"UnnamedFile.dat",_noteJumpMovementSpeed:0,_noteJumpStartBeatOffset:0,_beatmapColorSchemeIdx:0,_environmentNameIdx:0,_customData:{},rank:1},Qt);const Up={_time:{type:"number",version:"2.0.0",optional:!0},_type:{type:"number",int:!0,unsigned:!0,version:"2.0.0",optional:!0},_lineIndex:{type:"number",int:!0,version:"2.0.0",optional:!0},_lineLayer:{type:"number",int:!0,version:"2.0.0",optional:!0},_cutDirection:{type:"number",int:!0,unsigned:!0,version:"2.0.0",optional:!0},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},qp={_colorType:{type:"number",version:"2.0.0",optional:!0},_headTime:{type:"number",version:"2.0.0",optional:!0},_headLineIndex:{type:"number",int:!0,version:"2.0.0",optional:!0},_headLineLayer:{type:"number",int:!0,version:"2.0.0",optional:!0},_headCutDirection:{type:"number",int:!0,unsigned:!0,version:"2.0.0",optional:!0},_headControlPointLengthMultiplier:{type:"number",version:"2.0.0",optional:!0},_tailTime:{type:"number",version:"2.0.0",optional:!0},_tailLineIndex:{type:"number",int:!0,version:"2.0.0",optional:!0},_tailLineLayer:{type:"number",int:!0,version:"2.0.0",optional:!0},_tailCutDirection:{type:"number",int:!0,unsigned:!0,version:"2.0.0",optional:!0},_tailControlPointLengthMultiplier:{type:"number",version:"2.0.0",optional:!0},_sliderMidAnchorMode:{type:"number",version:"2.0.0",optional:!0},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},Kp={_time:{type:"number",version:"2.0.0",optional:!0},_lineIndex:{type:"number",int:!0,version:"2.0.0",optional:!0},_type:{type:"number",int:!0,unsigned:!0,version:"2.0.0",optional:!0},_duration:{type:"number",version:"2.0.0",optional:!0},_width:{type:"number",int:!0,version:"2.0.0",optional:!0},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},Zp={_time:{type:"number",version:"2.0.0",optional:!0},_type:{type:"number",int:!0,version:"2.0.0",optional:!0},_value:{type:"number",int:!0,version:"2.0.0",optional:!0},_floatValue:{type:"number",version:"2.5.0",optional:!0},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},Qp={_time:{type:"number",version:"2.2.0",optional:!0},_lineIndex:{type:"number",int:!0,version:"2.2.0",optional:!0},_lineLayer:{type:"number",int:!0,version:"2.2.0",optional:!0},_offsetDirection:{type:"number",int:!0,version:"2.2.0",optional:!0},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},td={_keyword:{type:"string",version:"2.4.0",optional:!0},_specialEvents:{type:"number",int:!0,array:!0,version:"2.4.0",optional:!0}},ed={_keywords:{type:"array",version:"2.4.0",check:td,optional:!0}},id={_version:{type:"string",version:"2.0.0",optional:!0},_notes:{type:"array",version:"2.0.0",check:Up,optional:!0},_sliders:{type:"array",version:"2.6.0",check:qp,optional:!0},_obstacles:{type:"array",version:"2.0.0",check:Kp,optional:!0},_events:{type:"array",version:"2.0.0",check:Zp,optional:!0},_waypoints:{type:"array",version:"2.2.0",check:Qp,optional:!0},_specialEventsKeywordFilters:{type:"object",version:"2.4.0",check:ed,optional:!0},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},od={_difficulty:{type:"string",version:"2.0.0"},_difficultyRank:{type:"number",version:"2.0.0"},_beatmapFilename:{type:"string",version:"2.0.0"},_noteJumpMovementSpeed:{type:"number",version:"2.0.0"},_noteJumpStartBeatOffset:{type:"number",version:"2.0.0"},_beatmapColorSchemeIdx:{type:"number",version:"2.1.0"},_environmentNameIdx:{type:"number",version:"2.1.0"},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},sd={_beatmapCharacteristicName:{type:"string",version:"2.0.0"},_difficultyBeatmaps:{type:"array",version:"2.0.0",check:od}},vo={r:{type:"number",version:"2.1.0"},g:{type:"number",version:"2.1.0"},b:{type:"number",version:"2.1.0"},a:{type:"number",version:"2.1.0"}},nd={colorSchemeId:{type:"string",version:"2.1.0"},saberAColor:{type:"object",version:"2.1.0",check:vo},saberBColor:{type:"object",version:"2.1.0",check:vo},environmentColor0:{type:"object",version:"2.1.0",check:vo},environmentColor1:{type:"object",version:"2.1.0",check:vo},obstaclesColor:{type:"object",version:"2.1.0",check:vo},environmentColor0Boost:{type:"object",version:"2.1.0",check:vo},environmentColor1Boost:{type:"object",version:"2.1.0",check:vo}},rd={useOverride:{type:"boolean",version:"2.1.0"},colorScheme:{type:"object",version:"2.1.0",check:nd}},ad={_version:{type:"string",version:"2.0.0",optional:!0},_songName:{type:"string",version:"2.0.0"},_songSubName:{type:"string",version:"2.0.0"},_songAuthorName:{type:"string",version:"2.0.0"},_levelAuthorName:{type:"string",version:"2.0.0"},_beatsPerMinute:{type:"number",version:"2.0.0"},_songTimeOffset:{type:"number",version:"2.0.0"},_shuffle:{type:"number",version:"2.0.0"},_shufflePeriod:{type:"number",version:"2.0.0"},_previewStartTime:{type:"number",version:"2.0.0"},_previewDuration:{type:"number",version:"2.0.0"},_songFilename:{type:"string",version:"2.0.0"},_coverImageFilename:{type:"string",version:"2.0.0"},_environmentName:{type:"string",version:"2.0.0"},_allDirectionsEnvironmentName:{type:"string",version:"2.0.0",optional:!0},_environmentNames:{type:"string",version:"2.1.0",array:!0},_colorSchemes:{type:"array",version:"2.1.0",check:rd},_customData:{type:"object",version:"2.0.0",check:{},optional:!0},_difficultyBeatmapSets:{type:"array",version:"2.0.0",check:sd}};function Ko(i){return["v2","parse",i]}function ld(i,t={enabled:!0,throwError:!0}){var e,o,s,n,r;return W.tInfo(Ko("difficulty"),"Parsing beatmap difficulty v2.x.x"),i=xt(i),(e=i._version)!=null&&e.startsWith("2")||(W.tWarn(Ko("difficulty"),"Unidentified beatmap version"),i._version="2.0.0"),t.enabled&&si(i,id,"difficulty",i._version,t.throwError),i._customData=xt(i._customData||{}),i._BPMChanges&&(i._customData_BPMChanges||(i._customData_BPMChanges=i._BPMChanges)),i._bpmChanges&&(i._customData_bpmChanges||(i._customData_bpmChanges=i._bpmChanges)),i._bookmarks&&((o=i._customData)._bookmarks||(o._bookmarks=i._bookmarks)),i._customEvents&&((s=i._customData)._customEvents||(s._customEvents=i._customEvents)),i._time&&((n=i._customData)._time||(n._time=i._time)),ah(i._version,"2.5.0")==="old"&&(i._events=((r=i._events)==null?void 0:r.map(a=>(a=xt(a),a._floatValue=1,a)))||[]),Pr.fromJSON(i)}function ud(i,t={enabled:!0,throwError:!0}){var e,o;return W.tInfo(Ko("info"),"Parsing beatmap info v2.x.x"),i=xt(i),(e=i._version)!=null&&e.startsWith("2")||(W.tWarn(Ko("info"),"Unidentified beatmap version"),i._version="2.0.0"),t.enabled&&si(i,ad,"info",i._version,t.throwError),i._difficultyBeatmapSets=((o=i._difficultyBeatmapSets)==null?void 0:o.map(xt).map(s=>{var r;s=xt(s);let n=0;return s._difficultyBeatmaps=(r=s._difficultyBeatmaps)==null?void 0:r.map(a=>{var l,f;return a=xt(a),typeof a._difficultyRank=="number"?a._difficultyRank-n<=0&&W.tWarn(Ko("info"),a._difficulty+" is unordered"):typeof a._difficulty=="string"?(a._difficultyRank=mn[a._difficulty],a._difficultyRank||(a._difficulty="Easy",a._difficultyRank=1)):(a._difficulty="Easy",a._difficultyRank=1),mn[a._difficulty]!==a._difficultyRank&&W.tError(Ko("info"),a._difficulty+" has invalid rank"),n=a._difficultyRank,a._customData=xt(a._customData||{}),typeof((l=a._customData)==null?void 0:l._editorOffset)=="number"&&a._customData._editorOffset===0&&delete a._customData._editorOffset,typeof((f=a._customData)==null?void 0:f._editorOldOffset)=="number"&&a._customData._editorOldOffset===0&&delete a._customData._editorOldOffset,a}),s}))||[],kh.fromJSON(i)}var wt;let Vo=(wt=class extends kr{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??wt.default.b,this._color=t.color??wt.default.c,this._posX=t.posX??wt.default.x,this._posY=t.posY??wt.default.y,this._direction=t.direction??wt.default.d,this._lengthMultiplier=t.lengthMultiplier??wt.default.mu,this._tailTime=t.tailTime??wt.default.tb,this._tailPosX=t.tailPosX??wt.default.tx,this._tailPosY=t.tailPosY??wt.default.ty,this._tailDirection=t.tailDirection??wt.default.tc,this._tailLengthMultiplier=t.tailLengthMultiplier??wt.default.tmu,this._midAnchor=t.midAnchor??wt.default.m,this._customData=C(t.customData??wt.default.customData)}static fromJSON(t={}){const e=new this;return e._time=t.b??wt.default.b,e._color=t.c??wt.default.c,e._posX=t.x??wt.default.x,e._posY=t.y??wt.default.y,e._direction=t.d??wt.default.d,e._lengthMultiplier=t.mu??wt.default.mu,e._tailTime=t.tb??wt.default.tb,e._tailPosX=t.tx??wt.default.tx,e._tailPosY=t.ty??wt.default.ty,e._tailDirection=t.tc??wt.default.tc,e._tailLengthMultiplier=t.tmu??wt.default.tmu,e._midAnchor=t.m??wt.default.m,e._customData=C(t.customData??wt.default.customData),e}toJSON(){return{b:this.time,c:this.color,x:this.posX,y:this.posY,d:this.direction,mu:this.lengthMultiplier,tb:this.tailTime,tx:this.tailPosX,ty:this.tailPosY,tc:this.tailDirection,tmu:this.tailLengthMultiplier,m:this.midAnchor,customData:C(this.customData)}}get customData(){return this._customData}set customData(t){this._customData=t}mirror(t=!0,e){return e&&(this.customData.coordinates&&(this.customData.coordinates[0]=-1-this.customData.coordinates[0]),this.customData.flip&&(this.customData.flip[0]=-1-this.customData.flip[0]),this.customData.animation&&(Array.isArray(this.customData.animation.definitePosition)&&(ne(this.customData.animation.definitePosition)?this.customData.animation.definitePosition[0]=-this.customData.animation.definitePosition[0]:this.customData.animation.definitePosition.forEach(o=>{Array.isArray(o)&&(o[0]=-o[0])})),Array.isArray(this.customData.animation.offsetPosition)&&(ne(this.customData.animation.offsetPosition)?this.customData.animation.offsetPosition[0]=-this.customData.animation.offsetPosition[0]:this.customData.animation.offsetPosition.forEach(o=>{Array.isArray(o)&&(o[0]=-o[0])})))),super.mirror(t)}getPosition(t){switch(t){case"vanilla":return super.getPosition();case"ne":if(this.customData.coordinates)return[this.customData.coordinates[0],this.customData.coordinates[1]];case"me":default:return[(this.posX<=-1e3?this.posX/1e3+1:this.posX>=1e3?this.posX/1e3-1:this.posX)-2,this.posY<=-1e3?this.posY/1e3:this.posY>=1e3?this.posY/1e3:this.posY]}}getAngle(t){switch(t){case"vanilla":case"ne":return super.getAngle();case"me":default:return this.direction>=1e3?Math.abs(this.direction%1e3%360-360):super.getAngle()}}getTailPosition(t){switch(t){case"vanilla":return super.getTailPosition();case"ne":if(this.customData.tailCoordinates)return[this.customData.tailCoordinates[0],this.customData.tailCoordinates[1]];case"me":default:return[(this.tailPosX<=-1e3?this.tailPosX/1e3+1:this.tailPosX>=1e3?this.tailPosX/1e3-1:this.tailPosX)-2,this.tailPosY<=-1e3?this.tailPosY/1e3:this.tailPosY>=1e3?this.tailPosY/1e3:this.tailPosY]}}getTailAngle(t){switch(t){case"vanilla":case"ne":return super.getTailAngle();case"me":if(this.tailDirection>=1e3)return Math.abs(this.tailDirection%1e3%360-360);default:return super.getTailAngle()}}isChroma(){return Array.isArray(this.customData.color)||typeof this.customData.spawnEffect=="boolean"||typeof this.customData.disableDebris=="boolean"}isNoodleExtensions(){return Array.isArray(this.customData.animation)||typeof this.customData.disableNoteGravity=="boolean"||typeof this.customData.disableNoteLook=="boolean"||typeof this.customData.disableBadCutDirection=="boolean"||typeof this.customData.disableBadCutSaberType=="boolean"||typeof this.customData.disableBadCutSpeed=="boolean"||Array.isArray(this.customData.flip)||typeof this.customData.uninteractable=="boolean"||Array.isArray(this.customData.localRotation)||typeof this.customData.noteJumpMovementSpeed=="number"||typeof this.customData.noteJumpStartBeatOffset=="number"||Array.isArray(this.customData.coordinates)||Array.isArray(this.customData.tailCoordinates)||Array.isArray(this.customData.worldRotation)||typeof this.customData.worldRotation=="number"||typeof this.customData.link=="string"}},wt.default={b:0,c:0,x:0,y:0,d:0,mu:0,tb:0,tx:0,ty:0,tc:0,tmu:0,m:0,customData:{}},wt);var Ne;let Qe=(Ne=class extends Yn{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??Ne.default.b,this._type=t.type??Ne.default.et,this._value=t.value??Ne.default.i,this._floatValue=t.floatValue??Ne.default.f,this._customData=C(t.customData??Ne.default.customData)}static fromJSON(t={}){const e=new this;return e._time=t.b??Ne.default.b,e._type=t.et??Ne.default.et,e._value=t.i??Ne.default.i,e._floatValue=t.f??Ne.default.f,e._customData=C(t.customData??Ne.default.customData),e}toJSON(){return{b:this.time,et:this.type,i:this.value,f:this.floatValue,customData:C(this.customData)}}get customData(){return this._customData}set customData(t){this._customData=t}isLightEvent(t){return super.isLightEvent(t)}isRingEvent(t){return super.isRingEvent(t)}isLaserRotationEvent(t){return super.isLaserRotationEvent(t)}isLaneRotationEvent(t){return super.isLaneRotationEvent(t)}isChroma(){const t=this;return t.isLightEvent()?Array.isArray(this.customData.color)||typeof this.customData.lightID=="number"||Array.isArray(this.customData.lightID)||typeof this.customData.easing=="string"||typeof this.customData.lerpType=="string":t.isRingEvent()?typeof this.customData.nameFilter=="string"||typeof this.customData.rotation=="number"||typeof this.customData.step=="number"||typeof this.customData.prop=="number"||typeof this.customData.speed=="number"||typeof this.customData.direction=="number":t.isLaserRotationEvent()?typeof this.customData.lockRotation=="boolean"||typeof this.customData.speed=="number"||typeof this.customData.direction=="number":!1}},Ne.default={b:0,et:0,i:0,f:0,customData:{}},Ne);const Lo=class Lo extends fh{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._keyword=t.keyword??Lo.default.k,this._events=(t.events??Lo.default.e).filter(e=>typeof e=="number")}static fromJSON(t){const e=new this;return e._keyword=t.k??Lo.default.k,e._events=(t.e??Lo.default.e).filter(o=>typeof o=="number"),e}toJSON(){return{k:this.keyword,e:this.events}}};Lo.default={k:"",e:[]};let bs=Lo;const xs=class xs extends Un{static create(t={}){return new this(t)}constructor(t={}){super(),t.list?this._list=t.list.map(e=>new bs(e)):this.list=xs.default.d.map(e=>bs.fromJSON(e))}static fromJSON(t={}){const e=new this;return e._list=(t.d??xs.default.d).map(o=>bs.fromJSON(o)),e}toJSON(){return{d:this.list.map(t=>t.toJSON())}}get list(){return this._list}set list(t){this._list=t}addList(t){return this.list.push(t),this}};xs.default={d:[]};let Ee=xs;var Fe;let zo=(Fe=class extends uh{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??Fe.default.b,this._posX=t.posX??Fe.default.x,this._posY=t.posY??Fe.default.y,this._customData=C(t.customData??Fe.default.customData)}static fromJSON(t={}){const e=new this;return e._time=t.b??Fe.default.b,e._posX=t.x??Fe.default.x,e._posY=t.y??Fe.default.y,e._customData=C(t.customData??Fe.default.customData),e}toJSON(){return{b:this.time,x:this.posX,y:this.posY,customData:C(this.customData)}}get customData(){return this._customData}set customData(t){this._customData=t}mirror(t,e){return e&&(this.customData.coordinates&&(this.customData.coordinates[0]=-1-this.customData.coordinates[0]),this.customData.flip&&(this.customData.flip[0]=-1-this.customData.flip[0]),this.customData.animation&&(Array.isArray(this.customData.animation.definitePosition)&&(ne(this.customData.animation.definitePosition)?this.customData.animation.definitePosition[0]=-this.customData.animation.definitePosition[0]:this.customData.animation.definitePosition.forEach(o=>{Array.isArray(o)&&(o[0]=-o[0])})),Array.isArray(this.customData.animation.offsetPosition)&&(ne(this.customData.animation.offsetPosition)?this.customData.animation.offsetPosition[0]=-this.customData.animation.offsetPosition[0]:this.customData.animation.offsetPosition.forEach(o=>{Array.isArray(o)&&(o[0]=-o[0])})))),super.mirror()}isChroma(){return Array.isArray(this.customData.color)||typeof this.customData.spawnEffect=="boolean"||typeof this.customData.disableDebris=="boolean"}isNoodleExtensions(){return Array.isArray(this.customData.animation)||typeof this.customData.disableNoteGravity=="boolean"||typeof this.customData.disableNoteLook=="boolean"||typeof this.customData.disableBadCutDirection=="boolean"||typeof this.customData.disableBadCutSaberType=="boolean"||typeof this.customData.disableBadCutSpeed=="boolean"||Array.isArray(this.customData.flip)||typeof this.customData.uninteractable=="boolean"||Array.isArray(this.customData.localRotation)||typeof this.customData.noteJumpMovementSpeed=="number"||typeof this.customData.noteJumpStartBeatOffset=="number"||Array.isArray(this.customData.coordinates)||Array.isArray(this.customData.worldRotation)||typeof this.customData.worldRotation=="number"||typeof this.customData.link=="string"}},Fe.default={b:0,x:0,y:0,customData:{}},Fe);const Oi=class Oi extends Ip{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??Oi.default.b,this._bpm=t.bpm??Oi.default.m,this._customData=C(t.customData??Oi.default.customData)}static fromJSON(t={}){const e=new this;return e._time=t.b??Oi.default.b,e._bpm=t.m??Oi.default.m,e._customData=C(t.customData??Oi.default.customData),e}toJSON(){return{b:this.time,m:this.bpm,customData:C(this.customData)}}get customData(){return this._customData}set customData(t){this._customData=t}setBPM(t){return this.bpm=t,this}isValid(){return this.bpm>0}};Oi.default={b:0,m:0,customData:{}};let qi=Oi;var Bt;let Uo=(Bt=class extends ch{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??Bt.default.b,this._color=t.color??Bt.default.c,this._posX=t.posX??Bt.default.x,this._posY=t.posY??Bt.default.y,this._direction=t.direction??Bt.default.d,this._tailTime=t.tailTime??Bt.default.tb,this._tailPosX=t.tailPosX??Bt.default.tx,this._tailPosY=t.tailPosY??Bt.default.ty,this._sliceCount=t.sliceCount??Bt.default.sc,this._squish=t.squish??Bt.default.s,this._customData=C(t.customData??Bt.default.customData)}static fromJSON(t={}){const e=new this;return e._time=t.b??Bt.default.b,e._color=t.c??Bt.default.c,e._posX=t.x??Bt.default.x,e._posY=t.y??Bt.default.y,e._direction=t.d??Bt.default.d,e._tailTime=t.tb??Bt.default.tb,e._tailPosX=t.tx??Bt.default.tx,e._tailPosY=t.ty??Bt.default.ty,e._sliceCount=t.sc??Bt.default.sc,e._squish=t.s??Bt.default.s,e._customData=C(t.customData??Bt.default.customData),e}toJSON(){return{b:this.time,c:this.color,x:this.posX,y:this.posY,d:this.direction,tb:this.tailTime,tx:this.tailPosX,ty:this.tailPosY,sc:this.sliceCount,s:this.squish,customData:C(this.customData)}}get customData(){return this._customData}set customData(t){this._customData=t}mirror(t=!0,e){return e&&(this.customData.coordinates&&(this.customData.coordinates[0]=-1-this.customData.coordinates[0]),this.customData.flip&&(this.customData.flip[0]=-1-this.customData.flip[0]),this.customData.animation&&(Array.isArray(this.customData.animation.definitePosition)&&(ne(this.customData.animation.definitePosition)?this.customData.animation.definitePosition[0]=-this.customData.animation.definitePosition[0]:this.customData.animation.definitePosition.forEach(o=>{Array.isArray(o)&&(o[0]=-o[0])})),Array.isArray(this.customData.animation.offsetPosition)&&(ne(this.customData.animation.offsetPosition)?this.customData.animation.offsetPosition[0]=-this.customData.animation.offsetPosition[0]:this.customData.animation.offsetPosition.forEach(o=>{Array.isArray(o)&&(o[0]=-o[0])})))),super.mirror(t)}getPosition(t){switch(t){case"vanilla":return super.getPosition();case"ne":if(this.customData.coordinates)return[this.customData.coordinates[0],this.customData.coordinates[1]];case"me":default:return[(this.posX<=-1e3?this.posX/1e3+1:this.posX>=1e3?this.posX/1e3-1:this.posX)-2,this.posY<=-1e3?this.posY/1e3:this.posY>=1e3?this.posY/1e3:this.posY]}}getAngle(t){switch(t){case"me":if(this.direction>=1e3)return Math.abs(this.direction%1e3%360-360);case"vanilla":case"ne":default:return super.getAngle()}}getTailPosition(t){switch(t){case"vanilla":return super.getTailPosition();case"ne":if(this.customData.tailCoordinates)return[this.customData.tailCoordinates[0],this.customData.tailCoordinates[1]];case"me":default:return[(this.tailPosX<=-1e3?this.tailPosX/1e3+1:this.tailPosX>=1e3?this.tailPosX/1e3-1:this.tailPosX)-2,this.tailPosY<=-1e3?this.tailPosY/1e3:this.tailPosY>=1e3?this.tailPosY/1e3:this.tailPosY]}}isChroma(){return Array.isArray(this.customData.color)||typeof this.customData.spawnEffect=="boolean"||typeof this.customData.disableDebris=="boolean"}isNoodleExtensions(){return Array.isArray(this.customData.animation)||typeof this.customData.disableNoteGravity=="boolean"||typeof this.customData.disableNoteLook=="boolean"||typeof this.customData.disableBadCutDirection=="boolean"||typeof this.customData.disableBadCutSaberType=="boolean"||typeof this.customData.disableBadCutSpeed=="boolean"||Array.isArray(this.customData.flip)||typeof this.customData.uninteractable=="boolean"||Array.isArray(this.customData.localRotation)||typeof this.customData.noteJumpMovementSpeed=="number"||typeof this.customData.noteJumpStartBeatOffset=="number"||Array.isArray(this.customData.coordinates)||Array.isArray(this.customData.tailCoordinates)||Array.isArray(this.customData.worldRotation)||typeof this.customData.worldRotation=="number"||typeof this.customData.link=="string"}},Bt.default={b:0,c:0,x:0,y:0,d:0,tb:0,tx:0,ty:0,sc:0,s:0,customData:{}},Bt);var yi;let ti=(yi=class extends hh{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??yi.default.b,this._toggle=t.toggle??yi.default.o,this._customData=C(t.customData??yi.default.customData)}static fromJSON(t={}){const e=new this;return e._time=t.b??yi.default.b,e._toggle=t.o??yi.default.o,e._customData=C(t.customData??yi.default.customData),e}toJSON(){return{b:this.time,o:this.toggle,customData:C(this.customData)}}get customData(){return this._customData}set customData(t){this._customData=t}isValid(){return!0}},yi.default={b:0,o:!1,customData:{}},yi);var At;let we=(At=class extends bh{static create(t={}){return new At(t)}constructor(t={}){super(),this._type=t.type??At.default.f,this._p0=t.p0??At.default.p,this._p1=t.p1??At.default.t,this._reverse=t.reverse??At.default.r,this._chunks=t.chunks??At.default.c,this._random=t.random??At.default.n,this._seed=t.seed??At.default.s,this._limit=t.limit??At.default.l,this._limitAffectsType=t.limitAffectsType??At.default.d,this._customData=C(t.customData??At.default.customData)}static fromJSON(t={}){const e=new this;return e._type=t.f??At.default.f,e._p0=t.p??At.default.p,e._p1=t.t??At.default.t,e._reverse=t.r??At.default.r,e._chunks=t.c??At.default.c,e._random=t.n??At.default.n,e._seed=t.s??At.default.s,e._limit=t.l??At.default.l,e._limitAffectsType=t.d??At.default.d,e._customData=C(t.customData??At.default.customData),e}toJSON(){return{f:this.type,p:this.p0,t:this.p1,r:this.reverse,c:this.chunks,n:this.random,s:this.seed,l:this.limit,d:this.limitAffectsType,customData:C(this.customData)}}get customData(){return this._customData}set customData(t){this._customData=t}},At.default={f:1,p:0,t:0,r:0,c:0,n:0,s:0,l:0,d:0,customData:{}},At);const re=class re extends gh{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??re.default.b,this._color=t.color??re.default.c,this._frequency=t.frequency??re.default.f,this._transition=t.transition??re.default.i,this._brightness=t.brightness??re.default.s,this._strobeBrightness=t.strobeBrightness??re.default.sb,this._strobeFade=t.strobeFade??re.default.sf,this._customData=C(t.customData??re.default.customData)}static fromJSON(t={}){const e=new this;return e._time=t.b??re.default.b,e._color=t.c??re.default.c,e._frequency=t.f??re.default.f,e._transition=t.i??re.default.i,e._brightness=t.s??re.default.s,e._strobeBrightness=t.sb??re.default.sb,e._strobeFade=t.sf??re.default.sf,e._customData=C(t.customData??re.default.customData),e}toJSON(){return{b:this.time,c:this.color,f:this.frequency,i:this.transition,s:this.brightness,sb:this.strobeBrightness,sf:this.strobeFade,customData:C(this.customData)}}get previous(){return this.transition===2?1:0}set previous(t){this.transition=t?2:this.transition}get customData(){return this._customData}set customData(t){this._customData=t}};re.default={b:0,i:0,c:0,s:0,f:0,sb:0,sf:0,customData:{}};let gs=re;var Xt;let or=(Xt=class extends vh{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),t.filter?this._filter=new we(t.filter):this._filter=we.fromJSON(Xt.default.f),this._beatDistribution=t.beatDistribution??Xt.default.w,this._beatDistributionType=t.beatDistributionType??Xt.default.d,this._brightnessDistribution=t.brightnessDistribution??Xt.default.r,this._brightnessDistributionType=t.brightnessDistributionType??Xt.default.t,this._affectFirst=t.affectFirst??Xt.default.b,this._easing=t.easing??Xt.default.i,t.events?this._events=t.events.map(e=>new gs(e)):this._events=Xt.default.e.map(e=>gs.fromJSON(e)),this._customData=C(t.customData??Xt.default.customData)}static fromJSON(t={}){const e=new this;return e._filter=we.fromJSON(t.f??Xt.default.f),e._beatDistribution=t.w??Xt.default.w,e._beatDistributionType=t.d??Xt.default.d,e._brightnessDistribution=t.r??Xt.default.r,e._brightnessDistributionType=t.t??Xt.default.t,e._affectFirst=t.b??Xt.default.b,e._easing=t.i??Xt.default.i,e._events=(t.e??Xt.default.e).map(o=>gs.fromJSON(o)),e._customData=C(t.customData??Xt.default.customData),e}toJSON(){return{f:this.filter.toJSON(),w:this.beatDistribution,d:this.beatDistributionType,r:this.brightnessDistribution,t:this.brightnessDistributionType,b:this.affectFirst,i:this.easing,e:this.events.map(t=>t.toJSON()),customData:C(this.customData)}}get filter(){return this._filter}set filter(t){this._filter=t}get events(){return this._events}set events(t){this._events=t}get customData(){return this._customData}set customData(t){this._customData=t}setEvents(t){return this.events=t,this}},Xt.default={f:{...we.default},w:0,d:1,r:0,t:1,b:0,i:0,e:[],customData:{}},Xt);var Ge;let _i=(Ge=class extends yh{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??Ge.default.b,this._id=t.id??Ge.default.g,t.boxes?this._boxes=t.boxes.map(e=>new or(e)):this._boxes=Ge.default.e.map(e=>or.fromJSON(e)),this._customData=C(t.customData??Ge.default.customData)}static fromJSON(t={}){const e=new this;return e._time=t.b??Ge.default.b,e._id=t.g??Ge.default.g,e._boxes=(t.e??Ge.default.e).map(o=>or.fromJSON(o)),e._customData=C(t.customData??Ge.default.customData),e}toJSON(){return{b:this.time,g:this.id,e:this.boxes.map(t=>t.toJSON()),customData:C(this.customData)}}get boxes(){return this._boxes}set boxes(t){this._boxes=t}get customData(){return this._customData}set customData(t){this._customData=t}isValid(){return this.id>=0}},Ge.default={b:0,g:0,e:[],customData:{}},Ge);const de=class de extends _h{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??de.default.b,this._easing=t.easing??de.default.e,this._loop=t.loop??de.default.l,this._direction=t.direction??de.default.o,this._previous=t.previous??de.default.p,this._rotation=t.rotation??de.default.r,this._customData=C(t.customData??de.default.customData)}static fromJSON(t={}){const e=new this;return e._time=t.b??de.default.b,e._easing=t.e??de.default.e,e._loop=t.l??de.default.l,e._direction=t.o??de.default.o,e._previous=t.p??de.default.p,e._rotation=t.r??de.default.r,e._customData=C(t.customData??de.default.customData),e}toJSON(){return{b:this.time,e:this.easing,l:this.loop,o:this.direction,p:this.previous,r:this.rotation,customData:C(this.customData)}}get customData(){return this._customData}set customData(t){this._customData=t}};de.default={b:0,p:0,e:0,l:0,r:0,o:0,customData:{}};let vs=de;var kt;let sr=(kt=class extends Dh{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),t.filter?this._filter=new we(t.filter):this._filter=we.fromJSON(kt.default.f),this._beatDistribution=t.beatDistribution??kt.default.w,this._beatDistributionType=t.beatDistributionType??kt.default.d,this._rotationDistribution=t.rotationDistribution??kt.default.s,this._rotationDistributionType=t.rotationDistributionType??kt.default.t,this._axis=t.axis??kt.default.a,this._flip=t.flip??kt.default.r,this._affectFirst=t.affectFirst??kt.default.b,this._easing=t.easing??kt.default.i,t.events?this._events=t.events.map(e=>new vs(e)):this._events=kt.default.l.map(e=>vs.fromJSON(e)),this._customData=C(t.customData??kt.default.customData)}static fromJSON(t={}){const e=new this;return e._filter=we.fromJSON(t.f??kt.default.f),e._beatDistribution=t.w??kt.default.w,e._beatDistributionType=t.d??kt.default.d,e._rotationDistribution=t.s??kt.default.s,e._rotationDistributionType=t.t??kt.default.t,e._axis=t.a??kt.default.a,e._flip=t.r??kt.default.r,e._affectFirst=t.b??kt.default.b,e._easing=t.i??kt.default.i,e._events=(t.l??kt.default.l).map(o=>vs.fromJSON(o)),e._customData=C(t.customData??kt.default.customData),e}toJSON(){return{f:this.filter.toJSON(),w:this.beatDistribution,d:this.beatDistributionType,s:this.rotationDistribution,t:this.rotationDistributionType,a:this.axis,r:this.flip,b:this.affectFirst,i:this.easing,l:this.events.map(t=>t.toJSON()),customData:C(this.customData)}}get filter(){return this._filter}set filter(t){this._filter=t}get events(){return this._events}set events(t){this._events=t}get customData(){return this._customData}set customData(t){this._customData=t}setEvents(t){return this.events=t,this}},kt.default={f:{...we.default},w:0,d:1,s:0,t:1,a:0,r:0,b:0,i:0,l:[],customData:{}},kt);var je;let Di=(je=class extends Eh{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??je.default.b,this._id=t.id??je.default.g,t.boxes?this._boxes=t.boxes.map(e=>new sr(e)):this._boxes=je.default.e.map(e=>sr.fromJSON(e)),this._customData=C(t.customData??je.default.customData)}static fromJSON(t={}){const e=new this;return e._time=t.b??je.default.b,e._id=t.g??je.default.g,e._boxes=(t.e??je.default.e).map(o=>sr.fromJSON(o)),e._customData=C(t.customData??je.default.customData),e}toJSON(){return{b:this.time,g:this.id,e:this.boxes.map(t=>t.toJSON()),customData:C(this.customData)}}get boxes(){return this._boxes}set boxes(t){this._boxes=t}get customData(){return this._customData}set customData(t){this._customData=t}isValid(){return this.id>=0}},je.default={b:0,g:0,e:[],customData:{}},je);const Ie=class Ie extends Sh{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??Ie.default.b,this._easing=t.easing??Ie.default.e,this._previous=t.previous??Ie.default.p,this._translation=t.translation??Ie.default.t,this._customData=C(t.customData??Ie.default.customData)}static fromJSON(t={}){const e=new this;return e._time=t.b??Ie.default.b,e._easing=t.e??Ie.default.e,e._previous=t.p??Ie.default.p,e._translation=t.t??Ie.default.t,e._customData=C(t.customData??Ie.default.customData),e}toJSON(){return{b:this.time,e:this.easing,p:this.previous,t:this.translation,customData:C(this.customData)}}get customData(){return this._customData}set customData(t){this._customData=t}};Ie.default={b:0,p:0,e:0,t:0,customData:{}};let ys=Ie;var Rt;let nr=(Rt=class extends Ch{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),t.filter?this._filter=new we(t.filter):this._filter=we.fromJSON(Rt.default.f),this._beatDistribution=t.beatDistribution??Rt.default.w,this._beatDistributionType=t.beatDistributionType??Rt.default.d,this._translationDistribution=t.gapDistribution??Rt.default.s,this._translationDistributionType=t.gapDistributionType??Rt.default.t,this._axis=t.axis??Rt.default.a,this._flip=t.flip??Rt.default.r,this._affectFirst=t.affectFirst??Rt.default.b,this._easing=t.easing??Rt.default.i,t.events?this._events=t.events.map(e=>new ys(e)):this._events=Rt.default.l.map(e=>ys.fromJSON(e)),this._customData=C(t.customData??Rt.default.customData)}static fromJSON(t={}){const e=new this;return e._filter=we.fromJSON(t.f??Rt.default.f),e._beatDistribution=t.w??Rt.default.w,e._beatDistributionType=t.d??Rt.default.d,e._translationDistribution=t.s??Rt.default.s,e._translationDistributionType=t.t??Rt.default.t,e._axis=t.a??Rt.default.a,e._flip=t.r??Rt.default.r,e._affectFirst=t.b??Rt.default.b,e._easing=t.i??Rt.default.i,e._events=(t.l??Rt.default.l).map(o=>ys.fromJSON(o)),e._customData=C(t.customData??Rt.default.customData),e}toJSON(){return{f:this.filter.toJSON(),w:this.beatDistribution,d:this.beatDistributionType,s:this.gapDistribution,t:this.gapDistributionType,a:this.axis,r:this.flip,b:this.affectFirst,i:this.easing,l:this.events.map(t=>t.toJSON()),customData:C(this.customData)}}get filter(){return this._filter}set filter(t){this._filter=t}get events(){return this._events}set events(t){this._events=t}get customData(){return this._customData}set customData(t){this._customData=t}setEvents(t){return this.events=t,this}},Rt.default={f:{...we.default},w:0,d:1,s:0,t:1,a:0,r:0,b:0,i:0,l:[],customData:{}},Rt);var Je;let Ei=(Je=class extends xh{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??Je.default.b,this._id=t.id??Je.default.g,t.boxes?this._boxes=t.boxes.map(e=>new nr(e)):this._boxes=Je.default.e.map(e=>nr.fromJSON(e)),this._customData=C(t.customData??Je.default.customData)}static fromJSON(t={}){const e=new this;return e._time=t.b??Je.default.b,e._id=t.g??Je.default.g,e._boxes=(t.e??Je.default.e).map(o=>nr.fromJSON(o)),e._customData=C(t.customData??Je.default.customData),e}toJSON(){return{b:this.time,g:this.id,e:this.boxes.map(t=>t.toJSON()),customData:C(this.customData)}}get boxes(){return this._boxes}set boxes(t){this._boxes=t}get customData(){return this._customData}set customData(t){this._customData=t}isValid(){return this.id>=0}},Je.default={b:0,g:0,e:[],customData:{}},Je);const be=class be extends Xn{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??be.default.b,this._posX=t.posX??be.default.x,this._posY=t.posY??be.default.y,this._duration=t.duration??be.default.d,this._width=t.width??be.default.w,this._height=t.height??be.default.h,this._customData=C(t.customData??be.default.customData)}static fromJSON(t={}){const e=new this;return e._time=t.b??be.default.b,e._posX=t.x??be.default.x,e._posY=t.y??be.default.y,e._duration=t.d??be.default.d,e._width=t.w??be.default.w,e._height=t.h??be.default.h,e._customData=C(t.customData??be.default.customData),e}toJSON(){return{b:this.time,x:this.posX,y:this.posY,d:this.duration,w:this.width,h:this.height,customData:C(this.customData)}}get customData(){return this._customData}set customData(t){this._customData=t}mirror(t,e){var o;if(e){const s=((o=this.customData.size)==null?void 0:o[0])??this.width;this.customData.coordinates&&(this.customData.coordinates[0]=-1-this.customData.coordinates[0]),this.customData.animation&&(Array.isArray(this.customData.animation.definitePosition)&&(ne(this.customData.animation.definitePosition)?this.customData.animation.definitePosition[0]=-this.customData.animation.definitePosition[0]-(this.posX+s-1):this.customData.animation.definitePosition.forEach(n=>{Array.isArray(n)&&(n[0]=-n[0]-(this.posX+s-1))})),Array.isArray(this.customData.animation.offsetPosition)&&(ne(this.customData.animation.offsetPosition)?this.customData.animation.offsetPosition[0]=-this.customData.animation.offsetPosition[0]-(this.posX+s-1):this.customData.animation.offsetPosition.forEach(n=>{Array.isArray(n)&&(n[0]=-n[0]-(this.posX+s-1))})))}return super.mirror()}getPosition(t){switch(t){case"vanilla":return super.getPosition();case"ne":if(this.customData.coordinates)return[this.customData.coordinates[0],this.customData.coordinates[1]];case"me":default:return[(this.posX<=-1e3?this.posX/1e3+1:this.posX>=1e3?this.posX/1e3-1:this.posX)-2,(this.posY<=-1e3?this.posY/1e3:this.posY>=1e3?this.posY/1e3:this.posY)-.5]}}isChroma(){return Array.isArray(this.customData.color)}isNoodleExtensions(){return Array.isArray(this.customData.animation)||typeof this.customData.uninteractable=="boolean"||Array.isArray(this.customData.localRotation)||typeof this.customData.noteJumpMovementSpeed=="number"||typeof this.customData.noteJumpStartBeatOffset=="number"||Array.isArray(this.customData.coordinates)||Array.isArray(this.customData.worldRotation)||Array.isArray(this.customData.size)}isMappingExtensions(){return this.posY<0||this.posY>2||this.posX<=-1e3||this.posX>=1e3||this.width<=-1e3||this.width>=1e3||this.height<=-1e3||this.height>=1e3}};be.default={b:0,x:0,y:0,d:0,w:0,h:0,customData:{}};let Ki=be;const ci=class ci extends Th{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??ci.default.b,this._executionTime=t.executionTime??ci.default.e,this._rotation=t.rotation??ci.default.r,this._customData=C(t.customData??ci.default.customData)}static fromJSON(t={}){const e=new this;return e._time=t.b??ci.default.b,e._executionTime=t.e??ci.default.e,e._rotation=t.r??ci.default.r,e._customData=C(t.customData??ci.default.customData),e}toJSON(){return{b:this.time,e:this.executionTime,r:this.rotation,customData:C(this.customData)}}get customData(){return this._customData}set customData(t){this._customData=t}};ci.default={b:0,e:0,r:0,customData:{}};let Zi=ci;var Be;let qo=(Be=class extends Ar{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??Be.default.b,this._posX=t.posX??Be.default.x,this._posY=t.posY??Be.default.y,this._direction=t.direction??Be.default.d,this._customData=C(t.customData??Be.default.customData)}static fromJSON(t={}){const e=new this;return e._time=t.b??Be.default.b,e._posX=t.x??Be.default.x,e._posY=t.y??Be.default.y,e._direction=t.d??Be.default.d,e._customData=C(t.customData??Be.default.customData),e}toJSON(){return{b:this.time,x:this.posX,y:this.posY,d:this.direction,customData:C(this.customData)}}get customData(){return this._customData}set customData(t){this._customData=t}},Be.default={b:0,x:0,y:0,d:0,customData:{}},Be);var ke;let qs=(ke=class extends dh{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??ke.default.b,this._easing=t.easing??ke.default.i,this._previous=t.previous??ke.default.p,this._value=t.value??ke.default.v,this._customData=C(t.customData??ke.default.customData)}static fromJSON(t={}){const e=new this;return e._time=t.b??ke.default.b,e._easing=t.i??ke.default.i,e._previous=t.p??ke.default.p,e._value=t.v??ke.default.v,e._customData=C(t.customData??ke.default.customData),e}toJSON(){return{b:this.time,i:this.easing,p:this.previous,v:this.value,customData:C(this.customData)}}get customData(){return this._customData}set customData(t){this._customData=t}},ke.default={b:0,i:0,p:0,v:0,customData:{}},ke);var Ht;let Ks=(Ht=class extends mh{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),t.filter?this._filter=new we(t.filter):this._filter=we.fromJSON(Ht.default.data.f),this._beatDistribution=t.beatDistribution??Ht.default.data.w,this._beatDistributionType=t.beatDistributionType??Ht.default.data.d,this._fxDistribution=t.fxDistribution??Ht.default.data.s,this._fxDistributionType=t.fxDistributionType??Ht.default.data.t,this._affectFirst=t.affectFirst??Ht.default.data.b,this._easing=t.easing??Ht.default.data.i,t.events?this._events=t.events.map(e=>new qs(e)):this._events=Ht.default.eventData.map(e=>qs.fromJSON(e)),this._customData=C(t.customData??Ht.default.data.customData)}static fromJSON(t={},e){const o=new this;if(o._filter=we.fromJSON(t.f??Ht.default.data.f),o._beatDistribution=t.w??Ht.default.data.w,o._beatDistributionType=t.d??Ht.default.data.d,o._fxDistribution=t.s??Ht.default.data.s,o._fxDistributionType=t.t??Ht.default.data.t,o._affectFirst=t.b??Ht.default.data.b,o._easing=t.i??Ht.default.data.i,o._events=[],e)for(const s of t.l||[])o._events.push(qs.fromJSON(e[s]));else o._events=Ht.default.eventData.map(s=>qs.fromJSON(s));return o._customData=C(t.customData??Ht.default.data.customData),o}toJSON(){return{data:{f:this.filter.toJSON(),w:this.beatDistribution,d:this.beatDistributionType,s:this.fxDistribution,t:this.fxDistributionType,b:this.affectFirst,i:this.easing,l:[],customData:C(this.customData)},eventData:this.events.map(t=>t.toJSON())}}get filter(){return this._filter}set filter(t){this._filter=t}get events(){return this._events}set events(t){this._events=t}get customData(){return this._customData}set customData(t){this._customData=t}setEvents(t){return this.events=t,this}},Ht.default={data:{f:{...we.default},w:0,d:1,s:0,t:1,b:0,i:0,l:[],customData:{}},eventData:[]},Ht);var We;let wi=(We=class extends ph{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??We.default.object.b,this._id=t.id??We.default.object.g,t.boxes?this._boxes=t.boxes.map(e=>new Ks(e)):this._boxes=We.default.boxData.map(e=>Ks.fromJSON(e.data,e.eventData)),this._customData=C(t.customData??We.default.object.customData)}static fromJSON(t={},e){const o=new this;return o._time=t.b??We.default.object.b,o._id=t.g??We.default.object.g,t.e?o._boxes=t.e.map(s=>Ks.fromJSON(s,e)):o._boxes=We.default.boxData.map(s=>Ks.fromJSON(s.data,e??s.eventData)),o._customData=C(t.customData??We.default.object.customData),o}toJSON(){return{object:{t:pr.FLOAT,b:this.time,g:this.id,e:[],customData:C(this.customData)},boxData:this.boxes.map(t=>t.toJSON())}}get boxes(){return this._boxes}set boxes(t){this._boxes=t}get customData(){return this._customData}set customData(t){this._customData=t}isValid(){return this.id>=0}},We.default={object:{t:pr.FLOAT,b:0,g:0,e:[],customData:{}},boxData:[]},We);var ft;let $r=(ft=class extends Hn{constructor(t={}){super(),this.version="3.3.0",this.filename=t.filename??this.filename,t.bpmEvents?this.bpmEvents=t.bpmEvents.map(e=>new qi(e)):this.bpmEvents=ft.default.bpmEvents.map(e=>qi.fromJSON(e)),t.rotationEvents?this.rotationEvents=t.rotationEvents.map(e=>new Zi(e)):this.rotationEvents=ft.default.rotationEvents.map(e=>Zi.fromJSON(e)),t.colorNotes?this.colorNotes=t.colorNotes.map(e=>new Ui(e)):this.colorNotes=ft.default.colorNotes.map(e=>Ui.fromJSON(e)),t.bombNotes?this.bombNotes=t.bombNotes.map(e=>new zo(e)):this.bombNotes=ft.default.bombNotes.map(e=>zo.fromJSON(e)),t.obstacles?this.obstacles=t.obstacles.map(e=>new Ki(e)):this.obstacles=ft.default.obstacles.map(e=>Ki.fromJSON(e)),t.arcs?this.arcs=t.arcs.map(e=>new Vo(e)):this.arcs=ft.default.sliders.map(e=>Vo.fromJSON(e)),t.chains?this.chains=t.chains.map(e=>new Uo(e)):this.chains=ft.default.burstSliders.map(e=>Uo.fromJSON(e)),t.waypoints?this.waypoints=t.waypoints.map(e=>new qo(e)):this.waypoints=ft.default.waypoints.map(e=>qo.fromJSON(e)),t.basicEvents?this.basicEvents=t.basicEvents.map(e=>new Qe(e)):this.basicEvents=ft.default.basicBeatmapEvents.map(e=>Qe.fromJSON(e)),t.colorBoostEvents?this.colorBoostEvents=t.colorBoostEvents.map(e=>new ti(e)):this.colorBoostEvents=ft.default.colorBoostBeatmapEvents.map(e=>ti.fromJSON(e)),t.lightColorEventBoxGroups?this.lightColorEventBoxGroups=t.lightColorEventBoxGroups.map(e=>new _i(e)):this.lightColorEventBoxGroups=ft.default.lightColorEventBoxGroups.map(e=>_i.fromJSON(e)),t.lightRotationEventBoxGroups?this.lightRotationEventBoxGroups=t.lightRotationEventBoxGroups.map(e=>new Di(e)):this.lightRotationEventBoxGroups=ft.default.lightRotationEventBoxGroups.map(e=>Di.fromJSON(e)),t.lightTranslationEventBoxGroups?this.lightTranslationEventBoxGroups=t.lightTranslationEventBoxGroups.map(e=>new Ei(e)):this.lightTranslationEventBoxGroups=ft.default.lightTranslationEventBoxGroups.map(e=>Ei.fromJSON(e)),t.fxEventBoxGroups?this.fxEventBoxGroups=t.fxEventBoxGroups.map(e=>new wi(e)):this.fxEventBoxGroups=ft.default.vfxEventBoxGroups.map(e=>wi.fromJSON(e)),t.eventTypesWithKeywords?this.eventTypesWithKeywords=new Ee(t.eventTypesWithKeywords):this.eventTypesWithKeywords=Ee.fromJSON(ft.default.basicEventTypesWithKeywords),this.useNormalEventsAsCompatibleEvents=t.useNormalEventsAsCompatibleEvents??ft.default.useNormalEventsAsCompatibleEvents,this.customData=C(t.customData??ft.default.customData)}static create(t={}){return new this(t)}static fromJSON(t={}){const e=new this;return e.bpmEvents=(t.bpmEvents??ft.default.bpmEvents).map(o=>qi.fromJSON(o)),e.rotationEvents=(t.rotationEvents??ft.default.rotationEvents).map(o=>Zi.fromJSON(o)),e.colorNotes=(t.colorNotes??ft.default.colorNotes).map(o=>Ui.fromJSON(o)),e.bombNotes=(t.bombNotes??ft.default.bombNotes).map(o=>zo.fromJSON(o)),e.obstacles=(t.obstacles??ft.default.obstacles).map(o=>Ki.fromJSON(o)),e.arcs=(t.sliders??ft.default.sliders).map(o=>Vo.fromJSON(o)),e.chains=(t.burstSliders??ft.default.burstSliders).map(o=>Uo.fromJSON(o)),e.waypoints=(t.waypoints??ft.default.waypoints).map(o=>qo.fromJSON(o)),e.basicEvents=(t.basicBeatmapEvents??ft.default.basicBeatmapEvents).map(o=>Qe.fromJSON(o)),e.colorBoostEvents=(t.colorBoostBeatmapEvents??ft.default.colorBoostBeatmapEvents).map(o=>ti.fromJSON(o)),e.lightColorEventBoxGroups=(t.lightColorEventBoxGroups??ft.default.lightColorEventBoxGroups).map(o=>_i.fromJSON(o)),e.lightRotationEventBoxGroups=(t.lightRotationEventBoxGroups??ft.default.lightRotationEventBoxGroups).map(o=>Di.fromJSON(o)),e.lightTranslationEventBoxGroups=(t.lightTranslationEventBoxGroups??ft.default.lightTranslationEventBoxGroups).map(o=>Ei.fromJSON(o)),e.fxEventBoxGroups=(t.vfxEventBoxGroups??ft.default.vfxEventBoxGroups).map(o=>{var s;return wi.fromJSON(o,((s=t._fxEventsCollection)==null?void 0:s._fl)??ft.default._fxEventsCollection._fl)}),e.eventTypesWithKeywords=Ee.fromJSON(t.basicEventTypesWithKeywords??ft.default.basicEventTypesWithKeywords),e.useNormalEventsAsCompatibleEvents=t.useNormalEventsAsCompatibleEvents??ft.default.useNormalEventsAsCompatibleEvents,e.customData=C(t.customData??ft.default.customData),e}toJSON(){const t={version:this.version,bpmEvents:this.bpmEvents.map(e=>e.toJSON()),rotationEvents:this.rotationEvents.map(e=>e.toJSON()),colorNotes:this.colorNotes.map(e=>e.toJSON()),bombNotes:this.bombNotes.map(e=>e.toJSON()),obstacles:this.obstacles.map(e=>e.toJSON()),sliders:this.arcs.map(e=>e.toJSON()),burstSliders:this.chains.map(e=>e.toJSON()),waypoints:this.waypoints.map(e=>e.toJSON()),basicBeatmapEvents:this.basicEvents.map(e=>e.toJSON()),colorBoostBeatmapEvents:this.colorBoostEvents.map(e=>e.toJSON()),lightColorEventBoxGroups:this.lightColorEventBoxGroups.map(e=>e.toJSON()),lightRotationEventBoxGroups:this.lightRotationEventBoxGroups.map(e=>e.toJSON()),lightTranslationEventBoxGroups:this.lightTranslationEventBoxGroups.map(e=>e.toJSON()),vfxEventBoxGroups:[],basicEventTypesWithKeywords:this.eventTypesWithKeywords.toJSON(),_fxEventsCollection:{_fl:[],_il:[]},useNormalEventsAsCompatibleEvents:this.useNormalEventsAsCompatibleEvents,customData:C(this.customData)};for(const e of this.fxEventBoxGroups.map(o=>o.toJSON())){t.vfxEventBoxGroups.push(e.object);for(const o of e.boxData){e.object.e.push(o.data);for(const s of o.eventData)o.data.l.push(t._fxEventsCollection._fl.length),t._fxEventsCollection._fl.push(s)}}return t}get customData(){return this._customData}set customData(t){this._customData=t}reparse(t){return this.colorNotes=this.colorNotes.map(e=>this.createOrKeep(Ui,e,t)),this.bombNotes=this.bombNotes.map(e=>this.createOrKeep(zo,e,t)),this.arcs=this.arcs.map(e=>this.createOrKeep(Vo,e,t)),this.chains=this.chains.map(e=>this.createOrKeep(Uo,e,t)),this.obstacles=this.obstacles.map(e=>this.createOrKeep(Ki,e,t)),this.basicEvents=this.basicEvents.map(e=>this.createOrKeep(Qe,e,t)),this.colorBoostEvents=this.colorBoostEvents.map(e=>this.createOrKeep(ti,e,t)),this.rotationEvents=this.rotationEvents.map(e=>this.createOrKeep(Zi,e,t)),this.bpmEvents=this.bpmEvents.map(e=>this.createOrKeep(qi,e,t)),this.waypoints=this.waypoints.map(e=>this.createOrKeep(qo,e,t)),this.eventTypesWithKeywords=new Ee(this.eventTypesWithKeywords),this}addBpmEvents(...t){for(const e of t)this.bpmEvents.push(new qi(e));return this}addRotationEvents(...t){for(const e of t)this.rotationEvents.push(new Zi(e));return this}addColorNotes(...t){for(const e of t)this.colorNotes.push(new Ui(e));return this}addBombNotes(...t){for(const e of t)this.bombNotes.push(new zo(e));return this}addObstacles(...t){for(const e of t)this.obstacles.push(new Ki(e));return this}addArcs(...t){for(const e of t)this.arcs.push(new Vo(e));return this}addChains(...t){for(const e of t)this.chains.push(new Uo(e));return this}addWaypoints(...t){for(const e of t)this.waypoints.push(new qo(e));return this}addBasicEvents(...t){for(const e of t)this.basicEvents.push(new Qe(e));return this}addColorBoostEvents(...t){for(const e of t)this.colorBoostEvents.push(new ti(e));return this}addLightColorEventBoxGroups(...t){for(const e of t)this.lightColorEventBoxGroups.push(new _i(e));return this}addLightRotationEventBoxGroups(...t){for(const e of t)this.lightRotationEventBoxGroups.push(new Di(e));return this}addLightTranslationEventBoxGroups(...t){for(const e of t)this.lightTranslationEventBoxGroups.push(new Ei(e));return this}addFxEventBoxGroups(...t){for(const e of t)this.fxEventBoxGroups.push(new wi(e));return this}isValid(){return this.colorNotes.every(t=>this.checkClass(Ui,t))&&this.bombNotes.every(t=>this.checkClass(zo,t))&&this.arcs.every(t=>this.checkClass(Vo,t))&&this.chains.every(t=>this.checkClass(Uo,t))&&this.obstacles.every(t=>this.checkClass(Ki,t))&&this.basicEvents.every(t=>this.checkClass(Qe,t))&&this.colorBoostEvents.every(t=>this.checkClass(ti,t))&&this.rotationEvents.every(t=>this.checkClass(Zi,t))&&this.bpmEvents.every(t=>this.checkClass(qi,t))&&this.waypoints.every(t=>this.checkClass(qo,t))&&this.lightColorEventBoxGroups.every(t=>this.checkClass(_i,t))&&this.lightRotationEventBoxGroups.every(t=>this.checkClass(Di,t))&&this.lightTranslationEventBoxGroups.every(t=>this.checkClass(Ei,t))&&this.fxEventBoxGroups.every(t=>this.checkClass(wi,t))&&this.eventTypesWithKeywords instanceof Ee}},ft.default={version:"3.3.0",bpmEvents:[],rotationEvents:[],colorNotes:[],bombNotes:[],obstacles:[],sliders:[],burstSliders:[],waypoints:[],basicBeatmapEvents:[],colorBoostBeatmapEvents:[],lightColorEventBoxGroups:[],lightRotationEventBoxGroups:[],lightTranslationEventBoxGroups:[],vfxEventBoxGroups:[],_fxEventsCollection:{_fl:[],_il:[]},basicEventTypesWithKeywords:{...Ee.default},useNormalEventsAsCompatibleEvents:!1,customData:{}},ft);const hi=class hi extends Pp{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??hi.default.b,this._previous=t.previous??hi.default.p,this._value=t.value??hi.default.v,this._customData=C(t.customData??hi.default.customData)}static fromJSON(t={}){const e=new this;return e._time=t.b??hi.default.b,e._previous=t.p??hi.default.p,e._value=t.v??hi.default.v,e._customData=C(t.customData??hi.default.customData),e}toJSON(){return{b:this.time,p:this.previous,v:this.value,customData:C(this.customData)}}get customData(){return this._customData}set customData(t){this._customData=t}};hi.default={b:0,p:0,v:0,customData:{}};let fu=hi;function cd(i){return["beatmap","v3","lightshow",i]}var se;let Rh=(se=class extends wh{constructor(t={}){super(),this.version="3.3.0",this.waypoints=[],this.eventTypesWithKeywords=new Ee,this.useNormalEventsAsCompatibleEvents=!0,this.filename=t.filename??this.filename,t.basicEvents?this.basicEvents=t.basicEvents.map(e=>new Qe(e)):this.basicEvents=se.default.basicBeatmapEvents.map(e=>Qe.fromJSON(e)),t.colorBoostEvents?this.colorBoostEvents=t.colorBoostEvents.map(e=>new ti(e)):this.colorBoostEvents=se.default.colorBoostBeatmapEvents.map(e=>ti.fromJSON(e)),t.lightColorEventBoxGroups?this.lightColorEventBoxGroups=t.lightColorEventBoxGroups.map(e=>new _i(e)):this.lightColorEventBoxGroups=se.default.lightColorEventBoxGroups.map(e=>_i.fromJSON(e)),t.lightRotationEventBoxGroups?this.lightRotationEventBoxGroups=t.lightRotationEventBoxGroups.map(e=>new Di(e)):this.lightRotationEventBoxGroups=se.default.lightRotationEventBoxGroups.map(e=>Di.fromJSON(e)),t.lightTranslationEventBoxGroups?this.lightTranslationEventBoxGroups=t.lightTranslationEventBoxGroups.map(e=>new Ei(e)):this.lightTranslationEventBoxGroups=se.default.lightTranslationEventBoxGroups.map(e=>Ei.fromJSON(e)),t.fxEventBoxGroups?this.fxEventBoxGroups=t.fxEventBoxGroups.map(e=>new wi(e)):this.fxEventBoxGroups=se.default.vfxEventBoxGroups.map(e=>wi.fromJSON(e)),this.customData=C(t.customData??se.default.customData)}static create(t={}){return new this(t)}static fromJSON(t={}){const e=new this;return e.basicEvents=(t.basicBeatmapEvents??se.default.basicBeatmapEvents).map(o=>Qe.fromJSON(o)),e.colorBoostEvents=(t.colorBoostBeatmapEvents??se.default.colorBoostBeatmapEvents).map(o=>ti.fromJSON(o)),e.lightColorEventBoxGroups=(t.lightColorEventBoxGroups??se.default.lightColorEventBoxGroups).map(o=>_i.fromJSON(o)),e.lightRotationEventBoxGroups=(t.lightRotationEventBoxGroups??se.default.lightRotationEventBoxGroups).map(o=>Di.fromJSON(o)),e.lightTranslationEventBoxGroups=(t.lightTranslationEventBoxGroups??se.default.lightTranslationEventBoxGroups).map(o=>Ei.fromJSON(o)),e.fxEventBoxGroups=(t.vfxEventBoxGroups??se.default.vfxEventBoxGroups).map(o=>{var s;return wi.fromJSON(o,((s=t._fxEventsCollection)==null?void 0:s._fl)??se.default._fxEventsCollection._fl)}),e.customData=C(t.customData??se.default.customData),e}toJSON(){const t={basicBeatmapEvents:this.basicEvents.map(e=>e.toJSON()),colorBoostBeatmapEvents:this.colorBoostEvents.map(e=>e.toJSON()),lightColorEventBoxGroups:this.lightColorEventBoxGroups.map(e=>e.toJSON()),lightRotationEventBoxGroups:this.lightRotationEventBoxGroups.map(e=>e.toJSON()),lightTranslationEventBoxGroups:this.lightTranslationEventBoxGroups.map(e=>e.toJSON()),vfxEventBoxGroups:[],_fxEventsCollection:{_fl:[],_il:[]},customData:C(this.customData)};for(const e of this.fxEventBoxGroups.map(o=>o.toJSON())){t.vfxEventBoxGroups.push(e.object);for(const o of e.boxData){e.object.e.push(o.data);for(const s of o.eventData)o.data.l.push(t._fxEventsCollection._fl.length),t._fxEventsCollection._fl.push(s)}}return t}get customData(){return this._customData}set customData(t){this._customData=t}reparse(t){return this.basicEvents=this.basicEvents.map(e=>this.createOrKeep(Qe,e,t)),this.colorBoostEvents=this.colorBoostEvents.map(e=>this.createOrKeep(ti,e,t)),this.lightColorEventBoxGroups=this.lightColorEventBoxGroups.map(e=>this.createOrKeep(_i,e,t)),this.lightRotationEventBoxGroups=this.lightRotationEventBoxGroups.map(e=>this.createOrKeep(Di,e,t)),this.lightTranslationEventBoxGroups=this.lightTranslationEventBoxGroups.map(e=>this.createOrKeep(Ei,e,t)),this.fxEventBoxGroups=this.fxEventBoxGroups.map(e=>this.createOrKeep(wi,e,t)),this}addWaypoints(...t){return W.tWarn(cd("addWaypoints"),"Waypoints does not exist in lightshow V3"),this}addBasicEvents(...t){for(const e of t)this.basicEvents.push(new Qe(e));return this}addColorBoostEvents(...t){for(const e of t)this.colorBoostEvents.push(new ti(e));return this}addLightColorEventBoxGroups(...t){for(const e of t)this.lightColorEventBoxGroups.push(new _i(e));return this}addLightRotationEventBoxGroups(...t){for(const e of t)this.lightRotationEventBoxGroups.push(new Di(e));return this}addLightTranslationEventBoxGroups(...t){for(const e of t)this.lightTranslationEventBoxGroups.push(new Ei(e));return this}addFxEventBoxGroups(...t){for(const e of t)this.fxEventBoxGroups.push(new wi(e));return this}sort(){return super.sort()}isValid(){return this.basicEvents.every(t=>this.checkClass(Qe,t))&&this.colorBoostEvents.every(t=>this.checkClass(ti,t))&&this.lightColorEventBoxGroups.every(t=>this.checkClass(_i,t))&&this.lightRotationEventBoxGroups.every(t=>this.checkClass(Di,t))&&this.lightTranslationEventBoxGroups.every(t=>this.checkClass(Ei,t))&&this.fxEventBoxGroups.every(t=>this.checkClass(wi,t))}},se.default={basicBeatmapEvents:[],colorBoostBeatmapEvents:[],lightColorEventBoxGroups:[],lightRotationEventBoxGroups:[],lightTranslationEventBoxGroups:[],vfxEventBoxGroups:[],_fxEventsCollection:{_fl:[],_il:[]},customData:{}},se);const hd={b:{type:"number",version:"3.0.0",optional:!0},c:{type:"number",int:!0,version:"3.0.0",optional:!0},x:{type:"number",int:!0,version:"3.0.0",optional:!0},y:{type:"number",int:!0,version:"3.0.0",optional:!0},d:{type:"number",int:!0,version:"3.0.0",optional:!0},a:{type:"number",int:!0,version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},fd={b:{type:"number",version:"3.0.0",optional:!0},x:{type:"number",int:!0,version:"3.0.0",optional:!0},y:{type:"number",int:!0,version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},md={b:{type:"number",version:"3.0.0",optional:!0},c:{type:"number",int:!0,version:"3.0.0",optional:!0},x:{type:"number",int:!0,version:"3.0.0",optional:!0},y:{type:"number",int:!0,version:"3.0.0",optional:!0},d:{type:"number",int:!0,version:"3.0.0",optional:!0},mu:{type:"number",version:"3.0.0",optional:!0},tb:{type:"number",version:"3.0.0",optional:!0},tx:{type:"number",int:!0,version:"3.0.0",optional:!0},ty:{type:"number",int:!0,version:"3.0.0",optional:!0},tc:{type:"number",int:!0,version:"3.0.0",optional:!0},tmu:{type:"number",version:"3.0.0",optional:!0},m:{type:"number",int:!0,version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},pd={b:{type:"number",version:"3.0.0",optional:!0},c:{type:"number",int:!0,version:"3.0.0",optional:!0},x:{type:"number",int:!0,version:"3.0.0",optional:!0},y:{type:"number",int:!0,version:"3.0.0",optional:!0},d:{type:"number",int:!0,version:"3.0.0",optional:!0},tb:{type:"number",version:"3.0.0",optional:!0},tx:{type:"number",int:!0,version:"3.0.0",optional:!0},ty:{type:"number",int:!0,version:"3.0.0",optional:!0},sc:{type:"number",int:!0,version:"3.0.0",optional:!0},s:{type:"number",version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},dd={b:{type:"number",version:"3.0.0",optional:!0},x:{type:"number",int:!0,version:"3.0.0",optional:!0},y:{type:"number",int:!0,version:"3.0.0",optional:!0},d:{type:"number",version:"3.0.0",optional:!0},w:{type:"number",int:!0,version:"3.0.0",optional:!0},h:{type:"number",int:!0,version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Oh={b:{type:"number",version:"3.0.0",optional:!0},et:{type:"number",int:!0,version:"3.0.0",optional:!0},i:{type:"number",int:!0,version:"3.0.0",optional:!0},f:{type:"number",version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},bd={b:{type:"number",version:"3.0.0",optional:!0},m:{type:"number",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},gd={b:{type:"number",version:"3.0.0",optional:!0},e:{type:"number",int:!0,version:"3.0.0",optional:!0},r:{type:"number",version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Ah={b:{type:"number",version:"3.0.0",optional:!0},o:{type:"boolean",version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},qn={f:{type:"number",int:!0,version:"3.0.0",optional:!0},p:{type:"number",version:"3.0.0",optional:!0},t:{type:"number",version:"3.0.0",optional:!0},r:{type:"number",int:!0,version:"3.0.0",optional:!0},c:{type:"number",int:!0,version:"3.1.0",optional:!0},l:{type:"number",version:"3.1.0",optional:!0},d:{type:"number",int:!0,version:"3.1.0",optional:!0},n:{type:"number",int:!0,version:"3.1.0",optional:!0},s:{type:"number",int:!0,version:"3.1.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},vd={b:{type:"number",version:"3.0.0",optional:!0},c:{type:"number",int:!0,version:"3.0.0",optional:!0},f:{type:"number",version:"3.0.0",optional:!0},i:{type:"number",int:!0,version:"3.0.0",optional:!0},s:{type:"number",version:"3.0.0",optional:!0},sb:{type:"number",version:"3.3.0",optional:!0},sf:{type:"number",int:!0,version:"3.3.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},yd={f:{type:"object",version:"3.0.0",check:qn,optional:!0},w:{type:"number",version:"3.0.0",optional:!0},d:{type:"number",int:!0,version:"3.0.0",optional:!0},r:{type:"number",version:"3.0.0",optional:!0},t:{type:"number",int:!0,version:"3.0.0",optional:!0},e:{type:"array",version:"3.0.0",check:vd,optional:!0},b:{type:"number",int:!0,version:"3.0.0",optional:!0},i:{type:"number",int:!0,version:"3.2.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Ih={b:{type:"number",version:"3.0.0",optional:!0},g:{type:"number",int:!0,version:"3.0.0",optional:!0},e:{type:"array",version:"3.0.0",check:yd,optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},_d={b:{type:"number",version:"3.0.0",optional:!0},p:{type:"number",int:!0,version:"3.0.0",optional:!0},e:{type:"number",int:!0,version:"3.0.0",optional:!0},l:{type:"number",version:"3.0.0",optional:!0},r:{type:"number",version:"3.0.0",optional:!0},o:{type:"number",int:!0,version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Dd={f:{type:"object",version:"3.0.0",check:qn,optional:!0},w:{type:"number",version:"3.0.0",optional:!0},d:{type:"number",int:!0,version:"3.0.0",optional:!0},s:{type:"number",version:"3.0.0",optional:!0},t:{type:"number",int:!0,version:"3.0.0",optional:!0},a:{type:"number",int:!0,version:"3.0.0",optional:!0},l:{type:"array",version:"3.0.0",check:_d,optional:!0},r:{type:"number",int:!0,version:"3.0.0",optional:!0},b:{type:"number",int:!0,version:"3.0.0",optional:!0},i:{type:"number",int:!0,version:"3.2.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Ph={b:{type:"number",version:"3.0.0",optional:!0},g:{type:"number",int:!0,version:"3.0.0",optional:!0},e:{type:"array",version:"3.0.0",check:Dd,optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Ed={b:{type:"number",version:"3.2.0",optional:!0},p:{type:"number",int:!0,version:"3.2.0",optional:!0},e:{type:"number",int:!0,version:"3.2.0",optional:!0},t:{type:"number",version:"3.2.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},wd={f:{type:"object",version:"3.2.0",check:qn,optional:!0},w:{type:"number",version:"3.2.0",optional:!0},d:{type:"number",int:!0,version:"3.2.0",optional:!0},s:{type:"number",version:"3.2.0",optional:!0},t:{type:"number",int:!0,version:"3.2.0",optional:!0},a:{type:"number",int:!0,version:"3.2.0",optional:!0},l:{type:"array",version:"3.2.0",check:Ed,optional:!0},r:{type:"number",int:!0,version:"3.2.0",optional:!0},b:{type:"number",int:!0,version:"3.2.0",optional:!0},i:{type:"number",int:!0,version:"3.2.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},$h={b:{type:"number",version:"3.2.0",optional:!0},g:{type:"number",int:!0,version:"3.2.0",optional:!0},e:{type:"array",version:"3.2.0",check:wd,optional:!0},customData:{type:"object",version:"3.2.0",check:{},optional:!0}},Sd={f:{type:"object",version:"3.3.0",check:qn,optional:!0},w:{type:"number",version:"3.3.0",optional:!0},d:{type:"number",int:!0,version:"3.3.0",optional:!0},s:{type:"number",version:"3.3.0",optional:!0},t:{type:"number",int:!0,version:"3.3.0",optional:!0},l:{type:"number",int:!0,array:!0,version:"3.3.0",optional:!0},b:{type:"number",int:!0,version:"3.3.0",optional:!0},i:{type:"number",int:!0,version:"3.3.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Mh={b:{type:"number",version:"3.3.0",optional:!0},g:{type:"number",int:!0,version:"3.3.0",optional:!0},e:{type:"array",version:"3.3.0",check:Sd,optional:!0},t:{type:"number",int:!0,version:"3.3.0",optional:!0},customData:{type:"object",version:"3.3.0",check:{},optional:!0}},Cd={k:{type:"string",version:"3.0.0",optional:!0},e:{type:"number",int:!0,array:!0,version:"3.0.0",optional:!0}},Fh={d:{type:"array",version:"3.0.0",check:Cd,optional:!0}},xd={b:{type:"number",version:"3.3.0",optional:!0},i:{type:"number",int:!0,version:"3.3.0",optional:!0},p:{type:"number",int:!0,version:"3.3.0",optional:!0},v:{type:"number",version:"3.3.0",optional:!0},customData:{type:"object",version:"3.3.0",check:{},optional:!0}},Td={b:{type:"number",version:"3.3.0",optional:!0},p:{type:"number",int:!0,version:"3.3.0",optional:!0},v:{type:"number",int:!0,version:"3.3.0",optional:!0},customData:{type:"object",version:"3.3.0",check:{},optional:!0}},Gh={_fl:{type:"array",version:"3.3.0",check:xd,optional:!0},_il:{type:"array",version:"3.3.0",check:Td,optional:!0}},Ld={b:{type:"number",version:"3.0.0",optional:!0},d:{type:"number",int:!0,version:"3.0.0",optional:!0},x:{type:"number",int:!0,version:"3.0.0",optional:!0},y:{type:"number",int:!0,version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Nd={version:{type:"string",version:"3.0.0",optional:!0},bpmEvents:{type:"array",version:"3.0.0",check:bd,optional:!0},rotationEvents:{type:"array",version:"3.0.0",check:gd,optional:!0},colorNotes:{type:"array",version:"3.0.0",check:hd,optional:!0},bombNotes:{type:"array",version:"3.0.0",check:fd,optional:!0},obstacles:{type:"array",version:"3.0.0",check:dd,optional:!0},sliders:{type:"array",version:"3.0.0",check:md,optional:!0},burstSliders:{type:"array",version:"3.0.0",check:pd,optional:!0},waypoints:{type:"array",version:"3.0.0",check:Ld,optional:!0},basicBeatmapEvents:{type:"array",version:"3.0.0",check:Oh,optional:!0},colorBoostBeatmapEvents:{type:"array",version:"3.0.0",check:Ah,optional:!0},lightColorEventBoxGroups:{type:"array",version:"3.0.0",check:Ih,optional:!0},lightRotationEventBoxGroups:{type:"array",version:"3.0.0",check:Ph,optional:!0},lightTranslationEventBoxGroups:{type:"array",version:"3.2.0",check:$h,optional:!0},vfxEventBoxGroups:{type:"array",version:"3.3.0",check:Mh,optional:!0},basicEventTypesWithKeywords:{type:"object",version:"3.0.0",check:Fh,optional:!0},_fxEventsCollection:{type:"object",version:"3.3.0",check:Gh,optional:!0},useNormalEventsAsCompatibleEvents:{type:"boolean",version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Bd={basicBeatmapEvents:{type:"array",version:"3.0.0",check:Oh,optional:!0},colorBoostBeatmapEvents:{type:"array",version:"3.0.0",check:Ah,optional:!0},lightColorEventBoxGroups:{type:"array",version:"3.0.0",check:Ih,optional:!0},lightRotationEventBoxGroups:{type:"array",version:"3.0.0",check:Ph,optional:!0},lightTranslationEventBoxGroups:{type:"array",version:"3.2.0",check:$h,optional:!0},vfxEventBoxGroups:{type:"array",version:"3.3.0",check:Mh,optional:!0},_fxEventsCollection:{type:"object",version:"3.3.0",check:Gh,optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}};function Tn(i){return["v3","parse",i]}function kd(i,t={enabled:!0,throwError:!0}){return W.tInfo(Tn("difficulty"),"Parsing beatmap difficulty v3.x.x"),i.version==="3.0.0"||i.version==="3.1.0"||i.version==="3.2.0"||i.version==="3.3.0"||W.tWarn(Tn("difficulty"),"Unidentified beatmap version"),t.enabled&&si(i,Nd,"difficulty",i.version,t.throwError),$r.fromJSON(i)}function Rd(i,t={enabled:!0,throwError:!0}){return W.tInfo(Tn("lightshow"),"Parsing beatmap lightshow v3.x.x"),W.tWarn(Tn("lightshow"),"This beatmap does not have lightshow version and does not work in-game."),t.enabled&&si(i,Bd,"lightshow",i.version,t.throwError),Rh.fromJSON(i)}const _t=class _t extends kr{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??_t.default.object.hb,this._laneRotation=t.laneRotation??_t.default.object.hr,this._tailTime=t.tailTime??_t.default.object.tb,this._tailLaneRotation=t.tailLaneRotation??_t.default.object.tr,this._color=t.color??_t.default.headData.c,this._posX=t.posX??_t.default.headData.x,this._posY=t.posY??_t.default.headData.y,this._direction=t.direction??_t.default.headData.d,this._lengthMultiplier=t.lengthMultiplier??_t.default.data.m,this._tailPosX=t.tailPosX??_t.default.tailData.x,this._tailPosY=t.tailPosY??_t.default.tailData.y,this._tailDirection=t.tailDirection??_t.default.tailData.c,this._tailLengthMultiplier=t.tailLengthMultiplier??_t.default.data.tm,this._midAnchor=t.midAnchor??_t.default.data.a,this._customData=C(t.customData??_t.default.data.customData)}static fromJSON(t={},e={},o={},s={}){const n=new this;return n._time=t.hb??_t.default.object.hb,n._laneRotation=t.hr??_t.default.object.hr,n._tailTime=t.tb??_t.default.object.tb,n._tailLaneRotation=t.tr??_t.default.object.tr,n._color=o.c??_t.default.headData.c,n._posX=o.x??_t.default.headData.x,n._posY=o.y??_t.default.headData.y,n._direction=o.d??_t.default.headData.d,n._lengthMultiplier=e.m??_t.default.data.m,n._tailPosX=s.x??_t.default.tailData.x,n._tailPosY=s.y??_t.default.tailData.y,n._tailDirection=s.d??_t.default.tailData.c,n._tailLengthMultiplier=e.tm??_t.default.data.tm,n._midAnchor=e.a??_t.default.data.a,n._customData=C(e.customData??_t.default.data.customData),n}toJSON(){return{object:{ai:0,hb:this.time,hi:0,hr:this.laneRotation,tb:this.tailTime,ti:0,tr:this.tailLaneRotation,customData:{}},data:{m:this.lengthMultiplier,tm:this.tailLengthMultiplier,a:this.midAnchor,customData:C(this.customData)},headData:{c:this.color,x:this.posX,y:this.posY,d:this.direction,a:0,customData:{}},tailData:{c:this.color,x:this.tailPosX,y:this.tailPosY,d:this.tailDirection,a:0,customData:{}}}}get customData(){return this._customData}set customData(t){this._customData=t}mirror(t=!0,e){return e&&(this.customData.coordinates&&(this.customData.coordinates[0]=-1-this.customData.coordinates[0]),this.customData.flip&&(this.customData.flip[0]=-1-this.customData.flip[0]),this.customData.animation&&(Array.isArray(this.customData.animation.definitePosition)&&(ne(this.customData.animation.definitePosition)?this.customData.animation.definitePosition[0]=-this.customData.animation.definitePosition[0]:this.customData.animation.definitePosition.forEach(o=>{Array.isArray(o)&&(o[0]=-o[0])})),Array.isArray(this.customData.animation.offsetPosition)&&(ne(this.customData.animation.offsetPosition)?this.customData.animation.offsetPosition[0]=-this.customData.animation.offsetPosition[0]:this.customData.animation.offsetPosition.forEach(o=>{Array.isArray(o)&&(o[0]=-o[0])})))),super.mirror(t)}getPosition(t){switch(t){case"vanilla":return super.getPosition();case"ne":if(this.customData.coordinates)return[this.customData.coordinates[0],this.customData.coordinates[1]];case"me":default:return[(this.posX<=-1e3?this.posX/1e3+1:this.posX>=1e3?this.posX/1e3-1:this.posX)-2,this.posY<=-1e3?this.posY/1e3:this.posY>=1e3?this.posY/1e3:this.posY]}}getAngle(t){switch(t){case"vanilla":case"ne":return super.getAngle();case"me":default:return this.direction>=1e3?Math.abs(this.direction%1e3%360-360):super.getAngle()}}getTailPosition(t){switch(t){case"vanilla":return super.getTailPosition();case"ne":if(this.customData.tailCoordinates)return[this.customData.tailCoordinates[0],this.customData.tailCoordinates[1]];case"me":default:return[(this.tailPosX<=-1e3?this.tailPosX/1e3+1:this.tailPosX>=1e3?this.tailPosX/1e3-1:this.tailPosX)-2,this.tailPosY<=-1e3?this.tailPosY/1e3:this.tailPosY>=1e3?this.tailPosY/1e3:this.tailPosY]}}getTailAngle(t){switch(t){case"vanilla":case"ne":return super.getTailAngle();case"me":if(this.tailDirection>=1e3)return Math.abs(this.tailDirection%1e3%360-360);default:return super.getTailAngle()}}isChroma(){return Array.isArray(this.customData.color)||typeof this.customData.spawnEffect=="boolean"||typeof this.customData.disableDebris=="boolean"}isNoodleExtensions(){return Array.isArray(this.customData.animation)||typeof this.customData.disableNoteGravity=="boolean"||typeof this.customData.disableNoteLook=="boolean"||typeof this.customData.disableBadCutDirection=="boolean"||typeof this.customData.disableBadCutSaberType=="boolean"||typeof this.customData.disableBadCutSpeed=="boolean"||Array.isArray(this.customData.flip)||typeof this.customData.uninteractable=="boolean"||Array.isArray(this.customData.localRotation)||typeof this.customData.noteJumpMovementSpeed=="number"||typeof this.customData.noteJumpStartBeatOffset=="number"||Array.isArray(this.customData.coordinates)||Array.isArray(this.customData.tailCoordinates)||Array.isArray(this.customData.worldRotation)||typeof this.customData.worldRotation=="number"||typeof this.customData.link=="string"}};_t.default={object:{ai:0,hb:0,hi:0,hr:0,tb:0,ti:0,tr:0,customData:{}},data:{m:0,tm:0,a:0,customData:{}},headData:{c:0,x:0,y:0,d:0,a:0,customData:{}},tailData:{c:0,x:0,y:0,d:0,a:0,customData:{}}};let Qi=_t;const Pe=class Pe extends Yn{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??Pe.default.object.b,this._type=t.type??Pe.default.data.t,this._value=t.value??Pe.default.data.i,this._floatValue=t.floatValue??Pe.default.data.f,this._customData=C(t.customData??Pe.default.data.customData)}static fromJSON(t={},e={}){const o=new this;return o._time=t.b??Pe.default.object.b,o._type=e.t??Pe.default.data.t,o._value=e.i??Pe.default.data.i,o._floatValue=e.f??Pe.default.data.f,o._customData=C(e.customData??Pe.default.data.customData),o}toJSON(){return{object:{b:this.time,i:0,customData:{}},data:{t:this.type,i:this.value,f:this.floatValue,customData:C(this.customData)}}}get customData(){return this._customData}set customData(t){this._customData=t}isLightEvent(t){return super.isLightEvent(t)}isRingEvent(t){return super.isRingEvent(t)}isLaserRotationEvent(t){return super.isLaserRotationEvent(t)}isLaneRotationEvent(t){return super.isLaneRotationEvent(t)}isChroma(){const t=this;return t.isLightEvent()?Array.isArray(this.customData.color)||typeof this.customData.lightID=="number"||Array.isArray(this.customData.lightID)||typeof this.customData.easing=="string"||typeof this.customData.lerpType=="string":t.isRingEvent()?typeof this.customData.nameFilter=="string"||typeof this.customData.rotation=="number"||typeof this.customData.step=="number"||typeof this.customData.prop=="number"||typeof this.customData.speed=="number"||typeof this.customData.direction=="number":t.isLaserRotationEvent()?typeof this.customData.lockRotation=="boolean"||typeof this.customData.speed=="number"||typeof this.customData.direction=="number":!1}};Pe.default={object:{b:0,i:0,customData:{}},data:{t:0,i:0,f:0,customData:{}}};let to=Pe;const $e=class $e extends uh{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??$e.default.object.b,this._laneRotation=t.laneRotation??$e.default.object.r,this._posX=t.posX??$e.default.data.x,this._posY=t.posY??$e.default.data.y,this._customData=C(t.customData??$e.default.data.customData)}static fromJSON(t={},e={}){const o=new this;return o._time=t.b??$e.default.object.b,o._laneRotation=t.r??$e.default.object.r,o._posX=e.x??$e.default.data.x,o._posY=e.y??$e.default.data.y,o._customData=C(e.customData??$e.default.data.customData),o}toJSON(){return{object:{b:this.time,i:0,r:this.laneRotation,customData:{}},data:{x:this.posX,y:this.posY,customData:C(this.customData)}}}get customData(){return this._customData}set customData(t){this._customData=t}mirror(t,e){return e&&(this.customData.coordinates&&(this.customData.coordinates[0]=-1-this.customData.coordinates[0]),this.customData.flip&&(this.customData.flip[0]=-1-this.customData.flip[0]),this.customData.animation&&(Array.isArray(this.customData.animation.definitePosition)&&(ne(this.customData.animation.definitePosition)?this.customData.animation.definitePosition[0]=-this.customData.animation.definitePosition[0]:this.customData.animation.definitePosition.forEach(o=>{Array.isArray(o)&&(o[0]=-o[0])})),Array.isArray(this.customData.animation.offsetPosition)&&(ne(this.customData.animation.offsetPosition)?this.customData.animation.offsetPosition[0]=-this.customData.animation.offsetPosition[0]:this.customData.animation.offsetPosition.forEach(o=>{Array.isArray(o)&&(o[0]=-o[0])})))),super.mirror()}isChroma(){return Array.isArray(this.customData.color)||typeof this.customData.spawnEffect=="boolean"||typeof this.customData.disableDebris=="boolean"}isNoodleExtensions(){return Array.isArray(this.customData.animation)||typeof this.customData.disableNoteGravity=="boolean"||typeof this.customData.disableNoteLook=="boolean"||typeof this.customData.disableBadCutDirection=="boolean"||typeof this.customData.disableBadCutSaberType=="boolean"||typeof this.customData.disableBadCutSpeed=="boolean"||Array.isArray(this.customData.flip)||typeof this.customData.uninteractable=="boolean"||Array.isArray(this.customData.localRotation)||typeof this.customData.noteJumpMovementSpeed=="number"||typeof this.customData.noteJumpStartBeatOffset=="number"||Array.isArray(this.customData.coordinates)||Array.isArray(this.customData.worldRotation)||typeof this.customData.worldRotation=="number"||typeof this.customData.link=="string"}};$e.default={object:{b:0,i:0,r:0,customData:{}},data:{x:0,y:0,customData:{}}};let eo=$e;const Dt=class Dt extends ch{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??Dt.default.object.hb,this._laneRotation=t.laneRotation??Dt.default.object.hr,this._tailTime=t.tailTime??Dt.default.object.tb,this._tailLaneRotation=t.tailLaneRotation??Dt.default.object.tr,this._color=t.color??Dt.default.data.c,this._posX=t.posX??Dt.default.data.x,this._posY=t.posY??Dt.default.data.y,this._direction=t.direction??Dt.default.data.d,this._tailTime=t.tailTime??Dt.default.object.tb,this._tailPosX=t.tailPosX??Dt.default.chainData.tx,this._tailPosY=t.tailPosY??Dt.default.chainData.ty,this._sliceCount=t.sliceCount??Dt.default.chainData.c,this._squish=t.squish??Dt.default.chainData.s,this._customData=C(t.customData??Dt.default.chainData.customData)}static fromJSON(t={},e={},o={}){const s=new this;return s._time=t.hb??Dt.default.object.hb,s._laneRotation=t.hr??Dt.default.object.hr,s._tailTime=t.tb??Dt.default.object.tb,s._tailLaneRotation=t.tr??Dt.default.object.tr,s._color=e.c??Dt.default.data.c,s._posX=e.x??Dt.default.data.x,s._posY=e.y??Dt.default.data.y,s._direction=e.d??Dt.default.data.d,s._tailTime=t.tb??Dt.default.object.tb,s._tailPosX=o.tx??Dt.default.chainData.tx,s._tailPosY=o.ty??Dt.default.chainData.ty,s._sliceCount=o.c??Dt.default.chainData.c,s._squish=o.s??Dt.default.chainData.s,s._customData=C(o.customData??Dt.default.chainData.customData),s}toJSON(){return{object:{hb:this.time,hr:this.laneRotation,tb:this.tailTime,tr:this.tailLaneRotation,i:0,ci:0,customData:{}},data:{c:this.color,x:this.posX,y:this.posY,d:this.direction,a:0,customData:{}},chainData:{tx:this.tailPosX,ty:this.tailPosY,c:this.sliceCount,s:this.squish,customData:C(this.customData)}}}get customData(){return this._customData}set customData(t){this._customData=t}mirror(t=!0,e){return e&&(this.customData.coordinates&&(this.customData.coordinates[0]=-1-this.customData.coordinates[0]),this.customData.flip&&(this.customData.flip[0]=-1-this.customData.flip[0]),this.customData.animation&&(Array.isArray(this.customData.animation.definitePosition)&&(ne(this.customData.animation.definitePosition)?this.customData.animation.definitePosition[0]=-this.customData.animation.definitePosition[0]:this.customData.animation.definitePosition.forEach(o=>{Array.isArray(o)&&(o[0]=-o[0])})),Array.isArray(this.customData.animation.offsetPosition)&&(ne(this.customData.animation.offsetPosition)?this.customData.animation.offsetPosition[0]=-this.customData.animation.offsetPosition[0]:this.customData.animation.offsetPosition.forEach(o=>{Array.isArray(o)&&(o[0]=-o[0])})))),super.mirror(t)}getPosition(t){switch(t){case"vanilla":return super.getPosition();case"ne":if(this.customData.coordinates)return[this.customData.coordinates[0],this.customData.coordinates[1]];case"me":default:return[(this.posX<=-1e3?this.posX/1e3+1:this.posX>=1e3?this.posX/1e3-1:this.posX)-2,this.posY<=-1e3?this.posY/1e3:this.posY>=1e3?this.posY/1e3:this.posY]}}getAngle(t){switch(t){case"me":if(this.direction>=1e3)return Math.abs(this.direction%1e3%360-360);case"vanilla":case"ne":default:return super.getAngle()}}getTailPosition(t){switch(t){case"vanilla":return super.getTailPosition();case"ne":if(this.customData.tailCoordinates)return[this.customData.tailCoordinates[0],this.customData.tailCoordinates[1]];case"me":default:return[(this.tailPosX<=-1e3?this.tailPosX/1e3+1:this.tailPosX>=1e3?this.tailPosX/1e3-1:this.tailPosX)-2,this.tailPosY<=-1e3?this.tailPosY/1e3:this.tailPosY>=1e3?this.tailPosY/1e3:this.tailPosY]}}isChroma(){return Array.isArray(this.customData.color)||typeof this.customData.spawnEffect=="boolean"||typeof this.customData.disableDebris=="boolean"}isNoodleExtensions(){return Array.isArray(this.customData.animation)||typeof this.customData.disableNoteGravity=="boolean"||typeof this.customData.disableNoteLook=="boolean"||typeof this.customData.disableBadCutDirection=="boolean"||typeof this.customData.disableBadCutSaberType=="boolean"||typeof this.customData.disableBadCutSpeed=="boolean"||Array.isArray(this.customData.flip)||typeof this.customData.uninteractable=="boolean"||Array.isArray(this.customData.localRotation)||typeof this.customData.noteJumpMovementSpeed=="number"||typeof this.customData.noteJumpStartBeatOffset=="number"||Array.isArray(this.customData.coordinates)||Array.isArray(this.customData.tailCoordinates)||Array.isArray(this.customData.worldRotation)||typeof this.customData.worldRotation=="number"||typeof this.customData.link=="string"}};Dt.default={object:{hb:0,hr:0,tb:0,tr:0,i:0,ci:0,customData:{}},data:{c:0,x:0,y:0,d:0,a:0,customData:{}},chainData:{tx:0,ty:0,c:0,s:0,customData:{}}};let io=Dt;const Ai=class Ai extends hh{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??Ai.default.object.b,this._toggle=!!(t.toggle??Ai.default.data.b),this._customData=C(t.customData??Ai.default.data.customData)}static fromJSON(t={},e={}){const o=new this;return o._time=t.b??Ai.default.object.b,o._toggle=!!(e.b??Ai.default.data.b),o._customData=C(e.customData??Ai.default.data.customData),o}toJSON(){return{object:{b:this.time,i:0,customData:{}},data:{b:this.toggle?1:0,customData:C(this.customData)}}}get customData(){return this._customData}set customData(t){this._customData=t}isValid(){return!0}};Ai.default={object:{b:0,i:0,customData:{}},data:{b:0,customData:{}}};let oo=Ai;const ae=class ae extends As{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??ae.default.object.b,this._laneRotation=t.laneRotation??ae.default.object.r,this._posX=t.posX??ae.default.data.x,this._posY=t.posY??ae.default.data.y,this._color=t.color??(t.type===0||t.type===1?t.type:ae.default.data.c),this._direction=t.direction??ae.default.data.d,this._angleOffset=t.angleOffset??ae.default.data.a,this._customData=C(t.customData??ae.default.data.customData)}static fromJSON(t={},e={}){const o=new this;return o._time=t.b??ae.default.object.b,o._laneRotation=t.r??ae.default.object.r,o._posX=e.x??ae.default.data.x,o._posY=e.y??ae.default.data.y,o._color=e.c??ae.default.data.c,o._direction=e.d??ae.default.data.d,o._angleOffset=e.a??ae.default.data.a,o._customData=C(e.customData??ae.default.data.customData),o}toJSON(){return{object:{b:this.time,i:0,r:this.laneRotation,customData:{}},data:{c:this.color,x:this.posX,y:this.posY,d:this.direction,a:this.angleOffset,customData:C(this.customData)}}}get type(){return this._color}set type(t){this._color=t}get customData(){return this._customData}set customData(t){this._customData=t}mirror(t=!0,e){return e&&(this.customData.coordinates&&(this.customData.coordinates[0]=-1-this.customData.coordinates[0]),this.customData.flip&&(this.customData.flip[0]=-1-this.customData.flip[0]),this.customData.animation&&(Array.isArray(this.customData.animation.definitePosition)&&(ne(this.customData.animation.definitePosition)?this.customData.animation.definitePosition[0]=-this.customData.animation.definitePosition[0]:this.customData.animation.definitePosition.forEach(o=>{Array.isArray(o)&&(o[0]=-o[0])})),Array.isArray(this.customData.animation.offsetPosition)&&(ne(this.customData.animation.offsetPosition)?this.customData.animation.offsetPosition[0]=-this.customData.animation.offsetPosition[0]:this.customData.animation.offsetPosition.forEach(o=>{Array.isArray(o)&&(o[0]=-o[0])})))),super.mirror(t)}getPosition(t){switch(t){case"vanilla":return super.getPosition();case"ne":if(this.customData.coordinates)return[this.customData.coordinates[0],this.customData.coordinates[1]];case"me":default:return[(this.posX<=-1e3?this.posX/1e3+1:this.posX>=1e3?this.posX/1e3-1:this.posX)-2,this.posY<=-1e3?this.posY/1e3:this.posY>=1e3?this.posY/1e3:this.posY]}}getAngle(t){switch(t){case"vanilla":case"ne":return super.getAngle();case"me":default:return this.direction>=1e3?Math.abs(this.direction%1e3%360-360):super.getAngle()}}isChroma(){return Array.isArray(this.customData.color)||typeof this.customData.spawnEffect=="boolean"||typeof this.customData.disableDebris=="boolean"}isNoodleExtensions(){return Array.isArray(this.customData.animation)||typeof this.customData.disableNoteGravity=="boolean"||typeof this.customData.disableNoteLook=="boolean"||typeof this.customData.disableBadCutDirection=="boolean"||typeof this.customData.disableBadCutSaberType=="boolean"||typeof this.customData.disableBadCutSpeed=="boolean"||Array.isArray(this.customData.flip)||typeof this.customData.uninteractable=="boolean"||Array.isArray(this.customData.localRotation)||typeof this.customData.noteJumpMovementSpeed=="number"||typeof this.customData.noteJumpStartBeatOffset=="number"||Array.isArray(this.customData.coordinates)||Array.isArray(this.customData.worldRotation)||typeof this.customData.worldRotation=="number"||typeof this.customData.link=="string"}};ae.default={object:{b:0,i:0,r:0,customData:{}},data:{c:0,x:0,y:0,d:0,a:0,customData:{}}};let so=ae;const Jr=class Jr extends Un{constructor(t={}){super(),this.list=[]}static create(t={}){return new this(t)}static fromJSON(t){return new this}toJSON(){return{_keywords:[]}}get list(){return this._list}set list(t){this._list=t}addList(t){return this._list.push(t),this}};Jr.default={_keywords:[]};let gr=Jr;const fi=class fi extends Th{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??fi.default.object.b,this._executionTime=t.executionTime??fi.default.data.e,this._rotation=t.rotation??fi.default.data.r,this._customData=C(t.customData??fi.default.data.customData)}static fromJSON(t={},e={}){const o=new this;return o._time=t.b??fi.default.object.b,o._executionTime=e.e??fi.default.data.e,o._rotation=e.r??fi.default.data.r,o._customData=C(e.customData??fi.default.data.customData),o}toJSON(){return{object:{b:this.time},data:{e:this.executionTime,r:this.rotation,customData:C(this.customData)}}}get customData(){return this._customData}set customData(t){this._customData=t}};fi.default={object:{b:0,i:0,customData:{}},data:{e:0,r:0,customData:{}}};let Bs=fi;function zi(i){return["beatmap","v4","difficulty",i]}const Jt=class Jt extends Hn{constructor(t={}){var e;super(),this.version="4.0.0",this.bpmEvents=[],this.rotationEvents=[],this.waypoints=[],this.basicEvents=[],this.colorBoostEvents=[],this.lightColorEventBoxGroups=[],this.lightRotationEventBoxGroups=[],this.lightTranslationEventBoxGroups=[],this.fxEventBoxGroups=[],this.eventTypesWithKeywords=new gr,this.useNormalEventsAsCompatibleEvents=!1,this.filename=t.filename??this.filename,t.colorNotes?this.colorNotes=t.colorNotes.map(o=>new so(o)):this.colorNotes=Jt.default.colorNotes.map(o=>{var s,n;return so.fromJSON(o,(n=(s=Jt.default)==null?void 0:s.colorNotesData)==null?void 0:n[(o==null?void 0:o.i)||0])}),t.bombNotes?this.bombNotes=t.bombNotes.map(o=>new eo(o)):this.bombNotes=Jt.default.bombNotes.map(o=>{var s,n;return eo.fromJSON(o,(n=(s=Jt.default)==null?void 0:s.bombNotesData)==null?void 0:n[(o==null?void 0:o.i)||0])}),t.obstacles?this.obstacles=t.obstacles.map(o=>new Ze(o)):this.obstacles=Jt.default.obstacles.map(o=>{var s,n;return Ze.fromJSON(o,(n=(s=Jt.default)==null?void 0:s.obstaclesData)==null?void 0:n[(o==null?void 0:o.i)||0])}),t.arcs?this.arcs=t.arcs.map(o=>new Qi(o)):this.arcs=(((e=Jt.default)==null?void 0:e.arcs)??Jt.default.arcs).map(o=>{var s,n,r,a,l,f;return Qi.fromJSON(o,(n=(s=Jt.default)==null?void 0:s.arcsData)==null?void 0:n[(o==null?void 0:o.ai)||0],(a=(r=Jt.default)==null?void 0:r.colorNotesData)==null?void 0:a[(o==null?void 0:o.hi)||0],(f=(l=Jt.default)==null?void 0:l.colorNotesData)==null?void 0:f[(o==null?void 0:o.ti)||0])}),t.chains?this.chains=t.chains.map(o=>new io(o)):this.chains=Jt.default.chains.map(o=>{var s,n,r,a;return io.fromJSON(o,(n=(s=Jt.default)==null?void 0:s.colorNotesData)==null?void 0:n[(o==null?void 0:o.i)||0],(a=(r=Jt.default)==null?void 0:r.chainsData)==null?void 0:a[(o==null?void 0:o.ci)||0])}),this.customData=C(t.customData??Jt.default.customData)}static create(t={}){return new this(t)}static fromJSON(t={}){const e=new this;return e.colorNotes=((t==null?void 0:t.colorNotes)??Jt.default.colorNotes).map(o=>{var s;return so.fromJSON(o,(s=t==null?void 0:t.colorNotesData)==null?void 0:s[(o==null?void 0:o.i)||0])}),e.bombNotes=((t==null?void 0:t.bombNotes)??Jt.default.bombNotes).map(o=>{var s;return eo.fromJSON(o,(s=t==null?void 0:t.bombNotesData)==null?void 0:s[(o==null?void 0:o.i)||0])}),e.obstacles=((t==null?void 0:t.obstacles)??Jt.default.obstacles).map(o=>{var s;return Ze.fromJSON(o,(s=t==null?void 0:t.obstaclesData)==null?void 0:s[(o==null?void 0:o.i)||0])}),e.arcs=((t==null?void 0:t.arcs)??Jt.default.arcs).map(o=>{var s,n,r;return Qi.fromJSON(o,(s=t==null?void 0:t.arcsData)==null?void 0:s[(o==null?void 0:o.ai)||0],(n=t==null?void 0:t.colorNotesData)==null?void 0:n[(o==null?void 0:o.hi)||0],(r=t==null?void 0:t.colorNotesData)==null?void 0:r[(o==null?void 0:o.ti)||0])}),e.chains=((t==null?void 0:t.chains)??Jt.default.chains).map(o=>{var s,n;return io.fromJSON(o,(s=t==null?void 0:t.colorNotesData)==null?void 0:s[(o==null?void 0:o.i)||0],(n=t==null?void 0:t.chainsData)==null?void 0:n[(o==null?void 0:o.ci)||0])}),e.customData=C((t==null?void 0:t.customData)??Jt.default.customData),e}toJSON(){const t={version:this.version,colorNotes:[],bombNotes:[],obstacles:[],chains:[],arcs:[],spawnRotations:[],colorNotesData:[],bombNotesData:[],obstaclesData:[],chainsData:[],arcsData:[],spawnRotationsData:[],customData:C(this.customData)};for(const e of this.colorNotes){const o=e.toJSON();t.colorNotes.push(o.object),o.object.i=t.colorNotesData.length,t.colorNotesData.push(o.data)}for(const e of this.bombNotes){const o=e.toJSON();t.bombNotes.push(o.object),o.object.i=t.bombNotesData.length,t.bombNotesData.push(o.data)}for(const e of this.obstacles){const o=e.toJSON();t.obstacles.push(o.object),o.object.i=t.obstaclesData.length,t.obstaclesData.push(o.data)}for(const e of this.arcs){const o=e.toJSON();t.arcs.push(o.object),o.object.ai=t.arcsData.length,t.arcsData.push(o.data),o.object.hi=t.colorNotesData.length,t.colorNotesData.push(o.headData),o.object.ti=t.colorNotesData.length,t.colorNotesData.push(o.tailData)}for(const e of this.chains){const o=e.toJSON();t.chains.push(o.object),o.object.i=t.colorNotesData.length,t.colorNotesData.push(o.data),o.object.ci=t.chainsData.length,t.chainsData.push(o.chainData)}for(const e of this.rotationEvents){const o=e.toJSON();t.spawnRotations.push(o.object),o.object.i=t.spawnRotationsData.length,t.spawnRotationsData.push(o.data)}return t}get customData(){return this._customData}set customData(t){this._customData=t}reparse(t){return this.colorNotes=this.colorNotes.map(e=>this.createOrKeep(so,e,t)),this.bombNotes=this.bombNotes.map(e=>this.createOrKeep(eo,e,t)),this.arcs=this.arcs.map(e=>this.createOrKeep(Qi,e,t)),this.chains=this.chains.map(e=>this.createOrKeep(io,e,t)),this.obstacles=this.obstacles.map(e=>this.createOrKeep(Ze,e,t)),this}addBpmEvents(...t){return W.tWarn(zi("addBpmEvents"),"BPM Event does not exist in difficulty V4"),this}addRotationEvents(...t){for(const e of t)this.rotationEvents.push(new Bs(e));return this}addColorNotes(...t){for(const e of t)this.colorNotes.push(new so(e));return this}addBombNotes(...t){for(const e of t)this.bombNotes.push(new eo(e));return this}addObstacles(...t){for(const e of t)this.obstacles.push(new Ze(e));return this}addArcs(...t){for(const e of t)this.arcs.push(new Qi(e));return this}addChains(...t){for(const e of t)this.chains.push(new io(e));return this}addWaypoints(...t){return W.tWarn(zi("addWaypoints"),"Waypoint does not exist in difficulty V4"),this}addBasicEvents(...t){return W.tWarn(zi("addBasicEvents"),"Basic Event does not exist in difficulty V4"),this}addColorBoostEvents(...t){return W.tWarn(zi("addColorBoostEvents"),"Color Boost Event does not exist in difficulty V4"),this}addLightColorEventBoxGroups(...t){return W.tWarn(zi("addLightColorEventBoxGroups"),"Light Color Event Box Group does not exist in difficulty V4"),this}addLightRotationEventBoxGroups(...t){return W.tWarn(zi("addLightRotationEventBoxGroups"),"Light Rotation Event Box Group does not exist in difficulty V4"),this}addLightTranslationEventBoxGroups(...t){return W.tWarn(zi("addLightTranslationEventBoxGroups"),"Light Translation Event Box Group does not exist in difficulty V4"),this}addFxEventBoxGroups(...t){return W.tWarn(zi("addFxEventBoxGroups"),"FX Event Box Group does not exist in difficulty V4"),this}isValid(){return this.colorNotes.every(t=>this.checkClass(so,t))&&this.bombNotes.every(t=>this.checkClass(eo,t))&&this.arcs.every(t=>this.checkClass(Qi,t))&&this.chains.every(t=>this.checkClass(io,t))&&this.obstacles.every(t=>this.checkClass(Ze,t))}};Jt.default={version:"4.0.0",colorNotes:[],bombNotes:[],obstacles:[],chains:[],arcs:[],spawnRotations:[],colorNotesData:[],bombNotesData:[],obstaclesData:[],chainsData:[],arcsData:[],spawnRotationsData:[],customData:{}};let Ro=Jt;const Wt=class Wt extends bh{static create(t={}){return new Wt(t)}constructor(t={}){super(),this._type=t.type??Wt.default.f,this._p0=t.p0??Wt.default.p,this._p1=t.p1??Wt.default.t,this._reverse=t.reverse??Wt.default.r,this._chunks=t.chunks??Wt.default.c,this._random=t.random??Wt.default.n,this._seed=t.seed??Wt.default.s,this._limit=t.limit??Wt.default.l,this._limitAffectsType=t.limitAffectsType??Wt.default.d,this._customData=C(t.customData??Wt.default.customData)}static fromJSON(t={}){const e=new this;return e._type=t.f??Wt.default.f,e._p0=t.p??Wt.default.p,e._p1=t.t??Wt.default.t,e._reverse=t.r??Wt.default.r,e._chunks=t.c??Wt.default.c,e._random=t.n??Wt.default.n,e._seed=t.s??Wt.default.s,e._limit=t.l??Wt.default.l,e._limitAffectsType=t.d??Wt.default.d,e._customData=C(t.customData??Wt.default.customData),e}toJSON(){return{f:this.type,p:this.p0,t:this.p1,r:this.reverse,c:this.chunks,n:this.random,s:this.seed,l:this.limit,d:this.limitAffectsType,customData:C(this.customData)}}get customData(){return this._customData}set customData(t){this._customData=t}};Wt.default={f:1,p:0,t:0,r:0,c:0,n:0,s:0,l:0,d:0,customData:{}};let me=Wt;const Me=class Me extends dh{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??Me.default.time,this._previous=t.previous??Me.default.data.p,this._easing=t.easing??Me.default.data.e,this._value=t.value??Me.default.data.v,this._customData=C(t.customData??Me.default.data.customData)}static fromJSON(t={},e){const o=new this;return o._time=e??Me.default.time,o._previous=t.p??Me.default.data.p,o._easing=t.e??Me.default.data.e,o._value=t.v??Me.default.data.v,o._customData=C(t.customData??Me.default.data.customData),o}toJSON(){return{data:{p:this.previous,e:this.easing,v:this.value,customData:C(this.customData)},time:this.time}}get customData(){return this._customData}set customData(t){this._customData=t}};Me.default={data:{p:0,e:0,v:0,customData:{}},time:0};let _s=Me;const zt=class zt extends mh{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),t.filter?this._filter=new me(t.filter):this._filter=me.fromJSON(zt.default.filterData),this._beatDistribution=t.beatDistribution??zt.default.data.w,this._beatDistributionType=t.beatDistributionType??zt.default.data.d,this._fxDistribution=t.fxDistribution??zt.default.data.s,this._fxDistributionType=t.fxDistributionType??zt.default.data.t,this._affectFirst=t.affectFirst??zt.default.data.b,this._easing=t.easing??zt.default.data.e,t.events?this._events=t.events.map(e=>new _s(e)):this._events=zt.default.eventData.map(e=>_s.fromJSON(e.data,e.time)),this._customData=C(t.customData??zt.default.data.customData)}static fromJSON(t={},e,o,s){const n=new this;return n._filter=me.fromJSON(s??zt.default.filterData),n._beatDistribution=t.w??zt.default.data.w,n._beatDistributionType=t.d??zt.default.data.d,n._fxDistribution=t.s??zt.default.data.s,n._fxDistributionType=t.t??zt.default.data.t,n._affectFirst=t.b??zt.default.data.b,n._easing=t.e??zt.default.data.e,n._events=(e??zt.default.eventData).map((r,a)=>_s.fromJSON(r,o==null?void 0:o[a])),n._customData=C(t.customData??zt.default.data.customData),n}toJSON(){return{data:{w:this.beatDistribution,d:this.beatDistributionType,s:this.fxDistribution,t:this.fxDistributionType,b:this.affectFirst,e:this.easing,customData:C(this.customData)},eventData:this.events.map(t=>t.toJSON()),filterData:this.filter.toJSON()}}get filter(){return this._filter}set filter(t){this._filter=t}get events(){return this._events}set events(t){this._events=t}get customData(){return this._customData}set customData(t){this._customData=t}setEvents(t){return this.events=t,this}};zt.default={data:{w:0,d:1,s:0,t:1,b:0,e:0,customData:{}},eventData:[],filterData:{...me.default}};let Ln=zt;const Ii=class Ii extends ph{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??Ii.default.object.b,this._id=t.id??Ii.default.object.g,this._boxes=(t.boxes??[]).map(e=>new Ln(e)),this._customData=C(t.customData??Ii.default.object.customData)}static fromJSON(t={},e,o,s){const n=new this;if(n._time=t.b??Ii.default.object.b,n._id=t.g??Ii.default.object.g,o||(o=[]),t.e)for(const r of t.e){const a=[],l=[];for(const f of r.l||[])l.push(f.b||0),a.push(o[f.i||0]);n._boxes.push(Ln.fromJSON((e==null?void 0:e[r.e||0])||{},a,l,s==null?void 0:s[r.f||0]))}return n._customData=C(t.customData??Ii.default.object.customData),n}toJSON(){return{object:{t:He.FX_FLOAT,b:this.time,g:this.id,e:[],customData:C(this.customData)},boxData:this.boxes.map(t=>t.toJSON())}}get boxes(){return this._boxes}set boxes(t){this._boxes=t}get customData(){return this._customData}set customData(t){this._customData=t}isValid(){return this.id>=0}};Ii.default={object:{t:He.TRANSLATION,b:0,g:0,e:[],customData:{}},boxData:[]};let _o=Ii;const yt=class yt extends Rr{constructor(t={}){var e,o,s,n,r,a,l,f,h,p;super(),this.version="4.0.0",this.song={title:"",subTitle:"",author:""},this.audio={filename:"",duration:0,audioDataFilename:"",bpm:0,lufs:0,previewStartTime:0,previewDuration:0},this.songPreviewFilename="",this.coverImageFilename="",this.difficulties=[],this.filename=t.filename??this.filename,this.song.author=((e=t.song)==null?void 0:e.author)||yt.default.song.author,this.song.title=((o=t.song)==null?void 0:o.title)||yt.default.song.title,this.song.subTitle=((s=t.song)==null?void 0:s.subTitle)||yt.default.song.subTitle,this.audio.filename=((n=t.audio)==null?void 0:n.filename)||yt.default.audio.songFilename,this.audio.duration=((r=t.audio)==null?void 0:r.duration)||yt.default.audio.songDuration,this.audio.audioDataFilename=((a=t.audio)==null?void 0:a.audioDataFilename)||yt.default.audio.audioDataFilename,this.audio.bpm=((l=t.audio)==null?void 0:l.bpm)||yt.default.audio.bpm,this.audio.lufs=((f=t.audio)==null?void 0:f.lufs)||yt.default.audio.lufs,this.audio.previewStartTime=((h=t.audio)==null?void 0:h.previewStartTime)||yt.default.audio.previewStartTime,this.audio.previewDuration=((p=t.audio)==null?void 0:p.previewDuration)||yt.default.audio.previewDuration,this.songPreviewFilename=t.songPreviewFilename||yt.default.songPreviewFilename,this.coverImageFilename=t.coverImageFilename||yt.default.coverImageFilename,this.environmentNames=(t.environmentNames??yt.default.environmentNames).map(c=>c),t.colorSchemes?this.colorSchemes=t.colorSchemes.map(c=>{c=c;const u={useOverride:!!c.useOverride,name:c.name||"",saberLeftColor:{r:0,g:0,b:0,a:0,...c.saberLeftColor},saberRightColor:{r:0,g:0,b:0,a:0,...c.saberRightColor},environment0Color:{r:0,g:0,b:0,a:0,...c.environment0Color},environment1Color:{r:0,g:0,b:0,a:0,...c.environment1Color},obstaclesColor:{r:0,g:0,b:0,a:0,...c.obstaclesColor},environment0ColorBoost:{r:0,g:0,b:0,a:0,...c.environment0ColorBoost},environment1ColorBoost:{r:0,g:0,b:0,a:0,...c.environment1ColorBoost}};return c.environmentWColor&&(u.environmentWColor=xt(c.environmentWColor)),c.environmentWColorBoost&&(u.environmentWColorBoost=xt(c.environmentWColorBoost)),u}):this.colorSchemes=yt.default.colorSchemes.map(c=>{const u={useOverride:!!c.useOverride,name:c.colorSchemeName||"",saberLeftColor:Kt(ie(c.saberAColor),!0),saberRightColor:Kt(ie(c.saberBColor),!0),environment0Color:Kt(ie(c.environmentColor0),!0),environment1Color:Kt(ie(c.environmentColor1),!0),obstaclesColor:Kt(ie(c.obstaclesColor),!0),environment0ColorBoost:Kt(ie(c.environmentColor0Boost),!0),environment1ColorBoost:Kt(ie(c.environmentColor1Boost),!0)};return c.environmentColorW&&(u.environmentWColor=Kt(ie(c.environmentColorW),!0)),c.environmentColorWBoost&&(u.environmentWColorBoost=Kt(ie(c.environmentColorWBoost),!0)),u}),this.customData=C(t.customData??yt.default.customData),this.difficulties=(t.difficulties??yt.default.difficultyBeatmaps).map(c=>new Ds(c))}static create(t={}){return new this(t)}static fromJSON(t={}){var o,s,n,r,a,l,f,h,p,c;const e=new this;return e.song.author=((o=t.song)==null?void 0:o.author)||yt.default.song.author,e.song.title=((s=t.song)==null?void 0:s.title)||yt.default.song.title,e.song.subTitle=((n=t.song)==null?void 0:n.subTitle)||yt.default.song.subTitle,e.audio.filename=((r=t.audio)==null?void 0:r.songFilename)||yt.default.audio.songFilename,e.audio.duration=((a=t.audio)==null?void 0:a.songDuration)||yt.default.audio.songDuration,e.audio.audioDataFilename=((l=t.audio)==null?void 0:l.audioDataFilename)||yt.default.audio.audioDataFilename,e.audio.bpm=((f=t.audio)==null?void 0:f.bpm)||yt.default.audio.bpm,e.audio.lufs=((h=t.audio)==null?void 0:h.lufs)||yt.default.audio.lufs,e.audio.previewStartTime=((p=t.audio)==null?void 0:p.previewStartTime)||yt.default.audio.previewStartTime,e.audio.previewDuration=((c=t.audio)==null?void 0:c.previewDuration)||yt.default.audio.previewDuration,e.songPreviewFilename=t.songPreviewFilename||yt.default.songPreviewFilename,e.coverImageFilename=t.coverImageFilename||yt.default.coverImageFilename,e.environmentNames=(t.environmentNames??yt.default.environmentNames).map(u=>u),e.colorSchemes=(t.colorSchemes??yt.default.colorSchemes).map(u=>{u=u;const b={useOverride:!!u.useOverride,name:u.colorSchemeName||"",saberLeftColor:Kt(ie(u.saberAColor),!0),saberRightColor:Kt(ie(u.saberBColor),!0),environment0Color:Kt(ie(u.environmentColor0),!0),environment1Color:Kt(ie(u.environmentColor1),!0),obstaclesColor:Kt(ie(u.obstaclesColor),!0),environment0ColorBoost:Kt(ie(u.environmentColor0Boost),!0),environment1ColorBoost:Kt(ie(u.environmentColor1Boost),!0)};return u.environmentColorW&&(b.environmentWColor=Kt(ie(u.environmentColorW),!0)),u.environmentColorWBoost&&(b.environmentWColorBoost=Kt(ie(u.environmentColorWBoost),!0)),b}),e.customData=C(t.customData??yt.default.customData),e.difficulties=(t.difficultyBeatmaps??[]).map(u=>Ds.fromJSON(u)),e}toJSON(){return{version:this.version,song:{author:this.song.author,title:this.song.title,subTitle:this.song.subTitle},audio:{songFilename:this.audio.filename,songDuration:this.audio.duration,audioDataFilename:this.audio.audioDataFilename,bpm:this.audio.bpm,lufs:this.audio.lufs,previewStartTime:this.audio.previewStartTime,previewDuration:this.audio.previewDuration},songPreviewFilename:this.songPreviewFilename,coverImageFilename:this.coverImageFilename,environmentNames:this.environmentNames.map(t=>t),colorSchemes:this.colorSchemes.map(t=>{const e={useOverride:t.useOverride,colorSchemeName:t.name,saberAColor:pt(t.saberLeftColor),saberBColor:pt(t.saberRightColor),environmentColor0:pt(t.environment0Color),environmentColor1:pt(t.environment1Color),obstaclesColor:pt(t.obstaclesColor),environmentColor0Boost:pt(t.environment0ColorBoost),environmentColor1Boost:pt(t.environment1ColorBoost)};return t.environmentWColor&&(e.environmentColorW=pt(t.environmentWColor)),t.environmentWColorBoost&&(e.environmentColorWBoost=pt(t.environmentWColorBoost)),e}),difficultyBeatmaps:this.difficulties.map(t=>t.toJSON()),customData:C(this.customData)}}get customData(){return this._customData}set customData(t){this._customData=t}addMap(t){return this.difficulties.push(new Ds(t)),this}listMap(){return super.listMap()}isValid(){throw new Error("Method not implemented.")}};yt.default={version:"4.0.0",song:{author:"",title:"",subTitle:""},audio:{songFilename:"",songDuration:0,audioDataFilename:"",bpm:0,lufs:0,previewStartTime:0,previewDuration:0},songPreviewFilename:"",coverImageFilename:"",environmentNames:[],colorSchemes:[],difficultyBeatmaps:[],customData:{}};let ts=yt;const $t=class $t extends Or{constructor(t={}){var e,o;super(),this.authors={mappers:[],lighters:[]},this.characteristic=t.characteristic??$t.default.characteristic,this.difficulty=t.difficulty??$t.default.difficulty,this.authors.mappers=(((e=t.authors)==null?void 0:e.mappers)??$t.default.beatmapAuthors.mappers).map(s=>s),this.authors.lighters=(((o=t.authors)==null?void 0:o.lighters)??$t.default.beatmapAuthors.lighters).map(s=>s),this.filename=t.filename??$t.default.beatmapDataFilename,this.lightshowFilename=t.lightshowFilename??$t.default.lightshowDataFilename,this.njs=t.njs??$t.default.noteJumpMovementSpeed,this.njsOffset=t.njsOffset??$t.default.noteJumpStartBeatOffset,this.colorSchemeId=t.colorSchemeId??$t.default.beatmapColorSchemeIdx,this.environmentId=t.environmentId??$t.default.environmentNameIdx,this.customData=C(t.customData??$t.default.customData)}static create(t){return new this(t)}static fromJSON(t){var o,s;const e=new this;return e.characteristic=t.characteristic??$t.default.characteristic,e.difficulty=t.difficulty??$t.default.difficulty,e.authors.mappers=(((o=t.beatmapAuthors)==null?void 0:o.mappers)??$t.default.beatmapAuthors.mappers).map(n=>n),e.authors.lighters=(((s=t.beatmapAuthors)==null?void 0:s.lighters)??$t.default.beatmapAuthors.lighters).map(n=>n),e.filename=t.beatmapDataFilename??$t.default.beatmapDataFilename,e.lightshowFilename=t.lightshowDataFilename??$t.default.lightshowDataFilename,e.njs=t.noteJumpMovementSpeed??$t.default.noteJumpMovementSpeed,e.njsOffset=t.noteJumpStartBeatOffset??$t.default.noteJumpStartBeatOffset,e.colorSchemeId=t.beatmapColorSchemeIdx??$t.default.beatmapColorSchemeIdx,e.environmentId=t.environmentNameIdx??$t.default.environmentNameIdx,e.customData=C(t.customData??$t.default.customData),e}toJSON(){return{characteristic:this.characteristic,difficulty:this.difficulty,beatmapAuthors:{mappers:[...this.authors.mappers],lighters:[...this.authors.lighters]},environmentNameIdx:this.environmentId,beatmapColorSchemeIdx:this.colorSchemeId,noteJumpMovementSpeed:this.njs,noteJumpStartBeatOffset:this.njsOffset,lightshowDataFilename:this.lightshowFilename,beatmapDataFilename:this.filename,customData:C(this.customData)}}get customData(){return this._customData}set customData(t){this._customData=t}copyColorScheme(t,e){if(typeof t=="number"){if(e.colorSchemes.length<t)return this;const o=e.colorSchemes[t];return this.copyColorScheme(o)}return this.customData._colorLeft=Object.entries(t.saberLeftColor).reduce((o,s)=>(o[s[0]]=s[1],o),{r:0,g:0,b:0}),this.customData._colorRight=Object.entries(t.saberRightColor).reduce((o,s)=>(o[s[0]]=s[1],o),{r:0,g:0,b:0}),this.customData._envColorLeft=Object.entries(t.environment0Color).reduce((o,s)=>(o[s[0]]=s[1],o),{r:0,g:0,b:0}),this.customData._envColorRight=Object.entries(t.environment1Color).reduce((o,s)=>(o[s[0]]=s[1],o),{r:0,g:0,b:0}),this.customData._envColorLeftBoost=Object.entries(t.environment0ColorBoost).reduce((o,s)=>(o[s[0]]=s[1],o),{r:0,g:0,b:0}),this.customData._envColorRightBoost=Object.entries(t.environment1ColorBoost).reduce((o,s)=>(o[s[0]]=s[1],o),{r:0,g:0,b:0}),this.customData._obstacleColor=Object.entries(t.obstaclesColor).reduce((o,s)=>(o[s[0]]=s[1],o),{r:0,g:0,b:0}),this}isValid(){throw new Error("Method not implemented.")}};$t.default={characteristic:"Standard",difficulty:"Easy",beatmapAuthors:{mappers:[],lighters:[]},environmentNameIdx:0,beatmapColorSchemeIdx:0,noteJumpMovementSpeed:0,noteJumpStartBeatOffset:0,beatmapDataFilename:"UnnamedFile.dat",lightshowDataFilename:"UnnamedFile.dat",customData:{}};let Ds=$t;const Ut=class Ut extends gh{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??Ut.default.time,this._previous=t.previous??Ut.default.data.p,this._color=t.color??Ut.default.data.c,this._frequency=t.frequency??Ut.default.data.f,this.transition=t.transition??t.previous??0,this._easing=t.easing??Ut.default.data.e,this._brightness=t.brightness??Ut.default.data.b,this._strobeBrightness=t.strobeBrightness??Ut.default.data.sb,this._strobeFade=t.strobeFade??Ut.default.data.sf,this._customData=C(t.customData??Ut.default.data.customData)}static fromJSON(t={},e){const o=new this;return o._time=e??Ut.default.time,o._previous=t.p??Ut.default.data.p,o._color=t.c??Ut.default.data.c,o._frequency=t.f??Ut.default.data.f,o._easing=t.e??Ut.default.data.e,o._brightness=t.b??Ut.default.data.b,o._strobeBrightness=t.sb??Ut.default.data.sb,o._strobeFade=t.sf??Ut.default.data.sf,o._customData=C(t.customData??Ut.default.data.customData),o}toJSON(){return{data:{p:this.previous,c:this.color,e:this.easing,b:this.brightness,f:this.frequency,sb:this.strobeBrightness,sf:this.strobeFade,customData:C(this.customData)},time:this.time}}get transition(){return this.previous?2:this.easing===-1?0:1}set transition(t){t===0&&(this.easing=-1),t===1&&(this.easing=0),t===2&&(this.previous=1)}get customData(){return this._customData}set customData(t){this._customData=t}};Ut.default={data:{p:0,c:0,e:0,b:0,f:0,sb:0,sf:0,customData:{}},time:0};let Es=Ut;const qt=class qt extends vh{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),t.filter?this._filter=new me(t.filter):this._filter=me.fromJSON(qt.default.filterData),this._beatDistribution=t.beatDistribution??qt.default.data.w,this._beatDistributionType=t.beatDistributionType??qt.default.data.d,this._brightnessDistribution=t.brightnessDistribution??qt.default.data.s,this._brightnessDistributionType=t.brightnessDistributionType??qt.default.data.t,this._affectFirst=t.affectFirst??qt.default.data.b,this._easing=t.easing??qt.default.data.e,t.events?this._events=t.events.map(e=>new Es(e)):this._events=qt.default.eventData.map(e=>Es.fromJSON(e.data,e.time)),this._customData=C(t.customData??qt.default.data.customData)}static fromJSON(t={},e,o,s){const n=new this;return n._filter=me.fromJSON(s??qt.default.filterData),n._beatDistribution=t.w??qt.default.data.w,n._beatDistributionType=t.d??qt.default.data.d,n._brightnessDistribution=t.s??qt.default.data.s,n._brightnessDistributionType=t.t??qt.default.data.t,n._affectFirst=t.b??qt.default.data.b,n._easing=t.e??qt.default.data.e,n._events=(e??qt.default.eventData).map((r,a)=>Es.fromJSON(r,o==null?void 0:o[a])),n._customData=C(t.customData??qt.default.data.customData),n}toJSON(){return{data:{w:this.beatDistribution,d:this.beatDistributionType,s:this.brightnessDistribution,t:this.brightnessDistributionType,b:this.affectFirst,e:this.easing,customData:C(this.customData)},eventData:this.events.map(t=>t.toJSON()),filterData:this.filter.toJSON()}}get filter(){return this._filter}set filter(t){this._filter=t}get events(){return this._events}set events(t){this._events=t}get customData(){return this._customData}set customData(t){this._customData=t}setEvents(t){return this.events=t,this}};qt.default={data:{w:0,d:1,s:0,t:1,b:0,e:0,customData:{}},eventData:[],filterData:{...me.default}};let Nn=qt;const Pi=class Pi extends yh{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??Pi.default.object.b,this._id=t.id??Pi.default.object.g,this._boxes=(t.boxes??[]).map(e=>new Nn(e)),this._customData=C(t.customData??Pi.default.object.customData)}static fromJSON(t={},e,o,s){const n=new this;if(n._time=t.b??Pi.default.object.b,n._id=t.g??Pi.default.object.g,o||(o=[]),t.e)for(const r of t.e){const a=[],l=[];for(const f of r.l||[])l.push(f.b||0),a.push(o[f.i||0]);n._boxes.push(Nn.fromJSON((e==null?void 0:e[r.e||0])||{},a,l,s==null?void 0:s[r.f||0]))}return n._customData=C(t.customData??Pi.default.object.customData),n}toJSON(){return{object:{t:He.COLOR,b:this.time,g:this.id,e:[],customData:C(this.customData)},boxData:this.boxes.map(t=>t.toJSON())}}get boxes(){return this._boxes}set boxes(t){this._boxes=t}get customData(){return this._customData}set customData(t){this._customData=t}isValid(){return this.id>=0}};Pi.default={object:{t:He.TRANSLATION,b:0,g:0,e:[],customData:{}},boxData:[]};let Do=Pi;const ge=class ge extends _h{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??ge.default.time,this._previous=t.previous??ge.default.data.p,this._easing=t.easing??ge.default.data.e,this._loop=t.loop??ge.default.data.l,this._rotation=t.rotation??ge.default.data.r,this._direction=t.direction??ge.default.data.d,this._customData=C(t.customData??ge.default.data.customData)}static fromJSON(t={},e){const o=new this;return o._time=e??ge.default.time,o._previous=t.p??ge.default.data.p,o._easing=t.e??ge.default.data.e,o._loop=t.l??ge.default.data.l,o._rotation=t.r??ge.default.data.r,o._direction=t.d??ge.default.data.d,o._customData=C(t.customData??ge.default.data.customData),o}toJSON(){return{data:{p:this.previous,l:this.loop,e:this.easing,r:this.rotation,d:this.direction,customData:C(this.customData)},time:this.time}}get customData(){return this._customData}set customData(t){this._customData=t}};ge.default={data:{p:0,e:0,l:0,r:0,d:0,customData:{}},time:0};let ws=ge;const Mt=class Mt extends Dh{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),t.filter?this._filter=new me(t.filter):this._filter=me.fromJSON(Mt.default.filterData),this._beatDistribution=t.beatDistribution??Mt.default.data.w,this._beatDistributionType=t.beatDistributionType??Mt.default.data.d,this._rotationDistribution=t.rotationDistribution??Mt.default.data.s,this._rotationDistributionType=t.rotationDistributionType??Mt.default.data.t,this._affectFirst=t.affectFirst??Mt.default.data.b,this._easing=t.easing??Mt.default.data.e,this._axis=t.axis??Mt.default.data.a,this._flip=t.flip??Mt.default.data.f,t.events?this._events=t.events.map(e=>new ws(e)):this._events=Mt.default.eventData.map(e=>ws.fromJSON(e.data,e.time)),this._customData=C(t.customData??Mt.default.data.customData)}static fromJSON(t={},e,o,s){const n=new this;return n._filter=me.fromJSON(s??Mt.default.filterData),n._beatDistribution=t.w??Mt.default.data.w,n._beatDistributionType=t.d??Mt.default.data.d,n._rotationDistribution=t.s??Mt.default.data.s,n._rotationDistributionType=t.t??Mt.default.data.t,n._affectFirst=t.b??Mt.default.data.b,n._easing=t.e??Mt.default.data.e,n._axis=t.a??Mt.default.data.a,n._flip=t.f??Mt.default.data.f,n._events=(e??Mt.default.eventData).map((r,a)=>ws.fromJSON(r,o==null?void 0:o[a])),n._customData=C(t.customData??Mt.default.data.customData),n}toJSON(){return{data:{w:this.beatDistribution,d:this.beatDistributionType,s:this.rotationDistribution,t:this.rotationDistributionType,b:this.affectFirst,e:this.easing,a:this.axis,f:this.flip,customData:C(this.customData)},eventData:this.events.map(t=>t.toJSON()),filterData:this.filter.toJSON()}}get filter(){return this._filter}set filter(t){this._filter=t}get events(){return this._events}set events(t){this._events=t}get customData(){return this._customData}set customData(t){this._customData=t}setEvents(t){return this.events=t,this}};Mt.default={data:{w:0,d:1,s:0,t:1,b:0,e:0,f:0,a:0,customData:{}},eventData:[],filterData:{...me.default}};let Bn=Mt;const $i=class $i extends Eh{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??$i.default.object.b,this._id=t.id??$i.default.object.g,this._boxes=(t.boxes??[]).map(e=>new Bn(e)),this._customData=C(t.customData??$i.default.object.customData)}static fromJSON(t={},e,o,s){const n=new this;if(n._time=t.b??$i.default.object.b,n._id=t.g??$i.default.object.g,o||(o=[]),t.e)for(const r of t.e){const a=[],l=[];for(const f of r.l||[])l.push(f.b||0),a.push(o[f.i||0]);n._boxes.push(Bn.fromJSON((e==null?void 0:e[r.e||0])||{},a,l,s==null?void 0:s[r.f||0]))}return n._customData=C(t.customData??$i.default.object.customData),n}toJSON(){return{object:{t:He.ROTATION,b:this.time,g:this.id,e:[],customData:C(this.customData)},boxData:this.boxes.map(t=>t.toJSON())}}get boxes(){return this._boxes}set boxes(t){this._boxes=t}get customData(){return this._customData}set customData(t){this._customData=t}isValid(){return this.id>=0}};$i.default={object:{t:He.TRANSLATION,b:0,g:0,e:[],customData:{}},boxData:[]};let Eo=$i;const xe=class xe extends Ar{constructor(t={}){super(),this._time=t.time??xe.default.object.b,this._laneRotation=t.laneRotation??xe.default.object.r,this._posX=t.posX??xe.default.data.x,this._posY=t.posY??xe.default.data.y,this._direction=t.direction??xe.default.data.d,this._customData=C(t.customData??xe.default.data.customData)}static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}static fromJSON(t={},e={}){const o=new this;return o._time=t.b??xe.default.object.b,o._laneRotation=t.r??xe.default.object.r,o._posX=e.x??xe.default.data.x,o._posY=e.y??xe.default.data.y,o._direction=e.d??xe.default.data.d,o._customData=C(e.customData??xe.default.data.customData),o}toJSON(){return{object:{b:this.time,i:0,r:this.laneRotation,customData:{}},data:{x:this.posX,y:this.posY,d:this.direction,customData:C(this.customData)}}}get customData(){return this._customData}set customData(t){this._customData=t}};xe.default={object:{b:0,i:0,r:0,customData:{}},data:{x:0,y:0,d:0,customData:{}}};let no=xe;const mi=class mi extends Sh{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??0,this._previous=t.previous??mi.default.data.p,this._easing=t.easing??mi.default.data.e,this._translation=t.translation??mi.default.data.t,this._customData=C(t.customData??mi.default.data.customData)}static fromJSON(t={},e){const o=new this;return o._time=e??0,o._previous=t.p??mi.default.data.p,o._easing=t.e??mi.default.data.e,o._translation=t.t??mi.default.data.t,o._customData=C(t.customData??mi.default.data.customData),o}toJSON(){return{data:{p:this.previous,e:this.easing,t:this.translation,customData:C(this.customData)},time:this.time}}get customData(){return this._customData}set customData(t){this._customData=t}};mi.default={data:{p:0,e:0,t:0,customData:{}},time:0};let Ss=mi;const Ft=class Ft extends Ch{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),t.filter?this._filter=new me(t.filter):this._filter=me.fromJSON(Ft.default.filterData),this._beatDistribution=t.beatDistribution??Ft.default.data.w,this._beatDistributionType=t.beatDistributionType??Ft.default.data.d,this._translationDistribution=t.gapDistribution??Ft.default.data.s,this._translationDistributionType=t.gapDistributionType??Ft.default.data.t,this._affectFirst=t.affectFirst??Ft.default.data.b,this._easing=t.easing??Ft.default.data.e,this._axis=t.axis??Ft.default.data.a,this._flip=t.flip??Ft.default.data.f,t.events?this._events=t.events.map(e=>new Ss(e)):this._events=Ft.default.eventData.map(e=>Ss.fromJSON(e.data,e.time)),this._customData=C(t.customData??Ft.default.data.customData)}static fromJSON(t={},e,o,s){const n=new this;return n._filter=me.fromJSON(s??Ft.default.filterData),n._beatDistribution=t.w??Ft.default.data.w,n._beatDistributionType=t.d??Ft.default.data.d,n._translationDistribution=t.s??Ft.default.data.s,n._translationDistributionType=t.t??Ft.default.data.t,n._affectFirst=t.b??Ft.default.data.b,n._easing=t.e??Ft.default.data.e,n._axis=t.a??Ft.default.data.a,n._flip=t.f??Ft.default.data.f,n._events=(e??Ft.default.eventData).map((r,a)=>Ss.fromJSON(r,o==null?void 0:o[a])),n._customData=C(t.customData??Ft.default.data.customData),n}toJSON(){return{data:{w:this.beatDistribution,d:this.beatDistributionType,s:this.gapDistribution,t:this.gapDistributionType,b:this.affectFirst,e:this.easing,a:this.axis,f:this.flip,customData:C(this.customData)},eventData:this.events.map(t=>t.toJSON()),filterData:this.filter.toJSON()}}get filter(){return this._filter}set filter(t){this._filter=t}get events(){return this._events}set events(t){this._events=t}get customData(){return this._customData}set customData(t){this._customData=t}setEvents(t){return this.events=t,this}};Ft.default={data:{w:0,d:1,s:0,t:1,b:0,e:0,f:0,a:0,customData:{}},eventData:[],filterData:{...me.default}};let kn=Ft;const Mi=class Mi extends xh{static create(...t){const e=t.map(o=>new this(o));return e.length?e:[new this]}constructor(t={}){super(),this._time=t.time??Mi.default.object.b,this._id=t.id??Mi.default.object.g,this._boxes=(t.boxes??[]).map(e=>new kn(e)),this._customData=C(t.customData??Mi.default.object.customData)}static fromJSON(t={},e,o,s){const n=new this;if(n._time=t.b??Mi.default.object.b,n._id=t.g??Mi.default.object.g,o||(o=[]),t.e)for(const r of t.e){const a=[],l=[];for(const f of r.l||[])l.push(f.b||0),a.push(o[f.i||0]);n._boxes.push(kn.fromJSON((e==null?void 0:e[r.e||0])||{},a,l,s==null?void 0:s[r.f||0]))}return n._customData=C(t.customData??Mi.default.object.customData),n}toJSON(){return{object:{t:He.TRANSLATION,b:this.time,g:this.id,e:[],customData:C(this.customData)},boxData:this.boxes.map(t=>t.toJSON())}}get boxes(){return this._boxes}set boxes(t){this._boxes=t}get customData(){return this._customData}set customData(t){this._customData=t}isValid(){return this.id>=0}};Mi.default={object:{t:He.TRANSLATION,b:0,g:0,e:[],customData:{}},boxData:[]};let wo=Mi;const pi=class pi extends wh{constructor(t={}){super(),this.version="4.0.0",this.lightColorEventBoxGroups=[],this.lightRotationEventBoxGroups=[],this.lightTranslationEventBoxGroups=[],this.fxEventBoxGroups=[],this.filename=t.filename??this.filename,t.waypoints?this.waypoints=t.waypoints.map(e=>new no(e)):this.waypoints=pi.default.waypoints.map(e=>no.fromJSON(e,pi.default.waypointsData[e.i||0])),t.basicEvents?this.basicEvents=t.basicEvents.map(e=>new to(e)):this.basicEvents=pi.default.basicEvents.map(e=>to.fromJSON(e,pi.default.basicEventsData[e.i||0])),t.colorBoostEvents?this.colorBoostEvents=t.colorBoostEvents.map(e=>new oo(e)):this.colorBoostEvents=pi.default.colorBoostEvents.map(e=>oo.fromJSON(e,pi.default.colorBoostEventsData[e.i||0])),this.lightColorEventBoxGroups=(t.lightColorEventBoxGroups??[]).map(e=>new Do(e)),this.lightRotationEventBoxGroups=(t.lightRotationEventBoxGroups??[]).map(e=>new Eo(e)),this.lightTranslationEventBoxGroups=(t.lightTranslationEventBoxGroups??[]).map(e=>new wo(e)),this.fxEventBoxGroups=(t.fxEventBoxGroups??[]).map(e=>new _o(e)),t.eventTypesWithKeywords?this.eventTypesWithKeywords=new Ee(t.eventTypesWithKeywords):this.eventTypesWithKeywords=Ee.fromJSON(pi.default.basicEventTypesWithKeywords),this.useNormalEventsAsCompatibleEvents=!!t.useNormalEventsAsCompatibleEvents,this.customData=C(t.customData??{})}static create(t={}){return new this(t)}static fromJSON(t={}){const e=new this;e.waypoints=((t==null?void 0:t.waypoints)??[]).map(o=>{var s;return no.fromJSON(o,(s=t==null?void 0:t.waypointsData)==null?void 0:s[(o==null?void 0:o.i)||0])}),e.basicEvents=((t==null?void 0:t.basicEvents)??[]).map(o=>{var s;return to.fromJSON(o,(s=t==null?void 0:t.basicEventsData)==null?void 0:s[(o==null?void 0:o.i)||0])}),e.colorBoostEvents=((t==null?void 0:t.colorBoostEvents)??[]).map(o=>{var s;return oo.fromJSON(o,(s=t==null?void 0:t.colorBoostEventsData)==null?void 0:s[(o==null?void 0:o.i)||0])});for(const o of(t==null?void 0:t.eventBoxGroups)||[])switch((o==null?void 0:o.t)||0){case He.COLOR:e.lightColorEventBoxGroups.push(Do.fromJSON(o,t==null?void 0:t.lightColorEventBoxes,t==null?void 0:t.lightColorEvents,t==null?void 0:t.indexFilters));break;case He.ROTATION:e.lightRotationEventBoxGroups.push(Eo.fromJSON(o,t==null?void 0:t.lightRotationEventBoxes,t==null?void 0:t.lightRotationEvents,t==null?void 0:t.indexFilters));break;case He.TRANSLATION:e.lightTranslationEventBoxGroups.push(wo.fromJSON(o,t==null?void 0:t.lightTranslationEventBoxes,t==null?void 0:t.lightTranslationEvents,t==null?void 0:t.indexFilters));break;case He.FX_FLOAT:e.fxEventBoxGroups.push(_o.fromJSON(o,t==null?void 0:t.fxEventBoxes,t==null?void 0:t.floatFxEvents,t==null?void 0:t.indexFilters));break}return e.eventTypesWithKeywords=Ee.fromJSON((t==null?void 0:t.basicEventTypesWithKeywords)||pi.default.basicEventTypesWithKeywords),e.useNormalEventsAsCompatibleEvents=!!(t!=null&&t.useNormalEventsAsCompatibleEvents),e.customData=C((t==null?void 0:t.customData)??{}),e}toJSON(){const t={version:this.version,waypoints:[],waypointsData:[],basicEvents:[],basicEventsData:[],colorBoostEvents:[],colorBoostEventsData:[],eventBoxGroups:[],indexFilters:[],lightColorEventBoxes:[],lightColorEvents:[],lightRotationEventBoxes:[],lightRotationEvents:[],lightTranslationEventBoxes:[],lightTranslationEvents:[],fxEventBoxes:[],floatFxEvents:[],basicEventTypesWithKeywords:this.eventTypesWithKeywords.toJSON(),useNormalEventsAsCompatibleEvents:this.useNormalEventsAsCompatibleEvents,customData:C(this.customData)};for(const e of this.waypoints){const o=e.toJSON();t.waypoints.push(o.object),o.object.i=t.waypointsData.length,t.waypointsData.push(o.data)}for(const e of this.basicEvents){const o=e.toJSON();t.basicEvents.push(o.object),o.object.i=t.basicEventsData.length,t.basicEventsData.push(o.data)}for(const e of this.colorBoostEvents){const o=e.toJSON();t.colorBoostEvents.push(o.object),o.object.i=t.colorBoostEventsData.length,t.colorBoostEventsData.push(o.data)}for(const e of this.lightColorEventBoxGroups.map(o=>o.toJSON())){t.eventBoxGroups.push(e.object);for(const o of e.boxData){const s=[];for(const n of o.eventData)s.push({b:n.time,i:t.lightColorEvents.length}),t.lightColorEvents.push(n.data);e.object.e.push({e:t.lightColorEventBoxes.length,f:t.indexFilters.length,l:s,customData:{}}),t.lightColorEventBoxes.push(o.data),t.indexFilters.push(o.filterData)}}for(const e of this.lightRotationEventBoxGroups.map(o=>o.toJSON())){t.eventBoxGroups.push(e.object);for(const o of e.boxData){const s=[];for(const n of o.eventData)s.push({b:n.time,i:t.lightRotationEvents.length}),t.lightRotationEvents.push(n.data);e.object.e.push({e:t.lightRotationEventBoxes.length,f:t.indexFilters.length,l:s,customData:{}}),t.lightRotationEventBoxes.push(o.data),t.indexFilters.push(o.filterData)}}for(const e of this.lightTranslationEventBoxGroups.map(o=>o.toJSON())){t.eventBoxGroups.push(e.object);for(const o of e.boxData){const s=[];for(const n of o.eventData)s.push({b:n.time,i:t.lightTranslationEvents.length}),t.lightTranslationEvents.push(n.data);e.object.e.push({e:t.lightTranslationEventBoxes.length,f:t.indexFilters.length,l:s,customData:{}}),t.lightTranslationEventBoxes.push(o.data),t.indexFilters.push(o.filterData)}}for(const e of this.fxEventBoxGroups.map(o=>o.toJSON())){t.eventBoxGroups.push(e.object);for(const o of e.boxData){const s=[];for(const n of o.eventData)s.push({b:n.time,i:t.floatFxEvents.length}),t.floatFxEvents.push(n.data);e.object.e.push({e:t.fxEventBoxes.length,f:t.indexFilters.length,l:s,customData:{}}),t.fxEventBoxes.push(o.data),t.indexFilters.push(o.filterData)}}return t}get customData(){return this._customData}set customData(t){this._customData=t}reparse(t){return this.waypoints=this.waypoints.map(e=>this.createOrKeep(no,e,t)),this.basicEvents=this.basicEvents.map(e=>this.createOrKeep(to,e,t)),this.colorBoostEvents=this.colorBoostEvents.map(e=>this.createOrKeep(oo,e,t)),this.lightColorEventBoxGroups=this.lightColorEventBoxGroups.map(e=>this.createOrKeep(Do,e,t)),this.lightRotationEventBoxGroups=this.lightRotationEventBoxGroups.map(e=>this.createOrKeep(Eo,e,t)),this.lightTranslationEventBoxGroups=this.lightTranslationEventBoxGroups.map(e=>this.createOrKeep(wo,e,t)),this.fxEventBoxGroups=this.fxEventBoxGroups.map(e=>this.createOrKeep(_o,e,t)),this.eventTypesWithKeywords=new Ee(this.eventTypesWithKeywords),this}addWaypoints(...t){for(const e of t)this.waypoints.push(new no(e));return this}addBasicEvents(...t){for(const e of t)this.basicEvents.push(new to(e));return this}addColorBoostEvents(...t){for(const e of t)this.colorBoostEvents.push(new oo(e));return this}addLightColorEventBoxGroups(...t){for(const e of t)this.lightColorEventBoxGroups.push(new Do(e));return this}addLightRotationEventBoxGroups(...t){for(const e of t)this.lightRotationEventBoxGroups.push(new Eo(e));return this}addLightTranslationEventBoxGroups(...t){for(const e of t)this.lightTranslationEventBoxGroups.push(new wo(e));return this}addFxEventBoxGroups(...t){for(const e of t)this.fxEventBoxGroups.push(new _o(e));return this}isValid(){return this.waypoints.every(t=>this.checkClass(no,t))&&this.basicEvents.every(t=>this.checkClass(to,t))&&this.colorBoostEvents.every(t=>this.checkClass(oo,t))&&this.lightColorEventBoxGroups.every(t=>this.checkClass(Do,t))&&this.lightRotationEventBoxGroups.every(t=>this.checkClass(Eo,t))&&this.lightTranslationEventBoxGroups.every(t=>this.checkClass(wo,t))&&this.fxEventBoxGroups.every(t=>this.checkClass(_o,t))&&this.eventTypesWithKeywords instanceof Ee}};pi.default={version:"4.0.0",waypoints:[],waypointsData:[],basicEvents:[],basicEventsData:[],colorBoostEvents:[],colorBoostEventsData:[],eventBoxGroups:[],indexFilters:[],lightColorEvents:[],lightColorEventBoxes:[],lightRotationEvents:[],lightRotationEventBoxes:[],lightTranslationEvents:[],lightTranslationEventBoxes:[],floatFxEvents:[],fxEventBoxes:[],basicEventTypesWithKeywords:{...Ee.default},useNormalEventsAsCompatibleEvents:!1,customData:{}};let Oo=pi;const vr={b:{type:"number",version:"4.0.0",optional:!0},i:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},sn={b:{type:"number",version:"4.0.0",optional:!0},i:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},r:{type:"number",version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Od={hb:{type:"number",version:"4.0.0",optional:!0},hr:{type:"number",version:"4.0.0",optional:!0},tb:{type:"number",version:"4.0.0",optional:!0},tr:{type:"number",version:"4.0.0",optional:!0},i:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},ci:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},mu={hb:{type:"number",version:"4.0.0",optional:!0},hi:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},hr:{type:"number",version:"4.0.0",optional:!0},tb:{type:"number",version:"4.0.0",optional:!0},ti:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},tr:{type:"number",version:"4.0.0",optional:!0},ai:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Ad={x:{type:"number",int:!0,version:"4.0.0",optional:!0},y:{type:"number",int:!0,version:"4.0.0",optional:!0},a:{type:"number",int:!0,version:"4.0.0",optional:!0},c:{type:"number",int:!0,version:"4.0.0",optional:!0},d:{type:"number",int:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Id={x:{type:"number",int:!0,version:"4.0.0",optional:!0},y:{type:"number",int:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Pd={x:{type:"number",int:!0,version:"4.0.0",optional:!0},y:{type:"number",int:!0,version:"4.0.0",optional:!0},d:{type:"number",version:"4.0.0",optional:!0},w:{type:"number",int:!0,version:"4.0.0",optional:!0},h:{type:"number",int:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},$d={tx:{type:"number",int:!0,version:"4.0.0",optional:!0},ty:{type:"number",int:!0,version:"4.0.0",optional:!0},c:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},s:{type:"number",version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Md={m:{type:"number",version:"4.0.0",optional:!0},tm:{type:"number",version:"4.0.0",optional:!0},a:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Fd={e:{type:"number",int:!0,version:"4.0.0",optional:!0},r:{type:"number",version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Gd={version:{type:"string",version:"4.0.0"},colorNotes:{type:"object",array:!0,version:"4.0.0",check:sn,optional:!0},bombNotes:{type:"object",array:!0,version:"4.0.0",check:sn,optional:!0},obstacles:{type:"object",array:!0,version:"4.0.0",check:sn,optional:!0},chains:{type:"object",array:!0,version:"4.0.0",check:Od,optional:!0},arcs:{type:"object",array:!0,version:"4.0.0",check:mu,optional:!0},spawnRotations:{type:"object",array:!0,version:"4.0.0",check:mu,optional:!0},colorNotesData:{type:"object",array:!0,version:"4.0.0",check:Ad,optional:!0},bombNotesData:{type:"object",array:!0,version:"4.0.0",check:Id,optional:!0},obstaclesData:{type:"object",array:!0,version:"4.0.0",check:Pd,optional:!0},chainsData:{type:"object",array:!0,version:"4.0.0",check:$d,optional:!0},arcsData:{type:"object",array:!0,version:"4.0.0",check:Md,optional:!0},spawnRotationsData:{type:"object",array:!0,version:"4.0.0",check:Fd,optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},jd={x:{type:"number",int:!0,version:"4.0.0",optional:!0},y:{type:"number",int:!0,version:"4.0.0",optional:!0},d:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Jd={t:{type:"number",int:!0,version:"4.0.0",optional:!0},i:{type:"number",int:!0,version:"4.0.0",optional:!0},f:{type:"number",version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Wd={b:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Xd={e:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},f:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},l:{type:"object",array:!0,version:"4.0.0",check:vr,optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Hd={t:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},b:{type:"number",version:"4.0.0",optional:!0},g:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},e:{type:"object",array:!0,version:"4.0.0",check:Xd,optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Yd={f:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},p:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},t:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},r:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},c:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},n:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},s:{type:"number",int:!0,version:"4.0.0",optional:!0},l:{type:"number",unsigned:!0,version:"4.0.0",optional:!0},d:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Vd={w:{type:"number",version:"4.0.0",optional:!0},d:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},s:{type:"number",version:"4.0.0",optional:!0},t:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},b:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},e:{type:"number",int:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},zd={p:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},c:{type:"number",int:!0,version:"4.0.0",optional:!0},e:{type:"number",int:!0,version:"4.0.0",optional:!0},b:{type:"number",version:"4.0.0",optional:!0},f:{type:"number",int:!0,version:"4.0.0",optional:!0},sb:{type:"number",version:"4.0.0",optional:!0},sf:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Ud={w:{type:"number",version:"4.0.0",optional:!0},d:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},s:{type:"number",version:"4.0.0",optional:!0},t:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},b:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},e:{type:"number",int:!0,version:"4.0.0",optional:!0},a:{type:"number",int:!0,version:"4.0.0",optional:!0},f:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},qd={p:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},e:{type:"number",int:!0,version:"4.0.0",optional:!0},l:{type:"number",int:!0,version:"4.0.0",optional:!0},r:{type:"number",version:"4.0.0",optional:!0},d:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Kd={w:{type:"number",version:"4.0.0",optional:!0},d:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},s:{type:"number",version:"4.0.0",optional:!0},t:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},b:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},e:{type:"number",int:!0,version:"4.0.0",optional:!0},a:{type:"number",int:!0,version:"4.0.0",optional:!0},f:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Zd={p:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},e:{type:"number",int:!0,version:"4.0.0",optional:!0},t:{type:"number",version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Qd={w:{type:"number",version:"4.0.0",optional:!0},d:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},s:{type:"number",version:"4.0.0",optional:!0},t:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},b:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},e:{type:"number",int:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},t0={p:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},e:{type:"number",int:!0,version:"4.0.0",optional:!0},v:{type:"number",version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},e0={version:{type:"string",version:"4.0.0"},waypoints:{type:"object",array:!0,version:"4.0.0",check:sn,optional:!0},waypointsData:{type:"object",array:!0,version:"4.0.0",check:jd,optional:!0},basicEvents:{type:"object",array:!0,version:"4.0.0",check:vr,optional:!0},basicEventsData:{type:"object",array:!0,version:"4.0.0",check:Jd,optional:!0},colorBoostEvents:{type:"object",array:!0,version:"4.0.0",check:vr,optional:!0},colorBoostEventsData:{type:"object",array:!0,version:"4.0.0",check:Wd,optional:!0},eventBoxGroups:{type:"object",array:!0,version:"4.0.0",check:Hd,optional:!0},indexFilters:{type:"object",array:!0,version:"4.0.0",check:Yd,optional:!0},lightColorEventBoxes:{type:"object",array:!0,version:"4.0.0",check:Vd,optional:!0},lightColorEvents:{type:"object",array:!0,version:"4.0.0",check:zd,optional:!0},lightRotationEventBoxes:{type:"object",array:!0,version:"4.0.0",check:Ud,optional:!0},lightRotationEvents:{type:"object",array:!0,version:"4.0.0",check:qd,optional:!0},lightTranslationEventBoxes:{type:"object",array:!0,version:"4.0.0",check:Kd,optional:!0},lightTranslationEvents:{type:"object",array:!0,version:"4.0.0",check:Zd,optional:!0},fxEventBoxes:{type:"object",array:!0,version:"4.0.0",check:Qd,optional:!0},floatFxEvents:{type:"object",array:!0,version:"4.0.0",check:t0,optional:!0},basicEventTypesWithKeywords:{type:"object",version:"4.0.0",check:Fh},useNormalEventsAsCompatibleEvents:{type:"boolean",version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},i0={title:{type:"string",version:"4.0.0",optional:!0},subTitle:{type:"string",version:"4.0.0",optional:!0},author:{type:"string",version:"4.0.0",optional:!0}},o0={songFilename:{type:"string",version:"4.0.0",optional:!0},songDuration:{type:"number",version:"4.0.0",optional:!0},audioDataFilename:{type:"string",version:"4.0.0",optional:!0},bpm:{type:"number",version:"4.0.0"},lufs:{type:"number",version:"4.0.0"},previewStartTime:{type:"number",version:"4.0.0",optional:!0},previewDuration:{type:"number",version:"4.0.0",optional:!0}},s0={useOverride:{type:"boolean",version:"4.0.0",optional:!0},colorSchemeName:{type:"string",version:"4.0.0",optional:!0},saberAColor:{type:"string",version:"4.0.0",optional:!0},saberBColor:{type:"string",version:"4.0.0",optional:!0},obstaclesColor:{type:"string",version:"4.0.0",optional:!0},environmentColor0:{type:"string",version:"4.0.0",optional:!0},environmentColor1:{type:"string",version:"4.0.0",optional:!0},environmentColorW:{type:"string",version:"4.0.0",optional:!0},environmentColor0Boost:{type:"string",version:"4.0.0",optional:!0},environmentColor1Boost:{type:"string",version:"4.0.0",optional:!0},environmentColorWBoost:{type:"string",version:"4.0.0",optional:!0}},n0={mappers:{type:"string",array:!0,version:"4.0.0"},lighters:{type:"string",array:!0,version:"4.0.0"}},r0={characteristic:{type:"string",version:"4.0.0",optional:!0},difficulty:{type:"string",version:"4.0.0",optional:!0},beatmapAuthors:{type:"object",version:"4.0.0",check:n0},environmentNameIdx:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},beatmapColorSchemeIdx:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},noteJumpMovementSpeed:{type:"number",version:"4.0.0",optional:!0},noteJumpStartBeatOffset:{type:"number",version:"4.0.0",optional:!0},lightshowDataFilename:{type:"string",version:"4.0.0",optional:!0},beatmapDataFilename:{type:"string",version:"4.0.0"},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},a0={version:{type:"string",version:"4.0.0"},song:{type:"object",version:"4.0.0",check:i0},audio:{type:"object",version:"4.0.0",check:o0},songPreviewFilename:{type:"string",version:"4.0.0",optional:!0},coverImageFilename:{type:"string",version:"4.0.0",optional:!0},environmentNames:{type:"string",array:!0,version:"4.0.0"},colorSchemes:{type:"object",array:!0,version:"4.0.0",check:s0},difficultyBeatmaps:{type:"object",array:!0,version:"4.0.0",check:r0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}};function rs(i){return["v4","parse",i]}function l0(i,t={enabled:!0,throwError:!0}){var e;return W.tInfo(rs("info"),"Parsing beatmap info v4.x.x"),i=xt(i),(e=i.version)!=null&&e.startsWith("4")||(W.tWarn(rs("info"),"Unidentified beatmap version"),i.version="4.0.0"),t.enabled&&si(i,a0,"info",i._version,t.throwError),ts.fromJSON(i)}function u0(i,t={enabled:!0,throwError:!0}){var e;return W.tInfo(rs("difficulty"),"Parsing beatmap difficulty v4.x.x"),i=xt(i),(e=i.version)!=null&&e.startsWith("4")||(W.tWarn(rs("difficulty"),"Unidentified beatmap version"),i.version="4.0.0"),t.enabled&&si(i,Gd,"difficulty",i.version,t.throwError),Ro.fromJSON(i)}function c0(i,t={enabled:!0,throwError:!0}){var e;return W.tInfo(rs("lightshow"),"Parsing beatmap lightshow v4.x.x"),i=xt(i),(e=i.version)!=null&&e.startsWith("4")||(W.tWarn(rs("lightshow"),"Unidentified beatmap version"),i.version="4.0.0"),t.enabled&&si(i,e0,"lightshow",i.version,t.throwError),Oo.fromJSON(i)}const pu="Invalid Event Box",du="Check for valid event box group usage.",bu=!0,Rn={name:pu,description:du,type:"event",order:{input:bt.EVENTS_INVALID_EVENT_BOX,output:gt.EVENTS_INVALID_EVENT_BOX},input:{enabled:bu,params:{},html:U.createBlock(U.createCheckbox(function(){Rn.input.enabled=this.checked},pu,du,bu))},output:{html:null},run:f0},gu={EDMEnvironment:{0:24,1:24,2:24,3:24,4:24,5:24,6:10,7:10,8:10,9:10,10:10,11:10,12:10,13:10,14:1,15:1,16:1,17:1},LizzoEnvironment:{0:40,1:16,2:16,3:16,4:16,5:16,6:1,7:1,8:12,9:12,10:12,11:6,12:6,13:14,14:14,15:4,16:4,17:3,18:3,19:14},PyroEnvironment:{0:3,1:3,2:5,3:5,4:3,5:12,6:48,7:48,8:4,9:4,10:3,11:3,12:10,13:10},TheSecondEnvironment:{0:15,1:24,2:12,3:12,4:12,5:12,6:4,7:4,8:4,9:4,10:4,11:4,12:4,13:4},TheWeekndEnvironment:{0:4,1:4,2:4,3:4,4:8,5:4,6:4,7:12,8:1,9:6,10:25,11:25,12:25,13:25,14:25,15:25,16:25,17:25,18:25,19:25,20:3,21:3,22:8,23:8,29:3,30:3,31:3,32:3,33:3,34:3,35:3,36:3,37:6,38:6,40:2},RockMixtapeEnvironment:{0:5,1:5,2:10,3:10,4:10,5:10,6:10,7:10,8:10,9:10,10:10,11:10,12:10,13:10,14:3,15:10,16:5,17:5,18:24,19:24,20:12,21:12,22:8,23:8,24:36,25:3,26:36,27:3,28:5,29:2,30:16,31:4,32:4,33:4,34:4,35:2,36:2,37:2},WeaveEnvironment:{0:8,1:8,2:8,3:8,4:8,5:8,6:8,7:8,8:8,9:8,10:8,11:8,12:12,13:12,14:8,15:8},Dragons2Environment:{0:24,1:96,2:35,3:15,4:8,5:12,6:12,7:5,8:5,9:5,10:5,11:5,12:5},Panic2Environment:{0:7,1:7,2:7,3:7,4:8,5:8,6:24,7:24,8:24,9:6,10:6,11:6,12:6,13:14,14:14,15:2,16:28,17:28,18:1,19:1,20:12,21:1,22:12,23:1}};function h0(i,t){const e=[],o=[];if(!gu[t])return{defectID:[],defectFilter:[]};const s=t,n=Io[s][1],r=[...i.lightColorEventBoxGroups,...i.lightRotationEventBoxGroups,...i.lightTranslationEventBoxGroups];for(const a of r){n.includes(a.id)||e.push(a);for(const l of a.boxes){const f=l.filter;f.type===Rc.STEP_AND_OFFSET&&f.p0>gu[s][a.id]&&o.push(a)}}return{defectID:e.map(a=>a.time).filter(function(a,l,f){return!l||a!==f[l-1]}),defectFilter:o.map(a=>a.time).filter(function(a,l,f){return!l||a!==f[l-1]})}}function f0(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=h0(i.difficulty.lightshow,i.difficulty.environment),e=[];if(t.defectID.length&&e.push(mt("Invalid event box group ID",t.defectID,i.settings.bpm,"error")),t.defectFilter.length&&e.push(mt("Invalid event box filter",t.defectFilter,i.settings.bpm,"error")),e.length){const o=document.createElement("div");e.forEach(s=>o.append(s)),Rn.output.html=o}else Rn.output.html=null}const vu="Unlit Bomb",yu="Check for lighting around bomb.",_u=!0,On={name:vu,description:yu,type:"event",order:{input:bt.EVENTS_UNLIT_BOMB,output:gt.EVENTS_UNLIT_BOMB},input:{enabled:_u,params:{},html:U.createBlock(U.createCheckbox(function(){On.input.enabled=this.checked},vu,yu,_u))},output:{html:null},run:p0},m0=(i,t,e,o)=>{var p;if(!t.length)return[];const s=[],n=((p=Io[o])==null?void 0:p[0])??Io.DefaultEnvironment[0],r=t.filter(c=>c.isLightEvent(o)&&n.includes(c.type)).sort((c,u)=>c.type-u.type),a={0:{state:"off",time:0,fadeTime:0},1:{state:"off",time:0,fadeTime:0},2:{state:"off",time:0,fadeTime:0},3:{state:"off",time:0,fadeTime:0},4:{state:"off",time:0,fadeTime:0},6:{state:"off",time:0,fadeTime:0},7:{state:"off",time:0,fadeTime:0},10:{state:"off",time:0,fadeTime:0},11:{state:"off",time:0,fadeTime:0}},l={};n.forEach(c=>l[c]=[[0,!1]]);const f=e.toBeatTime(1),h=e.toBeatTime(.25);for(let c=0,u=r.length;c<u;c++){const b=r[c];if((b.isOn()||b.isFlash())&&a[b.type].state!=="on"){a[b.type]={state:"on",time:b.time,fadeTime:0};const d=l[b.type].find(v=>v[0]>=b.time);d?(d[0]=b.time,d[1]=!0):l[b.type].push([b.time,!0])}if(b.isFade()){a[b.type]={state:"off",time:b.time,fadeTime:f};const d=l[b.type].find(v=>v[0]>=b.time);d?(d[0]=b.time,d[1]=!0):l[b.type].push([b.time,!0]),l[b.type].push([b.time+f,!1])}(((b==null?void 0:b.floatValue)??1)<.25||b.isOff()||b.customData._color&&(typeof b.customData._color[3]=="number"&&b.customData._color[3]<.25||Math.max(b.customData._color[0],b.customData._color[1],b.customData._color[2])<.25))&&a[b.type].state!=="off"&&(a[b.type]={state:"off",time:b.time,fadeTime:a[b.type].state==="on"?h:Math.min(h,a[b.type].fadeTime)},l[b.type].push([b.time+(a[b.type].state==="on"?h:Math.min(h,a[b.type].fadeTime)),!1]))}for(const c in l)l[c].reverse();for(let c=0,u=i.length,b=!1;c<u;c++){const d=i[c];b=!1;for(const v in l){const y=l[v].find(E=>E[0]<=d.time);y&&(b=b||y[1])}b||s.push(d)}return s.map(c=>c.time).filter(function(c,u,b){return!u||c!==b[u-1]})};function p0(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=m0(i.difficulty.data.bombNotes,i.difficulty.lightshow.basicEvents,i.settings.bpm,i.difficulty.environment);t.length?On.output.html=mt("Unlit bomb",t,i.settings.bpm,"warning"):On.output.html=null}const Du=Object.freeze(Object.defineProperty({__proto__:null,insufficientLight:ps,invalidEventBox:Rn,unlitBomb:On},Symbol.toStringTag,{value:"Module"})),Eu="Hot Start",wu="Check for first interactive object starting from start time.",Su=!0,Cu=1.5,Ao={name:Eu,description:wu,type:"other",order:{input:bt.OTHERS_HOT_START,output:gt.OTHERS_HOT_START},input:{enabled:Su,params:{time:Cu},html:U.createBlock(U.createCheckbox(function(){Ao.input.enabled=this.checked},Eu+" (s): ",wu,Su),U.createNumber(function(){Ao.input.params.time=M(Math.abs(parseFloat(this.value)),3),this.value=Ao.input.params.time.toString()},"",Cu,0,null,.1))},output:{html:null},run:d0};function d0(i){if(!i.difficulty){console.error("Something went wrong!");return}const{time:t}=Ao.input.params,e=i.settings.bpm.toRealTime(i.difficulty.data.getFirstInteractiveTime());e<t?Ao.output.html=Pt("Hot start",`${M(e,2)}s`,"warning"):Ao.output.html=null}const xu="Difficulty Label Check",Tu="For ranking purpose, check difficulty label to fit rankability criteria.",Lu=!0,An={name:xu,description:Tu,type:"other",order:{input:bt.OTHERS_DIFFICULTY_LABEL,output:gt.OTHERS_DIFFICULTY_LABEL},input:{enabled:Lu,params:{},html:U.createBlock(U.createCheckbox(function(){An.input.enabled=this.checked},xu,Tu,Lu))},output:{html:null},run:b0};function b0(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=i.difficulty.info.customData._difficultyLabel;t&&t.length>30?An.output.html=Pt(`Difficulty label is too long (${t.length} characters)`,"exceeded 30 max characters by ranking criteria","rank"):An.output.html=null}const Nu="NJS Check",Bu="Check note jump speed for suitable value.",ku=!0,In={name:Nu,description:Bu,type:"other",order:{input:bt.OTHERS_NJS,output:gt.OTHERS_NJS},input:{enabled:ku,params:{},html:U.createBlock(U.createCheckbox(function(){In.input.enabled=this.checked},Nu,Bu,ku))},output:{html:null},run:g0};function g0(i){if(!i.difficulty){console.error("Something went wrong!");return}const{njs:t,bpm:e}=i.settings,o=[];if(i.difficulty.info.njs===0&&o.push(Pt("Unset NJS","fallback NJS is used","error")),t.value>23&&o.push(Pt(`NJS is too high (${M(t.value,2)})`,"use lower whenever necessary","warning")),t.value<3&&o.push(Pt(`NJS is too low (${M(t.value,2)})`,"timing is less significant below this","warning")),t.jd>36&&o.push(Pt("Very high jump distance",`${M(t.jd,2)}`,"warning")),t.jd<18&&o.push(Pt("Very low jump distance",`${M(t.jd,2)}`,"warning")),t.jd>t.calcJdOptimal()[1]&&o.push(Pt(`High jump distance warning (>${M(t.calcJdOptimal()[1],2)})`,"NJS & offset may be uncomfortable to play","warning")),e.toRealTime(t.hjd)<.42&&o.push(Pt(`Very quick reaction time (${M(e.toRealTime(t.hjd)*1e3)}ms)`,"may lead to suboptimal gameplay","warning")),t.calcHjd(0)+t.offset<ji.HJD_MIN&&o.push(Pt("Unnecessary negative offset",`will not drop below ${ji.HJD_MIN}`,"warning")),o.length){const s=document.createElement("div");o.forEach(n=>s.append(n)),In.output.html=s}else In.output.html=null}const Ru="Outside Playable Object",Ou="Look for any object starting before and after song timer.",Au=!0,Pn={name:Ru,description:Ou,type:"other",order:{input:bt.OTHERS_OUTSIDE_PLAYABLE,output:gt.OTHERS_OUTSIDE_PLAYABLE},input:{enabled:Au,params:{},html:U.createBlock(U.createCheckbox(function(){Pn.input.enabled=this.checked},Ru,Ou,Au))},output:{html:null},run:v0};function Ue(i,t,e,o){t.length&&t[0].time<0&&o.push(Pt(i+"(s) before start time",`${M(t[0].time,3)} (${Xe(e.toRealTime(t[0].time))}`,"error"))}function qe(i,t,e,o,s){t.length&&t[t.length-1].time>o&&s.push(Pt(i+"(s) after end time",`${M(t[t.length-1].time,3)} (${Xe(e.toRealTime(t[t.length-1].time))})`,"error"))}function v0(i){if(!i.difficulty){console.error("Something went wrong!");return}const{bpm:t,audioDuration:e}=i.settings,{colorNotes:o,bombNotes:s,obstacles:n,arcs:r,chains:a}=i.difficulty.data,{basicEvents:l,colorBoostEvents:f,waypoints:h,lightColorEventBoxGroups:p,lightRotationEventBoxGroups:c,lightTranslationEventBoxGroups:u,fxEventBoxGroups:b}=i.difficulty.lightshow,d=[];if(e){let v=t.toBeatTime(e,!0);Ue("Note",o,t,d),Ue("Bomb",s,t,d),Ue("Obstacle",n,t,d),Ue("Arc",r,t,d),Ue("Chain",a,t,d),Ue("Event",l,t,d),Ue("Color Boost",f,t,d),Ue("Waypoint",h,t,d),Ue("Light Color Event Box Group",p,t,d),Ue("Light Rotation Event Box Group",c,t,d),Ue("Light Translation Event Box Group",u,t,d),Ue("FX Event Box Group",b,t,d),qe("Note",o,t,v,d),qe("Bomb",s,t,v,d),qe("Obstacle",n,t,v,d),qe("Arc",r,t,v,d),qe("Chain",a,t,v,d),qe("Event",l,t,v,d),qe("Color Boost",f,t,v,d),qe("Waypoint",h,t,v,d),qe("Light Color Event Box Group",p,t,v,d),qe("Light Rotation Event Box Group",c,t,v,d),qe("Light Translation Event Box Group",u,t,v,d),qe("FX Event Box Group",b,t,v,d)}if(d.length){const v=document.createElement("div");d.forEach(y=>v.append(y)),Pn.output.html=v}else Pn.output.html=null}const Iu="Invalid Object",Pu="Validate beatmap object to be compatible with vanilla (ignores for modded).",$u=!0,$n={name:Iu,description:Pu,type:"other",order:{input:bt.OTHERS_INVALID_OBJECT,output:gt.OTHERS_INVALID_OBJECT},input:{enabled:$u,params:{},html:U.createBlock(U.createCheckbox(function(){$n.input.enabled=this.checked},Iu,Pu,$u))},output:{html:null},run:y0};function y0(i){var V,it;if(!i.difficulty){console.error("Something went wrong!");return}const{colorNotes:t,bombNotes:e,obstacles:o,arcs:s,chains:n}=i.difficulty.data,{waypoints:r,basicEvents:a,colorBoostEvents:l,lightColorEventBoxGroups:f,lightRotationEventBoxGroups:h,lightTranslationEventBoxGroups:p,fxEventBoxGroups:c}=i.difficulty.lightshow;let u=[],b=[],d=[],v=[],y=[];(V=i.difficulty.info.customData._requirements)!=null&&V.includes("Mapping Extensions")||((it=i.difficulty.info.customData._requirements)!=null&&it.includes("Noodle Extensions")?(u=t.filter(_=>_.isMappingExtensions()).map(_=>_.time),b=o.filter(_=>_.isMappingExtensions()).map(_=>_.time),d=e.filter(_=>_.isMappingExtensions()).map(_=>_.time),v=s.filter(_=>_.isMappingExtensions()).map(_=>_.time),y=n.filter(_=>_.isMappingExtensions()).map(_=>_.time)):(u=t.filter(_=>!_.isValid()).map(_=>_.time),b=o.filter(_=>!_.isValid()).map(_=>_.time),d=e.filter(_=>!_.isValid()).map(_=>_.time),v=s.filter(_=>!_.isValid()).map(_=>_.time),y=n.filter(_=>!_.isValid()).map(_=>_.time)));const E=r.filter(_=>!_.isValid()).map(_=>_.time),S=a.filter(_=>!_.isValid()).map(_=>_.time),x=l.filter(_=>!_.isValid()).map(_=>_.time),N=f.filter(_=>!_.isValid()).map(_=>_.time),F=h.filter(_=>!_.isValid()).map(_=>_.time),$=p.filter(_=>!_.isValid()).map(_=>_.time),X=c.filter(_=>!_.isValid()).map(_=>_.time),O=[];if(u.length&&O.push(mt("Invalid note",u,i.settings.bpm,"error")),d.length&&O.push(mt("Invalid bomb",d,i.settings.bpm,"error")),v.length&&O.push(mt("Invalid arc",v,i.settings.bpm,"error")),y.length&&O.push(mt("Invalid chain",y,i.settings.bpm,"error")),b.length&&O.push(mt("Invalid obstacle",b,i.settings.bpm,"error")),E.length&&O.push(mt("Invalid waypoint",E,i.settings.bpm,"error")),S.length&&O.push(mt("Invalid event",S,i.settings.bpm,"error")),x.length&&O.push(mt("Invalid color boost",x,i.settings.bpm,"error")),N.length&&O.push(mt("Invalid light color event",N,i.settings.bpm,"error")),F.length&&O.push(mt("Invalid light rotation event",F,i.settings.bpm,"error")),$.length&&O.push(mt("Invalid light translation event",$,i.settings.bpm,"error")),X.length&&O.push(mt("Invalid FX event",X,i.settings.bpm,"error")),O.length){const _=document.createElement("div");O.forEach(P=>_.append(P)),$n.output.html=_}else $n.output.html=null}const Mu=Object.freeze(Object.defineProperty({__proto__:null,difficultyLabel:An,hotStart:Ao,invalidObject:$n,njs:In,outsidePlayable:Pn},Symbol.toStringTag,{value:"Module"})),ce=class ce{constructor(){}};ce.getNote=()=>Object.keys(Vl).map(t=>Vl[t]),ce.getObstacle=()=>Object.keys(ou).map(t=>ou[t]),ce.getEvent=()=>Object.keys(Du).map(t=>Du[t]),ce.getOther=()=>Object.keys(Mu).map(t=>Mu[t]),ce.getGeneral=()=>Object.keys(Ia).map(t=>Ia[t]),ce.getDifficulty=()=>[...ce.getNote(),...ce.getObstacle(),...ce.getEvent(),...ce.getOther()],ce.getAll=()=>[...ce.getNote(),...ce.getObstacle(),...ce.getEvent(),...ce.getOther(),...ce.getGeneral()];let Mn=ce;function No(i){return["analyzer",i]}const jh=Mn.getAll().sort((i,t)=>i.order.input-t.order.input),Jh=[...jh].sort((i,t)=>i.order.output-t.order.output);function Wh(){lt.analysis={general:{html:null},map:[]}}function _0(){var r;const i=lt.beatmapInfo;if(!i){W.tError(No("runGeneral"),"Could not analyse, missing map info");return}lt.analysis||Wh();const t=(r=lt.analysis)==null?void 0:r.general,e=Gi.create(i.audio.bpm),o=ji.create(e),s={bpm:e,njs:o,audioDuration:lt.duration??null,mapDuration:0};W.tInfo(No("runGeneral"),"Analysing general");const n=[];Jh.filter(a=>a.type==="general").forEach(a=>{if(a.input.enabled)try{a.run({settings:s,info:i}),a.output.html&&n.push(a.output.html)}catch(l){W.tError(No("runGeneral"),l)}}),t&&(t.html=n)}function Xh(i,t){var l,f,h;const e=lt.beatmapInfo;if(!e){W.tError(No("runDifficulty"),"Could not analyse, missing map info");return}lt.analysis||Wh();const o=(l=lt.beatmapDifficulty)==null?void 0:l.find(p=>p.characteristic===i&&p.difficulty===t);if(!o){W.tError(No("runDifficulty"),"Could not analyse, missing map data");return}const s=(f=lt.analysis)==null?void 0:f.map.find(p=>p.difficulty===t&&p.characteristic===i),n=ji.create(o.bpm,o.info.njs||ji.FallbackNJS[o.difficulty],o.info.njsOffset),r={bpm:o.bpm,njs:n,audioDuration:lt.duration??null,mapDuration:o.bpm.toRealTime(o.data.getLastInteractiveTime())};W.tInfo(No("runDifficulty"),`Analysing ${i} ${t}`);const a=[];Jh.filter(p=>p.type!=="general").forEach(p=>{if(p.input.enabled)try{p.run({settings:r,difficulty:o,info:e}),p.output.html&&a.push(p.output.html)}catch(c){W.tError(No("runDifficulty"),c)}}),s?s.html=a:(h=lt.analysis)==null||h.map.push({characteristic:i,difficulty:t,html:a})}function D0(i){Mn.getDifficulty().sort((e,o)=>e.order.output-o.order.output).forEach(e=>{e.input.adjustTime&&e.input.adjustTime(i)})}function E0(){var i;(i=lt.beatmapDifficulty)==null||i.forEach(t=>Xh(t.characteristic,t.difficulty))}const Po={toolListInput:jh,runGeneral:_0,runDifficulty:Xh,adjustTime:D0,applyAll:E0},$s="UI Tools: ",ho=document.querySelectorAll(".tools__select-characteristic"),fo=document.querySelectorAll(".tools__select-difficulty"),w0=document.querySelectorAll(".difficulty__label"),S0=document.querySelector(".tools__note-content"),C0=document.querySelector(".tools__obstacle-content"),x0=document.querySelector(".tools__event-content"),T0=document.querySelector(".tools__other-content"),L0=document.querySelector(".tools__general-content"),ro=document.querySelector(".tools__output-diff"),ao=document.querySelector(".tools__output-general"),N0=document.querySelector(".tools__apply-this"),B0=document.querySelector(".tools__apply-all"),k0=document.querySelector(".tools__apply-general");N0.addEventListener("click",M0);B0.addEventListener("click",F0);k0.addEventListener("click",G0);ho.forEach(i=>i.addEventListener("change",P0));fo.forEach(i=>i.addEventListener("change",$0));function Hh(){var t;const i=(t=lt.analysis)==null?void 0:t.general;if(!i){ao.textContent="ERROR: could not find analysis for general";return}if(!i.html){ao.textContent="ERROR: could not find HTML for general";return}ao.innerHTML="",i.html.forEach(e=>ao.appendChild(e)),ao.firstChild||(ao.textContent="No issues found.")}function Ms(i,t){var o;if(!i&&!t&&(i=ho[0].value,t=fo[0].value),!i||!t)throw new Error($s+"something went wrong!");ro.innerHTML="";const e=(o=lt.analysis)==null?void 0:o.map.find(s=>s.difficulty===t&&s.characteristic===i);if(!e){ro.textContent="ERROR: could not find analysis for "+i+" "+t;return}if(!e.html){ro.textContent="ERROR: could not find HTML for "+i+" "+t;return}e.html.forEach(s=>ro.appendChild(s)),ro.firstChild||(ro.textContent="No issues found.")}function Kn(i){w0.forEach(t=>t.textContent=i)}function Yh(i){const t=lt.beatmapInfo;if(!i||!t)return;fo.forEach(o=>{for(let s=o.options.length-1;s>=0;s--)o.remove(s)});let e=!0;for(let o=t.difficulties.length-1;o>=0;o--){const s=t.difficulties[o];i===s.characteristic&&fo.forEach(n=>{const r=document.createElement("option");if(r.value=s.difficulty,r.textContent=Bi[s.difficulty]+(s.customData._difficultyLabel?" -- "+s.customData._difficultyLabel:""),e){const a=lt.beatmapDifficulty.find(l=>l.difficulty===s.difficulty&&l.characteristic===t.difficulties[o].characteristic);if(!a)throw new Error("missing _mapSetData");Lc(lt.beatmapInfo,a),Kn(s.customData._difficultyLabel||Bi[s.difficulty]),Ms(s.characteristic,s.difficulty)}e=!1,n.add(r)})}}function Vh(i){if(!i){ho.forEach(o=>ur(o)),fo.forEach(o=>ur(o));return}let t=!0;const e=new Set;i.difficulties.forEach(o=>{e.has(o.characteristic)||(e.add(o.characteristic),ho.forEach(s=>{const n=document.createElement("option");n.value=o.characteristic,n.textContent=rh[o.characteristic],o.customData._characteristicLabel&&(n.textContent+=` -- ${o.customData._characteristicLabel}`),s.add(n)}),t&&Yh(o.characteristic),t=!1)})}function R0(){const i=lt.beatmapInfo;if(!i)throw new Error($s+"could not find map info");const t=Gi.create(i.audio.bpm);Po.adjustTime(t)}function O0(){Po.toolListInput.forEach(i=>{if(i.input.html)switch(i.type){case"note":{S0.appendChild(i.input.html);break}case"obstacle":{C0.appendChild(i.input.html);break}case"event":{x0.appendChild(i.input.html);break}case"other":{T0.appendChild(i.input.html);break}case"general":{L0.appendChild(i.input.html);break}default:console.error($s+"could not recognise type "+i.type+" for "+i.name)}})}function A0(){ao&&(ao.innerHTML="No output."),ro&&(ro.innerHTML="No output.")}function I0(){A0(),Kn("Difficulty Label"),Vh()}function P0(i){var o;const t=i.target;ho.forEach(s=>{s!==t&&(s.value=t.value)});const e=(o=lt.beatmapInfo)==null?void 0:o.difficulties.find(s=>s.characteristic===t.value);Yh(e==null?void 0:e.characteristic)}function $0(i){var s,n;const t=i.target;fo.forEach(r=>{r!==t&&(r.value=t.value)});const e=(s=lt.beatmapInfo)==null?void 0:s.difficulties.find(r=>r.characteristic===ho.item(0).value);if(!e)throw new Error("aaaaaaaaaaaaaaaaaaa");const o=(n=lt.beatmapDifficulty)==null?void 0:n.find(r=>r.difficulty===t.value&&r.characteristic===e.characteristic);o&&(Lc(lt.beatmapInfo,o),Kn(o.info.customData._difficultyLabel||Bi[t.value]),Ms(o.characteristic,o.difficulty))}function M0(){const i=ho[0].value,t=fo[0].value;if(!i||!t)throw new Error($s+"characteristic/difficulty does not exist");It.status("info",`Re-analysing ${i} ${t}`),Po.runDifficulty(i,t),It.status("info",`Re-analysed ${i} ${t}`),Ms(i,t)}function F0(){const i=ho[0].value,t=fo[0].value;if(!i||!t)throw new Error($s+"characteristic/difficulty does not exist");It.status("info","Re-analysing all difficulties"),Po.applyAll(),It.status("info","Re-analysed all difficulties"),Ms(i,t)}function G0(){It.status("info","Re-analysing general"),Po.runGeneral(),It.status("info","Re-analysed general"),Hh()}const Zo={displayOutputGeneral:Hh,displayOutputDifficulty:Ms,setDifficultyLabel:Kn,adjustBeatTime:R0,populateSelect:Vh,populateTool:O0,reset:I0},Fn="UI Stats: ",L="stats__";function j0(i,t){const e=t.bpm,o=lt.duration||0,s=e.toRealTime(t.data.getLastInteractiveTime()),n=document.createElement("table");return n.className=L+"table",n.innerHTML=`<caption class="${L}table-caption">Note Per Seconds (NPS):</caption><tr><th class="${L}table-header" colspan="2">Overall</th><td class="${L}table-element">${M(t.data.nps(o),2)}</td></tr><tr><th class="${L}table-header" colspan="2">Mapped</th><td class="${L}table-element">${M(t.data.nps(s),2)}</td></tr><tr><th class="${L}table-header" rowspan="3">Peak</th><th class="${L}table-header">16-beat</th><td class="${L}table-element">${M(t.data.peak(16,e.value),2)}</td></tr><tr><th class="${L}table-header">8-beat</th><td class="${L}table-element">${M(t.data.peak(8,e.value),2)}</td></tr><tr><th class="${L}table-header">4-beat</th><td class="${L}table-element">${M(t.data.peak(4,e.value),2)}</td></tr>`,n}function J0(i,t){const e=Gi.create(i.audio.bpm),o=ji.create(e,t.info.njs||ji.FallbackNJS[t.difficulty],t.info.njsOffset),s=document.createElement("table");return s.className=L+"table",s.innerHTML=`<caption class="${L}table-caption">Map Settings:</caption><tr><th class="${L}table-header" colspan="2">Note Jump Speed</th><td class="${L}table-element">${M(o.value,3)}</td></tr><tr><th class="${L}table-header" colspan="2">Spawn Distance Modifier</th><td class="${L}table-element">${M(o.offset,3)}</td></tr><tr><th class="${L}table-header" colspan="2">Half Jump Duration</th><td class="${L}table-element">${M(o.hjd,3)}</td></tr><tr><th class="${L}table-header" colspan="2">Jump Distance</th><td class="${L}table-element">${M(o.jd,3)}</td></tr><tr><th class="${L}table-header" colspan="2">Reaction Time</th><td class="${L}table-element">${M(o.reactionTime*1e3)}ms</td></tr>`,s}function W0(i,t){const e=t.swingAnalysis,o=document.createElement("table");return o.className=L+"table",o.innerHTML=`<caption class="${L}table-caption">Swing Per Seconds (SPS):</caption><tr><th class="${L}table-header"></th><th class="${L}table-header">Total</th><th class="${L}table-header">Red</th><th class="${L}table-header">Blue</th></tr><tr><th class="${L}table-header">Average</th><td class="${L}table-element">${M(e.total.average,2)}</td><td class="${L}table-element">${M(e.red.average,2)}</td><td class="${L}table-element">${M(e.blue.average,2)}</td></tr><tr><th class="${L}table-header">Median</th><td class="${L}table-element">${M(e.total.median,2)}</td><td class="${L}table-element">${M(e.red.median,2)}</td><td class="${L}table-element">${M(e.blue.median,2)}</td></tr><tr><th class="${L}table-header">Peak</th><td class="${L}table-element">${M(e.total.peak,2)}</td><td class="${L}table-element">${M(e.red.peak,2)}</td><td class="${L}table-element">${M(e.blue.peak,2)}</td></tr><tr><th class="${L}table-header">Total</th><td class="${L}table-element">${e.total.total}</td><td class="${L}table-element">${e.red.total}</td><td class="${L}table-element">${e.blue.total}</td></tr>`,o}function nn(i){const t={red:{total:0,chroma:0,noodleExtensions:0,mappingExtensions:0},blue:{total:0,chroma:0,noodleExtensions:0,mappingExtensions:0}};for(let e=i.length-1;e>=0;e--)i[e].color===0?(t.red.total++,i[e].isChroma()&&t.red.chroma++,i[e].isNoodleExtensions()&&t.red.noodleExtensions++,i[e].isMappingExtensions()&&t.red.mappingExtensions++):i[e].color===1&&(t.blue.total++,i[e].isChroma()&&t.blue.chroma++,i[e].isNoodleExtensions()&&t.blue.noodleExtensions++,i[e].isMappingExtensions()&&t.blue.mappingExtensions++);return t}function X0(i){const t={total:0,chroma:0,noodleExtensions:0,mappingExtensions:0};for(let e=i.length-1;e>=0;e--)t.total++,i[e].isChroma()&&t.chroma++,i[e].isNoodleExtensions()&&t.noodleExtensions++,i[e].isMappingExtensions()&&t.mappingExtensions++;return t}function Zs(i,t){return i.filter(e=>e.data.posX===t).length}function H0(i,t){return i.filter(e=>e.data.posY===t).length}function Y0(i,t,e){return i.filter(o=>o.data.posX===t&&o.data.posY===e).length}function V0(i,t){return i.filter(e=>e.type!=="bomb"&&e.data.direction===t).length}function zh(i,t){switch(t){case"note":return i.filter(e=>e.type==="note");case"red":return i.filter(e=>e.type==="note"&&e.data.color===0);case"blue":return i.filter(e=>e.type==="note"&&e.data.color===1);case"arc":return i.filter(e=>e.type==="arc");case"redArc":return i.filter(e=>e.type==="arc"&&e.data.color===0);case"blueArc":return i.filter(e=>e.type==="arc"&&e.data.color===1);case"chain":return i.filter(e=>e.type==="chain");case"redChain":return i.filter(e=>e.type==="chain"&&e.data.color===0);case"blueChain":return i.filter(e=>e.type==="chain"&&e.data.color===1);case"bomb":return i.filter(e=>e.type==="bomb");default:return i}}function z0(i){var l;const t=i.target,e=t.id.replace(`${L}table-select-angle-`,"").split("-"),o=e[0],s=e[1],n=(l=lt.beatmapDifficulty.find(f=>f.characteristic===o&&f.difficulty===s))==null?void 0:l.noteContainer;if(!n){console.error(Fn+"note could not be found");return}const r=zh(n,t.value),a=document.querySelector(`#${L}table-angle-${o}-${s}`);a.innerHTML=Uh(r)}function Uh(i){const t=i.length||1,e=[4,0,5,2,8,3,6,1,7];let o="";for(let s=0;s<3;s++){o+="<tr>";for(let n=0;n<3;n++){let r=V0(i,e[s*3+n]);o+=`<td class="${L}table-element">${r}<br>(${M(r/t*100,1)}%)</td>`}o+="</tr>"}return o}function U0(i,t){var n;const e=Is.create(`${L}table-select-angle-${t.characteristic}-${t.difficulty}`,"Note Angle: ","caption",`${L}table-caption`,{text:"All",value:"all"},{text:"Note Only",value:"note"},{text:"Red Note",value:"red"},{text:"Blue Note",value:"blue"},{text:"Arc Only",value:"arc"},{text:"Red Arc",value:"redArc"},{text:"Blue Arc",value:"blueArc"},{text:"Chain Only",value:"chain"},{text:"Red Chain",value:"redChain"},{text:"Blue Chain",value:"blueChain"});(n=e.querySelector("select"))==null||n.addEventListener("change",z0);let o=`<tbody id="${L}table-angle-${t.characteristic}-${t.difficulty}">${Uh(t.noteContainer)}</tbody>`;const s=document.createElement("table");return s.className=L+"table",s.innerHTML=o,s.prepend(e),s}function q0(i,t,e="DefaultEnvironment"){var n;const o=((n=Io[e])==null?void 0:n[0])??Io.DefaultEnvironment[0],s={};for(let r=o.length-1;r>=0;r--)s[o[r]]={total:0,chroma:0,chromaOld:0};s[5]={total:t.length,chroma:0,chromaOld:0};for(let r=i.length-1;r>=0;r--)i[r].isValidType()&&(s[i[r].type]||(s[i[r].type]={total:0,chroma:0,chromaOld:0}),s[i[r].type].total++,i[r].isChroma()&&s[i[r].type].chroma++,i[r].isOldChroma()&&s[i[r].type].chromaOld++);return s}function Qs(i,t="DefaultEnvironment"){var s;const e=((s=Io[t])==null?void 0:s[1])??Io.DefaultEnvironment[1],o={};for(let n=e.length-1;n>=0;n--)o[e[n]]={groups:0,boxes:0,bases:0};for(let n=i.length-1;n>=0;n--)o[i[n].id]||(o[i[n].id]={groups:0,boxes:0,bases:0}),o[i[n].id].groups++,o[i[n].id].boxes+=i[n].boxes.length,o[i[n].id].bases+=i[n].boxes.reduce((r,a)=>r+a.events.length,0);return o}function K0(i){const t={total:0,interactive:0,chroma:0,noodleExtensions:0,mappingExtensions:0};for(let e=i.length-1;e>-1;e--)t.total++,i[e].isInteractive()&&t.interactive++,i[e].isChroma()&&t.chroma++,i[e].isNoodleExtensions()&&t.noodleExtensions++,i[e].isMappingExtensions()&&t.mappingExtensions++;return t}const Z0={0:"Back Lasers",1:"Ring Lights",2:"Left Lasers",3:"Right Lasers",4:"Center Lights",5:"Boost Colors",6:"Extra Left Lights",7:"Extra Right Lights",8:"Ring Rotation",9:"Ring Zoom",10:"Extra Left Lasers",11:"Extra Right Lasers",12:"Left Laser Speed",13:"Right Laser Speed",14:"Early Lane Rotation",15:"Late Lane Rotation",16:"Utility Event 1",17:"Utility Event 2",18:"Utility Event 3",19:"Utility Event 4",40:"Special Event 1",41:"Special Event 2",42:"Special Event 3",43:"Special Event 4"},Q0={LinkinParkEnvironment:{0:"Lane Light",1:"Ceiling Lights",8:"Laser Mode"},BTSEnvironment:{0:"Door Light",1:"Vertical Pillar Lights",8:"Distant Tower Spin",9:"Raise/Lower Pillars",40:"BTS Event 1",41:"BTS Event 2",42:"BTS Event 3",43:"BTS Event 4"},KaleidoscopeEnvironment:{0:"Spike Tip Lights",1:"Spike Mid Lights",2:"Spike Left Lights",3:"Spike Right Lights",4:"Distant Lasers and Spike Top Lights"},InterscopeEnvironment:{0:"Gate 1",1:"Gate 2",2:"Gate 3",3:"Gate 4",4:"Gate 5",6:"Extra 1",7:"Extra 2"},SkrillexEnvironment:{0:"Logo",1:"Top Lanes and 1st Ring Set",4:"Bottom Lanes and 2nd Ring Set",6:"Left Panel",7:"Right Panel",12:"Left Laser & Panel Speed",13:"Right Laser & Panel Speed"},BillieEnvironment:{0:"Water 4",1:"Water 1",2:"Left Sun Beams",3:"Right Sun Beams",4:"Sun",6:"Water 2",7:"Water 3",8:"Toggle Rain",9:"Sunbeam Mode",10:"Left Bottom Lasers",11:"Right Bottom Lasers",12:"Left Sun Beams Speed",13:"Right Sun Beams Speed"},HalloweenEnvironment:{0:"Sky Lasers",1:"Moon",4:"Lane + Castle Interior"},GagaEnvironment:{0:"Aurora 1",1:"Aurora 2",2:"Tower 1",3:"Tower 2",4:"Logo",6:"Tower 3",7:"Tower 4",10:"Tower 5",11:"Tower 6",14:"Tower 1 Height",15:"Tower 2 Height",16:"Tower 3 Height",17:"Tower 4 Height",18:"Tower 5 Height",19:"Tower 6 Height"},WeaveEnvironment:{4:"Player Space"},PyroEnvironment:{0:"Video Alpha",1:"Logo",2:"Left Projectors",3:"Right Projectors",4:"Platform",6:"Ambient",40:"Video Projection"},EDMEnvironment:{0:"Lane Lights Bottom",1:"Lane Lights Top",4:"Player Space & Spectrogram"},TheSecondEnvironment:{0:"Logo",1:"Runway",2:"Left Flags",3:"Right Flags",4:"Buildings"},LizzoEnvironment:{0:"Runway Left",1:"Runway Right",2:"Left Ring",3:"Right Ring",4:"Top Square",6:"Ambient",7:"Cherry Left",8:"Cherry Right",9:"LI Sign",10:"Z Left Sign",11:"Z Right Sign",12:"O Sign",16:"Left Balloon Particles",17:"Right Balloon Particles"},TheWeekndEnvironment:{0:"Runway Left",1:"Runway Right",6:"Ambient"},RockMixtapeEnvironment:{3:"BG Bloom",4:"Aurora",6:"Ambient"},Dragons2Environment:{0:"Inner Laser Left",1:"Inner Laser Right",2:"Outer Laser Left",3:"Outer Laser Right",4:"Logo",6:"Ambient"},Panic2Environment:{3:"Ambient"},QueenEnvironment:{6:"Ambient",40:"Silhouettes"},LinkinPark2Environment:{3:"Ambient",40:"Logos",41:"Floor Logos"},TheRollingStonesEnvironment:{6:"Ambient",40:"Logo"},LatticeEnvironment:{6:"Ambient"},DaftPunkEnvironment:{6:"Ambient",40:"Helmet 01 Switch",41:"Helmet 02 Switch",42:"Helmet 01 Text",43:"Helmet 02 Text"}};function tb(i,t){var e;return((e=Q0[t])==null?void 0:e[i])||Z0[i]||"Unknown"}const eb={WeaveEnvironment:{0:"Outer Square Bottom Left Laser",1:"Outer Square Bottom Right Laser",2:"Outer Square Top Left Laser",3:"Outer Square Top Right Laser",4:"Inner Square Bottom Left Laser",5:"Inner Square Bottom Right Laser",6:"Inner Square Top Left Laser",7:"Inner Square Top Right Laser",8:"Side Square Bottom Left Laser",9:"Side Square Bottom Right Laser",10:"Side Square Top Left Laser",11:"Side Square Top Right Laser",12:"Distant Square Top Laser",13:"Distant Square Bottom Laser",14:"Distant Square Left Laser",15:"Distant Square Right Laser"},PyroEnvironment:{0:"Stage Left Platform",1:"Stage Right Platform",2:"Top Stage Left Laser",3:"Top Stage Right Laser",4:"Top Stage Middle Laser",5:"Top Stage Light",6:"Side Panels Left Tower",7:"Side Panels Right Tower",8:"Stage Left Laser",9:"Stage Right Laser",10:"Side Panels Left Laser",11:"Side Panels Right Laser",12:"Fire Left",13:"Fire Right"},EDMEnvironment:{0:"Circles Top",1:"Circles Close",2:"Circles Distant",3:"Circles Distant 2",4:"Single Source Circles Left",5:"Single Source Circles Right",6:"Single Source Lasers Left (Up)",7:"Single Source Lasers Left (Out)",8:"Single Source Lasers Right (Up)",9:"Single Source Lasers Right (Out)",10:"Single Source Lasers Left (Down)",11:"Single Source Lasers Right (Down)",12:"Single Source Lasers Left (Down) / Circle Rotations Top",13:"Single Source Lasers Right (Up) / Circle Rotations Close",14:"Circle Rotations Distant",15:"Circle Rotations Distant 2",16:"Circle Rotations Single Source Left",17:"Circle Rotations Single Source Right"},TheSecondEnvironment:{0:"Rings Big",1:"Rings Small",2:"Runway Left",3:"Runway Right",4:"Spotlight Left",5:"Spotlight Right",6:"Top Lasers Left Bottom",7:"Top Lasers Right Bottom",8:"Top Lasers Left Top",9:"Top Lasers Right Top",10:"Bottom Lasers Left Bottom",11:"Bottom Lasers Right Bottom",12:"Bottom Lasers Left Top",13:"Bottom Lasers Right Top"},LizzoEnvironment:{0:"Main Floor",1:"Rainbow Arcs Inner",2:"Rainbow Arcs 2",3:"Rainbow Arcs 3",4:"Rainbow Arcs 4",5:"Rainbow Arcs Outer",6:"Rainbow Rings Left",7:"Rainbow Rings Right",8:"Rainbow Rings Lasers Left",9:"Rainbow Rings Lasers Right",10:"Main Top Lasers",11:"Environment Stands Left",12:"Environment Stands Right",13:"Environment Clouds Left",14:"Environment Clouds Right",15:"Main Left Lasers",16:"Main Right Lasers",17:"Environment Stand Lasers Left",18:"Environment Stand Lasers Right",19:"Rainbow Arcs Laser"},TheWeekndEnvironment:{0:"Lamps Poles Left",1:"Lamps Poles Right",2:"Lamps Rings Left",3:"Lamps Rings Right",4:"Environment Arrows",5:"Environment Side Lasers Left",6:"Environment Side Lasers Right",7:"Environment Runway Lane",8:"Environment Center Ring",9:"Environment Center Ring Lasers",10:"Windows Left 1 Front",11:"Windows Left 1 Side",12:"Windows Left 2 Side",13:"Windows Left 3 Front",14:"Windows Left 3 Side",15:"Windows Right 1 Front",16:"Windows Right 1 Side",17:"Windows Right 2 Side",18:"Windows Right 3 Front",19:"Windows Right 3 Side",20:"Buildings Left",21:"Buildings Right",22:"Buildings Roof Left",23:"Buildings Roof Right",29:"Lamp Rings Left 1",30:"Lamp Rings Left 2",31:"Lamp Rings Left 3",32:"Lamp Rings Left 4",33:"Lamp Rings Right 1",34:"Lamp Rings Right 2",35:"Lamp Rings Right 3",36:"Lamp Rings Right 4",37:"Buildings Background Left",38:"Buildings Background Right",40:"Buildings Side Buildings"},RockMixtapeEnvironment:{0:"Lasers Far Left",1:"Lasers Far Right",2:"Mountain 1",3:"Mountain 2",4:"Mountain 3",5:"Mountain 4",6:"Mountain 5",7:"Mountain 6",8:"Mountain 7",9:"Mountain 8",10:"Mountain 9",11:"Mountain 10",12:"Mountain 11",13:"Mountain 12",14:"Face Eyes",15:"Runway Frets",16:"Runway Strings",17:"Runway Tunnel",18:"Lasers Side Left",19:"Lasers Side Right",20:"Lasers Side Left Rotation",21:"Lasers Side Right Rotation",22:"Face Left",23:"Face Right",24:"Spikes Left",25:"Spikes Left Movement",26:"Spikes Right",27:"Spikes Right Movement",28:"Runway Dots",29:"Face Movement",30:"Runway Equilizer",31:"Screens Left 1",32:"Screens Left 2",33:"Screens Right 1",34:"Screens Right 2",35:"Screens Left Movement",36:"Screens Right Movement",37:"Lasers Side Z Translation"},Dragons2Environment:{0:"Small Rings (R/T)",1:"Small Rings (Colors)",2:"Underground",3:"Big Rings",4:"Top Spotlights",5:"Runway Left",6:"Runway Right",7:"Particles Left",8:"Particles Right",9:"Main Lasers Bottom Left",10:"Main Lasers Top Left",11:"Main Lasers Top Right",12:"Main Lasers Bottom Right"},Panic2Environment:{0:"Left Cones Local",1:"Right Cones Local",2:"Left Cones Global",3:"Right Cones Global",4:"Center Cones Local",5:"Center Cones Global",6:"Diamond Rings Local Left",7:"Diamond Rings Local Right",8:"Diamond Rings Global",9:"Lasers Bottom Left",10:"Lasers Bottom Right",11:"Lasers Top Left",12:"Lasers Top Right",13:"Runway Lasers Left",14:"Runway Lasers Right",15:"Runway Inner Laser",16:"Spectrogram Left",17:"Spectrogram Right",18:"Runway Lasers Left Transform Z",19:"Runway Lasers Right Transform Z",20:"Window Left Pirces",21:"Window Left Aura",22:"Window Right Pieces",23:"Window Right Aura"},QueenEnvironment:{0:"Vinyls Left",1:"Vinyl Left 1",2:"Vinyl Left 2",3:"Vinyl Left 3",4:"Vinyl Left 4",5:"Vinyls Right",6:"Vinyl Right 1",7:"Vinyl Right 2",8:"Vinyl Right 3",9:"Vinyl Right 4",10:"Tunnel Rings Wrapper",11:"Distant Circular Lasers Z",12:"Distant Circular Lasers",13:"Top Circular Lasers Rot Y",14:"Top Circular Lasers",15:"Platform Lane Left",16:"Platform Lane Right",17:"Silhouette Contour"},LinkinPark2Environment:{0:"Circular Lasers Global Distant",1:"Circular Lasers Local Distant",2:"Circular Lasers Global Close",3:"Circular Lasers Local Close",4:"Tunnels Rings",5:"Big Arcs Local",6:"Laser Beams Local Left",7:"Laser Beams Local Right",8:"Floor Lasers Left",9:"Floor Lasers Right",10:"Tunnels Lights",11:"Logo",12:"Big Arcs Global",13:"Spectrograms Floor Left",14:"Spectrograms Floor Right",15:"Spectrograms Tunnel Left",16:"Spectrograms Tunnel Right",17:"Laser Beams Global Left",18:"Laser Beams Global Right"},TheRollingStonesEnvironment:{0:"Cube Local Left",1:"Cube Local Right",2:"Columns Left 01",3:"Columns Left 02",4:"Columns Left 03",5:"Columns Left 04",6:"Columns Right 01",7:"Columns Right 02",8:"Columns Right 03",9:"Columns Right 04",10:"Floor Blocks Left",11:"Floor Blocks Right",12:"Heart Local Left",13:"Heart Local Right",14:"Lasers Left 01",15:"Lasers Left 02",16:"Lasers Left 03",17:"Lasers Left 04",18:"Lasers Right 01",19:"Lasers Right 02",20:"Lasers Right 03",21:"Lasers Right 04",22:"Columns Lasers 01",23:"Columns Lasers 02",24:"Lasers Left Sphere",25:"Lasers Right Sphere",26:"Cube Global",27:"Heart Global",28:"Logo Local",29:"Logo Global",30:"Splinters",31:"Cube Rot Z Left",32:"Cube Rot Z Right",33:"Heart Rot Z Left",34:"Heart Rot Z Right",35:"Floor Side Laser Left",36:"Floor Side Laser Right",37:"Cube Lasers",38:"Splinters Global Translation",39:"Floor Below Block",40:"Floor Inner Light Left",41:"Floor Inner Light Right",42:"Logo Iridescence",43:"Logo Color",44:"Floor Side Laser Bottom Left",45:"Floor Side Laser Bottom Right"},LatticeEnvironment:{0:"Bottom Left Global",1:"Bottom Left Cube",2:"Bottom Left Radial",3:"Bottom Left Spot 1",4:"Bottom Left Spot 2",5:"Bottom Left Laser 1",6:"Bottom Left Laser 2",7:"Bottom Right Global",8:"Bottom Right Cube",9:"Bottom Right Radial",10:"Bottom Right Spot 1",11:"Bottom Right Spot 2",12:"Bottom Right Laser 1",13:"Bottom Right Laser 2",14:"Top Left Global",15:"Top Left Cube",16:"Top Left Radial",17:"Top Left Spot 1",18:"Top Left Spot 2",19:"Top Left Laser 1",20:"Top Left Laser 2",21:"Top Right Global",22:"Top Right Cube",23:"Top Right Radial",24:"Top Right Spot 1",25:"Top Right Spot 2",26:"Top Right Laser 1",27:"Top Right Laser 2",28:"Runway Diagonals",29:"Runway Outline",30:"Runway Chevron"},DaftPunkEnvironment:{0:"Tris Wall Left",1:"Tris Wall Right",2:"Lasers Top Sideset 01 L",3:"Lasers Top Sideset 02 L",4:"Lasers Top Sideset 01 R",5:"Lasers Top Sideset 02 R",6:"Lasers Bottom Sideset 01 L",7:"Lasers Bottom Sideset 02 L",8:"Lasers Bottom Sideset 01 R",9:"Lasers Bottom Sideset 02 R",10:"Lasers Top Wall L",11:"Lasers Top Wall R",12:"Lasers Bottom Wall L",13:"Lasers Bottom Wall R",14:"Orbit 1",15:"Orbit 2",16:"Orbit 3",17:"Orbit 4",18:"Runway Middle",19:"Visor 01 Spectrogram",20:"Visor 02 Spectrogram",21:"Visor 01 Text",22:"Visor 02 Text",23:"Helmet 01",24:"Helmet 02",25:"Runway Left",26:"Runway Right",27:"Background Stars",28:"Orbit 1 Star 1",29:"Orbit 1 Star 2",30:"Orbit 1 Star 3",31:"Orbit 1 Star 4",32:"Orbit 2 Star 1",33:"Orbit 2 Star 2",34:"Orbit 2 Star 3",35:"Orbit 2 Star 4",36:"Orbit 3 Star 1",37:"Orbit 3 Star 2",38:"Orbit 3 Star 3",39:"Orbit 3 Star 4",40:"Orbit 4 Star 1",41:"Orbit 4 Star 2",42:"Orbit 4 Star 3",43:"Orbit 4 Star 4",44:"Orbit 1 Stars Transform",45:"Orbit 2 Stars Transform",46:"Orbit 3 Stars Transform",47:"Orbit 4 Stars Transform",48:"Visor 02 Offset X",49:"Visor 02 Offset Y",50:"Visor 02 Padding X",51:"Visor 02 Padding Y",52:"Visor 01 Offset X",53:"Visor 01 Offset Y",54:"Visor 01 Padding X",55:"Visor 01 Padding Y"}};function ib(i,t){var e;return((e=eb[t])==null?void 0:e[i])||"Unknown"}function ob(i,t){const e=t.environment,o=q0(t.lightshow.basicEvents,t.lightshow.colorBoostEvents,e);let s=0,n=0,r=`<caption class="${L}table-caption">Events: ${Object.values(o).reduce((l,{total:f})=>l+f,0)}</caption>`;for(const l in o)s+=o[l].chroma,n+=o[l].chromaOld,r+=`<tr><th class="${L}table-header">${l}</th><th class="${L}table-header" colspan="4">${tb(parseInt(l),e)}</th><td class="${L}table-element">${o[l].total}</td></tr>`;s&&(r+=`<tr><th class="${L}table-header" colspan="5">Chroma</th><td class="${L}table-element">${s}</td></tr>`),n&&(r+=`<tr><th class="${L}table-header" colspan="5">OG Chroma</th><td class="${L}table-element">${n}</td></tr>`);const a=document.createElement("table");return a.className=L+"table",a.innerHTML=r,a}function sb(...i){for(const t of i)for(const e in t)for(const o of i)o[e]||(o[e]={groups:0,boxes:0,bases:0})}function nb(i,t){const e=t.environment,o=Qs(t.lightshow.lightColorEventBoxGroups,e),s=Qs(t.lightshow.lightRotationEventBoxGroups,e),n=Qs(t.lightshow.lightTranslationEventBoxGroups,e),r=Qs(t.lightshow.fxEventBoxGroups,e);sb(o,s,n,r);let a=`<caption class="${L}table-caption">Event Box Group:</caption><tr><th class="${L}table-header"></th><th class="${L}table-header">Group</th><th class="${L}table-header">Box</th><th class="${L}table-header">Base</th><tr><th class="${L}table-header">Color</th><td class="${L}table-element">${Object.values(o).reduce((c,{groups:u})=>c+u,0)}</td><td class="${L}table-element">${Object.values(o).reduce((c,{boxes:u})=>c+u,0)}</td><td class="${L}table-element">${Object.values(o).reduce((c,{bases:u})=>c+u,0)}</td></tr><tr><th class="${L}table-header">Rotate</th><td class="${L}table-element">${Object.values(s).reduce((c,{groups:u})=>c+u,0)}</td><td class="${L}table-element">${Object.values(s).reduce((c,{boxes:u})=>c+u,0)}</td><td class="${L}table-element">${Object.values(s).reduce((c,{bases:u})=>c+u,0)}</td></tr><tr><th class="${L}table-header">Translate</th><td class="${L}table-element">${Object.values(n).reduce((c,{groups:u})=>c+u,0)}</td><td class="${L}table-element">${Object.values(n).reduce((c,{boxes:u})=>c+u,0)}</td><td class="${L}table-element">${Object.values(n).reduce((c,{bases:u})=>c+u,0)}</td></tr><tr><th class="${L}table-header">FX</th><td class="${L}table-element">${Object.values(r).reduce((c,{groups:u})=>c+u,0)}</td><td class="${L}table-element">${Object.values(r).reduce((c,{boxes:u})=>c+u,0)}</td><td class="${L}table-element">${Object.values(r).reduce((c,{bases:u})=>c+u,0)}</td></tr><tr><th class="${L}table-header">Total</th><td class="${L}table-element">${Object.values(o).reduce((c,{groups:u})=>c+u,0)+Object.values(s).reduce((c,{groups:u})=>c+u,0)+Object.values(n).reduce((c,{groups:u})=>c+u,0)+Object.values(r).reduce((c,{groups:u})=>c+u,0)}</td><td class="${L}table-element">${Object.values(o).reduce((c,{boxes:u})=>c+u,0)+Object.values(s).reduce((c,{boxes:u})=>c+u,0)+Object.values(n).reduce((c,{boxes:u})=>c+u,0)+Object.values(r).reduce((c,{boxes:u})=>c+u,0)}</td><td class="${L}table-element">${Object.values(o).reduce((c,{bases:u})=>c+u,0)+Object.values(s).reduce((c,{bases:u})=>c+u,0)+Object.values(n).reduce((c,{bases:u})=>c+u,0)+Object.values(r).reduce((c,{bases:u})=>c+u,0)}</td></tr>`,l=`<caption class="${L}table-caption">Event Box Group ID:</caption>`;for(const c in o)l+=`<tr><th class="${L}table-header">${c}</th><th class="${L}table-header" colspan="5">${ib(parseInt(c),e)}</th><td class="${L}table-element" title="${o[c].groups} Box (${o[c].bases} Base)">${o[c].groups}</td><td class="${L}table-element" title="${s[c].boxes} Box (${s[c].bases} Base)">${s[c].groups}</td><td class="${L}table-element" title="${n[c].boxes} Box (${n[c].bases} Base)">${n[c].groups}</td><td class="${L}table-element" title="${r[c].groups} Box (${r[c].bases} Base)">${r[c].groups}</td></tr>`;const f=document.createElement("table");f.className=L+"table",f.innerHTML=a;const h=document.createElement("table");h.className=L+"table",h.innerHTML=l;const p=document.createElement("div");return p.appendChild(f),p.appendChild(document.createElement("br")),p.appendChild(h),p}const rb=115;function ab(i){let t=0,e=1;for(let o=0,s=i.filter(n=>n.type==="note"&&!(typeof n.data.customData.uninteractable<"u"||!n.data.customData.uninteractable)).length;o<s;o++)e<8&&o===-3+e*4&&(e*=2),t+=rb*e;return t}function lb(i,t){const e=nn(t.data.colorNotes);let o=`<caption class="${L}table-caption">Note Information:</caption><tr><th class="${L}table-header" colspan="2">R/B Ratio</th><td class="${L}table-element">${M(e.red.total/e.blue.total,2)}</td></tr><tr><th class="${L}table-header" colspan="2">Max Score</th><td class="${L}table-element">${ff(ab(t.noteContainer))}</td></tr><tr><th class="${L}table-header" colspan="2">Effective BPM</th><td class="${L}table-element">${M(Zf(t.swingAnalysis.container),2)}</td></tr><tr><th class="${L}table-header" colspan="2">Effective BPM (swing)</th><td class="${L}table-element">${M(Qf(t.swingAnalysis.container),2)}</td></tr>`,s=M(rm(t.swingAnalysis.container)*1e3,1),n=M(am(t.swingAnalysis.container)*1e3,1);s&&n&&(o+=`<tr><th class="${L}table-header" colspan="2">Min. Slider Speed</th><td class="${L}table-element">${s}ms</td></tr><tr><th class="${L}table-header" colspan="2">Max. Slider Speed</th><td class="${L}table-element">${n}ms</td></tr>`);const r=document.createElement("table");return r.className=L+"table",r.innerHTML=o,r}function ub(i,t){const e=nn(t.data.colorNotes),o=nn(t.data.arcs),s=nn(t.data.chains),n=X0(t.data.bombNotes);let r=`<caption class="${L}table-caption">Note Count:</caption><tr><th class="${L}table-header"></th><th class="${L}table-header">Note</th><th class="${L}table-header">Arc</th><th class="${L}table-header">Chain</th><th class="${L}table-header">Bomb</th></tr><tr><th class="${L}table-header">Total</th><td class="${L}table-element">${e.red.total+e.blue.total}</td><td class="${L}table-element">${o.red.total+o.blue.total}</td><td class="${L}table-element">${s.red.total+s.blue.total}</td><td class="${L}table-element">${n.total}</td></tr><tr><th class="${L}table-header">Red</th><td class="${L}table-element">${e.red.total}</td><td class="${L}table-element">${o.red.total}</td><td class="${L}table-element">${s.red.total}</td><td class="${L}table-element">0</td></tr><tr><th class="${L}table-header">Blue</th><td class="${L}table-element">${e.blue.total}</td><td class="${L}table-element">${o.blue.total}</td><td class="${L}table-element">${s.blue.total}</td><td class="${L}table-element">0</td></tr>`;(e.red.chroma||e.blue.chroma||o.red.chroma||o.blue.chroma||s.red.chroma||s.blue.chroma||n.chroma)&&(r+=`<tr><th class="${L}table-header">Chroma</th><td class="${L}table-element">${e.red.chroma+e.blue.chroma}</td><td class="${L}table-element">${o.red.chroma+o.blue.chroma}</td><td class="${L}table-element">${s.red.chroma+s.blue.chroma}</td><td class="${L}table-element">${n.chroma}</td></tr>`),(e.red.noodleExtensions||e.blue.noodleExtensions||o.red.noodleExtensions||o.blue.noodleExtensions||s.red.noodleExtensions||s.blue.noodleExtensions||n.noodleExtensions)&&(r+=`<tr><th class="${L}table-header">NE</th><td class="${L}table-element">${e.red.noodleExtensions+e.blue.noodleExtensions}</td><td class="${L}table-element">${o.red.noodleExtensions+o.blue.noodleExtensions}</td><td class="${L}table-element">${s.red.noodleExtensions+s.blue.noodleExtensions}</td><td class="${L}table-element">${n.noodleExtensions}</td></tr></tr>`),(e.red.mappingExtensions||e.blue.mappingExtensions||o.red.mappingExtensions||o.blue.mappingExtensions||s.red.mappingExtensions||s.blue.mappingExtensions||n.mappingExtensions)&&(r+=`<tr><th class="${L}table-header">ME</th><td class="${L}table-element">${e.red.mappingExtensions+e.blue.mappingExtensions}</td><td class="${L}table-element">${o.red.mappingExtensions+o.blue.mappingExtensions}</td><td class="${L}table-element">${s.red.mappingExtensions+s.blue.mappingExtensions}</td><td class="${L}table-element">${n.mappingExtensions}</td></tr></tr>`);const a=document.createElement("table");return a.className=L+"table",a.innerHTML=r,a}function cb(i){var l;const t=i.target,e=t.id.replace(`${L}table-select-placement-`,"").split("-"),o=e[0],s=e[1],n=(l=lt.beatmapDifficulty.find(f=>f.characteristic===o&&f.difficulty===s))==null?void 0:l.noteContainer;if(!n){console.error(Fn+"note could not be found");return}const r=zh(n,t.value),a=document.querySelector(`#${L}table-placement-${o}-${s}`);a.innerHTML=qh(r)}function qh(i){const t=i.length||1;let e="";for(let o=2;o>=0;o--){e+="<tr>";for(let s=0;s<=3;s++)e+=`<td class="${L}table-element">${Y0(i,s,o)}</td>`;e+=`<td class="${L}table-element ${L}table--no-border">${M(H0(i,o)/t*100,1)}%</td>
        </tr>`}return e+=`<tr><td class="${L}table-element ${L}table--no-border">${M(Zs(i,0)/t*100,1)}%</td><td class="${L}table-element ${L}table--no-border">${M(Zs(i,1)/t*100,1)}%</td><td class="${L}table-element ${L}table--no-border">${M(Zs(i,2)/t*100,1)}%</td><td class="${L}table-element ${L}table--no-border">${M(Zs(i,3)/t*100,1)}%</td></tr>`,e}function hb(i,t){var n;const e=Is.create(`${L}table-select-placement-${t.characteristic}-${t.difficulty}`,"Note Placement: ","caption",`${L}table-caption`,{text:"All",value:"all"},{text:"Note Only",value:"note"},{text:"Red Note",value:"red"},{text:"Blue Note",value:"blue"},{text:"Arc Only",value:"arc"},{text:"Red Arc",value:"redArc"},{text:"Blue Arc",value:"blueArc"},{text:"Chain Only",value:"chain"},{text:"Red Chain",value:"redChain"},{text:"Blue Chain",value:"blueChain"},{text:"Bomb",value:"bomb"});(n=e.querySelector("select"))==null||n.addEventListener("change",cb);let o=`<tbody id="${L}table-placement-${t.characteristic}-${t.difficulty}">${qh(t.noteContainer)}</tbody>`;const s=document.createElement("table");return s.className=L+"table",s.innerHTML=o,s.prepend(e),s}function fb(i,t){const e=K0(t.data.obstacles);let o=`<caption class="${L}table-caption">Obstacles: ${e.total}</caption>`;e.interactive&&(o+=`<tr><th class="${L}table-header" colspan="2">Interactive</th><td class="${L}table-element">${e.interactive}</td></tr>`),e.chroma&&(o+=`<tr><th class="${L}table-header" colspan="2">Chroma</th><td class="${L}table-element">${e.chroma}</td></tr>`),e.noodleExtensions&&(o+=`<tr><th class="${L}table-header" colspan="2">Noodle Extensions</th><td class="${L}table-element">${e.noodleExtensions}</td></tr>`),e.mappingExtensions&&(o+=`<tr><th class="${L}table-header" colspan="2">Mapping Extensions</th><td class="${L}table-element">${e.mappingExtensions}</td></tr>`);const s=document.createElement("table");return s.className=L+"table",s.innerHTML=o,s}const rn=document.querySelector("#stats .accordion__collapsible");function mb(){var e;if(!lt.beatmapInfo)throw new Error(Fn+"map info could not be found in savedData");const i=lt.beatmapInfo,t={};for(const o of i.difficulties)t[e=o.characteristic]||(t[e]=[]),t[o.characteristic].push(o);for(const o in t){const s=document.createElement("div");s.className=L+"characteristic-"+o;const n=document.createElement("div");n.className=L+"title",n.textContent=rh[o]||o,s.appendChild(n);const r=t[o];for(let a=r.length-1;a>=0;a--){const l=r[a],f=lt.beatmapDifficulty.find(v=>v.characteristic===o&&v.difficulty===l.difficulty);if(!f)throw new Error(Fn+"Could not find map data");const h=Yu.create(`${L}${o}-${l.difficulty}`,Bi[l.difficulty]+(l.customData._difficultyLabel?" -- "+l.customData._difficultyLabel:""),l.difficulty,!0),p=h.querySelector(".accordion__collapsible-flex"),c=h.querySelector(".accordion__button");c.checked=et.onLoad.stats;const u=Qo.create("small","half"),b=Qo.create("small","half"),d=Qo.create("small","half");u.append(J0(i,f)),u.append(document.createElement("br")),u.append(j0(i,f)),u.append(document.createElement("br")),u.append(W0(i,f)),b.append(lb(i,f)),b.append(document.createElement("br")),b.append(ub(i,f)),b.append(document.createElement("br")),b.append(hb(i,f)),b.append(document.createElement("br")),b.append(U0(i,f)),d.append(ob(i,f)),d.append(document.createElement("br")),d.append(nb(i,f)),d.append(document.createElement("br")),d.append(fb(i,f)),p.appendChild(u),p.appendChild(b),p.appendChild(d),s.appendChild(h)}rn.appendChild(s)}}function pb(){for(;rn.firstChild;)rn.removeChild(rn.firstChild)}function ee(i,t,e){i[e]??(i[e]=i[t]),delete i[t]}function db(i){if(!i)return{};const t={...i};return Object.keys(t).length?(ee(t,"_color","color"),ee(t,"_lightID","lightID"),ee(t,"_easing","easing"),ee(t,"_lerpType","lerpType"),ee(t,"_nameFilter","nameFilter"),ee(t,"_rotation","rotation"),ee(t,"_step","step"),ee(t,"_prop","prop"),ee(t,"_direction","direction"),ee(t,"_lockPosition","lockRotation"),typeof t._preciseSpeed=="number"?t.speed=t._preciseSpeed:t.speed??(t.speed=t._speed),delete t._speed,delete t._preciseSpeed,delete t._propID,delete t._lightGradient,delete t._reset,delete t._counterSpin,delete t._stepMult,delete t._propMult,delete t._speedMult,t):{}}function Fu(i){if(!i)return{};const t={...i};return Object.keys(t).length?(ee(t,"_color","color"),ee(t,"_position","coordinates"),ee(t,"_disableNoteGravity","disableNoteGravity"),ee(t,"_disableNoteLook","disableNoteLook"),ee(t,"_flip","flip"),ee(t,"_localRotation","localRotation"),ee(t,"_noteJumpMovementSpeed","noteJumpMovementSpeed"),ee(t,"_noteJumpStartBeatOffset","noteJumpStartBeatOffset"),ee(t,"_scale","size"),ee(t,"_track","track"),ee(t,"_rotation","worldRotation"),t.spawnEffect??(t.spawnEffect=typeof t._disableSpawnEffect=="boolean"?!t._disableSpawnEffect:void 0),delete t._disableSpawnEffect,t.uninteractable??(t.uninteractable=typeof t._interactable=="boolean"?!t._interactable:void 0),delete t._interactable,t._animation&&(t.animation??(t.animation={color:t._animation._color,definitePosition:t._animation._definitePosition,dissolve:t._animation._dissolve,dissolveArrow:t._animation._dissolveArrow,interactable:t._animation._interactable,localRotation:t._animation._localRotation,offsetPosition:t._animation._position,offsetRotation:t._animation._rotation,scale:t._animation._scale,time:t._animation._time})),delete t._animation,t):{}}function yr(i){return["convert","toV4Difficulty",i]}function bb(i){W.tWarn(yr("main"),"Converting to beatmap v4 may lose certain data!");let t=new Ro;switch(!0){case i instanceof Ir:gb(t,i);break;case i instanceof Pr:vb(t,i);break;case i instanceof $r:yb(t,i);break;case i instanceof Ro:t=new Ro(i);break;default:W.tWarn(yr("main"),"Unknown beatmap data, returning empty template")}return t.filename=i.filename,t}function gb(i,t){t.colorNotes.forEach(e=>{if(e.isBomb()&&i.addBombNotes(e),e.isNote()){let o=0;typeof e.customData._cutDirection=="number"?o=e.customData._cutDirection>0?e.customData._cutDirection%360:360+e.customData._cutDirection%360:e.direction>=1e3&&(o=Math.abs(e.direction%1e3%360-360)),i.addColorNotes({time:e.time,color:e.type,posX:e.posX,posY:e.posY,direction:e.direction>=1e3||typeof e.customData._cutDirection=="number"?e.direction===8?8:1:ar(e.direction,0,8),angleOffset:o})}}),i.addObstacles(...t.obstacles),t.basicEvents.forEach(e=>{e.isLaneRotationEvent()&&i.rotationEvents.push(new Bs({time:e.time,executionTime:e.type===14?0:1,rotation:typeof e.customData._rotation=="number"?e.customData._rotation:e.value>=1e3?(e.value-1360)%360:kc[e.value]??0}))})}function vb(i,t){i.customData.fakeBombNotes=[],i.customData.fakeColorNotes=[],i.customData.fakeObstacles=[],t.colorNotes.forEach((e,o)=>{const s=Fu(e.customData);if(typeof e.customData._cutDirection=="number"&&W.tDebug(yr("fromV2Difficulty"),`notes[${o}] at time ${e.time} NE _cutDirection will be converted.`),e.isBomb()&&(e.customData._fake?i.customData.fakeBombNotes.push({b:e.time,x:e.posX,y:e.posY,customData:s}):i.addBombNotes({time:e.time,posX:e.posX,posY:e.posY,customData:s})),e.isNote()){let n=0;typeof e.customData._cutDirection=="number"?n=e.customData._cutDirection>0?e.customData._cutDirection%360:360+e.customData._cutDirection%360:e.direction>=1e3&&(n=Math.abs(e.direction%1e3%360-360)),e.customData._fake?i.customData.fakeColorNotes.push({b:e.time,c:e.type,x:e.posX,y:e.posY,d:e.direction>=1e3||typeof e.customData._cutDirection=="number"?e.direction===8?8:1:ar(e.direction,0,8),a:n,customData:s}):i.addColorNotes({time:e.time,color:e.type,posX:e.posX,posY:e.posY,direction:e.direction>=1e3||typeof e.customData._cutDirection=="number"?e.direction===8?8:1:ar(e.direction,0,8),angleOffset:n,customData:s})}}),t.obstacles.forEach(e=>{const o=Fu(e.customData);e.customData._fake?i.customData.fakeObstacles.push({b:e.time,x:e.posX,y:e.type?2:0,d:e.duration,w:e.width,h:e.type?3:5,customData:o}):i.addObstacles({time:e.time,posX:e.posX,posY:e.type?2:0,duration:e.duration,width:e.width,height:e.type?3:5,customData:o})}),i.addArcs(...t.arcs),t.basicEvents.forEach(e=>{e.isLaneRotationEvent()&&i.rotationEvents.push(new Bs({time:e.time,executionTime:e.type===14?0:1,rotation:typeof e.customData._rotation=="number"?e.customData._rotation:e.value>=1e3?(e.value-1360)%360:kc[e.value]??0}))})}function yb(i,t){i.addColorNotes(...t.colorNotes),i.addBombNotes(...t.bombNotes),i.addObstacles(...t.obstacles),i.addArcs(...t.arcs),i.addChains(...t.chains),i.addRotationEvents(...t.rotationEvents),i.customData=C(t.customData)}function Gu(i){return["convert","toV4Info",i]}function _b(i){W.tWarn(Gu("main"),"Converting to beatmap v4 may lose certain data!");let t=new ts;switch(!0){case i instanceof Nh:Db(t,i);break;case i instanceof kh:Eb(t,i);break;case i instanceof ts:t=new ts(i);break;default:W.tWarn(Gu("main"),"Unknown beatmap data, returning empty template")}return t.filename=i.filename,t}function Db(i,t){i.song.title=t.songName,i.song.subTitle=t.songSubName,i.song.author=t.songAuthorName,i.audio.bpm=t.beatsPerMinute,i.audio.previewStartTime=t.previewStartTime,i.audio.previewDuration=t.previewDuration,i.audio.filename=t.songFilename,i.coverImageFilename=t.coverImageFilename,i.environmentNames=[t.environmentName],i.customData.contributors=t.contributors,i.customData.customEnvironment=t.customEnvironment,i.customData.customEnvironmentHash=t.customEnvironmentHash,t.listMap().forEach(([e,o])=>{i.addMap({characteristic:o.characteristic,difficulty:o.difficulty,authors:{mappers:[],lighters:[]},colorSchemeId:o.colorSchemeId,environmentId:o.environmentId,njs:o.njs,njsOffset:o.njsOffset,filename:o.filename,lightshowFilename:""})})}function Eb(i,t){i.song.title=t.songName,i.song.subTitle=t.songSubName,i.song.author=t.songAuthorName,i.audio.bpm=t.beatsPerMinute,i.audio.previewStartTime=t.previewStartTime,i.audio.previewDuration=t.previewDuration,i.audio.filename=t.songFilename,i.coverImageFilename=t.coverImageFilename,i.songPreviewFilename=t.songFilename,i.environmentNames=[...t.environmentNames],i.environmentNames.includes(t.environmentName)||i.environmentNames.push(t.environmentName),i.colorSchemes=t.colorSchemes.map(e=>xt(e)),i.customData=C(t.customData),t.listMap().forEach(([e,o])=>{let s=o.environmentId;i.environmentNames.length-s<=0&&(s=0),i.addMap({characteristic:o.characteristic,difficulty:o.difficulty,authors:{mappers:[t.levelAuthorName],lighters:[]},colorSchemeId:o.colorSchemeId,environmentId:s,njs:o.njs,njsOffset:o.njsOffset,filename:o.filename,lightshowFilename:"",customData:C(o.customData)})})}function So(i){return["convert","toV4Lightshow",i]}function ju(i){W.tWarn(So("main"),"Converting to beatmap v4 may lose certain data!");let t=new Oo;switch(!0){case i instanceof Ir:wb(t,i);break;case i instanceof Pr:Sb(t,i);break;case i instanceof $r:Cb(t,i);break;case i instanceof Ro:break;case i instanceof Rh:xb(t,i);break;case i instanceof Oo:t=new Oo(i);break;default:W.tWarn(So("main"),"Unknown beatmap data, returning empty template")}return t.filename=i.filename,t}function wb(i,t){t.basicEvents.forEach(e=>{e.isColorBoost()?i.addColorBoostEvents({time:e.time,toggle:!!e.value}):i.addBasicEvents(e)})}function Sb(i,t){i.addWaypoints(...t.waypoints),t.basicEvents.forEach((e,o)=>{if(e.isColorBoost())i.addColorBoostEvents({time:e.time,toggle:!!e.value});else{const s=db(e.customData);e.isLightEvent()&&(e.customData._propID&&W.tWarn(So("fromV2Difficulty"),`events[${o}] at time ${e.time} Chroma _propID will be removed.`),e.customData._lightGradient&&W.tWarn(So("fromV2Difficulty"),`events[${o}] at time ${e.time} Chroma _lightGradient will be removed.`)),e.isRingEvent()&&(e.customData._reset&&W.tWarn(So("fromV2Difficulty"),`events[${o}] at time ${e.time} Chroma _reset will be removed.`),e.customData._counterSpin&&W.tWarn(So("fromV2Difficulty"),`events[${o}] at time ${e.time} Chroma _counterSpin will be removed.`),(e.customData._stepMult||e.customData._propMult||e.customData._speedMult)&&W.tWarn(So("fromV2Difficulty"),`events[${o}] at time ${e.time} Chroma _mult will be removed.`)),i.addBasicEvents({time:e.time,type:e.type,value:e.value,floatValue:e.floatValue,customData:s})}}),i.eventTypesWithKeywords=new Ee(t.eventTypesWithKeywords),i.customData=C(t.customData)}function Cb(i,t){i.addWaypoints(...t.waypoints),i.addBasicEvents(...t.basicEvents),i.addColorBoostEvents(...t.colorBoostEvents),i.addLightColorEventBoxGroups(...t.lightColorEventBoxGroups),i.addLightRotationEventBoxGroups(...t.lightRotationEventBoxGroups),i.addLightTranslationEventBoxGroups(...t.lightTranslationEventBoxGroups),i.addFxEventBoxGroups(...t.fxEventBoxGroups),i.eventTypesWithKeywords=t.eventTypesWithKeywords.clone(),i.customData=C(t.customData)}function xb(i,t){i.addBasicEvents(...t.basicEvents),i.addColorBoostEvents(...t.colorBoostEvents),i.addLightColorEventBoxGroups(...t.lightColorEventBoxGroups),i.addLightRotationEventBoxGroups(...t.lightRotationEventBoxGroups),i.addLightTranslationEventBoxGroups(...t.lightTranslationEventBoxGroups),i.addFxEventBoxGroups(...t.fxEventBoxGroups),i.eventTypesWithKeywords=t.eventTypesWithKeywords.clone(),i.customData=C(t.customData)}function Ke(i){return["load",i]}const Tb={1:Vp,2:ud,4:l0},Lb={1:Yp,2:ld,3:kd,4:u0},Nb={3:Rd,4:c0};function Bb(i){const t=typeof i._version=="string"?i._version.at(0):typeof i.version=="string"?i.version.at(0):null;let e;t?e=parseInt(t):(e=i.songName?1:2,W.tWarn(Ke("_info"),"Could not identify info version from JSON, assume implicit version",e));let o;const s=Tb[e];if(s)o=s(i,{enabled:et.dataCheck,throwError:et.dataError});else throw new Error(`Info version ${e} is not supported, this may be an error in JSON or is newer than currently supported.`);return _b(o)}function kb(i){const t=typeof i._version=="string"?i._version.at(0):typeof i.version=="string"?i.version.at(0):null;let e;t?e=parseInt(t):(W.tWarn(Ke("_difficulty"),"Could not identify beatmap version from JSON, assume implicit version",2),e=2);let o;const s=Lb[e];if(s)o=s(i,{enabled:et.dataCheck,throwError:et.dataError});else throw new Error(`Beatmap version ${e} is not supported, this may be an error in JSON or is newer than currently supported.`);return o}function Rb(i){const t=typeof i.version=="string"?i.version.at(0):null;let e;t?e=parseInt(t):(W.tWarn(Ke("_lightshow"),"Could not identify beatmap version from JSON, assume implicit version",3),e=3);let o;const s=Nb[e];if(s)o=s(i,{enabled:et.dataCheck,throwError:et.dataError});else throw new Error(`Beatmap version ${e} is not supported, this may be an error in JSON or is newer than currently supported.`);return o}async function Ob(i,t){const e=t.file("BPMInfo.dat");if(W.tInfo(Ke("extractBPMInfo"),"loading BPMInfo.dat"),e){const s=await e.async("string").then(JSON.parse);return{duration:s._songSampleCount/s._songFrequency,bpm:s._regions.map(n=>({time:n._startBeat,bpm:(n._endBeat-n._startBeat)/((n._endSampleIndex-n._startSampleIndex)/s._songFrequency)*60}))}}const o=t.file(i.audio.audioDataFilename);if(o){const s=await o.async("string").then(JSON.parse);return{duration:s.songSampleCount/s.songFrequency,bpm:s.bpmData.map(n=>({time:n.sb,bpm:(n.eb-n.sb)/((n.ei-n.si)/s.songFrequency)*60}))}}return null}async function Ab(i){const t=i.file("Info.dat")||i.file("info.dat")||i.file("Info.json")||i.file("info.json");if(!t)throw new Error("Couldn't find Info.dat");return W.tInfo(Ke("extractInfo"),"loading info"),t.async("string").then(JSON.parse).then(Bb)}function Ib(i,t){return i.difficulties.map(async(e,o)=>{var f;const s=e,n=t.file(s.filename);if(!n)return W.tError(Ke("extractBeatmaps"),`Missing ${s.filename} file for ${s.characteristic} ${s.difficulty}, ignoring.`),null;W.tInfo(Ke("extractBeatmaps"),`Loading ${s.characteristic} ${s.difficulty}`);let r;try{r=await n.async("string").then(JSON.parse)}catch(h){throw new Error(`${s.characteristic} ${s.difficulty} ${h}`)}let a=typeof r._version=="string"?r._version.at(0):typeof r.version=="string"?r.version.at(0):null,l;a?l=parseInt(a):(W.tWarn(Ke("extractBeatmaps"),"Could not identify beatmap version from JSON, assume implicit version",2),l=2),r._notes&&r.version&&W.tError(Ke("extractBeatmaps"),`${s.characteristic} ${s.difficulty} contains 2 version of the map in the same file, attempting to load v3 instead`);try{let h=kb(r),p=l===4?new Oo:ju(h);if(l===4){const u=t.file(s.lightshowFilename);u||W.tError(Ke("extractBeatmaps"),`Missing ${s.lightshowFilename} lightshow file for ${s.characteristic} ${s.difficulty}, ignoring.`),W.tInfo(Ke("extractBeatmaps"),`Loading ${s.characteristic} ${s.difficulty} lightshow`);let b;try{b=await u.async("string").then(JSON.parse),p=ju(Rb(b))}catch(d){W.tError(Ke("extractBeatmaps"),`Could not load ${s.lightshowFilename} lightshow file; ${d}`)}}const c=Gi.create(i.audio.bpm,l===3?[...h.customData.BPMChanges??[],...(r.bpmEvents??[]).map(u=>u)]:l===2?h.customData._BPMChanges??h.customData._bpmChanges:l===1?r._BPMChanges:[],(f=s.customData)==null?void 0:f._editorOffset);return h=bb(h),p=p,et.sorting&&(h.sort(),p.sort()),{info:s,characteristic:s.characteristic,difficulty:s.difficulty,environment:i.environmentNames.at(s.environmentId),bpm:c,data:h,lightshow:p,noteContainer:h.getNoteContainer(),eventContainer:h.getEventContainer(),swingAnalysis:im(h,c,s.characteristic,s.difficulty),rawVersion:l,rawData:r}}catch(h){throw h}})}async function Kh(i){return new Promise(function(t,e){const o=new XMLHttpRequest;o.open("GET",i,!0),o.responseType="json",o.timeout=5e3;let s=Date.now();o.onprogress=()=>{o.timeout+=Date.now()-s},o.onload=()=>{o.status===200&&t(o.response),o.status===404&&e("Error 404: Map does not exist"),o.status===403&&e("Error 403: Forbidden"),e(`Error ${o.status}`)},o.onerror=()=>{e("Error downloading")},o.ontimeout=()=>{e("Connection timeout")},o.send()})}async function Pb(i){const t=`https://api.beatsaver.com/maps/id/${i}`,e=await Kh(t);if(e!=null&&e.versions.length)return e.versions[e.versions.length-1].downloadURL;throw new Error("could not find map download link")}async function $b(i){const t=`https://api.beatsaver.com/maps/hash/${i}`,e=await Kh(t);if(e!=null&&e.versions.length)return e.versions[e.versions.length-1].downloadURL;throw new Error("could not find map download link")}function ks(i){return["download",i]}async function Mr(i){return new Promise(function(t,e){const o=new XMLHttpRequest;o.open("GET",i,!0),o.responseType="arraybuffer",o.timeout=5e3;let s=Date.now();o.onprogress=n=>{o.timeout+=Date.now()-s,It.status("download",`Downloading map: ${M(n.loaded/1024/1024,1)}MB / ${M(n.total/1024/1024,1)}MB`,n.loaded/n.total*100)},o.onload=()=>{o.status===200&&t(o.response),o.status===404&&e("Error 404: Map/link does not exist"),o.status===403&&e("Error 403: Forbidden"),e(`Error ${o.status}`)},o.onerror=()=>{e("Error downloading")},o.ontimeout=()=>{e("Connection timeout")},o.send()})}async function Zh(i){const t=zu(i);W.tInfo(ks("downloadFromID"),`fetching download URL from BeatSaver for map ID ${t}`),It.status("info","Fetching download URL from BeatSaver",0);const e=await Pb(t);W.tInfo(ks("downloadFromID"),`downloading from BeatSaver for map ID ${t}`),It.status("info","Requesting download from BeatSaver",0);const o=await Mr(e);return fe.setCoverLink("https://beatsaver.com/maps/"+t,t),o}async function Mb(i){const t=Vu(i);if(t.match(/^(https?:\/\/)?(www\.)?beatsaver\.com\/maps\//))return Zh(t.replace(/^https?:\/\/(www\.)?beatsaver\.com\/maps\//,"").match(/[a-fA-F0-9]*/)[0]);It.status("info","Requesting download from link",0),W.tInfo(ks("downloadFromURL"),`downloading from ${t}`);let e=await Mr("https://cors.bsmg.dev/"+t);return fe.setCoverLink(t),e}async function Fb(i){let t;if(Dr(i.trim()))t=i.trim();else throw new Error("invalid hash");W.tInfo(ks("downloadFromHash"),`fetching download URL from BeatSaver for map hash ${t}`),It.status("info","Fetching download URL from BeatSaver",0);const e=await $b(t);return W.tInfo(ks("downloadFromHash"),`downloading from BeatSaver for map hash ${t}`),It.status("info","Requesting download from BeatSaver",0),await Mr(e)}var tn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Gb(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function en(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Qh={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(i,t){(function(e){i.exports=e()})(function(){return function e(o,s,n){function r(f,h){if(!s[f]){if(!o[f]){var p=typeof en=="function"&&en;if(!h&&p)return p(f,!0);if(a)return a(f,!0);var c=new Error("Cannot find module '"+f+"'");throw c.code="MODULE_NOT_FOUND",c}var u=s[f]={exports:{}};o[f][0].call(u.exports,function(b){var d=o[f][1][b];return r(d||b)},u,u.exports,e,o,s,n)}return s[f].exports}for(var a=typeof en=="function"&&en,l=0;l<n.length;l++)r(n[l]);return r}({1:[function(e,o,s){var n=e("./utils"),r=e("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(l){for(var f,h,p,c,u,b,d,v=[],y=0,E=l.length,S=E,x=n.getTypeOf(l)!=="string";y<l.length;)S=E-y,p=x?(f=l[y++],h=y<E?l[y++]:0,y<E?l[y++]:0):(f=l.charCodeAt(y++),h=y<E?l.charCodeAt(y++):0,y<E?l.charCodeAt(y++):0),c=f>>2,u=(3&f)<<4|h>>4,b=1<S?(15&h)<<2|p>>6:64,d=2<S?63&p:64,v.push(a.charAt(c)+a.charAt(u)+a.charAt(b)+a.charAt(d));return v.join("")},s.decode=function(l){var f,h,p,c,u,b,d=0,v=0,y="data:";if(l.substr(0,y.length)===y)throw new Error("Invalid base64 input, it looks like a data url.");var E,S=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===a.charAt(64)&&S--,l.charAt(l.length-2)===a.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(E=r.uint8array?new Uint8Array(0|S):new Array(0|S);d<l.length;)f=a.indexOf(l.charAt(d++))<<2|(c=a.indexOf(l.charAt(d++)))>>4,h=(15&c)<<4|(u=a.indexOf(l.charAt(d++)))>>2,p=(3&u)<<6|(b=a.indexOf(l.charAt(d++))),E[v++]=f,u!==64&&(E[v++]=h),b!==64&&(E[v++]=p);return E}},{"./support":30,"./utils":32}],2:[function(e,o,s){var n=e("./external"),r=e("./stream/DataWorker"),a=e("./stream/Crc32Probe"),l=e("./stream/DataLengthProbe");function f(h,p,c,u,b){this.compressedSize=h,this.uncompressedSize=p,this.crc32=c,this.compression=u,this.compressedContent=b}f.prototype={getContentWorker:function(){var h=new r(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),p=this;return h.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),h},getCompressedWorker:function(){return new r(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(h,p,c){return h.pipe(new a).pipe(new l("uncompressedSize")).pipe(p.compressWorker(c)).pipe(new l("compressedSize")).withStreamInfo("compression",p)},o.exports=f},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,o,s){var n=e("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},s.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,o,s){var n=e("./utils"),r=function(){for(var a,l=[],f=0;f<256;f++){a=f;for(var h=0;h<8;h++)a=1&a?3988292384^a>>>1:a>>>1;l[f]=a}return l}();o.exports=function(a,l){return a!==void 0&&a.length?n.getTypeOf(a)!=="string"?function(f,h,p,c){var u=r,b=c+p;f^=-1;for(var d=c;d<b;d++)f=f>>>8^u[255&(f^h[d])];return-1^f}(0|l,a,a.length,0):function(f,h,p,c){var u=r,b=c+p;f^=-1;for(var d=c;d<b;d++)f=f>>>8^u[255&(f^h.charCodeAt(d))];return-1^f}(0|l,a,a.length,0):0}},{"./utils":32}],5:[function(e,o,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(e,o,s){var n=null;n=typeof Promise<"u"?Promise:e("lie"),o.exports={Promise:n}},{lie:37}],7:[function(e,o,s){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",r=e("pako"),a=e("./utils"),l=e("./stream/GenericWorker"),f=n?"uint8array":"array";function h(p,c){l.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=c,this.meta={}}s.magic="\b\0",a.inherits(h,l),h.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(f,p.data),!1)},h.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},h.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},h.prototype._createPako=function(){this._pako=new r[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(c){p.push({data:c,meta:p.meta})}},s.compressWorker=function(p){return new h("Deflate",p)},s.uncompressWorker=function(){return new h("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,o,s){function n(u,b){var d,v="";for(d=0;d<b;d++)v+=String.fromCharCode(255&u),u>>>=8;return v}function r(u,b,d,v,y,E){var S,x,N=u.file,F=u.compression,$=E!==f.utf8encode,X=a.transformTo("string",E(N.name)),O=a.transformTo("string",f.utf8encode(N.name)),V=N.comment,it=a.transformTo("string",E(V)),_=a.transformTo("string",f.utf8encode(V)),P=O.length!==N.name.length,g=_.length!==V.length,j="",at="",Y="",ct=N.dir,z=N.date,rt={crc32:0,compressedSize:0,uncompressedSize:0};b&&!d||(rt.crc32=u.crc32,rt.compressedSize=u.compressedSize,rt.uncompressedSize=u.uncompressedSize);var A=0;b&&(A|=8),$||!P&&!g||(A|=2048);var k=0,ot=0;ct&&(k|=16),y==="UNIX"?(ot=798,k|=function(Z,Tt){var Yt=Z;return Z||(Yt=Tt?16893:33204),(65535&Yt)<<16}(N.unixPermissions,ct)):(ot=20,k|=function(Z){return 63&(Z||0)}(N.dosPermissions)),S=z.getUTCHours(),S<<=6,S|=z.getUTCMinutes(),S<<=5,S|=z.getUTCSeconds()/2,x=z.getUTCFullYear()-1980,x<<=4,x|=z.getUTCMonth()+1,x<<=5,x|=z.getUTCDate(),P&&(at=n(1,1)+n(h(X),4)+O,j+="up"+n(at.length,2)+at),g&&(Y=n(1,1)+n(h(it),4)+_,j+="uc"+n(Y.length,2)+Y);var Q="";return Q+=`
\0`,Q+=n(A,2),Q+=F.magic,Q+=n(S,2),Q+=n(x,2),Q+=n(rt.crc32,4),Q+=n(rt.compressedSize,4),Q+=n(rt.uncompressedSize,4),Q+=n(X.length,2),Q+=n(j.length,2),{fileRecord:p.LOCAL_FILE_HEADER+Q+X+j,dirRecord:p.CENTRAL_FILE_HEADER+n(ot,2)+Q+n(it.length,2)+"\0\0\0\0"+n(k,4)+n(v,4)+X+j+it}}var a=e("../utils"),l=e("../stream/GenericWorker"),f=e("../utf8"),h=e("../crc32"),p=e("../signature");function c(u,b,d,v){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=b,this.zipPlatform=d,this.encodeFileName=v,this.streamFiles=u,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(c,l),c.prototype.push=function(u){var b=u.meta.percent||0,d=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(u):(this.bytesWritten+=u.data.length,l.prototype.push.call(this,{data:u.data,meta:{currentFile:this.currentFile,percent:d?(b+100*(d-v-1))/d:100}}))},c.prototype.openedSource=function(u){this.currentSourceOffset=this.bytesWritten,this.currentFile=u.file.name;var b=this.streamFiles&&!u.file.dir;if(b){var d=r(u,b,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:d.fileRecord,meta:{percent:0}})}else this.accumulate=!0},c.prototype.closedSource=function(u){this.accumulate=!1;var b=this.streamFiles&&!u.file.dir,d=r(u,b,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(d.dirRecord),b)this.push({data:function(v){return p.DATA_DESCRIPTOR+n(v.crc32,4)+n(v.compressedSize,4)+n(v.uncompressedSize,4)}(u),meta:{percent:100}});else for(this.push({data:d.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},c.prototype.flush=function(){for(var u=this.bytesWritten,b=0;b<this.dirRecords.length;b++)this.push({data:this.dirRecords[b],meta:{percent:100}});var d=this.bytesWritten-u,v=function(y,E,S,x,N){var F=a.transformTo("string",N(x));return p.CENTRAL_DIRECTORY_END+"\0\0\0\0"+n(y,2)+n(y,2)+n(E,4)+n(S,4)+n(F.length,2)+F}(this.dirRecords.length,d,u,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},c.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},c.prototype.registerPrevious=function(u){this._sources.push(u);var b=this;return u.on("data",function(d){b.processChunk(d)}),u.on("end",function(){b.closedSource(b.previous.streamInfo),b._sources.length?b.prepareNextSource():b.end()}),u.on("error",function(d){b.error(d)}),this},c.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},c.prototype.error=function(u){var b=this._sources;if(!l.prototype.error.call(this,u))return!1;for(var d=0;d<b.length;d++)try{b[d].error(u)}catch{}return!0},c.prototype.lock=function(){l.prototype.lock.call(this);for(var u=this._sources,b=0;b<u.length;b++)u[b].lock()},o.exports=c},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,o,s){var n=e("../compressions"),r=e("./ZipFileWorker");s.generateWorker=function(a,l,f){var h=new r(l.streamFiles,f,l.platform,l.encodeFileName),p=0;try{a.forEach(function(c,u){p++;var b=function(E,S){var x=E||S,N=n[x];if(!N)throw new Error(x+" is not a valid compression method !");return N}(u.options.compression,l.compression),d=u.options.compressionOptions||l.compressionOptions||{},v=u.dir,y=u.date;u._compressWorker(b,d).withStreamInfo("file",{name:c,dir:v,date:y,comment:u.comment||"",unixPermissions:u.unixPermissions,dosPermissions:u.dosPermissions}).pipe(h)}),h.entriesCount=p}catch(c){h.error(c)}return h}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,o,s){function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var r=new n;for(var a in this)typeof this[a]!="function"&&(r[a]=this[a]);return r}}(n.prototype=e("./object")).loadAsync=e("./load"),n.support=e("./support"),n.defaults=e("./defaults"),n.version="3.10.1",n.loadAsync=function(r,a){return new n().loadAsync(r,a)},n.external=e("./external"),o.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,o,s){var n=e("./utils"),r=e("./external"),a=e("./utf8"),l=e("./zipEntries"),f=e("./stream/Crc32Probe"),h=e("./nodejsUtils");function p(c){return new r.Promise(function(u,b){var d=c.decompressed.getContentWorker().pipe(new f);d.on("error",function(v){b(v)}).on("end",function(){d.streamInfo.crc32!==c.decompressed.crc32?b(new Error("Corrupted zip : CRC32 mismatch")):u()}).resume()})}o.exports=function(c,u){var b=this;return u=n.extend(u||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),h.isNode&&h.isStream(c)?r.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",c,!0,u.optimizedBinaryString,u.base64).then(function(d){var v=new l(u);return v.load(d),v}).then(function(d){var v=[r.Promise.resolve(d)],y=d.files;if(u.checkCRC32)for(var E=0;E<y.length;E++)v.push(p(y[E]));return r.Promise.all(v)}).then(function(d){for(var v=d.shift(),y=v.files,E=0;E<y.length;E++){var S=y[E],x=S.fileNameStr,N=n.resolve(S.fileNameStr);b.file(N,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:u.createFolders}),S.dir||(b.file(N).unsafeOriginalName=x)}return v.zipComment.length&&(b.comment=v.zipComment),b})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,o,s){var n=e("../utils"),r=e("../stream/GenericWorker");function a(l,f){r.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(f)}n.inherits(a,r),a.prototype._bindStream=function(l){var f=this;(this._stream=l).pause(),l.on("data",function(h){f.push({data:h,meta:{percent:0}})}).on("error",function(h){f.isPaused?this.generatedError=h:f.error(h)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},a.prototype.pause=function(){return!!r.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},o.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,o,s){var n=e("readable-stream").Readable;function r(a,l,f){n.call(this,l),this._helper=a;var h=this;a.on("data",function(p,c){h.push(p)||h._helper.pause(),f&&f(c)}).on("error",function(p){h.emit("error",p)}).on("end",function(){h.push(null)})}e("../utils").inherits(r,n),r.prototype._read=function(){this._helper.resume()},o.exports=r},{"../utils":32,"readable-stream":16}],14:[function(e,o,s){o.exports={isNode:typeof Buffer<"u",newBufferFrom:function(n,r){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(n,r);if(typeof n=="number")throw new Error('The "data" argument must not be a number');return new Buffer(n,r)},allocBuffer:function(n){if(Buffer.alloc)return Buffer.alloc(n);var r=new Buffer(n);return r.fill(0),r},isBuffer:function(n){return Buffer.isBuffer(n)},isStream:function(n){return n&&typeof n.on=="function"&&typeof n.pause=="function"&&typeof n.resume=="function"}}},{}],15:[function(e,o,s){function n(N,F,$){var X,O=a.getTypeOf(F),V=a.extend($||{},h);V.date=V.date||new Date,V.compression!==null&&(V.compression=V.compression.toUpperCase()),typeof V.unixPermissions=="string"&&(V.unixPermissions=parseInt(V.unixPermissions,8)),V.unixPermissions&&16384&V.unixPermissions&&(V.dir=!0),V.dosPermissions&&16&V.dosPermissions&&(V.dir=!0),V.dir&&(N=y(N)),V.createFolders&&(X=v(N))&&E.call(this,X,!0);var it=O==="string"&&V.binary===!1&&V.base64===!1;$&&$.binary!==void 0||(V.binary=!it),(F instanceof p&&F.uncompressedSize===0||V.dir||!F||F.length===0)&&(V.base64=!1,V.binary=!0,F="",V.compression="STORE",O="string");var _=null;_=F instanceof p||F instanceof l?F:b.isNode&&b.isStream(F)?new d(N,F):a.prepareContent(N,F,V.binary,V.optimizedBinaryString,V.base64);var P=new c(N,_,V);this.files[N]=P}var r=e("./utf8"),a=e("./utils"),l=e("./stream/GenericWorker"),f=e("./stream/StreamHelper"),h=e("./defaults"),p=e("./compressedObject"),c=e("./zipObject"),u=e("./generate"),b=e("./nodejsUtils"),d=e("./nodejs/NodejsStreamInputAdapter"),v=function(N){N.slice(-1)==="/"&&(N=N.substring(0,N.length-1));var F=N.lastIndexOf("/");return 0<F?N.substring(0,F):""},y=function(N){return N.slice(-1)!=="/"&&(N+="/"),N},E=function(N,F){return F=F!==void 0?F:h.createFolders,N=y(N),this.files[N]||n.call(this,N,null,{dir:!0,createFolders:F}),this.files[N]};function S(N){return Object.prototype.toString.call(N)==="[object RegExp]"}var x={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(N){var F,$,X;for(F in this.files)X=this.files[F],($=F.slice(this.root.length,F.length))&&F.slice(0,this.root.length)===this.root&&N($,X)},filter:function(N){var F=[];return this.forEach(function($,X){N($,X)&&F.push(X)}),F},file:function(N,F,$){if(arguments.length!==1)return N=this.root+N,n.call(this,N,F,$),this;if(S(N)){var X=N;return this.filter(function(V,it){return!it.dir&&X.test(V)})}var O=this.files[this.root+N];return O&&!O.dir?O:null},folder:function(N){if(!N)return this;if(S(N))return this.filter(function(O,V){return V.dir&&N.test(O)});var F=this.root+N,$=E.call(this,F),X=this.clone();return X.root=$.name,X},remove:function(N){N=this.root+N;var F=this.files[N];if(F||(N.slice(-1)!=="/"&&(N+="/"),F=this.files[N]),F&&!F.dir)delete this.files[N];else for(var $=this.filter(function(O,V){return V.name.slice(0,N.length)===N}),X=0;X<$.length;X++)delete this.files[$[X].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(N){var F,$={};try{if(($=a.extend(N||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:r.utf8encode})).type=$.type.toLowerCase(),$.compression=$.compression.toUpperCase(),$.type==="binarystring"&&($.type="string"),!$.type)throw new Error("No output type specified.");a.checkSupport($.type),$.platform!=="darwin"&&$.platform!=="freebsd"&&$.platform!=="linux"&&$.platform!=="sunos"||($.platform="UNIX"),$.platform==="win32"&&($.platform="DOS");var X=$.comment||this.comment||"";F=u.generateWorker(this,$,X)}catch(O){(F=new l("error")).error(O)}return new f(F,$.type||"string",$.mimeType)},generateAsync:function(N,F){return this.generateInternalStream(N).accumulate(F)},generateNodeStream:function(N,F){return(N=N||{}).type||(N.type="nodebuffer"),this.generateInternalStream(N).toNodejsStream(F)}};o.exports=x},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,o,s){o.exports=e("stream")},{stream:void 0}],17:[function(e,o,s){var n=e("./DataReader");function r(a){n.call(this,a);for(var l=0;l<this.data.length;l++)a[l]=255&a[l]}e("../utils").inherits(r,n),r.prototype.byteAt=function(a){return this.data[this.zero+a]},r.prototype.lastIndexOfSignature=function(a){for(var l=a.charCodeAt(0),f=a.charCodeAt(1),h=a.charCodeAt(2),p=a.charCodeAt(3),c=this.length-4;0<=c;--c)if(this.data[c]===l&&this.data[c+1]===f&&this.data[c+2]===h&&this.data[c+3]===p)return c-this.zero;return-1},r.prototype.readAndCheckSignature=function(a){var l=a.charCodeAt(0),f=a.charCodeAt(1),h=a.charCodeAt(2),p=a.charCodeAt(3),c=this.readData(4);return l===c[0]&&f===c[1]&&h===c[2]&&p===c[3]},r.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},o.exports=r},{"../utils":32,"./DataReader":18}],18:[function(e,o,s){var n=e("../utils");function r(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}r.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var l,f=0;for(this.checkOffset(a),l=this.index+a-1;l>=this.index;l--)f=(f<<8)+this.byteAt(l);return this.index+=a,f},readString:function(a){return n.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},o.exports=r},{"../utils":32}],19:[function(e,o,s){var n=e("./Uint8ArrayReader");function r(a){n.call(this,a)}e("../utils").inherits(r,n),r.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},o.exports=r},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,o,s){var n=e("./DataReader");function r(a){n.call(this,a)}e("../utils").inherits(r,n),r.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},r.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},r.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},r.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},o.exports=r},{"../utils":32,"./DataReader":18}],21:[function(e,o,s){var n=e("./ArrayReader");function r(a){n.call(this,a)}e("../utils").inherits(r,n),r.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},o.exports=r},{"../utils":32,"./ArrayReader":17}],22:[function(e,o,s){var n=e("../utils"),r=e("../support"),a=e("./ArrayReader"),l=e("./StringReader"),f=e("./NodeBufferReader"),h=e("./Uint8ArrayReader");o.exports=function(p){var c=n.getTypeOf(p);return n.checkSupport(c),c!=="string"||r.uint8array?c==="nodebuffer"?new f(p):r.uint8array?new h(n.transformTo("uint8array",p)):new a(n.transformTo("array",p)):new l(p)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,o,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,o,s){var n=e("./GenericWorker"),r=e("../utils");function a(l){n.call(this,"ConvertWorker to "+l),this.destType=l}r.inherits(a,n),a.prototype.processChunk=function(l){this.push({data:r.transformTo(this.destType,l.data),meta:l.meta})},o.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(e,o,s){var n=e("./GenericWorker"),r=e("../crc32");function a(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(a,n),a.prototype.processChunk=function(l){this.streamInfo.crc32=r(l.data,this.streamInfo.crc32||0),this.push(l)},o.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,o,s){var n=e("../utils"),r=e("./GenericWorker");function a(l){r.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}n.inherits(a,r),a.prototype.processChunk=function(l){if(l){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+l.data.length}r.prototype.processChunk.call(this,l)},o.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(e,o,s){var n=e("../utils"),r=e("./GenericWorker");function a(l){r.call(this,"DataWorker");var f=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(h){f.dataIsReady=!0,f.data=h,f.max=h&&h.length||0,f.type=n.getTypeOf(h),f.isPaused||f._tickAndRepeat()},function(h){f.error(h)})}n.inherits(a,r),a.prototype.cleanUp=function(){r.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,f=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,f);break;case"uint8array":l=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":l=this.data.slice(this.index,f)}return this.index=f,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},o.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(e,o,s){function n(r){this.name=r||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(r){this.emit("data",r)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(r){this.emit("error",r)}return!0},error:function(r){return!this.isFinished&&(this.isPaused?this.generatedError=r:(this.isFinished=!0,this.emit("error",r),this.previous&&this.previous.error(r),this.cleanUp()),!0)},on:function(r,a){return this._listeners[r].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(r,a){if(this._listeners[r])for(var l=0;l<this._listeners[r].length;l++)this._listeners[r][l].call(this,a)},pipe:function(r){return r.registerPrevious(this)},registerPrevious:function(r){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=r.streamInfo,this.mergeStreamInfo(),this.previous=r;var a=this;return r.on("data",function(l){a.processChunk(l)}),r.on("end",function(){a.end()}),r.on("error",function(l){a.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var r=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),r=!0),this.previous&&this.previous.resume(),!r},flush:function(){},processChunk:function(r){this.push(r)},withStreamInfo:function(r,a){return this.extraStreamInfo[r]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var r in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,r)&&(this.streamInfo[r]=this.extraStreamInfo[r])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var r="Worker "+this.name;return this.previous?this.previous+" -> "+r:r}},o.exports=n},{}],29:[function(e,o,s){var n=e("../utils"),r=e("./ConvertWorker"),a=e("./GenericWorker"),l=e("../base64"),f=e("../support"),h=e("../external"),p=null;if(f.nodestream)try{p=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function c(b,d){return new h.Promise(function(v,y){var E=[],S=b._internalType,x=b._outputType,N=b._mimeType;b.on("data",function(F,$){E.push(F),d&&d($)}).on("error",function(F){E=[],y(F)}).on("end",function(){try{var F=function($,X,O){switch($){case"blob":return n.newBlob(n.transformTo("arraybuffer",X),O);case"base64":return l.encode(X);default:return n.transformTo($,X)}}(x,function($,X){var O,V=0,it=null,_=0;for(O=0;O<X.length;O++)_+=X[O].length;switch($){case"string":return X.join("");case"array":return Array.prototype.concat.apply([],X);case"uint8array":for(it=new Uint8Array(_),O=0;O<X.length;O++)it.set(X[O],V),V+=X[O].length;return it;case"nodebuffer":return Buffer.concat(X);default:throw new Error("concat : unsupported type '"+$+"'")}}(S,E),N);v(F)}catch($){y($)}E=[]}).resume()})}function u(b,d,v){var y=d;switch(d){case"blob":case"arraybuffer":y="uint8array";break;case"base64":y="string"}try{this._internalType=y,this._outputType=d,this._mimeType=v,n.checkSupport(y),this._worker=b.pipe(new r(y)),b.lock()}catch(E){this._worker=new a("error"),this._worker.error(E)}}u.prototype={accumulate:function(b){return c(this,b)},on:function(b,d){var v=this;return b==="data"?this._worker.on(b,function(y){d.call(v,y.data,y.meta)}):this._worker.on(b,function(){n.delay(d,arguments,v)}),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(b){if(n.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},b)}},o.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,o,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Buffer<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var n=new ArrayBuffer(0);try{s.blob=new Blob([n],{type:"application/zip"}).size===0}catch{try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);r.append(n),s.blob=r.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!e("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(e,o,s){for(var n=e("./utils"),r=e("./support"),a=e("./nodejsUtils"),l=e("./stream/GenericWorker"),f=new Array(256),h=0;h<256;h++)f[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;f[254]=f[254]=1;function p(){l.call(this,"utf-8 decode"),this.leftOver=null}function c(){l.call(this,"utf-8 encode")}s.utf8encode=function(u){return r.nodebuffer?a.newBufferFrom(u,"utf-8"):function(b){var d,v,y,E,S,x=b.length,N=0;for(E=0;E<x;E++)(64512&(v=b.charCodeAt(E)))==55296&&E+1<x&&(64512&(y=b.charCodeAt(E+1)))==56320&&(v=65536+(v-55296<<10)+(y-56320),E++),N+=v<128?1:v<2048?2:v<65536?3:4;for(d=r.uint8array?new Uint8Array(N):new Array(N),E=S=0;S<N;E++)(64512&(v=b.charCodeAt(E)))==55296&&E+1<x&&(64512&(y=b.charCodeAt(E+1)))==56320&&(v=65536+(v-55296<<10)+(y-56320),E++),v<128?d[S++]=v:(v<2048?d[S++]=192|v>>>6:(v<65536?d[S++]=224|v>>>12:(d[S++]=240|v>>>18,d[S++]=128|v>>>12&63),d[S++]=128|v>>>6&63),d[S++]=128|63&v);return d}(u)},s.utf8decode=function(u){return r.nodebuffer?n.transformTo("nodebuffer",u).toString("utf-8"):function(b){var d,v,y,E,S=b.length,x=new Array(2*S);for(d=v=0;d<S;)if((y=b[d++])<128)x[v++]=y;else if(4<(E=f[y]))x[v++]=65533,d+=E-1;else{for(y&=E===2?31:E===3?15:7;1<E&&d<S;)y=y<<6|63&b[d++],E--;1<E?x[v++]=65533:y<65536?x[v++]=y:(y-=65536,x[v++]=55296|y>>10&1023,x[v++]=56320|1023&y)}return x.length!==v&&(x.subarray?x=x.subarray(0,v):x.length=v),n.applyFromCharCode(x)}(u=n.transformTo(r.uint8array?"uint8array":"array",u))},n.inherits(p,l),p.prototype.processChunk=function(u){var b=n.transformTo(r.uint8array?"uint8array":"array",u.data);if(this.leftOver&&this.leftOver.length){if(r.uint8array){var d=b;(b=new Uint8Array(d.length+this.leftOver.length)).set(this.leftOver,0),b.set(d,this.leftOver.length)}else b=this.leftOver.concat(b);this.leftOver=null}var v=function(E,S){var x;for((S=S||E.length)>E.length&&(S=E.length),x=S-1;0<=x&&(192&E[x])==128;)x--;return x<0||x===0?S:x+f[E[x]]>S?x:S}(b),y=b;v!==b.length&&(r.uint8array?(y=b.subarray(0,v),this.leftOver=b.subarray(v,b.length)):(y=b.slice(0,v),this.leftOver=b.slice(v,b.length))),this.push({data:s.utf8decode(y),meta:u.meta})},p.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=p,n.inherits(c,l),c.prototype.processChunk=function(u){this.push({data:s.utf8encode(u.data),meta:u.meta})},s.Utf8EncodeWorker=c},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,o,s){var n=e("./support"),r=e("./base64"),a=e("./nodejsUtils"),l=e("./external");function f(d){return d}function h(d,v){for(var y=0;y<d.length;++y)v[y]=255&d.charCodeAt(y);return v}e("setimmediate"),s.newBlob=function(d,v){s.checkSupport("blob");try{return new Blob([d],{type:v})}catch{try{var y=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return y.append(d),y.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(d,v,y){var E=[],S=0,x=d.length;if(x<=y)return String.fromCharCode.apply(null,d);for(;S<x;)v==="array"||v==="nodebuffer"?E.push(String.fromCharCode.apply(null,d.slice(S,Math.min(S+y,x)))):E.push(String.fromCharCode.apply(null,d.subarray(S,Math.min(S+y,x)))),S+=y;return E.join("")},stringifyByChar:function(d){for(var v="",y=0;y<d.length;y++)v+=String.fromCharCode(d[y]);return v},applyCanBeUsed:{uint8array:function(){try{return n.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return n.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function c(d){var v=65536,y=s.getTypeOf(d),E=!0;if(y==="uint8array"?E=p.applyCanBeUsed.uint8array:y==="nodebuffer"&&(E=p.applyCanBeUsed.nodebuffer),E)for(;1<v;)try{return p.stringifyByChunk(d,y,v)}catch{v=Math.floor(v/2)}return p.stringifyByChar(d)}function u(d,v){for(var y=0;y<d.length;y++)v[y]=d[y];return v}s.applyFromCharCode=c;var b={};b.string={string:f,array:function(d){return h(d,new Array(d.length))},arraybuffer:function(d){return b.string.uint8array(d).buffer},uint8array:function(d){return h(d,new Uint8Array(d.length))},nodebuffer:function(d){return h(d,a.allocBuffer(d.length))}},b.array={string:c,array:f,arraybuffer:function(d){return new Uint8Array(d).buffer},uint8array:function(d){return new Uint8Array(d)},nodebuffer:function(d){return a.newBufferFrom(d)}},b.arraybuffer={string:function(d){return c(new Uint8Array(d))},array:function(d){return u(new Uint8Array(d),new Array(d.byteLength))},arraybuffer:f,uint8array:function(d){return new Uint8Array(d)},nodebuffer:function(d){return a.newBufferFrom(new Uint8Array(d))}},b.uint8array={string:c,array:function(d){return u(d,new Array(d.length))},arraybuffer:function(d){return d.buffer},uint8array:f,nodebuffer:function(d){return a.newBufferFrom(d)}},b.nodebuffer={string:c,array:function(d){return u(d,new Array(d.length))},arraybuffer:function(d){return b.nodebuffer.uint8array(d).buffer},uint8array:function(d){return u(d,new Uint8Array(d.length))},nodebuffer:f},s.transformTo=function(d,v){if(v=v||"",!d)return v;s.checkSupport(d);var y=s.getTypeOf(v);return b[y][d](v)},s.resolve=function(d){for(var v=d.split("/"),y=[],E=0;E<v.length;E++){var S=v[E];S==="."||S===""&&E!==0&&E!==v.length-1||(S===".."?y.pop():y.push(S))}return y.join("/")},s.getTypeOf=function(d){return typeof d=="string"?"string":Object.prototype.toString.call(d)==="[object Array]"?"array":n.nodebuffer&&a.isBuffer(d)?"nodebuffer":n.uint8array&&d instanceof Uint8Array?"uint8array":n.arraybuffer&&d instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(d){if(!n[d.toLowerCase()])throw new Error(d+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(d){var v,y,E="";for(y=0;y<(d||"").length;y++)E+="\\x"+((v=d.charCodeAt(y))<16?"0":"")+v.toString(16).toUpperCase();return E},s.delay=function(d,v,y){setImmediate(function(){d.apply(y||null,v||[])})},s.inherits=function(d,v){function y(){}y.prototype=v.prototype,d.prototype=new y},s.extend=function(){var d,v,y={};for(d=0;d<arguments.length;d++)for(v in arguments[d])Object.prototype.hasOwnProperty.call(arguments[d],v)&&y[v]===void 0&&(y[v]=arguments[d][v]);return y},s.prepareContent=function(d,v,y,E,S){return l.Promise.resolve(v).then(function(x){return n.blob&&(x instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(x))!==-1)&&typeof FileReader<"u"?new l.Promise(function(N,F){var $=new FileReader;$.onload=function(X){N(X.target.result)},$.onerror=function(X){F(X.target.error)},$.readAsArrayBuffer(x)}):x}).then(function(x){var N=s.getTypeOf(x);return N?(N==="arraybuffer"?x=s.transformTo("uint8array",x):N==="string"&&(S?x=r.decode(x):y&&E!==!0&&(x=function(F){return h(F,n.uint8array?new Uint8Array(F.length):new Array(F.length))}(x))),x):l.Promise.reject(new Error("Can't read the data of '"+d+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,o,s){var n=e("./reader/readerFor"),r=e("./utils"),a=e("./signature"),l=e("./zipEntry"),f=e("./support");function h(p){this.files=[],this.loadOptions=p}h.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var c=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+r.pretty(c)+", expected "+r.pretty(p)+")")}},isSignature:function(p,c){var u=this.reader.index;this.reader.setIndex(p);var b=this.reader.readString(4)===c;return this.reader.setIndex(u),b},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),c=f.uint8array?"uint8array":"array",u=r.transformTo(c,p);this.zipComment=this.loadOptions.decodeFileName(u)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p,c,u,b=this.zip64EndOfCentralSize-44;0<b;)p=this.reader.readInt(2),c=this.reader.readInt(4),u=this.reader.readData(c),this.zip64ExtensibleData[p]={id:p,length:c,value:u}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,c;for(p=0;p<this.files.length;p++)c=this.files[p],this.reader.setIndex(c.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),c.readLocalPart(this.reader),c.handleUTF8(),c.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(p=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(p<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(p);var c=p;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===r.MAX_VALUE_16BITS||this.diskWithCentralDirStart===r.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===r.MAX_VALUE_16BITS||this.centralDirRecords===r.MAX_VALUE_16BITS||this.centralDirSize===r.MAX_VALUE_32BITS||this.centralDirOffset===r.MAX_VALUE_32BITS){if(this.zip64=!0,(p=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var u=this.centralDirOffset+this.centralDirSize;this.zip64&&(u+=20,u+=12+this.zip64EndOfCentralSize);var b=c-u;if(0<b)this.isSignature(c,a.CENTRAL_FILE_HEADER)||(this.reader.zero=b);else if(b<0)throw new Error("Corrupted zip: missing "+Math.abs(b)+" bytes.")},prepareReader:function(p){this.reader=n(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},o.exports=h},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,o,s){var n=e("./reader/readerFor"),r=e("./utils"),a=e("./compressedObject"),l=e("./crc32"),f=e("./utf8"),h=e("./compressions"),p=e("./support");function c(u,b){this.options=u,this.loadOptions=b}c.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(u){var b,d;if(u.skip(22),this.fileNameLength=u.readInt(2),d=u.readInt(2),this.fileName=u.readData(this.fileNameLength),u.skip(d),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((b=function(v){for(var y in h)if(Object.prototype.hasOwnProperty.call(h,y)&&h[y].magic===v)return h[y];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+r.pretty(this.compressionMethod)+" unknown (inner file : "+r.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,b,u.readData(this.compressedSize))},readCentralPart:function(u){this.versionMadeBy=u.readInt(2),u.skip(2),this.bitFlag=u.readInt(2),this.compressionMethod=u.readString(2),this.date=u.readDate(),this.crc32=u.readInt(4),this.compressedSize=u.readInt(4),this.uncompressedSize=u.readInt(4);var b=u.readInt(2);if(this.extraFieldsLength=u.readInt(2),this.fileCommentLength=u.readInt(2),this.diskNumberStart=u.readInt(2),this.internalFileAttributes=u.readInt(2),this.externalFileAttributes=u.readInt(4),this.localHeaderOffset=u.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");u.skip(b),this.readExtraFields(u),this.parseZIP64ExtraField(u),this.fileComment=u.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var u=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),u==0&&(this.dosPermissions=63&this.externalFileAttributes),u==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var u=n(this.extraFields[1].value);this.uncompressedSize===r.MAX_VALUE_32BITS&&(this.uncompressedSize=u.readInt(8)),this.compressedSize===r.MAX_VALUE_32BITS&&(this.compressedSize=u.readInt(8)),this.localHeaderOffset===r.MAX_VALUE_32BITS&&(this.localHeaderOffset=u.readInt(8)),this.diskNumberStart===r.MAX_VALUE_32BITS&&(this.diskNumberStart=u.readInt(4))}},readExtraFields:function(u){var b,d,v,y=u.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});u.index+4<y;)b=u.readInt(2),d=u.readInt(2),v=u.readData(d),this.extraFields[b]={id:b,length:d,value:v};u.setIndex(y)},handleUTF8:function(){var u=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var b=this.findExtraFieldUnicodePath();if(b!==null)this.fileNameStr=b;else{var d=r.transformTo(u,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(d)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var y=r.transformTo(u,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(y)}}},findExtraFieldUnicodePath:function(){var u=this.extraFields[28789];if(u){var b=n(u.value);return b.readInt(1)!==1||l(this.fileName)!==b.readInt(4)?null:f.utf8decode(b.readData(u.length-5))}return null},findExtraFieldUnicodeComment:function(){var u=this.extraFields[25461];if(u){var b=n(u.value);return b.readInt(1)!==1||l(this.fileComment)!==b.readInt(4)?null:f.utf8decode(b.readData(u.length-5))}return null}},o.exports=c},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,o,s){function n(b,d,v){this.name=b,this.dir=v.dir,this.date=v.date,this.comment=v.comment,this.unixPermissions=v.unixPermissions,this.dosPermissions=v.dosPermissions,this._data=d,this._dataBinary=v.binary,this.options={compression:v.compression,compressionOptions:v.compressionOptions}}var r=e("./stream/StreamHelper"),a=e("./stream/DataWorker"),l=e("./utf8"),f=e("./compressedObject"),h=e("./stream/GenericWorker");n.prototype={internalStream:function(b){var d=null,v="string";try{if(!b)throw new Error("No output type specified.");var y=(v=b.toLowerCase())==="string"||v==="text";v!=="binarystring"&&v!=="text"||(v="string"),d=this._decompressWorker();var E=!this._dataBinary;E&&!y&&(d=d.pipe(new l.Utf8EncodeWorker)),!E&&y&&(d=d.pipe(new l.Utf8DecodeWorker))}catch(S){(d=new h("error")).error(S)}return new r(d,v,"")},async:function(b,d){return this.internalStream(b).accumulate(d)},nodeStream:function(b,d){return this.internalStream(b||"nodebuffer").toNodejsStream(d)},_compressWorker:function(b,d){if(this._data instanceof f&&this._data.compression.magic===b.magic)return this._data.getCompressedWorker();var v=this._decompressWorker();return this._dataBinary||(v=v.pipe(new l.Utf8EncodeWorker)),f.createWorkerFrom(v,b,d)},_decompressWorker:function(){return this._data instanceof f?this._data.getContentWorker():this._data instanceof h?this._data:new a(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],c=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},u=0;u<p.length;u++)n.prototype[p[u]]=c;o.exports=n},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,o,s){(function(n){var r,a,l=n.MutationObserver||n.WebKitMutationObserver;if(l){var f=0,h=new l(b),p=n.document.createTextNode("");h.observe(p,{characterData:!0}),r=function(){p.data=f=++f%2}}else if(n.setImmediate||n.MessageChannel===void 0)r="document"in n&&"onreadystatechange"in n.document.createElement("script")?function(){var d=n.document.createElement("script");d.onreadystatechange=function(){b(),d.onreadystatechange=null,d.parentNode.removeChild(d),d=null},n.document.documentElement.appendChild(d)}:function(){setTimeout(b,0)};else{var c=new n.MessageChannel;c.port1.onmessage=b,r=function(){c.port2.postMessage(0)}}var u=[];function b(){var d,v;a=!0;for(var y=u.length;y;){for(v=u,u=[],d=-1;++d<y;)v[d]();y=u.length}a=!1}o.exports=function(d){u.push(d)!==1||a||r()}}).call(this,typeof tn<"u"?tn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,o,s){var n=e("immediate");function r(){}var a={},l=["REJECTED"],f=["FULFILLED"],h=["PENDING"];function p(y){if(typeof y!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,y!==r&&d(this,y)}function c(y,E,S){this.promise=y,typeof E=="function"&&(this.onFulfilled=E,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function u(y,E,S){n(function(){var x;try{x=E(S)}catch(N){return a.reject(y,N)}x===y?a.reject(y,new TypeError("Cannot resolve promise with itself")):a.resolve(y,x)})}function b(y){var E=y&&y.then;if(y&&(typeof y=="object"||typeof y=="function")&&typeof E=="function")return function(){E.apply(y,arguments)}}function d(y,E){var S=!1;function x($){S||(S=!0,a.reject(y,$))}function N($){S||(S=!0,a.resolve(y,$))}var F=v(function(){E(N,x)});F.status==="error"&&x(F.value)}function v(y,E){var S={};try{S.value=y(E),S.status="success"}catch(x){S.status="error",S.value=x}return S}(o.exports=p).prototype.finally=function(y){if(typeof y!="function")return this;var E=this.constructor;return this.then(function(S){return E.resolve(y()).then(function(){return S})},function(S){return E.resolve(y()).then(function(){throw S})})},p.prototype.catch=function(y){return this.then(null,y)},p.prototype.then=function(y,E){if(typeof y!="function"&&this.state===f||typeof E!="function"&&this.state===l)return this;var S=new this.constructor(r);return this.state!==h?u(S,this.state===f?y:E,this.outcome):this.queue.push(new c(S,y,E)),S},c.prototype.callFulfilled=function(y){a.resolve(this.promise,y)},c.prototype.otherCallFulfilled=function(y){u(this.promise,this.onFulfilled,y)},c.prototype.callRejected=function(y){a.reject(this.promise,y)},c.prototype.otherCallRejected=function(y){u(this.promise,this.onRejected,y)},a.resolve=function(y,E){var S=v(b,E);if(S.status==="error")return a.reject(y,S.value);var x=S.value;if(x)d(y,x);else{y.state=f,y.outcome=E;for(var N=-1,F=y.queue.length;++N<F;)y.queue[N].callFulfilled(E)}return y},a.reject=function(y,E){y.state=l,y.outcome=E;for(var S=-1,x=y.queue.length;++S<x;)y.queue[S].callRejected(E);return y},p.resolve=function(y){return y instanceof this?y:a.resolve(new this(r),y)},p.reject=function(y){var E=new this(r);return a.reject(E,y)},p.all=function(y){var E=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=y.length,x=!1;if(!S)return this.resolve([]);for(var N=new Array(S),F=0,$=-1,X=new this(r);++$<S;)O(y[$],$);return X;function O(V,it){E.resolve(V).then(function(_){N[it]=_,++F!==S||x||(x=!0,a.resolve(X,N))},function(_){x||(x=!0,a.reject(X,_))})}},p.race=function(y){var E=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=y.length,x=!1;if(!S)return this.resolve([]);for(var N=-1,F=new this(r);++N<S;)$=y[N],E.resolve($).then(function(X){x||(x=!0,a.resolve(F,X))},function(X){x||(x=!0,a.reject(F,X))});var $;return F}},{immediate:36}],38:[function(e,o,s){var n={};(0,e("./lib/utils/common").assign)(n,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),o.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,o,s){var n=e("./zlib/deflate"),r=e("./utils/common"),a=e("./utils/strings"),l=e("./zlib/messages"),f=e("./zlib/zstream"),h=Object.prototype.toString,p=0,c=-1,u=0,b=8;function d(y){if(!(this instanceof d))return new d(y);this.options=r.assign({level:c,method:b,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},y||{});var E=this.options;E.raw&&0<E.windowBits?E.windowBits=-E.windowBits:E.gzip&&0<E.windowBits&&E.windowBits<16&&(E.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var S=n.deflateInit2(this.strm,E.level,E.method,E.windowBits,E.memLevel,E.strategy);if(S!==p)throw new Error(l[S]);if(E.header&&n.deflateSetHeader(this.strm,E.header),E.dictionary){var x;if(x=typeof E.dictionary=="string"?a.string2buf(E.dictionary):h.call(E.dictionary)==="[object ArrayBuffer]"?new Uint8Array(E.dictionary):E.dictionary,(S=n.deflateSetDictionary(this.strm,x))!==p)throw new Error(l[S]);this._dict_set=!0}}function v(y,E){var S=new d(E);if(S.push(y,!0),S.err)throw S.msg||l[S.err];return S.result}d.prototype.push=function(y,E){var S,x,N=this.strm,F=this.options.chunkSize;if(this.ended)return!1;x=E===~~E?E:E===!0?4:0,typeof y=="string"?N.input=a.string2buf(y):h.call(y)==="[object ArrayBuffer]"?N.input=new Uint8Array(y):N.input=y,N.next_in=0,N.avail_in=N.input.length;do{if(N.avail_out===0&&(N.output=new r.Buf8(F),N.next_out=0,N.avail_out=F),(S=n.deflate(N,x))!==1&&S!==p)return this.onEnd(S),!(this.ended=!0);N.avail_out!==0&&(N.avail_in!==0||x!==4&&x!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(r.shrinkBuf(N.output,N.next_out))):this.onData(r.shrinkBuf(N.output,N.next_out)))}while((0<N.avail_in||N.avail_out===0)&&S!==1);return x===4?(S=n.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===p):x!==2||(this.onEnd(p),!(N.avail_out=0))},d.prototype.onData=function(y){this.chunks.push(y)},d.prototype.onEnd=function(y){y===p&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg},s.Deflate=d,s.deflate=v,s.deflateRaw=function(y,E){return(E=E||{}).raw=!0,v(y,E)},s.gzip=function(y,E){return(E=E||{}).gzip=!0,v(y,E)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,o,s){var n=e("./zlib/inflate"),r=e("./utils/common"),a=e("./utils/strings"),l=e("./zlib/constants"),f=e("./zlib/messages"),h=e("./zlib/zstream"),p=e("./zlib/gzheader"),c=Object.prototype.toString;function u(d){if(!(this instanceof u))return new u(d);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},d||{});var v=this.options;v.raw&&0<=v.windowBits&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),!(0<=v.windowBits&&v.windowBits<16)||d&&d.windowBits||(v.windowBits+=32),15<v.windowBits&&v.windowBits<48&&!(15&v.windowBits)&&(v.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var y=n.inflateInit2(this.strm,v.windowBits);if(y!==l.Z_OK)throw new Error(f[y]);this.header=new p,n.inflateGetHeader(this.strm,this.header)}function b(d,v){var y=new u(v);if(y.push(d,!0),y.err)throw y.msg||f[y.err];return y.result}u.prototype.push=function(d,v){var y,E,S,x,N,F,$=this.strm,X=this.options.chunkSize,O=this.options.dictionary,V=!1;if(this.ended)return!1;E=v===~~v?v:v===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof d=="string"?$.input=a.binstring2buf(d):c.call(d)==="[object ArrayBuffer]"?$.input=new Uint8Array(d):$.input=d,$.next_in=0,$.avail_in=$.input.length;do{if($.avail_out===0&&($.output=new r.Buf8(X),$.next_out=0,$.avail_out=X),(y=n.inflate($,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&O&&(F=typeof O=="string"?a.string2buf(O):c.call(O)==="[object ArrayBuffer]"?new Uint8Array(O):O,y=n.inflateSetDictionary(this.strm,F)),y===l.Z_BUF_ERROR&&V===!0&&(y=l.Z_OK,V=!1),y!==l.Z_STREAM_END&&y!==l.Z_OK)return this.onEnd(y),!(this.ended=!0);$.next_out&&($.avail_out!==0&&y!==l.Z_STREAM_END&&($.avail_in!==0||E!==l.Z_FINISH&&E!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=a.utf8border($.output,$.next_out),x=$.next_out-S,N=a.buf2string($.output,S),$.next_out=x,$.avail_out=X-x,x&&r.arraySet($.output,$.output,S,x,0),this.onData(N)):this.onData(r.shrinkBuf($.output,$.next_out)))),$.avail_in===0&&$.avail_out===0&&(V=!0)}while((0<$.avail_in||$.avail_out===0)&&y!==l.Z_STREAM_END);return y===l.Z_STREAM_END&&(E=l.Z_FINISH),E===l.Z_FINISH?(y=n.inflateEnd(this.strm),this.onEnd(y),this.ended=!0,y===l.Z_OK):E!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!($.avail_out=0))},u.prototype.onData=function(d){this.chunks.push(d)},u.prototype.onEnd=function(d){d===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg},s.Inflate=u,s.inflate=b,s.inflateRaw=function(d,v){return(v=v||{}).raw=!0,b(d,v)},s.ungzip=b},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,o,s){var n=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(l){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var h=f.shift();if(h){if(typeof h!="object")throw new TypeError(h+"must be non-object");for(var p in h)h.hasOwnProperty(p)&&(l[p]=h[p])}}return l},s.shrinkBuf=function(l,f){return l.length===f?l:l.subarray?l.subarray(0,f):(l.length=f,l)};var r={arraySet:function(l,f,h,p,c){if(f.subarray&&l.subarray)l.set(f.subarray(h,h+p),c);else for(var u=0;u<p;u++)l[c+u]=f[h+u]},flattenChunks:function(l){var f,h,p,c,u,b;for(f=p=0,h=l.length;f<h;f++)p+=l[f].length;for(b=new Uint8Array(p),f=c=0,h=l.length;f<h;f++)u=l[f],b.set(u,c),c+=u.length;return b}},a={arraySet:function(l,f,h,p,c){for(var u=0;u<p;u++)l[c+u]=f[h+u]},flattenChunks:function(l){return[].concat.apply([],l)}};s.setTyped=function(l){l?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,r)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,a))},s.setTyped(n)},{}],42:[function(e,o,s){var n=e("./common"),r=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var l=new n.Buf8(256),f=0;f<256;f++)l[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;function h(p,c){if(c<65537&&(p.subarray&&a||!p.subarray&&r))return String.fromCharCode.apply(null,n.shrinkBuf(p,c));for(var u="",b=0;b<c;b++)u+=String.fromCharCode(p[b]);return u}l[254]=l[254]=1,s.string2buf=function(p){var c,u,b,d,v,y=p.length,E=0;for(d=0;d<y;d++)(64512&(u=p.charCodeAt(d)))==55296&&d+1<y&&(64512&(b=p.charCodeAt(d+1)))==56320&&(u=65536+(u-55296<<10)+(b-56320),d++),E+=u<128?1:u<2048?2:u<65536?3:4;for(c=new n.Buf8(E),d=v=0;v<E;d++)(64512&(u=p.charCodeAt(d)))==55296&&d+1<y&&(64512&(b=p.charCodeAt(d+1)))==56320&&(u=65536+(u-55296<<10)+(b-56320),d++),u<128?c[v++]=u:(u<2048?c[v++]=192|u>>>6:(u<65536?c[v++]=224|u>>>12:(c[v++]=240|u>>>18,c[v++]=128|u>>>12&63),c[v++]=128|u>>>6&63),c[v++]=128|63&u);return c},s.buf2binstring=function(p){return h(p,p.length)},s.binstring2buf=function(p){for(var c=new n.Buf8(p.length),u=0,b=c.length;u<b;u++)c[u]=p.charCodeAt(u);return c},s.buf2string=function(p,c){var u,b,d,v,y=c||p.length,E=new Array(2*y);for(u=b=0;u<y;)if((d=p[u++])<128)E[b++]=d;else if(4<(v=l[d]))E[b++]=65533,u+=v-1;else{for(d&=v===2?31:v===3?15:7;1<v&&u<y;)d=d<<6|63&p[u++],v--;1<v?E[b++]=65533:d<65536?E[b++]=d:(d-=65536,E[b++]=55296|d>>10&1023,E[b++]=56320|1023&d)}return h(E,b)},s.utf8border=function(p,c){var u;for((c=c||p.length)>p.length&&(c=p.length),u=c-1;0<=u&&(192&p[u])==128;)u--;return u<0||u===0?c:u+l[p[u]]>c?u:c}},{"./common":41}],43:[function(e,o,s){o.exports=function(n,r,a,l){for(var f=65535&n|0,h=n>>>16&65535|0,p=0;a!==0;){for(a-=p=2e3<a?2e3:a;h=h+(f=f+r[l++]|0)|0,--p;);f%=65521,h%=65521}return f|h<<16|0}},{}],44:[function(e,o,s){o.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,o,s){var n=function(){for(var r,a=[],l=0;l<256;l++){r=l;for(var f=0;f<8;f++)r=1&r?3988292384^r>>>1:r>>>1;a[l]=r}return a}();o.exports=function(r,a,l,f){var h=n,p=f+l;r^=-1;for(var c=f;c<p;c++)r=r>>>8^h[255&(r^a[c])];return-1^r}},{}],46:[function(e,o,s){var n,r=e("../utils/common"),a=e("./trees"),l=e("./adler32"),f=e("./crc32"),h=e("./messages"),p=0,c=4,u=0,b=-2,d=-1,v=4,y=2,E=8,S=9,x=286,N=30,F=19,$=2*x+1,X=15,O=3,V=258,it=V+O+1,_=42,P=113,g=1,j=2,at=3,Y=4;function ct(m,G){return m.msg=h[G],G}function z(m){return(m<<1)-(4<m?9:0)}function rt(m){for(var G=m.length;0<=--G;)m[G]=0}function A(m){var G=m.state,I=G.pending;I>m.avail_out&&(I=m.avail_out),I!==0&&(r.arraySet(m.output,G.pending_buf,G.pending_out,I,m.next_out),m.next_out+=I,G.pending_out+=I,m.total_out+=I,m.avail_out-=I,G.pending-=I,G.pending===0&&(G.pending_out=0))}function k(m,G){a._tr_flush_block(m,0<=m.block_start?m.block_start:-1,m.strstart-m.block_start,G),m.block_start=m.strstart,A(m.strm)}function ot(m,G){m.pending_buf[m.pending++]=G}function Q(m,G){m.pending_buf[m.pending++]=G>>>8&255,m.pending_buf[m.pending++]=255&G}function Z(m,G){var I,w,D=m.max_chain_length,T=m.strstart,J=m.prev_length,H=m.nice_match,B=m.strstart>m.w_size-it?m.strstart-(m.w_size-it):0,q=m.window,tt=m.w_mask,K=m.prev,st=m.strstart+V,Ct=q[T+J-1],dt=q[T+J];m.prev_length>=m.good_match&&(D>>=2),H>m.lookahead&&(H=m.lookahead);do if(q[(I=G)+J]===dt&&q[I+J-1]===Ct&&q[I]===q[T]&&q[++I]===q[T+1]){T+=2,I++;do;while(q[++T]===q[++I]&&q[++T]===q[++I]&&q[++T]===q[++I]&&q[++T]===q[++I]&&q[++T]===q[++I]&&q[++T]===q[++I]&&q[++T]===q[++I]&&q[++T]===q[++I]&&T<st);if(w=V-(st-T),T=st-V,J<w){if(m.match_start=G,H<=(J=w))break;Ct=q[T+J-1],dt=q[T+J]}}while((G=K[G&tt])>B&&--D!=0);return J<=m.lookahead?J:m.lookahead}function Tt(m){var G,I,w,D,T,J,H,B,q,tt,K=m.w_size;do{if(D=m.window_size-m.lookahead-m.strstart,m.strstart>=K+(K-it)){for(r.arraySet(m.window,m.window,K,K,0),m.match_start-=K,m.strstart-=K,m.block_start-=K,G=I=m.hash_size;w=m.head[--G],m.head[G]=K<=w?w-K:0,--I;);for(G=I=K;w=m.prev[--G],m.prev[G]=K<=w?w-K:0,--I;);D+=K}if(m.strm.avail_in===0)break;if(J=m.strm,H=m.window,B=m.strstart+m.lookahead,q=D,tt=void 0,tt=J.avail_in,q<tt&&(tt=q),I=tt===0?0:(J.avail_in-=tt,r.arraySet(H,J.input,J.next_in,tt,B),J.state.wrap===1?J.adler=l(J.adler,H,tt,B):J.state.wrap===2&&(J.adler=f(J.adler,H,tt,B)),J.next_in+=tt,J.total_in+=tt,tt),m.lookahead+=I,m.lookahead+m.insert>=O)for(T=m.strstart-m.insert,m.ins_h=m.window[T],m.ins_h=(m.ins_h<<m.hash_shift^m.window[T+1])&m.hash_mask;m.insert&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[T+O-1])&m.hash_mask,m.prev[T&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=T,T++,m.insert--,!(m.lookahead+m.insert<O)););}while(m.lookahead<it&&m.strm.avail_in!==0)}function Yt(m,G){for(var I,w;;){if(m.lookahead<it){if(Tt(m),m.lookahead<it&&G===p)return g;if(m.lookahead===0)break}if(I=0,m.lookahead>=O&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+O-1])&m.hash_mask,I=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart),I!==0&&m.strstart-I<=m.w_size-it&&(m.match_length=Z(m,I)),m.match_length>=O)if(w=a._tr_tally(m,m.strstart-m.match_start,m.match_length-O),m.lookahead-=m.match_length,m.match_length<=m.max_lazy_match&&m.lookahead>=O){for(m.match_length--;m.strstart++,m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+O-1])&m.hash_mask,I=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart,--m.match_length!=0;);m.strstart++}else m.strstart+=m.match_length,m.match_length=0,m.ins_h=m.window[m.strstart],m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+1])&m.hash_mask;else w=a._tr_tally(m,0,m.window[m.strstart]),m.lookahead--,m.strstart++;if(w&&(k(m,!1),m.strm.avail_out===0))return g}return m.insert=m.strstart<O-1?m.strstart:O-1,G===c?(k(m,!0),m.strm.avail_out===0?at:Y):m.last_lit&&(k(m,!1),m.strm.avail_out===0)?g:j}function ht(m,G){for(var I,w,D;;){if(m.lookahead<it){if(Tt(m),m.lookahead<it&&G===p)return g;if(m.lookahead===0)break}if(I=0,m.lookahead>=O&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+O-1])&m.hash_mask,I=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart),m.prev_length=m.match_length,m.prev_match=m.match_start,m.match_length=O-1,I!==0&&m.prev_length<m.max_lazy_match&&m.strstart-I<=m.w_size-it&&(m.match_length=Z(m,I),m.match_length<=5&&(m.strategy===1||m.match_length===O&&4096<m.strstart-m.match_start)&&(m.match_length=O-1)),m.prev_length>=O&&m.match_length<=m.prev_length){for(D=m.strstart+m.lookahead-O,w=a._tr_tally(m,m.strstart-1-m.prev_match,m.prev_length-O),m.lookahead-=m.prev_length-1,m.prev_length-=2;++m.strstart<=D&&(m.ins_h=(m.ins_h<<m.hash_shift^m.window[m.strstart+O-1])&m.hash_mask,I=m.prev[m.strstart&m.w_mask]=m.head[m.ins_h],m.head[m.ins_h]=m.strstart),--m.prev_length!=0;);if(m.match_available=0,m.match_length=O-1,m.strstart++,w&&(k(m,!1),m.strm.avail_out===0))return g}else if(m.match_available){if((w=a._tr_tally(m,0,m.window[m.strstart-1]))&&k(m,!1),m.strstart++,m.lookahead--,m.strm.avail_out===0)return g}else m.match_available=1,m.strstart++,m.lookahead--}return m.match_available&&(w=a._tr_tally(m,0,m.window[m.strstart-1]),m.match_available=0),m.insert=m.strstart<O-1?m.strstart:O-1,G===c?(k(m,!0),m.strm.avail_out===0?at:Y):m.last_lit&&(k(m,!1),m.strm.avail_out===0)?g:j}function vt(m,G,I,w,D){this.good_length=m,this.max_lazy=G,this.nice_length=I,this.max_chain=w,this.func=D}function Gt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=E,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(2*$),this.dyn_dtree=new r.Buf16(2*(2*N+1)),this.bl_tree=new r.Buf16(2*(2*F+1)),rt(this.dyn_ltree),rt(this.dyn_dtree),rt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(X+1),this.heap=new r.Buf16(2*x+1),rt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(2*x+1),rt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Lt(m){var G;return m&&m.state?(m.total_in=m.total_out=0,m.data_type=y,(G=m.state).pending=0,G.pending_out=0,G.wrap<0&&(G.wrap=-G.wrap),G.status=G.wrap?_:P,m.adler=G.wrap===2?0:1,G.last_flush=p,a._tr_init(G),u):ct(m,b)}function De(m){var G=Lt(m);return G===u&&function(I){I.window_size=2*I.w_size,rt(I.head),I.max_lazy_match=n[I.level].max_lazy,I.good_match=n[I.level].good_length,I.nice_match=n[I.level].nice_length,I.max_chain_length=n[I.level].max_chain,I.strstart=0,I.block_start=0,I.lookahead=0,I.insert=0,I.match_length=I.prev_length=O-1,I.match_available=0,I.ins_h=0}(m.state),G}function pe(m,G,I,w,D,T){if(!m)return b;var J=1;if(G===d&&(G=6),w<0?(J=0,w=-w):15<w&&(J=2,w-=16),D<1||S<D||I!==E||w<8||15<w||G<0||9<G||T<0||v<T)return ct(m,b);w===8&&(w=9);var H=new Gt;return(m.state=H).strm=m,H.wrap=J,H.gzhead=null,H.w_bits=w,H.w_size=1<<H.w_bits,H.w_mask=H.w_size-1,H.hash_bits=D+7,H.hash_size=1<<H.hash_bits,H.hash_mask=H.hash_size-1,H.hash_shift=~~((H.hash_bits+O-1)/O),H.window=new r.Buf8(2*H.w_size),H.head=new r.Buf16(H.hash_size),H.prev=new r.Buf16(H.w_size),H.lit_bufsize=1<<D+6,H.pending_buf_size=4*H.lit_bufsize,H.pending_buf=new r.Buf8(H.pending_buf_size),H.d_buf=1*H.lit_bufsize,H.l_buf=3*H.lit_bufsize,H.level=G,H.strategy=T,H.method=I,De(m)}n=[new vt(0,0,0,0,function(m,G){var I=65535;for(I>m.pending_buf_size-5&&(I=m.pending_buf_size-5);;){if(m.lookahead<=1){if(Tt(m),m.lookahead===0&&G===p)return g;if(m.lookahead===0)break}m.strstart+=m.lookahead,m.lookahead=0;var w=m.block_start+I;if((m.strstart===0||m.strstart>=w)&&(m.lookahead=m.strstart-w,m.strstart=w,k(m,!1),m.strm.avail_out===0)||m.strstart-m.block_start>=m.w_size-it&&(k(m,!1),m.strm.avail_out===0))return g}return m.insert=0,G===c?(k(m,!0),m.strm.avail_out===0?at:Y):(m.strstart>m.block_start&&(k(m,!1),m.strm.avail_out),g)}),new vt(4,4,8,4,Yt),new vt(4,5,16,8,Yt),new vt(4,6,32,32,Yt),new vt(4,4,16,16,ht),new vt(8,16,32,32,ht),new vt(8,16,128,128,ht),new vt(8,32,128,256,ht),new vt(32,128,258,1024,ht),new vt(32,258,258,4096,ht)],s.deflateInit=function(m,G){return pe(m,G,E,15,8,0)},s.deflateInit2=pe,s.deflateReset=De,s.deflateResetKeep=Lt,s.deflateSetHeader=function(m,G){return m&&m.state?m.state.wrap!==2?b:(m.state.gzhead=G,u):b},s.deflate=function(m,G){var I,w,D,T;if(!m||!m.state||5<G||G<0)return m?ct(m,b):b;if(w=m.state,!m.output||!m.input&&m.avail_in!==0||w.status===666&&G!==c)return ct(m,m.avail_out===0?-5:b);if(w.strm=m,I=w.last_flush,w.last_flush=G,w.status===_)if(w.wrap===2)m.adler=0,ot(w,31),ot(w,139),ot(w,8),w.gzhead?(ot(w,(w.gzhead.text?1:0)+(w.gzhead.hcrc?2:0)+(w.gzhead.extra?4:0)+(w.gzhead.name?8:0)+(w.gzhead.comment?16:0)),ot(w,255&w.gzhead.time),ot(w,w.gzhead.time>>8&255),ot(w,w.gzhead.time>>16&255),ot(w,w.gzhead.time>>24&255),ot(w,w.level===9?2:2<=w.strategy||w.level<2?4:0),ot(w,255&w.gzhead.os),w.gzhead.extra&&w.gzhead.extra.length&&(ot(w,255&w.gzhead.extra.length),ot(w,w.gzhead.extra.length>>8&255)),w.gzhead.hcrc&&(m.adler=f(m.adler,w.pending_buf,w.pending,0)),w.gzindex=0,w.status=69):(ot(w,0),ot(w,0),ot(w,0),ot(w,0),ot(w,0),ot(w,w.level===9?2:2<=w.strategy||w.level<2?4:0),ot(w,3),w.status=P);else{var J=E+(w.w_bits-8<<4)<<8;J|=(2<=w.strategy||w.level<2?0:w.level<6?1:w.level===6?2:3)<<6,w.strstart!==0&&(J|=32),J+=31-J%31,w.status=P,Q(w,J),w.strstart!==0&&(Q(w,m.adler>>>16),Q(w,65535&m.adler)),m.adler=1}if(w.status===69)if(w.gzhead.extra){for(D=w.pending;w.gzindex<(65535&w.gzhead.extra.length)&&(w.pending!==w.pending_buf_size||(w.gzhead.hcrc&&w.pending>D&&(m.adler=f(m.adler,w.pending_buf,w.pending-D,D)),A(m),D=w.pending,w.pending!==w.pending_buf_size));)ot(w,255&w.gzhead.extra[w.gzindex]),w.gzindex++;w.gzhead.hcrc&&w.pending>D&&(m.adler=f(m.adler,w.pending_buf,w.pending-D,D)),w.gzindex===w.gzhead.extra.length&&(w.gzindex=0,w.status=73)}else w.status=73;if(w.status===73)if(w.gzhead.name){D=w.pending;do{if(w.pending===w.pending_buf_size&&(w.gzhead.hcrc&&w.pending>D&&(m.adler=f(m.adler,w.pending_buf,w.pending-D,D)),A(m),D=w.pending,w.pending===w.pending_buf_size)){T=1;break}T=w.gzindex<w.gzhead.name.length?255&w.gzhead.name.charCodeAt(w.gzindex++):0,ot(w,T)}while(T!==0);w.gzhead.hcrc&&w.pending>D&&(m.adler=f(m.adler,w.pending_buf,w.pending-D,D)),T===0&&(w.gzindex=0,w.status=91)}else w.status=91;if(w.status===91)if(w.gzhead.comment){D=w.pending;do{if(w.pending===w.pending_buf_size&&(w.gzhead.hcrc&&w.pending>D&&(m.adler=f(m.adler,w.pending_buf,w.pending-D,D)),A(m),D=w.pending,w.pending===w.pending_buf_size)){T=1;break}T=w.gzindex<w.gzhead.comment.length?255&w.gzhead.comment.charCodeAt(w.gzindex++):0,ot(w,T)}while(T!==0);w.gzhead.hcrc&&w.pending>D&&(m.adler=f(m.adler,w.pending_buf,w.pending-D,D)),T===0&&(w.status=103)}else w.status=103;if(w.status===103&&(w.gzhead.hcrc?(w.pending+2>w.pending_buf_size&&A(m),w.pending+2<=w.pending_buf_size&&(ot(w,255&m.adler),ot(w,m.adler>>8&255),m.adler=0,w.status=P)):w.status=P),w.pending!==0){if(A(m),m.avail_out===0)return w.last_flush=-1,u}else if(m.avail_in===0&&z(G)<=z(I)&&G!==c)return ct(m,-5);if(w.status===666&&m.avail_in!==0)return ct(m,-5);if(m.avail_in!==0||w.lookahead!==0||G!==p&&w.status!==666){var H=w.strategy===2?function(B,q){for(var tt;;){if(B.lookahead===0&&(Tt(B),B.lookahead===0)){if(q===p)return g;break}if(B.match_length=0,tt=a._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++,tt&&(k(B,!1),B.strm.avail_out===0))return g}return B.insert=0,q===c?(k(B,!0),B.strm.avail_out===0?at:Y):B.last_lit&&(k(B,!1),B.strm.avail_out===0)?g:j}(w,G):w.strategy===3?function(B,q){for(var tt,K,st,Ct,dt=B.window;;){if(B.lookahead<=V){if(Tt(B),B.lookahead<=V&&q===p)return g;if(B.lookahead===0)break}if(B.match_length=0,B.lookahead>=O&&0<B.strstart&&(K=dt[st=B.strstart-1])===dt[++st]&&K===dt[++st]&&K===dt[++st]){Ct=B.strstart+V;do;while(K===dt[++st]&&K===dt[++st]&&K===dt[++st]&&K===dt[++st]&&K===dt[++st]&&K===dt[++st]&&K===dt[++st]&&K===dt[++st]&&st<Ct);B.match_length=V-(Ct-st),B.match_length>B.lookahead&&(B.match_length=B.lookahead)}if(B.match_length>=O?(tt=a._tr_tally(B,1,B.match_length-O),B.lookahead-=B.match_length,B.strstart+=B.match_length,B.match_length=0):(tt=a._tr_tally(B,0,B.window[B.strstart]),B.lookahead--,B.strstart++),tt&&(k(B,!1),B.strm.avail_out===0))return g}return B.insert=0,q===c?(k(B,!0),B.strm.avail_out===0?at:Y):B.last_lit&&(k(B,!1),B.strm.avail_out===0)?g:j}(w,G):n[w.level].func(w,G);if(H!==at&&H!==Y||(w.status=666),H===g||H===at)return m.avail_out===0&&(w.last_flush=-1),u;if(H===j&&(G===1?a._tr_align(w):G!==5&&(a._tr_stored_block(w,0,0,!1),G===3&&(rt(w.head),w.lookahead===0&&(w.strstart=0,w.block_start=0,w.insert=0))),A(m),m.avail_out===0))return w.last_flush=-1,u}return G!==c?u:w.wrap<=0?1:(w.wrap===2?(ot(w,255&m.adler),ot(w,m.adler>>8&255),ot(w,m.adler>>16&255),ot(w,m.adler>>24&255),ot(w,255&m.total_in),ot(w,m.total_in>>8&255),ot(w,m.total_in>>16&255),ot(w,m.total_in>>24&255)):(Q(w,m.adler>>>16),Q(w,65535&m.adler)),A(m),0<w.wrap&&(w.wrap=-w.wrap),w.pending!==0?u:1)},s.deflateEnd=function(m){var G;return m&&m.state?(G=m.state.status)!==_&&G!==69&&G!==73&&G!==91&&G!==103&&G!==P&&G!==666?ct(m,b):(m.state=null,G===P?ct(m,-3):u):b},s.deflateSetDictionary=function(m,G){var I,w,D,T,J,H,B,q,tt=G.length;if(!m||!m.state||(T=(I=m.state).wrap)===2||T===1&&I.status!==_||I.lookahead)return b;for(T===1&&(m.adler=l(m.adler,G,tt,0)),I.wrap=0,tt>=I.w_size&&(T===0&&(rt(I.head),I.strstart=0,I.block_start=0,I.insert=0),q=new r.Buf8(I.w_size),r.arraySet(q,G,tt-I.w_size,I.w_size,0),G=q,tt=I.w_size),J=m.avail_in,H=m.next_in,B=m.input,m.avail_in=tt,m.next_in=0,m.input=G,Tt(I);I.lookahead>=O;){for(w=I.strstart,D=I.lookahead-(O-1);I.ins_h=(I.ins_h<<I.hash_shift^I.window[w+O-1])&I.hash_mask,I.prev[w&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=w,w++,--D;);I.strstart=w,I.lookahead=O-1,Tt(I)}return I.strstart+=I.lookahead,I.block_start=I.strstart,I.insert=I.lookahead,I.lookahead=0,I.match_length=I.prev_length=O-1,I.match_available=0,m.next_in=H,m.input=B,m.avail_in=J,I.wrap=T,u},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,o,s){o.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,o,s){o.exports=function(n,r){var a,l,f,h,p,c,u,b,d,v,y,E,S,x,N,F,$,X,O,V,it,_,P,g,j;a=n.state,l=n.next_in,g=n.input,f=l+(n.avail_in-5),h=n.next_out,j=n.output,p=h-(r-n.avail_out),c=h+(n.avail_out-257),u=a.dmax,b=a.wsize,d=a.whave,v=a.wnext,y=a.window,E=a.hold,S=a.bits,x=a.lencode,N=a.distcode,F=(1<<a.lenbits)-1,$=(1<<a.distbits)-1;t:do{S<15&&(E+=g[l++]<<S,S+=8,E+=g[l++]<<S,S+=8),X=x[E&F];e:for(;;){if(E>>>=O=X>>>24,S-=O,(O=X>>>16&255)===0)j[h++]=65535&X;else{if(!(16&O)){if(!(64&O)){X=x[(65535&X)+(E&(1<<O)-1)];continue e}if(32&O){a.mode=12;break t}n.msg="invalid literal/length code",a.mode=30;break t}V=65535&X,(O&=15)&&(S<O&&(E+=g[l++]<<S,S+=8),V+=E&(1<<O)-1,E>>>=O,S-=O),S<15&&(E+=g[l++]<<S,S+=8,E+=g[l++]<<S,S+=8),X=N[E&$];i:for(;;){if(E>>>=O=X>>>24,S-=O,!(16&(O=X>>>16&255))){if(!(64&O)){X=N[(65535&X)+(E&(1<<O)-1)];continue i}n.msg="invalid distance code",a.mode=30;break t}if(it=65535&X,S<(O&=15)&&(E+=g[l++]<<S,(S+=8)<O&&(E+=g[l++]<<S,S+=8)),u<(it+=E&(1<<O)-1)){n.msg="invalid distance too far back",a.mode=30;break t}if(E>>>=O,S-=O,(O=h-p)<it){if(d<(O=it-O)&&a.sane){n.msg="invalid distance too far back",a.mode=30;break t}if(P=y,(_=0)===v){if(_+=b-O,O<V){for(V-=O;j[h++]=y[_++],--O;);_=h-it,P=j}}else if(v<O){if(_+=b+v-O,(O-=v)<V){for(V-=O;j[h++]=y[_++],--O;);if(_=0,v<V){for(V-=O=v;j[h++]=y[_++],--O;);_=h-it,P=j}}}else if(_+=v-O,O<V){for(V-=O;j[h++]=y[_++],--O;);_=h-it,P=j}for(;2<V;)j[h++]=P[_++],j[h++]=P[_++],j[h++]=P[_++],V-=3;V&&(j[h++]=P[_++],1<V&&(j[h++]=P[_++]))}else{for(_=h-it;j[h++]=j[_++],j[h++]=j[_++],j[h++]=j[_++],2<(V-=3););V&&(j[h++]=j[_++],1<V&&(j[h++]=j[_++]))}break}}break}}while(l<f&&h<c);l-=V=S>>3,E&=(1<<(S-=V<<3))-1,n.next_in=l,n.next_out=h,n.avail_in=l<f?f-l+5:5-(l-f),n.avail_out=h<c?c-h+257:257-(h-c),a.hold=E,a.bits=S}},{}],49:[function(e,o,s){var n=e("../utils/common"),r=e("./adler32"),a=e("./crc32"),l=e("./inffast"),f=e("./inftrees"),h=1,p=2,c=0,u=-2,b=1,d=852,v=592;function y(_){return(_>>>24&255)+(_>>>8&65280)+((65280&_)<<8)+((255&_)<<24)}function E(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(_){var P;return _&&_.state?(P=_.state,_.total_in=_.total_out=P.total=0,_.msg="",P.wrap&&(_.adler=1&P.wrap),P.mode=b,P.last=0,P.havedict=0,P.dmax=32768,P.head=null,P.hold=0,P.bits=0,P.lencode=P.lendyn=new n.Buf32(d),P.distcode=P.distdyn=new n.Buf32(v),P.sane=1,P.back=-1,c):u}function x(_){var P;return _&&_.state?((P=_.state).wsize=0,P.whave=0,P.wnext=0,S(_)):u}function N(_,P){var g,j;return _&&_.state?(j=_.state,P<0?(g=0,P=-P):(g=1+(P>>4),P<48&&(P&=15)),P&&(P<8||15<P)?u:(j.window!==null&&j.wbits!==P&&(j.window=null),j.wrap=g,j.wbits=P,x(_))):u}function F(_,P){var g,j;return _?(j=new E,(_.state=j).window=null,(g=N(_,P))!==c&&(_.state=null),g):u}var $,X,O=!0;function V(_){if(O){var P;for($=new n.Buf32(512),X=new n.Buf32(32),P=0;P<144;)_.lens[P++]=8;for(;P<256;)_.lens[P++]=9;for(;P<280;)_.lens[P++]=7;for(;P<288;)_.lens[P++]=8;for(f(h,_.lens,0,288,$,0,_.work,{bits:9}),P=0;P<32;)_.lens[P++]=5;f(p,_.lens,0,32,X,0,_.work,{bits:5}),O=!1}_.lencode=$,_.lenbits=9,_.distcode=X,_.distbits=5}function it(_,P,g,j){var at,Y=_.state;return Y.window===null&&(Y.wsize=1<<Y.wbits,Y.wnext=0,Y.whave=0,Y.window=new n.Buf8(Y.wsize)),j>=Y.wsize?(n.arraySet(Y.window,P,g-Y.wsize,Y.wsize,0),Y.wnext=0,Y.whave=Y.wsize):(j<(at=Y.wsize-Y.wnext)&&(at=j),n.arraySet(Y.window,P,g-j,at,Y.wnext),(j-=at)?(n.arraySet(Y.window,P,g-j,j,0),Y.wnext=j,Y.whave=Y.wsize):(Y.wnext+=at,Y.wnext===Y.wsize&&(Y.wnext=0),Y.whave<Y.wsize&&(Y.whave+=at))),0}s.inflateReset=x,s.inflateReset2=N,s.inflateResetKeep=S,s.inflateInit=function(_){return F(_,15)},s.inflateInit2=F,s.inflate=function(_,P){var g,j,at,Y,ct,z,rt,A,k,ot,Q,Z,Tt,Yt,ht,vt,Gt,Lt,De,pe,m,G,I,w,D=0,T=new n.Buf8(4),J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!_||!_.state||!_.output||!_.input&&_.avail_in!==0)return u;(g=_.state).mode===12&&(g.mode=13),ct=_.next_out,at=_.output,rt=_.avail_out,Y=_.next_in,j=_.input,z=_.avail_in,A=g.hold,k=g.bits,ot=z,Q=rt,G=c;t:for(;;)switch(g.mode){case b:if(g.wrap===0){g.mode=13;break}for(;k<16;){if(z===0)break t;z--,A+=j[Y++]<<k,k+=8}if(2&g.wrap&&A===35615){T[g.check=0]=255&A,T[1]=A>>>8&255,g.check=a(g.check,T,2,0),k=A=0,g.mode=2;break}if(g.flags=0,g.head&&(g.head.done=!1),!(1&g.wrap)||(((255&A)<<8)+(A>>8))%31){_.msg="incorrect header check",g.mode=30;break}if((15&A)!=8){_.msg="unknown compression method",g.mode=30;break}if(k-=4,m=8+(15&(A>>>=4)),g.wbits===0)g.wbits=m;else if(m>g.wbits){_.msg="invalid window size",g.mode=30;break}g.dmax=1<<m,_.adler=g.check=1,g.mode=512&A?10:12,k=A=0;break;case 2:for(;k<16;){if(z===0)break t;z--,A+=j[Y++]<<k,k+=8}if(g.flags=A,(255&g.flags)!=8){_.msg="unknown compression method",g.mode=30;break}if(57344&g.flags){_.msg="unknown header flags set",g.mode=30;break}g.head&&(g.head.text=A>>8&1),512&g.flags&&(T[0]=255&A,T[1]=A>>>8&255,g.check=a(g.check,T,2,0)),k=A=0,g.mode=3;case 3:for(;k<32;){if(z===0)break t;z--,A+=j[Y++]<<k,k+=8}g.head&&(g.head.time=A),512&g.flags&&(T[0]=255&A,T[1]=A>>>8&255,T[2]=A>>>16&255,T[3]=A>>>24&255,g.check=a(g.check,T,4,0)),k=A=0,g.mode=4;case 4:for(;k<16;){if(z===0)break t;z--,A+=j[Y++]<<k,k+=8}g.head&&(g.head.xflags=255&A,g.head.os=A>>8),512&g.flags&&(T[0]=255&A,T[1]=A>>>8&255,g.check=a(g.check,T,2,0)),k=A=0,g.mode=5;case 5:if(1024&g.flags){for(;k<16;){if(z===0)break t;z--,A+=j[Y++]<<k,k+=8}g.length=A,g.head&&(g.head.extra_len=A),512&g.flags&&(T[0]=255&A,T[1]=A>>>8&255,g.check=a(g.check,T,2,0)),k=A=0}else g.head&&(g.head.extra=null);g.mode=6;case 6:if(1024&g.flags&&(z<(Z=g.length)&&(Z=z),Z&&(g.head&&(m=g.head.extra_len-g.length,g.head.extra||(g.head.extra=new Array(g.head.extra_len)),n.arraySet(g.head.extra,j,Y,Z,m)),512&g.flags&&(g.check=a(g.check,j,Z,Y)),z-=Z,Y+=Z,g.length-=Z),g.length))break t;g.length=0,g.mode=7;case 7:if(2048&g.flags){if(z===0)break t;for(Z=0;m=j[Y+Z++],g.head&&m&&g.length<65536&&(g.head.name+=String.fromCharCode(m)),m&&Z<z;);if(512&g.flags&&(g.check=a(g.check,j,Z,Y)),z-=Z,Y+=Z,m)break t}else g.head&&(g.head.name=null);g.length=0,g.mode=8;case 8:if(4096&g.flags){if(z===0)break t;for(Z=0;m=j[Y+Z++],g.head&&m&&g.length<65536&&(g.head.comment+=String.fromCharCode(m)),m&&Z<z;);if(512&g.flags&&(g.check=a(g.check,j,Z,Y)),z-=Z,Y+=Z,m)break t}else g.head&&(g.head.comment=null);g.mode=9;case 9:if(512&g.flags){for(;k<16;){if(z===0)break t;z--,A+=j[Y++]<<k,k+=8}if(A!==(65535&g.check)){_.msg="header crc mismatch",g.mode=30;break}k=A=0}g.head&&(g.head.hcrc=g.flags>>9&1,g.head.done=!0),_.adler=g.check=0,g.mode=12;break;case 10:for(;k<32;){if(z===0)break t;z--,A+=j[Y++]<<k,k+=8}_.adler=g.check=y(A),k=A=0,g.mode=11;case 11:if(g.havedict===0)return _.next_out=ct,_.avail_out=rt,_.next_in=Y,_.avail_in=z,g.hold=A,g.bits=k,2;_.adler=g.check=1,g.mode=12;case 12:if(P===5||P===6)break t;case 13:if(g.last){A>>>=7&k,k-=7&k,g.mode=27;break}for(;k<3;){if(z===0)break t;z--,A+=j[Y++]<<k,k+=8}switch(g.last=1&A,k-=1,3&(A>>>=1)){case 0:g.mode=14;break;case 1:if(V(g),g.mode=20,P!==6)break;A>>>=2,k-=2;break t;case 2:g.mode=17;break;case 3:_.msg="invalid block type",g.mode=30}A>>>=2,k-=2;break;case 14:for(A>>>=7&k,k-=7&k;k<32;){if(z===0)break t;z--,A+=j[Y++]<<k,k+=8}if((65535&A)!=(A>>>16^65535)){_.msg="invalid stored block lengths",g.mode=30;break}if(g.length=65535&A,k=A=0,g.mode=15,P===6)break t;case 15:g.mode=16;case 16:if(Z=g.length){if(z<Z&&(Z=z),rt<Z&&(Z=rt),Z===0)break t;n.arraySet(at,j,Y,Z,ct),z-=Z,Y+=Z,rt-=Z,ct+=Z,g.length-=Z;break}g.mode=12;break;case 17:for(;k<14;){if(z===0)break t;z--,A+=j[Y++]<<k,k+=8}if(g.nlen=257+(31&A),A>>>=5,k-=5,g.ndist=1+(31&A),A>>>=5,k-=5,g.ncode=4+(15&A),A>>>=4,k-=4,286<g.nlen||30<g.ndist){_.msg="too many length or distance symbols",g.mode=30;break}g.have=0,g.mode=18;case 18:for(;g.have<g.ncode;){for(;k<3;){if(z===0)break t;z--,A+=j[Y++]<<k,k+=8}g.lens[J[g.have++]]=7&A,A>>>=3,k-=3}for(;g.have<19;)g.lens[J[g.have++]]=0;if(g.lencode=g.lendyn,g.lenbits=7,I={bits:g.lenbits},G=f(0,g.lens,0,19,g.lencode,0,g.work,I),g.lenbits=I.bits,G){_.msg="invalid code lengths set",g.mode=30;break}g.have=0,g.mode=19;case 19:for(;g.have<g.nlen+g.ndist;){for(;vt=(D=g.lencode[A&(1<<g.lenbits)-1])>>>16&255,Gt=65535&D,!((ht=D>>>24)<=k);){if(z===0)break t;z--,A+=j[Y++]<<k,k+=8}if(Gt<16)A>>>=ht,k-=ht,g.lens[g.have++]=Gt;else{if(Gt===16){for(w=ht+2;k<w;){if(z===0)break t;z--,A+=j[Y++]<<k,k+=8}if(A>>>=ht,k-=ht,g.have===0){_.msg="invalid bit length repeat",g.mode=30;break}m=g.lens[g.have-1],Z=3+(3&A),A>>>=2,k-=2}else if(Gt===17){for(w=ht+3;k<w;){if(z===0)break t;z--,A+=j[Y++]<<k,k+=8}k-=ht,m=0,Z=3+(7&(A>>>=ht)),A>>>=3,k-=3}else{for(w=ht+7;k<w;){if(z===0)break t;z--,A+=j[Y++]<<k,k+=8}k-=ht,m=0,Z=11+(127&(A>>>=ht)),A>>>=7,k-=7}if(g.have+Z>g.nlen+g.ndist){_.msg="invalid bit length repeat",g.mode=30;break}for(;Z--;)g.lens[g.have++]=m}}if(g.mode===30)break;if(g.lens[256]===0){_.msg="invalid code -- missing end-of-block",g.mode=30;break}if(g.lenbits=9,I={bits:g.lenbits},G=f(h,g.lens,0,g.nlen,g.lencode,0,g.work,I),g.lenbits=I.bits,G){_.msg="invalid literal/lengths set",g.mode=30;break}if(g.distbits=6,g.distcode=g.distdyn,I={bits:g.distbits},G=f(p,g.lens,g.nlen,g.ndist,g.distcode,0,g.work,I),g.distbits=I.bits,G){_.msg="invalid distances set",g.mode=30;break}if(g.mode=20,P===6)break t;case 20:g.mode=21;case 21:if(6<=z&&258<=rt){_.next_out=ct,_.avail_out=rt,_.next_in=Y,_.avail_in=z,g.hold=A,g.bits=k,l(_,Q),ct=_.next_out,at=_.output,rt=_.avail_out,Y=_.next_in,j=_.input,z=_.avail_in,A=g.hold,k=g.bits,g.mode===12&&(g.back=-1);break}for(g.back=0;vt=(D=g.lencode[A&(1<<g.lenbits)-1])>>>16&255,Gt=65535&D,!((ht=D>>>24)<=k);){if(z===0)break t;z--,A+=j[Y++]<<k,k+=8}if(vt&&!(240&vt)){for(Lt=ht,De=vt,pe=Gt;vt=(D=g.lencode[pe+((A&(1<<Lt+De)-1)>>Lt)])>>>16&255,Gt=65535&D,!(Lt+(ht=D>>>24)<=k);){if(z===0)break t;z--,A+=j[Y++]<<k,k+=8}A>>>=Lt,k-=Lt,g.back+=Lt}if(A>>>=ht,k-=ht,g.back+=ht,g.length=Gt,vt===0){g.mode=26;break}if(32&vt){g.back=-1,g.mode=12;break}if(64&vt){_.msg="invalid literal/length code",g.mode=30;break}g.extra=15&vt,g.mode=22;case 22:if(g.extra){for(w=g.extra;k<w;){if(z===0)break t;z--,A+=j[Y++]<<k,k+=8}g.length+=A&(1<<g.extra)-1,A>>>=g.extra,k-=g.extra,g.back+=g.extra}g.was=g.length,g.mode=23;case 23:for(;vt=(D=g.distcode[A&(1<<g.distbits)-1])>>>16&255,Gt=65535&D,!((ht=D>>>24)<=k);){if(z===0)break t;z--,A+=j[Y++]<<k,k+=8}if(!(240&vt)){for(Lt=ht,De=vt,pe=Gt;vt=(D=g.distcode[pe+((A&(1<<Lt+De)-1)>>Lt)])>>>16&255,Gt=65535&D,!(Lt+(ht=D>>>24)<=k);){if(z===0)break t;z--,A+=j[Y++]<<k,k+=8}A>>>=Lt,k-=Lt,g.back+=Lt}if(A>>>=ht,k-=ht,g.back+=ht,64&vt){_.msg="invalid distance code",g.mode=30;break}g.offset=Gt,g.extra=15&vt,g.mode=24;case 24:if(g.extra){for(w=g.extra;k<w;){if(z===0)break t;z--,A+=j[Y++]<<k,k+=8}g.offset+=A&(1<<g.extra)-1,A>>>=g.extra,k-=g.extra,g.back+=g.extra}if(g.offset>g.dmax){_.msg="invalid distance too far back",g.mode=30;break}g.mode=25;case 25:if(rt===0)break t;if(Z=Q-rt,g.offset>Z){if((Z=g.offset-Z)>g.whave&&g.sane){_.msg="invalid distance too far back",g.mode=30;break}Tt=Z>g.wnext?(Z-=g.wnext,g.wsize-Z):g.wnext-Z,Z>g.length&&(Z=g.length),Yt=g.window}else Yt=at,Tt=ct-g.offset,Z=g.length;for(rt<Z&&(Z=rt),rt-=Z,g.length-=Z;at[ct++]=Yt[Tt++],--Z;);g.length===0&&(g.mode=21);break;case 26:if(rt===0)break t;at[ct++]=g.length,rt--,g.mode=21;break;case 27:if(g.wrap){for(;k<32;){if(z===0)break t;z--,A|=j[Y++]<<k,k+=8}if(Q-=rt,_.total_out+=Q,g.total+=Q,Q&&(_.adler=g.check=g.flags?a(g.check,at,Q,ct-Q):r(g.check,at,Q,ct-Q)),Q=rt,(g.flags?A:y(A))!==g.check){_.msg="incorrect data check",g.mode=30;break}k=A=0}g.mode=28;case 28:if(g.wrap&&g.flags){for(;k<32;){if(z===0)break t;z--,A+=j[Y++]<<k,k+=8}if(A!==(4294967295&g.total)){_.msg="incorrect length check",g.mode=30;break}k=A=0}g.mode=29;case 29:G=1;break t;case 30:G=-3;break t;case 31:return-4;case 32:default:return u}return _.next_out=ct,_.avail_out=rt,_.next_in=Y,_.avail_in=z,g.hold=A,g.bits=k,(g.wsize||Q!==_.avail_out&&g.mode<30&&(g.mode<27||P!==4))&&it(_,_.output,_.next_out,Q-_.avail_out)?(g.mode=31,-4):(ot-=_.avail_in,Q-=_.avail_out,_.total_in+=ot,_.total_out+=Q,g.total+=Q,g.wrap&&Q&&(_.adler=g.check=g.flags?a(g.check,at,Q,_.next_out-Q):r(g.check,at,Q,_.next_out-Q)),_.data_type=g.bits+(g.last?64:0)+(g.mode===12?128:0)+(g.mode===20||g.mode===15?256:0),(ot==0&&Q===0||P===4)&&G===c&&(G=-5),G)},s.inflateEnd=function(_){if(!_||!_.state)return u;var P=_.state;return P.window&&(P.window=null),_.state=null,c},s.inflateGetHeader=function(_,P){var g;return _&&_.state&&2&(g=_.state).wrap?((g.head=P).done=!1,c):u},s.inflateSetDictionary=function(_,P){var g,j=P.length;return _&&_.state?(g=_.state).wrap!==0&&g.mode!==11?u:g.mode===11&&r(1,P,j,0)!==g.check?-3:it(_,P,j,j)?(g.mode=31,-4):(g.havedict=1,c):u},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,o,s){var n=e("../utils/common"),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];o.exports=function(h,p,c,u,b,d,v,y){var E,S,x,N,F,$,X,O,V,it=y.bits,_=0,P=0,g=0,j=0,at=0,Y=0,ct=0,z=0,rt=0,A=0,k=null,ot=0,Q=new n.Buf16(16),Z=new n.Buf16(16),Tt=null,Yt=0;for(_=0;_<=15;_++)Q[_]=0;for(P=0;P<u;P++)Q[p[c+P]]++;for(at=it,j=15;1<=j&&Q[j]===0;j--);if(j<at&&(at=j),j===0)return b[d++]=20971520,b[d++]=20971520,y.bits=1,0;for(g=1;g<j&&Q[g]===0;g++);for(at<g&&(at=g),_=z=1;_<=15;_++)if(z<<=1,(z-=Q[_])<0)return-1;if(0<z&&(h===0||j!==1))return-1;for(Z[1]=0,_=1;_<15;_++)Z[_+1]=Z[_]+Q[_];for(P=0;P<u;P++)p[c+P]!==0&&(v[Z[p[c+P]]++]=P);if($=h===0?(k=Tt=v,19):h===1?(k=r,ot-=257,Tt=a,Yt-=257,256):(k=l,Tt=f,-1),_=g,F=d,ct=P=A=0,x=-1,N=(rt=1<<(Y=at))-1,h===1&&852<rt||h===2&&592<rt)return 1;for(;;){for(X=_-ct,V=v[P]<$?(O=0,v[P]):v[P]>$?(O=Tt[Yt+v[P]],k[ot+v[P]]):(O=96,0),E=1<<_-ct,g=S=1<<Y;b[F+(A>>ct)+(S-=E)]=X<<24|O<<16|V|0,S!==0;);for(E=1<<_-1;A&E;)E>>=1;if(E!==0?(A&=E-1,A+=E):A=0,P++,--Q[_]==0){if(_===j)break;_=p[c+v[P]]}if(at<_&&(A&N)!==x){for(ct===0&&(ct=at),F+=g,z=1<<(Y=_-ct);Y+ct<j&&!((z-=Q[Y+ct])<=0);)Y++,z<<=1;if(rt+=1<<Y,h===1&&852<rt||h===2&&592<rt)return 1;b[x=A&N]=at<<24|Y<<16|F-d|0}}return A!==0&&(b[F+A]=_-ct<<24|64<<16|0),y.bits=at,0}},{"../utils/common":41}],51:[function(e,o,s){o.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,o,s){var n=e("../utils/common"),r=0,a=1;function l(D){for(var T=D.length;0<=--T;)D[T]=0}var f=0,h=29,p=256,c=p+1+h,u=30,b=19,d=2*c+1,v=15,y=16,E=7,S=256,x=16,N=17,F=18,$=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],X=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],O=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],it=new Array(2*(c+2));l(it);var _=new Array(2*u);l(_);var P=new Array(512);l(P);var g=new Array(256);l(g);var j=new Array(h);l(j);var at,Y,ct,z=new Array(u);function rt(D,T,J,H,B){this.static_tree=D,this.extra_bits=T,this.extra_base=J,this.elems=H,this.max_length=B,this.has_stree=D&&D.length}function A(D,T){this.dyn_tree=D,this.max_code=0,this.stat_desc=T}function k(D){return D<256?P[D]:P[256+(D>>>7)]}function ot(D,T){D.pending_buf[D.pending++]=255&T,D.pending_buf[D.pending++]=T>>>8&255}function Q(D,T,J){D.bi_valid>y-J?(D.bi_buf|=T<<D.bi_valid&65535,ot(D,D.bi_buf),D.bi_buf=T>>y-D.bi_valid,D.bi_valid+=J-y):(D.bi_buf|=T<<D.bi_valid&65535,D.bi_valid+=J)}function Z(D,T,J){Q(D,J[2*T],J[2*T+1])}function Tt(D,T){for(var J=0;J|=1&D,D>>>=1,J<<=1,0<--T;);return J>>>1}function Yt(D,T,J){var H,B,q=new Array(v+1),tt=0;for(H=1;H<=v;H++)q[H]=tt=tt+J[H-1]<<1;for(B=0;B<=T;B++){var K=D[2*B+1];K!==0&&(D[2*B]=Tt(q[K]++,K))}}function ht(D){var T;for(T=0;T<c;T++)D.dyn_ltree[2*T]=0;for(T=0;T<u;T++)D.dyn_dtree[2*T]=0;for(T=0;T<b;T++)D.bl_tree[2*T]=0;D.dyn_ltree[2*S]=1,D.opt_len=D.static_len=0,D.last_lit=D.matches=0}function vt(D){8<D.bi_valid?ot(D,D.bi_buf):0<D.bi_valid&&(D.pending_buf[D.pending++]=D.bi_buf),D.bi_buf=0,D.bi_valid=0}function Gt(D,T,J,H){var B=2*T,q=2*J;return D[B]<D[q]||D[B]===D[q]&&H[T]<=H[J]}function Lt(D,T,J){for(var H=D.heap[J],B=J<<1;B<=D.heap_len&&(B<D.heap_len&&Gt(T,D.heap[B+1],D.heap[B],D.depth)&&B++,!Gt(T,H,D.heap[B],D.depth));)D.heap[J]=D.heap[B],J=B,B<<=1;D.heap[J]=H}function De(D,T,J){var H,B,q,tt,K=0;if(D.last_lit!==0)for(;H=D.pending_buf[D.d_buf+2*K]<<8|D.pending_buf[D.d_buf+2*K+1],B=D.pending_buf[D.l_buf+K],K++,H===0?Z(D,B,T):(Z(D,(q=g[B])+p+1,T),(tt=$[q])!==0&&Q(D,B-=j[q],tt),Z(D,q=k(--H),J),(tt=X[q])!==0&&Q(D,H-=z[q],tt)),K<D.last_lit;);Z(D,S,T)}function pe(D,T){var J,H,B,q=T.dyn_tree,tt=T.stat_desc.static_tree,K=T.stat_desc.has_stree,st=T.stat_desc.elems,Ct=-1;for(D.heap_len=0,D.heap_max=d,J=0;J<st;J++)q[2*J]!==0?(D.heap[++D.heap_len]=Ct=J,D.depth[J]=0):q[2*J+1]=0;for(;D.heap_len<2;)q[2*(B=D.heap[++D.heap_len]=Ct<2?++Ct:0)]=1,D.depth[B]=0,D.opt_len--,K&&(D.static_len-=tt[2*B+1]);for(T.max_code=Ct,J=D.heap_len>>1;1<=J;J--)Lt(D,q,J);for(B=st;J=D.heap[1],D.heap[1]=D.heap[D.heap_len--],Lt(D,q,1),H=D.heap[1],D.heap[--D.heap_max]=J,D.heap[--D.heap_max]=H,q[2*B]=q[2*J]+q[2*H],D.depth[B]=(D.depth[J]>=D.depth[H]?D.depth[J]:D.depth[H])+1,q[2*J+1]=q[2*H+1]=B,D.heap[1]=B++,Lt(D,q,1),2<=D.heap_len;);D.heap[--D.heap_max]=D.heap[1],function(dt,Se){var Ji,Oe,Wi,jt,mo,Mo,ze=Se.dyn_tree,as=Se.max_code,Fs=Se.stat_desc.static_tree,Gs=Se.stat_desc.has_stree,js=Se.stat_desc.extra_bits,ls=Se.stat_desc.extra_base,Xi=Se.stat_desc.max_length,po=0;for(jt=0;jt<=v;jt++)dt.bl_count[jt]=0;for(ze[2*dt.heap[dt.heap_max]+1]=0,Ji=dt.heap_max+1;Ji<d;Ji++)Xi<(jt=ze[2*ze[2*(Oe=dt.heap[Ji])+1]+1]+1)&&(jt=Xi,po++),ze[2*Oe+1]=jt,as<Oe||(dt.bl_count[jt]++,mo=0,ls<=Oe&&(mo=js[Oe-ls]),Mo=ze[2*Oe],dt.opt_len+=Mo*(jt+mo),Gs&&(dt.static_len+=Mo*(Fs[2*Oe+1]+mo)));if(po!==0){do{for(jt=Xi-1;dt.bl_count[jt]===0;)jt--;dt.bl_count[jt]--,dt.bl_count[jt+1]+=2,dt.bl_count[Xi]--,po-=2}while(0<po);for(jt=Xi;jt!==0;jt--)for(Oe=dt.bl_count[jt];Oe!==0;)as<(Wi=dt.heap[--Ji])||(ze[2*Wi+1]!==jt&&(dt.opt_len+=(jt-ze[2*Wi+1])*ze[2*Wi],ze[2*Wi+1]=jt),Oe--)}}(D,T),Yt(q,Ct,D.bl_count)}function m(D,T,J){var H,B,q=-1,tt=T[1],K=0,st=7,Ct=4;for(tt===0&&(st=138,Ct=3),T[2*(J+1)+1]=65535,H=0;H<=J;H++)B=tt,tt=T[2*(H+1)+1],++K<st&&B===tt||(K<Ct?D.bl_tree[2*B]+=K:B!==0?(B!==q&&D.bl_tree[2*B]++,D.bl_tree[2*x]++):K<=10?D.bl_tree[2*N]++:D.bl_tree[2*F]++,q=B,Ct=(K=0)===tt?(st=138,3):B===tt?(st=6,3):(st=7,4))}function G(D,T,J){var H,B,q=-1,tt=T[1],K=0,st=7,Ct=4;for(tt===0&&(st=138,Ct=3),H=0;H<=J;H++)if(B=tt,tt=T[2*(H+1)+1],!(++K<st&&B===tt)){if(K<Ct)for(;Z(D,B,D.bl_tree),--K!=0;);else B!==0?(B!==q&&(Z(D,B,D.bl_tree),K--),Z(D,x,D.bl_tree),Q(D,K-3,2)):K<=10?(Z(D,N,D.bl_tree),Q(D,K-3,3)):(Z(D,F,D.bl_tree),Q(D,K-11,7));q=B,Ct=(K=0)===tt?(st=138,3):B===tt?(st=6,3):(st=7,4)}}l(z);var I=!1;function w(D,T,J,H){Q(D,(f<<1)+(H?1:0),3),function(B,q,tt,K){vt(B),K&&(ot(B,tt),ot(B,~tt)),n.arraySet(B.pending_buf,B.window,q,tt,B.pending),B.pending+=tt}(D,T,J,!0)}s._tr_init=function(D){I||(function(){var T,J,H,B,q,tt=new Array(v+1);for(B=H=0;B<h-1;B++)for(j[B]=H,T=0;T<1<<$[B];T++)g[H++]=B;for(g[H-1]=B,B=q=0;B<16;B++)for(z[B]=q,T=0;T<1<<X[B];T++)P[q++]=B;for(q>>=7;B<u;B++)for(z[B]=q<<7,T=0;T<1<<X[B]-7;T++)P[256+q++]=B;for(J=0;J<=v;J++)tt[J]=0;for(T=0;T<=143;)it[2*T+1]=8,T++,tt[8]++;for(;T<=255;)it[2*T+1]=9,T++,tt[9]++;for(;T<=279;)it[2*T+1]=7,T++,tt[7]++;for(;T<=287;)it[2*T+1]=8,T++,tt[8]++;for(Yt(it,c+1,tt),T=0;T<u;T++)_[2*T+1]=5,_[2*T]=Tt(T,5);at=new rt(it,$,p+1,c,v),Y=new rt(_,X,0,u,v),ct=new rt(new Array(0),O,0,b,E)}(),I=!0),D.l_desc=new A(D.dyn_ltree,at),D.d_desc=new A(D.dyn_dtree,Y),D.bl_desc=new A(D.bl_tree,ct),D.bi_buf=0,D.bi_valid=0,ht(D)},s._tr_stored_block=w,s._tr_flush_block=function(D,T,J,H){var B,q,tt=0;0<D.level?(D.strm.data_type===2&&(D.strm.data_type=function(K){var st,Ct=4093624447;for(st=0;st<=31;st++,Ct>>>=1)if(1&Ct&&K.dyn_ltree[2*st]!==0)return r;if(K.dyn_ltree[18]!==0||K.dyn_ltree[20]!==0||K.dyn_ltree[26]!==0)return a;for(st=32;st<p;st++)if(K.dyn_ltree[2*st]!==0)return a;return r}(D)),pe(D,D.l_desc),pe(D,D.d_desc),tt=function(K){var st;for(m(K,K.dyn_ltree,K.l_desc.max_code),m(K,K.dyn_dtree,K.d_desc.max_code),pe(K,K.bl_desc),st=b-1;3<=st&&K.bl_tree[2*V[st]+1]===0;st--);return K.opt_len+=3*(st+1)+5+5+4,st}(D),B=D.opt_len+3+7>>>3,(q=D.static_len+3+7>>>3)<=B&&(B=q)):B=q=J+5,J+4<=B&&T!==-1?w(D,T,J,H):D.strategy===4||q===B?(Q(D,2+(H?1:0),3),De(D,it,_)):(Q(D,4+(H?1:0),3),function(K,st,Ct,dt){var Se;for(Q(K,st-257,5),Q(K,Ct-1,5),Q(K,dt-4,4),Se=0;Se<dt;Se++)Q(K,K.bl_tree[2*V[Se]+1],3);G(K,K.dyn_ltree,st-1),G(K,K.dyn_dtree,Ct-1)}(D,D.l_desc.max_code+1,D.d_desc.max_code+1,tt+1),De(D,D.dyn_ltree,D.dyn_dtree)),ht(D),H&&vt(D)},s._tr_tally=function(D,T,J){return D.pending_buf[D.d_buf+2*D.last_lit]=T>>>8&255,D.pending_buf[D.d_buf+2*D.last_lit+1]=255&T,D.pending_buf[D.l_buf+D.last_lit]=255&J,D.last_lit++,T===0?D.dyn_ltree[2*J]++:(D.matches++,T--,D.dyn_ltree[2*(g[J]+p+1)]++,D.dyn_dtree[2*k(T)]++),D.last_lit===D.lit_bufsize-1},s._tr_align=function(D){Q(D,2,3),Z(D,S,it),function(T){T.bi_valid===16?(ot(T,T.bi_buf),T.bi_buf=0,T.bi_valid=0):8<=T.bi_valid&&(T.pending_buf[T.pending++]=255&T.bi_buf,T.bi_buf>>=8,T.bi_valid-=8)}(D)}},{"../utils/common":41}],53:[function(e,o,s){o.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,o,s){(function(n){(function(r,a){if(!r.setImmediate){var l,f,h,p,c=1,u={},b=!1,d=r.document,v=Object.getPrototypeOf&&Object.getPrototypeOf(r);v=v&&v.setTimeout?v:r,l={}.toString.call(r.process)==="[object process]"?function(x){process.nextTick(function(){E(x)})}:function(){if(r.postMessage&&!r.importScripts){var x=!0,N=r.onmessage;return r.onmessage=function(){x=!1},r.postMessage("","*"),r.onmessage=N,x}}()?(p="setImmediate$"+Math.random()+"$",r.addEventListener?r.addEventListener("message",S,!1):r.attachEvent("onmessage",S),function(x){r.postMessage(p+x,"*")}):r.MessageChannel?((h=new MessageChannel).port1.onmessage=function(x){E(x.data)},function(x){h.port2.postMessage(x)}):d&&"onreadystatechange"in d.createElement("script")?(f=d.documentElement,function(x){var N=d.createElement("script");N.onreadystatechange=function(){E(x),N.onreadystatechange=null,f.removeChild(N),N=null},f.appendChild(N)}):function(x){setTimeout(E,0,x)},v.setImmediate=function(x){typeof x!="function"&&(x=new Function(""+x));for(var N=new Array(arguments.length-1),F=0;F<N.length;F++)N[F]=arguments[F+1];var $={callback:x,args:N};return u[c]=$,l(c),c++},v.clearImmediate=y}function y(x){delete u[x]}function E(x){if(b)setTimeout(E,0,x);else{var N=u[x];if(N){b=!0;try{(function(F){var $=F.callback,X=F.args;switch(X.length){case 0:$();break;case 1:$(X[0]);break;case 2:$(X[0],X[1]);break;case 3:$(X[0],X[1],X[2]);break;default:$.apply(a,X)}})(N)}finally{y(x),b=!1}}}}function S(x){x.source===r&&typeof x.data=="string"&&x.data.indexOf(p)===0&&E(+x.data.slice(p.length))}})(typeof self>"u"?n===void 0?this:n:self)}).call(this,typeof tn<"u"?tn:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Qh);var jb=Qh.exports;const Jb=Gb(jb);async function Wb(i){return Jb.loadAsync(i)}function li(){return["main"]}async function Xb(i){if(i.file)return i.file;if(i.link)return Mb(Vu(decodeURI(i.link)));if(i.id)return Zh(zu(decodeURI(i.id)));if(i.hash&&Dr(decodeURI(i.hash).trim()))return Fb(decodeURI(i.hash).trim());throw new Error("Could not search for file.")}const Fi=async i=>{try{let t=function(){It.status("info",`Loading ${[...l].join(", ")}... [${n}/${r-2}]`,zr(n/r,15,80))};console.time("loading time"),Ys.enable(!1);let e=await Xb(i);It.status("info","Extracting zip",0),fe.switchHeader(!1);const o=await Wb(e);Ys.enable(!1),It.status("info","Parsing map info...",10),W.tInfo(li(),"Parsing map info");const s=await Ab(o);lt.beatmapInfo=s,jf(s),s.audio.duration&&(lt.duration=s.audio.duration,fe.setSongDuration(s.audio.duration));let n=0,r=0,a=0;const l=new Set(["map","cover image","contributors image","audio","audio/BPM data"]),f=[new Promise(async b=>{W.tInfo(li(),"Loading cover image");const d=o.file(s.coverImageFilename);if(et.load.imageCover&&d){let v=await d.async("base64");fe.setCoverImage("data:image;base64,"+v),co.loading.coverImage=!0}else W.tError(li(),`${s.coverImageFilename} does not exists.`);n++,l.delete("cover image"),t(),b(null)}),new Promise(async b=>{if(lt.contributors=[],s.customData._contributors)for(const d of s.customData._contributors){W.tInfo(li(),"Loading contributor image "+d._name);const v=o.file(d._iconPath);let y=null;et.load.imageContributor&&v?y=await v.async("base64"):W.tError(li(),`${d._iconPath} does not exists.`),lt.contributors.push({...d,_base64:y})}ac(lt.contributors),n++,l.delete("contributors image"),t(),b(null)}),new Promise(async b=>{W.tInfo(li(),"Loading audio");let d=o.file(s.audio.filename);if(et.load.audio&&d){let v=!1;setTimeout(()=>{!v&&!co.loading.finished&&It.status("info","Loading audio... (this may take a while)",zr(n/r,15,80))},1e4);let y=await d.async("arraybuffer");fe.setAudio(y),await new AudioContext().decodeAudioData(y).then(S=>{v=!0;let x=S.duration;lt.duration=x,fe.setSongDuration(x),co.loading.audio=!0}).catch(function(S){fe.setSongDuration(),W.tError(li(),S)})}else lt.duration||fe.setSongDuration(),W.tError(li(),`${s.audio.filename} does not exist.`);n+=3,l.delete("Audio"),t(),b(null)}),new Promise(async b=>{const d=await Ob(s,o);n++,l.delete("audio/BPM data"),d&&(co.loading.audio||(lt.duration=d.duration),fe.setSongDuration(d.duration),t()),b(d)}),...Ib(s,o).map(async(b,d,v)=>{const y=await b;return n++,a++,y===null?null:(v.length===a&&l.delete("map"),t(),y)})];r=f.length+2,t();const h=await Promise.allSettled(f);lt.beatmapDifficulty=h.slice(4).map(b=>b.status==="fulfilled"?b.value:null).filter(b=>b);const p=h[3].status==="fulfilled"?h[3].value:null;let c=Math.min(s.audio.bpm,...((p==null?void 0:p.bpm)??[]).map(b=>b.bpm)),u=Math.max(s.audio.bpm,...((p==null?void 0:p.bpm)??[]).map(b=>b.bpm));lt.beatmapDifficulty.forEach(b=>{b.rawVersion===4&&(b.bpm.timescale=p.bpm);const d=b.bpm.change.map(y=>y.BPM),v=b.bpm.timescale.map(y=>b.bpm.value/y.scale);c=Math.min(c,...d,...v),u=Math.max(u,...d,...v)}),c!==u&&fe.setSongBPM(s.audio.bpm,c,u),Zo.adjustBeatTime(),Zo.populateSelect(s),W.tInfo(li(),"Analysing map"),It.status("info","Analysing general...",85),Po.runGeneral(),Zo.displayOutputGeneral(),await new Promise(b=>setTimeout(b,5)),It.status("info","Analysing difficulty...",90),Po.applyAll(),Zo.displayOutputDifficulty(),await new Promise(b=>setTimeout(b,5)),It.status("info","Populating stats...",95),W.tInfo(li(),"Populating stats"),mb(),await new Promise(b=>setTimeout(b,5)),Ys.enable(!0),It.status("info","Successfully loaded!")}catch(t){It.status("error",t),W.tError(li(),t),lt.clear(),Ys.enable(!0),fe.switchHeader(!0)}finally{console.timeEnd("loading time")}},an=document.querySelector(".input__intro-url"),ln=document.querySelector(".input__intro-id"),un=document.querySelector(".input__intro-hash"),Hb=document.querySelector(".input__search-button"),Yb=document.querySelector(".input__file"),tf=document.querySelector(".input__file-zone");an.addEventListener("keydown",Fr);ln.addEventListener("keydown",Fr);un.addEventListener("keydown",Fr);Hb.addEventListener("click",Vb);Yb.addEventListener("change",zb);tf.addEventListener("drop",Ub);tf.addEventListener("dragover",qb);function Fr(i){const t=i.target;i.key==="Enter"&&t.value!==""&&(t.classList.contains("input__intro-url")&&Fi({link:t.value}),t.classList.contains("input__intro-id")&&Fi({id:t.value}),t.classList.contains("input__intro-hash")&&Fi({hash:t.value}))}function Vb(i){if(an&&an.value!==""){Fi({link:an.value});return}if(ln&&ln.value!==""){Fi({id:ln.value});return}if(un&&un.value!==""){Fi({hash:un.value});return}}function zb(i){const t=i.target;It.status("info","Reading file input",0);const e=t.files?t.files[0]:null;try{if(e==null)throw It.status("info","No file input",0),new Error("No file input");if(e&&(e.name.substr(-4)===".zip"||e.name.substr(-4)===".bsl")){const o=new FileReader;o.readAsArrayBuffer(e),o.addEventListener("load",()=>{Fi({file:e})})}else throw new Error("Unsupported file format, please enter zip file")}catch(o){It.status("error",o,0),console.error(o)}}function Ub(i){i.preventDefault(),i.stopPropagation();try{if(i.dataTransfer==null)throw new Error("No file input");if(i.dataTransfer.items&&i.dataTransfer.items[0].kind==="file"){let t=i.dataTransfer.items[0].getAsFile();if(t&&(t.name.substr(-4)===".zip"||t.name.substr(-4)===".bsl")){const e=new FileReader;e.readAsArrayBuffer(t),e.addEventListener("load",()=>{Fi({file:t})})}else throw new Error("Unsupported file format, please enter zip file")}}catch(t){It.status("error",t,0),console.error(t)}}function qb(i){i.preventDefault(),i.stopPropagation()}const Kb=document.querySelector("body"),Zb=["Dark","Light","Monochrome"],Gr={list:Zb,set:i=>{Kb.className="theme-"+i.toLowerCase().replace(" ","")}},jr=document.querySelector(".settings__theme"),ef=document.querySelector(".settings__beat-numbering"),of=document.querySelector(".settings__rounding"),sf=document.querySelector(".settings__info-height"),nf=document.querySelector(".settings__data-check"),rf=document.querySelector(".settings__data-error"),af=document.querySelectorAll(".settings__load"),_r=document.querySelector(".settings__sort"),lf=document.querySelectorAll(".settings__show"),uf=document.querySelectorAll(".settings__onload"),Qb=document.querySelector(".settings__clear-button");jr.addEventListener("change",tg);Gr.list.forEach(i=>{const t=document.createElement("option");t.value=i,t.textContent=i,jr.add(t)});ef.addEventListener("change",eg);of.addEventListener("change",ig);sf.addEventListener("change",og);nf.addEventListener("change",sg);rf.addEventListener("change",ng);af.forEach(i=>i.addEventListener("change",cg));_r.addEventListener("change",lg);uf.forEach(i=>i.addEventListener("change",fg));lf.forEach(i=>i.addEventListener("change",rg));Qb.addEventListener("click",cf);function tg(i){const t=i.target;et.theme=t.options[t.options.selectedIndex].value,Gr.set(et.theme),et.save()}function eg(i){const t=i.target;et.beatNumbering=t.options[t.options.selectedIndex].value,et.save()}function ig(i){const t=i.target;et.rounding=parseInt(t.value),et.save()}function og(i){const t=i.target;et.infoRowHeight=parseInt(t.value),cc(et.infoRowHeight),et.save()}function sg(i){const t=i.target;et.dataCheck=t.checked,et.save()}function ng(i){const t=i.target;et.dataError=t.checked,et.save()}function rg(i){const t=i.target,e=t.id.replace("settings__show-","");et.show[e]=t.checked,et.save()}function ag(i,t){lf.forEach(e=>{e.id.endsWith(i)&&(e.checked=t)})}function lg(i){const t=i.target;et.sorting=t.checked,et.save()}function ug(i){_r&&(_r.checked=i)}function cg(i){const t=i.target,e=t.name;et.load[e]=t.checked,et.save()}function hg(i,t){af.forEach(e=>{e.name===i&&(e.checked=t)})}function fg(i){const t=i.target,e=t.name;et.onLoad[e]=t.checked,et.save()}function mg(i,t){uf.forEach(e=>{e.name===i&&(e.checked=t)})}function pg(i){jr.value=i}function dg(i){ef.value=i}function bg(i){of.value=i.toString()}function gg(i){sf.value=i.toString(),cc(et.infoRowHeight)}function vg(i){nf.checked=i}function yg(i){rf.checked=i}function cf(){et.clear(),et.reset(),location.reload()}const Ni={setShowCheck:ag,setSortCheck:ug,setLoadCheck:hg,setOnLoadCheck:mg,setTheme:pg,setBeatNumbering:dg,setRounding:bg,setInfoHeight:gg,setDataCheck:vg,setDataError:yg,clear:cf},_g=document.querySelectorAll(".input__reset-button");_g.forEach(i=>i.addEventListener("click",Dg));function Dg(){It.reset(),fe.reset(),Jf(),Zo.reset(),pb(),lt.clear()}const Eg="2.6.2",wg="Kival Evan#5480",Ju=new class{constructor(){this._version=Eg,this._wm=wg}get value(){return this._version}get watermark(){return this._wm}},Sg=document.querySelectorAll(".link__watermark"),Cg=document.querySelectorAll(".link__version");function Wu(){const i=new Date;return i.getMonth()==5&&i.getDate()==10}const Xu={setWatermark:i=>{Sg.forEach(t=>{t.textContent=(Wu()?"Happy Birthday, ":"")+i,Wu()&&(t.title=`Happy ${new Date().getFullYear()-new Date("1999-06-10").getFullYear()} Birthday, 10th June`)})},setVersion:i=>{Cg.forEach(t=>t.textContent=i)}},xg=function(){let i=!1;return function(){if(!i){i=!0,Xu.setWatermark(Ju.watermark),Xu.setVersion(Ju.value),Zo.populateTool(),Ni.setTheme(et.theme),Ni.setBeatNumbering(et.beatNumbering),Ni.setRounding(et.rounding),Ni.setInfoHeight(et.infoRowHeight),Ni.setDataCheck(et.dataCheck),Ni.setDataError(et.dataError);for(const t in et.load)Ni.setLoadCheck(t,et.load[t]);Ni.setSortCheck(et.sorting);for(const t in et.show)Yu.show(t,et.show[t]),Ni.setShowCheck(t,et.show[t]);for(const t in et.onLoad)Ni.setOnLoadCheck(t,et.onLoad[t]);Gr.set(et.theme),W.tInfo(["init"],"User interface initialised")}}}();(function(){xg();const i=new URL(location.href),t=i.searchParams.get("url"),e=i.searchParams.get("id"),o=i.searchParams.get("hash");(e||t||o)&&Fi({link:t,id:e,hash:o})})();
