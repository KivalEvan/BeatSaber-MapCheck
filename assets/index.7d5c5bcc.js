var fl=Object.defineProperty,ml=Object.defineProperties;var pl=Object.getOwnPropertyDescriptors;var to=Object.getOwnPropertySymbols;var gl=Object.prototype.hasOwnProperty,bl=Object.prototype.propertyIsEnumerable;var eo=(t,e,n)=>e in t?fl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,qn=(t,e)=>{for(var n in e||(e={}))gl.call(e,n)&&eo(t,n,e[n]);if(to)for(var n of to(e))bl.call(e,n)&&eo(t,n,e[n]);return t},Vn=(t,e)=>ml(t,pl(e));const _l=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerpolicy&&(r.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?r.credentials="include":a.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(a){if(a.ep)return;a.ep=!0;const r=n(a);fetch(a.href,r)}};_l();var zo=(t=>(t.none="",t.ExpertPlus="accordion__label--bg-expertplus",t.Expert="accordion__label--bg-expert",t.Hard="accordion__label--bg-hard",t.Normal="accordion__label--bg-normal",t.Easy="accordion__label--bg-easy",t))(zo||{});const yl="UI Accordion: ",Gn="accordion__",Ho=document.querySelectorAll(".accordion__button");Ho.length||console.error(yl+"empty accordion list, intentional or typo error?");var Xo={create:(t,e,n,i=!1)=>{const a=document.createElement("div");a.className="accordion";const r=document.createElement("input");r.className=Gn+"button",r.id=t,r.setAttribute("type","checkbox");const l=document.createElement("label");l.className=Gn+"label unselectable",l.htmlFor=t,l.textContent=e,n&&l.classList.add(zo[n]);const s=document.createElement("div");return s.className=i?Gn+"collapsible-flex":Gn+"collapsible",s.id=t+"-content",a.appendChild(r),a.appendChild(l),a.appendChild(s),a},show:(t,e)=>{Ho.forEach(n=>{n.id.endsWith(t)&&(n.checked=e)})}},Uo=(t=>(t[t.VERBOSE=0]="VERBOSE",t[t.DEBUG=1]="DEBUG",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.NONE=5]="NONE",t))(Uo||{});const no=new Map([[0,"VERBOSE"],[1,"DEBUG"],[2,"INFO"],[3,"WARN"],[4,"!!ERROR!!"],[5,"NONE"]]);var nt=new class{constructor(){this.logLevel=2,this.logLevels=Uo}log(e,...n){if(e<this.logLevel)return;const i=[no.get(e),">",...n];switch(e){case 1:return console.debug(...i);case 2:return console.info(...i);case 3:return console.warn(...i);case 4:return console.error(...i);default:return console.log(...i)}}setLevel(e){e=Math.min(e,5),this.logLevel=e,this.info("[logger::setLevel]",`Log level set to ${no.get(e)}`)}verbose(...e){this.log(0,...e)}debug(...e){this.log(1,...e)}info(...e){this.log(2,...e)}warn(...e){this.log(3,...e)}error(...e){this.log(4,...e)}};const vl=t=>t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),M=(t,e=0)=>Math.round(t*Math.pow(10,e))/Math.pow(10,e),or=t=>t*(180/Math.PI),hn=t=>t*(Math.PI/180),io=(t,e)=>{e<0&&(e=-e);const n=t%e;return n<0?n+e:n},ro=(t,e,n)=>Math.min(io(t-e,n),io(e-t,n)),Hi=t=>{if(t.length===0)return 0;t.sort((n,i)=>n-i);const e=Math.floor(t.length/2);return t.length%2?t[e]:(t[e-1]+t[e])/2},wl=(t,e,n)=>Math.min(Math.max(e,t),n),li=t=>[t.r,t.g,t.b],Zn=t=>{const e=t.toString(16);return e.length===1?"0"+e:e},El=t=>t>1&&!(t<0)?255:M(t*255),xt=t=>{if(!t)return null;const e={r:0,g:0,b:0};for(const n in t){const i=t[n];i!==void 0&&(e[n]=El(i))}return`#${Zn(e.r)}${Zn(e.g)}${Zn(e.b)}${e.a?Zn(e.a):""}`},ao=t=>{let e=t[0],n=t[1],i=t[2],a,r,l;return e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92,i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92,a=(e*.4124+n*.3576+i*.1805)/.95047,r=(e*.2126+n*.7152+i*.0722)/1,l=(e*.0193+n*.1192+i*.9505)/1.08883,a=a>.008856?Math.pow(a,1/3):7.787*a+16/116,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,l=l>.008856?Math.pow(l,1/3):7.787*l+16/116,[116*r-16,500*(a-r),200*(r-l)]},oo=(t,e)=>{let n=0;return t>=0&&e===0?0:t<0&&e===0?180:t===0&&e>0?90:t===0&&e<0?270:(t>0&&e>0&&(n=0),t<0&&(n=180),t>0&&e<0&&(n=360),or(Math.atan(e/t))+n)},sr=(t,e)=>{const[n,i,a]=ao(t),[r,l,s]=ao(e),o=1,f=1,h=1;let m,p,c,_,v,g,b,y,x,T,D,j,N,Y,B,U,K,k,A,u;return m=Math.sqrt(i*i+a*a),p=Math.sqrt(l*l+s*s),c=(m+p)/2,v=.5*(1-Math.sqrt((c^7)/((c^7)+30))),x=(1+v)*i,m=Math.sqrt(x*x+a*a),g=oo(x,a),x=(1+v)*l,p=Math.sqrt(x*x+s*s),b=oo(x,s),k=r-n,A=p-m,m*p==0?u=0:(x=M(b-g,12),Math.abs(x)<=180?u=b-g:x>180?u=b-g-360:u=b-g+360),u=2*Math.sqrt(m*p)*Math.sin(hn(u/2)),T=(n+r)/2,_=(m+p)/2,m*p==0?y=g+b:(x=Math.abs(M(g-b,12)),x>180?b+g<360?y=g+b+360:y=g+b-360:y=g+b,y/=2),D=1-.17*Math.cos(hn(y-30))+.24*Math.cos(hn(2*y))+.32*Math.cos(hn(3*y+6))-.2*Math.cos(hn(4*y-63)),B=30*Math.exp(-((y-275)/25)*((y-275)/25)),U=2*Math.sqrt((_^7)/((_^7)+30)),j=1+.015*((T-50)*(T-50))/Math.sqrt(20+(T-50)*(T-50)),N=1+.045*_,Y=1+.015*_*D,K=-Math.sin(hn(2*B))*U,k=k/(o*j),A=A/(f*N),u=u/(h*Y),Math.sqrt(k*k+A*A+u*u+K*A*u)},xl=t=>`[utils::misc::${t.name}]`,Yo=t=>/[a-fA-F0-9]*/g.test(t),yt=t=>(typeof t!="object"&&nt.error(xl(yt),"Received non-object type"),JSON.parse(JSON.stringify(t))),Wt=t=>{if(!t)return"0:00";const e=Math.floor(t),n=e/60,i=n<0?`-${Math.ceil(n).toString()}`:Math.floor(n).toString(),a=Math.abs(e%60).toString().padStart(2,"0");return`${i}:${a}`},kl=t=>{if(!t)return"0:00:00";const e=Math.round(t*60%60).toString().padStart(2,"0");return`${Wt(t)}:${e}`},Dl=t=>{var n;if(!t)return"0:00.000";const e=((n=(t%1).toString().split(".")[1])==null?void 0:n.padEnd(3,"0").slice(0,3))||"000";return`${Wt(t)}.${e}`},Wo=t=>{const e=/^(http|ftp|https):\/\/([\w_-]+(?:(?:\.[\w_-]+)+))([\w.,@?^=%&:/~+#-]*[\w@?^=%&/~+#-])?/;if(t=t.trim(),/^http:\/\//.test(t)&&(t=t.replace("http://","https://")),e.test(t))return t;throw new Error("Invalid URL")},qo=t=>{const e=/^[0-9a-fA-F]{1,6}$/;if(t=t.trim(),/^!bsr /.test(t)&&(t=t.replace("!bsr ","")),e.test(t))return t;throw new Error("Invalid ID")},lr=t=>{for(let e=t.options.length-1;e>=0;e--)t.remove(e)},Vr="UI Header: ",cr=document.querySelector(".intro"),ur=document.querySelector(".metadata"),Ge=document.querySelector(".cover__link"),Gr=document.querySelector(".cover__image"),Vo=document.querySelector(".metadata__song-name"),Go=document.querySelector(".metadata__song-subname"),Zo=document.querySelector(".metadata__song-author"),Jo=document.querySelector(".metadata__song-bpm"),hr=document.querySelector(".metadata__song-duration"),Ko=document.querySelector(".audio"),Cl="";if(!cr||!ur)throw new Error(Vr+"header component is missing one of the two section");if(!Ge||!Gr)throw new Error(Vr+"cover component is missing");if(!Vo||!Go||!Zo||!Jo||!hr)throw new Error(Vr+"metadata component is missing one of the part");const Qo=t=>{t?(cr.classList.remove("hidden"),ur.classList.add("hidden")):(cr.classList.add("hidden"),ur.classList.remove("hidden"))},ts=t=>{Gr.src=t||"./img/unknown.jpg"},Sl=()=>Gr.src,es=(t,e)=>{if(t==null&&e==null){Ge.textContent="",Ge.href="",Ge.classList.add("disabled");return}t!=null&&(Ge.textContent=e!=null?e:"Download Link",Ge.href=t,Ge.classList.remove("disabled"))},Ll=t=>{Vo.textContent=t},Tl=t=>{Go.textContent=t},$l=t=>{Zo.textContent=t},Ml=(t,e,n)=>{let i=M(t,2).toString()+"BPM";Jo.textContent=i},ns=t=>{t?hr.textContent=Dl(t):hr.textContent="No audio"},Rl=async t=>{const e=new Blob([t],{type:"audio/ogg"});Ko.src=window.URL.createObjectURL(e)},is=()=>{Ko.src="",window.URL.revokeObjectURL(Cl)},Bl=()=>{Qo(!1),ts(null),es(),ns(0),is()};var Mt={switchHeader:Qo,setCoverImage:ts,getCoverImage:Sl,setCoverLink:es,setSongName:Ll,setSongSubname:Tl,setSongAuthor:$l,setSongBPM:Ml,setSongDuration:ns,setAudio:Rl,unloadAudio:is,reset:Bl},rs=(t=>(t.tiny="panel--tiny",t.small="panel--small",t.medium="panel--medium",t.large="panel--large",t.max="panel--max",t))(rs||{}),as=(t=>(t.normal="panel--offset",t.half="panel--offset-half",t.none="",t))(as||{}),ti={create:(t,e,n,i)=>{const a=document.createElement("div");return a.className=`panel ${rs[t]}`,e&&e!=="none"&&a.classList.add(as[e]),n&&a.classList.add("panel--flex"+i?"-column":""),a}},bn=new class{constructor(){this.loading={info:!1,difficulty:!1,analysis:!1,audio:!1,coverImage:!1,contributorImage:!1,finished:!1}}resetLoad(){this.loading.info=!1,this.loading.difficulty=!1,this.loading.analysis=!1,this.loading.audio=!1,this.loading.coverImage=!1,this.loading.contributorImage=!1,this.loading.finished=!1}},rt=new class{constructor(){this.beatmapInfo=null,this.beatmapDifficulty=[],this.contributors=[],this.analysis=null,this.duration=null}retrieveSafe(){if(!this.beatmapInfo)throw new Error("Beatmap info is not loaded.");if(!this.analysis)throw new Error("Beatmap analysis is not loaded.");if(this.duration===null)throw new Error("Audio is not loaded.");if(bn.loading.finished)return{beatmapInfo:this.beatmapInfo,beatmapDifficulty:this.beatmapDifficulty,contributors:this.contributors,analysis:this.analysis,duration:this.duration};throw new Error("Could not retrieve saved data, loading process is not finished.")}clear(){bn.loading.finished=!1,this.beatmapInfo=null,this.beatmapDifficulty=[],this.contributors=[],this.analysis=null,this.duration=null}};const os=class{constructor(t,e=[],n=0){this._bpm=t,this._offset=n/1e3,this._bpmChange=this.getBPMChangeTime([...e])}get value(){return this._bpm}set value(t){this._bpm=t}get change(){return this._bpmChange}set change(t){this._bpmChange=this.getBPMChangeTime([...t])}get offset(){return this._offset*1e3}set offset(t){this._offset=t/1e3}getBPMChangeTime(t=[]){var i;let e;const n=[];for(let a=0;a<t.length;a++){const r={_BPM:(i=t[a]._BPM)!=null?i:t[a]._bpm,_time:t[a]._time,_beatsPerBar:t[a]._beatsPerBar,_metronomeOffset:t[a]._metronomeOffset,_newTime:0};e?r._newTime=Math.ceil((r._time-e._time)/this._bpm*e._BPM+e._newTime-.01):r._newTime=Math.ceil(r._time-this._offset*this._bpm/60-.01),n.push(r),e=r}return n}offsetBegone(t){return(this.toRealTime(t)-this._offset)*this._bpm/60}toRealTime(t){return t/this._bpm*60}toBeatTime(t){return t*this._bpm/60}toJSONTime(t){for(let e=this._bpmChange.length-1;e>=0;e--)if(t>this._bpmChange[e]._newTime)return(t-this._bpmChange[e]._newTime)/this._bpmChange[e]._BPM*this._bpm+this._bpmChange[e]._time;return(this.toRealTime(t)+this._offset)*this._bpm/60}adjustTime(t){for(let e=this._bpmChange.length-1;e>=0;e--)if(t>this._bpmChange[e]._time)return(t-this._bpmChange[e]._time)/this._bpm*this._bpmChange[e]._BPM+this._bpmChange[e]._newTime;return this.offsetBegone(t)}};let oe=os;oe.create=(t,e,n)=>new os(t,e,n);var Zr=(t=>(t.Standard="Standard",t.NoArrows="No Arrows",t.OneSaber="One Saber",t["360Degree"]="360 Degree",t["90Degree"]="90 Degree",t.Lightshow="Lightshow",t.Lawless="Lawless",t))(Zr||{}),dr=(t=>(t[t.Standard=0]="Standard",t[t.NoArrows=1]="NoArrows",t[t.OneSaber=2]="OneSaber",t[t["360Degree"]=3]="360Degree",t[t["90Degree"]=4]="90Degree",t[t.Lightshow=5]="Lightshow",t[t.Lawless=6]="Lawless",t))(dr||{});const Ot={DefaultEnvironment:"The First",OriginsEnvironment:"Origins",TriangleEnvironment:"The First",NiceEnvironment:"The First",BigMirrorEnvironment:"The First",DragonsEnvironment:"The First",KDAEnvironment:"KDA",MonstercatEnvironment:"The First",CrabRaveEnvironment:"Crab Rave",PanicEnvironment:"The First",RocketEnvironment:"Rocket",GreenDayEnvironment:"Green Day",GreenDayGrenadeEnvironment:"Green Day",TimbalandEnvironment:"Timbaland",FitBeatEnvironment:"FitBeat",LinkinParkEnvironment:"Linkin Park",BTSEnvironment:"BTS",KaleidoscopeEnvironment:"Kaleidoscope",InterscopeEnvironment:"Interscope",SkrillexEnvironment:"Skrillex",BillieEnvironment:"Billie Eilish",HalloweenEnvironment:"Spooky",GagaEnvironment:"Gaga",WeaveEnvironment:"Weave",PyroEnvironment:"Pyro",EDMEnvironment:"EDM",GlassDesertEnvironment:"Glass Desert"},Il={_colorLeft:"Left Note Color",_colorRight:"Right Note Color",_envColorLeft:"Left Environment Color",_envColorRight:"Right Environment Color",_envColorWhite:"White Environment Color",_envColorLeftBoost:"Left Environment Boost Color",_envColorRightBoost:"Right Environment Boost Color",_envColorWhiteBoost:"White Environment Boost Color",_obstacleColor:"Obstacle Color"},jt={"Default Custom":{_colorLeft:{r:.7529412,g:.1882353,b:.1882353},_colorRight:{r:.1254902,g:.3921569,b:.6588235},_envColorLeft:{r:.7529412,g:.1882353,b:.1882353},_envColorRight:{r:.1882353,g:.5960785,b:1},_obstacleColor:{r:1,g:.1882353,b:.1882353}},"The First":{_colorLeft:{r:.7843137,g:.07843138,b:.07843138},_colorRight:{r:.1568627,g:.5568627,b:.8235294},_envColorLeft:{r:.85,g:.08499997,b:.08499997},_envColorRight:{r:.1882353,g:.675294,b:1},_obstacleColor:{r:1,g:.1882353,b:.1882353}},Origins:{_colorLeft:{r:.6792453,g:.5712628,b:0},_colorRight:{r:.7075472,g:0,b:.5364411},_envColorLeft:{r:.4910995,g:.6862745,b:.7},_envColorRight:{r:.03844783,g:.6862745,b:.9056604},_obstacleColor:{r:.06167676,g:.2869513,b:.3962264}},KDA:{_colorLeft:{r:.6588235,g:.2627451,b:.1607843},_colorRight:{r:.5019608,g:.08235294,b:.572549},_envColorLeft:{r:1,g:.3960785,b:.2431373},_envColorRight:{r:.7607844,g:.1254902,b:.8666667},_obstacleColor:{r:1,g:.3960785,b:.2431373}},"Crab Rave":{_colorLeft:{r:0,g:.7130001,b:.07806564},_colorRight:{r:.04805952,g:.5068096,b:.734},_envColorLeft:{r:.134568,g:.756,b:.1557533},_envColorRight:{r:.05647058,g:.6211764,b:.9},_obstacleColor:{r:0,g:.8117648,b:.09019608}},Noir:{_colorLeft:{r:.1792453,g:.1792453,b:.1792453},_colorRight:{r:.5943396,g:.5943396,b:.5943396},_envColorLeft:{r:.4056604,g:.4056604,b:.4056604},_envColorRight:{r:.6037736,g:.6037736,b:.6037736},_obstacleColor:{r:.2358491,g:.2358491,b:.2358491}},Rocket:{_colorLeft:{r:1,g:.4980392,b:0},_colorRight:{r:0,g:.5294118,b:1},_envColorLeft:{r:.9,g:.4866279,b:.3244186},_envColorRight:{r:.4,g:.7180724,b:1},_obstacleColor:{r:.3176471,g:.6117647,b:.7254902}},"Green Day":{_colorLeft:{r:.2588235,g:.7843138,b:.01960784},_colorRight:{r:0,g:.7137255,b:.6705883},_envColorLeft:{r:0,g:.7137255,b:.6705883},_envColorRight:{r:.2588235,g:.7843137,b:.01960784},_obstacleColor:{r:0,g:.8117648,b:.09019608}},Timbaland:{_colorLeft:{r:.5019608,g:.5019608,b:.5019608},_colorRight:{r:.1,g:.5517647,b:1},_envColorLeft:{r:.1,g:.5517647,b:1},_envColorRight:{r:.1,g:.5517647,b:1},_obstacleColor:{r:.5,g:.5,b:.5}},FitBeat:{_colorLeft:{r:.8000001,g:.6078432,b:.1568628},_colorRight:{r:.7921569,g:.1607843,b:.682353},_envColorLeft:{r:.8,g:.5594772,b:.5594772},_envColorRight:{r:.5594772,g:.5594772,b:.8},_obstacleColor:{r:.2784314,g:.2784314,b:.4}},"Linkin Park":{_colorLeft:{r:.6627451,g:.1643608,b:.1690187},_colorRight:{r:.3870196,g:.5168997,b:.5568628},_envColorLeft:{r:.7529412,g:.672753,b:.5925647},_envColorRight:{r:.6241197,g:.6890281,b:.709},_envColorLeftBoost:{r:.922,g:.5957885,b:.255394},_envColorRightBoost:{r:.282353,g:.4586275,b:.6235294},_obstacleColor:{r:.6627451,g:.1647059,b:.172549}},BTS:{_colorLeft:{r:1,g:.09019607,b:.4059771},_colorRight:{r:.8018868,g:0,b:.7517689},_envColorLeft:{r:.7843137,g:.1254902,b:.5010797},_envColorRight:{r:.6941177,g:.1254902,b:.8666667},_envColorLeftBoost:{r:.9019608,g:.5411765,b:1},_envColorRightBoost:{r:.3490196,g:.8078431,b:1},_obstacleColor:{r:.6698113,g:.1800908,b:.5528399}},Kaleidoscope:{_colorLeft:{r:.65882355,g:.1254902,b:.1254902},_colorRight:{r:.28235295,g:.28235295,b:.28235295},_envColorLeft:{r:.65882355,g:.1254902,b:.1254902},_envColorRight:{r:.47058824,g:.47058824,b:.47058824},_envColorLeftBoost:{r:.50196081,g:0,b:0},_envColorRightBoost:{r:.49244517,g:0,b:.53725493},_obstacleColor:{r:.25098041,g:.25098041,b:.25098041}},Interscope:{_colorLeft:{r:.726415,g:.62691,b:.31181},_colorRight:{r:.589571,g:.297888,b:.723},_envColorLeft:{r:.724254,g:.319804,b:.913725},_envColorRight:{r:.764706,g:.758971,b:.913725},_envColorLeftBoost:{r:.792453,g:.429686,b:.429868},_envColorRightBoost:{r:.7038,g:.715745,b:.765},_obstacleColor:{r:.588235,g:.298039,b:.721569}},Skrillex:{_colorLeft:{r:.69803923,g:.14117648,b:.36862746},_colorRight:{r:.32933334,g:.32299998,b:.38},_envColorLeft:{r:.80000001,g:.28000003,b:.58594489},_envColorRight:{r:.06525807,g:.57800001,b:.56867743},_envColorLeftBoost:{r:.81176478,g:.30588236,b:.30588236},_envColorRightBoost:{r:.27843139,g:.80000001,b:.44597632},_obstacleColor:{r:.15686275,g:.60392159,b:.60392159}},"Billie Eilish":{_colorLeft:{r:.80000001,g:.64481932,b:.43200001},_colorRight:{r:.54808509,g:.61276591,b:.63999999},_envColorLeft:{r:.81960785,g:.442,b:.184},_envColorRight:{r:.94117647,g:.70677096,b:.56470591},_obstacleColor:{r:.71325314,g:.56140977,b:.78301889},_envColorLeftBoost:{r:.80000001,g:0,b:0},_envColorRightBoost:{r:.55686277,g:.7019608,b:.77647066}},Spooky:{_colorLeft:{r:.81960785,g:.49807876,b:.27702752},_colorRight:{r:.37894738,g:.35789475,b:.40000001},_envColorLeft:{r:.90196079,g:.23009226,b:0},_envColorRight:{r:.46005884,g:.56889427,b:.92941177},_obstacleColor:{r:.81960791,g:.44313729,b:.18431373},_envColorLeftBoost:{r:.33768433,g:.63207543,b:.33690813},_envColorRightBoost:{r:.60209066,g:.3280082,b:.85849059}},Gaga:{_colorLeft:{r:.85,g:.4333333,b:.7833334},_colorRight:{r:.4705882,g:.8,b:.4078431},_envColorLeft:{r:.706,g:.649,b:.2394706},_envColorRight:{r:.894,g:.1625455,b:.7485644},_obstacleColor:{r:.9921569,g:0,b:.7719755},_envColorLeftBoost:{r:.754717,g:.3610244,b:.22071921},_envColorRightBoost:{r:0,g:.7058824,b:1}},Weave:{_colorLeft:{r:.7843137,g:.07843138,b:.07843138},_colorRight:{r:.1568627,g:.5568627,b:.8235294},_envColorLeft:{r:.85,g:.08499997,b:.08499997},_envColorRight:{r:.1882353,g:.675294,b:1},_envColorLeftBoost:{r:.8218409,g:.08627451,b:.8509804},_envColorRightBoost:{r:.5320754,g:.5320754,b:.5320754},_obstacleColor:{r:1,g:.1882353,b:.1882353}},Pyro:{_colorLeft:{r:.5764706,g:0,b:.03921569},_colorRight:{r:1,g:.6705883,b:0},_envColorLeft:{r:1,g:.1098039,b:.2039216},_envColorRight:{r:.8862745,g:.7372549,b:.2627451},_envColorLeftBoost:{r:1,g:0,b:.1764706},_envColorRightBoost:{r:.7647059,g:.7647059,b:.7647059},_obstacleColor:{r:.8490566,g:.7037643,b:.4285333}},EDM:{_colorLeft:{r:.6320754,g:.6320754,b:.6320754},_colorRight:{r:.1764706,g:.6980392,b:.8784314},_envColorLeft:{r:.08220173,g:.7169812,b:0},_envColorRight:{r:0,g:.3671638,b:.7169812},_envColorLeftBoost:{r:.735849,g:0,b:.1758632},_envColorRightBoost:{r:.4284593,g:0,b:.754717},_obstacleColor:{r:.1764706,g:.6980392,b:.8784314}},"Glass Desert":{_colorLeft:{r:.6792453,g:.5712628,b:0},_colorRight:{r:.7075472,g:0,b:.5364411},_envColorLeft:{r:.32222217,g:.6111111,b:.75},_envColorRight:{r:.03844783,g:.62239975,b:.90566039},_obstacleColor:{r:.06167676,g:.2869513,b:.3962264}}},me=4,qt={0:180,1:0,2:270,3:90,4:225,5:135,6:315,7:45,8:0},Al={0:1,1:0,2:3,3:2,4:7,5:6,6:5,7:4,8:8},Le={0:[0,1],1:[0,-1],2:[-1,0],3:[1,0],4:[-1,1],5:[1,1],6:[-1,-1],7:[1,-1],8:[0,0]},Pl={0:-60,1:-45,2:-30,3:-15,4:15,5:30,6:45,7:60};var jn=(t=>(t.Easy="Easy",t.Normal="Normal",t.Hard="Hard",t.Expert="Expert",t.ExpertPlus="Expert+",t))(jn||{});const Nl={DefaultEnvironment:"The First",OriginsEnvironment:"Origins",TriangleEnvironment:"Triangle",NiceEnvironment:"Nice",BigMirrorEnvironment:"Big Mirror",DragonsEnvironment:"Dragons",KDAEnvironment:"K/DA",MonstercatEnvironment:"Monstercat",CrabRaveEnvironment:"Crab Rave",PanicEnvironment:"Panic",RocketEnvironment:"Rocket",GreenDayEnvironment:"Green Day",GreenDayGrenadeEnvironment:"Green Day Grenade",TimbalandEnvironment:"Timbaland",FitBeatEnvironment:"FitBeat",LinkinParkEnvironment:"Linkin Park",BTSEnvironment:"BTS",KaleidoscopeEnvironment:"Kaleidoscope",InterscopeEnvironment:"Interscope",SkrillexEnvironment:"Skrillex",BillieEnvironment:"Billie",HalloweenEnvironment:"Spooky",GagaEnvironment:"Gaga",WeaveEnvironment:"Weave",PyroEnvironment:"Pyro",EDMEnvironment:"EDM",GlassDesertEnvironment:"Glass Desert"},Ol=(t,e)=>{switch(t){case 0:switch(e){case"BillieEnvironment":return"Water 4";case"PyroEnvironment":return"Video Alpha";case"EDMEnvironment":return"Lane Lights Bottom";default:return"Back Lasers"}case 1:switch(e){case"BillieEnvironment":return"Water 1";case"PyroEnvironment":return"Logo";case"EDMEnvironment":return"Lane Lights Top";default:return"Ring Lights"}case 2:switch(e){case"BillieEnvironment":return"Left Sun Ray";case"PyroEnvironment":return"Left Projectors";default:return"Left Lasers"}case 3:switch(e){case"BillieEnvironment":return"Right Sun Ray";case"PyroEnvironment":return"Right Projectors";default:return"Right Lasers"}case 4:switch(e){case"BillieEnvironment":return"Sun";case"PyroEnvironment":return"Platform";case"EDMEnvironment":return"Player Space & Spectrogram";default:return"Center Lights"}case 5:return"Light Color Boost";case 6:switch(e){case"BillieEnvironment":return"Water 2";case"PyroEnvironment":return"Ambient";default:return"Extra Left Lights"}case 7:switch(e){case"BillieEnvironment":return"Water 3";default:return"Extra Right Lights"}case 8:switch(e){case"BillieEnvironment":return"Rain Toggle";default:return"Ring Rotation"}case 9:switch(e){case"BillieEnvironment":return"Laser Align Toggle";default:return"Ring Zoom"}case 10:switch(e){default:return"Extra Left Lasers"}case 11:switch(e){default:return"Extra Right Lasers"}case 12:switch(e){case"BillieEnvironment":return"Left Sun Ray Rotation";default:return"Left Laser Rotation"}case 13:switch(e){case"BillieEnvironment":return"Right Sun Ray Rotation";default:return"Right Laser Rotation"}case 14:return"Early Lane Rotation";case 15:return"Late Lane Rotation";case 16:switch(e){case"BillieEnvironment":return"Left Laser Rotation";default:return"Utility Event 1"}case 17:switch(e){case"BillieEnvironment":return"Right Laser Rotation";default:return"Utility Event 2"}case 18:switch(e){default:return"Utility Event 3"}case 19:switch(e){default:return"Utility Event 4"}case 40:switch(e){case"PyroEnvironment":return"Video Projection";default:return"BTS Event 1"}case 41:switch(e){default:return"BTS Event 2"}case 42:switch(e){default:return"BTS Event 3"}case 43:switch(e){default:return"BTS Event 4"}default:return"Unknown"}},ci={DefaultEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],OriginsEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],TriangleEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],NiceEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],BigMirrorEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],DragonsEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],KDAEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],MonstercatEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],CrabRaveEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],PanicEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],RocketEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],GreenDayEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],GreenDayGrenadeEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],TimbalandEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],FitBeatEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],LinkinParkEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],BTSEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],KaleidoscopeEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],InterscopeEnvironment:[[0,1,2,3,4,5,6,7,8,9,12,13,16,17],[]],SkrillexEnvironment:[[0,1,2,3,4,5,6,7,8,9,12,13],[]],BillieEnvironment:[[0,1,2,3,4,5,6,7,8,9,10,11,12,13,16,17],[]],HalloweenEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],GagaEnvironment:[[0,1,2,3,4,5,6,7,8,9,10,11,12,13,16,17],[]],GlassDesertEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],WeaveEnvironment:[[],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]],PyroEnvironment:[[0,1,2,3,4,6],[0,1,2,3,4,5,6,7,8,9,10,11,12,13]],EDMEnvironment:[[0,1,4],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]]},Qe=class{constructor(t,e=10,n=0){this._bpm=t,this._njs=e,this._sdm=n,this.update()}get value(){return this._njs}set value(t){this._njs=t,this.update()}get offset(){return this._sdm}set offset(t){this._sdm=t,this.update()}get hjd(){return this._hjd}get hjdMin(){return Qe.HJD_MIN}get reactTime(){return this._reactionTime}get jd(){return this._jd}get jdMin(){return this._jdMin}update(){this._hjd=this.calcHalfJumpDuration(),this._jd=this.calcJumpDistance(),this._jdMin=this.calcJumpDistance(Qe.HJD_MIN),this._reactionTime=this.calcReactionTimeFromHJD()}calcHalfJumpDurationRaw(){const e=this._njs*this._njs/this._njs,n=60/this._bpm.value;let i=Qe.HJD_START;for(;e*n*i>17.999;)i/=2;return i<1&&(i=1),i}calcHalfJumpDuration(t=this.offset){return Math.max(this.calcHalfJumpDurationRaw()+t,Qe.HJD_MIN)}calcHalfJumpDurationFromJD(t=this.calcJumpDistance()){return t/(60/this._bpm.value*this._njs*2)}calcHalfJumpDurationFromRT(t=this.calcReactionTimeFromHJD()){return t/(60/this._bpm.value)}calcJumpDistance(t=this.calcHalfJumpDuration()){return this._njs*(60/this._bpm.value)*t*2}calcJumpDistanceOptimalHigh(){return 18*(1/1.07)**this._njs+18}calcJumpDistanceOptimalLow(){return-(18/(this._njs+1))+18}calcReactionTimeFromJD(t=this.calcJumpDistance()){return t/(2*this._njs)}calcReactionTimeFromHJD(t=this.calcHalfJumpDuration()){return 60/this._bpm.value*t}calcDistance(t){return this._njs*60/this._bpm.value*t*2}};let Te=Qe;Te.HJD_START=4;Te.HJD_MIN=.25;Te.create=(t,e=10,n=0)=>typeof t=="number"?new Qe(oe.create(t),e,n):new Qe(t,e,n);Te.FallbackNJS={ExpertPlus:16,Expert:12,Hard:10,Normal:10,Easy:10};const jl=(t,e)=>{const n=so(t),i=so(e);for(const a in n){if(n[a]<i[a])return"old";if(n[a]>i[a])return"new"}return"current"},so=t=>t.replace("v","").split(".").map(e=>parseInt(e));class Xt{constructor(e){this.data=e}serialize(){return JSON.stringify(this.toObject())}}class Ni extends Xt{get time(){return this.data._time}set time(e){this.data._time=e}get customData(){return this.data._customData}set customData(e){this.data._customData=e}setCustomData(e){return this.customData=e,this}deleteCustomData(){return this.customData={},this}removeCustomData(e){return this.customData&&delete this.customData[e],this}addCustomData(e){return this.customData=Vn(qn({},this.customData),{object:e}),this}}const Tt=class extends Ni{constructor(t){super(t),this.isNote=()=>this.type===0||this.type===1,this.isBomb=()=>this.type===3,this.getPosition=()=>{var e;return(e=this.customData)!=null&&e._position?[this.customData._position[0],this.customData._position[1]]:[(this.lineIndex<=-1e3?this.lineIndex/1e3:this.lineIndex>=1e3?this.lineIndex/1e3:this.lineIndex)-2,this.lineLayer<=-1e3?this.lineLayer/1e3:this.lineLayer>=1e3?this.lineLayer/1e3:this.lineLayer]},this.getAngle=()=>{var e;return(e=this.customData)!=null&&e._cutDirection?this.customData._cutDirection>0?this.customData._cutDirection%360:360+this.customData._cutDirection%360:this.cutDirection>=1e3?Math.abs(this.cutDirection%1e3%360-360):qt[this.cutDirection]||0},this.getDistance=e=>{const[n,i]=this.getPosition(),[a,r]=e.getPosition();return Math.sqrt(Math.pow(a-n,2)+Math.pow(r-i,2))},this.isVertical=e=>{const[n]=this.getPosition(),[i]=e.getPosition(),a=n-i;return a>-.001&&a<.001},this.isHorizontal=e=>{const[n,i]=this.getPosition(),[a,r]=e.getPosition(),l=i-r;return l>-.001&&l<.001},this.isDiagonal=e=>{const[n,i]=this.getPosition(),[a,r]=e.getPosition(),l=Math.abs(n-a),s=Math.abs(i-r);return l===s},this.isInline=(e,n=.5)=>this.getDistance(e)<=n,this.isDouble=(e,n)=>{for(let i=n,a=e.length;i<a;i++){if(e[i].time<this.time+.01&&e[i].type!==this.type)return!0;if(e[i].time>this.time+.01)return!1}return!1},this.isAdjacent=e=>{const n=this.getDistance(e);return n>.499&&n<1.001},this.isWindow=e=>this.getDistance(e)>1.8,this.isSlantedWindow=e=>this.isWindow(e)&&!this.isDiagonal(e)&&!this.isHorizontal(e)&&!this.isVertical(e),this.hasChroma=()=>{var e,n;return Array.isArray((e=this.customData)==null?void 0:e._color)||typeof((n=this.customData)==null?void 0:n._disableSpawnEffect)=="boolean"},this.hasNoodleExtensions=()=>{var e,n,i,a,r,l,s,o,f,h,m,p,c;return Array.isArray((e=this.customData)==null?void 0:e._animation)||typeof((n=this.customData)==null?void 0:n._cutDirection)=="number"||typeof((i=this.customData)==null?void 0:i._disableNoteGravity)=="boolean"||typeof((a=this.customData)==null?void 0:a._disableNoteLook)=="boolean"||typeof((r=this.customData)==null?void 0:r._fake)=="boolean"||Array.isArray((l=this.customData)==null?void 0:l._flip)||typeof((s=this.customData)==null?void 0:s._interactable)=="boolean"||Array.isArray((o=this.customData)==null?void 0:o._localRotation)||typeof((f=this.customData)==null?void 0:f._noteJumpMovementSpeed)=="number"||typeof((h=this.customData)==null?void 0:h._noteJumpStartBeatOffset)=="number"||Array.isArray((m=this.customData)==null?void 0:m._position)||Array.isArray((p=this.customData)==null?void 0:p._rotation)||typeof((c=this.customData)==null?void 0:c._track)=="string"},this.hasMappingExtensions=()=>this.cutDirection>=1e3||this.lineIndex>3||this.lineIndex<0||this.lineLayer>2||this.lineLayer<0,this.isValidDirection=()=>this.cutDirection>=0&&this.cutDirection<=8,this.isValid=()=>!this.hasMappingExtensions()&&this.isValidDirection()}static create(...t){const e=[];return t==null||t.forEach(n=>{var i,a,r,l,s,o;return e.push(new Tt({_time:(i=n._time)!=null?i:Tt.default._time,_lineIndex:(a=n._lineIndex)!=null?a:Tt.default._lineIndex,_lineLayer:(r=n._lineLayer)!=null?r:Tt.default._lineLayer,_type:(l=n._type)!=null?l:Tt.default._type,_cutDirection:(s=n._cutDirection)!=null?s:Tt.default._cutDirection,_customData:(o=n._customData)!=null?o:Tt.default._customData()}))}),e.length===1?e[0]:e.length?e:new Tt({_time:Tt.default._time,_lineIndex:Tt.default._lineIndex,_lineLayer:Tt.default._lineLayer,_type:Tt.default._type,_cutDirection:Tt.default._cutDirection,_customData:Tt.default._customData()})}toObject(){return{_time:this.time,_type:this.type,_lineIndex:this.lineIndex,_lineLayer:this.lineLayer,_cutDirection:this.cutDirection,_customData:yt(this.customData)}}get lineIndex(){return this.data._lineIndex}set lineIndex(t){this.data._lineIndex=t}get lineLayer(){return this.data._lineLayer}set lineLayer(t){this.data._lineLayer=t}get type(){return this.data._type}set type(t){this.data._type=t}get cutDirection(){return this.data._cutDirection}set cutDirection(t){this.data._cutDirection=t}setLineIndex(t){return this.lineIndex=t,this}setLineLayer(t){return this.lineLayer=t,this}setType(t){return this.type=t,this}setCutDirection(t){return this.cutDirection=t,this}};let fr=Tt;fr.default={_time:0,_lineIndex:0,_lineLayer:0,_type:0,_cutDirection:0,_customData:()=>({})};const ht=class extends Xt{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var i,a,r,l,s,o,f,h,m,p,c,_,v,g;return e.push(new ht({_colorType:(i=n._colorType)!=null?i:ht.default._colorType,_headTime:(r=(a=n._headTime)!=null?a:n._tailTime)!=null?r:ht.default._headTime,_headLineIndex:(l=n._headLineIndex)!=null?l:ht.default._headLineIndex,_headLineLayer:(s=n._headLineLayer)!=null?s:ht.default._headLineLayer,_headCutDirection:(o=n._headCutDirection)!=null?o:ht.default._headCutDirection,_headControlPointlengthMultiplier:(f=n._headControlPointlengthMultiplier)!=null?f:ht.default._headControlPointlengthMultiplier,_tailTime:(m=(h=n._tailTime)!=null?h:n._headTime)!=null?m:ht.default._tailTime,_tailLineIndex:(p=n._tailLineIndex)!=null?p:ht.default._tailLineIndex,_tailLineLayer:(c=n._tailLineLayer)!=null?c:ht.default._tailLineLayer,_tailCutDirection:(_=n._tailCutDirection)!=null?_:ht.default._tailCutDirection,_tailControlPointLengthMultiplier:(v=n._tailControlPointLengthMultiplier)!=null?v:ht.default._tailControlPointLengthMultiplier,_sliderMidAnchorMode:(g=n._sliderMidAnchorMode)!=null?g:ht.default._sliderMidAnchorMode}))}),e.length===1?e[0]:e.length?e:new ht({_colorType:ht.default._colorType,_headTime:ht.default._headTime,_headLineIndex:ht.default._headLineIndex,_headLineLayer:ht.default._headLineLayer,_headCutDirection:ht.default._headCutDirection,_headControlPointlengthMultiplier:ht.default._headControlPointlengthMultiplier,_tailTime:ht.default._tailTime,_tailLineIndex:ht.default._tailLineIndex,_tailLineLayer:ht.default._tailLineLayer,_tailCutDirection:ht.default._tailCutDirection,_tailControlPointLengthMultiplier:ht.default._tailControlPointLengthMultiplier,_sliderMidAnchorMode:ht.default._sliderMidAnchorMode})}toObject(){return{_colorType:this.colorType,_headTime:this.headTime,_headLineIndex:this.headLineIndex,_headLineLayer:this.headLineLayer,_headCutDirection:this.headCutDirection,_headControlPointlengthMultiplier:this.headLengthMultiplier,_tailTime:this.tailTime,_tailLineIndex:this.tailLineIndex,_tailLineLayer:this.tailLineLayer,_tailCutDirection:this.tailCutDirection,_tailControlPointLengthMultiplier:this.tailLengthMultiplier,_sliderMidAnchorMode:this.midAnchor}}get colorType(){return this.data._colorType}set colorType(t){this.data._colorType=t}get headTime(){return this.data._headTime}set headTime(t){this.data._headTime=t}get headLineIndex(){return this.data._headLineIndex}set headLineIndex(t){this.data._headLineIndex=t}get headLineLayer(){return this.data._headLineLayer}set headLineLayer(t){this.data._headLineLayer=t}get headCutDirection(){return this.data._headCutDirection}set headCutDirection(t){this.data._headCutDirection=t}get headLengthMultiplier(){return this.data._headControlPointlengthMultiplier}set headLengthMultiplier(t){this.data._headControlPointlengthMultiplier=t}get tailTime(){return this.data._tailTime}set tailTime(t){this.data._tailTime=t}get tailLineIndex(){return this.data._tailLineIndex}set tailLineIndex(t){this.data._tailLineIndex=t}get tailLineLayer(){return this.data._tailLineLayer}set tailLineLayer(t){this.data._tailLineLayer=t}get tailCutDirection(){return this.data._tailCutDirection}set tailCutDirection(t){this.data._tailCutDirection=t}get tailLengthMultiplier(){return this.data._tailControlPointLengthMultiplier}set tailLengthMultiplier(t){this.data._tailControlPointLengthMultiplier=t}get midAnchor(){return this.data._sliderMidAnchorMode}set midAnchor(t){this.data._sliderMidAnchorMode=t}setColor(t){return this.colorType=t,this}setPosX(t){return this.headLineIndex=t,this}setPosY(t){return this.headLineLayer=t,this}setDirection(t){return this.headCutDirection=t,this}setLengthMultiplier(t){return this.headLengthMultiplier=t,this}setTailTime(t){return this.tailTime=t,this}setTailPosX(t){return this.tailLineIndex=t,this}setTailPosY(t){return this.tailLineLayer=t,this}setTailDirection(t){return this.tailCutDirection=t,this}setTailLengthMultiplier(t){return this.tailLengthMultiplier=t,this}setMidAnchor(t){return this.midAnchor=t,this}mirror(t=!0){switch(this.headLineIndex=me-1-this.headLineIndex,this.tailLineIndex=me-1-this.tailLineIndex,t&&(this.colorType=(1+this.colorType)%2),this.headCutDirection){case 2:this.headCutDirection=3;break;case 3:this.headCutDirection=2;break;case 6:this.headCutDirection=7;break;case 7:this.headCutDirection=6;break;case 4:this.headCutDirection=5;break;case 5:this.headCutDirection=4;break}switch(this.tailCutDirection){case 2:this.tailCutDirection=3;break;case 3:this.tailCutDirection=2;break;case 6:this.tailCutDirection=7;break;case 7:this.tailCutDirection=6;break;case 4:this.tailCutDirection=5;break;case 5:this.tailCutDirection=4;break}return this.midAnchor&&(this.midAnchor=this.midAnchor===1?2:1),this}hasMappingExtensions(){return this.headLineLayer>2||this.headLineLayer<0||this.headLineIndex<=-1e3||this.headLineIndex>=1e3||this.headCutDirection>=1e3&&this.headCutDirection<=1360||this.tailCutDirection>=1e3&&this.tailCutDirection<=1360}};let mr=ht;mr.default={_colorType:0,_headTime:0,_headLineIndex:0,_headLineLayer:0,_headCutDirection:0,_headControlPointlengthMultiplier:.5,_tailTime:0,_tailLineIndex:0,_tailLineLayer:0,_tailCutDirection:0,_tailControlPointLengthMultiplier:.5,_sliderMidAnchorMode:0};const wt=class extends Ni{constructor(t){super(t),this.getPosition=()=>{var e;return(e=this.customData)!=null&&e._position?[this.customData._position[0],this.customData._position[1]]:[(this.lineIndex<=-1e3?this.lineIndex/1e3:this.lineIndex>=1e3?this.lineIndex/1e3:this.lineIndex)-2,this.type<=-1e3?this.type/1e3:this.type>=1e3?this.type/1e3:this.type]},this.isInteractive=()=>this.width>=2||this.lineIndex===1||this.lineIndex===2,this.isCrouch=()=>this.type===1&&(this.width>2||this.width===2&&this.lineIndex===1),this.isZero=()=>this.duration===0||this.width===0,this.isLonger=(e,n,i=0)=>e._time+e._duration>n._time+n._duration+i,this.hasChroma=()=>{var e;return Array.isArray((e=this.customData)==null?void 0:e._color)},this.hasNoodleExtensions=()=>{var e,n,i,a,r,l,s,o,f,h;return Array.isArray((e=this.customData)==null?void 0:e._animation)||typeof((n=this.customData)==null?void 0:n._fake)=="boolean"||typeof((i=this.customData)==null?void 0:i._interactable)=="boolean"||Array.isArray((a=this.customData)==null?void 0:a._localRotation)||typeof((r=this.customData)==null?void 0:r._noteJumpMovementSpeed)=="number"||typeof((l=this.customData)==null?void 0:l._noteJumpStartBeatOffset)=="number"||Array.isArray((s=this.customData)==null?void 0:s._position)||Array.isArray((o=this.customData)==null?void 0:o._rotation)||Array.isArray((f=this.customData)==null?void 0:f._scale)||typeof((h=this.customData)==null?void 0:h._track)=="string"},this.hasMappingExtensions=()=>this.width>=1e3||this.type>=1e3||this.lineIndex>3||this.lineIndex<0,this.isValid=()=>!this.hasMappingExtensions()&&this.width>0&&this.width<=4}static create(...t){const e=[];return t==null||t.forEach(n=>{var i,a,r,l,s,o,f,h;return e.push(new wt({_time:(i=n._time)!=null?i:wt.default._time,_type:(a=n._type)!=null?a:wt.default._type,_lineIndex:(r=n._lineIndex)!=null?r:wt.default._lineIndex,_lineLayer:(l=n._lineLayer)!=null?l:wt.default._lineLayer,_duration:(s=n._duration)!=null?s:wt.default._duration,_width:(o=n._width)!=null?o:wt.default._width,_height:(f=n._height)!=null?f:wt.default._height,_customData:(h=n._customData)!=null?h:wt.default._customData()}))}),e.length===1?e[0]:e.length?e:new wt({_time:wt.default._time,_type:wt.default._type,_lineIndex:wt.default._lineIndex,_lineLayer:wt.default._lineLayer,_duration:wt.default._duration,_width:wt.default._width,_height:wt.default._height,_customData:wt.default._customData()})}toObject(){return{_time:this.time,_type:this.type,_lineIndex:this.lineIndex,_lineLayer:this.lineLayer,_duration:this.duration,_width:this.width,_height:this.height,_customData:yt(this.customData)}}get lineIndex(){return this.data._lineIndex}set lineIndex(t){this.data._lineIndex=t}get lineLayer(){return this.data._lineLayer}set lineLayer(t){this.data._lineLayer=t}get type(){return this.data._type}set type(t){this.data._type=t}get duration(){return this.data._duration}set duration(t){this.data._duration=t}get width(){return this.data._width}set width(t){this.data._width=t}get height(){return this.data._height}set height(t){this.data._height=t}setType(t){return this.type=t,this}setLineIndex(t){return this.lineIndex=t,this}setLineLayer(t){return this.lineLayer=t,this}setDuration(t){return this.duration=t,this}setWidth(t){return this.width=t,this}setHeight(t){return this.height=t,this}};let pr=wt;pr.default={_time:0,_lineIndex:0,_lineLayer:0,_type:0,_duration:1,_width:1,_height:1,_customData:()=>({})};const Bt=class extends Ni{constructor(t){super(t),this.isOff=()=>this.value===0,this.isOn=()=>this.value===1||this.value===5||this.value===9,this.isFlash=()=>this.value===2||this.value===6||this.value===10,this.isFade=()=>this.value===3||this.value===7||this.value===11,this.isTransition=()=>this.value===4||this.value===8||this.value===12,this.isValidType=()=>this.type>=0&&this.type<=17||this.type===100,this.isLightEvent=()=>this.type===0||this.type===1||this.type===2||this.type===3||this.type===4||this.type===6||this.type===7||this.type===10||this.type===11,this.isColorBoost=()=>this.type===5,this.isRingEvent=()=>this.type===8||this.type===9,this.isLaserRotationEvent=()=>this.type===12||this.type===13,this.isLaneRotationEvent=()=>this.type===14||this.type===15,this.isExtraEvent=()=>this.type===16||this.type===17||this.type===18||this.type===19,this.isSpecialEvent=()=>this.type===40||this.type===41||this.type===42||this.type===43,this.isBPMChangeEvent=()=>this.type===100,this.isLightingEvent=()=>this.isLightEvent()||this.isRingEvent()||this.isLaserRotationEvent()||this.isExtraEvent(),this.hasChroma=()=>{var e,n,i,a,r,l,s,o,f,h,m,p,c,_,v,g,b,y,x,T,D,j;return this.isLightEvent()?Array.isArray((e=this.customData)==null?void 0:e._color)||typeof((n=this.customData)==null?void 0:n._lightID)=="number"||Array.isArray((i=this.customData)==null?void 0:i._lightID)||typeof((a=this.customData)==null?void 0:a._propID)=="number"||typeof((r=this.customData)==null?void 0:r._lightGradient)=="object"||typeof((l=this.customData)==null?void 0:l._easing)=="string"||typeof((s=this.customData)==null?void 0:s._lerpType)=="string":this.isRingEvent()?typeof((o=this.customData)==null?void 0:o._nameFilter)=="string"||typeof((f=this.customData)==null?void 0:f._reset)=="boolean"||typeof((h=this.customData)==null?void 0:h._rotation)=="number"||typeof((m=this.customData)==null?void 0:m._step)=="number"||typeof((p=this.customData)==null?void 0:p._prop)=="number"||typeof((c=this.customData)==null?void 0:c._speed)=="number"||typeof((_=this.customData)==null?void 0:_._direction)=="number"||typeof((v=this.customData)==null?void 0:v._counterSpin)=="boolean"||typeof((g=this.customData)==null?void 0:g._stepMult)=="number"||typeof((b=this.customData)==null?void 0:b._propMult)=="number"||typeof((y=this.customData)==null?void 0:y._speedMult)=="number":this.isLaserRotationEvent()?typeof((x=this.customData)==null?void 0:x._lockPosition)=="boolean"||typeof((T=this.customData)==null?void 0:T._speed)=="number"||typeof((D=this.customData)==null?void 0:D._preciseSpeed)=="number"||typeof((j=this.customData)==null?void 0:j._direction)=="number":!1},this.hasOldChroma=()=>this.value>=2e9,this.hasNoodleExtensions=()=>{var e;return this.isLaneRotationEvent()&&typeof((e=this.customData)==null?void 0:e._rotation)=="number"},this.hasMappingExtensions=()=>this.isLaneRotationEvent()&&this.value>=1e3&&this.value<=1720,this.isValid=()=>this.isValidType()&&this.value>=0&&!(!this.isLaserRotationEvent()&&this.value>12&&!this.hasOldChroma())}static create(...t){const e=[];return t==null||t.forEach(n=>{var i,a,r,l,s;return e.push(new Bt({_time:(i=n._time)!=null?i:Bt.default._time,_type:(a=n._type)!=null?a:Bt.default._type,_value:(r=n._value)!=null?r:Bt.default._value,_floatValue:(l=n._floatValue)!=null?l:Bt.default._floatValue,_customData:(s=n._customData)!=null?s:Bt.default._customData()}))}),e.length===1?e[0]:e.length?e:new Bt({_time:Bt.default._time,_type:Bt.default._type,_value:Bt.default._value,_floatValue:Bt.default._floatValue,_customData:Bt.default._customData()})}toObject(){return{_time:this.time,_type:this.type,_value:this.value,_floatValue:this.floatValue,_customData:yt(this.customData)}}get type(){return this.data._type}set type(t){this.data._type=t}get value(){return this.data._value}set value(t){this.data._value=t}get floatValue(){return this.data._floatValue}set floatValue(t){this.data._floatValue=t}setType(t){return this.type=t,this}setValue(t){return this.value=t,this}setFloatValue(t){return this.floatValue=t,this}};let gr=Bt;gr.default={_time:0,_type:0,_value:0,_floatValue:1,_customData:()=>({})};const It=class extends Ni{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var i,a,r,l,s;return e.push(new It({_time:(i=n._time)!=null?i:It.default._time,_lineIndex:(a=n._lineIndex)!=null?a:It.default._lineIndex,_lineLayer:(r=n._lineLayer)!=null?r:It.default._lineLayer,_offsetDirection:(l=n._offsetDirection)!=null?l:It.default._offsetDirection,_customData:(s=n._customData)!=null?s:It.default._customData()}))}),e.length===1?e[0]:e.length?e:new It({_time:It.default._time,_lineIndex:It.default._lineIndex,_lineLayer:It.default._lineLayer,_offsetDirection:It.default._offsetDirection,_customData:It.default._customData()})}toObject(){return{_time:this.time,_lineIndex:this.lineIndex,_lineLayer:this.lineLayer,_offsetDirection:this.direction,_customData:yt(this.customData)}}get lineIndex(){return this.data._lineIndex}set lineIndex(t){this.data._lineIndex=t}get lineLayer(){return this.data._lineLayer}set lineLayer(t){this.data._lineLayer=t}get direction(){return this.data._offsetDirection}set direction(t){this.data._offsetDirection=t}setLineIndex(t){return this.lineIndex=t,this}setLineLayer(t){return this.lineLayer=t,this}setDirection(t){return this.direction=t,this}mirror(){switch(this.lineIndex=me-1-this.lineIndex,this.direction){case 2:this.direction=3;break;case 3:this.direction=2;break;case 6:this.direction=7;break;case 7:this.direction=6;break;case 4:this.direction=5;break;case 5:this.direction=4;break}return this}};let br=It;br.default={_time:0,_lineIndex:0,_lineLayer:0,_offsetDirection:1,_customData:()=>({})};const Ze=class extends Xt{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var i,a;return e.push(new Ze({_keyword:(i=n._keyword)!=null?i:Ze.default._keyword,_specialEvents:(a=n._specialEvents)!=null?a:Ze.default._specialEvents()}))}),e.length===1?e[0]:e.length?e:new Ze({_keyword:Ze.default._keyword,_specialEvents:Ze.default._specialEvents()})}toObject(){return{_keyword:this.keyword,_specialEvents:this.events}}get keyword(){return this.data._keyword}set keyword(t){this.data._keyword=t}get events(){return this.data._specialEvents}set events(t){this.data._specialEvents=t}setKeyword(t){return this.keyword=t,this}setEvents(t){return this.events=t,this}addEvent(t){return this.events.push(t),this}removeEvent(t){const e=this.events.indexOf(t,0);return e>-1&&this.events.splice(e,1),this}};let _r=Ze;_r.default={_keyword:"",_specialEvents:()=>[]};const yr=class extends Xt{constructor(t){super(t),this.keywords=t._keywords.map(e=>_r.create({_keyword:e._keyword,_specialEvents:e._specialEvents}))}static create(t={}){var e;return new yr({_keywords:(e=t._keywords)!=null?e:yr.default._keywords()})}toObject(){return{_keywords:this.keywords.map(t=>t.toObject())}}setKeyword(t){return this.keywords=t,this}addKeyword(t){return this.keywords.push(_r.create(t)),this}removeKeyword(t){return this.keywords=this.keywords.filter(e=>e.keyword!==t),this}};let ss=yr;ss.default={_keywords:()=>[]};class Jr extends Xt{constructor(e){super(e),this.getFirstInteractiveTime=()=>{let n=Number.MAX_VALUE;this.notes.length>0&&(n=this.notes[0].time);const i=this.findFirstInteractiveObstacleTime();return Math.min(n,i)},this.getLastInteractiveTime=()=>{let n=0;this.notes.length>0&&(n=this.notes[this.notes.length-1].time);const i=this.findLastInteractiveObstacleTime();return Math.max(n,i)},this.findFirstInteractiveObstacleTime=()=>{for(let n=0,i=this.obstacles.length;n<i;n++)if(this.obstacles[n].isInteractive())return this.obstacles[n].time;return Number.MAX_VALUE},this.findLastInteractiveObstacleTime=()=>{let n=0;for(let i=this.obstacles.length-1;i>=0;i--)this.obstacles[i].isInteractive()&&(n=Math.max(n,this.obstacles[i].time+this.obstacles[i].duration));return n},this.addNotes=(...n)=>{n.forEach(i=>{this.notes.push(fr.create(i))})},this.addObstacles=(...n)=>{n.forEach(i=>{this.obstacles.push(pr.create(i))})},this.addEvents=(...n)=>{n.forEach(i=>{this.events.push(gr.create(i))})},this.addWaypoints=(...n)=>{n.forEach(i=>{this.waypoints.push(br.create(i))})},this.addSliders=(...n)=>{n.forEach(i=>{this.sliders.push(mr.create(i))})},this.version="2.6.0",this.notes=e._notes.map(n=>fr.create(n)),this.sliders=e._sliders.map(n=>mr.create(n)),this.obstacles=e._obstacles.map(n=>pr.create(n)),this.events=e._events.map(n=>gr.create(n)),this.waypoints=e._waypoints.map(n=>br.create(n)),this.specialEventsKeywordFilters=ss.create(e._specialEventsKeywordFilters),this.customData=e._customData}static create(e={}){var n,i,a,r,l,s,o;return new Jr({_version:"2.6.0",_notes:(n=e._notes)!=null?n:[],_sliders:(i=e._sliders)!=null?i:[],_obstacles:(a=e._obstacles)!=null?a:[],_events:(r=e._events)!=null?r:[],_waypoints:(l=e._waypoints)!=null?l:[],_specialEventsKeywordFilters:(s=e._specialEventsKeywordFilters)!=null?s:{_keywords:[]},_customData:(o=e._customData)!=null?o:{}})}toObject(){var e;return{_version:this.version||"2.6.0",_notes:this.notes.map(n=>n.toObject()),_sliders:this.sliders.map(n=>n.toObject()),_obstacles:this.obstacles.map(n=>n.toObject()),_events:this.events.map(n=>n.toObject()),_waypoints:this.waypoints.map(n=>n.toObject()),_specialEventsKeywordFilters:(e=this.specialEventsKeywordFilters)==null?void 0:e.toObject(),_customData:yt(this.customData)}}}class Re extends Xt{get time(){return this.data.b}set time(e){this.data.b=e}get customData(){return this.data.customData}set customData(e){this.data.customData=e}setTime(e){return this.time=e,this}setCustomData(e){return this.customData=e,this}deleteCustomData(){return this.customData={},this}removeCustomData(e){return this.customData&&delete this.customData[e],this}addCustomData(e){return this.customData=Vn(qn({},this.customData),{object:e}),this}}const At=class extends Re{constructor(t){super(t),this.hasChroma=()=>{var e,n,i,a,r,l,s,o,f,h,m,p,c,_,v,g,b,y,x,T,D,j;return this.isLightEvent()?Array.isArray((e=this.customData)==null?void 0:e._color)||typeof((n=this.customData)==null?void 0:n._lightID)=="number"||Array.isArray((i=this.customData)==null?void 0:i._lightID)||typeof((a=this.customData)==null?void 0:a._propID)=="number"||typeof((r=this.customData)==null?void 0:r._lightGradient)=="object"||typeof((l=this.customData)==null?void 0:l._easing)=="string"||typeof((s=this.customData)==null?void 0:s._lerpType)=="string":this.isRingEvent()?typeof((o=this.customData)==null?void 0:o._nameFilter)=="string"||typeof((f=this.customData)==null?void 0:f._reset)=="boolean"||typeof((h=this.customData)==null?void 0:h._rotation)=="number"||typeof((m=this.customData)==null?void 0:m._step)=="number"||typeof((p=this.customData)==null?void 0:p._prop)=="number"||typeof((c=this.customData)==null?void 0:c._speed)=="number"||typeof((_=this.customData)==null?void 0:_._direction)=="number"||typeof((v=this.customData)==null?void 0:v._counterSpin)=="boolean"||typeof((g=this.customData)==null?void 0:g._stepMult)=="number"||typeof((b=this.customData)==null?void 0:b._propMult)=="number"||typeof((y=this.customData)==null?void 0:y._speedMult)=="number":this.isLaserRotationEvent()?typeof((x=this.customData)==null?void 0:x._lockPosition)=="boolean"||typeof((T=this.customData)==null?void 0:T._speed)=="number"||typeof((D=this.customData)==null?void 0:D._preciseSpeed)=="number"||typeof((j=this.customData)==null?void 0:j._direction)=="number":!1}}static create(...t){const e=[];return t==null||t.forEach(n=>{var i,a,r,l,s;return e.push(new At({b:(i=n.b)!=null?i:At.default.b,et:(a=n.et)!=null?a:At.default.et,i:(r=n.i)!=null?r:At.default.i,f:(l=n.f)!=null?l:At.default.f,customData:(s=n.customData)!=null?s:At.default.customData()}))}),e.length===1?e[0]:e.length?e:new At({b:At.default.b,et:At.default.et,i:At.default.i,f:At.default.f,customData:At.default.customData()})}toObject(){return{b:this.time,et:this.type,i:this.value,f:this.floatValue,customData:yt(this.customData)}}get type(){return this.data.et}set type(t){this.data.et=t}get value(){return this.data.i}set value(t){this.data.i=t}get floatValue(){return this.data.f}set floatValue(t){this.data.f=t}setType(t){return this.type=t,this}setValue(t){return this.value=t,this}setFloatValue(t){return this.floatValue=t,this}isOff(){return this.value===0}isOn(){return this.value===1||this.value===5||this.value===9}isFlash(){return this.value===2||this.value===6||this.value===10}isFade(){return this.value===3||this.value===7||this.value===11}isTransition(){return this.value===4||this.value===8||this.value===12}isValidType(){return this.type>=0&&this.type<=17||this.type===100}isLightEvent(){return this.type===0||this.type===1||this.type===2||this.type===3||this.type===4||this.type===6||this.type===7||this.type===10||this.type===11}isColorBoost(){return this.type===5}isRingEvent(){return this.type===8}isLaserRotationEvent(){return this.type===12||this.type===13}isLaneRotationEvent(){return this.type===14||this.type===15}isExtraEvent(){return this.type===16||this.type===17||this.type===18||this.type===19}isSpecialEvent(){return this.type===40||this.type===41||this.type===42||this.type===43}isBPMChangeEvent(){return this.type===100}isLightingEvent(){return this.isLightEvent()||this.isRingEvent()||this.isLaserRotationEvent()||this.isExtraEvent()}hasOldChroma(){return this.value>=2e9}isValid(){return this.isValidType()&&this.value>=0&&!(!this.isLaserRotationEvent()&&this.value>12&&!this.hasOldChroma())}};let ui=At;ui.default={b:0,et:0,i:0,f:1,customData:()=>({})};const Je=class extends Xt{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var i,a;return e.push(new Je({k:(i=n.k)!=null?i:Je.default.k,e:(a=n.e)!=null?a:Je.default.e()}))}),e.length===1?e[0]:e.length?e:new Je({k:Je.default.k,e:Je.default.e()})}toObject(){return{k:this.keyword,e:this.events}}get keyword(){return this.data.k}set keyword(t){this.data.k=t}get events(){return this.data.e}set events(t){this.data.e=t}setKeyword(t){return this.keyword=t,this}setEvents(t){return this.events=t,this}addEvent(t){return this.events.push(t),this}removeEvent(t){const e=this.events.indexOf(t,0);return e>-1&&this.events.splice(e,1),this}};let vr=Je;vr.default={k:"",e:()=>[]};const wr=class extends Xt{constructor(t){super(t),this.d=t.d.map(e=>vr.create({e:e.e,k:e.k}))}static create(t={}){var e;return new wr({d:(e=t.d)!=null?e:wr.default.d()})}toObject(){return{d:this.list.map(t=>t.toObject())}}get list(){return this.d}set list(t){this.d=t}setData(t){return this.list=t,this}addData(t){return this.list.push(vr.create(t)),this}removeData(t){return this.list=this.list.filter(e=>e.keyword!==t),this}};let Kr=wr;Kr.default={d:()=>[]};class Qr extends Re{get posX(){return this.data.x}set posX(e){this.data.x=e}get posY(){return this.data.y}set posY(e){this.data.y=e}setPosX(e){return this.posX=e,this}setPosY(e){return this.posY=e,this}mirror(){return this.posX=me-1-this.posX,this}swapPosition(e){const n=e.posX;e.posX=this.posX,this.posX=n;const i=e.posY;return e.posY=this.posY,this.posY=i,this}hasMappingExtensions(){return this.posX>3||this.posX<0||this.posY>2||this.posY<0}}const te=class extends Qr{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var i,a,r,l;return e.push(new te({b:(i=n.b)!=null?i:te.default.b,x:(a=n.x)!=null?a:te.default.x,y:(r=n.y)!=null?r:te.default.y,customData:(l=n.customData)!=null?l:te.default.customData()}))}),e.length===1?e[0]:e.length?e:new te({b:te.default.b,x:te.default.x,y:te.default.y,customData:te.default.customData()})}toObject(){return{b:this.time,x:this.posX,y:this.posY,customData:yt(this.customData)}}getPosition(){return[(this.posX<=-1e3?this.posX/1e3:this.posX>=1e3?this.posX/1e3:this.posX)-2,this.posY<=-1e3?this.posY/1e3:this.posY>=1e3?this.posY/1e3:this.posY]}getDistance(t){const[e,n]=this.getPosition(),[i,a]=t.getPosition();return Math.sqrt(Math.pow(i-e,2)+Math.pow(a-n,2))}isVertical(t){const[e]=this.getPosition(),[n]=t.getPosition(),i=e-n;return i>-.001&&i<.001}isHorizontal(t){const[e,n]=this.getPosition(),[i,a]=t.getPosition(),r=n-a;return r>-.001&&r<.001}isDiagonal(t){const[e,n]=this.getPosition(),[i,a]=t.getPosition(),r=Math.abs(e-i),l=Math.abs(n-a);return r===l}isInline(t,e=.5){return this.getDistance(t)<=e}isAdjacent(t){const e=this.getDistance(t);return e>.499&&e<1.001}isWindow(t,e=1.8){return this.getDistance(t)>e}isSlantedWindow(t){return this.isWindow(t)&&!this.isDiagonal(t)&&!this.isHorizontal(t)&&!this.isVertical(t)}hasMappingExtensions(){return this.posX>3||this.posX<0||this.posY>2||this.posY<0}isValid(){return!this.hasMappingExtensions()}};let hi=te;hi.default={b:0,x:0,y:0,customData:()=>({})};const be=class extends Re{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var i,a,r;return e.push(new be({b:(i=n.b)!=null?i:be.default.b,m:(a=n.m)!=null?a:be.default.m,customData:(r=n.customData)!=null?r:be.default.customData()}))}),e.length===1?e[0]:e.length?e:new be({b:be.default.b,m:be.default.m,customData:be.default.customData()})}toObject(){return{b:this.time,m:this.bpm,customData:yt(this.customData)}}get bpm(){return this.data.m}set bpm(t){this.data.m=t}setBPM(t){return this.bpm=t,this}};let di=be;di.default={b:0,m:0,customData:()=>({})};class ls extends Qr{get color(){return this.data.c}set color(e){this.data.c=e}get direction(){return this.data.d}set direction(e){this.data.d=e}get tailTime(){return this.data.tb}set tailTime(e){this.data.tb=e}get tailPosX(){return this.data.tx}set tailPosX(e){this.data.tx=e}get tailPosY(){return this.data.ty}set tailPosY(e){this.data.ty=e}setColor(e){return this.color=e,this}setPosX(e){return this.posX=e,this}setPosY(e){return this.posY=e,this}setDirection(e){return this.direction=e,this}setTailTime(e){return this.tailTime=e,this}setTailPosX(e){return this.tailPosX=e,this}setTailPosY(e){return this.tailPosY=e,this}getPosition(){return[(this.posX<=-1e3?this.posX/1e3:this.posX>=1e3?this.posX/1e3:this.posX)-2,this.posY<=-1e3?this.posY/1e3:this.posY>=1e3?this.posY/1e3:this.posY]}getDistance(e){const[n,i]=this.getPosition(),[a,r]=e.getPosition();return Math.sqrt(Math.pow(a-n,2)+Math.pow(r-i,2))}isVertical(e){const[n]=this.getPosition(),[i]=e.getPosition(),a=n-i;return a>-.001&&a<.001}isHorizontal(e){const[n,i]=this.getPosition(),[a,r]=e.getPosition(),l=i-r;return l>-.001&&l<.001}isDiagonal(e){const[n,i]=this.getPosition(),[a,r]=e.getPosition(),l=Math.abs(n-a),s=Math.abs(i-r);return l===s}isInline(e,n=.5){return this.getDistance(e)<=n}isAdjacent(e){const n=this.getDistance(e);return n>.499&&n<1.001}isWindow(e,n=1.8){return this.getDistance(e)>n}isSlantedWindow(e){return this.isWindow(e)&&!this.isDiagonal(e)&&!this.isHorizontal(e)&&!this.isVertical(e)}isInverse(){return this.time>this.tailTime}}const mt=class extends ls{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var i,a,r,l,s,o,f,h,m,p,c,_,v;return e.push(new mt({b:(a=(i=n.b)!=null?i:n.tb)!=null?a:mt.default.b,c:(r=n.c)!=null?r:mt.default.c,x:(l=n.x)!=null?l:mt.default.x,y:(s=n.y)!=null?s:mt.default.y,d:(o=n.d)!=null?o:mt.default.d,tb:(h=(f=n.tb)!=null?f:n.b)!=null?h:mt.default.tb,tx:(m=n.tx)!=null?m:mt.default.tx,ty:(p=n.ty)!=null?p:mt.default.ty,sc:(c=n.sc)!=null?c:mt.default.sc,s:(_=n.s)!=null?_:mt.default.s,customData:(v=n.customData)!=null?v:mt.default.customData()}))}),e.length===1?e[0]:e.length?e:new mt({b:mt.default.b,c:mt.default.c,x:mt.default.x,y:mt.default.y,d:mt.default.d,tb:mt.default.tb,tx:mt.default.tx,ty:mt.default.ty,sc:mt.default.sc,s:mt.default.s,customData:mt.default.customData()})}toObject(){return{b:this.time,c:this.color,x:this.posX,y:this.posY,d:this.direction,tb:this.tailTime,tx:this.tailPosX,ty:this.tailPosY,sc:this.sliceCount,s:this.squish,customData:yt(this.customData)}}get sliceCount(){return this.data.sc}set sliceCount(t){this.data.sc=t}get squish(){return this.data.s}set squish(t){this.data.s=t}setSliceCount(t){return this.sliceCount=t,this}setSquish(t){return this.squish=t,this}mirror(t=!0){switch(this.posX=me-1-this.posX,this.tailPosX=me-1-this.tailPosX,t&&(this.color=(1+this.color)%2),this.direction){case 2:this.direction=3;break;case 3:this.direction=2;break;case 6:this.direction=7;break;case 7:this.direction=6;break;case 4:this.direction=5;break;case 5:this.direction=4;break}return this}getAngle(){return this.direction>=1e3?Math.abs(this.direction%1e3%360-360):qt[this.direction]||0}hasMappingExtensions(){return this.posY>2||this.posY<0||this.posX<=-1e3||this.posX>=1e3||this.direction>=1e3&&this.direction<=1360}isValid(){return!(this.hasMappingExtensions()||this.isInverse())}};let Er=mt;Er.default={b:0,c:0,x:0,y:0,d:0,tb:0,tx:0,ty:0,sc:1,s:1,customData:()=>({})};const _e=class extends Re{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var i,a,r;return e.push(new _e({b:(i=n.b)!=null?i:_e.default.b,o:(a=n.o)!=null?a:_e.default.o,customData:(r=n.customData)!=null?r:_e.default.customData()}))}),e.length===1?e[0]:e.length?e:new _e({b:_e.default.b,o:_e.default.o,customData:_e.default.customData()})}toObject(){return{b:this.time,o:this.toggle,customData:yt(this.customData)}}get toggle(){return this.data.o}set toggle(t){this.data.o=t}};let fi=_e;fi.default={b:0,o:!1,customData:()=>({})};const Dt=class extends Qr{constructor(t){super(t),this.hasNoodleExtensions=()=>{var e,n,i,a,r,l,s,o,f,h,m,p;return Array.isArray((e=this.customData)==null?void 0:e.animation)||typeof((n=this.customData)==null?void 0:n.disableNoteGravity)=="boolean"||typeof((i=this.customData)==null?void 0:i.disableNoteLook)=="boolean"||Array.isArray((a=this.customData)==null?void 0:a.flip)||typeof((r=this.customData)==null?void 0:r.uninteractable)=="boolean"||Array.isArray((l=this.customData)==null?void 0:l.localRotation)||typeof((s=this.customData)==null?void 0:s.noteJumpMovementSpeed)=="number"||typeof((o=this.customData)==null?void 0:o.noteJumpStartBeatOffset)=="number"||Array.isArray((f=this.customData)==null?void 0:f.coordinates)||Array.isArray((h=this.customData)==null?void 0:h.worldRotation)||typeof((m=this.customData)==null?void 0:m.worldRotation)=="number"||typeof((p=this.customData)==null?void 0:p.track)=="string"}}static create(...t){const e=[];return t==null||t.forEach(n=>{var i,a,r,l,s,o,f;return e.push(new Dt({b:(i=n.b)!=null?i:Dt.default.b,x:(a=n.x)!=null?a:Dt.default.x,y:(r=n.y)!=null?r:Dt.default.y,c:(l=n.c)!=null?l:Dt.default.c,d:(s=n.d)!=null?s:Dt.default.d,a:(o=n.a)!=null?o:Dt.default.a,customData:(f=n.customData)!=null?f:Dt.default.customData()}))}),e.length===1?e[0]:e.length?e:new Dt({b:Dt.default.b,x:Dt.default.x,y:Dt.default.y,c:Dt.default.c,d:Dt.default.d,a:Dt.default.a,customData:Dt.default.customData()})}toObject(){return{b:this.time,c:this.color,x:this.posX,y:this.posY,d:this.direction,a:this.angleOffset,customData:yt(this.customData)}}get color(){return this.data.c}set color(t){this.data.c=t}get direction(){return this.data.d}set direction(t){this.data.d=t}get angleOffset(){return this.data.a}set angleOffset(t){this.data.a=t}setColor(t){return this.color=t,this}setDirection(t){return this.direction=t,this}setAngleOffset(t){return this.angleOffset=t,this}swapRotation(t,e=!0){const n=t.direction;t.direction=this.direction,this.direction=n;const i=t.angleOffset;return t.angleOffset=this.angleOffset,this.angleOffset=i,e&&(t.angleOffset=0-t.angleOffset,this.angleOffset=0-this.angleOffset),this}getPosition(){return[(this.posX<=-1e3?this.posX/1e3:this.posX>=1e3?this.posX/1e3:this.posX)-2,this.posY<=-1e3?this.posY/1e3:this.posY>=1e3?this.posY/1e3:this.posY]}getAngle(){return this.direction>=1e3?Math.abs(this.direction%1e3%360-360):(qt[this.direction]||0)+this.angleOffset}getDistance(t){const[e,n]=this.getPosition(),[i,a]=t.getPosition();return Math.sqrt(Math.pow(i-e,2)+Math.pow(a-n,2))}isRed(){return this.color===0}isBlue(){return this.color===1}isVertical(t){if(t){const[e]=this.getPosition(),[n]=t.getPosition(),i=e-n;return i>-.001&&i<.001}return 22.5<=Math.abs(this.getAngle())%180+90&&Math.abs(this.getAngle())%180+90<=67.5}isHorizontal(t){if(t){const[e,n]=this.getPosition(),[i,a]=t.getPosition(),r=n-a;return r>-.001&&r<.001}return 22.5<=Math.abs(this.getAngle())%180+90&&Math.abs(this.getAngle())%180+90<=67.5}isDiagonal(t){if(t){const[e,n]=this.getPosition(),[i,a]=t.getPosition(),r=Math.abs(e-i),l=Math.abs(n-a);return r===l}return 22.5<=Math.abs(this.getAngle())%90&&Math.abs(this.getAngle())%90<=67.5}isInline(t,e=.5){return this.getDistance(t)<=e}isDouble(t,e=.01){return t.time>this.time-e&&t.time<this.time+e&&this.color!==t.color}isAdjacent(t){const e=this.getDistance(t);return e>.499&&e<1.001}isWindow(t,e=1.8){return this.getDistance(t)>e}isSlantedWindow(t){return this.isWindow(t)&&!this.isDiagonal(t)&&!this.isHorizontal(t)&&!this.isVertical(t)}hasMappingExtensions(){return this.posX>3||this.posX<0||this.posY>2||this.posY<0||this.direction>=1e3&&this.direction<=1360||this.direction>=2e3&&this.direction<=2360}isValidDirection(){return this.direction>=0&&this.direction<=8}isValid(){return!this.hasMappingExtensions()&&this.isValidDirection()}};let _n=Dt;_n.default={b:0,c:0,x:0,y:0,d:0,a:0,customData:()=>({})};class Fl extends Re{get groupID(){return this.data.g}set groupID(e){this.data.g=e}}class cs extends Fl{constructor(e,n){super(e),this.e=n}toObject(){return{b:this.time,g:this.groupID,e:this.events.map(e=>e.toObject()),customData:yt(this.customData)}}get events(){return this.e}set events(e){this.e=e}}const dn=class extends Xt{constructor(t){super(t),this.data.f===1&&(this.p0=this.p0?this.p0:1)}static create(t={}){var e,n,i,a;return new dn({f:(e=t.f)!=null?e:dn.default.f,p:(n=t.p)!=null?n:dn.default.p,t:(i=t.t)!=null?i:dn.default.t,r:(a=t.r)!=null?a:dn.default.r})}toObject(){return{f:this.type,p:this.p0,t:this.p1,r:this.reverse}}get type(){return this.data.f}set type(t){this.data.f=t}get p0(){return this.data.p}set p0(t){this.data.p=t}get p1(){return this.data.t}set p1(t){this.data.t=t}get reverse(){return this.data.r}set reverse(t){this.data.r=t}};let de=dn;de.default={f:1,p:0,t:0,r:0};class us extends Xt{constructor(e){super(e),this.f=de.create(e.f)}get filter(){return this.f}set filter(e){this.f=e}get beatDistribution(){return this.data.w}set beatDistribution(e){this.data.w=e}get beatDistributionType(){return this.data.d}set beatDistributionType(e){this.data.d=e}setFilter(e){return this.filter=e,this}setBeatDistribution(e){return this.beatDistribution=e,this}setBeatDistributionType(e){return this.beatDistributionType=e,this}}const Pt=class extends Xt{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var i,a,r,l,s;return e.push(new Pt({b:(i=n.b)!=null?i:Pt.default.b,i:(a=n.i)!=null?a:Pt.default.i,c:(r=n.c)!=null?r:Pt.default.c,s:(l=n.s)!=null?l:Pt.default.s,f:(s=n.f)!=null?s:Pt.default.f}))}),e.length===1?e[0]:e.length?e:new Pt({b:Pt.default.b,i:Pt.default.i,c:Pt.default.c,s:Pt.default.s,f:Pt.default.f})}toObject(){return{b:this.time,i:this.transition,c:this.color,s:this.brightness,f:this.frequency}}get time(){return this.data.b}set time(t){this.data.b=t}get transition(){return this.data.i}set transition(t){this.data.i=t}get color(){return this.data.c}set color(t){this.data.c=t}get brightness(){return this.data.s}set brightness(t){this.data.s=t}get frequency(){return this.data.f}set frequency(t){this.data.f=t}};let hs=Pt;hs.default={b:0,i:0,c:0,s:1,f:0};const Ct=class extends us{constructor(t){super(t),this.e=t.e.map(n=>hs.create(n));const e=Math.max(...this.e.map(n=>n.time));this.beatDistributionType===2&&(this.beatDistribution=this.beatDistribution<e?e:this.beatDistribution)}static create(...t){const e=[];return t==null||t.forEach(n=>{var i,a,r,l,s,o,f;return e.push(new Ct({f:(i=n.f)!=null?i:Ct.default.f(),w:(a=n.w)!=null?a:Ct.default.w,d:(r=n.d)!=null?r:Ct.default.d,r:(l=n.r)!=null?l:Ct.default.r,t:(s=n.t)!=null?s:Ct.default.t,b:(o=n.b)!=null?o:Ct.default.b,e:(f=n.e)!=null?f:Ct.default.e()}))}),e.length===1?e[0]:e.length?e:new Ct({f:Ct.default.f(),w:Ct.default.w,d:Ct.default.d,r:Ct.default.r,t:Ct.default.t,b:Ct.default.b,e:Ct.default.e()})}toObject(){return{f:this.filter.toObject(),w:this.beatDistribution,d:this.beatDistributionType,r:this.brightnessDistribution,t:this.brightnessDistributionType,b:this.affectFirst,e:this.events.map(t=>t.toObject())}}get brightnessDistribution(){return this.data.r}set brightnessDistribution(t){this.data.r=t}get brightnessDistributionType(){return this.data.t}set brightnessDistributionType(t){this.data.t=t}get affectFirst(){return this.data.b}set affectFirst(t){this.data.b=t?1:0}get events(){return this.e}set events(t){this.e=t}};let ds=Ct;ds.default={f:()=>({f:de.default.f,p:de.default.p,t:de.default.t,r:de.default.r}),w:0,d:1,r:0,t:1,b:0,e:()=>[]};const ee=class extends cs{constructor(t){super(t,t.e.map(e=>ds.create(e)))}static create(...t){const e=[];return t==null||t.forEach(n=>{var i,a,r,l;return e.push(new ee({b:(i=n.b)!=null?i:ee.default.b,g:(a=n.g)!=null?a:ee.default.g,e:(r=n.e)!=null?r:ee.default.e(),customData:(l=n.customData)!=null?l:ee.default.customData()}))}),e.length===1?e[0]:e.length?e:new ee({b:ee.default.b,g:ee.default.g,e:ee.default.e(),customData:ee.default.customData()})}};let xr=ee;xr.default={b:0,g:0,e:()=>[],customData:()=>({})};const $t=class extends Xt{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var i,a,r,l,s,o;return e.push(new $t({b:(i=n.b)!=null?i:$t.default.b,p:(a=n.p)!=null?a:$t.default.p,e:(r=n.e)!=null?r:$t.default.e,l:(l=n.l)!=null?l:$t.default.l,r:(s=n.r)!=null?s:$t.default.r,o:(o=n.o)!=null?o:$t.default.o}))}),e.length===1?e[0]:e.length?e:new $t({b:$t.default.b,p:$t.default.p,e:$t.default.e,l:$t.default.l,r:$t.default.r,o:$t.default.o})}toObject(){return{b:this.time,p:this.previous,e:this.ease,l:this.loop,r:this.rotation,o:this.direction}}get time(){return this.data.b}set time(t){this.data.b=t}get previous(){return this.data.p}set previous(t){this.data.p=t}get ease(){return this.data.e}set ease(t){this.data.e=t}get loop(){return this.data.l}set loop(t){this.data.l=t}get rotation(){return this.data.r}set rotation(t){this.data.r=t}get direction(){return this.data.o}set direction(t){this.data.o=t}};let fs=$t;fs.default={b:0,p:0,e:0,l:0,r:0,o:0};const _t=class extends us{constructor(t){super(t),this.l=t.l.map(n=>fs.create(n));const e=Math.max(...this.l.map(n=>n.time));this.beatDistributionType===2&&(this.beatDistribution=this.beatDistribution<e?e:this.beatDistribution)}static create(...t){const e=[];return t==null||t.forEach(n=>{var i,a,r,l,s,o,f,h,m;return e.push(new _t({f:(i=n.f)!=null?i:_t.default.f(),w:(a=n.w)!=null?a:_t.default.w,d:(r=n.d)!=null?r:_t.default.d,s:(l=n.s)!=null?l:_t.default.s,t:(s=n.t)!=null?s:_t.default.t,a:(o=n.a)!=null?o:_t.default.a,r:(f=n.r)!=null?f:_t.default.r,b:(h=n.b)!=null?h:_t.default.b,l:(m=n.l)!=null?m:_t.default.l()}))}),e.length===1?e[0]:e.length?e:new _t({f:_t.default.f(),w:_t.default.w,d:_t.default.d,s:_t.default.s,t:_t.default.t,a:_t.default.a,r:_t.default.r,b:_t.default.b,l:_t.default.l()})}toObject(){return{f:this.filter.toObject(),w:this.beatDistribution,d:this.beatDistributionType,s:this.rotationDistribution,t:this.rotationDistributionType,a:this.axis,r:this.flip,b:this.affectFirst,l:this.events.map(t=>t.toObject())}}get rotationDistribution(){return this.data.s}set rotationDistribution(t){this.data.s=t}get rotationDistributionType(){return this.data.t}set rotationDistributionType(t){this.data.t=t}get axis(){return this.data.a}set axis(t){this.data.a=t}get flip(){return this.data.r}set flip(t){this.data.r=t?1:0}get affectFirst(){return this.data.b}set affectFirst(t){this.data.b=t?1:0}get events(){return this.l}set events(t){this.l=t}};let ms=_t;ms.default={f:()=>({f:de.default.f,p:de.default.p,t:de.default.t,r:de.default.r}),w:0,d:1,s:0,t:1,a:0,r:0,b:0,l:()=>[]};const ne=class extends cs{constructor(t){super(t,t.e.map(e=>ms.create(e)))}static create(...t){const e=[];return t==null||t.forEach(n=>{var i,a,r,l;return e.push(new ne({b:(i=n.b)!=null?i:ne.default.b,g:(a=n.g)!=null?a:ne.default.g,e:(r=n.e)!=null?r:ne.default.e(),customData:(l=n.customData)!=null?l:ne.default.customData()}))}),e.length===1?e[0]:e.length?e:new ne({b:ne.default.b,g:ne.default.g,e:ne.default.e(),customData:ne.default.customData()})}};let kr=ne;kr.default={b:0,g:0,e:()=>[],customData:()=>({})};const St=class extends Re{constructor(t){super(t),this.hasChroma=()=>{var e;return Array.isArray((e=this.customData)==null?void 0:e.color)},this.hasNoodleExtensions=()=>{var e,n,i,a,r,l,s,o,f;return Array.isArray((e=this.customData)==null?void 0:e.animation)||typeof((n=this.customData)==null?void 0:n.uninteractable)=="boolean"||Array.isArray((i=this.customData)==null?void 0:i.localRotation)||typeof((a=this.customData)==null?void 0:a.noteJumpMovementSpeed)=="number"||typeof((r=this.customData)==null?void 0:r.noteJumpStartBeatOffset)=="number"||Array.isArray((l=this.customData)==null?void 0:l.coordinates)||Array.isArray((s=this.customData)==null?void 0:s.worldRotation)||Array.isArray((o=this.customData)==null?void 0:o.size)||typeof((f=this.customData)==null?void 0:f.track)=="string"}}static create(...t){const e=[];return t==null||t.forEach(n=>{var i,a,r,l,s,o,f;return e.push(new St({b:(i=n.b)!=null?i:St.default.b,x:(a=n.x)!=null?a:St.default.x,y:(r=n.y)!=null?r:St.default.y,d:(l=n.d)!=null?l:St.default.d,w:(s=n.w)!=null?s:St.default.w,h:(o=n.h)!=null?o:St.default.h,customData:(f=n.customData)!=null?f:St.default.customData()}))}),e.length===1?e[0]:e.length?e:new St({b:St.default.b,x:St.default.x,y:St.default.y,d:St.default.d,w:St.default.w,h:St.default.h,customData:St.default.customData()})}toObject(){return{b:this.time,x:this.posX,y:this.posY,d:this.duration,w:this.width,h:this.height,customData:yt(this.customData)}}get posX(){return this.data.x}set posX(t){this.data.x=t}get posY(){return this.data.y}set posY(t){this.data.y=t}get duration(){return this.data.d}set duration(t){this.data.d=t}get width(){return this.data.w}set width(t){this.data.w=t}get height(){return this.data.h}set height(t){this.data.h=t}setPosX(t){return this.posX=t,this}setPosY(t){return this.posY=t,this}setDuration(t){return this.duration=t,this}setWidth(t){return this.width=t,this}setHeight(t){return this.height=t,this}mirror(){return this.posX=me-1-this.posX,this}isInteractive(){return this.width-this.posX>1||this.posX===1||this.posX===2}isCrouch(){return this.posY===2&&this.isInteractive()&&(this.width>2||this.width===2&&this.posX===1)}hasZero(){return this.duration===0||this.width===0||this.height===0}hasNegative(){return this.posY<0||this.duration<0||this.width<0||this.height<0}getPosition(){return[(this.posX<=-1e3?this.posX/1e3:this.posX>=1e3?this.posX/1e3:this.posX)-2,(this.posY<=-1e3?this.posY/1e3:this.posY>=1e3?this.posY/1e3:this.posY)-.5]}isLonger(t,e=0){return this.time+this.duration>t.time+t.duration+e}hasMappingExtensions(){return this.posY>2||this.posX<=-1e3||this.posX>=1e3}isValid(){return!this.hasMappingExtensions()&&!this.hasZero()&&!this.hasNegative()}};let fe=St;fe.default={b:0,x:0,y:0,d:1,w:1,h:1,customData:()=>({})};const ie=class extends Re{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var i,a,r,l;return e.push(new ie({b:(i=n.b)!=null?i:ie.default.b,e:(a=n.e)!=null?a:ie.default.e,r:(r=n.r)!=null?r:ie.default.r,customData:(l=n.customData)!=null?l:ie.default.customData()}))}),e.length===1?e[0]:e.length?e:new ie({b:ie.default.b,e:ie.default.e,r:ie.default.r,customData:ie.default.customData()})}toObject(){return{b:this.time,e:this.executionTime,r:this.rotation,customData:yt(this.customData)}}get executionTime(){return this.data.e}set executionTime(t){this.data.e=t}get rotation(){return this.data.r}set rotation(t){this.data.r=t}setExecutionTime(t){return this.executionTime=t,this}setRotation(t){return this.rotation=t,this}};let mi=ie;mi.default={b:0,e:0,r:0,customData:()=>({})};const ct=class extends ls{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var i,a,r,l,s,o,f,h,m,p,c,_,v;return e.push(new ct({b:(i=n.b)!=null?i:ct.default.b,c:(a=n.c)!=null?a:ct.default.c,x:(r=n.x)!=null?r:ct.default.x,y:(l=n.y)!=null?l:ct.default.y,d:(s=n.d)!=null?s:ct.default.d,mu:(o=n.mu)!=null?o:ct.default.mu,tb:(f=n.tb)!=null?f:ct.default.tb,tx:(h=n.tx)!=null?h:ct.default.tx,ty:(m=n.ty)!=null?m:ct.default.ty,tc:(p=n.tc)!=null?p:ct.default.tc,tmu:(c=n.tmu)!=null?c:ct.default.tmu,m:(_=n.m)!=null?_:ct.default.m,customData:(v=n.customData)!=null?v:ct.default.customData()}))}),e.length===1?e[0]:e.length?e:new ct({b:ct.default.b,c:ct.default.c,x:ct.default.x,y:ct.default.y,d:ct.default.d,mu:ct.default.mu,tb:ct.default.tb,tx:ct.default.tx,ty:ct.default.ty,tc:ct.default.tc,tmu:ct.default.tmu,m:ct.default.m,customData:ct.default.customData()})}toObject(){return{b:this.time,c:this.color,x:this.posX,y:this.posY,d:this.direction,mu:this.lengthMultiplier,tb:this.tailTime,tx:this.tailPosX,ty:this.tailPosY,tc:this.tailDirection,tmu:this.tailLengthMultiplier,m:this.midAnchor,customData:yt(this.customData)}}get lengthMultiplier(){return this.data.mu}set lengthMultiplier(t){this.data.mu=t}get tailLengthMultiplier(){return this.data.tmu}set tailLengthMultiplier(t){this.data.tmu=t}get tailDirection(){return this.data.tc}set tailDirection(t){this.data.tc=t}get midAnchor(){return this.data.m}set midAnchor(t){this.data.m=t}setLengthMultiplier(t){return this.lengthMultiplier=t,this}setTailLengthMultiplier(t){return this.tailLengthMultiplier=t,this}setTailDirection(t){return this.tailDirection=t,this}setMidAnchor(t){return this.midAnchor=t,this}mirror(t=!0){switch(this.posX=me-1-this.posX,this.tailPosX=me-1-this.tailPosX,t&&(this.color=(1+this.color)%2),this.direction){case 2:this.direction=3;break;case 3:this.direction=2;break;case 6:this.direction=7;break;case 7:this.direction=6;break;case 4:this.direction=5;break;case 5:this.direction=4;break}switch(this.tailDirection){case 2:this.tailDirection=3;break;case 3:this.tailDirection=2;break;case 6:this.tailDirection=7;break;case 7:this.tailDirection=6;break;case 4:this.tailDirection=5;break;case 5:this.tailDirection=4;break}return this.midAnchor&&(this.midAnchor=this.midAnchor===1?2:1),this}getAngle(){return this.direction>=1e3?Math.abs(this.direction%1e3%360-360):qt[this.direction]||0}hasMappingExtensions(){return this.posY>2||this.posY<0||this.posX<=-1e3||this.posX>=1e3||this.direction>=1e3&&this.direction<=1360||this.tailDirection>=1e3&&this.tailDirection<=1360}isValid(){return!(this.hasMappingExtensions()||this.isInverse())}};let pi=ct;pi.default={b:0,c:0,x:0,y:0,d:0,mu:.5,tb:0,tx:0,ty:0,tc:0,tmu:.5,m:1,customData:()=>({})};const Nt=class extends Re{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var i,a,r,l,s;return e.push(new Nt({b:(i=n.b)!=null?i:Nt.default.b,x:(a=n.x)!=null?a:Nt.default.x,y:(r=n.y)!=null?r:Nt.default.y,d:(l=n.d)!=null?l:Nt.default.d,customData:(s=n.customData)!=null?s:Nt.default.customData()}))}),e.length===1?e[0]:e.length?e:new Nt({b:Nt.default.b,x:Nt.default.x,y:Nt.default.y,d:Nt.default.d,customData:Nt.default.customData()})}toObject(){return{b:this.time,x:this.posX,y:this.posY,d:this.direction,customData:yt(this.customData)}}get posX(){return this.data.x}set posX(t){this.data.x=t}get posY(){return this.data.y}set posY(t){this.data.y=t}get direction(){return this.data.d}set direction(t){this.data.d=t}setPosX(t){return this.posX=t,this}setPosY(t){return this.posY=t,this}setDirection(t){return this.direction=t,this}mirror(){switch(this.posX=me-1-this.posX,this.direction){case 2:this.direction=3;break;case 3:this.direction=2;break;case 6:this.direction=7;break;case 7:this.direction=6;break;case 4:this.direction=5;break;case 5:this.direction=4;break}return this}};let gi=Nt;gi.default={b:0,x:0,y:0,d:1,customData:()=>({})};class Oi extends Xt{constructor(e){var n,i,a,r,l,s,o,f,h,m,p,c,_,v,g,b,y,x,T,D,j,N,Y,B,U,K,k,A;super(e),this.nps=u=>{const S=this.getNoteContainer().filter(J=>J.type!=="bomb");return u?S.length/u:0},this.peak=(u,S)=>{let J=0,z=0;const it=typeof S=="number"?S:S.value,X=this.getNoteContainer().filter(Q=>Q.type!=="bomb");for(let Q=0;Q<X.length;Q++){for(;X[Q].data.time-X[z].data.time>u;)z++;J=Math.max(J,(Q-z+1)/(u/it*60))}return J},this.getFirstInteractiveTime=()=>{const u=this.getNoteContainer().filter(z=>z.type!=="bomb");let S=Number.MAX_VALUE;u.length>0&&(S=u[0].data.time);const J=this.findFirstInteractiveObstacleTime();return Math.min(S,J)},this.getLastInteractiveTime=()=>{const u=this.getNoteContainer().filter(z=>z.type!=="bomb");let S=0;u.length>0&&(S=u[u.length-1].data.time);const J=this.findLastInteractiveObstacleTime();return Math.max(S,J)},this.findFirstInteractiveObstacleTime=()=>{for(let u=0,S=this.obstacles.length;u<S;u++)if(this.obstacles[u].isInteractive())return this.obstacles[u].time;return Number.MAX_VALUE},this.findLastInteractiveObstacleTime=()=>{let u=0;for(let S=this.obstacles.length-1;S>=0;S--)this.obstacles[S].isInteractive()&&(u=Math.max(u,this.obstacles[S].time+this.obstacles[S].duration));return u},this.getNoteContainer=()=>{const u=[];return this.colorNotes.forEach(S=>u.push({type:"note",data:S})),this.sliders.forEach(S=>u.push({type:"slider",data:S})),this.burstSliders.forEach(S=>u.push({type:"burstSlider",data:S})),this.bombNotes.forEach(S=>u.push({type:"bomb",data:S})),u.sort((S,J)=>S.data.time-J.data.time)},this.getEventContainer=()=>{const u=[];return this.basicBeatmapEvents.forEach(S=>u.push({type:"basicEvent",data:S})),this.colorBoostBeatmapEvents.forEach(S=>u.push({type:"boost",data:S})),u.sort((S,J)=>S.data.time-J.data.time)},this.addBPMEvents=(...u)=>{u.forEach(S=>{this.bpmEvents.push(di.create(S))})},this.addRotationEvents=(...u)=>{u.forEach(S=>{this.rotationEvents.push(mi.create(S))})},this.addColorNotes=(...u)=>{u.forEach(S=>{this.colorNotes.push(_n.create(S))})},this.addBombNotes=(...u)=>{u.forEach(S=>{this.bombNotes.push(hi.create(S))})},this.addObstacles=(...u)=>{u.forEach(S=>{this.obstacles.push(fe.create(S))})},this.addSliders=(...u)=>{u.forEach(S=>{this.sliders.push(pi.create(S))})},this.addBurstSliders=(...u)=>{u.forEach(S=>{this.burstSliders.push(Er.create(S))})},this.addWaypoints=(...u)=>{u.forEach(S=>{this.waypoints.push(gi.create(S))})},this.addBasicBeatmapEvents=(...u)=>{u.forEach(S=>{this.basicBeatmapEvents.push(ui.create(S))})},this.addColorBoostBeatmapEvents=(...u)=>{u.forEach(S=>{this.colorBoostBeatmapEvents.push(fi.create(S))})},this.addLightColorEventBoxGroups=(...u)=>{u.forEach(S=>{this.lightColorEventBoxGroups.push(xr.create(S))})},this.addLightRotationEventBoxGroups=(...u)=>{u.forEach(S=>{this.lightRotationEventBoxGroups.push(kr.create(S))})},this.version=(n=e.version)!=null?n:"3.0.0",this.bpmEvents=(a=(i=e.bpmEvents)==null?void 0:i.map(u=>di.create(u)))!=null?a:[],this.rotationEvents=(l=(r=e.rotationEvents)==null?void 0:r.map(u=>mi.create(u)))!=null?l:[],this.colorNotes=(o=(s=e.colorNotes)==null?void 0:s.map(u=>_n.create(u)))!=null?o:[],this.bombNotes=(h=(f=e.bombNotes)==null?void 0:f.map(u=>hi.create(u)))!=null?h:[],this.obstacles=(p=(m=e.obstacles)==null?void 0:m.map(u=>fe.create(u)))!=null?p:[],this.sliders=(_=(c=e.sliders)==null?void 0:c.map(u=>pi.create(u)))!=null?_:[],this.burstSliders=(g=(v=e.burstSliders)==null?void 0:v.map(u=>Er.create(u)))!=null?g:[],this.waypoints=(y=(b=e.waypoints)==null?void 0:b.map(u=>gi.create(u)))!=null?y:[],this.basicBeatmapEvents=(T=(x=e.basicBeatmapEvents)==null?void 0:x.map(u=>ui.create(u)))!=null?T:[],this.colorBoostBeatmapEvents=(j=(D=e.colorBoostBeatmapEvents)==null?void 0:D.map(u=>fi.create(u)))!=null?j:[],this.lightColorEventBoxGroups=(Y=(N=e.lightColorEventBoxGroups)==null?void 0:N.map(u=>xr.create(u)))!=null?Y:[],this.lightRotationEventBoxGroups=(U=(B=e.lightRotationEventBoxGroups)==null?void 0:B.map(u=>kr.create(u)))!=null?U:[],this.basicEventTypesWithKeywords=(K=Kr.create(e.basicEventTypesWithKeywords))!=null?K:{d:[]},this.useNormalEventsAsCompatibleEvents=(k=e.useNormalEventsAsCompatibleEvents)!=null?k:!1,this.customData=(A=e.customData)!=null?A:{}}static create(e={}){var n,i,a,r,l,s,o,f,h,m,p,c,_,v,g;return new Oi({version:e.version||"3.0.0",bpmEvents:(n=e.bpmEvents)!=null?n:[],rotationEvents:(i=e.rotationEvents)!=null?i:[],colorNotes:(a=e.colorNotes)!=null?a:[],bombNotes:(r=e.bombNotes)!=null?r:[],obstacles:(l=e.obstacles)!=null?l:[],sliders:(s=e.sliders)!=null?s:[],burstSliders:(o=e.burstSliders)!=null?o:[],waypoints:(f=e.waypoints)!=null?f:[],basicBeatmapEvents:(h=e.basicBeatmapEvents)!=null?h:[],colorBoostBeatmapEvents:(m=e.colorBoostBeatmapEvents)!=null?m:[],lightColorEventBoxGroups:(p=e.lightColorEventBoxGroups)!=null?p:[],lightRotationEventBoxGroups:(c=e.lightRotationEventBoxGroups)!=null?c:[],basicEventTypesWithKeywords:(_=e.basicEventTypesWithKeywords)!=null?_:{d:[]},useNormalEventsAsCompatibleEvents:(v=e.useNormalEventsAsCompatibleEvents)!=null?v:!1,customData:(g=e.customData)!=null?g:{}})}toObject(){return{version:this.version||"3.0.0",bpmEvents:this.bpmEvents.map(e=>e.toObject()),rotationEvents:this.rotationEvents.map(e=>e.toObject()),colorNotes:this.colorNotes.map(e=>e.toObject()),bombNotes:this.bombNotes.map(e=>e.toObject()),obstacles:this.obstacles.map(e=>e.toObject()),sliders:this.sliders.map(e=>e.toObject()),burstSliders:this.burstSliders.map(e=>e.toObject()),waypoints:this.waypoints.map(e=>e.toObject()),basicBeatmapEvents:this.basicBeatmapEvents.map(e=>e.toObject()),colorBoostBeatmapEvents:this.colorBoostBeatmapEvents.map(e=>e.toObject()),lightColorEventBoxGroups:this.lightColorEventBoxGroups.map(e=>e.toObject()),lightRotationEventBoxGroups:this.lightRotationEventBoxGroups.map(e=>e.toObject()),basicEventTypesWithKeywords:this.basicEventTypesWithKeywords.toObject(),useNormalEventsAsCompatibleEvents:this.useNormalEventsAsCompatibleEvents,customData:yt(this.customData)}}}const lo=t=>`[convert::${t.name}]`,Dr=(t,e)=>{var i,a,r,l,s;if(e)nt.warn(lo(Dr),"Converting beatmap v2 to v3 may lose certain data!");else{if(console.warn("Converting beatmap v2 to v3 may lose certain data!"),prompt("Proceed with conversion? (Y/N):","n")[0].toLowerCase()!=="y")throw Error("Conversion to beatmap v3 denied.");nt.info(lo(Dr),"Converting beatmap v2 to v3")}const n=Oi.create();if(t.notes.forEach((o,f)=>{var m,p;let h;if(o.customData&&(h={color:o.customData._color,coordinates:o.customData._position,disableNoteGravity:o.customData._disableNoteGravity,disableNoteLook:o.customData._disableNoteLook,flip:o.customData._flip,localRotation:o.customData._localRotation,noteJumpMovementSpeed:o.customData._noteJumpMovementSpeed,noteJumpStartBeatOffset:o.customData._noteJumpStartBeatOffset,spawnEffect:typeof o.customData._disableSpawnEffect=="boolean"?!o.customData._disableSpawnEffect:void 0,track:o.customData._track,uninteractable:typeof o.customData._interactable=="boolean"?!o.customData._interactable:void 0,worldRotation:o.customData._rotation},o.customData._animation&&(h.animation={color:o.customData._animation._color,definitePosition:o.customData._animation._definitePosition,dissolve:o.customData._animation._dissolve,dissolveArrow:o.customData._animation._dissolveArrow,interactable:o.customData._animation._interactable,localRotation:o.customData._animation._localRotation,offsetPosition:o.customData._animation._position,offsetRotation:o.customData._animation._rotation,scale:o.customData._animation._scale,time:o.customData._animation._time}),typeof o.customData._fake=="boolean"&&nt.warn(`notes${f} at time ${o.time} NE _fake will be removed.`),typeof o.customData._cutDirection=="number"&&nt.debug(`notes${f} at time ${o.time} NE _cutDirection will be converted.`)),o.isBomb()&&n.bombNotes.push(hi.create({b:o.time,x:o.lineIndex,y:o.lineLayer,customData:h})),o.isNote()){let c=0;typeof((m=o.customData)==null?void 0:m._cutDirection)=="number"&&(c=o.customData._cutDirection>0?o.customData._cutDirection%360:360+o.customData._cutDirection%360),o.cutDirection>=1e3&&(c=Math.abs(o.cutDirection%1e3%360-360)),n.colorNotes.push(_n.create({b:o.time,c:o.type,x:o.lineIndex,y:o.lineLayer,d:o.cutDirection>=1e3||typeof((p=o.customData)==null?void 0:p._cutDirection)=="number"?o.cutDirection===8?8:1:wl(o.cutDirection,0,8),a:c,customData:h}))}}),t.obstacles.forEach((o,f)=>{let h;o.customData&&(h={color:o.customData._color,coordinates:o.customData._position,localRotation:o.customData._localRotation,noteJumpMovementSpeed:o.customData._noteJumpMovementSpeed,noteJumpStartBeatOffset:o.customData._noteJumpStartBeatOffset,size:o.customData._scale,track:o.customData._track,uninteractable:typeof o.customData._interactable=="boolean"?!o.customData._interactable:void 0,worldRotation:o.customData._rotation},o.customData._animation&&(h.animation={color:o.customData._animation._color,definitePosition:o.customData._animation._definitePosition,dissolve:o.customData._animation._dissolve,dissolveArrow:o.customData._animation._dissolveArrow,interactable:o.customData._animation._interactable,localRotation:o.customData._animation._localRotation,offsetPosition:o.customData._animation._position,offsetRotation:o.customData._animation._rotation,scale:o.customData._animation._scale,time:o.customData._animation._time}),typeof o.customData._fake=="boolean"&&nt.warn(`obstacles${f} at time ${o.time} NE _fake will be removed.`)),n.obstacles.push(fe.create({b:o.time,x:o.lineIndex,y:o.type===2?o.lineLayer:o.type?2:0,d:o.duration,w:o.width,h:o.type===2?o.height:o.type?3:5,customData:h}))}),t.events.forEach((o,f)=>{var h,m,p;if(o.isColorBoost())n.colorBoostBeatmapEvents.push(fi.create({b:o.time,o:!!o.value}));else if(o.isLaneRotationEvent())n.rotationEvents.push(mi.create({b:o.time,e:o.type===14?0:1,r:typeof((h=o.customData)==null?void 0:h._rotation)=="number"?o.customData._rotation:o.value>=1e3?(o.value-1360)%360:(m=Pl[o.value])!=null?m:0}));else if(o.isBPMChangeEvent())n.bpmEvents.push(di.create({b:o.time,m:o.floatValue}));else{let c;if(o.customData&&(o.isLightEvent()&&(c={color:o.customData._color,lightID:o.customData._lightID,easing:o.customData._easing,lerpType:o.customData._lerpType},o.customData._propID&&nt.warn(`events${f} at time ${o.time} Chroma _propID will be removed.`),o.customData._lightGradient&&nt.warn(`events${f} at time ${o.time} Chroma _lightGradient will be removed.`)),o.isRingEvent()&&(c={nameFilter:o.customData._nameFilter,rotation:o.customData._rotation,step:o.customData._step,prop:o.customData._prop,speed:o.customData._speed,direction:o.customData._direction},o.customData._reset&&nt.warn(`events${f} at time ${o.time} Chroma _reset will be removed.`),o.customData._counterSpin&&nt.warn(`events${f} at time ${o.time} Chroma _counterSpin will be removed.`),(o.customData._stepMult||o.customData._propMult||o.customData._speedMult)&&nt.warn(`events${f} at time ${o.time} Chroma _mult will be removed.`)),o.isLaserRotationEvent())){const _=(p=o.customData._preciseSpeed)!=null?p:o.customData._speed;c={lockPosition:o.customData._lockPosition,direction:o.customData._direction,speed:_}}n.basicBeatmapEvents.push(ui.create({b:o.time,et:o.type,i:o.value,f:o.floatValue,customData:c}))}}),t.waypoints.forEach(o=>{n.waypoints.push(gi.create({b:o.time,x:o.lineIndex,y:o.lineLayer,d:o.direction}))}),t.sliders.forEach(o=>n.sliders.push(pi.create({c:o.colorType,b:o.headTime,x:o.headLineIndex,y:o.headLineLayer,d:o.headCutDirection,mu:o.headLengthMultiplier,tb:o.tailTime,tx:o.tailLineIndex,ty:o.tailLineLayer,tc:o.tailCutDirection,tmu:o.tailLengthMultiplier,m:o.midAnchor}))),n.basicEventTypesWithKeywords=Kr.create({d:(r=(a=(i=t.specialEventsKeywordFilters)==null?void 0:i.keywords)==null?void 0:a.map(o=>({k:o.keyword,e:o.events})))!=null?r:[]}),t.customData)for(const o in t.customData){if(o==="_customEvents"){n.customData.customEvents=(l=t.customData._customEvents.map(f=>({b:f._time,t:f._type,d:f._data})))!=null?l:[];continue}if(o==="_environment"){n.customData.environment=(s=t.customData._environment.map(f=>{var h,m;return{id:f._id,lookupMethod:f._lookupMethod,track:f._track,duplicate:f._duplicate,active:f._active,scale:f._scale,position:(h=f._position)==null?void 0:h.map(p=>p*.6),rotation:f._rotation,localPosition:(m=f._localPosition)==null?void 0:m.map(p=>p*.6),localRotation:f._localRotation,lightID:f._lightID}}))!=null?s:[];continue}n.customData[o]=t.customData[o]}return n};var ps=(t=>(t[t.Easy=1]="Easy",t[t.Normal=3]="Normal",t[t.Hard=5]="Hard",t[t.Expert=7]="Expert",t[t.ExpertPlus=9]="ExpertPlus",t))(ps||{}),gs=(t=>(t.id="Ct",t.lookupMethod="Lm",t.duplicate="D",t.active="A",t.scale="S",t.position="P",t.localPosition="Lp",t.rotation="R",t.localRotation="Lr",t.lightID="Li",t.track="T",t))(gs||{});const Xi=t=>`[shared::parse::${t.name}]`,ei=t=>(nt.info(Xi(ei),"Parsing beatmap info v2.x.x"),t._difficultyBeatmapSets.sort((e,n)=>dr[e._beatmapCharacteristicName]-dr[n._beatmapCharacteristicName]),t._difficultyBeatmapSets.forEach(e=>{let n=0;e._difficultyBeatmaps.forEach(i=>{i._difficultyRank-n<=0&&nt.warn(Xi(ei),i._difficulty+" is unordered"),ps[i._difficulty]!==i._difficultyRank&&nt.error(Xi(ei),i._difficulty+" has invalid rank"),n=i._difficultyRank}),e._difficultyBeatmaps.sort((i,a)=>i._difficultyRank-a._difficultyRank)}),t),co=t=>`[shared::dataCheck::${t.name}]`,Ke=(t,e,n,i)=>{if(nt.verbose(co(Ke),`Looking up ${n}`),Array.isArray(t)){t.forEach((r,l)=>Ke(r,e,n+l,i));return}const a=Object.keys(e);for(const r in t){if(!a.length)break;a.includes(r)||nt.warn(co(Ke),`Foreign property ${r} found in ${n}`)}for(const r in e){if(typeof t[r]=="undefined"){if(e[r].optional||jl(i,e[r].version)==="old")continue;throw Error(`Missing ${r} in property ${n}!`)}if(t[r]==null)throw Error(`${r} contain null value in property ${n}!`);if(e[r].type==="array"){if(!Array.isArray(t[r]))throw Error(`${r} is not an array in property ${n}!`);Ke(t[r],e[r].check,`${n} ${r}`,i)}if(e[r].type==="object"){if(!Array.isArray(t[r])&&typeof t[r]!="object")throw Error(`${r} is not an object in property ${n}!`);Ke(t[r],e[r].check,`${n} ${r}`,i)}if(e[r].type!=="array"&&typeof t[r]!==e[r].type)throw Error(`${r} is not ${e[r].type} in property ${n}!`)}},zl={_time:{type:"number",version:"2.0.0"},_type:{type:"number",version:"2.0.0"},_lineIndex:{type:"number",version:"2.0.0"},_lineLayer:{type:"number",version:"2.0.0"},_cutDirection:{type:"number",version:"2.0.0"},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},Hl={_colorType:{type:"number",version:"2.0.0"},_headTime:{type:"number",version:"2.0.0"},_headLineIndex:{type:"number",version:"2.0.0"},_headLineLayer:{type:"number",version:"2.0.0"},_headCutDirection:{type:"number",version:"2.0.0"},_headControlPointlengthMultiplier:{type:"number",version:"2.0.0"},_tailTime:{type:"number",version:"2.0.0"},_tailLineIndex:{type:"number",version:"2.0.0"},_tailLineLayer:{type:"number",version:"2.0.0"},_tailCutDirection:{type:"number",version:"2.0.0"},_tailControlPointLengthMultiplier:{type:"number",version:"2.0.0"},_sliderMidAnchorMode:{type:"number",version:"2.0.0"}},Xl={_time:{type:"number",version:"2.0.0"},_lineIndex:{type:"number",version:"2.0.0"},_lineLayer:{type:"number",version:"2.6.0"},_type:{type:"number",version:"2.0.0"},_duration:{type:"number",version:"2.0.0"},_width:{type:"number",version:"2.0.0"},_height:{type:"number",version:"2.6.0"},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},Ul={_time:{type:"number",version:"2.0.0"},_type:{type:"number",version:"2.0.0"},_value:{type:"number",version:"2.0.0"},_floatValue:{type:"number",version:"2.5.0"},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},Yl={_time:{type:"number",version:"2.2.0"},_lineIndex:{type:"number",version:"2.2.0"},_lineLayer:{type:"number",version:"2.2.0"},_offsetDirection:{type:"number",version:"2.2.0"},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},Wl={_keyword:{type:"string",version:"2.4.0"},_specialEvents:{type:"number",version:"2.4.0"}},ql={_keywords:{type:"array",version:"2.4.0",check:Wl}},Vl={_version:{type:"string",version:"2.0.0"},_notes:{type:"array",version:"2.0.0",check:zl},_sliders:{type:"array",version:"2.6.0",check:Hl},_obstacles:{type:"array",version:"2.0.0",check:Xl},_events:{type:"array",version:"2.0.0",check:Ul},_waypoints:{type:"array",version:"2.2.0",check:Yl},_specialEventsKeywordFilters:{type:"object",version:"2.4.0",check:ql,optional:!0},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},uo=t=>`[v2::parse::${t.name}]`,Cr=t=>{var e,n,i,a,r,l;return nt.info(uo(Cr),"Parsing beatmap difficulty v2.x.x"),(e=t._version)!=null&&e.startsWith("2")||(nt.warn(uo(Cr),"Unidentified beatmap version"),t._version="2.0.0"),Ke(t,Vl,"difficulty",t._version),t._notes=(n=t._notes)!=null?n:[],t._sliders=(i=t._sliders)!=null?i:[],t._obstacles=(a=t._obstacles)!=null?a:[],t._events=(r=t._events)!=null?r:[],t._waypoints=(l=t._waypoints)!=null?l:[],t._notes.sort((s,o)=>s._time-o._time),t._sliders.sort((s,o)=>s._headTime-o._headTime),t._obstacles.sort((s,o)=>s._time-o._time),t._events.sort((s,o)=>s._time-o._time),t._waypoints.sort((s,o)=>s._time-o._time),Jr.create(t)},Gl={b:{type:"number",version:"3.0.0"},c:{type:"number",version:"3.0.0"},x:{type:"number",version:"3.0.0"},y:{type:"number",version:"3.0.0"},d:{type:"number",version:"3.0.0"},a:{type:"number",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Zl={b:{type:"number",version:"3.0.0"},x:{type:"number",version:"3.0.0"},y:{type:"number",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Jl={b:{type:"number",version:"3.0.0"},c:{type:"number",version:"3.0.0"},x:{type:"number",version:"3.0.0"},y:{type:"number",version:"3.0.0"},d:{type:"number",version:"3.0.0"},mu:{type:"number",version:"3.0.0"},tb:{type:"number",version:"3.0.0"},tx:{type:"number",version:"3.0.0"},ty:{type:"number",version:"3.0.0"},tc:{type:"number",version:"3.0.0"},tmu:{type:"number",version:"3.0.0"},m:{type:"number",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Kl={b:{type:"number",version:"3.0.0"},c:{type:"number",version:"3.0.0"},x:{type:"number",version:"3.0.0"},y:{type:"number",version:"3.0.0"},d:{type:"number",version:"3.0.0"},tb:{type:"number",version:"3.0.0"},tx:{type:"number",version:"3.0.0"},ty:{type:"number",version:"3.0.0"},sc:{type:"number",version:"3.0.0"},s:{type:"number",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Ql={b:{type:"number",version:"3.0.0"},x:{type:"number",version:"3.0.0"},y:{type:"number",version:"3.0.0"},d:{type:"number",version:"3.0.0"},w:{type:"number",version:"3.0.0"},h:{type:"number",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},tc={b:{type:"number",version:"3.0.0"},et:{type:"number",version:"3.0.0"},i:{type:"number",version:"3.0.0"},f:{type:"number",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},ec={b:{type:"number",version:"3.0.0"},m:{type:"number",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},nc={b:{type:"number",version:"3.0.0"},e:{type:"number",version:"3.0.0"},r:{type:"number",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},ic={b:{type:"number",version:"3.0.0"},o:{type:"boolean",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},bs={f:{type:"number",version:"3.0.0"},p:{type:"number",version:"3.0.0"},t:{type:"number",version:"3.0.0"},r:{type:"number",version:"3.0.0"}},rc={b:{type:"number",version:"3.0.0"},i:{type:"number",version:"3.0.0"},c:{type:"number",version:"3.0.0"},s:{type:"number",version:"3.0.0"},f:{type:"number",version:"3.0.0"}},ac={f:{type:"object",version:"3.0.0",check:bs},w:{type:"number",version:"3.0.0"},d:{type:"number",version:"3.0.0"},r:{type:"number",version:"3.0.0"},t:{type:"number",version:"3.0.0"},e:{type:"array",version:"3.0.0",check:rc},b:{type:"number",version:"3.0.0"}},oc={b:{type:"number",version:"3.0.0"},g:{type:"number",version:"3.0.0"},e:{type:"array",version:"3.0.0",check:ac},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},sc={b:{type:"number",version:"3.0.0"},p:{type:"number",version:"3.0.0"},e:{type:"number",version:"3.0.0"},l:{type:"number",version:"3.0.0"},r:{type:"number",version:"3.0.0"},o:{type:"number",version:"3.0.0"}},lc={f:{type:"object",version:"3.0.0",check:bs},w:{type:"number",version:"3.0.0"},d:{type:"number",version:"3.0.0"},s:{type:"number",version:"3.0.0"},t:{type:"number",version:"3.0.0"},a:{type:"number",version:"3.0.0"},l:{type:"array",version:"3.0.0",check:sc},r:{type:"number",version:"3.0.0"},b:{type:"number",version:"3.0.0"}},cc={b:{type:"number",version:"3.0.0"},g:{type:"number",version:"3.0.0"},e:{type:"array",version:"3.0.0",check:lc},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},uc={k:{type:"string",version:"3.0.0"},e:{type:"number",version:"3.0.0"}},hc={d:{type:"array",version:"3.0.0",check:uc,optional:!0}},dc={b:{type:"number",version:"3.0.0"},d:{type:"number",version:"3.0.0"},x:{type:"number",version:"3.0.0"},y:{type:"number",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},fc={version:{type:"string",version:"3.0.0"},bpmEvents:{type:"array",version:"3.0.0",check:ec,optional:!0},rotationEvents:{type:"array",version:"3.0.0",check:nc,optional:!0},colorNotes:{type:"array",version:"3.0.0",check:Gl,optional:!0},bombNotes:{type:"array",version:"3.0.0",check:Zl,optional:!0},obstacles:{type:"array",version:"3.0.0",check:Ql,optional:!0},sliders:{type:"array",version:"3.0.0",check:Jl,optional:!0},burstSliders:{type:"array",version:"3.0.0",check:Kl,optional:!0},waypoints:{type:"array",version:"3.0.0",check:dc,optional:!0},basicBeatmapEvents:{type:"array",version:"3.0.0",check:tc,optional:!0},colorBoostBeatmapEvents:{type:"array",version:"3.0.0",check:ic,optional:!0},lightColorEventBoxGroups:{type:"array",version:"3.0.0",check:oc,optional:!0},lightRotationEventBoxGroups:{type:"array",version:"3.0.0",check:cc,optional:!0},basicEventTypesWithKeywords:{type:"object",version:"3.0.0",check:hc},useNormalEventsAsCompatibleEvents:{type:"boolean",version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},ho=t=>`[v3::parse::${t.name}]`,Yt=(t,e)=>t.b-e.b,Sr=t=>{var e,n,i,a,r,l,s,o,f,h,m,p;return nt.info(ho(Sr),"Parsing beatmap difficulty v3.x.x"),t.version!=="3.0.0"&&(nt.warn(ho(Sr),"Unidentified beatmap version"),t.version="3.0.0"),Ke(t,fc,"difficulty",t.version),t.bpmEvents=(e=t.bpmEvents)!=null?e:[],t.rotationEvents=(n=t.rotationEvents)!=null?n:[],t.colorNotes=(i=t.colorNotes)!=null?i:[],t.bombNotes=(a=t.bombNotes)!=null?a:[],t.obstacles=(r=t.obstacles)!=null?r:[],t.sliders=(l=t.sliders)!=null?l:[],t.burstSliders=(s=t.burstSliders)!=null?s:[],t.waypoints=(o=t.waypoints)!=null?o:[],t.basicBeatmapEvents=(f=t.basicBeatmapEvents)!=null?f:[],t.colorBoostBeatmapEvents=(h=t.colorBoostBeatmapEvents)!=null?h:[],t.lightColorEventBoxGroups=(m=t.lightColorEventBoxGroups)!=null?m:[],t.lightRotationEventBoxGroups=(p=t.lightRotationEventBoxGroups)!=null?p:[],t.bpmEvents.sort(Yt),t.rotationEvents.sort(Yt),t.colorNotes.sort(Yt),t.bombNotes.sort(Yt),t.obstacles.sort(Yt),t.sliders.sort(Yt),t.burstSliders.sort(Yt),t.waypoints.sort(Yt),t.basicBeatmapEvents.sort(Yt),t.colorBoostBeatmapEvents.sort(Yt),t.lightColorEventBoxGroups.sort(Yt),t.lightRotationEventBoxGroups.sort(Yt),Oi.create(t)},ji="UI Info: ",Lr=document.querySelector(".info__level-author"),Tr=document.querySelector(".info__environment"),ni=document.querySelector(".info__editors"),ii=document.querySelector(".info__contributors"),bi=document.querySelector(".info__contributors-select"),mc=document.querySelector(".info__contributors-image"),_s=document.querySelector(".info__contributors-name"),ys=document.querySelector(".info__contributors-role"),$r=document.querySelector(".info__version"),Mr=document.querySelector(".info__time-spend"),Rr=document.querySelector(".info__custom-color"),Br=document.querySelector(".info__requirements"),Ir=document.querySelector(".info__suggestions"),Ar=document.querySelector(".info__information"),Pr=document.querySelector(".info__warnings"),Nr=document.querySelector(".info__bookmarks"),Or=document.querySelector(".info__bpm-changes"),jr=document.querySelector(".info__environment-enhancement"),Fr=document.querySelector(".info__point-definitions"),zr=document.querySelector(".info__custom-events");if(!Lr||!Tr||!ni)throw new Error(ji+"info component is missing part");if(!ii||!_s||!ys)throw new Error(ji+"contributors component is missing part");if(bi)bi.addEventListener("change",vc);else throw new Error(ji+"contributors select is missing");if(!$r||!Mr||!Rr||!Br||!Ir||!Ar||!Pr||!Nr||!Or||!jr||!Fr||!zr)throw new Error(ji+"table info component is missing part");const ta=t=>{if(!t){Lr.textContent="";return}Lr.textContent="Mapped by "+t},ea=t=>{if(!t){Tr.textContent="";return}Tr.textContent=(Nl[t]||"Unknown")+" Environment"},na=t=>{if(!t||!t._lastEditedBy){ni.classList.add("hidden");return}ni.classList.remove("hidden");const e=t._lastEditedBy||"Undefined";let n="Last edited on "+e;if(t[e]){const i=t[e];n+=" v"+i.version}ni.textContent=n},pc=t=>{mc.src=t||"./img/unknown.jpg"},gc=t=>{_s.textContent=t},bc=t=>{ys.textContent=t},ia=t=>{pc(t._base64?"data:image;base64,"+t._base64:null),gc(t._name),bc(t._role)},vs=t=>{if(ii&&(!t||!t.length)){ii.classList.add("hidden"),lr(bi);return}if(t){ii.classList.remove("hidden");let e=!0;t.forEach((n,i)=>{e&&(e=!1,ia(n));const a=document.createElement("option");a.value=i.toString(),a.text=n._name+" -- "+n._role,bi.add(a)})}},Zt=t=>{const e=t.querySelector(".info__table-element");e&&(e.innerHTML=""),t.classList.add("hidden")},Jt=(t,e)=>{const n=t.querySelector(".info__table-element");if(n){for(;n.firstChild;)n.removeChild(n.firstChild);typeof e=="string"?n.textContent=e:(e.forEach(i=>{if(typeof i=="string"){let a=document.createElement("span");a.textContent=i,n.appendChild(a),n.appendChild(document.createElement("br"))}else n.appendChild(i),n.appendChild(document.createElement("br"))}),n.lastChild&&n.removeChild(n.lastChild))}t.classList.remove("hidden")},_i=t=>{if(t==null){Zt($r);return}Jt($r,t)},ra=t=>{if(t==null){Zt(Mr);return}Jt(Mr,kl(t))},aa=(t,e)=>{var o,f,h,m,p,c,_,v,g;if(!t||!t._colorLeft&&!t._colorRight&&!t._envColorLeft&&!t._envColorLeftBoost&&!t._envColorRight&&!t._envColorRightBoost&&!t._obstacleColor){Zt(Rr);return}e||(e="DefaultEnvironment");let n={_colorLeft:xt((o=jt[Ot[e]])==null?void 0:o._colorLeft)||null,_colorRight:xt((f=jt[Ot[e]])==null?void 0:f._colorRight)||null,_envColorLeft:xt((h=jt[Ot[e]])==null?void 0:h._envColorLeft)||null,_envColorRight:xt((m=jt[Ot[e]])==null?void 0:m._envColorRight)||null,_envColorLeftBoost:xt((p=jt[Ot[e]])==null?void 0:p._envColorLeftBoost)||null,_envColorRightBoost:xt((c=jt[Ot[e]])==null?void 0:c._envColorRightBoost)||null,_obstacleColor:xt((_=jt[Ot[e]])==null?void 0:_._obstacleColor)||null};t._colorLeft&&(n._colorLeft=xt(t._colorLeft)),t._colorRight&&(n._colorRight=xt(t._colorRight)),t._envColorLeft?n._envColorLeft=xt(t._envColorLeft):t._colorLeft&&(n._envColorLeft=xt(t._colorLeft)),t._envColorRight?n._envColorRight=xt(t._envColorRight):t._colorRight&&(n._envColorRight=xt(t._colorRight));let i,a,r=!1;t._envColorLeftBoost?(i=xt(t._envColorLeftBoost),r=!0):i=xt((v=jt[Ot[e]])==null?void 0:v._envColorLeftBoost)||n._envColorLeft,t._envColorRightBoost?(a=xt(t._envColorRightBoost),r=!0):a=xt((g=jt[Ot[e]])==null?void 0:g._envColorRightBoost)||n._envColorRight,r&&(n._envColorLeftBoost=i,n._envColorRightBoost=a),t._obstacleColor&&(n._obstacleColor=xt(t._obstacleColor));const l=ti.create("max","none",!0);for(const b in n){if(!n[b])continue;const y=document.createElement("div"),x=document.createElement("div"),T=document.createElement("div"),D=document.createElement("div");x.className="info__color-dot",x.style.backgroundColor=n[b]||"#000000",T.className="info__color-text info__color-text--monospace",T.textContent=`${n[b]}`,D.className="info__color-text",D.textContent=` -- ${Il[b]}`,y.appendChild(x),y.appendChild(T),y.appendChild(D),l.appendChild(y)}Jt(Rr,[l])},oa=t=>{if(t==null||!t.length){Zt(Br);return}Jt(Br,t.join(", "))},sa=t=>{if(t==null||!t.length){Zt(Ir);return}Jt(Ir,t.join(", "))},la=t=>{if(t==null||!t.length){Zt(Ar);return}Jt(Ar,t)},ca=t=>{if(t==null||!t.length){Zt(Pr);return}Jt(Pr,t)},ua=(t,e)=>{if(t==null||!t.length){Zt(Nr);return}const n=t.map(i=>{let a=i._time,r;return e&&(a=e.adjustTime(a),r=e.toRealTime(a)),`${M(i._time,3)}${r?" | "+Wt(r):""} -- ${i._name!=""?i._name:"**EMPTY NAME**"}`});Jt(Nr,n)},ha=t=>{if(!t||!t.change.length){Zt(Or);return}const e=t.change.map(n=>{let i=M(n._newTime,3),a=t.toRealTime(n._time);return`${i} | ${Wt(a)} -- ${n._BPM}`});Jt(Or,e)},da=t=>{if(t==null||!t.length){Zt(jr);return}const e=t.map(n=>{let i=[];for(const a in n){if(a=="_lookupMethod"||a=="_id")continue;let r=gs[a];n[a]!=null&&i.push(r)}return`${n.lookupMethod} [${i.join("")}]${n.track?`(${n.track})`:""} -> ${n.id}`});Jt(jr,e)},fa=t=>{if(t==null||!t.length){Zt(Fr);return}const e=t.map(n=>`${n.name} -- ${n.points.length} point${n.points.length>1?"s":""}`);Jt(Fr,e)},ma=(t,e)=>{if(t==null||!t.length){Zt(zr);return}const n=t.map(i=>{let a=i.b,r;e&&(a=e.adjustTime(a),r=e.toRealTime(a));let l=[];for(const s in i.d)s=="_duration"||s=="_easing"||s=="_track"||i.d[s]!=null&&l.push(s);return`${M(i.b,3)}${r?" | "+Wt(r):""} -- ${i.t} -> [${l.join("")}]${i.t!=="AssignTrackParent"?`(${i.d.track})`:""}`});Jt(zr,n)},_c=t=>{var e;Mt.setSongName(t._songName),Mt.setSongSubname(t._songSubName),Mt.setSongAuthor(t._songAuthorName),Mt.setSongBPM(t._beatsPerMinute),ta(t._levelAuthorName),ea(t._environmentName),na((e=t._customData)==null?void 0:e._editors)},yc=t=>{var e,n,i,a,r,l,s;if(t.rawVersion===2&&_i(t.rawData._version),t.rawVersion===3&&_i(t.rawData.version),(e=t.info)!=null&&e._customData&&(aa(t.info._customData),oa(t.info._customData._requirements),sa(t.info._customData._suggestions),la(t.info._customData._information),ca(t.info._customData._warnings)),(n=t.data)!=null&&n.customData){const o=(i=rt.beatmapInfo)!=null&&i._beatsPerMinute?oe.create(rt.beatmapInfo._beatsPerMinute,t.data.customData._bpmChanges||t.data.customData._BPMChanges||t.data.customData.BPMChanges):null;ra((a=t.data.customData._time)!=null?a:t.data.customData.time),ua((r=t.data.customData._bookmarks)!=null?r:t.data.customData.bookmarks,o),ha(o),da(t.data.customData.environment),fa((l=t.data.customData._pointDefinitions)!=null?l:t.data.customData.pointDefinitions),ma((s=t.data.customData._customEvents)!=null?s:t.data.customData.customEvents,o)}};function vc(t){const e=t.target;ia(rt.contributors[parseInt(e.value)])}const wc=()=>{ta(),ea(),na(),vs(),_i(),ra(),aa(),oa(),sa(),la(),ca(),ua(),ha(),da(),fa(),ma()};var Fn={setLevelAuthor:ta,setEnvironment:ea,setEditors:na,setContributors:ia,populateContributors:vs,setVersion:_i,setTimeSpend:ra,setCustomColor:aa,setRequirements:oa,setSuggestions:sa,setInformation:la,setWarnings:ca,setBookmarks:ua,setBPMChanges:ha,setEnvironmentEnhancement:da,setPointDefinitions:fa,setCustomEvents:ma,setInfo:_c,setDiffInfoTable:yc,reset:wc};const Ec="UI Input: ";var Jn={enable:t=>{const e=document.querySelectorAll(".input-toggle");if(!e.length){console.error(Ec+"empty list, intentional or typo error?");return}e.forEach(n=>{n.disabled=!t})}};const xc="UI Loading: ",fn=document.querySelector(".loading__bar"),fo="loading__bar--error",mo="loading__bar--download",ws=document.querySelector(".loading__text");if(!fn||!ws)throw new Error(xc+"loading component is missing part");const Es=(t,e,n=100)=>{ws.textContent=e,fn.style.width=`${n}%`,t==="error"?fn.classList.add(fo):fn.classList.remove(fo),t==="download"?fn.classList.add(mo):fn.classList.remove(mo)},kc=()=>{Es("info","No map loaded",0)};var ft={status:Es,reset:kc};const po={version:1,load:{audio:!0,imageCover:!0,imageContributor:!0},sorting:!0,beatNumbering:"beattime",rounding:3,theme:"Dark",onLoad:{stats:!1},show:{info:!1,tools:!1,stats:!1,settings:!1}};var ut=new class{constructor(){this.property=yt(po),this.stringify=()=>JSON.stringify({_property:this.property}),this.init=()=>{var n;if(localStorage==null)return;const e=localStorage.getItem("settings");if(e){const i=JSON.parse(e);if(!i.version){this.clear();return}this.property=(n=i._property)!=null?n:this.property,this.save()}},this.save=()=>{localStorage&&localStorage.setItem("settings",this.stringify())},this.clear=()=>{localStorage&&localStorage.clear()},this.reset=()=>{this.property=yt(po)},this.init()}get version(){return this.property.version}get load(){return this.property.load}get sorting(){return this.property.sorting}set sorting(e){this.property.sorting=e}get beatNumbering(){return this.property.beatNumbering}set beatNumbering(e){this.property.beatNumbering=e}get rounding(){return this.property.rounding}set rounding(e){this.property.rounding=e}get theme(){return this.property.theme}set theme(e){this.property.theme=e}get onLoad(){return this.property.onLoad}get show(){return this.property.show}};const Hr={name:"Cover Image",description:"Placeholder",type:"general",order:{input:0,output:0},input:{enabled:!0,params:{}},output:{html:null},run:Dc};function Dc(){const t=new Image,e=Mt.getCoverImage(),n=[];if(bn.loading.coverImage&&e!==null?(t.src=e,t.width!==t.height&&n.push("<b>Cover image is not square:</b> resize to fit square"),(t.width<256||t.height<256)&&n.push("<b>Cover image is too small:</b> require at least 256x256")):n.push("<b>No cover image:</b> "+(ut.load.imageCover?"could not be loaded or found":"no cover image option is enabled")),n.length){const i=document.createElement("div");i.innerHTML=n.join("<br>"),Hr.output.html=i}else Hr.output.html=null}const ri={name:"Preview Time",description:"Placeholder",type:"general",order:{input:0,output:0},input:{enabled:!0,params:{}},output:{html:null},run:Cc};function Cc(t){const{audioDuration:e}=t.settings,n=document.createElement("div");e&&e<20?(n.innerHTML=`<b>Unrankable audio length:</b> too short (${Wt(e)}s)`,ri.output.html=n):bn.loading.audio?ri.output.html=null:(n.innerHTML=`<b>No audio:</b> ${ut.load.audio?"could not be loaded or not found":"no audio mode is enabled"}`,ri.output.html=n)}const Xr={name:"Preview Time",description:"Placeholder",type:"general",order:{input:0,output:0},input:{enabled:!0,params:{}},output:{html:null},run:Sc};function Sc(t){const{_previewStartTime:e,_previewDuration:n}=t.info;if(e===12&&n===10){const i=document.createElement("div");i.innerHTML="<b>Default preview time:</b> strongly recommended to set for audience's 1st impression",Xr.output.html=i}else Xr.output.html=null}const Lc=t=>Math.max(...t.map(e=>e.ebpm),0),Tc=t=>Math.max(...t.map(e=>e.ebpmSwing),0),$c=(t,e,n)=>t.direction===8&&e.direction===8&&n!==8&&(t.posX>e.posX&&(n===5||n===3||n===7)||t.posX<e.posX&&(n===6||n===2||n===4)||t.posY>e.posY&&(n===4||n===0||n===5)||t.posY<e.posY&&(n===6||n===1||n===7))||t.posX>e.posX&&(t.direction===5||t.direction===3||t.direction===7||(e.direction===5||e.direction===3||e.direction===7)&&t.direction===8)||t.posX<e.posX&&(t.direction===6||t.direction===2||t.direction===4||(e.direction===6||e.direction===2||e.direction===4)&&t.direction===8)||t.posY>e.posY&&(t.direction===4||t.direction===0||t.direction===5||(e.direction===4||e.direction===0||e.direction===5)&&t.direction===8)||t.posY<e.posY&&(t.direction===6||t.direction===1||t.direction===7||(e.direction===6||e.direction===1||e.direction===7)&&t.direction===8),Ur=(t,e,n,i=!1)=>{const[a,r]=t.getPosition(),[l,s]=e.getPosition(),o=t.getAngle(),f=e.getAngle(),h=i?540:360;let m=!1;if(t.direction!==8){const c=(or(Math.atan2(r-s,a-l))+450)%360;for(const[_,v,g]of n){const b=g!=null?g:0,y=(o+h-_+b)%360,x=(o+h+_+b)%360;if(m=v>=Math.sqrt(Math.pow(a-l,2)+Math.pow(r-s,2))&&(y<x&&y<=c&&c<=x||y>=x&&(c<=x||c>=y))||m,m)break}}let p=!1;if(e.direction!==8){const c=(or(Math.atan2(s-r,l-a))+450)%360;for(const[_,v,g]of n){const b=g!=null?g:0,y=(f+h-_+b)%360,x=(f+h+_+b)%360;if(p=v>=Math.sqrt(Math.pow(a-l,2)+Math.pow(r-s,2))&&(y<x&&y<=c&&c<=x||y>=x&&(c<=x||c>=y))||p,p)break}}return[m,p]},zn=(t,e,n,i)=>{let a,r;if(t===null||e===null)return!1;if(typeof t=="number")a=t;else{if(t.direction===8)return!1;a=t.getAngle()}if(typeof e=="number")r=e;else{if(e.direction===8)return!1;r=e.getAngle()}return i?ro(a,r,360)<=n:ro(a,r,360)>=n};class Rt{constructor(e){this.time=e.time,this.duration=e.duration,this.minSpeed=e.minSpeed,this.maxSpeed=e.maxSpeed,this.ebpm=e.ebpm,this.ebpmSwing=e.ebpmSwing,this.data=e.data}static generate(e,n){const i=[];let a=0,r=0,l,s;const o={},f={},h={0:[],1:[]};for(const m of e)m.type==="note"&&(l=0,s=Number.MAX_SAFE_INTEGER,f[m.data.color]?this.next(m,f[m.data.color],n,h[m.data.color])&&(r=this.calcEBPMBetweenObject(m.data,o[m.data.color].data,n.value),a=this.calcEBPMBetweenObject(m.data,f[m.data.color].data,n.value),l=this.calcMinSliderSpeed(h[m.data.color],n),s=this.calcMaxSliderSpeed(h[m.data.color],n),l>0&&s!==1/0||(l=0,s=0),i.push({time:o[m.data.color].data.time,duration:f[m.data.color].data.time-o[m.data.color].data.time,data:h[m.data.color],ebpm:a,ebpmSwing:r,maxSpeed:s,minSpeed:l}),o[m.data.color]=m,h[m.data.color]=[]):o[m.data.color]=m,f[m.data.color]=m,h[m.data.color].push(m));for(let m=0;m<2;m++)f[m]&&(r=0,a=0,l=this.calcMinSliderSpeed(h[m],n),s=this.calcMaxSliderSpeed(h[m],n),l>0&&s!==1/0||(l=0,s=0),i.push({time:o[m].data.time,duration:f[m].data.time-o[m].data.time,data:h[m],ebpm:a,ebpmSwing:r,maxSpeed:s,minSpeed:l}));return i}}Rt.next=(t,e,n,i)=>{if(t.type==="bomb"||e.type==="bomb")throw new Error("Invalid type");if(i&&i.length>0&&n.toRealTime(e.data.time)+.005<n.toRealTime(t.data.time)&&t.data.direction!==8){for(const a of i)if(a.type==="note"&&a.data.direction!==8&&zn(t.data,a.data,90,!1))return!0}if(i&&i.length>0){for(const a of i)if(a.type==="note"&&t.data.isInline(a.data))return!0}return t.data.isWindow(e.data)&&n.toRealTime(t.data.time-e.data.time)>.08||n.toRealTime(t.data.time-e.data.time)>.07};Rt.calcEBPMBetweenObject=(t,e,n)=>n/((t.time-e.time)*2);Rt.calcMinSliderSpeed=(t,e)=>{let n=!1,i=!1,a=0;const r=e.toRealTime(Math.max(...t.map((l,s)=>s===0?0:((t[s].data.isHorizontal(t[s-1].data)||t[s].data.isVertical(t[s-1].data))&&!n&&(n=!0,a=(t[s].data.time-t[s-1].data.time)/(t[s].data.getDistance(t[s-1].data)||1)),i=t[s].data.isDiagonal(t[s-1].data)||t[s].data.isSlantedWindow(t[s-1].data)||i,(t[s].data.time-t[s-1].data.time)/(t[s].data.getDistance(t[s-1].data)||1)))));return n&&i?e.toRealTime(a):r};Rt.calcMaxSliderSpeed=(t,e)=>{let n=!1,i=!1,a=Number.MAX_SAFE_INTEGER;const r=e.toRealTime(Math.min(...t.map((l,s)=>s===0?Number.MAX_SAFE_INTEGER:((t[s].data.isHorizontal(t[s-1].data)||t[s].data.isVertical(t[s-1].data))&&!n&&(n=!0,a=(t[s].data.time-t[s-1].data.time)/(t[s].data.getDistance(t[s-1].data)||1)),i=t[s].data.isDiagonal(t[s-1].data)||t[s].data.isSlantedWindow(t[s-1].data)||i,(t[s].data.time-t[s-1].data.time)/(t[s].data.getDistance(t[s-1].data)||1)))));return n&&i?e.toRealTime(a):r};const Mc=(t,e,n)=>{const i={left:new Array(Math.floor(e+1)).fill(0),right:new Array(Math.floor(e+1)).fill(0)};let a,r;for(const l of t){if(l.type!=="note")continue;const s=n.toRealTime(l.data.time);l.data.color===0&&(a?Rt.next(l,a,n)&&i.left[Math.floor(s)]++:i.left[Math.floor(s)]++,a=l),l.data.color===1&&(r?Rt.next(l,r,n)&&i.right[Math.floor(s)]++:i.right[Math.floor(s)]++,r=l)}return i},Ui=(t,e)=>{if(!t.length)return 0;if(t.length<e)return t.reduce((a,r)=>a+r)/t.length;let n=t.slice(0,e).reduce((a,r)=>a+r),i=n;for(let a=0;a<t.length-e;a++)n=n-t[a]+t[a+e],i=Math.max(i,n);return i/e},go=(t,e,n,i)=>{const r={characteristic:n,difficulty:i,red:{count:0,peak:0,median:0,total:0},blue:{count:0,peak:0,median:0,total:0},total:{count:0,peak:0,median:0,total:0},container:Rt.generate(t.getNoteContainer(),e)},l=Math.max(e.toRealTime(t.getLastInteractiveTime()-t.getFirstInteractiveTime()),0),s=Math.max(e.toRealTime(t.getLastInteractiveTime()),0),o=Mc(t.getNoteContainer(),s,e),f=o.left.map((c,_)=>c+o.right[_]);if(f.reduce((c,_)=>c+_)===0)return r;const h=[],m=[],p=[];for(let c=0,_=Math.ceil(f.length/10);c<_;c++){const v=c*10;let g=10;g+v>f.length&&(g=f.length-v);const b=o.left.slice(v,v+g),y=o.right.slice(v,v+g),x=f.slice(v,v+g);h.push(b.reduce((T,D)=>T+D)/g),m.push(y.reduce((T,D)=>T+D)/g),p.push(x.reduce((T,D)=>T+D)/g)}return r.red.total=o.left.reduce((c,_)=>c+_),r.red.count=o.left.reduce((c,_)=>c+_)/l,r.red.peak=Ui(o.left,10),r.red.median=Hi(h),r.blue.total=o.right.reduce((c,_)=>c+_),r.blue.count=o.right.reduce((c,_)=>c+_)/l,r.blue.peak=Ui(o.right,10),r.blue.median=Hi(m),r.total.total=r.red.total+r.blue.total,r.total.count=f.reduce((c,_)=>c+_)/l,r.total.peak=Ui(f,10),r.total.median=Hi(p),r},Rc=(t,e)=>{let n=0,i=0;for(const a of t){const r=a.total.count;if(i>0&&r>0&&(n=(1-i/r)*100),i=r>0?r:i,i>e&&n>40)return a}return null},Bc=(t,e)=>{let n=Number.MAX_SAFE_INTEGER,i=0;for(const a of t){const r=a.total.count;if(i>0&&r>0&&(n=(1-i/r)*100),i=r>0?r:i,i>e&&n<10)return a}return null},Ic=t=>{let e=0,n=Number.MAX_SAFE_INTEGER;return t.forEach(i=>{const a=i.total.count;a>0&&(e=Math.max(e,a),n=Math.min(n,a))}),e||e&&n?(1-n/e)*100:0},bo=t=>{let e=Number.MAX_SAFE_INTEGER;return t.forEach(n=>{const i=n.total.count;i>0&&(e=Math.min(e,i))}),e},Ac=t=>Math.max(...t.map(e=>e.minSpeed),0),Pc=t=>{const e=t.map(n=>n.maxSpeed).filter(n=>n!==0);return e.length?Math.min(...e):0},Bn={name:"Progression",description:"Placeholder",type:"general",order:{input:0,output:0},input:{enabled:!0,params:{}},output:{html:null},run:Nc};function Nc(t){const{audioDuration:e}=t.settings;if(!e){Bn.output.html=null;return}const n=rt.beatmapDifficulty.map(s=>s.swingAnalysis).filter(s=>s.characteristic==="Standard").sort((s,o)=>s.total.count-o.total.count);if(!n.length){Bn.output.html=null;return}const i=e<120?3.2:e<240?4.2:5.2,a=[];e<240&&bo(n)>i&&Ic(n)<60&&a.push(`<b>Minimum SPS not met (<${i}):</b> lowest is ${M(bo(n),2)}`);const r=Rc(n,i),l=Bc(n,i);if(r&&e<360&&a.push(`<b>Violates progression:</b> ${r.difficulty} exceeded 40% SPS drop`),l&&e<360&&a.push(`<b>Violates progression:</b> ${l.difficulty} has less than 10% SPS drop`),a.length){const s=document.createElement("div");s.innerHTML=a.join("<br>"),Bn.output.html=s}else Bn.output.html=null}var _o=Object.freeze(Object.defineProperty({__proto__:null,coverImage:Hr,audio:ri,previewTime:Xr,progression:Bn},Symbol.toStringTag,{value:"Module"}));const pa=450,ga=350,Xn=document.createElement("div"),Be=document.createElement("input"),ba=document.createElement("label"),Ie=document.createElement("input"),_a=document.createElement("label");ba.textContent="Effective BPM threshold: ";ba.htmlFor="input__tools-ebpm";Be.id="input__tools-ebpm";Be.className="input-toggle input--small";Be.type="number";Be.min="0";Be.value=pa.toString();Be.addEventListener("change",jc);_a.textContent=" (swing): ";_a.htmlFor="input__tools-ebpms";Ie.id="input__tools-ebpms";Ie.className="input-toggle input--small";Ie.type="number";Ie.min="0";Ie.value=ga.toString();Ie.addEventListener("change",Fc);Xn.appendChild(ba);Xn.appendChild(Be);Xn.appendChild(_a);Xn.appendChild(Ie);const Ft={name:"Effective BPM",description:"Placeholder",type:"note",order:{input:0,output:100},input:{enabled:!0,params:{ebpmThres:pa,ebpmsThres:ga},html:Xn,adjustTime:Oc},output:{html:null},run:Hc};function Oc(t){Ft.input.params.ebpmThres=M(Math.min(pa,t.value*2*1.285714),1),Ft.input.params.ebpmsThres=M(Math.min(ga,t.value*2),1),Be.value=Ft.input.params.ebpmThres.toString(),Ie.value=Ft.input.params.ebpmsThres.toString()}function jc(){Ft.input.params.ebpmThres=M(Math.abs(parseFloat(this.value)),1),this.value=Ft.input.params.ebpmThres.toString()}function Fc(){Ft.input.params.ebpmsThres=M(Math.abs(parseFloat(this.value)),1),this.value=Ft.input.params.ebpmsThres.toString()}function zc(t){const{swingAnalysis:e}=t.difficulty,{ebpmThres:n,ebpmsThres:i}=Ft.input.params,a=e.container.filter(l=>l.ebpm>n).map(l=>l.time),r=e.container.filter(l=>l.ebpmSwing>i).map(l=>l.time);return{base:a,swing:r}}function Hc(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=zc(t),{ebpmThres:n,ebpmsThres:i}=Ft.input.params,a=[];if(e.base.length&&a.push(`<b>>${n}EBPM warning [${e.base.length}]:</b> ${e.base.map(r=>M(t.settings.bpm.adjustTime(r),3)).join(", ")}`),e.swing.length&&a.push(`<b>>${i}EBPM (swing) warning [${e.swing.length}]:</b> ${e.swing.map(r=>M(t.settings.bpm.adjustTime(r),3)).join(", ")}`),a.length){const r=document.createElement("div");r.innerHTML=a.join("<br>"),Ft.output.html=r}else Ft.output.html=null}const xs=[8,6],ya=document.createElement("div"),Cn=document.createElement("input"),va=document.createElement("label");va.textContent="Acceptable beat precision: ";va.htmlFor="input__tools-prec";Cn.id="input__tools-prec";Cn.className="input-toggle input--small";Cn.type="text";Cn.value=xs.join(" ");Cn.addEventListener("change",Xc);ya.appendChild(va);ya.appendChild(Cn);const yn={name:"Acceptable Beat Precision",description:"Placeholder",type:"note",order:{input:10,output:110},input:{enabled:!0,params:{prec:[...xs]},html:ya},output:{html:null},run:Yc};function Xc(){yn.input.params.prec=this.value.trim().split(" ").map(t=>parseInt(t)).filter(t=>t>0?!Number.isNaN(t):!1),this.value=yn.input.params.prec.join(" ")}function Uc(t,e){const{bpm:n}=t,i=e.swingAnalysis.container,{prec:a}=yn.input.params;return i.map(r=>r.time).filter((r,l,s)=>!l||r!==s[l-1]).filter(r=>{if(!a.length)return!1;for(let l=0;l<a.length;l++)if((n.adjustTime(r)+.001)%(1/a[l])<.01)return!1;return!0})}function Yc(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=Uc(t.settings,t.difficulty);if(e.length){const n=document.createElement("div");n.innerHTML=`<b>Off-beat precision [${e.length}]:</b> ${e.map(i=>M(t.settings.bpm.adjustTime(i),3)).join(", ")}`,yn.output.html=n}else yn.output.html=null}const Yr=class{constructor(){}};let vt=Yr;vt.list=[];vt.create=(t,e,n,i)=>{if(t=t.trim().toLowerCase().replace(" ","-"),Yr.list.includes(t))throw new Error(t+" is already being used.");Yr.list.push(t);const a=document.createElement("div"),r=document.createElement("input"),l=document.createElement("label");return l.textContent=" "+e,l.htmlFor="input__tools-"+t,r.id="input__tools-"+t,r.className="input-toggle",r.type="checkbox",r.checked=n,r.addEventListener("change",i),a.appendChild(r),a.appendChild(l),a};const Yi="Varying Swing Speed",yi={name:Yi,description:"Placeholder",type:"note",order:{input:20,output:130},input:{enabled:!0,params:{},html:vt.create(Yi,Yi,!0,function(){yi.input.enabled=this.checked})},output:{html:null},run:qc};function Wc(t){const{swingAnalysis:e}=t;return e.container.filter(n=>Math.abs(n.minSpeed-n.maxSpeed)>.002).map(n=>n.time).filter((n,i,a)=>!i||n!==a[i-1])}function qc(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=Wc(t.difficulty);if(e.length){const n=document.createElement("div");n.innerHTML=`<b>Varying swing speed [${e.length}]:</b> ${e.map(i=>M(t.settings.bpm.adjustTime(i),3)).join(", ")}`,yi.output.html=n}else yi.output.html=null}const ks=.025,Ae=document.createElement("div"),nn=document.createElement("input"),wa=document.createElement("label"),Pe=document.createElement("input"),Ea=document.createElement("label"),Ne=document.createElement("input"),xa=document.createElement("label");let vn;wa.textContent=" Slow slider";wa.htmlFor="input__tools-slow-slider-check";nn.id="input__tools-slow-slider-check";nn.className="input-toggle";nn.type="checkbox";nn.checked=!0;nn.addEventListener("change",Gc);Ea.textContent="min speed (ms): ";Ea.htmlFor="input__tools-slow-slider-time";Pe.id="input__tools-slow-slider-time";Pe.className="input-toggle input--small";Pe.type="number";Pe.min="0";Pe.value=M(ks*1e3,1).toString();Pe.addEventListener("change",Zc);xa.textContent=" (prec): ";xa.htmlFor="input__tools-slow-slider-prec";Ne.id="input__tools-slow-slider-prec";Ne.className="input-toggle input--small";Ne.type="number";Ne.min="0";Ne.addEventListener("change",Jc);Ae.appendChild(nn);Ae.appendChild(wa);Ae.appendChild(document.createElement("br"));Ae.appendChild(Ea);Ae.appendChild(Pe);Ae.appendChild(xa);Ae.appendChild(Ne);const Vt={name:"Slow Slider",description:"Placeholder",type:"note",order:{input:21,output:120},input:{enabled:nn.checked,params:{minSpeed:ks},html:Ae,adjustTime:Vc},output:{html:null},run:Qc};function Vc(t){vn=t,Ne.value=M(1/vn.toBeatTime(Vt.input.params.minSpeed),2).toString()}function Gc(){Vt.input.enabled=this.checked}function Zc(){Vt.input.params.minSpeed=Math.abs(parseFloat(this.value))/1e3,this.value=M(Vt.input.params.minSpeed*1e3,1).toString(),vn&&(Ne.value=M(1/vn.toBeatTime(Vt.input.params.minSpeed),2).toString())}function Jc(){if(!vn){this.value="0";return}let t=M(Math.abs(parseFloat(this.value)),2)||1;Vt.input.params.minSpeed=vn.toRealTime(1/t),Pe.value=M(Vt.input.params.minSpeed*1e3,1).toString(),this.value=t.toString()}function Kc(t){const{swingAnalysis:e}=t.difficulty,{minSpeed:n}=Vt.input.params;return e.container.filter(i=>i.maxSpeed>n||i.minSpeed>n).map(i=>i.time).filter((i,a,r)=>!a||i!==r[a-1])}function Qc(t){if(!t.difficulty){console.error("Something went wrong!");return}const{minSpeed:e}=Vt.input.params,n=Kc(t);if(n.length){const i=document.createElement("div");i.innerHTML=`<b>Slow slider (>${M(e*1e3,1)}ms) [${n.length}]:</b> ${n.map(a=>M(t.settings.bpm.adjustTime(a),3)).join(", ")}`,Vt.output.html=i}else Vt.output.html=null}const Ds=.15;let wn;const Oe=document.createElement("div"),rn=document.createElement("input"),ka=document.createElement("label"),je=document.createElement("input"),Da=document.createElement("label"),xe=document.createElement("input"),Ca=document.createElement("label");ka.textContent=" Inline sharp angle";ka.htmlFor="input__tools-inline-angle-check";rn.id="input__tools-inline-angle-check";rn.className="input-toggle";rn.type="checkbox";rn.checked=!0;rn.addEventListener("change",eu);Da.textContent="max time (ms): ";Da.htmlFor="input__tools-inline-angle-time";je.id="input__tools-inline-angle-time";je.className="input-toggle input--small";je.type="number";je.min="0";je.value=M(Ds*1e3,1).toString();je.addEventListener("change",nu);Ca.textContent=" (beat): ";Ca.htmlFor="input__tools-inline-angle-beat";xe.id="input__tools-inline-angle-beat";xe.className="input-toggle input--small";xe.type="number";xe.min="0";xe.step="0.1";xe.addEventListener("change",iu);Oe.appendChild(rn);Oe.appendChild(ka);Oe.appendChild(document.createElement("br"));Oe.appendChild(Da);Oe.appendChild(je);Oe.appendChild(Ca);Oe.appendChild(xe);const re={name:"Inline Sharp Angle",description:"Placeholder",type:"note",order:{input:30,output:160},input:{enabled:rn.checked,params:{maxTime:Ds},html:Oe,adjustTime:tu},output:{html:null},run:au};function tu(t){wn=t,xe.value=M(wn.toBeatTime(re.input.params.maxTime),2).toString()}function eu(){re.input.enabled=this.checked}function nu(){re.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=M(re.input.params.maxTime*1e3,1).toString(),wn&&(xe.value=M(wn.toBeatTime(re.input.params.maxTime),2).toString())}function iu(){if(!wn){this.value="0";return}let t=M(Math.abs(parseFloat(this.value)),2)||1;re.input.params.maxTime=wn.toRealTime(t),je.value=M(re.input.params.maxTime*1e3,1).toString(),this.value=t.toString()}function ru(t){const{bpm:e}=t.settings,n=t.difficulty.noteContainer,{maxTime:i}=re.input.params,a=e.toBeatTime(i)+.001,r={},l={},s={},o={0:[],1:[],3:[]},f=[];let h=0;for(let m=0,p=n.length;m<p;m++){const c=n[m];c.type==="note"&&r[c.data.color]?Rt.next(c,r[c.data.color],e,o[c.data.color])?(s[c.data.color]&&(s[c.data.color]=null,l[c.data.color]=(l[c.data.color]+180)%360),yo(c.data,n,h,a)&&zn(c.data,l[c.data.color],90,!0)&&f.push(c.data),c.data.direction===8?s[c.data.color]=c.data:l[c.data.color]=c.data.getAngle(),o[c.data.color]=[]):(s[c.data.color]&&yo(c.data,n,h,a)&&zn(c.data,l[c.data.color],90,!0)&&(f.push(s[c.data.color]),s[c.data.color]=null),c.data.direction!==8&&(l[c.data.color]=c.data.getAngle())):c.type==="note"&&(l[c.data.color]=c.data.getAngle()),c.type==="note"&&(r[c.data.color]=c,o[c.data.color].push(c)),c.type==="bomb"&&(c.data.posY===0&&(c.data.posX===1&&(l[0]=qt[0],s[0]=null),c.data.posX===2&&(l[1]=qt[0],s[1]=null)),c.data.posY===2&&(c.data.posX===1&&(l[0]=qt[1],s[0]=null),c.data.posX===2&&(l[1]=qt[1],s[1]=null)))}return f.map(m=>m.time).filter(function(m,p,c){return!p||m!==c[p-1]})}function yo(t,e,n,i){for(let a=n;e[a].data.time<t.time;a++){const r=e[a];if(r.type==="note"&&t.isInline(r.data)&&t.time-e[a].data.time<=i)return!0}return!1}function au(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=ru(t);if(e.length){const n=document.createElement("div");n.innerHTML=`<b>Inline sharp angle [${e.length}]:</b> ${e.map(i=>M(t.settings.bpm.adjustTime(i),3)).join(", ")}`,re.output.html=n}else re.output.html=null}const Cs=.15,Ss=1;let En;const se=document.createElement("div"),an=document.createElement("input"),Sa=document.createElement("label"),on=document.createElement("input"),La=document.createElement("label"),Fe=document.createElement("input"),Ta=document.createElement("label"),ke=document.createElement("input"),$a=document.createElement("label");Sa.textContent=" shrado angle";Sa.htmlFor="input__tools-shrado-angle-check";an.id="input__tools-shrado-angle-check";an.className="input-toggle";an.type="checkbox";an.checked=!1;an.addEventListener("change",su);La.textContent="min distance: ";La.htmlFor="input__tools-shrado-angle-distance";on.id="input__tools-shrado-angle-distance";on.className="input-toggle input--small";on.type="number";on.min="0";on.value=Ss.toString();on.addEventListener("change",lu);Ta.textContent="max time (ms): ";Ta.htmlFor="input__tools-shrado-angle-time";Fe.id="input__tools-shrado-angle-time";Fe.className="input-toggle input--small";Fe.type="number";Fe.min="0";Fe.value=M(Cs*1e3,1).toString();Fe.addEventListener("change",cu);$a.textContent=" (beat): ";$a.htmlFor="input__tools-shrado-angle-beat";ke.id="input__tools-shrado-angle-beat";ke.className="input-toggle input--small";ke.type="number";ke.min="0";ke.step="0.1";ke.addEventListener("change",uu);se.appendChild(an);se.appendChild(Sa);se.appendChild(document.createElement("br"));se.appendChild(La);se.appendChild(on);se.appendChild(document.createElement("br"));se.appendChild(Ta);se.appendChild(Fe);se.appendChild($a);se.appendChild(ke);const zt={name:"shrado Angle",description:"Placeholder",type:"note",order:{input:40,output:170},input:{enabled:an.checked,params:{distance:Ss,maxTime:Cs},html:se,adjustTime:ou},output:{html:null},run:du};function ou(t){En=t,ke.value=M(En.toBeatTime(zt.input.params.maxTime),2).toString()}function su(){zt.input.enabled=this.checked}function lu(){zt.input.params.distance=Math.max(parseInt(this.value),0),this.value=zt.input.params.distance.toString()}function cu(){zt.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=M(zt.input.params.maxTime*1e3,1).toString(),En&&(ke.value=M(En.toBeatTime(zt.input.params.maxTime),2).toString())}function uu(){if(!En){this.value="0";return}let t=M(Math.abs(parseFloat(this.value)),2)||1;zt.input.params.maxTime=En.toRealTime(t),Fe.value=M(zt.input.params.maxTime*1e3,1).toString(),this.value=t.toString()}function hu(t){var m;const{bpm:e}=t.settings,{noteContainer:n}=t.difficulty,{maxTime:i,distance:a}=zt.input.params,r=e.toBeatTime(i)+.001,l={},s={},o={},f={0:[],1:[],3:[]},h=[];for(let p=0,c=n.length;p<c;p++){if(n[p].type!=="note")continue;const _=n[p];l[_.data.color]?Rt.next(_,l[_.data.color],e,f[_.data.color])?(o[_.data.color]&&(o[_.data.color]=null,s[_.data.color]=(m=Al[s[_.data.color]])!=null?m:8),_.data.getDistance(l[_.data.color].data)>=a&&vo(_.data.direction,s[_.data.color],_.data.color)&&_.data.time-l[_.data.color].data.time<=r&&h.push(_),_.data.direction===8?o[_.data.color]=_:s[_.data.color]=_.data.direction,f[_.data.color]=[]):(o[_.data.color]&&_.data.getDistance(l[_.data.color].data)>=a&&vo(_.data.direction,s[_.data.color],_.data.color)&&_.data.time-l[_.data.color].data.time<=r&&(h.push(o[_.data.color]),o[_.data.color]=null),_.data.direction!==8&&(s[_.data.color]=_.data.direction)):s[_.data.color]=_.data.direction,l[_.data.color]=_,f[_.data.color].push(_)}return h.map(p=>p.data.time).filter(function(p,c,_){return!c||p!==_[c-1]})}function vo(t,e,n){return t===8||e===8?!1:(n===0?e===7:e===6)&&t===0}function du(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=hu(t);if(e.length){const n=document.createElement("div");n.innerHTML=`<b>shrado angle [${e.length}]:</b> ${e.map(i=>M(t.settings.bpm.adjustTime(i),3)).join(", ")}`,zt.output.html=n}else zt.output.html=null}const Ls=.075,ze=document.createElement("div"),sn=document.createElement("input"),Ma=document.createElement("label"),He=document.createElement("input"),Ra=document.createElement("label"),Xe=document.createElement("input"),Ba=document.createElement("label");let xn;Ma.textContent=" Speed pause (EXPERIMENTAL)";Ma.htmlFor="input__tools-speed-pause-check";sn.id="input__tools-speed-pause-check";sn.className="input-toggle";sn.type="checkbox";sn.checked=!1;sn.addEventListener("change",mu);Ra.textContent="stream speed (ms): ";Ra.htmlFor="input__tools-speed-pause-time";He.id="input__tools-speed-pause-time";He.className="input-toggle input--small";He.type="number";He.min="0";He.value=M(Ls*1e3,1).toString();He.addEventListener("change",pu);Ba.textContent=" (prec): ";Ba.htmlFor="input__tools-speed-pause-prec";Xe.id="input__tools-speed-pause-prec";Xe.className="input-toggle input--small";Xe.type="number";Xe.min="0";Xe.addEventListener("change",gu);ze.appendChild(sn);ze.appendChild(Ma);ze.appendChild(document.createElement("br"));ze.appendChild(Ra);ze.appendChild(He);ze.appendChild(Ba);ze.appendChild(Xe);const ae={name:"Speed Pause",description:"Placeholder",type:"note",order:{input:50,output:180},input:{enabled:sn.checked,params:{maxTime:Ls},html:ze,adjustTime:fu},output:{html:null},run:_u};function fu(t){xn=t,Xe.value=M(1/xn.toBeatTime(ae.input.params.maxTime),2).toString()}function mu(){ae.input.enabled=this.checked}function pu(){ae.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=M(ae.input.params.maxTime*1e3,1).toString(),xn&&(Xe.value=M(1/xn.toBeatTime(ae.input.params.maxTime),2).toString())}function gu(){if(!xn){this.value="0";return}let t=M(Math.abs(parseFloat(this.value)),2)||1;ae.input.params.maxTime=xn.toRealTime(1/t),He.value=M(ae.input.params.maxTime*1e3,1).toString(),this.value=t.toString()}function bu(t,e){const{bpm:n}=t,{noteContainer:i}=e,{maxTime:a}=ae.input.params,r=n.toBeatTime(a)+.001,l={},s={},o={0:!1,1:!1,3:!1},f={0:[],1:[],3:[]},h=[];for(let m=0,p=i.length;m<p;m++){if(i[m].type!=="note")continue;const c=i[m];l[c.data.color]?Rt.next(c,l[c.data.color],n,f[c.data.color])&&(c.data.time-l[c.data.color].data.time<=r*2?(o[0]&&o[1]&&l[c.data.color].data.time-s[c.data.color].data.time<=r*3&&h.push(l[c.data.color]),o[c.data.color]=!1):o[c.data.color]||(o[c.data.color]=!0,s[c.data.color]=l[c.data.color]),f[c.data.color]=[],l[c.data.color]=c):l[c.data.color]=c,f[c.data.color].push(c)}return h.map(m=>m.data.time).filter(function(m,p,c){return!p||m!==c[p-1]})}function _u(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=bu(t.settings,t.difficulty);if(e.length){const n=document.createElement("div");n.innerHTML=`<b>Speed pause [${e.length}]:</b> ${e.map(i=>M(t.settings.bpm.adjustTime(i),3)).join(", ")}`,ae.output.html=n}else ae.output.html=null}const Wi="Hitbox Staircase",vi={name:Wi,description:"Placeholder",type:"note",order:{input:70,output:190},input:{enabled:!0,params:{},html:vt.create(Wi,Wi,!0,function(){vi.input.enabled=this.checked})},output:{html:null},run:wu},yu=(t,e,n)=>{for(let i=n,a=e.length;i<a;i++)if(e[i].type==="note"){if(e[i].data.time<t.data.time+.01&&e[i].data.color!==t.data.color)return!0;if(e[i].data.time>t.data.time+.01)return!1}return!1};function vu(t){const{bpm:e}=t.settings,{noteContainer:n}=t.difficulty,i=e.toBeatTime(.15),a={},r={},l={},s={0:[],1:[],3:[]},o={0:_n.create(),1:_n.create({c:1})},f=[];for(let h=0,m=n.length;h<m;h++){if(n[h].type!=="note")continue;const p=n[h];a[p.data.color]?(Rt.next(p,a[p.data.color],e,s[p.data.color])?(l[p.data.color]=p.data.time-a[p.data.color].data.time,p.data.direction!==8?(o[p.data.color].posX=p.data.posX+Le[p.data.direction][0],o[p.data.color].posY=p.data.posY+Le[p.data.direction][1]):(o[p.data.color].posX=-1,o[p.data.color].posY=-1),s[p.data.color]=[],r[p.data.color]=p.data.direction):$c(p.data,a[p.data.color].data,r[p.data.color])&&(p.data.direction!==8?(o[p.data.color].posX=p.data.posX+Le[p.data.direction][0],o[p.data.color].posY=p.data.posY+Le[p.data.direction][1],r[p.data.color]=p.data.direction):(o[p.data.color].posX=p.data.posX+Le[r[p.data.color]][0],o[p.data.color].posY=p.data.posY+Le[r[p.data.color]][1])),a[(p.data.color+1)%2]&&p.data.time-a[(p.data.color+1)%2].data.time!==0&&p.data.time-a[(p.data.color+1)%2].data.time<Math.min(i,l[(p.data.color+1)%2])&&p.data.posX===o[(p.data.color+1)%2].posX&&p.data.posY===o[(p.data.color+1)%2].posY&&!yu(p,n,h)&&f.push(p)):(p.data.direction!==8?(o[p.data.color].posX=p.data.posX+Le[p.data.direction][0],o[p.data.color].posY=p.data.posY+Le[p.data.direction][1]):(o[p.data.color].posX=-1,o[p.data.color].posY=-1),r[p.data.color]=p.data.direction),a[p.data.color]=p,s[p.data.color].push(p)}return f.map(h=>h.data.time).filter(function(h,m,p){return!m||h!==p[m-1]})}function wu(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=vu(t);if(e.length){const n=document.createElement("div");n.innerHTML=`<b>Hitbox staircase [${e.length}]:</b> ${e.map(i=>M(t.settings.bpm.adjustTime(i),3)).join(", ")}`,vi.output.html=n}else vi.output.html=null}const qi="Hitbox Reverse Staircase",wi={name:qi,description:"Placeholder",type:"note",order:{input:71,output:191},input:{enabled:!0,params:{},html:vt.create(qi,qi,!0,function(){wi.input.enabled=this.checked})},output:{html:null},run:Du},Eu=.03414823529,xu=.03414823529;function ku(t){const{bpm:e,njs:n}=t.settings,{noteContainer:i}=t.difficulty,a={},r={0:[],1:[]},l=[];for(let s=0,o=i.length;s<o;s++){if(i[s].type!=="note")continue;const f=i[s];a[f.data.color]&&Rt.next(f,a[f.data.color],e,r[f.data.color])&&(r[f.data.color]=[]);for(const h of r[(f.data.color+1)%2])if(h.type==="note"&&h.data.direction!==8){if(!(e.toRealTime(f.data.time)>e.toRealTime(h.data.time)+.01))continue;const m=h.data.getAngle()%90>15&&h.data.getAngle()%90<75;if(n.value<1.425/(60*(f.data.time-h.data.time)/e.value+(m?xu:Eu))&&Ur(f.data,h.data,[[15,1.5]])[1]){l.push(h);break}}a[f.data.color]=f,r[f.data.color].push(f)}return l.map(s=>s.data.time).filter(function(s,o,f){return!o||s!==f[o-1]})}function Du(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=ku(t);if(e.length){const n=document.createElement("div");n.innerHTML=`<b>Hitbox reverse staircase [${e.length}]:</b> ${e.map(i=>M(t.settings.bpm.adjustTime(i),3)).join(", ")}`,wi.output.html=n}else wi.output.html=null}const Vi="Hitbox Inline",Ei={name:Vi,description:"Placeholder",type:"note",order:{input:72,output:192},input:{enabled:!0,params:{},html:vt.create(Vi,Vi,!0,function(){Ei.input.enabled=this.checked})},output:{html:null},run:Lu},Cu=0;function Su(t){const{bpm:e,njs:n}=t.settings,{noteContainer:i}=t.difficulty,a={},r={0:[],1:[],3:[]},l=[];for(let s=0,o=i.length;s<o;s++){if(i[s].type!=="note")continue;const f=i[s];a[f.data.color]&&Rt.next(f,a[f.data.color],e,r[f.data.color])&&(r[f.data.color]=[]);for(const h of r[(f.data.color+1)%2])if(h.type==="note"&&n.value<1.425/(60*(f.data.time-h.data.time)/e.value+Cu)&&f.data.isInline(h.data)){l.push(f);break}a[f.data.color]=f,r[f.data.color].push(f)}return l.map(s=>s.data.time).filter(function(s,o,f){return!o||s!==f[o-1]})}function Lu(t){const e=Su(t);if(e.length){const n=document.createElement("div");n.innerHTML=`<b>Hitbox inline [${e.length}]:</b> ${e.map(i=>M(t.settings.bpm.adjustTime(i),3)).join(", ")}`,Ei.output.html=n}else Ei.output.html=null}const Gi="Hitbox Path",xi={name:Gi,description:"Placeholder",type:"note",order:{input:74,output:190},input:{enabled:!0,params:{},html:vt.create(Gi,Gi,!0,function(){xi.input.enabled=this.checked})},output:{html:null},run:$u};function Tu(t){const{bpm:e}=t.settings,{colorNotes:n}=t.difficulty.data,i=[];let a=0;for(let r=0,l=n.length;r<l;r++)if(!(e.toRealTime(n[r].time)<a+.01))for(let s=r+1;s<l&&!(e.toRealTime(n[s].time)>e.toRealTime(n[r].time)+.01);s++)n[r].color!==n[s].color&&((n[r].isHorizontal(n[s])||n[r].isVertical(n[s]))&&Ur(n[r],n[s],[[45,1],[15,2]]).some(o=>o)||n[r].isDiagonal(n[s])&&Ur(n[r],n[s],[[45,1],[15,1.5]]).some(o=>o))&&(i.push(n[r]),a=e.toRealTime(n[r].time));return i.map(r=>r.time).filter(function(r,l,s){return!l||r!==s[l-1]})}function $u(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=Tu(t);if(e.length){const n=document.createElement("div");n.innerHTML=`<b>Hitbox path [${e.length}]:</b> ${e.map(i=>M(t.settings.bpm.adjustTime(i),3)).join(", ")}`,xi.output.html=n}else xi.output.html=null}const Zi="Improper Window Snap",ki={name:Zi,description:"Placeholder",type:"note",order:{input:60,output:185},input:{enabled:!0,params:{},html:vt.create(Zi,Zi,!0,function(){ki.input.enabled=this.checked})},output:{html:null},run:Ru};function Mu(t){const{bpm:e}=t.settings,{noteContainer:n}=t.difficulty,i={},a={0:[],1:[],3:[]},r=[];for(let l=0,s=n.length;l<s;l++){if(n[l].type!=="note")continue;const o=n[l];i[o.data.color]?Rt.next(o,i[o.data.color],e,a[o.data.color])?(i[o.data.color]=o,a[o.data.color]=[]):o.data.isSlantedWindow(i[o.data.color].data)&&o.data.time-i[o.data.color].data.time>=.001&&o.data.direction===i[o.data.color].data.direction&&o.data.direction!==8&&i[o.data.color].data.direction!==8&&r.push(i[o.data.color]):i[o.data.color]=o,a[o.data.color].push(o)}return r.map(l=>l.data.time).filter(function(l,s,o){return!s||l!==o[s-1]})}function Ru(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=Mu(t);if(e.length){const n=document.createElement("div");n.innerHTML=`<b>Improper window snap [${e.length}]:</b> ${e.map(i=>M(t.settings.bpm.adjustTime(i),3)).join(", ")}`,ki.output.html=n}else ki.output.html=null}const Ji="Double-directional",Di={name:Ji,description:"Placeholder",type:"note",order:{input:99,output:140},input:{enabled:!0,params:{},html:vt.create(Ji,Ji,!0,function(){Di.input.enabled=this.checked})},output:{html:null},run:Iu};function Bu(t,e){const{bpm:n}=t,i=e.noteContainer,a={},r={},l={},s={0:[],1:[]},o=[];for(let f=0,h=i.length;f<h;f++){const m=i[f];m.type==="note"&&a[m.data.color]?Rt.next(m,a[m.data.color],n,s[m.data.color])?(l[m.data.color]&&(l[m.data.color]=null,r[m.data.color]=(r[m.data.color]+180)%360),zn(m.data,r[m.data.color],45,!0)&&o.push(m.data),m.data.direction===8?l[m.data.color]=m.data:r[m.data.color]=m.data.getAngle(),s[m.data.color]=[]):(l[m.data.color]&&zn(m.data,r[m.data.color],45,!0)&&(o.push(m.data),l[m.data.color]=null,r[m.data.color]=m.data.getAngle()),m.data.direction!==8&&(l[m.data.color]=null,r[m.data.color]=m.data.getAngle())):m.type==="note"&&(r[m.data.color]=m.data.getAngle()),m.type==="note"&&(a[m.data.color]=m,s[m.data.color].push(m)),m.type==="bomb"&&(m.data.posY===0&&(m.data.posX===1&&(r[0]=qt[0],l[0]=null),m.data.posX===2&&(r[1]=qt[0],l[1]=null)),m.data.posY===2&&(m.data.posX===1&&(r[0]=qt[1],l[0]=null),m.data.posX===2&&(r[1]=qt[1],l[1]=null)))}return o.map(f=>f.time).filter(function(f,h,m){return!h||f!==m[h-1]})}function Iu(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=Bu(t.settings,t.difficulty);if(e.length){const n=document.createElement("div");n.innerHTML=`<b>Double-directional [${e.length}]:</b> ${e.map(i=>M(t.settings.bpm.adjustTime(i),3)).join(", ")}`,Di.output.html=n}else Di.output.html=null}const Ts=.1,$s=.5,wo={Easy:{min:.025,max:1.2},Normal:{min:.05,max:1},Hard:{min:.08,max:.75},Expert:{min:.1,max:.625},ExpertPlus:{min:.1,max:.5}};let Ht;const kt=document.createElement("div"),ln=document.createElement("input"),Ia=document.createElement("label"),cn=document.createElement("input"),Aa=document.createElement("label"),Ue=document.createElement("input"),Pa=document.createElement("label"),Ye=document.createElement("input"),Na=document.createElement("label"),De=document.createElement("input"),Oa=document.createElement("label"),pe=document.createElement("input"),ja=document.createElement("label"),le=document.createElement("input"),Fa=document.createElement("label");Ia.textContent=" Vision block";Ia.htmlFor="input__tools-vb-check";ln.id="input__tools-vb-check";ln.className="input-toggle";ln.type="checkbox";ln.checked=!0;ln.addEventListener("change",Pu);Aa.textContent=" VB time specific ";Aa.htmlFor="input__tools-vb-time-check";cn.id="input__tools-vb-time-check";cn.className="input-toggle";cn.type="radio";cn.name="input__tools-vb-spec";cn.value="time";cn.addEventListener("change",Ms);Pa.textContent=" VB difficulty specific ";Pa.htmlFor="input__tools-vb-diff-check";Ue.id="input__tools-vb-diff-check";Ue.className="input-toggle";Ue.type="radio";Ue.checked=!0;Ue.name="input__tools-vb-spec";Ue.value="difficulty";Ue.addEventListener("change",Ms);Na.textContent="min time (ms): ";Na.htmlFor="input__tools-vb-min-time";Ye.id="input__tools-vb-min-time";Ye.className="input-toggle input--small";Ye.type="number";Ye.min="0";Ye.value=M(Ts*1e3,1).toString();Ye.addEventListener("change",Nu);Oa.textContent=" (beat): ";Oa.htmlFor="input__tools-vb-min-beat";De.id="input__tools-vb-min-beat";De.className="input-toggle input--small";De.type="number";De.min="0";De.step="0.1";De.addEventListener("change",Ou);ja.textContent="max time (ms): ";ja.htmlFor="input__tools-vb-max-time";pe.id="input__tools-vb-max-time";pe.className="input-toggle input--small";pe.type="number";pe.min="0";pe.value=M($s*1e3,1).toString();pe.addEventListener("change",ju);Fa.textContent=" (beat): ";Fa.htmlFor="input__tools-vb-max-beat";le.id="input__tools-vb-max-beat";le.className="input-toggle input--small";le.type="number";le.min="0";le.step="0.1";le.addEventListener("change",Fu);kt.appendChild(ln);kt.appendChild(Ia);kt.appendChild(document.createElement("br"));kt.appendChild(cn);kt.appendChild(Aa);kt.appendChild(Ue);kt.appendChild(Pa);kt.appendChild(document.createElement("br"));kt.appendChild(Na);kt.appendChild(Ye);kt.appendChild(Oa);kt.appendChild(De);kt.appendChild(document.createElement("br"));kt.appendChild(ja);kt.appendChild(pe);kt.appendChild(Fa);kt.appendChild(le);const lt={name:"Slow Slider",description:"Placeholder",type:"note",order:{input:100,output:120},input:{enabled:ln.checked,params:{specific:"difficulty",minTime:Ts,maxTime:$s},html:kt,adjustTime:Au},output:{html:null},run:Hu};function Au(t){Ht=t,De.value=M(Ht.toBeatTime(lt.input.params.minTime),2).toString(),le.value=M(Ht.toBeatTime(lt.input.params.maxTime),2).toString()}function Pu(){lt.input.enabled=this.checked}function Ms(){lt.input.params.specific=this.value}function Nu(){lt.input.params.minTime=Math.abs(parseFloat(this.value))/1e3,this.value=M(lt.input.params.minTime*1e3,1).toString(),Ht&&(De.value=M(Ht.toBeatTime(lt.input.params.minTime),2).toString(),lt.input.params.minTime>lt.input.params.maxTime&&(lt.input.params.maxTime=lt.input.params.minTime,pe.value=M(lt.input.params.maxTime*1e3,1).toString(),le.value=M(Ht.toBeatTime(lt.input.params.maxTime),2).toString()))}function Ou(){if(!Ht){this.value="0";return}const t=Math.abs(parseFloat(this.value))||1;lt.input.params.minTime=Ht.toRealTime(t),Ye.value=M(lt.input.params.minTime*1e3,1).toString(),this.value=M(t,2).toString(),lt.input.params.minTime>lt.input.params.maxTime&&(lt.input.params.maxTime=lt.input.params.minTime,pe.value=M(lt.input.params.maxTime*1e3,1).toString(),le.value=M(Ht.toBeatTime(lt.input.params.maxTime),2).toString())}function ju(){lt.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=M(lt.input.params.maxTime*1e3,1).toString(),Ht&&(le.value=M(Ht.toBeatTime(lt.input.params.maxTime),2).toString())}function Fu(){if(!Ht){this.value="0";return}const t=Math.abs(parseFloat(this.value))||1;lt.input.params.maxTime=Ht.toRealTime(t),pe.value=M(lt.input.params.maxTime*1e3,1).toString(),this.value=M(t,2).toString()}function zu(t){const{bpm:e,njs:n}=t.settings,i=t.difficulty.data.getNoteContainer().filter(p=>p.type!=="slider"),{minTime:a,maxTime:r,specific:l}=lt.input.params,s=l==="time"?e.toBeatTime(a):e.toBeatTime(wo[t.difficulty.difficulty].min),o=l==="time"?e.toBeatTime(r):Math.min(n.hjd,e.toBeatTime(wo[t.difficulty.difficulty].max));let f=null,h=null;const m=[];for(let p=0,c=i.length;p<c;p++){const _=i[p];f&&(_.data.time-f.data.time>=s&&_.data.time-f.data.time<=o?_.data.posX<2&&m.push(_):_.data.time-f.data.time>o&&(f=null)),h&&(_.data.time-h.data.time>=s&&_.data.time-h.data.time<=o?_.data.posX>1&&m.push(_):_.data.time-h.data.time>o&&(h=null)),_.data.posY===1&&_.data.posX===1&&(f=_),_.data.posY===1&&_.data.posX===2&&(h=_)}return m.map(p=>p.data.time).filter(function(p,c,_){return!c||p!==_[c-1]})}function Hu(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=zu(t);if(e.length){const n=document.createElement("div");n.innerHTML=`<b>Vision block [${e.length}]:</b> ${e.map(i=>M(t.settings.bpm.adjustTime(i),3)).join(", ")}`,lt.output.html=n}else lt.output.html=null}const Eo="Stacked Note",Ci={name:"Stacked Note",description:"Placeholder",type:"note",order:{input:98,output:198},input:{enabled:!0,params:{},html:vt.create(Eo,Eo,!0,function(){Ci.input.enabled=this.checked})},output:{html:null},run:Yu};function Xu(t,e){const{bpm:n}=t,{colorNotes:i}=e.data,a=[];let r=0;for(let l=0,s=i.length;l<s;l++)if(!(n.toRealTime(i[l].time)<r+.01))for(let o=l+1;o<s&&!(n.toRealTime(i[o].time)>n.toRealTime(i[l].time)+.01);o++)i[o].isInline(i[l])&&(a.push(i[l]),r=n.toRealTime(i[l].time));return a.map(l=>l.time).filter(function(l,s,o){return!s||l!==o[s-1]})}function Uu(t,e){const{bpm:n,njs:i}=t,{bombNotes:a}=e.data,r=[];for(let l=0,s=a.length;l<s;l++)for(let o=l+1;o<s&&!(n.toRealTime(a[o].time)>n.toRealTime(a[l].time)+1);o++)a[l].isInline(a[o])&&(i.value<n.value/(120*(a[o].time-a[l].time))||n.toRealTime(a[o].time)<n.toRealTime(a[l].time)+.02)&&r.push(a[l]);return r.map(l=>l.time).filter(function(l,s,o){return!s||l!==o[s-1]})}function Yu(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=Xu(t.settings,t.difficulty),n=Uu(t.settings,t.difficulty),i=[];if(e.length&&i.push(`<b>Stacked note [${e.length}]:</b> ${e.map(a=>M(t.settings.bpm.adjustTime(a),3)).join(", ")}`),n.length&&i.push(`<b>Stacked bomb [${n.length}]:</b> ${n.map(a=>M(t.settings.bpm.adjustTime(a),3)).join(", ")}`),i.length){const a=document.createElement("div");a.innerHTML=i.join("<br>"),Ci.output.html=a}else Ci.output.html=null}const xo=[1,1,1],ko={1:"Indistinguishable",5:"Hardly perceivable",10:"Close apparent",20:"Mildly similar",40:"Different",90:"Discernible",100:"Opposite"},Do=(t,e)=>{var a;let n=(a=Object.keys(t).find(r=>parseFloat(r)>=e))!=null?a:"100",i=parseFloat(n);return t[i]},Ki="Color Check (EXPERIMENTAL)",Si={name:Ki,description:"Placeholder",type:"note",order:{input:97,output:45},input:{enabled:!0,params:{},html:vt.create(Ki,Ki,!0,function(){Si.input.enabled=this.checked})},output:{html:null},run:Vu};function Wu(t){var i,a,r,l,s,o,f,h;const e=(l=(a=(i=t.difficulty)==null?void 0:i.info._customData)==null?void 0:a._colorLeft)!=null?l:jt[(r=Ot[t.info._environmentName])!=null?r:"The First"]._colorLeft,n=(h=(o=(s=t.difficulty)==null?void 0:s.info._customData)==null?void 0:o._colorRight)!=null?h:jt[(f=Ot[t.info._environmentName])!=null?f:"The First"]._colorRight;return e&&n?sr(li(e),li(n)):100}function qu(t){var r,l,s,o,f,h,m,p;let e=100,n=100;const i=(o=(l=(r=t.difficulty)==null?void 0:r.info._customData)==null?void 0:l._colorLeft)!=null?o:jt[(s=Ot[t.info._environmentName])!=null?s:"The First"]._colorLeft,a=(p=(h=(f=t.difficulty)==null?void 0:f.info._customData)==null?void 0:h._colorRight)!=null?p:jt[(m=Ot[t.info._environmentName])!=null?m:"The First"]._colorRight;return i&&(e=sr(xo,li(i))),a&&(n=sr(xo,li(a))),Math.min(e,n)}function Vu(t){var a,r,l,s;if(!((r=(a=t.difficulty)==null?void 0:a.info._customData)!=null&&r._colorLeft)&&!((s=(l=t.difficulty)==null?void 0:l.info._customData)!=null&&s._colorRight))return;const e=Wu(t),n=qu(t),i=[];if(e<=20&&i.push(`<b>${Do(ko,e)} note color (dE${M(e,1)}):</b> suggest change to better differentiate between 2 note colour`),n<=20&&i.push(`<b>${Do(ko,n)} arrow note color (dE${M(n,1)}):</b> may be difficult to see the arrow`),i.length){const o=document.createElement("div");o.innerHTML=i.join("<br>"),Si.output.html=o}else Si.output.html=null}var Co=Object.freeze(Object.defineProperty({__proto__:null,effectiveBPM:Ft,acceptablePrec:yn,varySwing:yi,slowSlider:Vt,inlineAngle:re,shradoAngle:zt,speedPause:ae,hitboxStair:vi,hitboxReverseStair:wi,hitboxInline:Ei,hitboxPath:xi,improperWindow:ki,doubleDirectional:Di,visionBlock:lt,stackedNote:Ci,colorCheck:Si},Symbol.toStringTag,{value:"Module"}));const Qi="<15ms Obstacle",Hn={name:Qi,description:"Placeholder",type:"obstacle",order:{input:0,output:50},input:{enabled:!0,params:{minDur:.015},html:vt.create(Qi,Qi,!0,function(){Hn.input.enabled=this.checked})},output:{html:null},run:Zu};function Gu(t){const{obstacles:e}=t.difficulty.data,{bpm:n}=t.settings,{minDur:i}=Hn.input.params,a=n.toBeatTime(i),r=[];let l=fe.create(),s=fe.create(),o=fe.create(),f=fe.create();return e.forEach(h=>{h.posY===0&&h.height>2&&h.duration>0?h.width>2||h.width>1&&h.posX===1?(h.isLonger(l)&&(h.duration<a&&r.push(h),l=h),h.isLonger(s)&&(h.duration<a&&r.push(h),s=h)):h.width===2?h.posX===0?h.isLonger(l)&&(h.duration<a&&r.push(h),l=h):h.posX===2&&h.isLonger(s)&&(h.duration<a&&r.push(h),s=h):h.width===1&&(h.posX===1?h.isLonger(l)&&(h.duration<a&&r.push(h),l=h):h.posX===2&&h.isLonger(s)&&(h.duration<a&&r.push(h),s=h)):h.posY===2&&h.height>2&&h.duration>0&&(h.width>2||h.width>1&&h.posX===1?(h.isLonger(o)&&(h.duration<a&&h.isLonger(l,a)&&h.isLonger(o,a)&&r.push(h),o=h),h.isLonger(f)&&(h.duration<a&&h.isLonger(s,a)&&h.isLonger(f,a)&&r.push(h),f=h)):h.width===2?h.posX===0?h.isLonger(o)&&(h.duration<a&&h.isLonger(l,a)&&h.isLonger(o,a)&&r.push(h),o=h):h.posX===2&&h.isLonger(f)&&(h.duration<a&&h.isLonger(s,a)&&h.isLonger(f,a)&&r.push(h),f=h):h.width===1&&(h.posX===1?h.isLonger(o)&&(h.duration<a&&h.isLonger(l,a)&&h.isLonger(o,a)&&r.push(h),o=h):h.posX===2&&h.isLonger(f)&&(h.duration<a&&h.isLonger(s,a)&&h.isLonger(f,a)&&r.push(h),f=h)))}),r.map(h=>h.time).filter(function(h,m,p){return!m||h!==p[m-1]})}function Zu(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=Gu(t);if(e.length){const n=document.createElement("div");n.innerHTML=`<b><15ms obstacle [${e.length}]:</b> ${e.map(i=>M(t.settings.bpm.adjustTime(i),3)).join(", ")}`,Hn.output.html=n}else Hn.output.html=null}const Rs=.25;let kn;const We=document.createElement("div"),un=document.createElement("input"),za=document.createElement("label"),qe=document.createElement("input"),Ha=document.createElement("label"),Ce=document.createElement("input"),Xa=document.createElement("label");za.textContent=" 2-wide center obstacle";za.htmlFor="input__tools-center-obstacle-check";un.id="input__tools-center-obstacle-check";un.className="input-toggle";un.type="checkbox";un.checked=!0;un.addEventListener("change",Ku);Ha.textContent="recovery time (ms): ";Ha.htmlFor="input__tools-2wide-wall-time";qe.id="input__tools-2wide-wall-time";qe.className="input-toggle input--small";qe.type="number";qe.min="0";qe.value=M(Rs*1e3,1).toString();qe.addEventListener("change",Qu);Xa.textContent=" (beat): ";Xa.htmlFor="input__tools-2wide-wall-beat";Ce.id="input__tools-2wide-wall-beat";Ce.className="input-toggle input--small";Ce.type="number";Ce.min="0";Ce.step="0.1";Ce.addEventListener("change",th);We.appendChild(un);We.appendChild(za);We.appendChild(document.createElement("br"));We.appendChild(Ha);We.appendChild(qe);We.appendChild(Xa);We.appendChild(Ce);const Gt={name:"2-wide Center Obstacle",description:"Placeholder",type:"obstacle",order:{input:10,output:60},input:{enabled:un.checked,params:{recovery:Rs},html:We,adjustTime:Ju},output:{html:null},run:nh};function Ju(t){kn=t,Ce.value=M(kn.toBeatTime(Gt.input.params.recovery),2).toString()}function Ku(){Gt.input.enabled=this.checked}function Qu(){Gt.input.params.recovery=Math.abs(parseFloat(this.value))/1e3,this.value=M(Gt.input.params.recovery*1e3,1).toString(),kn&&(Ce.value=M(kn.toBeatTime(Gt.input.params.recovery),2).toString())}function th(){if(!kn){this.value="0";return}let t=M(Math.abs(parseFloat(this.value)),2)||1;Gt.input.params.recovery=kn.toRealTime(t),qe.value=M(Gt.input.params.recovery*1e3,1).toString(),this.value=t.toString()}function eh(t){const{obstacles:e}=t.difficulty.data,{bpm:n}=t.settings,{recovery:i}=Gt.input.params,a=[];let r=fe.create(),l=fe.create();return e.forEach(s=>{s.posY<2&&s.height>1&&(s.width>2&&(a.push(s),s.isLonger(r)&&(r=s),s.isLonger(l)&&(l=s)),s.width===2&&(s.posX===0&&s.isLonger(r)&&(n.toRealTime(s.time)>n.toRealTime(l.time)-i&&n.toRealTime(s.time)<n.toRealTime(l.time+l.duration)+i&&a.push(s),r=s),s.posX===1&&(a.push(s),s.isLonger(r)&&(r=s),s.isLonger(l)&&(l=s)),s.posX===2&&s.isLonger(l)&&(n.toRealTime(s.time)>n.toRealTime(r.time)-i&&n.toRealTime(s.time)<n.toRealTime(r.time+r.duration)+i&&a.push(s),l=s)),s.width===1&&(s.posX===1&&s.isLonger(r)&&(n.toRealTime(s.time)>n.toRealTime(l.time)-i&&n.toRealTime(s.time)<n.toRealTime(l.time+l.duration)+i&&a.push(s),r=s),s.posX===2&&s.isLonger(l)&&(n.toRealTime(s.time)>n.toRealTime(r.time)-i&&n.toRealTime(s.time)<n.toRealTime(r.time+r.duration)+i&&a.push(s),l=s)))}),a.map(s=>s.time).filter(function(s,o,f){return!o||s!==f[o-1]})}function nh(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=eh(t),{recovery:n}=Gt.input.params;if(e.length){const i=document.createElement("div");i.innerHTML=`<b>2-wide center obstacle (<${M(n*1e3)}ms) [${e.length}]:</b> ${e.map(a=>M(t.settings.bpm.adjustTime(a),3)).join(", ")}`,Gt.output.html=i}else Gt.output.html=null}const tr="Zero Obstacle",Li={name:tr,description:"Placeholder",type:"obstacle",order:{input:20,output:70},input:{enabled:!0,params:{},html:vt.create(tr,tr,!0,function(){Li.input.enabled=this.checked})},output:{html:null},run:rh};function ih(t){const{obstacles:e}=t.difficulty.data;return e.filter(n=>n.hasZero()).map(n=>n.time)}function rh(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=ih(t);if(e.length){const n=document.createElement("div");n.innerHTML=`<b>Zero width/duration obstacle [${e.length}]:</b> ${e.map(i=>M(t.settings.bpm.adjustTime(i),3)).join(", ")}`,Li.output.html=n}else Li.output.html=null}const er="Negative obstacle",Ti={name:er,description:"Placeholder",type:"obstacle",order:{input:30,output:80},input:{enabled:!0,params:{},html:vt.create(er,er,!0,function(){Ti.input.enabled=this.checked})},output:{html:null},run:oh};function ah(t){var n,i,a,r;const{obstacles:e}=t.difficulty.data;return((i=(n=t.difficulty.info._customData)==null?void 0:n._requirements)==null?void 0:i.includes("Mapping Extensions"))||((r=(a=t.difficulty.info._customData)==null?void 0:a._requirements)==null?void 0:r.includes("Noodle Extensions"))?[]:e.filter(l=>l.hasNegative()).map(l=>l.time)}function oh(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=ah(t);if(e.length){const n=document.createElement("div");n.innerHTML=`<b>Negative obstacle [${e.length}]:</b> ${e.map(i=>M(t.settings.bpm.adjustTime(i),3)).join(", ")}`,Ti.output.html=n}else Ti.output.html=null}var So=Object.freeze(Object.defineProperty({__proto__:null,shortObstacle:Hn,centerObstacle:Gt,zeroObstacle:Li,negativeObstacle:Ti},Symbol.toStringTag,{value:"Module"}));const Lo=" Insufficient Lighting Event",$i={name:"Insufficient Light",description:"Placeholder",type:"event",order:{input:0,output:0},input:{enabled:!0,params:{},html:vt.create(Lo,Lo,!0,function(){$i.input.enabled=this.checked})},output:{html:null},run:lh},sh=t=>{let e=0;for(let n=t.length-1;n>=0;n--)if(t[n].isLightEvent()&&!t[n].isOff()&&(e++,e>10))return!0;return!1};function lh(t){if(!t.difficulty){console.error("Something went wrong!");return}if(sh(t.difficulty.data.basicBeatmapEvents))$i.output.html=null;else{const n=document.createElement("div");n.innerHTML="<b>Insufficient lighting event</b>",$i.output.html=n}}const To=" Old value 4 event",Mi={name:"Insufficient Light",description:"Placeholder",type:"event",order:{input:1,output:1},input:{enabled:!0,params:{},html:vt.create(To,To,!0,function(){Mi.input.enabled=this.checked})},output:{html:null},run:uh};function ch(t){const{basicBeatmapEvents:e}=t.data,n=[];if(t.rawVersion===2&&t.rawData._version!=="2.5.0"&&t.rawData._version!=="2.6.0")for(let i=e.length-1;i>=0;i--)e[i].isLightEvent()&&e[i].value===4&&n.push(e[i]);else return[];return n.map(i=>i.time).filter(function(i,a,r){return!a||i!==r[a-1]})}function uh(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=ch(t.difficulty);if(e.length){const n=document.createElement("div");n.innerHTML=`<b>Event with value 4 [${e.length}]:</b> ${e.map(i=>M(t.settings.bpm.adjustTime(i),3)).join(", ")}`,Mi.output.html=n}else Mi.output.html=null}const nr="Unlit Bomb",Ri={name:nr,description:"Placeholder",type:"event",order:{input:3,output:203},input:{enabled:!0,params:{},html:vt.create(nr,nr,!0,function(){Ri.input.enabled=this.checked})},output:{html:null},run:dh},hh=(t,e,n,i)=>{var m,p,c,_;if(!e.length)return[];const a=[],r=(p=(m=ci[i])==null?void 0:m[0])!=null?p:ci.DefaultEnvironment[0],l=e.filter(v=>v.isLightEvent()&&r.includes(v.type)).sort((v,g)=>v.type-g.type),s={0:{state:"off",time:0,fadeTime:0},1:{state:"off",time:0,fadeTime:0},2:{state:"off",time:0,fadeTime:0},3:{state:"off",time:0,fadeTime:0},4:{state:"off",time:0,fadeTime:0},6:{state:"off",time:0,fadeTime:0},7:{state:"off",time:0,fadeTime:0},10:{state:"off",time:0,fadeTime:0},11:{state:"off",time:0,fadeTime:0}},o={};r.forEach(v=>o[v]=[[0,!1]]);const f=n.toBeatTime(1),h=n.toBeatTime(.25);for(let v=0,g=l.length;v<g;v++){const b=l[v];if((b.isOn()||b.isFlash())&&s[b.type].state!=="on"){s[b.type]={state:"on",time:b.time,fadeTime:0};const y=o[b.type].find(x=>x[0]>=b.time);y?(y[0]=b.time,y[1]=!0):o[b.type].push([b.time,!0])}if(b.isFade()){s[b.type]={state:"off",time:b.time,fadeTime:f};const y=o[b.type].find(x=>x[0]>=b.time);y?(y[0]=b.time,y[1]=!0):o[b.type].push([b.time,!0]),o[b.type].push([b.time+f,!1])}(((c=b==null?void 0:b.floatValue)!=null?c:1)<.25||b.isOff()||((_=b.customData)==null?void 0:_._color)&&(typeof b.customData._color[3]=="number"&&b.customData._color[3]<.25||Math.max(b.customData._color[0],b.customData._color[1],b.customData._color[2])<.25))&&s[b.type].state!=="off"&&(s[b.type]={state:"off",time:b.time,fadeTime:s[b.type].state==="on"?h:Math.min(h,s[b.type].fadeTime)},o[b.type].push([b.time+(s[b.type].state==="on"?h:Math.min(h,s[b.type].fadeTime)),!1]))}for(const v in o)o[v].reverse();for(let v=0,g=t.length,b=!1;v<g;v++){const y=t[v];b=!1;for(const x in o){const T=o[x].find(D=>D[0]<=y.time);T&&(b=b||T[1])}b||a.push(y)}return a.map(v=>v.time).filter(function(v,g,b){return!g||v!==b[g-1]})};function dh(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=hh(t.difficulty.data.bombNotes,t.difficulty.data.basicBeatmapEvents,t.settings.bpm,t.info._environmentName);if(e.length){const n=document.createElement("div");n.innerHTML=`<b>Unlit bomb [${e.length}]:</b> ${e.map(i=>M(t.settings.bpm.adjustTime(i),3)).join(", ")}`,Ri.output.html=n}else Ri.output.html=null}const $o=" Event Peak (1 second) and Per Second",Bi={name:"Insufficient Light",description:"Placeholder",type:"event",order:{input:2,output:2},input:{enabled:!1,params:{},html:vt.create($o,$o,!1,function(){Bi.input.enabled=this.checked})},output:{html:null},run:mh};function fh(t){if(!t.difficulty){console.error("Something went wrong!");return}const{bpm:e,audioDuration:n}=t.settings,{basicBeatmapEvents:i}=t.difficulty.data;let a=e.toBeatTime(1),r=0,l=0;for(let s=0;s<i.length;s++){for(;i[s].time-i[l].time>a;)l++;r=Math.max(r,(s-l+a)/(1/e.value*60))}return{EPS:n?M(i.length/n,3):0,peakEPS:M(r,3)}}function mh(t){const e=fh(t);if(e){const n=document.createElement("div");n.innerHTML=`<b>Events per second:</b> ${e.EPS}<br><b>Peak Event (1s):</b> ${e.peakEPS}`,Bi.output.html=n}else Bi.output.html=null}var Mo=Object.freeze(Object.defineProperty({__proto__:null,insufficientLight:$i,oldEventValue:Mi,unlitBomb:Ri,testEvent:Bi},Symbol.toStringTag,{value:"Module"}));const Bs=1.5,Ua=document.createElement("div"),Ve=document.createElement("input"),Ya=document.createElement("label");Ya.textContent="Hot start (s): ";Ya.htmlFor="input__tools-hot-start";Ve.id="input__tools-hot-start";Ve.className="input-toggle input--small";Ve.type="number";Ve.min="0";Ve.step="0.1";Ve.value=Bs.toString();Ve.addEventListener("change",ph);Ua.appendChild(Ya);Ua.appendChild(Ve);const gn={name:"Hot Start",description:"Placeholder",type:"other",order:{input:0,output:0},input:{enabled:!0,params:{time:Bs},html:Ua},output:{html:null},run:gh};function ph(){gn.input.params.time=M(Math.abs(parseFloat(this.value)),3),this.value=gn.input.params.time.toString()}function gh(t){if(!t.difficulty){console.error("Something went wrong!");return}const{time:e}=gn.input.params,n=t.settings.bpm.toRealTime(t.difficulty.data.getFirstInteractiveTime());if(n<e){const i=document.createElement("div");i.innerHTML=`<b>Hot start:</b> ${M(n,2)}s`,gn.output.html=i}else gn.output.html=null}const Wr={name:"Difficulty Label",description:"Placeholder",type:"other",order:{input:30,output:30},input:{enabled:!0,params:{}},output:{html:null},run:bh};function bh(t){var n;if(!t.difficulty){console.error("Something went wrong!");return}const e=(n=t.difficulty.info._customData)==null?void 0:n._difficultyLabel;if(e&&e.length>30){const i=document.createElement("div");i.innerHTML=`<b>Difficulty label is too long (${e.length} characters):</b> exceeded 30 max characters by ranking criteria`,Wr.output.html=i}else Wr.output.html=null}const qr={name:"Note Jump Speed",description:"Placeholder",type:"other",order:{input:40,output:40},input:{enabled:!0,params:{}},output:{html:null},run:_h};function _h(t){if(!t.difficulty){console.error("Something went wrong!");return}const{njs:e,bpm:n}=t.settings,i=[];if(t.difficulty.info._noteJumpMovementSpeed===0&&i.push("<b>Unset NJS</b>: fallback NJS is used"),e.value>23&&i.push(`<b>NJS is too high (${M(e.value,2)}):</b> use lower whenever necessary`),e.jd<18&&i.push(`<b>Very low jump distance:</b> ${M(e.jd,2)}`),e.jd>36&&i.push(`<b>Very high jump distance:</b> ${M(e.jd,2)}`),e.jd>e.calcJumpDistanceOptimalHigh()&&i.push(`<b>High jump distance warning (>${M(e.calcJumpDistanceOptimalHigh(),2)}):</b> ${M(e.jd,2)} at ${M(e.value,2)} NJS may be uncomfortable to play`),n.toRealTime(e.hjd)<.45&&i.push(`<b>Very quick reaction time (${M(n.toRealTime(e.hjd)*1e3)}ms):</b> may lead to suboptimal gameplay`),e.calcHalfJumpDurationRaw()+e.offset<e.hjdMin&&i.push(`<b>Unnecessary negative offset:</b> will not drop below ${e.hjdMin}`),i.length){const a=document.createElement("div");a.innerHTML=i.join("<br>"),qr.output.html=a}else qr.output.html=null}const ir="Outside Playable Object",Ii={name:ir,description:"Placeholder",type:"other",order:{input:10,output:10},input:{enabled:!0,params:{},html:vt.create(ir,ir,!0,function(){Ii.input.enabled=this.checked})},output:{html:null},run:yh};function yh(t){if(!t.difficulty){console.error("Something went wrong!");return}const{bpm:e,audioDuration:n}=t.settings,{colorNotes:i,obstacles:a,basicBeatmapEvents:r}=t.difficulty.data,l=[];if(n){let s=e.toBeatTime(n);i.length&&i[0].time<0&&l.push(`<b>Note(s) before start time:</b> ${M(i[0].time,3)} (${Wt(e.toRealTime(i[0].time))})`),a.length&&a[0].time<0&&l.push(`<b>Obstacle(s) before start time:</b> ${M(a[0].time,3)} (${Wt(e.toRealTime(a[0].time))})`),r.length&&r[0].time<0&&l.push(`<b>Event(s) before start time:</b> ${M(r[0].time,3)} (${Wt(e.toRealTime(r[0].time))})`),i.length&&i[i.length-1].time>s&&l.push(`<b>Note(s) after end time:</b> ${M(i[i.length-1].time,3)} (${Wt(e.toRealTime(i[i.length-1].time))})`),a.length&&a[a.length-1].time>s&&l.push(`<b>Obstacle(s) after end time:</b> ${M(a[a.length-1].time,3)} (${Wt(e.toRealTime(a[a.length-1].time))})`),r.length&&r[r.length-1].time>s&&l.push(`<b>Event(s) after end time:</b> ${M(r[r.length-1].time,3)} (${Wt(e.toRealTime(r[r.length-1].time))})`)}if(l.length){const s=document.createElement("div");s.innerHTML=l.join("<br>"),Ii.output.html=s}else Ii.output.html=null}const rr=" Invalid Object",Ai={name:rr,description:"Placeholder",type:"other",order:{input:20,output:20},input:{enabled:!0,params:{},html:vt.create(rr,rr,!0,function(){Ai.input.enabled=this.checked})},output:{html:null},run:vh};function vh(t){var _,v,g,b;if(!t.difficulty){console.error("Something went wrong!");return}const{bpm:e}=t.settings,{colorNotes:n,bombNotes:i,obstacles:a,basicBeatmapEvents:r,sliders:l,burstSliders:s}=t.difficulty.data;let o=[],f=[],h=[],m=[];(v=(_=t.difficulty.info._customData)==null?void 0:_._requirements)!=null&&v.includes("Mapping Extensions")||((b=(g=t.difficulty.info._customData)==null?void 0:g._requirements)!=null&&b.includes("Noodle Extensions")?(o=n.filter(y=>y.hasMappingExtensions()).map(y=>y.time),f=a.filter(y=>y.hasMappingExtensions()).map(y=>y.time),i.filter(y=>y.hasMappingExtensions()).map(y=>y.time),h=l.filter(y=>y.hasMappingExtensions()).map(y=>y.time),m=s.filter(y=>y.hasMappingExtensions()).map(y=>y.time)):(o=n.filter(y=>!y.isValid()).map(y=>y.time),f=a.filter(y=>!y.isValid()).map(y=>y.time),i.filter(y=>!y.isValid()).map(y=>y.time),h=l.filter(y=>!y.isValid()).map(y=>y.time),m=s.filter(y=>!y.isValid()).map(y=>y.time)));const p=r.filter(y=>!y.isValid()).map(y=>y.time),c=[];if(o.length&&c.push(`<b>Invalid note [${o.length}]:</b> ${o.map(y=>M(e.adjustTime(y),3)).join(", ")}`),f.length&&c.push(`<b>Invalid obstacle [${f.length}]:</b> ${f.map(y=>M(e.adjustTime(y),3)).join(", ")}`),p.length&&c.push(`<b>Invalid event [${p.length}]:</b> ${p.map(y=>M(e.adjustTime(y),3)).join(", ")}`),h.length&&c.push(`<b>Invalid slider [${h.length}]:</b> ${h.map(y=>M(e.adjustTime(y),3)).join(", ")}`),m.length&&c.push(`<b>Invalid burst slider [${m.length}]:</b> ${m.map(y=>M(e.adjustTime(y),3)).join(", ")}`),c.length){const y=document.createElement("div");y.innerHTML=c.join("<br>"),Ai.output.html=y}else Ai.output.html=null}var Ro=Object.freeze(Object.defineProperty({__proto__:null,hotStart:gn,difficultyLabel:Wr,njs:qr,outsidePlayable:Ii,invalidObject:Ai},Symbol.toStringTag,{value:"Module"}));const he=class{constructor(){}};let Se=he;Se.getNote=()=>Object.keys(Co).map(t=>Co[t]);Se.getObstacle=()=>Object.keys(So).map(t=>So[t]);Se.getEvent=()=>Object.keys(Mo).map(t=>Mo[t]);Se.getOther=()=>Object.keys(Ro).map(t=>Ro[t]);Se.getGeneral=()=>Object.keys(_o).map(t=>_o[t]);Se.getDifficulty=()=>[...he.getNote(),...he.getObstacle(),...he.getEvent(),...he.getOther()];Se.getAll=()=>[...he.getNote(),...he.getObstacle(),...he.getEvent(),...he.getOther(),...he.getGeneral()];const tn=t=>`[analyzer::${t.name}]`,Is=Se.getAll().sort((t,e)=>t.order.input-e.order.input),As=[...Is].sort((t,e)=>t.order.output-e.order.output),Ps=()=>{rt.analysis={general:{html:null},map:[]}},ai=()=>{var l,s;const t=rt.beatmapInfo;if(!t){nt.error(tn(ai),"Could not analyse, missing map info");return}rt.analysis||Ps();const e=(l=rt.analysis)==null?void 0:l.general,n=oe.create(t._beatsPerMinute),i=Te.create(n),a={bpm:n,njs:i,audioDuration:(s=rt.duration)!=null?s:null,mapDuration:0};nt.info(tn(ai),"Analysing general");const r=[];As.filter(o=>o.type==="general").forEach(o=>{if(o.input.enabled)try{o.run({settings:a,difficulties:rt.beatmapDifficulty,info:t}),o.output.html&&r.push(o.output.html)}catch(f){nt.error(tn(ai),f)}}),e&&(e.html=r)},mn=(t,e)=>{var f,h,m,p,c,_,v,g;const n=rt.beatmapInfo;if(!n){nt.error(tn(mn),"Could not analyse, missing map info");return}rt.analysis||Ps();const i=(f=rt.beatmapDifficulty)==null?void 0:f.find(b=>b.characteristic===t&&b.difficulty===e);if(!i){nt.error(tn(mn),"Could not analyse, missing map data");return}const a=(h=rt.analysis)==null?void 0:h.map.find(b=>b.difficulty===e&&b.mode===t),r=oe.create(n._beatsPerMinute,((m=i.data.customData)==null?void 0:m._BPMChanges)||((p=i.data.customData)==null?void 0:p._bpmChanges)||((c=i.data.customData)==null?void 0:c.BPMChanges),(_=i.info._customData)==null?void 0:_._editorOffset),l=Te.create(r,i.info._noteJumpMovementSpeed,i.info._noteJumpStartBeatOffset),s={bpm:r,njs:l,audioDuration:(v=rt.duration)!=null?v:null,mapDuration:r.toRealTime(i.data.getLastInteractiveTime())};nt.info(tn(mn),`Analysing ${t} ${e}`);const o=[];As.filter(b=>b.type!=="general").forEach(b=>{if(b.input.enabled)try{b.run({settings:s,difficulty:i,info:n}),b.output.html&&o.push(b.output.html)}catch(y){nt.error(tn(mn),y)}}),a?a.html=o:(g=rt.analysis)==null||g.map.push({mode:t,difficulty:e,html:o})},wh=t=>{Se.getDifficulty().sort((n,i)=>n.order.output-i.order.output).forEach(n=>{n.input.adjustTime&&n.input.adjustTime(t)})},Eh=()=>{var t;(t=rt.beatmapDifficulty)==null||t.forEach(e=>mn(e.characteristic,e.difficulty))};var Dn={toolListInput:Is,runGeneral:ai,runDifficulty:mn,adjustTime:wh,applyAll:Eh};const Ee="UI Tools: ",$e=document.querySelectorAll(".tools__select-mode"),Me=document.querySelectorAll(".tools__select-difficulty"),xh=document.querySelectorAll(".difficulty__label"),Ns=document.querySelector(".tools__note-content"),Os=document.querySelector(".tools__obstacle-content"),js=document.querySelector(".tools__event-content"),Fs=document.querySelector(".tools__other-content"),ye=document.querySelector(".tools__output-diff"),ve=document.querySelector(".tools__output-general"),Bo=document.querySelector(".tools__apply-this"),Io=document.querySelector(".tools__apply-all");if(!Ns||!Os||!js||!Fs)throw new Error(Ee+"missing content element");if(!ye||!ve)throw new Error(Ee+"missing output element");if(Bo&&Io)Bo.addEventListener("click",Mh),Io.addEventListener("click",Rh);else throw new Error(Ee+"missing apply element");$e.forEach(t=>t.addEventListener("change",Th));Me.forEach(t=>t.addEventListener("change",$h));const kh=()=>{var e;const t=(e=rt.analysis)==null?void 0:e.general;if(!t){ve.textContent="ERROR: could not find analysis for general";return}if(!t.html){ve.textContent="ERROR: could not find HTML for general";return}ve.innerHTML="",t.html.forEach(n=>ve.appendChild(n)),ve.firstChild||(ve.textContent="No issues found.")},Un=(t,e)=>{var i;if(!t&&!e&&(t=$e[0].value,e=Me[0].value),!t||!e)throw new Error(Ee+"something went wrong!");ye.innerHTML="";const n=(i=rt.analysis)==null?void 0:i.map.find(a=>a.difficulty===e&&a.mode===t);if(!n){ye.textContent="ERROR: could not find analysis for "+t+" "+e;return}if(!n.html){ye.textContent="ERROR: could not find HTML for "+t+" "+e;return}n.html.forEach(a=>ye.appendChild(a)),ye.firstChild||(ye.textContent="No issues found.")},Fi=t=>{xh.forEach(e=>e.textContent=t)},zs=t=>{if(!t)return;Me.forEach(n=>{for(let i=n.options.length-1;i>=0;i--)n.remove(i)});let e=!0;for(let n=t._difficultyBeatmaps.length-1;n>=0;n--){const i=t._difficultyBeatmaps[n];Me.forEach(a=>{var l,s,o,f;const r=document.createElement("option");if(r.value=i._difficulty,r.textContent=jn[i._difficulty]+((l=i._customData)!=null&&l._difficultyLabel?" -- "+((s=i._customData)==null?void 0:s._difficultyLabel):""),e){const h=(o=rt.beatmapDifficulty)==null?void 0:o.find(m=>m.difficulty===i._difficulty&&m.characteristic===t._beatmapCharacteristicName);if(!h)throw new Error("missing _mapSetData");Fn.setDiffInfoTable(h),Fi(((f=i._customData)==null?void 0:f._difficultyLabel)||jn[i._difficulty]),Un(t._beatmapCharacteristicName,i._difficulty)}e=!1,a.add(r)})}},Hs=t=>{if(!t){$e.forEach(n=>lr(n)),Me.forEach(n=>lr(n));return}let e=!0;t._difficultyBeatmapSets.forEach(n=>{$e.forEach(i=>{const a=document.createElement("option");a.value=n._beatmapCharacteristicName,a.textContent=Zr[n._beatmapCharacteristicName],i.add(a)}),e&&zs(n),e=!1})},Dh=()=>{const t=rt.beatmapInfo;if(!t)throw new Error(Ee+"could not find map info");const e=oe.create(t._beatsPerMinute);Dn.adjustTime(e)},Ch=()=>{Dn.toolListInput.forEach(t=>{if(t.input.html)switch(t.type){case"note":{Ns.appendChild(t.input.html);break}case"obstacle":{Os.appendChild(t.input.html);break}case"event":{js.appendChild(t.input.html);break}case"other":{Fs.appendChild(t.input.html);break}case"general":{console.log(Ee+"ignoring general tool for "+t.name);break}default:console.error(Ee+"could not recognise type "+t.type+" for "+t.name)}})},Sh=()=>{ve&&(ve.innerHTML="No output."),ye&&(ye.innerHTML="No output.")},Lh=()=>{Sh(),Fi("Difficulty Label"),Hs()};function Th(t){var i;const e=t.target;$e.forEach(a=>{a!==e&&(a.value=e.value)});const n=(i=rt.beatmapInfo)==null?void 0:i._difficultyBeatmapSets.find(a=>a._beatmapCharacteristicName===e.value);zs(n)}function $h(t){var a,r,l,s;const e=t.target;Me.forEach(o=>{o!==e&&(o.value=e.value)});const n=(a=rt.beatmapInfo)==null?void 0:a._difficultyBeatmapSets.find(o=>o._beatmapCharacteristicName===$e.item(0).value);if(!n)throw new Error("aaaaaaaaaaaaaaaaaaa");const i=(r=rt.beatmapDifficulty)==null?void 0:r.find(o=>o.difficulty===e.value&&o.characteristic===n._beatmapCharacteristicName);i&&(Fn.setDiffInfoTable(i),Fi(((s=(l=i.info)==null?void 0:l._customData)==null?void 0:s._difficultyLabel)||jn[e.value]),Un(i.characteristic,i.difficulty))}function Mh(){const t=$e[0].value,e=Me[0].value;if(!t||!e)throw new Error(Ee+"mode/difficulty does not exist");ft.status("info",`Re-analysing ${t} ${e}`,100),Dn.runDifficulty(t,e),ft.status("info",`Re-analysed ${t} ${e}`,100),Un(t,e)}function Rh(){const t=$e[0].value,e=Me[0].value;if(!t||!e)throw new Error(Ee+"mode/difficulty does not exist");ft.status("info","Re-analysing all difficulties",100),Dn.applyAll(),ft.status("info","Re-analysed all difficulties",100),Un(t,e)}var pn={displayOutputGeneral:kh,displayOutputDifficulty:Un,setDifficultyLabel:Fi,adjustTime:Dh,populateSelect:Hs,populateTool:Ch,reset:Lh},Xs={create:(t,e,n,i,...a)=>{const r=document.createElement(n);r.className=i;const l=document.createElement("select");l.className="input-toggle",l.id=t,a.forEach(o=>{const f=document.createElement("option");f.textContent=o.text,f.value=o.value,l.append(f)});const s=document.createElement("label");return s.htmlFor=t,s.innerHTML=`<span>${e}</span>`,r.append(s),r.append(l),r}};const Us=t=>{var n,i,a,r;const e={red:{total:0,chroma:0,noodleExtensions:0,mappingExtensions:0},blue:{total:0,chroma:0,noodleExtensions:0,mappingExtensions:0},bomb:{total:0,chroma:0,noodleExtensions:0,mappingExtensions:0}};for(let l=t.length-1;l>=0;l--)t[l].color===0?(e.red.total++,(((n=t[l].customData)==null?void 0:n.color)||((i=t[l].customData)==null?void 0:i.disableSpawnEffect))&&e.red.chroma++):t[l].color===1&&(e.blue.total++,(((a=t[l].customData)==null?void 0:a.color)||((r=t[l].customData)==null?void 0:r.disableSpawnEffect))&&e.blue.chroma++);return e},Kn=(t,e)=>t.filter(n=>n.data.posX===e).length,Bh=(t,e)=>t.filter(n=>n.data.posY===e).length,Ih=(t,e,n)=>t.filter(i=>i.data.posX===e&&i.data.posY===n).length,Ah=(t,e)=>t.filter(n=>n.type!=="bomb"&&n.data.direction===e).length,Ph=t=>{const e={total:0,interactive:0,chroma:0,noodleExtensions:0,mappingExtensions:0};for(let n=t.length-1;n>-1;n--)e.total++,t[n].isInteractive()&&e.interactive++,t[n].hasChroma()&&e.chroma++,t[n].hasNoodleExtensions()&&e.noodleExtensions++,t[n].hasMappingExtensions()&&e.mappingExtensions++;return e},Nh=(t,e="DefaultEnvironment")=>{var a,r;const n=(r=(a=ci[e])==null?void 0:a[0])!=null?r:ci.DefaultEnvironment[0],i={};for(let l=n.length-1;l>=0;l--)i[n[l]]={total:0,chroma:0,chromaOld:0};for(let l=t.length-1;l>=0;l--)t[l].isValidType()&&(i[t[l].type]||(i[t[l].type]={total:0,chroma:0,chromaOld:0}),i[t[l].type].total++,t[l].hasChroma()&&i[t[l].type].chroma++,t[l].hasOldChroma()&&i[t[l].type].chromaOld++);return i},Oh=115,jh=t=>{let e=0,n=1;for(let i=0,a=t.filter(r=>r.type==="note").length;i<a;i++)n<8&&i===-3+n*4&&(n*=2),e+=Oh*n;return e},en="UI Stats: ",P="stats__",oi=document.querySelector("#stats .accordion__collapsible"),Ys=(t,e)=>{const n=oe.create(t._beatsPerMinute),i=Te.create(n,e.info._noteJumpMovementSpeed||Te.FallbackNJS[e.difficulty],e.info._noteJumpStartBeatOffset),a=document.createElement("table");return a.className=P+"table",a.innerHTML=`<caption class="${P}table-caption">Map Settings:</caption>
    <tr>
    <th class="${P}table-header" colspan="2">Note Jump Speed</th>
    <td class="${P}table-element">${M(i.value,3)}</td>
    </tr>
    <tr>
    <th class="${P}table-header" colspan="2">Spawn Distance Modifier</th>
    <td class="${P}table-element">${M(i.offset,3)}</td>
    </tr>
    <tr>
    <th class="${P}table-header" colspan="2">Half Jump Duration</th>
    <td class="${P}table-element">${M(i.hjd,3)}</td>
    </tr>
    <tr>
    <th class="${P}table-header" colspan="2">Jump Distance</th>
    <td class="${P}table-element">${M(i.jd,3)}</td>
    </tr>
    <tr>
    <th class="${P}table-header" colspan="2">Reaction Time</th>
    <td class="${P}table-element">${M(i.reactTime*1e3)}ms</td>
    </tr>`,a},Ws=(t,e)=>{const n=oe.create(t._beatsPerMinute),i=rt.duration||0,a=n.toRealTime(e.data.getLastInteractiveTime()),r=document.createElement("table");return r.className=P+"table",r.innerHTML=`<caption class="${P}table-caption">Note Per Seconds (NPS):</caption>
    <tr>
    <th class="${P}table-header" colspan="2">Overall</th>
    <td class="${P}table-element">${M(e.data.nps(i),2)}</td>
    </tr>
    <tr>
    <th class="${P}table-header" colspan="2">Mapped</th>
    <td class="${P}table-element">${M(e.data.nps(a),2)}</td>
    </tr>
    <tr>
    <th class="${P}table-header" rowspan="3">Peak</th>
    <th class="${P}table-header">16-beat</th>
    <td class="${P}table-element">${M(e.data.peak(16,n.value),2)}</td>
    </tr>
    <tr>
    <th class="${P}table-header">8-beat</th>
    <td class="${P}table-element">${M(e.data.peak(8,n.value),2)}</td>
    </tr>
    <tr>
    <th class="${P}table-header">4-beat</th>
    <td class="${P}table-element">${M(e.data.peak(4,n.value),2)}</td>
    </tr>`,r},qs=(t,e)=>{const n=e.swingAnalysis,i=document.createElement("table");return i.className=P+"table",i.innerHTML=`<caption class="${P}table-caption">Swing Per Seconds (SPS):</caption>
    <tr>
    <th class="${P}table-header"></th>
    <th class="${P}table-header">Total</th>
    <th class="${P}table-header">Red</th>
    <th class="${P}table-header">Blue</th>
    </tr>
    <tr>
    <th class="${P}table-header">Count</th>
    <td class="${P}table-element">${M(n.total.count,2)}</td>
    <td class="${P}table-element">${M(n.red.count,2)}</td>
    <td class="${P}table-element">${M(n.blue.count,2)}</td>
    </tr>
    <tr>
    <th class="${P}table-header">Median</th>
    <td class="${P}table-element">${M(n.total.median,2)}</td>
    <td class="${P}table-element">${M(n.red.median,2)}</td>
    <td class="${P}table-element">${M(n.blue.median,2)}</td>
    </tr>
    <tr>
    <th class="${P}table-header">Peak</th>
    <td class="${P}table-element">${M(n.total.peak,2)}</td>
    <td class="${P}table-element">${M(n.red.peak,2)}</td>
    <td class="${P}table-element">${M(n.blue.peak,2)}</td>
    </tr>
    <tr>
    <th class="${P}table-header">Total</th>
    <td class="${P}table-element">${n.total.total}</td>
    <td class="${P}table-element">${n.red.total}</td>
    <td class="${P}table-element">${n.blue.total}</td>
    </tr>`,i},Vs=(t,e)=>{const n=Us(e.data.colorNotes);let i=`<caption class="${P}table-caption">Notes: ${n.red.total+n.blue.total}<br>R/B Ratio: ${M(n.red.total/n.blue.total,2)}</caption>
    <tr>
    <th class="${P}table-header"></th>
    <th class="${P}table-header">Red</th>
    <th class="${P}table-header">Blue</th>
    <th class="${P}table-header">Bomb</th>
    </tr>
    <tr>
    <th class="${P}table-header">Total</th>
    <td class="${P}table-element">${n.red.total}</td>
    <td class="${P}table-element">${n.blue.total}</td>
    <td class="${P}table-element">${n.bomb.total}</td>
    </tr>`;(n.red.chroma||n.blue.chroma||n.bomb.chroma)&&(i+=`<tr>
        <th class="${P}table-header">Chroma</th>
        <td class="${P}table-element">${n.red.chroma}</td>
        <td class="${P}table-element">${n.blue.chroma}</td>
        <td class="${P}table-element">${n.bomb.chroma}</td>
        </tr>`),(n.red.noodleExtensions||n.blue.noodleExtensions||n.bomb.noodleExtensions)&&(i+=`<tr>
        <th class="${P}table-header">NE</th>
        <td class="${P}table-element">${n.red.noodleExtensions}</td>
        <td class="${P}table-element">${n.blue.noodleExtensions}</td>
        <td class="${P}table-element">${n.bomb.noodleExtensions}</td>
        </tr>`),(n.red.mappingExtensions||n.blue.mappingExtensions||n.bomb.mappingExtensions)&&(i+=`<tr>
        <th class="${P}table-header">ME</th>
        <td class="${P}table-element">${n.red.mappingExtensions}</td>
        <td class="${P}table-element">${n.blue.mappingExtensions}</td>
        <td class="${P}table-element">${n.bomb.mappingExtensions}</td>
        </tr>`);const a=document.createElement("table");return a.className=P+"table",a.innerHTML=i,a};function Fh(t){var o;const e=t.target,n=e.id.replace(`${P}table-select-placement-`,"").split("-"),i=n[0],a=n[1],r=(o=rt.beatmapDifficulty.find(f=>f.characteristic===i&&f.difficulty===a))==null?void 0:o.noteContainer;if(!r){console.error(en+"note could not be found");return}let l;switch(e.value){case"note":{l=r.filter(f=>f.type==="note");break}case"red":{l=r.filter(f=>f.type==="note"&&f.data.color===0);break}case"blue":{l=r.filter(f=>f.type==="note"&&f.data.color===1);break}case"bomb":{l=r.filter(f=>f.type==="bomb");break}default:l=r}const s=document.querySelector(`#${P}table-placement-${i}-${a}`);if(!s){console.error(en+"table could not be found");return}s.innerHTML=Gs(l)}const Gs=t=>{const e=t.length||1;let n="";for(let i=2;i>=0;i--){n+="<tr>";for(let a=0;a<=3;a++)n+=`<td class="${P}table-element">${Ih(t,a,i)}</td>`;n+=`<td class="${P}table-element ${P}table--no-border">${M(Bh(t,i)/e*100,1)}%</td>
        </tr>`}return n+=`<tr>
    <td class="${P}table-element ${P}table--no-border">${M(Kn(t,0)/e*100,1)}%</td>
    <td class="${P}table-element ${P}table--no-border">${M(Kn(t,1)/e*100,1)}%</td>
    <td class="${P}table-element ${P}table--no-border">${M(Kn(t,2)/e*100,1)}%</td>
    <td class="${P}table-element ${P}table--no-border">${M(Kn(t,3)/e*100,1)}%</td>
    </tr>`,n},Zs=(t,e)=>{var r;const n=Xs.create(`${P}table-select-placement-${e.characteristic}-${e.difficulty}`,"Note Placement: ","caption",`${P}table-caption`,{text:"All",value:"all"},{text:"Note Only",value:"note"},{text:"Red Note",value:"red"},{text:"Blue Note",value:"blue"},{text:"Bomb",value:"bomb"});(r=n.querySelector("select"))==null||r.addEventListener("change",Fh);let i=`<tbody id="${P}table-placement-${e.characteristic}-${e.difficulty}">${Gs(e.noteContainer)}</tbody>`;const a=document.createElement("table");return a.className=P+"table",a.innerHTML=i,a.prepend(n),a};function zh(t){var o;const e=t.target,n=e.id.replace(`${P}table-select-angle-`,"").split("-"),i=n[0],a=n[1],r=(o=rt.beatmapDifficulty.find(f=>f.characteristic===i&&f.difficulty===a))==null?void 0:o.noteContainer;if(!r){console.error(en+"note could not be found");return}let l;switch(e.value){case"red":{l=r.filter(f=>f.type==="note"&&f.data.color===0);break}case"blue":{l=r.filter(f=>f.type==="note"&&f.data.color===1);break}default:l=r}const s=document.querySelector(`#${P}table-angle-${i}-${a}`);if(!s){console.error(en+"table could not be found");return}s.innerHTML=Js(l)}const Js=t=>{const e=t.length||1,n=[4,0,5,2,8,3,6,1,7];let i="";for(let a=0;a<3;a++){i+="<tr>";for(let r=0;r<3;r++){let l=Ah(t,n[a*3+r]);i+=`<td class="${P}table-element">${l}<br>(${M(l/e*100,1)}%)</td>`}i+="</tr>"}return i},Ks=(t,e)=>{var r;const n=Xs.create(`${P}table-select-angle-${e.characteristic}-${e.difficulty}`,"Note Angle: ","caption",`${P}table-caption`,{text:"All",value:"all"},{text:"Note Only",value:"note"},{text:"Red Note",value:"red"},{text:"Blue Note",value:"blue"});(r=n.querySelector("select"))==null||r.addEventListener("change",zh);let i=`<tbody id="${P}table-angle-${e.characteristic}-${e.difficulty}">${Js(e.noteContainer)}</tbody>`;const a=document.createElement("table");return a.className=P+"table",a.innerHTML=i,a.prepend(n),a},Qs=(t,e)=>{oe.create(t._beatsPerMinute),Us(e.data.colorNotes);let n=`<caption class="${P}table-caption">Note Information:</caption>
    <tr>
    <th class="${P}table-header" colspan="2">Max Score</th>
    <td class="${P}table-element">${vl(jh(e.noteContainer))}</td>
    </tr>
    <tr>
    <th class="${P}table-header" colspan="2">Effective BPM</th>
    <td class="${P}table-element">${M(Lc(e.swingAnalysis.container),2)}</td>
    </tr>
    <tr>
    <th class="${P}table-header" colspan="2">Effective BPM (swing)</th>
    <td class="${P}table-element">${M(Tc(e.swingAnalysis.container),2)}</td>
    </tr>`,i=M(Ac(e.swingAnalysis.container)*1e3,1),a=M(Pc(e.swingAnalysis.container)*1e3,1);i&&a&&(n+=`
        <tr>
        <th class="${P}table-header" colspan="2">Min. Slider Speed</th>
        <td class="${P}table-element">${i}ms</td>
        </tr>
        <tr>
        <th class="${P}table-header" colspan="2">Max. Slider Speed</th>
        <td class="${P}table-element">${a}ms</td>
        </tr>`);const r=document.createElement("table");return r.className=P+"table",r.innerHTML=n,r},tl=(t,e)=>{const n=e.characteristic==="360Degree"||e.characteristic==="90Degree"?t._allDirectionsEnvironmentName:t._environmentName,i=Nh(e.data.basicBeatmapEvents,n);let a=0,r=0,l=`<caption class="${P}table-caption">Events: ${Object.values(i).reduce((o,{total:f})=>o+f,0)}</caption>`;for(const o in i)a+=i[o].chroma,r+=i[o].chromaOld,l+=`<tr>
        <th class="${P}table-header" colspan="2">${Ol(parseInt(o),n)}</th>
        <td class="${P}table-element">${i[o].total}</td>
        </tr>`;a&&(l+=`<tr>
        <th class="${P}table-header" colspan="2">Chroma</th>
        <td class="${P}table-element">${a}</td>
        </tr>`),r&&(l+=`<tr>
        <th class="${P}table-header" colspan="2">OG Chroma</th>
        <td class="${P}table-element">${r}</td>
        </tr>`);const s=document.createElement("table");return s.className=P+"table",s.innerHTML=l,s},el=(t,e)=>{const n=Ph(e.data.obstacles);let i=`<caption class="${P}table-caption">Obstacles: ${n.total}</caption>`;n.interactive&&(i+=`<tr>
        <th class="${P}table-header" colspan="2">Interactive</th>
        <td class="${P}table-element">${n.interactive}</td>
        </tr>`),n.chroma&&(i+=`<tr>
        <th class="${P}table-header" colspan="2">Chroma</th>
        <td class="${P}table-element">${n.chroma}</td>
        </tr>`),n.noodleExtensions&&(i+=`<tr>
        <th class="${P}table-header" colspan="2">Noodle Extensions</th>
        <td class="${P}table-element">${n.noodleExtensions}</td>
        </tr>`),n.mappingExtensions&&(i+=`<tr>
        <th class="${P}table-header" colspan="2">Mapping Extensions</th>
        <td class="${P}table-element">${n.mappingExtensions}</td>
        </tr>`);const a=document.createElement("table");return a.className=P+"table",a.innerHTML=i,a},Hh=()=>{if(!rt.beatmapInfo)throw new Error(en+"map info could not be found in savedData");const t=rt.beatmapInfo;t._difficultyBeatmapSets.forEach(e=>{var a,r;const n=document.createElement("div");n.className=P+"mode-"+e._beatmapCharacteristicName;const i=document.createElement("div");i.className=P+"title",i.textContent=Zr[e._beatmapCharacteristicName],n.appendChild(i);for(let l=e._difficultyBeatmaps.length-1;l>=0;l--){const s=e._difficultyBeatmaps[l],o=rt.beatmapDifficulty.find(v=>v.characteristic===e._beatmapCharacteristicName&&v.difficulty===s._difficulty);if(!o)throw new Error(en+"Could not find map data");const f=Xo.create(`${P}${e._beatmapCharacteristicName}-${s._difficulty}`,jn[s._difficulty]+((a=s._customData)!=null&&a._difficultyLabel?" -- "+((r=s._customData)==null?void 0:r._difficultyLabel):""),s._difficulty,!0),h=f.querySelector(".accordion__collapsible-flex"),m=f.querySelector(".accordion__button");if(!h||!m)throw new Error(en+"something went wrong!");m.checked=ut.onLoad.stats;const p=ti.create("small","half"),c=ti.create("small","half"),_=ti.create("small","half");p.append(Ys(t,o)),p.append(document.createElement("br")),p.append(Ws(t,o)),p.append(document.createElement("br")),p.append(qs(t,o)),c.append(Qs(t,o)),c.append(document.createElement("br")),c.append(Zs(t,o)),c.append(document.createElement("br")),c.append(Ks(t,o)),_.append(Vs(t,o)),_.append(document.createElement("br")),_.append(tl(t,o)),_.append(document.createElement("br")),_.append(el(t,o)),h.appendChild(p),h.appendChild(c),h.appendChild(_),n.appendChild(f)}oi.appendChild(n)})},Xh=()=>{for(;oi.firstChild;)oi.removeChild(oi.firstChild)};var nl={createSettingsTable:Ys,createNPSTable:Ws,createSPSTable:qs,createNoteCountTable:Vs,createNotePlacementTable:Zs,createNoteAngleTable:Ks,createInfoTable:Qs,createEventCountTable:tl,createObstacleCountTable:el,populate:Hh,reset:Xh};const In=t=>`[load::${t.name}]`,il=async t=>{const e=t.file("Info.dat")||t.file("info.dat");if(!e)throw new Error("Couldn't find Info.dat");return nt.info(In(il),"loading info"),ei(JSON.parse(await e.async("string")))},An=async(t,e)=>{var a,r,l,s,o,f;const n=[],i=t._difficultyBeatmapSets;for(let h=i.length-1;h>=0;h--){const m=i[h]._difficultyBeatmaps;if(m.length===0||!m){nt.error(In(An),"Empty difficulty set, removing..."),i.splice(h,1);continue}for(let p=0;p<m.length;p++){const c=m[p],_=e.file(c._beatmapFilename);if(_){nt.info(In(An),`Loading ${i[h]._beatmapCharacteristicName} ${c._difficulty}`);let v;try{v=JSON.parse(await _.async("string"))}catch(g){throw new Error(`${i[h]._beatmapCharacteristicName} ${c._difficulty} ${g}`)}try{if(v._notes&&v.version&&nt.error(In(An),`${i[h]._beatmapCharacteristicName} ${c._difficulty} contains 2 version of the map in the same file, attempting to load v3 instead`),v.version){const g=Sr(v),b=oe.create(t._beatsPerMinute,(a=g.customData)==null?void 0:a.BPMChanges,(r=c._customData)==null?void 0:r._editorOffset);n.push({info:c,characteristic:i[h]._beatmapCharacteristicName,difficulty:c._difficulty,bpm:b,data:g,noteContainer:g.getNoteContainer(),eventContainer:g.getEventContainer(),swingAnalysis:go(g,b,i[h]._beatmapCharacteristicName,c._difficulty),rawVersion:3,rawData:v})}else{const g=Dr(Cr(v),!0),b=oe.create(t._beatsPerMinute,(o=(l=v._customData)==null?void 0:l._BPMChanges)!=null?o:(s=v._customData)==null?void 0:s._bpmChanges,(f=c._customData)==null?void 0:f._editorOffset);n.push({info:c,characteristic:i[h]._beatmapCharacteristicName,difficulty:c._difficulty,bpm:b,data:g,noteContainer:g.getNoteContainer(),eventContainer:g.getEventContainer(),swingAnalysis:go(g,b,i[h]._beatmapCharacteristicName,c._difficulty),rawVersion:2,rawData:v})}}catch(g){throw new Error(`${i[h]._beatmapCharacteristicName} ${c._difficulty} ${g}`)}}else if(nt.error(In(An),`Missing ${c._beatmapFilename} file for ${i[h]._beatmapCharacteristicName} ${c._difficulty}, ignoring.`),i[h]._difficultyBeatmaps.splice(p,1),p--,i[h]._difficultyBeatmaps.length<1){nt.error(`${i[h]._beatmapCharacteristicName} difficulty set now empty, ignoring.`),i.splice(h,1);continue}}}return n},rl=async t=>new Promise(function(e,n){const i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="json",i.timeout=5e3;let a=Date.now();i.onprogress=()=>{i.timeout+=Date.now()-a},i.onload=()=>{i.status===200&&e(i.response),i.status===404&&n("Error 404: Map does not exist"),i.status===403&&n("Error 403: Forbidden"),n(`Error ${i.status}`)},i.onerror=()=>{n("Error downloading")},i.ontimeout=()=>{n("Connection timeout")},i.send()}),Uh=async t=>{const e=`https://api.beatsaver.com/maps/id/${t}`,n=await rl(e);if(n!=null&&n.versions.length)return n.versions[n.versions.length-1].downloadURL;throw new Error("could not find map download link")},Yh=async t=>{const e=`https://api.beatsaver.com/maps/hash/${t}`,n=await rl(e);if(n!=null&&n.versions.length)return n.versions[n.versions.length-1].downloadURL;throw new Error("could not find map download link")},Wa=async t=>new Promise(function(e,n){const i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer",i.timeout=5e3;let a=Date.now();i.onprogress=r=>{i.timeout+=Date.now()-a,ft.status("download",`Downloading map: ${M(r.loaded/1024/1024,1)}MB / ${M(r.total/1024/1024,1)}MB`,r.loaded/r.total*100)},i.onload=()=>{i.status===200&&e(i.response),i.status===404&&n("Error 404: Map/link does not exist"),i.status===403&&n("Error 403: Forbidden"),n(`Error ${i.status}`)},i.onerror=()=>{n("Error downloading")},i.ontimeout=()=>{n("Connection timeout")},i.send()}),al=async t=>{const e=qo(t);console.log(`fetching download URL from BeatSaver for map ID ${e}`),ft.status("info","Fetching download URL from BeatSaver",0);const n=await Uh(e);console.log(`downloading from BeatSaver for map ID ${e}`),ft.status("info","Requesting download from BeatSaver",0);const i=await Wa(n);return Mt.setCoverLink("https://beatsaver.com/maps/"+e,e),i},Wh=async t=>{const e=Wo(t);if(e.match(/^(https?:\/\/)?(www\.)?beatsaver\.com\/maps\//))return al(e.replace(/^https?:\/\/(www\.)?beatsaver\.com\/maps\//,"").match(/[a-fA-F0-9]*/)[0]);ft.status("info","Requesting download from link",0),console.log(`downloading from ${e}`);let n=await Wa(e);return Mt.setCoverLink(e),n},qh=async t=>{let e;if(Yo(t.trim()))e=t.trim();else throw new Error("invalid hash");console.log(`fetching download URL from BeatSaver for map hash ${e}`),ft.status("info","Fetching download URL from BeatSaver",0);const n=await Yh(e);return console.log(`downloading from BeatSaver for map hash ${e}`),ft.status("info","Requesting download from BeatSaver",0),await Wa(n)};var Ao=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Qn(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ol={exports:{}};/*!

JSZip v3.9.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/master/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/master/LICENSE
*/(function(t,e){(function(n){t.exports=n()})(function(){return function n(i,a,r){function l(f,h){if(!a[f]){if(!i[f]){var m=typeof Qn=="function"&&Qn;if(!h&&m)return m(f,!0);if(s)return s(f,!0);var p=new Error("Cannot find module '"+f+"'");throw p.code="MODULE_NOT_FOUND",p}var c=a[f]={exports:{}};i[f][0].call(c.exports,function(_){var v=i[f][1][_];return l(v||_)},c,c.exports,n,i,a,r)}return a[f].exports}for(var s=typeof Qn=="function"&&Qn,o=0;o<r.length;o++)l(r[o]);return l}({1:[function(n,i,a){var r=n("./utils"),l=n("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(o){for(var f,h,m,p,c,_,v,g=[],b=0,y=o.length,x=y,T=r.getTypeOf(o)!=="string";b<o.length;)x=y-b,m=T?(f=o[b++],h=b<y?o[b++]:0,b<y?o[b++]:0):(f=o.charCodeAt(b++),h=b<y?o.charCodeAt(b++):0,b<y?o.charCodeAt(b++):0),p=f>>2,c=(3&f)<<4|h>>4,_=1<x?(15&h)<<2|m>>6:64,v=2<x?63&m:64,g.push(s.charAt(p)+s.charAt(c)+s.charAt(_)+s.charAt(v));return g.join("")},a.decode=function(o){var f,h,m,p,c,_,v=0,g=0,b="data:";if(o.substr(0,b.length)===b)throw new Error("Invalid base64 input, it looks like a data url.");var y,x=3*(o=o.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(o.charAt(o.length-1)===s.charAt(64)&&x--,o.charAt(o.length-2)===s.charAt(64)&&x--,x%1!=0)throw new Error("Invalid base64 input, bad content length.");for(y=l.uint8array?new Uint8Array(0|x):new Array(0|x);v<o.length;)f=s.indexOf(o.charAt(v++))<<2|(p=s.indexOf(o.charAt(v++)))>>4,h=(15&p)<<4|(c=s.indexOf(o.charAt(v++)))>>2,m=(3&c)<<6|(_=s.indexOf(o.charAt(v++))),y[g++]=f,c!==64&&(y[g++]=h),_!==64&&(y[g++]=m);return y}},{"./support":30,"./utils":32}],2:[function(n,i,a){var r=n("./external"),l=n("./stream/DataWorker"),s=n("./stream/Crc32Probe"),o=n("./stream/DataLengthProbe");function f(h,m,p,c,_){this.compressedSize=h,this.uncompressedSize=m,this.crc32=p,this.compression=c,this.compressedContent=_}f.prototype={getContentWorker:function(){var h=new l(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),m=this;return h.on("end",function(){if(this.streamInfo.data_length!==m.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),h},getCompressedWorker:function(){return new l(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(h,m,p){return h.pipe(new s).pipe(new o("uncompressedSize")).pipe(m.compressWorker(p)).pipe(new o("compressedSize")).withStreamInfo("compression",m)},i.exports=f},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,i,a){var r=n("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(l){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},a.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,i,a){var r=n("./utils"),l=function(){for(var s,o=[],f=0;f<256;f++){s=f;for(var h=0;h<8;h++)s=1&s?3988292384^s>>>1:s>>>1;o[f]=s}return o}();i.exports=function(s,o){return s!==void 0&&s.length?r.getTypeOf(s)!=="string"?function(f,h,m,p){var c=l,_=p+m;f^=-1;for(var v=p;v<_;v++)f=f>>>8^c[255&(f^h[v])];return-1^f}(0|o,s,s.length,0):function(f,h,m,p){var c=l,_=p+m;f^=-1;for(var v=p;v<_;v++)f=f>>>8^c[255&(f^h.charCodeAt(v))];return-1^f}(0|o,s,s.length,0):0}},{"./utils":32}],5:[function(n,i,a){a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(n,i,a){var r=null;r=typeof Promise!="undefined"?Promise:n("lie"),i.exports={Promise:r}},{lie:37}],7:[function(n,i,a){var r=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",l=n("pako"),s=n("./utils"),o=n("./stream/GenericWorker"),f=r?"uint8array":"array";function h(m,p){o.call(this,"FlateWorker/"+m),this._pako=null,this._pakoAction=m,this._pakoOptions=p,this.meta={}}a.magic="\b\0",s.inherits(h,o),h.prototype.processChunk=function(m){this.meta=m.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(f,m.data),!1)},h.prototype.flush=function(){o.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},h.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},h.prototype._createPako=function(){this._pako=new l[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var m=this;this._pako.onData=function(p){m.push({data:p,meta:m.meta})}},a.compressWorker=function(m){return new h("Deflate",m)},a.uncompressWorker=function(){return new h("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,i,a){function r(c,_){var v,g="";for(v=0;v<_;v++)g+=String.fromCharCode(255&c),c>>>=8;return g}function l(c,_,v,g,b,y){var x,T,D=c.file,j=c.compression,N=y!==f.utf8encode,Y=s.transformTo("string",y(D.name)),B=s.transformTo("string",f.utf8encode(D.name)),U=D.comment,K=s.transformTo("string",y(U)),k=s.transformTo("string",f.utf8encode(U)),A=B.length!==D.name.length,u=k.length!==U.length,S="",J="",z="",it=D.dir,X=D.date,Q={crc32:0,compressedSize:0,uncompressedSize:0};_&&!v||(Q.crc32=c.crc32,Q.compressedSize=c.compressedSize,Q.uncompressedSize=c.uncompressedSize);var R=0;_&&(R|=8),N||!A&&!u||(R|=2048);var $=0,et=0;it&&($|=16),b==="UNIX"?(et=798,$|=function(V,pt){var Lt=V;return V||(Lt=pt?16893:33204),(65535&Lt)<<16}(D.unixPermissions,it)):(et=20,$|=function(V){return 63&(V||0)}(D.dosPermissions)),x=X.getUTCHours(),x<<=6,x|=X.getUTCMinutes(),x<<=5,x|=X.getUTCSeconds()/2,T=X.getUTCFullYear()-1980,T<<=4,T|=X.getUTCMonth()+1,T<<=5,T|=X.getUTCDate(),A&&(J=r(1,1)+r(h(Y),4)+B,S+="up"+r(J.length,2)+J),u&&(z=r(1,1)+r(h(K),4)+k,S+="uc"+r(z.length,2)+z);var G="";return G+=`
\0`,G+=r(R,2),G+=j.magic,G+=r(x,2),G+=r(T,2),G+=r(Q.crc32,4),G+=r(Q.compressedSize,4),G+=r(Q.uncompressedSize,4),G+=r(Y.length,2),G+=r(S.length,2),{fileRecord:m.LOCAL_FILE_HEADER+G+Y+S,dirRecord:m.CENTRAL_FILE_HEADER+r(et,2)+G+r(K.length,2)+"\0\0\0\0"+r($,4)+r(g,4)+Y+S+K}}var s=n("../utils"),o=n("../stream/GenericWorker"),f=n("../utf8"),h=n("../crc32"),m=n("../signature");function p(c,_,v,g){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=_,this.zipPlatform=v,this.encodeFileName=g,this.streamFiles=c,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(p,o),p.prototype.push=function(c){var _=c.meta.percent||0,v=this.entriesCount,g=this._sources.length;this.accumulate?this.contentBuffer.push(c):(this.bytesWritten+=c.data.length,o.prototype.push.call(this,{data:c.data,meta:{currentFile:this.currentFile,percent:v?(_+100*(v-g-1))/v:100}}))},p.prototype.openedSource=function(c){this.currentSourceOffset=this.bytesWritten,this.currentFile=c.file.name;var _=this.streamFiles&&!c.file.dir;if(_){var v=l(c,_,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:v.fileRecord,meta:{percent:0}})}else this.accumulate=!0},p.prototype.closedSource=function(c){this.accumulate=!1;var _=this.streamFiles&&!c.file.dir,v=l(c,_,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(v.dirRecord),_)this.push({data:function(g){return m.DATA_DESCRIPTOR+r(g.crc32,4)+r(g.compressedSize,4)+r(g.uncompressedSize,4)}(c),meta:{percent:100}});else for(this.push({data:v.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},p.prototype.flush=function(){for(var c=this.bytesWritten,_=0;_<this.dirRecords.length;_++)this.push({data:this.dirRecords[_],meta:{percent:100}});var v=this.bytesWritten-c,g=function(b,y,x,T,D){var j=s.transformTo("string",D(T));return m.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(b,2)+r(b,2)+r(y,4)+r(x,4)+r(j.length,2)+j}(this.dirRecords.length,v,c,this.zipComment,this.encodeFileName);this.push({data:g,meta:{percent:100}})},p.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},p.prototype.registerPrevious=function(c){this._sources.push(c);var _=this;return c.on("data",function(v){_.processChunk(v)}),c.on("end",function(){_.closedSource(_.previous.streamInfo),_._sources.length?_.prepareNextSource():_.end()}),c.on("error",function(v){_.error(v)}),this},p.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},p.prototype.error=function(c){var _=this._sources;if(!o.prototype.error.call(this,c))return!1;for(var v=0;v<_.length;v++)try{_[v].error(c)}catch{}return!0},p.prototype.lock=function(){o.prototype.lock.call(this);for(var c=this._sources,_=0;_<c.length;_++)c[_].lock()},i.exports=p},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,i,a){var r=n("../compressions"),l=n("./ZipFileWorker");a.generateWorker=function(s,o,f){var h=new l(o.streamFiles,f,o.platform,o.encodeFileName),m=0;try{s.forEach(function(p,c){m++;var _=function(y,x){var T=y||x,D=r[T];if(!D)throw new Error(T+" is not a valid compression method !");return D}(c.options.compression,o.compression),v=c.options.compressionOptions||o.compressionOptions||{},g=c.dir,b=c.date;c._compressWorker(_,v).withStreamInfo("file",{name:p,dir:g,date:b,comment:c.comment||"",unixPermissions:c.unixPermissions,dosPermissions:c.dosPermissions}).pipe(h)}),h.entriesCount=m}catch(p){h.error(p)}return h}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,i,a){function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var l=new r;for(var s in this)typeof this[s]!="function"&&(l[s]=this[s]);return l}}(r.prototype=n("./object")).loadAsync=n("./load"),r.support=n("./support"),r.defaults=n("./defaults"),r.version="3.9.1",r.loadAsync=function(l,s){return new r().loadAsync(l,s)},r.external=n("./external"),i.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,i,a){var r=n("./utils"),l=n("./external"),s=n("./utf8"),o=n("./zipEntries"),f=n("./stream/Crc32Probe"),h=n("./nodejsUtils");function m(p){return new l.Promise(function(c,_){var v=p.decompressed.getContentWorker().pipe(new f);v.on("error",function(g){_(g)}).on("end",function(){v.streamInfo.crc32!==p.decompressed.crc32?_(new Error("Corrupted zip : CRC32 mismatch")):c()}).resume()})}i.exports=function(p,c){var _=this;return c=r.extend(c||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),h.isNode&&h.isStream(p)?l.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",p,!0,c.optimizedBinaryString,c.base64).then(function(v){var g=new o(c);return g.load(v),g}).then(function(v){var g=[l.Promise.resolve(v)],b=v.files;if(c.checkCRC32)for(var y=0;y<b.length;y++)g.push(m(b[y]));return l.Promise.all(g)}).then(function(v){for(var g=v.shift(),b=g.files,y=0;y<b.length;y++){var x=b[y],T=x.fileNameStr,D=r.resolve(x.fileNameStr);_.file(D,x.decompressed,{binary:!0,optimizedBinaryString:!0,date:x.date,dir:x.dir,comment:x.fileCommentStr.length?x.fileCommentStr:null,unixPermissions:x.unixPermissions,dosPermissions:x.dosPermissions,createFolders:c.createFolders}),x.dir||(_.file(D).unsafeOriginalName=T)}return g.zipComment.length&&(_.comment=g.zipComment),_})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,i,a){var r=n("../utils"),l=n("../stream/GenericWorker");function s(o,f){l.call(this,"Nodejs stream input adapter for "+o),this._upstreamEnded=!1,this._bindStream(f)}r.inherits(s,l),s.prototype._bindStream=function(o){var f=this;(this._stream=o).pause(),o.on("data",function(h){f.push({data:h,meta:{percent:0}})}).on("error",function(h){f.isPaused?this.generatedError=h:f.error(h)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},s.prototype.pause=function(){return!!l.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},i.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,i,a){var r=n("readable-stream").Readable;function l(s,o,f){r.call(this,o),this._helper=s;var h=this;s.on("data",function(m,p){h.push(m)||h._helper.pause(),f&&f(p)}).on("error",function(m){h.emit("error",m)}).on("end",function(){h.push(null)})}n("../utils").inherits(l,r),l.prototype._read=function(){this._helper.resume()},i.exports=l},{"../utils":32,"readable-stream":16}],14:[function(n,i,a){i.exports={isNode:typeof Buffer!="undefined",newBufferFrom:function(r,l){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(r,l);if(typeof r=="number")throw new Error('The "data" argument must not be a number');return new Buffer(r,l)},allocBuffer:function(r){if(Buffer.alloc)return Buffer.alloc(r);var l=new Buffer(r);return l.fill(0),l},isBuffer:function(r){return Buffer.isBuffer(r)},isStream:function(r){return r&&typeof r.on=="function"&&typeof r.pause=="function"&&typeof r.resume=="function"}}},{}],15:[function(n,i,a){function r(D,j,N){var Y,B=s.getTypeOf(j),U=s.extend(N||{},h);U.date=U.date||new Date,U.compression!==null&&(U.compression=U.compression.toUpperCase()),typeof U.unixPermissions=="string"&&(U.unixPermissions=parseInt(U.unixPermissions,8)),U.unixPermissions&&16384&U.unixPermissions&&(U.dir=!0),U.dosPermissions&&16&U.dosPermissions&&(U.dir=!0),U.dir&&(D=b(D)),U.createFolders&&(Y=g(D))&&y.call(this,Y,!0);var K=B==="string"&&U.binary===!1&&U.base64===!1;N&&N.binary!==void 0||(U.binary=!K),(j instanceof m&&j.uncompressedSize===0||U.dir||!j||j.length===0)&&(U.base64=!1,U.binary=!0,j="",U.compression="STORE",B="string");var k=null;k=j instanceof m||j instanceof o?j:_.isNode&&_.isStream(j)?new v(D,j):s.prepareContent(D,j,U.binary,U.optimizedBinaryString,U.base64);var A=new p(D,k,U);this.files[D]=A}var l=n("./utf8"),s=n("./utils"),o=n("./stream/GenericWorker"),f=n("./stream/StreamHelper"),h=n("./defaults"),m=n("./compressedObject"),p=n("./zipObject"),c=n("./generate"),_=n("./nodejsUtils"),v=n("./nodejs/NodejsStreamInputAdapter"),g=function(D){D.slice(-1)==="/"&&(D=D.substring(0,D.length-1));var j=D.lastIndexOf("/");return 0<j?D.substring(0,j):""},b=function(D){return D.slice(-1)!=="/"&&(D+="/"),D},y=function(D,j){return j=j!==void 0?j:h.createFolders,D=b(D),this.files[D]||r.call(this,D,null,{dir:!0,createFolders:j}),this.files[D]};function x(D){return Object.prototype.toString.call(D)==="[object RegExp]"}var T={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(D){var j,N,Y;for(j in this.files)Y=this.files[j],(N=j.slice(this.root.length,j.length))&&j.slice(0,this.root.length)===this.root&&D(N,Y)},filter:function(D){var j=[];return this.forEach(function(N,Y){D(N,Y)&&j.push(Y)}),j},file:function(D,j,N){if(arguments.length!==1)return D=this.root+D,r.call(this,D,j,N),this;if(x(D)){var Y=D;return this.filter(function(U,K){return!K.dir&&Y.test(U)})}var B=this.files[this.root+D];return B&&!B.dir?B:null},folder:function(D){if(!D)return this;if(x(D))return this.filter(function(B,U){return U.dir&&D.test(B)});var j=this.root+D,N=y.call(this,j),Y=this.clone();return Y.root=N.name,Y},remove:function(D){D=this.root+D;var j=this.files[D];if(j||(D.slice(-1)!=="/"&&(D+="/"),j=this.files[D]),j&&!j.dir)delete this.files[D];else for(var N=this.filter(function(B,U){return U.name.slice(0,D.length)===D}),Y=0;Y<N.length;Y++)delete this.files[N[Y].name];return this},generate:function(D){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(D){var j,N={};try{if((N=s.extend(D||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:l.utf8encode})).type=N.type.toLowerCase(),N.compression=N.compression.toUpperCase(),N.type==="binarystring"&&(N.type="string"),!N.type)throw new Error("No output type specified.");s.checkSupport(N.type),N.platform!=="darwin"&&N.platform!=="freebsd"&&N.platform!=="linux"&&N.platform!=="sunos"||(N.platform="UNIX"),N.platform==="win32"&&(N.platform="DOS");var Y=N.comment||this.comment||"";j=c.generateWorker(this,N,Y)}catch(B){(j=new o("error")).error(B)}return new f(j,N.type||"string",N.mimeType)},generateAsync:function(D,j){return this.generateInternalStream(D).accumulate(j)},generateNodeStream:function(D,j){return(D=D||{}).type||(D.type="nodebuffer"),this.generateInternalStream(D).toNodejsStream(j)}};i.exports=T},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,i,a){i.exports=n("stream")},{stream:void 0}],17:[function(n,i,a){var r=n("./DataReader");function l(s){r.call(this,s);for(var o=0;o<this.data.length;o++)s[o]=255&s[o]}n("../utils").inherits(l,r),l.prototype.byteAt=function(s){return this.data[this.zero+s]},l.prototype.lastIndexOfSignature=function(s){for(var o=s.charCodeAt(0),f=s.charCodeAt(1),h=s.charCodeAt(2),m=s.charCodeAt(3),p=this.length-4;0<=p;--p)if(this.data[p]===o&&this.data[p+1]===f&&this.data[p+2]===h&&this.data[p+3]===m)return p-this.zero;return-1},l.prototype.readAndCheckSignature=function(s){var o=s.charCodeAt(0),f=s.charCodeAt(1),h=s.charCodeAt(2),m=s.charCodeAt(3),p=this.readData(4);return o===p[0]&&f===p[1]&&h===p[2]&&m===p[3]},l.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var o=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,o},i.exports=l},{"../utils":32,"./DataReader":18}],18:[function(n,i,a){var r=n("../utils");function l(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}l.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(s){},readInt:function(s){var o,f=0;for(this.checkOffset(s),o=this.index+s-1;o>=this.index;o--)f=(f<<8)+this.byteAt(o);return this.index+=s,f},readString:function(s){return r.transformTo("string",this.readData(s))},readData:function(s){},lastIndexOfSignature:function(s){},readAndCheckSignature:function(s){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},i.exports=l},{"../utils":32}],19:[function(n,i,a){var r=n("./Uint8ArrayReader");function l(s){r.call(this,s)}n("../utils").inherits(l,r),l.prototype.readData=function(s){this.checkOffset(s);var o=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,o},i.exports=l},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,i,a){var r=n("./DataReader");function l(s){r.call(this,s)}n("../utils").inherits(l,r),l.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},l.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},l.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},l.prototype.readData=function(s){this.checkOffset(s);var o=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,o},i.exports=l},{"../utils":32,"./DataReader":18}],21:[function(n,i,a){var r=n("./ArrayReader");function l(s){r.call(this,s)}n("../utils").inherits(l,r),l.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var o=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,o},i.exports=l},{"../utils":32,"./ArrayReader":17}],22:[function(n,i,a){var r=n("../utils"),l=n("../support"),s=n("./ArrayReader"),o=n("./StringReader"),f=n("./NodeBufferReader"),h=n("./Uint8ArrayReader");i.exports=function(m){var p=r.getTypeOf(m);return r.checkSupport(p),p!=="string"||l.uint8array?p==="nodebuffer"?new f(m):l.uint8array?new h(r.transformTo("uint8array",m)):new s(r.transformTo("array",m)):new o(m)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,i,a){a.LOCAL_FILE_HEADER="PK",a.CENTRAL_FILE_HEADER="PK",a.CENTRAL_DIRECTORY_END="PK",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,i,a){var r=n("./GenericWorker"),l=n("../utils");function s(o){r.call(this,"ConvertWorker to "+o),this.destType=o}l.inherits(s,r),s.prototype.processChunk=function(o){this.push({data:l.transformTo(this.destType,o.data),meta:o.meta})},i.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(n,i,a){var r=n("./GenericWorker"),l=n("../crc32");function s(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(s,r),s.prototype.processChunk=function(o){this.streamInfo.crc32=l(o.data,this.streamInfo.crc32||0),this.push(o)},i.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,i,a){var r=n("../utils"),l=n("./GenericWorker");function s(o){l.call(this,"DataLengthProbe for "+o),this.propName=o,this.withStreamInfo(o,0)}r.inherits(s,l),s.prototype.processChunk=function(o){if(o){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+o.data.length}l.prototype.processChunk.call(this,o)},i.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(n,i,a){var r=n("../utils"),l=n("./GenericWorker");function s(o){l.call(this,"DataWorker");var f=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,o.then(function(h){f.dataIsReady=!0,f.data=h,f.max=h&&h.length||0,f.type=r.getTypeOf(h),f.isPaused||f._tickAndRepeat()},function(h){f.error(h)})}r.inherits(s,l),s.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var o=null,f=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":o=this.data.substring(this.index,f);break;case"uint8array":o=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":o=this.data.slice(this.index,f)}return this.index=f,this.push({data:o,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(n,i,a){function r(l){this.name=l||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(l){this.emit("data",l)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(l){this.emit("error",l)}return!0},error:function(l){return!this.isFinished&&(this.isPaused?this.generatedError=l:(this.isFinished=!0,this.emit("error",l),this.previous&&this.previous.error(l),this.cleanUp()),!0)},on:function(l,s){return this._listeners[l].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(l,s){if(this._listeners[l])for(var o=0;o<this._listeners[l].length;o++)this._listeners[l][o].call(this,s)},pipe:function(l){return l.registerPrevious(this)},registerPrevious:function(l){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=l.streamInfo,this.mergeStreamInfo(),this.previous=l;var s=this;return l.on("data",function(o){s.processChunk(o)}),l.on("end",function(){s.end()}),l.on("error",function(o){s.error(o)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var l=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),l=!0),this.previous&&this.previous.resume(),!l},flush:function(){},processChunk:function(l){this.push(l)},withStreamInfo:function(l,s){return this.extraStreamInfo[l]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var l in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(l)&&(this.streamInfo[l]=this.extraStreamInfo[l])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var l="Worker "+this.name;return this.previous?this.previous+" -> "+l:l}},i.exports=r},{}],29:[function(n,i,a){var r=n("../utils"),l=n("./ConvertWorker"),s=n("./GenericWorker"),o=n("../base64"),f=n("../support"),h=n("../external"),m=null;if(f.nodestream)try{m=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function p(_,v){return new h.Promise(function(g,b){var y=[],x=_._internalType,T=_._outputType,D=_._mimeType;_.on("data",function(j,N){y.push(j),v&&v(N)}).on("error",function(j){y=[],b(j)}).on("end",function(){try{var j=function(N,Y,B){switch(N){case"blob":return r.newBlob(r.transformTo("arraybuffer",Y),B);case"base64":return o.encode(Y);default:return r.transformTo(N,Y)}}(T,function(N,Y){var B,U=0,K=null,k=0;for(B=0;B<Y.length;B++)k+=Y[B].length;switch(N){case"string":return Y.join("");case"array":return Array.prototype.concat.apply([],Y);case"uint8array":for(K=new Uint8Array(k),B=0;B<Y.length;B++)K.set(Y[B],U),U+=Y[B].length;return K;case"nodebuffer":return Buffer.concat(Y);default:throw new Error("concat : unsupported type '"+N+"'")}}(x,y),D);g(j)}catch(N){b(N)}y=[]}).resume()})}function c(_,v,g){var b=v;switch(v){case"blob":case"arraybuffer":b="uint8array";break;case"base64":b="string"}try{this._internalType=b,this._outputType=v,this._mimeType=g,r.checkSupport(b),this._worker=_.pipe(new l(b)),_.lock()}catch(y){this._worker=new s("error"),this._worker.error(y)}}c.prototype={accumulate:function(_){return p(this,_)},on:function(_,v){var g=this;return _==="data"?this._worker.on(_,function(b){v.call(g,b.data,b.meta)}):this._worker.on(_,function(){r.delay(v,arguments,g)}),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(_){if(r.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new m(this,{objectMode:this._outputType!=="nodebuffer"},_)}},i.exports=c},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,i,a){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",a.nodebuffer=typeof Buffer!="undefined",a.uint8array=typeof Uint8Array!="undefined",typeof ArrayBuffer=="undefined")a.blob=!1;else{var r=new ArrayBuffer(0);try{a.blob=new Blob([r],{type:"application/zip"}).size===0}catch{try{var l=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);l.append(r),a.blob=l.getBlob("application/zip").size===0}catch{a.blob=!1}}}try{a.nodestream=!!n("readable-stream").Readable}catch{a.nodestream=!1}},{"readable-stream":16}],31:[function(n,i,a){for(var r=n("./utils"),l=n("./support"),s=n("./nodejsUtils"),o=n("./stream/GenericWorker"),f=new Array(256),h=0;h<256;h++)f[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;f[254]=f[254]=1;function m(){o.call(this,"utf-8 decode"),this.leftOver=null}function p(){o.call(this,"utf-8 encode")}a.utf8encode=function(c){return l.nodebuffer?s.newBufferFrom(c,"utf-8"):function(_){var v,g,b,y,x,T=_.length,D=0;for(y=0;y<T;y++)(64512&(g=_.charCodeAt(y)))==55296&&y+1<T&&(64512&(b=_.charCodeAt(y+1)))==56320&&(g=65536+(g-55296<<10)+(b-56320),y++),D+=g<128?1:g<2048?2:g<65536?3:4;for(v=l.uint8array?new Uint8Array(D):new Array(D),y=x=0;x<D;y++)(64512&(g=_.charCodeAt(y)))==55296&&y+1<T&&(64512&(b=_.charCodeAt(y+1)))==56320&&(g=65536+(g-55296<<10)+(b-56320),y++),g<128?v[x++]=g:(g<2048?v[x++]=192|g>>>6:(g<65536?v[x++]=224|g>>>12:(v[x++]=240|g>>>18,v[x++]=128|g>>>12&63),v[x++]=128|g>>>6&63),v[x++]=128|63&g);return v}(c)},a.utf8decode=function(c){return l.nodebuffer?r.transformTo("nodebuffer",c).toString("utf-8"):function(_){var v,g,b,y,x=_.length,T=new Array(2*x);for(v=g=0;v<x;)if((b=_[v++])<128)T[g++]=b;else if(4<(y=f[b]))T[g++]=65533,v+=y-1;else{for(b&=y===2?31:y===3?15:7;1<y&&v<x;)b=b<<6|63&_[v++],y--;1<y?T[g++]=65533:b<65536?T[g++]=b:(b-=65536,T[g++]=55296|b>>10&1023,T[g++]=56320|1023&b)}return T.length!==g&&(T.subarray?T=T.subarray(0,g):T.length=g),r.applyFromCharCode(T)}(c=r.transformTo(l.uint8array?"uint8array":"array",c))},r.inherits(m,o),m.prototype.processChunk=function(c){var _=r.transformTo(l.uint8array?"uint8array":"array",c.data);if(this.leftOver&&this.leftOver.length){if(l.uint8array){var v=_;(_=new Uint8Array(v.length+this.leftOver.length)).set(this.leftOver,0),_.set(v,this.leftOver.length)}else _=this.leftOver.concat(_);this.leftOver=null}var g=function(y,x){var T;for((x=x||y.length)>y.length&&(x=y.length),T=x-1;0<=T&&(192&y[T])==128;)T--;return T<0||T===0?x:T+f[y[T]]>x?T:x}(_),b=_;g!==_.length&&(l.uint8array?(b=_.subarray(0,g),this.leftOver=_.subarray(g,_.length)):(b=_.slice(0,g),this.leftOver=_.slice(g,_.length))),this.push({data:a.utf8decode(b),meta:c.meta})},m.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=m,r.inherits(p,o),p.prototype.processChunk=function(c){this.push({data:a.utf8encode(c.data),meta:c.meta})},a.Utf8EncodeWorker=p},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,i,a){var r=n("./support"),l=n("./base64"),s=n("./nodejsUtils"),o=n("set-immediate-shim"),f=n("./external");function h(g){return g}function m(g,b){for(var y=0;y<g.length;++y)b[y]=255&g.charCodeAt(y);return b}a.newBlob=function(g,b){a.checkSupport("blob");try{return new Blob([g],{type:b})}catch{try{var y=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return y.append(g),y.getBlob(b)}catch{throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(g,b,y){var x=[],T=0,D=g.length;if(D<=y)return String.fromCharCode.apply(null,g);for(;T<D;)b==="array"||b==="nodebuffer"?x.push(String.fromCharCode.apply(null,g.slice(T,Math.min(T+y,D)))):x.push(String.fromCharCode.apply(null,g.subarray(T,Math.min(T+y,D)))),T+=y;return x.join("")},stringifyByChar:function(g){for(var b="",y=0;y<g.length;y++)b+=String.fromCharCode(g[y]);return b},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}}()}};function c(g){var b=65536,y=a.getTypeOf(g),x=!0;if(y==="uint8array"?x=p.applyCanBeUsed.uint8array:y==="nodebuffer"&&(x=p.applyCanBeUsed.nodebuffer),x)for(;1<b;)try{return p.stringifyByChunk(g,y,b)}catch{b=Math.floor(b/2)}return p.stringifyByChar(g)}function _(g,b){for(var y=0;y<g.length;y++)b[y]=g[y];return b}a.applyFromCharCode=c;var v={};v.string={string:h,array:function(g){return m(g,new Array(g.length))},arraybuffer:function(g){return v.string.uint8array(g).buffer},uint8array:function(g){return m(g,new Uint8Array(g.length))},nodebuffer:function(g){return m(g,s.allocBuffer(g.length))}},v.array={string:c,array:h,arraybuffer:function(g){return new Uint8Array(g).buffer},uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return s.newBufferFrom(g)}},v.arraybuffer={string:function(g){return c(new Uint8Array(g))},array:function(g){return _(new Uint8Array(g),new Array(g.byteLength))},arraybuffer:h,uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return s.newBufferFrom(new Uint8Array(g))}},v.uint8array={string:c,array:function(g){return _(g,new Array(g.length))},arraybuffer:function(g){return g.buffer},uint8array:h,nodebuffer:function(g){return s.newBufferFrom(g)}},v.nodebuffer={string:c,array:function(g){return _(g,new Array(g.length))},arraybuffer:function(g){return v.nodebuffer.uint8array(g).buffer},uint8array:function(g){return _(g,new Uint8Array(g.length))},nodebuffer:h},a.transformTo=function(g,b){if(b=b||"",!g)return b;a.checkSupport(g);var y=a.getTypeOf(b);return v[y][g](b)},a.resolve=function(g){for(var b=g.split("/"),y=[],x=0;x<b.length;x++){var T=b[x];T==="."||T===""&&x!==0&&x!==b.length-1||(T===".."?y.pop():y.push(T))}return y.join("/")},a.getTypeOf=function(g){return typeof g=="string"?"string":Object.prototype.toString.call(g)==="[object Array]"?"array":r.nodebuffer&&s.isBuffer(g)?"nodebuffer":r.uint8array&&g instanceof Uint8Array?"uint8array":r.arraybuffer&&g instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(g){if(!r[g.toLowerCase()])throw new Error(g+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(g){var b,y,x="";for(y=0;y<(g||"").length;y++)x+="\\x"+((b=g.charCodeAt(y))<16?"0":"")+b.toString(16).toUpperCase();return x},a.delay=function(g,b,y){o(function(){g.apply(y||null,b||[])})},a.inherits=function(g,b){function y(){}y.prototype=b.prototype,g.prototype=new y},a.extend=function(){var g,b,y={};for(g=0;g<arguments.length;g++)for(b in arguments[g])arguments[g].hasOwnProperty(b)&&y[b]===void 0&&(y[b]=arguments[g][b]);return y},a.prepareContent=function(g,b,y,x,T){return f.Promise.resolve(b).then(function(D){return r.blob&&(D instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(D))!==-1)&&typeof FileReader!="undefined"?new f.Promise(function(j,N){var Y=new FileReader;Y.onload=function(B){j(B.target.result)},Y.onerror=function(B){N(B.target.error)},Y.readAsArrayBuffer(D)}):D}).then(function(D){var j=a.getTypeOf(D);return j?(j==="arraybuffer"?D=a.transformTo("uint8array",D):j==="string"&&(T?D=l.decode(D):y&&x!==!0&&(D=function(N){return m(N,r.uint8array?new Uint8Array(N.length):new Array(N.length))}(D))),D):f.Promise.reject(new Error("Can't read the data of '"+g+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"set-immediate-shim":54}],33:[function(n,i,a){var r=n("./reader/readerFor"),l=n("./utils"),s=n("./signature"),o=n("./zipEntry"),f=(n("./utf8"),n("./support"));function h(m){this.files=[],this.loadOptions=m}h.prototype={checkSignature:function(m){if(!this.reader.readAndCheckSignature(m)){this.reader.index-=4;var p=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+l.pretty(p)+", expected "+l.pretty(m)+")")}},isSignature:function(m,p){var c=this.reader.index;this.reader.setIndex(m);var _=this.reader.readString(4)===p;return this.reader.setIndex(c),_},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var m=this.reader.readData(this.zipCommentLength),p=f.uint8array?"uint8array":"array",c=l.transformTo(p,m);this.zipComment=this.loadOptions.decodeFileName(c)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var m,p,c,_=this.zip64EndOfCentralSize-44;0<_;)m=this.reader.readInt(2),p=this.reader.readInt(4),c=this.reader.readData(p),this.zip64ExtensibleData[m]={id:m,length:p,value:c}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var m,p;for(m=0;m<this.files.length;m++)p=this.files[m],this.reader.setIndex(p.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),p.readLocalPart(this.reader),p.handleUTF8(),p.processAttributes()},readCentralDir:function(){var m;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(m=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(m);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var m=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(m<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(m);var p=m;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===l.MAX_VALUE_16BITS||this.diskWithCentralDirStart===l.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===l.MAX_VALUE_16BITS||this.centralDirRecords===l.MAX_VALUE_16BITS||this.centralDirSize===l.MAX_VALUE_32BITS||this.centralDirOffset===l.MAX_VALUE_32BITS){if(this.zip64=!0,(m=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(m),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var c=this.centralDirOffset+this.centralDirSize;this.zip64&&(c+=20,c+=12+this.zip64EndOfCentralSize);var _=p-c;if(0<_)this.isSignature(p,s.CENTRAL_FILE_HEADER)||(this.reader.zero=_);else if(_<0)throw new Error("Corrupted zip: missing "+Math.abs(_)+" bytes.")},prepareReader:function(m){this.reader=r(m)},load:function(m){this.prepareReader(m),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=h},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(n,i,a){var r=n("./reader/readerFor"),l=n("./utils"),s=n("./compressedObject"),o=n("./crc32"),f=n("./utf8"),h=n("./compressions"),m=n("./support");function p(c,_){this.options=c,this.loadOptions=_}p.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(c){var _,v;if(c.skip(22),this.fileNameLength=c.readInt(2),v=c.readInt(2),this.fileName=c.readData(this.fileNameLength),c.skip(v),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((_=function(g){for(var b in h)if(h.hasOwnProperty(b)&&h[b].magic===g)return h[b];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+l.pretty(this.compressionMethod)+" unknown (inner file : "+l.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,_,c.readData(this.compressedSize))},readCentralPart:function(c){this.versionMadeBy=c.readInt(2),c.skip(2),this.bitFlag=c.readInt(2),this.compressionMethod=c.readString(2),this.date=c.readDate(),this.crc32=c.readInt(4),this.compressedSize=c.readInt(4),this.uncompressedSize=c.readInt(4);var _=c.readInt(2);if(this.extraFieldsLength=c.readInt(2),this.fileCommentLength=c.readInt(2),this.diskNumberStart=c.readInt(2),this.internalFileAttributes=c.readInt(2),this.externalFileAttributes=c.readInt(4),this.localHeaderOffset=c.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");c.skip(_),this.readExtraFields(c),this.parseZIP64ExtraField(c),this.fileComment=c.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var c=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),c==0&&(this.dosPermissions=63&this.externalFileAttributes),c==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(c){if(this.extraFields[1]){var _=r(this.extraFields[1].value);this.uncompressedSize===l.MAX_VALUE_32BITS&&(this.uncompressedSize=_.readInt(8)),this.compressedSize===l.MAX_VALUE_32BITS&&(this.compressedSize=_.readInt(8)),this.localHeaderOffset===l.MAX_VALUE_32BITS&&(this.localHeaderOffset=_.readInt(8)),this.diskNumberStart===l.MAX_VALUE_32BITS&&(this.diskNumberStart=_.readInt(4))}},readExtraFields:function(c){var _,v,g,b=c.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});c.index+4<b;)_=c.readInt(2),v=c.readInt(2),g=c.readData(v),this.extraFields[_]={id:_,length:v,value:g};c.setIndex(b)},handleUTF8:function(){var c=m.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var _=this.findExtraFieldUnicodePath();if(_!==null)this.fileNameStr=_;else{var v=l.transformTo(c,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(v)}var g=this.findExtraFieldUnicodeComment();if(g!==null)this.fileCommentStr=g;else{var b=l.transformTo(c,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(b)}}},findExtraFieldUnicodePath:function(){var c=this.extraFields[28789];if(c){var _=r(c.value);return _.readInt(1)!==1||o(this.fileName)!==_.readInt(4)?null:f.utf8decode(_.readData(c.length-5))}return null},findExtraFieldUnicodeComment:function(){var c=this.extraFields[25461];if(c){var _=r(c.value);return _.readInt(1)!==1||o(this.fileComment)!==_.readInt(4)?null:f.utf8decode(_.readData(c.length-5))}return null}},i.exports=p},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,i,a){function r(_,v,g){this.name=_,this.dir=g.dir,this.date=g.date,this.comment=g.comment,this.unixPermissions=g.unixPermissions,this.dosPermissions=g.dosPermissions,this._data=v,this._dataBinary=g.binary,this.options={compression:g.compression,compressionOptions:g.compressionOptions}}var l=n("./stream/StreamHelper"),s=n("./stream/DataWorker"),o=n("./utf8"),f=n("./compressedObject"),h=n("./stream/GenericWorker");r.prototype={internalStream:function(_){var v=null,g="string";try{if(!_)throw new Error("No output type specified.");var b=(g=_.toLowerCase())==="string"||g==="text";g!=="binarystring"&&g!=="text"||(g="string"),v=this._decompressWorker();var y=!this._dataBinary;y&&!b&&(v=v.pipe(new o.Utf8EncodeWorker)),!y&&b&&(v=v.pipe(new o.Utf8DecodeWorker))}catch(x){(v=new h("error")).error(x)}return new l(v,g,"")},async:function(_,v){return this.internalStream(_).accumulate(v)},nodeStream:function(_,v){return this.internalStream(_||"nodebuffer").toNodejsStream(v)},_compressWorker:function(_,v){if(this._data instanceof f&&this._data.compression.magic===_.magic)return this._data.getCompressedWorker();var g=this._decompressWorker();return this._dataBinary||(g=g.pipe(new o.Utf8EncodeWorker)),f.createWorkerFrom(g,_,v)},_decompressWorker:function(){return this._data instanceof f?this._data.getContentWorker():this._data instanceof h?this._data:new s(this._data)}};for(var m=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],p=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},c=0;c<m.length;c++)r.prototype[m[c]]=p;i.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,i,a){(function(r){var l,s,o=r.MutationObserver||r.WebKitMutationObserver;if(o){var f=0,h=new o(_),m=r.document.createTextNode("");h.observe(m,{characterData:!0}),l=function(){m.data=f=++f%2}}else if(r.setImmediate||r.MessageChannel===void 0)l="document"in r&&"onreadystatechange"in r.document.createElement("script")?function(){var v=r.document.createElement("script");v.onreadystatechange=function(){_(),v.onreadystatechange=null,v.parentNode.removeChild(v),v=null},r.document.documentElement.appendChild(v)}:function(){setTimeout(_,0)};else{var p=new r.MessageChannel;p.port1.onmessage=_,l=function(){p.port2.postMessage(0)}}var c=[];function _(){var v,g;s=!0;for(var b=c.length;b;){for(g=c,c=[],v=-1;++v<b;)g[v]();b=c.length}s=!1}i.exports=function(v){c.push(v)!==1||s||l()}}).call(this,typeof Ao!="undefined"?Ao:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],37:[function(n,i,a){var r=n("immediate");function l(){}var s={},o=["REJECTED"],f=["FULFILLED"],h=["PENDING"];function m(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,b!==l&&v(this,b)}function p(b,y,x){this.promise=b,typeof y=="function"&&(this.onFulfilled=y,this.callFulfilled=this.otherCallFulfilled),typeof x=="function"&&(this.onRejected=x,this.callRejected=this.otherCallRejected)}function c(b,y,x){r(function(){var T;try{T=y(x)}catch(D){return s.reject(b,D)}T===b?s.reject(b,new TypeError("Cannot resolve promise with itself")):s.resolve(b,T)})}function _(b){var y=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof y=="function")return function(){y.apply(b,arguments)}}function v(b,y){var x=!1;function T(N){x||(x=!0,s.reject(b,N))}function D(N){x||(x=!0,s.resolve(b,N))}var j=g(function(){y(D,T)});j.status==="error"&&T(j.value)}function g(b,y){var x={};try{x.value=b(y),x.status="success"}catch(T){x.status="error",x.value=T}return x}(i.exports=m).prototype.finally=function(b){if(typeof b!="function")return this;var y=this.constructor;return this.then(function(x){return y.resolve(b()).then(function(){return x})},function(x){return y.resolve(b()).then(function(){throw x})})},m.prototype.catch=function(b){return this.then(null,b)},m.prototype.then=function(b,y){if(typeof b!="function"&&this.state===f||typeof y!="function"&&this.state===o)return this;var x=new this.constructor(l);return this.state!==h?c(x,this.state===f?b:y,this.outcome):this.queue.push(new p(x,b,y)),x},p.prototype.callFulfilled=function(b){s.resolve(this.promise,b)},p.prototype.otherCallFulfilled=function(b){c(this.promise,this.onFulfilled,b)},p.prototype.callRejected=function(b){s.reject(this.promise,b)},p.prototype.otherCallRejected=function(b){c(this.promise,this.onRejected,b)},s.resolve=function(b,y){var x=g(_,y);if(x.status==="error")return s.reject(b,x.value);var T=x.value;if(T)v(b,T);else{b.state=f,b.outcome=y;for(var D=-1,j=b.queue.length;++D<j;)b.queue[D].callFulfilled(y)}return b},s.reject=function(b,y){b.state=o,b.outcome=y;for(var x=-1,T=b.queue.length;++x<T;)b.queue[x].callRejected(y);return b},m.resolve=function(b){return b instanceof this?b:s.resolve(new this(l),b)},m.reject=function(b){var y=new this(l);return s.reject(y,b)},m.all=function(b){var y=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var x=b.length,T=!1;if(!x)return this.resolve([]);for(var D=new Array(x),j=0,N=-1,Y=new this(l);++N<x;)B(b[N],N);return Y;function B(U,K){y.resolve(U).then(function(k){D[K]=k,++j!==x||T||(T=!0,s.resolve(Y,D))},function(k){T||(T=!0,s.reject(Y,k))})}},m.race=function(b){var y=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var x=b.length,T=!1;if(!x)return this.resolve([]);for(var D=-1,j=new this(l);++D<x;)N=b[D],y.resolve(N).then(function(Y){T||(T=!0,s.resolve(j,Y))},function(Y){T||(T=!0,s.reject(j,Y))});var N;return j}},{immediate:36}],38:[function(n,i,a){var r={};(0,n("./lib/utils/common").assign)(r,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),i.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,i,a){var r=n("./zlib/deflate"),l=n("./utils/common"),s=n("./utils/strings"),o=n("./zlib/messages"),f=n("./zlib/zstream"),h=Object.prototype.toString,m=0,p=-1,c=0,_=8;function v(b){if(!(this instanceof v))return new v(b);this.options=l.assign({level:p,method:_,chunkSize:16384,windowBits:15,memLevel:8,strategy:c,to:""},b||{});var y=this.options;y.raw&&0<y.windowBits?y.windowBits=-y.windowBits:y.gzip&&0<y.windowBits&&y.windowBits<16&&(y.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var x=r.deflateInit2(this.strm,y.level,y.method,y.windowBits,y.memLevel,y.strategy);if(x!==m)throw new Error(o[x]);if(y.header&&r.deflateSetHeader(this.strm,y.header),y.dictionary){var T;if(T=typeof y.dictionary=="string"?s.string2buf(y.dictionary):h.call(y.dictionary)==="[object ArrayBuffer]"?new Uint8Array(y.dictionary):y.dictionary,(x=r.deflateSetDictionary(this.strm,T))!==m)throw new Error(o[x]);this._dict_set=!0}}function g(b,y){var x=new v(y);if(x.push(b,!0),x.err)throw x.msg||o[x.err];return x.result}v.prototype.push=function(b,y){var x,T,D=this.strm,j=this.options.chunkSize;if(this.ended)return!1;T=y===~~y?y:y===!0?4:0,typeof b=="string"?D.input=s.string2buf(b):h.call(b)==="[object ArrayBuffer]"?D.input=new Uint8Array(b):D.input=b,D.next_in=0,D.avail_in=D.input.length;do{if(D.avail_out===0&&(D.output=new l.Buf8(j),D.next_out=0,D.avail_out=j),(x=r.deflate(D,T))!==1&&x!==m)return this.onEnd(x),!(this.ended=!0);D.avail_out!==0&&(D.avail_in!==0||T!==4&&T!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(l.shrinkBuf(D.output,D.next_out))):this.onData(l.shrinkBuf(D.output,D.next_out)))}while((0<D.avail_in||D.avail_out===0)&&x!==1);return T===4?(x=r.deflateEnd(this.strm),this.onEnd(x),this.ended=!0,x===m):T!==2||(this.onEnd(m),!(D.avail_out=0))},v.prototype.onData=function(b){this.chunks.push(b)},v.prototype.onEnd=function(b){b===m&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},a.Deflate=v,a.deflate=g,a.deflateRaw=function(b,y){return(y=y||{}).raw=!0,g(b,y)},a.gzip=function(b,y){return(y=y||{}).gzip=!0,g(b,y)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,i,a){var r=n("./zlib/inflate"),l=n("./utils/common"),s=n("./utils/strings"),o=n("./zlib/constants"),f=n("./zlib/messages"),h=n("./zlib/zstream"),m=n("./zlib/gzheader"),p=Object.prototype.toString;function c(v){if(!(this instanceof c))return new c(v);this.options=l.assign({chunkSize:16384,windowBits:0,to:""},v||{});var g=this.options;g.raw&&0<=g.windowBits&&g.windowBits<16&&(g.windowBits=-g.windowBits,g.windowBits===0&&(g.windowBits=-15)),!(0<=g.windowBits&&g.windowBits<16)||v&&v.windowBits||(g.windowBits+=32),15<g.windowBits&&g.windowBits<48&&(15&g.windowBits)==0&&(g.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var b=r.inflateInit2(this.strm,g.windowBits);if(b!==o.Z_OK)throw new Error(f[b]);this.header=new m,r.inflateGetHeader(this.strm,this.header)}function _(v,g){var b=new c(g);if(b.push(v,!0),b.err)throw b.msg||f[b.err];return b.result}c.prototype.push=function(v,g){var b,y,x,T,D,j,N=this.strm,Y=this.options.chunkSize,B=this.options.dictionary,U=!1;if(this.ended)return!1;y=g===~~g?g:g===!0?o.Z_FINISH:o.Z_NO_FLUSH,typeof v=="string"?N.input=s.binstring2buf(v):p.call(v)==="[object ArrayBuffer]"?N.input=new Uint8Array(v):N.input=v,N.next_in=0,N.avail_in=N.input.length;do{if(N.avail_out===0&&(N.output=new l.Buf8(Y),N.next_out=0,N.avail_out=Y),(b=r.inflate(N,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&B&&(j=typeof B=="string"?s.string2buf(B):p.call(B)==="[object ArrayBuffer]"?new Uint8Array(B):B,b=r.inflateSetDictionary(this.strm,j)),b===o.Z_BUF_ERROR&&U===!0&&(b=o.Z_OK,U=!1),b!==o.Z_STREAM_END&&b!==o.Z_OK)return this.onEnd(b),!(this.ended=!0);N.next_out&&(N.avail_out!==0&&b!==o.Z_STREAM_END&&(N.avail_in!==0||y!==o.Z_FINISH&&y!==o.Z_SYNC_FLUSH)||(this.options.to==="string"?(x=s.utf8border(N.output,N.next_out),T=N.next_out-x,D=s.buf2string(N.output,x),N.next_out=T,N.avail_out=Y-T,T&&l.arraySet(N.output,N.output,x,T,0),this.onData(D)):this.onData(l.shrinkBuf(N.output,N.next_out)))),N.avail_in===0&&N.avail_out===0&&(U=!0)}while((0<N.avail_in||N.avail_out===0)&&b!==o.Z_STREAM_END);return b===o.Z_STREAM_END&&(y=o.Z_FINISH),y===o.Z_FINISH?(b=r.inflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===o.Z_OK):y!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(N.avail_out=0))},c.prototype.onData=function(v){this.chunks.push(v)},c.prototype.onEnd=function(v){v===o.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},a.Inflate=c,a.inflate=_,a.inflateRaw=function(v,g){return(g=g||{}).raw=!0,_(v,g)},a.ungzip=_},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,i,a){var r=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";a.assign=function(o){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var h=f.shift();if(h){if(typeof h!="object")throw new TypeError(h+"must be non-object");for(var m in h)h.hasOwnProperty(m)&&(o[m]=h[m])}}return o},a.shrinkBuf=function(o,f){return o.length===f?o:o.subarray?o.subarray(0,f):(o.length=f,o)};var l={arraySet:function(o,f,h,m,p){if(f.subarray&&o.subarray)o.set(f.subarray(h,h+m),p);else for(var c=0;c<m;c++)o[p+c]=f[h+c]},flattenChunks:function(o){var f,h,m,p,c,_;for(f=m=0,h=o.length;f<h;f++)m+=o[f].length;for(_=new Uint8Array(m),f=p=0,h=o.length;f<h;f++)c=o[f],_.set(c,p),p+=c.length;return _}},s={arraySet:function(o,f,h,m,p){for(var c=0;c<m;c++)o[p+c]=f[h+c]},flattenChunks:function(o){return[].concat.apply([],o)}};a.setTyped=function(o){o?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,l)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,s))},a.setTyped(r)},{}],42:[function(n,i,a){var r=n("./common"),l=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{l=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var o=new r.Buf8(256),f=0;f<256;f++)o[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;function h(m,p){if(p<65537&&(m.subarray&&s||!m.subarray&&l))return String.fromCharCode.apply(null,r.shrinkBuf(m,p));for(var c="",_=0;_<p;_++)c+=String.fromCharCode(m[_]);return c}o[254]=o[254]=1,a.string2buf=function(m){var p,c,_,v,g,b=m.length,y=0;for(v=0;v<b;v++)(64512&(c=m.charCodeAt(v)))==55296&&v+1<b&&(64512&(_=m.charCodeAt(v+1)))==56320&&(c=65536+(c-55296<<10)+(_-56320),v++),y+=c<128?1:c<2048?2:c<65536?3:4;for(p=new r.Buf8(y),v=g=0;g<y;v++)(64512&(c=m.charCodeAt(v)))==55296&&v+1<b&&(64512&(_=m.charCodeAt(v+1)))==56320&&(c=65536+(c-55296<<10)+(_-56320),v++),c<128?p[g++]=c:(c<2048?p[g++]=192|c>>>6:(c<65536?p[g++]=224|c>>>12:(p[g++]=240|c>>>18,p[g++]=128|c>>>12&63),p[g++]=128|c>>>6&63),p[g++]=128|63&c);return p},a.buf2binstring=function(m){return h(m,m.length)},a.binstring2buf=function(m){for(var p=new r.Buf8(m.length),c=0,_=p.length;c<_;c++)p[c]=m.charCodeAt(c);return p},a.buf2string=function(m,p){var c,_,v,g,b=p||m.length,y=new Array(2*b);for(c=_=0;c<b;)if((v=m[c++])<128)y[_++]=v;else if(4<(g=o[v]))y[_++]=65533,c+=g-1;else{for(v&=g===2?31:g===3?15:7;1<g&&c<b;)v=v<<6|63&m[c++],g--;1<g?y[_++]=65533:v<65536?y[_++]=v:(v-=65536,y[_++]=55296|v>>10&1023,y[_++]=56320|1023&v)}return h(y,_)},a.utf8border=function(m,p){var c;for((p=p||m.length)>m.length&&(p=m.length),c=p-1;0<=c&&(192&m[c])==128;)c--;return c<0||c===0?p:c+o[m[c]]>p?c:p}},{"./common":41}],43:[function(n,i,a){i.exports=function(r,l,s,o){for(var f=65535&r|0,h=r>>>16&65535|0,m=0;s!==0;){for(s-=m=2e3<s?2e3:s;h=h+(f=f+l[o++]|0)|0,--m;);f%=65521,h%=65521}return f|h<<16|0}},{}],44:[function(n,i,a){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,i,a){var r=function(){for(var l,s=[],o=0;o<256;o++){l=o;for(var f=0;f<8;f++)l=1&l?3988292384^l>>>1:l>>>1;s[o]=l}return s}();i.exports=function(l,s,o,f){var h=r,m=f+o;l^=-1;for(var p=f;p<m;p++)l=l>>>8^h[255&(l^s[p])];return-1^l}},{}],46:[function(n,i,a){var r,l=n("../utils/common"),s=n("./trees"),o=n("./adler32"),f=n("./crc32"),h=n("./messages"),m=0,p=4,c=0,_=-2,v=-1,g=4,b=2,y=8,x=9,T=286,D=30,j=19,N=2*T+1,Y=15,B=3,U=258,K=U+B+1,k=42,A=113,u=1,S=2,J=3,z=4;function it(d,O){return d.msg=h[O],O}function X(d){return(d<<1)-(4<d?9:0)}function Q(d){for(var O=d.length;0<=--O;)d[O]=0}function R(d){var O=d.state,I=O.pending;I>d.avail_out&&(I=d.avail_out),I!==0&&(l.arraySet(d.output,O.pending_buf,O.pending_out,I,d.next_out),d.next_out+=I,O.pending_out+=I,d.total_out+=I,d.avail_out-=I,O.pending-=I,O.pending===0&&(O.pending_out=0))}function $(d,O){s._tr_flush_block(d,0<=d.block_start?d.block_start:-1,d.strstart-d.block_start,O),d.block_start=d.strstart,R(d.strm)}function et(d,O){d.pending_buf[d.pending++]=O}function G(d,O){d.pending_buf[d.pending++]=O>>>8&255,d.pending_buf[d.pending++]=255&O}function V(d,O){var I,E,w=d.max_chain_length,C=d.strstart,F=d.prev_length,H=d.nice_match,L=d.strstart>d.w_size-K?d.strstart-(d.w_size-K):0,W=d.window,Z=d.w_mask,q=d.prev,tt=d.strstart+U,dt=W[C+F-1],ot=W[C+F];d.prev_length>=d.good_match&&(w>>=2),H>d.lookahead&&(H=d.lookahead);do if(W[(I=O)+F]===ot&&W[I+F-1]===dt&&W[I]===W[C]&&W[++I]===W[C+1]){C+=2,I++;do;while(W[++C]===W[++I]&&W[++C]===W[++I]&&W[++C]===W[++I]&&W[++C]===W[++I]&&W[++C]===W[++I]&&W[++C]===W[++I]&&W[++C]===W[++I]&&W[++C]===W[++I]&&C<tt);if(E=U-(tt-C),C=tt-U,F<E){if(d.match_start=O,H<=(F=E))break;dt=W[C+F-1],ot=W[C+F]}}while((O=q[O&Z])>L&&--w!=0);return F<=d.lookahead?F:d.lookahead}function pt(d){var O,I,E,w,C,F,H,L,W,Z,q=d.w_size;do{if(w=d.window_size-d.lookahead-d.strstart,d.strstart>=q+(q-K)){for(l.arraySet(d.window,d.window,q,q,0),d.match_start-=q,d.strstart-=q,d.block_start-=q,O=I=d.hash_size;E=d.head[--O],d.head[O]=q<=E?E-q:0,--I;);for(O=I=q;E=d.prev[--O],d.prev[O]=q<=E?E-q:0,--I;);w+=q}if(d.strm.avail_in===0)break;if(F=d.strm,H=d.window,L=d.strstart+d.lookahead,W=w,Z=void 0,Z=F.avail_in,W<Z&&(Z=W),I=Z===0?0:(F.avail_in-=Z,l.arraySet(H,F.input,F.next_in,Z,L),F.state.wrap===1?F.adler=o(F.adler,H,Z,L):F.state.wrap===2&&(F.adler=f(F.adler,H,Z,L)),F.next_in+=Z,F.total_in+=Z,Z),d.lookahead+=I,d.lookahead+d.insert>=B)for(C=d.strstart-d.insert,d.ins_h=d.window[C],d.ins_h=(d.ins_h<<d.hash_shift^d.window[C+1])&d.hash_mask;d.insert&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[C+B-1])&d.hash_mask,d.prev[C&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=C,C++,d.insert--,!(d.lookahead+d.insert<B)););}while(d.lookahead<K&&d.strm.avail_in!==0)}function Lt(d,O){for(var I,E;;){if(d.lookahead<K){if(pt(d),d.lookahead<K&&O===m)return u;if(d.lookahead===0)break}if(I=0,d.lookahead>=B&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+B-1])&d.hash_mask,I=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),I!==0&&d.strstart-I<=d.w_size-K&&(d.match_length=V(d,I)),d.match_length>=B)if(E=s._tr_tally(d,d.strstart-d.match_start,d.match_length-B),d.lookahead-=d.match_length,d.match_length<=d.max_lazy_match&&d.lookahead>=B){for(d.match_length--;d.strstart++,d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+B-1])&d.hash_mask,I=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart,--d.match_length!=0;);d.strstart++}else d.strstart+=d.match_length,d.match_length=0,d.ins_h=d.window[d.strstart],d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+1])&d.hash_mask;else E=s._tr_tally(d,0,d.window[d.strstart]),d.lookahead--,d.strstart++;if(E&&($(d,!1),d.strm.avail_out===0))return u}return d.insert=d.strstart<B-1?d.strstart:B-1,O===p?($(d,!0),d.strm.avail_out===0?J:z):d.last_lit&&($(d,!1),d.strm.avail_out===0)?u:S}function at(d,O){for(var I,E,w;;){if(d.lookahead<K){if(pt(d),d.lookahead<K&&O===m)return u;if(d.lookahead===0)break}if(I=0,d.lookahead>=B&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+B-1])&d.hash_mask,I=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),d.prev_length=d.match_length,d.prev_match=d.match_start,d.match_length=B-1,I!==0&&d.prev_length<d.max_lazy_match&&d.strstart-I<=d.w_size-K&&(d.match_length=V(d,I),d.match_length<=5&&(d.strategy===1||d.match_length===B&&4096<d.strstart-d.match_start)&&(d.match_length=B-1)),d.prev_length>=B&&d.match_length<=d.prev_length){for(w=d.strstart+d.lookahead-B,E=s._tr_tally(d,d.strstart-1-d.prev_match,d.prev_length-B),d.lookahead-=d.prev_length-1,d.prev_length-=2;++d.strstart<=w&&(d.ins_h=(d.ins_h<<d.hash_shift^d.window[d.strstart+B-1])&d.hash_mask,I=d.prev[d.strstart&d.w_mask]=d.head[d.ins_h],d.head[d.ins_h]=d.strstart),--d.prev_length!=0;);if(d.match_available=0,d.match_length=B-1,d.strstart++,E&&($(d,!1),d.strm.avail_out===0))return u}else if(d.match_available){if((E=s._tr_tally(d,0,d.window[d.strstart-1]))&&$(d,!1),d.strstart++,d.lookahead--,d.strm.avail_out===0)return u}else d.match_available=1,d.strstart++,d.lookahead--}return d.match_available&&(E=s._tr_tally(d,0,d.window[d.strstart-1]),d.match_available=0),d.insert=d.strstart<B-1?d.strstart:B-1,O===p?($(d,!0),d.strm.avail_out===0?J:z):d.last_lit&&($(d,!1),d.strm.avail_out===0)?u:S}function st(d,O,I,E,w){this.good_length=d,this.max_lazy=O,this.nice_length=I,this.max_chain=E,this.func=w}function Et(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new l.Buf16(2*N),this.dyn_dtree=new l.Buf16(2*(2*D+1)),this.bl_tree=new l.Buf16(2*(2*j+1)),Q(this.dyn_ltree),Q(this.dyn_dtree),Q(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new l.Buf16(Y+1),this.heap=new l.Buf16(2*T+1),Q(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new l.Buf16(2*T+1),Q(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function gt(d){var O;return d&&d.state?(d.total_in=d.total_out=0,d.data_type=b,(O=d.state).pending=0,O.pending_out=0,O.wrap<0&&(O.wrap=-O.wrap),O.status=O.wrap?k:A,d.adler=O.wrap===2?0:1,O.last_flush=m,s._tr_init(O),c):it(d,_)}function ce(d){var O=gt(d);return O===c&&function(I){I.window_size=2*I.w_size,Q(I.head),I.max_lazy_match=r[I.level].max_lazy,I.good_match=r[I.level].good_length,I.nice_match=r[I.level].nice_length,I.max_chain_length=r[I.level].max_chain,I.strstart=0,I.block_start=0,I.lookahead=0,I.insert=0,I.match_length=I.prev_length=B-1,I.match_available=0,I.ins_h=0}(d.state),O}function Kt(d,O,I,E,w,C){if(!d)return _;var F=1;if(O===v&&(O=6),E<0?(F=0,E=-E):15<E&&(F=2,E-=16),w<1||x<w||I!==y||E<8||15<E||O<0||9<O||C<0||g<C)return it(d,_);E===8&&(E=9);var H=new Et;return(d.state=H).strm=d,H.wrap=F,H.gzhead=null,H.w_bits=E,H.w_size=1<<H.w_bits,H.w_mask=H.w_size-1,H.hash_bits=w+7,H.hash_size=1<<H.hash_bits,H.hash_mask=H.hash_size-1,H.hash_shift=~~((H.hash_bits+B-1)/B),H.window=new l.Buf8(2*H.w_size),H.head=new l.Buf16(H.hash_size),H.prev=new l.Buf16(H.w_size),H.lit_bufsize=1<<w+6,H.pending_buf_size=4*H.lit_bufsize,H.pending_buf=new l.Buf8(H.pending_buf_size),H.d_buf=1*H.lit_bufsize,H.l_buf=3*H.lit_bufsize,H.level=O,H.strategy=C,H.method=I,ce(d)}r=[new st(0,0,0,0,function(d,O){var I=65535;for(I>d.pending_buf_size-5&&(I=d.pending_buf_size-5);;){if(d.lookahead<=1){if(pt(d),d.lookahead===0&&O===m)return u;if(d.lookahead===0)break}d.strstart+=d.lookahead,d.lookahead=0;var E=d.block_start+I;if((d.strstart===0||d.strstart>=E)&&(d.lookahead=d.strstart-E,d.strstart=E,$(d,!1),d.strm.avail_out===0)||d.strstart-d.block_start>=d.w_size-K&&($(d,!1),d.strm.avail_out===0))return u}return d.insert=0,O===p?($(d,!0),d.strm.avail_out===0?J:z):(d.strstart>d.block_start&&($(d,!1),d.strm.avail_out),u)}),new st(4,4,8,4,Lt),new st(4,5,16,8,Lt),new st(4,6,32,32,Lt),new st(4,4,16,16,at),new st(8,16,32,32,at),new st(8,16,128,128,at),new st(8,32,128,256,at),new st(32,128,258,1024,at),new st(32,258,258,4096,at)],a.deflateInit=function(d,O){return Kt(d,O,y,15,8,0)},a.deflateInit2=Kt,a.deflateReset=ce,a.deflateResetKeep=gt,a.deflateSetHeader=function(d,O){return d&&d.state?d.state.wrap!==2?_:(d.state.gzhead=O,c):_},a.deflate=function(d,O){var I,E,w,C;if(!d||!d.state||5<O||O<0)return d?it(d,_):_;if(E=d.state,!d.output||!d.input&&d.avail_in!==0||E.status===666&&O!==p)return it(d,d.avail_out===0?-5:_);if(E.strm=d,I=E.last_flush,E.last_flush=O,E.status===k)if(E.wrap===2)d.adler=0,et(E,31),et(E,139),et(E,8),E.gzhead?(et(E,(E.gzhead.text?1:0)+(E.gzhead.hcrc?2:0)+(E.gzhead.extra?4:0)+(E.gzhead.name?8:0)+(E.gzhead.comment?16:0)),et(E,255&E.gzhead.time),et(E,E.gzhead.time>>8&255),et(E,E.gzhead.time>>16&255),et(E,E.gzhead.time>>24&255),et(E,E.level===9?2:2<=E.strategy||E.level<2?4:0),et(E,255&E.gzhead.os),E.gzhead.extra&&E.gzhead.extra.length&&(et(E,255&E.gzhead.extra.length),et(E,E.gzhead.extra.length>>8&255)),E.gzhead.hcrc&&(d.adler=f(d.adler,E.pending_buf,E.pending,0)),E.gzindex=0,E.status=69):(et(E,0),et(E,0),et(E,0),et(E,0),et(E,0),et(E,E.level===9?2:2<=E.strategy||E.level<2?4:0),et(E,3),E.status=A);else{var F=y+(E.w_bits-8<<4)<<8;F|=(2<=E.strategy||E.level<2?0:E.level<6?1:E.level===6?2:3)<<6,E.strstart!==0&&(F|=32),F+=31-F%31,E.status=A,G(E,F),E.strstart!==0&&(G(E,d.adler>>>16),G(E,65535&d.adler)),d.adler=1}if(E.status===69)if(E.gzhead.extra){for(w=E.pending;E.gzindex<(65535&E.gzhead.extra.length)&&(E.pending!==E.pending_buf_size||(E.gzhead.hcrc&&E.pending>w&&(d.adler=f(d.adler,E.pending_buf,E.pending-w,w)),R(d),w=E.pending,E.pending!==E.pending_buf_size));)et(E,255&E.gzhead.extra[E.gzindex]),E.gzindex++;E.gzhead.hcrc&&E.pending>w&&(d.adler=f(d.adler,E.pending_buf,E.pending-w,w)),E.gzindex===E.gzhead.extra.length&&(E.gzindex=0,E.status=73)}else E.status=73;if(E.status===73)if(E.gzhead.name){w=E.pending;do{if(E.pending===E.pending_buf_size&&(E.gzhead.hcrc&&E.pending>w&&(d.adler=f(d.adler,E.pending_buf,E.pending-w,w)),R(d),w=E.pending,E.pending===E.pending_buf_size)){C=1;break}C=E.gzindex<E.gzhead.name.length?255&E.gzhead.name.charCodeAt(E.gzindex++):0,et(E,C)}while(C!==0);E.gzhead.hcrc&&E.pending>w&&(d.adler=f(d.adler,E.pending_buf,E.pending-w,w)),C===0&&(E.gzindex=0,E.status=91)}else E.status=91;if(E.status===91)if(E.gzhead.comment){w=E.pending;do{if(E.pending===E.pending_buf_size&&(E.gzhead.hcrc&&E.pending>w&&(d.adler=f(d.adler,E.pending_buf,E.pending-w,w)),R(d),w=E.pending,E.pending===E.pending_buf_size)){C=1;break}C=E.gzindex<E.gzhead.comment.length?255&E.gzhead.comment.charCodeAt(E.gzindex++):0,et(E,C)}while(C!==0);E.gzhead.hcrc&&E.pending>w&&(d.adler=f(d.adler,E.pending_buf,E.pending-w,w)),C===0&&(E.status=103)}else E.status=103;if(E.status===103&&(E.gzhead.hcrc?(E.pending+2>E.pending_buf_size&&R(d),E.pending+2<=E.pending_buf_size&&(et(E,255&d.adler),et(E,d.adler>>8&255),d.adler=0,E.status=A)):E.status=A),E.pending!==0){if(R(d),d.avail_out===0)return E.last_flush=-1,c}else if(d.avail_in===0&&X(O)<=X(I)&&O!==p)return it(d,-5);if(E.status===666&&d.avail_in!==0)return it(d,-5);if(d.avail_in!==0||E.lookahead!==0||O!==m&&E.status!==666){var H=E.strategy===2?function(L,W){for(var Z;;){if(L.lookahead===0&&(pt(L),L.lookahead===0)){if(W===m)return u;break}if(L.match_length=0,Z=s._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++,Z&&($(L,!1),L.strm.avail_out===0))return u}return L.insert=0,W===p?($(L,!0),L.strm.avail_out===0?J:z):L.last_lit&&($(L,!1),L.strm.avail_out===0)?u:S}(E,O):E.strategy===3?function(L,W){for(var Z,q,tt,dt,ot=L.window;;){if(L.lookahead<=U){if(pt(L),L.lookahead<=U&&W===m)return u;if(L.lookahead===0)break}if(L.match_length=0,L.lookahead>=B&&0<L.strstart&&(q=ot[tt=L.strstart-1])===ot[++tt]&&q===ot[++tt]&&q===ot[++tt]){dt=L.strstart+U;do;while(q===ot[++tt]&&q===ot[++tt]&&q===ot[++tt]&&q===ot[++tt]&&q===ot[++tt]&&q===ot[++tt]&&q===ot[++tt]&&q===ot[++tt]&&tt<dt);L.match_length=U-(dt-tt),L.match_length>L.lookahead&&(L.match_length=L.lookahead)}if(L.match_length>=B?(Z=s._tr_tally(L,1,L.match_length-B),L.lookahead-=L.match_length,L.strstart+=L.match_length,L.match_length=0):(Z=s._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++),Z&&($(L,!1),L.strm.avail_out===0))return u}return L.insert=0,W===p?($(L,!0),L.strm.avail_out===0?J:z):L.last_lit&&($(L,!1),L.strm.avail_out===0)?u:S}(E,O):r[E.level].func(E,O);if(H!==J&&H!==z||(E.status=666),H===u||H===J)return d.avail_out===0&&(E.last_flush=-1),c;if(H===S&&(O===1?s._tr_align(E):O!==5&&(s._tr_stored_block(E,0,0,!1),O===3&&(Q(E.head),E.lookahead===0&&(E.strstart=0,E.block_start=0,E.insert=0))),R(d),d.avail_out===0))return E.last_flush=-1,c}return O!==p?c:E.wrap<=0?1:(E.wrap===2?(et(E,255&d.adler),et(E,d.adler>>8&255),et(E,d.adler>>16&255),et(E,d.adler>>24&255),et(E,255&d.total_in),et(E,d.total_in>>8&255),et(E,d.total_in>>16&255),et(E,d.total_in>>24&255)):(G(E,d.adler>>>16),G(E,65535&d.adler)),R(d),0<E.wrap&&(E.wrap=-E.wrap),E.pending!==0?c:1)},a.deflateEnd=function(d){var O;return d&&d.state?(O=d.state.status)!==k&&O!==69&&O!==73&&O!==91&&O!==103&&O!==A&&O!==666?it(d,_):(d.state=null,O===A?it(d,-3):c):_},a.deflateSetDictionary=function(d,O){var I,E,w,C,F,H,L,W,Z=O.length;if(!d||!d.state||(C=(I=d.state).wrap)===2||C===1&&I.status!==k||I.lookahead)return _;for(C===1&&(d.adler=o(d.adler,O,Z,0)),I.wrap=0,Z>=I.w_size&&(C===0&&(Q(I.head),I.strstart=0,I.block_start=0,I.insert=0),W=new l.Buf8(I.w_size),l.arraySet(W,O,Z-I.w_size,I.w_size,0),O=W,Z=I.w_size),F=d.avail_in,H=d.next_in,L=d.input,d.avail_in=Z,d.next_in=0,d.input=O,pt(I);I.lookahead>=B;){for(E=I.strstart,w=I.lookahead-(B-1);I.ins_h=(I.ins_h<<I.hash_shift^I.window[E+B-1])&I.hash_mask,I.prev[E&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=E,E++,--w;);I.strstart=E,I.lookahead=B-1,pt(I)}return I.strstart+=I.lookahead,I.block_start=I.strstart,I.insert=I.lookahead,I.lookahead=0,I.match_length=I.prev_length=B-1,I.match_available=0,d.next_in=H,d.input=L,d.avail_in=F,I.wrap=C,c},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,i,a){i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,i,a){i.exports=function(r,l){var s,o,f,h,m,p,c,_,v,g,b,y,x,T,D,j,N,Y,B,U,K,k,A,u,S;s=r.state,o=r.next_in,u=r.input,f=o+(r.avail_in-5),h=r.next_out,S=r.output,m=h-(l-r.avail_out),p=h+(r.avail_out-257),c=s.dmax,_=s.wsize,v=s.whave,g=s.wnext,b=s.window,y=s.hold,x=s.bits,T=s.lencode,D=s.distcode,j=(1<<s.lenbits)-1,N=(1<<s.distbits)-1;t:do{x<15&&(y+=u[o++]<<x,x+=8,y+=u[o++]<<x,x+=8),Y=T[y&j];e:for(;;){if(y>>>=B=Y>>>24,x-=B,(B=Y>>>16&255)===0)S[h++]=65535&Y;else{if(!(16&B)){if((64&B)==0){Y=T[(65535&Y)+(y&(1<<B)-1)];continue e}if(32&B){s.mode=12;break t}r.msg="invalid literal/length code",s.mode=30;break t}U=65535&Y,(B&=15)&&(x<B&&(y+=u[o++]<<x,x+=8),U+=y&(1<<B)-1,y>>>=B,x-=B),x<15&&(y+=u[o++]<<x,x+=8,y+=u[o++]<<x,x+=8),Y=D[y&N];n:for(;;){if(y>>>=B=Y>>>24,x-=B,!(16&(B=Y>>>16&255))){if((64&B)==0){Y=D[(65535&Y)+(y&(1<<B)-1)];continue n}r.msg="invalid distance code",s.mode=30;break t}if(K=65535&Y,x<(B&=15)&&(y+=u[o++]<<x,(x+=8)<B&&(y+=u[o++]<<x,x+=8)),c<(K+=y&(1<<B)-1)){r.msg="invalid distance too far back",s.mode=30;break t}if(y>>>=B,x-=B,(B=h-m)<K){if(v<(B=K-B)&&s.sane){r.msg="invalid distance too far back",s.mode=30;break t}if(A=b,(k=0)===g){if(k+=_-B,B<U){for(U-=B;S[h++]=b[k++],--B;);k=h-K,A=S}}else if(g<B){if(k+=_+g-B,(B-=g)<U){for(U-=B;S[h++]=b[k++],--B;);if(k=0,g<U){for(U-=B=g;S[h++]=b[k++],--B;);k=h-K,A=S}}}else if(k+=g-B,B<U){for(U-=B;S[h++]=b[k++],--B;);k=h-K,A=S}for(;2<U;)S[h++]=A[k++],S[h++]=A[k++],S[h++]=A[k++],U-=3;U&&(S[h++]=A[k++],1<U&&(S[h++]=A[k++]))}else{for(k=h-K;S[h++]=S[k++],S[h++]=S[k++],S[h++]=S[k++],2<(U-=3););U&&(S[h++]=S[k++],1<U&&(S[h++]=S[k++]))}break}}break}}while(o<f&&h<p);o-=U=x>>3,y&=(1<<(x-=U<<3))-1,r.next_in=o,r.next_out=h,r.avail_in=o<f?f-o+5:5-(o-f),r.avail_out=h<p?p-h+257:257-(h-p),s.hold=y,s.bits=x}},{}],49:[function(n,i,a){var r=n("../utils/common"),l=n("./adler32"),s=n("./crc32"),o=n("./inffast"),f=n("./inftrees"),h=1,m=2,p=0,c=-2,_=1,v=852,g=592;function b(k){return(k>>>24&255)+(k>>>8&65280)+((65280&k)<<8)+((255&k)<<24)}function y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function x(k){var A;return k&&k.state?(A=k.state,k.total_in=k.total_out=A.total=0,k.msg="",A.wrap&&(k.adler=1&A.wrap),A.mode=_,A.last=0,A.havedict=0,A.dmax=32768,A.head=null,A.hold=0,A.bits=0,A.lencode=A.lendyn=new r.Buf32(v),A.distcode=A.distdyn=new r.Buf32(g),A.sane=1,A.back=-1,p):c}function T(k){var A;return k&&k.state?((A=k.state).wsize=0,A.whave=0,A.wnext=0,x(k)):c}function D(k,A){var u,S;return k&&k.state?(S=k.state,A<0?(u=0,A=-A):(u=1+(A>>4),A<48&&(A&=15)),A&&(A<8||15<A)?c:(S.window!==null&&S.wbits!==A&&(S.window=null),S.wrap=u,S.wbits=A,T(k))):c}function j(k,A){var u,S;return k?(S=new y,(k.state=S).window=null,(u=D(k,A))!==p&&(k.state=null),u):c}var N,Y,B=!0;function U(k){if(B){var A;for(N=new r.Buf32(512),Y=new r.Buf32(32),A=0;A<144;)k.lens[A++]=8;for(;A<256;)k.lens[A++]=9;for(;A<280;)k.lens[A++]=7;for(;A<288;)k.lens[A++]=8;for(f(h,k.lens,0,288,N,0,k.work,{bits:9}),A=0;A<32;)k.lens[A++]=5;f(m,k.lens,0,32,Y,0,k.work,{bits:5}),B=!1}k.lencode=N,k.lenbits=9,k.distcode=Y,k.distbits=5}function K(k,A,u,S){var J,z=k.state;return z.window===null&&(z.wsize=1<<z.wbits,z.wnext=0,z.whave=0,z.window=new r.Buf8(z.wsize)),S>=z.wsize?(r.arraySet(z.window,A,u-z.wsize,z.wsize,0),z.wnext=0,z.whave=z.wsize):(S<(J=z.wsize-z.wnext)&&(J=S),r.arraySet(z.window,A,u-S,J,z.wnext),(S-=J)?(r.arraySet(z.window,A,u-S,S,0),z.wnext=S,z.whave=z.wsize):(z.wnext+=J,z.wnext===z.wsize&&(z.wnext=0),z.whave<z.wsize&&(z.whave+=J))),0}a.inflateReset=T,a.inflateReset2=D,a.inflateResetKeep=x,a.inflateInit=function(k){return j(k,15)},a.inflateInit2=j,a.inflate=function(k,A){var u,S,J,z,it,X,Q,R,$,et,G,V,pt,Lt,at,st,Et,gt,ce,Kt,d,O,I,E,w=0,C=new r.Buf8(4),F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!k||!k.state||!k.output||!k.input&&k.avail_in!==0)return c;(u=k.state).mode===12&&(u.mode=13),it=k.next_out,J=k.output,Q=k.avail_out,z=k.next_in,S=k.input,X=k.avail_in,R=u.hold,$=u.bits,et=X,G=Q,O=p;t:for(;;)switch(u.mode){case _:if(u.wrap===0){u.mode=13;break}for(;$<16;){if(X===0)break t;X--,R+=S[z++]<<$,$+=8}if(2&u.wrap&&R===35615){C[u.check=0]=255&R,C[1]=R>>>8&255,u.check=s(u.check,C,2,0),$=R=0,u.mode=2;break}if(u.flags=0,u.head&&(u.head.done=!1),!(1&u.wrap)||(((255&R)<<8)+(R>>8))%31){k.msg="incorrect header check",u.mode=30;break}if((15&R)!=8){k.msg="unknown compression method",u.mode=30;break}if($-=4,d=8+(15&(R>>>=4)),u.wbits===0)u.wbits=d;else if(d>u.wbits){k.msg="invalid window size",u.mode=30;break}u.dmax=1<<d,k.adler=u.check=1,u.mode=512&R?10:12,$=R=0;break;case 2:for(;$<16;){if(X===0)break t;X--,R+=S[z++]<<$,$+=8}if(u.flags=R,(255&u.flags)!=8){k.msg="unknown compression method",u.mode=30;break}if(57344&u.flags){k.msg="unknown header flags set",u.mode=30;break}u.head&&(u.head.text=R>>8&1),512&u.flags&&(C[0]=255&R,C[1]=R>>>8&255,u.check=s(u.check,C,2,0)),$=R=0,u.mode=3;case 3:for(;$<32;){if(X===0)break t;X--,R+=S[z++]<<$,$+=8}u.head&&(u.head.time=R),512&u.flags&&(C[0]=255&R,C[1]=R>>>8&255,C[2]=R>>>16&255,C[3]=R>>>24&255,u.check=s(u.check,C,4,0)),$=R=0,u.mode=4;case 4:for(;$<16;){if(X===0)break t;X--,R+=S[z++]<<$,$+=8}u.head&&(u.head.xflags=255&R,u.head.os=R>>8),512&u.flags&&(C[0]=255&R,C[1]=R>>>8&255,u.check=s(u.check,C,2,0)),$=R=0,u.mode=5;case 5:if(1024&u.flags){for(;$<16;){if(X===0)break t;X--,R+=S[z++]<<$,$+=8}u.length=R,u.head&&(u.head.extra_len=R),512&u.flags&&(C[0]=255&R,C[1]=R>>>8&255,u.check=s(u.check,C,2,0)),$=R=0}else u.head&&(u.head.extra=null);u.mode=6;case 6:if(1024&u.flags&&(X<(V=u.length)&&(V=X),V&&(u.head&&(d=u.head.extra_len-u.length,u.head.extra||(u.head.extra=new Array(u.head.extra_len)),r.arraySet(u.head.extra,S,z,V,d)),512&u.flags&&(u.check=s(u.check,S,V,z)),X-=V,z+=V,u.length-=V),u.length))break t;u.length=0,u.mode=7;case 7:if(2048&u.flags){if(X===0)break t;for(V=0;d=S[z+V++],u.head&&d&&u.length<65536&&(u.head.name+=String.fromCharCode(d)),d&&V<X;);if(512&u.flags&&(u.check=s(u.check,S,V,z)),X-=V,z+=V,d)break t}else u.head&&(u.head.name=null);u.length=0,u.mode=8;case 8:if(4096&u.flags){if(X===0)break t;for(V=0;d=S[z+V++],u.head&&d&&u.length<65536&&(u.head.comment+=String.fromCharCode(d)),d&&V<X;);if(512&u.flags&&(u.check=s(u.check,S,V,z)),X-=V,z+=V,d)break t}else u.head&&(u.head.comment=null);u.mode=9;case 9:if(512&u.flags){for(;$<16;){if(X===0)break t;X--,R+=S[z++]<<$,$+=8}if(R!==(65535&u.check)){k.msg="header crc mismatch",u.mode=30;break}$=R=0}u.head&&(u.head.hcrc=u.flags>>9&1,u.head.done=!0),k.adler=u.check=0,u.mode=12;break;case 10:for(;$<32;){if(X===0)break t;X--,R+=S[z++]<<$,$+=8}k.adler=u.check=b(R),$=R=0,u.mode=11;case 11:if(u.havedict===0)return k.next_out=it,k.avail_out=Q,k.next_in=z,k.avail_in=X,u.hold=R,u.bits=$,2;k.adler=u.check=1,u.mode=12;case 12:if(A===5||A===6)break t;case 13:if(u.last){R>>>=7&$,$-=7&$,u.mode=27;break}for(;$<3;){if(X===0)break t;X--,R+=S[z++]<<$,$+=8}switch(u.last=1&R,$-=1,3&(R>>>=1)){case 0:u.mode=14;break;case 1:if(U(u),u.mode=20,A!==6)break;R>>>=2,$-=2;break t;case 2:u.mode=17;break;case 3:k.msg="invalid block type",u.mode=30}R>>>=2,$-=2;break;case 14:for(R>>>=7&$,$-=7&$;$<32;){if(X===0)break t;X--,R+=S[z++]<<$,$+=8}if((65535&R)!=(R>>>16^65535)){k.msg="invalid stored block lengths",u.mode=30;break}if(u.length=65535&R,$=R=0,u.mode=15,A===6)break t;case 15:u.mode=16;case 16:if(V=u.length){if(X<V&&(V=X),Q<V&&(V=Q),V===0)break t;r.arraySet(J,S,z,V,it),X-=V,z+=V,Q-=V,it+=V,u.length-=V;break}u.mode=12;break;case 17:for(;$<14;){if(X===0)break t;X--,R+=S[z++]<<$,$+=8}if(u.nlen=257+(31&R),R>>>=5,$-=5,u.ndist=1+(31&R),R>>>=5,$-=5,u.ncode=4+(15&R),R>>>=4,$-=4,286<u.nlen||30<u.ndist){k.msg="too many length or distance symbols",u.mode=30;break}u.have=0,u.mode=18;case 18:for(;u.have<u.ncode;){for(;$<3;){if(X===0)break t;X--,R+=S[z++]<<$,$+=8}u.lens[F[u.have++]]=7&R,R>>>=3,$-=3}for(;u.have<19;)u.lens[F[u.have++]]=0;if(u.lencode=u.lendyn,u.lenbits=7,I={bits:u.lenbits},O=f(0,u.lens,0,19,u.lencode,0,u.work,I),u.lenbits=I.bits,O){k.msg="invalid code lengths set",u.mode=30;break}u.have=0,u.mode=19;case 19:for(;u.have<u.nlen+u.ndist;){for(;st=(w=u.lencode[R&(1<<u.lenbits)-1])>>>16&255,Et=65535&w,!((at=w>>>24)<=$);){if(X===0)break t;X--,R+=S[z++]<<$,$+=8}if(Et<16)R>>>=at,$-=at,u.lens[u.have++]=Et;else{if(Et===16){for(E=at+2;$<E;){if(X===0)break t;X--,R+=S[z++]<<$,$+=8}if(R>>>=at,$-=at,u.have===0){k.msg="invalid bit length repeat",u.mode=30;break}d=u.lens[u.have-1],V=3+(3&R),R>>>=2,$-=2}else if(Et===17){for(E=at+3;$<E;){if(X===0)break t;X--,R+=S[z++]<<$,$+=8}$-=at,d=0,V=3+(7&(R>>>=at)),R>>>=3,$-=3}else{for(E=at+7;$<E;){if(X===0)break t;X--,R+=S[z++]<<$,$+=8}$-=at,d=0,V=11+(127&(R>>>=at)),R>>>=7,$-=7}if(u.have+V>u.nlen+u.ndist){k.msg="invalid bit length repeat",u.mode=30;break}for(;V--;)u.lens[u.have++]=d}}if(u.mode===30)break;if(u.lens[256]===0){k.msg="invalid code -- missing end-of-block",u.mode=30;break}if(u.lenbits=9,I={bits:u.lenbits},O=f(h,u.lens,0,u.nlen,u.lencode,0,u.work,I),u.lenbits=I.bits,O){k.msg="invalid literal/lengths set",u.mode=30;break}if(u.distbits=6,u.distcode=u.distdyn,I={bits:u.distbits},O=f(m,u.lens,u.nlen,u.ndist,u.distcode,0,u.work,I),u.distbits=I.bits,O){k.msg="invalid distances set",u.mode=30;break}if(u.mode=20,A===6)break t;case 20:u.mode=21;case 21:if(6<=X&&258<=Q){k.next_out=it,k.avail_out=Q,k.next_in=z,k.avail_in=X,u.hold=R,u.bits=$,o(k,G),it=k.next_out,J=k.output,Q=k.avail_out,z=k.next_in,S=k.input,X=k.avail_in,R=u.hold,$=u.bits,u.mode===12&&(u.back=-1);break}for(u.back=0;st=(w=u.lencode[R&(1<<u.lenbits)-1])>>>16&255,Et=65535&w,!((at=w>>>24)<=$);){if(X===0)break t;X--,R+=S[z++]<<$,$+=8}if(st&&(240&st)==0){for(gt=at,ce=st,Kt=Et;st=(w=u.lencode[Kt+((R&(1<<gt+ce)-1)>>gt)])>>>16&255,Et=65535&w,!(gt+(at=w>>>24)<=$);){if(X===0)break t;X--,R+=S[z++]<<$,$+=8}R>>>=gt,$-=gt,u.back+=gt}if(R>>>=at,$-=at,u.back+=at,u.length=Et,st===0){u.mode=26;break}if(32&st){u.back=-1,u.mode=12;break}if(64&st){k.msg="invalid literal/length code",u.mode=30;break}u.extra=15&st,u.mode=22;case 22:if(u.extra){for(E=u.extra;$<E;){if(X===0)break t;X--,R+=S[z++]<<$,$+=8}u.length+=R&(1<<u.extra)-1,R>>>=u.extra,$-=u.extra,u.back+=u.extra}u.was=u.length,u.mode=23;case 23:for(;st=(w=u.distcode[R&(1<<u.distbits)-1])>>>16&255,Et=65535&w,!((at=w>>>24)<=$);){if(X===0)break t;X--,R+=S[z++]<<$,$+=8}if((240&st)==0){for(gt=at,ce=st,Kt=Et;st=(w=u.distcode[Kt+((R&(1<<gt+ce)-1)>>gt)])>>>16&255,Et=65535&w,!(gt+(at=w>>>24)<=$);){if(X===0)break t;X--,R+=S[z++]<<$,$+=8}R>>>=gt,$-=gt,u.back+=gt}if(R>>>=at,$-=at,u.back+=at,64&st){k.msg="invalid distance code",u.mode=30;break}u.offset=Et,u.extra=15&st,u.mode=24;case 24:if(u.extra){for(E=u.extra;$<E;){if(X===0)break t;X--,R+=S[z++]<<$,$+=8}u.offset+=R&(1<<u.extra)-1,R>>>=u.extra,$-=u.extra,u.back+=u.extra}if(u.offset>u.dmax){k.msg="invalid distance too far back",u.mode=30;break}u.mode=25;case 25:if(Q===0)break t;if(V=G-Q,u.offset>V){if((V=u.offset-V)>u.whave&&u.sane){k.msg="invalid distance too far back",u.mode=30;break}pt=V>u.wnext?(V-=u.wnext,u.wsize-V):u.wnext-V,V>u.length&&(V=u.length),Lt=u.window}else Lt=J,pt=it-u.offset,V=u.length;for(Q<V&&(V=Q),Q-=V,u.length-=V;J[it++]=Lt[pt++],--V;);u.length===0&&(u.mode=21);break;case 26:if(Q===0)break t;J[it++]=u.length,Q--,u.mode=21;break;case 27:if(u.wrap){for(;$<32;){if(X===0)break t;X--,R|=S[z++]<<$,$+=8}if(G-=Q,k.total_out+=G,u.total+=G,G&&(k.adler=u.check=u.flags?s(u.check,J,G,it-G):l(u.check,J,G,it-G)),G=Q,(u.flags?R:b(R))!==u.check){k.msg="incorrect data check",u.mode=30;break}$=R=0}u.mode=28;case 28:if(u.wrap&&u.flags){for(;$<32;){if(X===0)break t;X--,R+=S[z++]<<$,$+=8}if(R!==(4294967295&u.total)){k.msg="incorrect length check",u.mode=30;break}$=R=0}u.mode=29;case 29:O=1;break t;case 30:O=-3;break t;case 31:return-4;case 32:default:return c}return k.next_out=it,k.avail_out=Q,k.next_in=z,k.avail_in=X,u.hold=R,u.bits=$,(u.wsize||G!==k.avail_out&&u.mode<30&&(u.mode<27||A!==4))&&K(k,k.output,k.next_out,G-k.avail_out)?(u.mode=31,-4):(et-=k.avail_in,G-=k.avail_out,k.total_in+=et,k.total_out+=G,u.total+=G,u.wrap&&G&&(k.adler=u.check=u.flags?s(u.check,J,G,k.next_out-G):l(u.check,J,G,k.next_out-G)),k.data_type=u.bits+(u.last?64:0)+(u.mode===12?128:0)+(u.mode===20||u.mode===15?256:0),(et==0&&G===0||A===4)&&O===p&&(O=-5),O)},a.inflateEnd=function(k){if(!k||!k.state)return c;var A=k.state;return A.window&&(A.window=null),k.state=null,p},a.inflateGetHeader=function(k,A){var u;return k&&k.state?(2&(u=k.state).wrap)==0?c:((u.head=A).done=!1,p):c},a.inflateSetDictionary=function(k,A){var u,S=A.length;return k&&k.state?(u=k.state).wrap!==0&&u.mode!==11?c:u.mode===11&&l(1,A,S,0)!==u.check?-3:K(k,A,S,S)?(u.mode=31,-4):(u.havedict=1,p):c},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,i,a){var r=n("../utils/common"),l=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(h,m,p,c,_,v,g,b){var y,x,T,D,j,N,Y,B,U,K=b.bits,k=0,A=0,u=0,S=0,J=0,z=0,it=0,X=0,Q=0,R=0,$=null,et=0,G=new r.Buf16(16),V=new r.Buf16(16),pt=null,Lt=0;for(k=0;k<=15;k++)G[k]=0;for(A=0;A<c;A++)G[m[p+A]]++;for(J=K,S=15;1<=S&&G[S]===0;S--);if(S<J&&(J=S),S===0)return _[v++]=20971520,_[v++]=20971520,b.bits=1,0;for(u=1;u<S&&G[u]===0;u++);for(J<u&&(J=u),k=X=1;k<=15;k++)if(X<<=1,(X-=G[k])<0)return-1;if(0<X&&(h===0||S!==1))return-1;for(V[1]=0,k=1;k<15;k++)V[k+1]=V[k]+G[k];for(A=0;A<c;A++)m[p+A]!==0&&(g[V[m[p+A]]++]=A);if(N=h===0?($=pt=g,19):h===1?($=l,et-=257,pt=s,Lt-=257,256):($=o,pt=f,-1),k=u,j=v,it=A=R=0,T=-1,D=(Q=1<<(z=J))-1,h===1&&852<Q||h===2&&592<Q)return 1;for(;;){for(Y=k-it,U=g[A]<N?(B=0,g[A]):g[A]>N?(B=pt[Lt+g[A]],$[et+g[A]]):(B=96,0),y=1<<k-it,u=x=1<<z;_[j+(R>>it)+(x-=y)]=Y<<24|B<<16|U|0,x!==0;);for(y=1<<k-1;R&y;)y>>=1;if(y!==0?(R&=y-1,R+=y):R=0,A++,--G[k]==0){if(k===S)break;k=m[p+g[A]]}if(J<k&&(R&D)!==T){for(it===0&&(it=J),j+=u,X=1<<(z=k-it);z+it<S&&!((X-=G[z+it])<=0);)z++,X<<=1;if(Q+=1<<z,h===1&&852<Q||h===2&&592<Q)return 1;_[T=R&D]=J<<24|z<<16|j-v|0}}return R!==0&&(_[j+R]=k-it<<24|64<<16|0),b.bits=J,0}},{"../utils/common":41}],51:[function(n,i,a){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,i,a){var r=n("../utils/common"),l=0,s=1;function o(w){for(var C=w.length;0<=--C;)w[C]=0}var f=0,h=29,m=256,p=m+1+h,c=30,_=19,v=2*p+1,g=15,b=16,y=7,x=256,T=16,D=17,j=18,N=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Y=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=new Array(2*(p+2));o(K);var k=new Array(2*c);o(k);var A=new Array(512);o(A);var u=new Array(256);o(u);var S=new Array(h);o(S);var J,z,it,X=new Array(c);function Q(w,C,F,H,L){this.static_tree=w,this.extra_bits=C,this.extra_base=F,this.elems=H,this.max_length=L,this.has_stree=w&&w.length}function R(w,C){this.dyn_tree=w,this.max_code=0,this.stat_desc=C}function $(w){return w<256?A[w]:A[256+(w>>>7)]}function et(w,C){w.pending_buf[w.pending++]=255&C,w.pending_buf[w.pending++]=C>>>8&255}function G(w,C,F){w.bi_valid>b-F?(w.bi_buf|=C<<w.bi_valid&65535,et(w,w.bi_buf),w.bi_buf=C>>b-w.bi_valid,w.bi_valid+=F-b):(w.bi_buf|=C<<w.bi_valid&65535,w.bi_valid+=F)}function V(w,C,F){G(w,F[2*C],F[2*C+1])}function pt(w,C){for(var F=0;F|=1&w,w>>>=1,F<<=1,0<--C;);return F>>>1}function Lt(w,C,F){var H,L,W=new Array(g+1),Z=0;for(H=1;H<=g;H++)W[H]=Z=Z+F[H-1]<<1;for(L=0;L<=C;L++){var q=w[2*L+1];q!==0&&(w[2*L]=pt(W[q]++,q))}}function at(w){var C;for(C=0;C<p;C++)w.dyn_ltree[2*C]=0;for(C=0;C<c;C++)w.dyn_dtree[2*C]=0;for(C=0;C<_;C++)w.bl_tree[2*C]=0;w.dyn_ltree[2*x]=1,w.opt_len=w.static_len=0,w.last_lit=w.matches=0}function st(w){8<w.bi_valid?et(w,w.bi_buf):0<w.bi_valid&&(w.pending_buf[w.pending++]=w.bi_buf),w.bi_buf=0,w.bi_valid=0}function Et(w,C,F,H){var L=2*C,W=2*F;return w[L]<w[W]||w[L]===w[W]&&H[C]<=H[F]}function gt(w,C,F){for(var H=w.heap[F],L=F<<1;L<=w.heap_len&&(L<w.heap_len&&Et(C,w.heap[L+1],w.heap[L],w.depth)&&L++,!Et(C,H,w.heap[L],w.depth));)w.heap[F]=w.heap[L],F=L,L<<=1;w.heap[F]=H}function ce(w,C,F){var H,L,W,Z,q=0;if(w.last_lit!==0)for(;H=w.pending_buf[w.d_buf+2*q]<<8|w.pending_buf[w.d_buf+2*q+1],L=w.pending_buf[w.l_buf+q],q++,H===0?V(w,L,C):(V(w,(W=u[L])+m+1,C),(Z=N[W])!==0&&G(w,L-=S[W],Z),V(w,W=$(--H),F),(Z=Y[W])!==0&&G(w,H-=X[W],Z)),q<w.last_lit;);V(w,x,C)}function Kt(w,C){var F,H,L,W=C.dyn_tree,Z=C.stat_desc.static_tree,q=C.stat_desc.has_stree,tt=C.stat_desc.elems,dt=-1;for(w.heap_len=0,w.heap_max=v,F=0;F<tt;F++)W[2*F]!==0?(w.heap[++w.heap_len]=dt=F,w.depth[F]=0):W[2*F+1]=0;for(;w.heap_len<2;)W[2*(L=w.heap[++w.heap_len]=dt<2?++dt:0)]=1,w.depth[L]=0,w.opt_len--,q&&(w.static_len-=Z[2*L+1]);for(C.max_code=dt,F=w.heap_len>>1;1<=F;F--)gt(w,W,F);for(L=tt;F=w.heap[1],w.heap[1]=w.heap[w.heap_len--],gt(w,W,1),H=w.heap[1],w.heap[--w.heap_max]=F,w.heap[--w.heap_max]=H,W[2*L]=W[2*F]+W[2*H],w.depth[L]=(w.depth[F]>=w.depth[H]?w.depth[F]:w.depth[H])+1,W[2*F+1]=W[2*H+1]=L,w.heap[1]=L++,gt(w,W,1),2<=w.heap_len;);w.heap[--w.heap_max]=w.heap[1],function(ot,Ut){var Tn,ue,$n,bt,Yn,zi,ge=Ut.dyn_tree,Ka=Ut.max_code,ul=Ut.stat_desc.static_tree,hl=Ut.stat_desc.has_stree,dl=Ut.stat_desc.extra_bits,Qa=Ut.stat_desc.extra_base,Mn=Ut.stat_desc.max_length,Wn=0;for(bt=0;bt<=g;bt++)ot.bl_count[bt]=0;for(ge[2*ot.heap[ot.heap_max]+1]=0,Tn=ot.heap_max+1;Tn<v;Tn++)Mn<(bt=ge[2*ge[2*(ue=ot.heap[Tn])+1]+1]+1)&&(bt=Mn,Wn++),ge[2*ue+1]=bt,Ka<ue||(ot.bl_count[bt]++,Yn=0,Qa<=ue&&(Yn=dl[ue-Qa]),zi=ge[2*ue],ot.opt_len+=zi*(bt+Yn),hl&&(ot.static_len+=zi*(ul[2*ue+1]+Yn)));if(Wn!==0){do{for(bt=Mn-1;ot.bl_count[bt]===0;)bt--;ot.bl_count[bt]--,ot.bl_count[bt+1]+=2,ot.bl_count[Mn]--,Wn-=2}while(0<Wn);for(bt=Mn;bt!==0;bt--)for(ue=ot.bl_count[bt];ue!==0;)Ka<($n=ot.heap[--Tn])||(ge[2*$n+1]!==bt&&(ot.opt_len+=(bt-ge[2*$n+1])*ge[2*$n],ge[2*$n+1]=bt),ue--)}}(w,C),Lt(W,dt,w.bl_count)}function d(w,C,F){var H,L,W=-1,Z=C[1],q=0,tt=7,dt=4;for(Z===0&&(tt=138,dt=3),C[2*(F+1)+1]=65535,H=0;H<=F;H++)L=Z,Z=C[2*(H+1)+1],++q<tt&&L===Z||(q<dt?w.bl_tree[2*L]+=q:L!==0?(L!==W&&w.bl_tree[2*L]++,w.bl_tree[2*T]++):q<=10?w.bl_tree[2*D]++:w.bl_tree[2*j]++,W=L,dt=(q=0)===Z?(tt=138,3):L===Z?(tt=6,3):(tt=7,4))}function O(w,C,F){var H,L,W=-1,Z=C[1],q=0,tt=7,dt=4;for(Z===0&&(tt=138,dt=3),H=0;H<=F;H++)if(L=Z,Z=C[2*(H+1)+1],!(++q<tt&&L===Z)){if(q<dt)for(;V(w,L,w.bl_tree),--q!=0;);else L!==0?(L!==W&&(V(w,L,w.bl_tree),q--),V(w,T,w.bl_tree),G(w,q-3,2)):q<=10?(V(w,D,w.bl_tree),G(w,q-3,3)):(V(w,j,w.bl_tree),G(w,q-11,7));W=L,dt=(q=0)===Z?(tt=138,3):L===Z?(tt=6,3):(tt=7,4)}}o(X);var I=!1;function E(w,C,F,H){G(w,(f<<1)+(H?1:0),3),function(L,W,Z,q){st(L),q&&(et(L,Z),et(L,~Z)),r.arraySet(L.pending_buf,L.window,W,Z,L.pending),L.pending+=Z}(w,C,F,!0)}a._tr_init=function(w){I||(function(){var C,F,H,L,W,Z=new Array(g+1);for(L=H=0;L<h-1;L++)for(S[L]=H,C=0;C<1<<N[L];C++)u[H++]=L;for(u[H-1]=L,L=W=0;L<16;L++)for(X[L]=W,C=0;C<1<<Y[L];C++)A[W++]=L;for(W>>=7;L<c;L++)for(X[L]=W<<7,C=0;C<1<<Y[L]-7;C++)A[256+W++]=L;for(F=0;F<=g;F++)Z[F]=0;for(C=0;C<=143;)K[2*C+1]=8,C++,Z[8]++;for(;C<=255;)K[2*C+1]=9,C++,Z[9]++;for(;C<=279;)K[2*C+1]=7,C++,Z[7]++;for(;C<=287;)K[2*C+1]=8,C++,Z[8]++;for(Lt(K,p+1,Z),C=0;C<c;C++)k[2*C+1]=5,k[2*C]=pt(C,5);J=new Q(K,N,m+1,p,g),z=new Q(k,Y,0,c,g),it=new Q(new Array(0),B,0,_,y)}(),I=!0),w.l_desc=new R(w.dyn_ltree,J),w.d_desc=new R(w.dyn_dtree,z),w.bl_desc=new R(w.bl_tree,it),w.bi_buf=0,w.bi_valid=0,at(w)},a._tr_stored_block=E,a._tr_flush_block=function(w,C,F,H){var L,W,Z=0;0<w.level?(w.strm.data_type===2&&(w.strm.data_type=function(q){var tt,dt=4093624447;for(tt=0;tt<=31;tt++,dt>>>=1)if(1&dt&&q.dyn_ltree[2*tt]!==0)return l;if(q.dyn_ltree[18]!==0||q.dyn_ltree[20]!==0||q.dyn_ltree[26]!==0)return s;for(tt=32;tt<m;tt++)if(q.dyn_ltree[2*tt]!==0)return s;return l}(w)),Kt(w,w.l_desc),Kt(w,w.d_desc),Z=function(q){var tt;for(d(q,q.dyn_ltree,q.l_desc.max_code),d(q,q.dyn_dtree,q.d_desc.max_code),Kt(q,q.bl_desc),tt=_-1;3<=tt&&q.bl_tree[2*U[tt]+1]===0;tt--);return q.opt_len+=3*(tt+1)+5+5+4,tt}(w),L=w.opt_len+3+7>>>3,(W=w.static_len+3+7>>>3)<=L&&(L=W)):L=W=F+5,F+4<=L&&C!==-1?E(w,C,F,H):w.strategy===4||W===L?(G(w,2+(H?1:0),3),ce(w,K,k)):(G(w,4+(H?1:0),3),function(q,tt,dt,ot){var Ut;for(G(q,tt-257,5),G(q,dt-1,5),G(q,ot-4,4),Ut=0;Ut<ot;Ut++)G(q,q.bl_tree[2*U[Ut]+1],3);O(q,q.dyn_ltree,tt-1),O(q,q.dyn_dtree,dt-1)}(w,w.l_desc.max_code+1,w.d_desc.max_code+1,Z+1),ce(w,w.dyn_ltree,w.dyn_dtree)),at(w),H&&st(w)},a._tr_tally=function(w,C,F){return w.pending_buf[w.d_buf+2*w.last_lit]=C>>>8&255,w.pending_buf[w.d_buf+2*w.last_lit+1]=255&C,w.pending_buf[w.l_buf+w.last_lit]=255&F,w.last_lit++,C===0?w.dyn_ltree[2*F]++:(w.matches++,C--,w.dyn_ltree[2*(u[F]+m+1)]++,w.dyn_dtree[2*$(C)]++),w.last_lit===w.lit_bufsize-1},a._tr_align=function(w){G(w,2,3),V(w,x,K),function(C){C.bi_valid===16?(et(C,C.bi_buf),C.bi_buf=0,C.bi_valid=0):8<=C.bi_valid&&(C.pending_buf[C.pending++]=255&C.bi_buf,C.bi_buf>>=8,C.bi_valid-=8)}(w)}},{"../utils/common":41}],53:[function(n,i,a){i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,i,a){i.exports=typeof setImmediate=="function"?setImmediate:function(){var r=[].slice.apply(arguments);r.splice(1,0,0),setTimeout.apply(null,r)}},{}]},{},[10])(10)})})(ol);var Vh=ol.exports;const Gh=async t=>await Vh.loadAsync(t),Qt=()=>"[main]";var we=async t=>{var e;try{console.time("loading time"),Jn.enable(!1);let n;if(t.file)n=t.file;else if(t.link)n=await Wh(Wo(decodeURI(t.link)));else if(t.id)n=await al(qo(decodeURI(t.id)));else if(t.hash&&Yo(decodeURI(t.hash).trim()))n=await qh(decodeURI(t.hash).trim());else throw new Error("Could not search for file.");ft.status("info","Extracting zip",0),Mt.switchHeader(!1);const i=await Gh(n);Jn.enable(!1),ft.status("info","Parsing map info...",0),nt.info(Qt(),"Parsing map info");const a=await il(i);rt.beatmapInfo=a,Fn.setInfo(a),ft.status("info","Loading image...",10.4375),nt.info(Qt(),"Loading cover image");let r=i.file(a._coverImageFilename);if(ut.load.imageCover&&r){let s=await r.async("base64");Mt.setCoverImage("data:image;base64,"+s),bn.loading.coverImage=!0}else nt.error(Qt(),`${a._coverImageFilename} does not exists.`);if(rt.contributors=[],(e=a==null?void 0:a._customData)!=null&&e._contributors)for(const s of a._customData._contributors){nt.info(Qt(),"Loading contributor image "+s._name),r=i.file(s._iconPath);let o=null;ut.load.imageContributor&&r?o=await r.async("base64"):nt.error(Qt(),`${s._iconPath} does not exists.`),rt.contributors.push(Vn(qn({},s),{_base64:o}))}ft.status("info","Loading audio...",20.875),nt.info(Qt(),"Loading audio");let l=i.file(a._songFilename);if(ut.load.audio&&l){let s=!1;setTimeout(()=>{s||ft.status("info","Loading audio... (this may take a while)",20.875)},1e4);let o=await l.async("arraybuffer");Mt.setAudio(o),await new AudioContext().decodeAudioData(o).then(h=>{s=!0;let m=h.duration;rt.duration=m,Mt.setSongDuration(m),bn.loading.audio=!0}).catch(function(h){Mt.setSongDuration(),nt.error(Qt(),h)})}else Mt.setSongDuration(),nt.error(Qt(),`${a._songFilename} does not exist.`);ft.status("info","Parsing difficulty...",70),rt.beatmapDifficulty=await An(a,i),pn.adjustTime(),ft.status("info","Adding map difficulty stats...",80),nt.info(Qt(),"Adding map stats"),nl.populate(),Fn.populateContributors(rt.contributors),ft.status("info","Analysing map...",85),nt.info(Qt(),"Analysing map"),Dn.runGeneral(),pn.displayOutputGeneral(),ft.status("info","Analysing difficulty...",90),Dn.applyAll(),pn.populateSelect(a),pn.displayOutputDifficulty(),Jn.enable(!0),ft.status("info","Map successfully loaded!"),console.timeEnd("loading time")}catch(n){ft.status("error",n,100),nt.error(Qt(),n),rt.clear(),Jn.enable(!0),Mt.switchHeader(!0)}};const Sn="UI Intro: ",Pn=document.querySelector(".input__intro-url"),Nn=document.querySelector(".input__intro-id"),On=document.querySelector(".input__intro-hash"),Po=document.querySelector(".input__search-button"),No=document.querySelector(".input__file"),ar=document.querySelector(".input__file-zone");if(Pn)Pn.addEventListener("keydown",qa);else throw new Error(Sn+"URL input is missing");if(Nn)Nn.addEventListener("keydown",qa);else throw new Error(Sn+"ID input is missing");if(On)On.addEventListener("keydown",qa);else throw new Error(Sn+"Hash input is missing");if(Po)Po.addEventListener("click",Zh);else throw new Error(Sn+"search button is missing");if(No)No.addEventListener("change",Jh);else throw new Error(Sn+"file input is missing");if(ar)ar.addEventListener("drop",Kh),ar.addEventListener("dragover",Qh);else throw new Error(Sn+"file drop zone is missing");function qa(t){const e=t.target;t.key==="Enter"&&e.value!==""&&(e.classList.contains("input__intro-url")&&we({link:e.value}),e.classList.contains("input__intro-id")&&we({id:e.value}),e.classList.contains("input__intro-hash")&&we({hash:e.value}))}function Zh(t){if(Pn&&Pn.value!==""){we({link:Pn.value});return}if(Nn&&Nn.value!==""){we({id:Nn.value});return}if(On&&On.value!==""){we({hash:On.value});return}}function Jh(t){const e=t.target;ft.status("info","Reading file input",0);const n=e.files?e.files[0]:null;try{if(n==null)throw ft.status("info","No file input",0),new Error("No file input");if(n&&(n.name.substr(-4)===".zip"||n.name.substr(-4)===".bsl")){const i=new FileReader;i.readAsArrayBuffer(n),i.addEventListener("load",()=>{we({file:n})})}else throw new Error("Unsupported file format, please enter zip file")}catch(i){ft.status("error",i,0),console.error(i)}}function Kh(t){t.preventDefault(),t.stopPropagation();try{if(t.dataTransfer==null)throw new Error("No file input");if(t.dataTransfer.items&&t.dataTransfer.items[0].kind==="file"){let e=t.dataTransfer.items[0].getAsFile();if(e&&(e.name.substr(-4)===".zip"||e.name.substr(-4)===".bsl")){const n=new FileReader;n.readAsArrayBuffer(e),n.addEventListener("load",()=>{we({file:e})})}else throw new Error("Unsupported file format, please enter zip file")}}catch(e){ft.status("error",e,0),console.error(e)}}function Qh(t){t.preventDefault(),t.stopPropagation()}const td=document.querySelector("body"),ed=["Dark","Light","Monochrome"];var Va={list:ed,set:t=>{td.className="theme-"+t.toLowerCase().replace(" ","")}};const Ln="UI Settings: ",si=document.querySelector(".settings__theme"),Ga=document.querySelectorAll(".settings__load"),Pi=document.querySelector(".settings__sort"),Za=document.querySelectorAll(".settings__show"),Ja=document.querySelectorAll(".settings__onload"),Oo=document.querySelector(".settings__clear-button");if(si)si.addEventListener("change",nd),Va.list.forEach(t=>{const e=document.createElement("option");e.value=t,e.textContent=t,si.add(e)});else throw new Error(Ln+"theme select is missing");Ga.length||console.error(Ln+"empty load list, intentional or typo error?");Ga.forEach(t=>t.addEventListener("change",sd));if(Pi)Pi.addEventListener("change",ad);else throw new Error(Ln+"sort check is missing");Ja.length||console.error(Ln+"empty onload list, intentional or typo error?");Ja.forEach(t=>t.addEventListener("change",cd));Za.length||console.error(Ln+"empty show list, intentional or typo error?");Za.forEach(t=>t.addEventListener("change",id));if(Oo)Oo.addEventListener("click",sl);else throw new Error(Ln+"clear button is missing");function nd(t){const e=t.target;ut.theme=e.options[e.options.selectedIndex].value,Va.set(ut.theme),ut.save()}function id(t){const e=t.target,n=e.id.replace("settings__show-","");ut.show[n]=e.checked,ut.save()}const rd=(t,e)=>{Za.forEach(n=>{n.id.endsWith(t)&&(n.checked=e)})};function ad(t){const e=t.target;ut.sorting=e.checked,ut.save()}const od=t=>{Pi&&(Pi.checked=t)};function sd(t){const e=t.target,n=e.name;ut.load[n]=e.checked,ut.save()}const ld=(t,e)=>{Ga.forEach(n=>{n.name===t&&(n.checked=e)})};function cd(t){const e=t.target,n=e.name;ut.onLoad[n]=e.checked,ut.save()}const ud=(t,e)=>{Ja.forEach(n=>{n.name===t&&(n.checked=e)})},hd=t=>{si.value=t};function sl(){ut.clear(),ut.reset(),location.reload()}var Rn={setShowCheck:rd,setSortCheck:od,setLoadCheck:ld,setOnLoadCheck:ud,setTheme:hd,clear:sl};const dd=document.querySelectorAll(".input__reset-button");dd.forEach(t=>t.addEventListener("click",fd));function fd(){ft.reset(),Mt.reset(),Fn.reset(),pn.reset(),nl.reset(),rt.clear()}const md=2,pd=5,gd=0,bd="Kival Evan#5480";var jo=new class{constructor(){this._version=`pre-${md}.${pd}.${gd}`,this._wm=bd}get value(){return this._version}get watermark(){return this._wm}};const _d="UI Footer: ",ll=document.querySelectorAll(".link__watermark"),cl=document.querySelectorAll(".link__version");(!ll.length||!cl.length)&&console.error(_d+"missing part");var Fo={setWatermark:t=>{ll.forEach(e=>e.textContent=t)},setVersion:t=>{cl.forEach(e=>e.textContent=t)}},yd=function(){let t=!1;return function(){if(!t){t=!0,Rn.setTheme(ut.theme),Fo.setWatermark(jo.watermark),Fo.setVersion(jo.value),pn.populateTool();for(const e in ut.load)Rn.setLoadCheck(e,ut.load[e]);Rn.setSortCheck(ut.sorting);for(const e in ut.show)Xo.show(e,ut.show[e]),Rn.setShowCheck(e,ut.show[e]);for(const e in ut.onLoad)Rn.setOnLoadCheck(e,ut.onLoad[e]);Va.set(ut.theme),nt.info("User interface initialised")}}}();(function(){yd();const t=new URL(location.href),e=t.searchParams.get("url"),n=t.searchParams.get("id"),i=t.searchParams.get("hash");(n||e||i)&&we({link:e,id:n,hash:i})})();
