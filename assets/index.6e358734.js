var nc=Object.defineProperty,ic=Object.defineProperties;var ac=Object.getOwnPropertyDescriptors;var Ar=Object.getOwnPropertySymbols;var rc=Object.prototype.hasOwnProperty,sc=Object.prototype.propertyIsEnumerable;var Br=(t,e,n)=>e in t?nc(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Wn=(t,e)=>{for(var n in e||(e={}))rc.call(e,n)&&Br(t,n,e[n]);if(Ar)for(var n of Ar(e))sc.call(e,n)&&Br(t,n,e[n]);return t},qn=(t,e)=>ic(t,ac(e));const oc=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}};oc();var lo=(t=>(t.none="",t.ExpertPlus="accordion__label--bg-expertplus",t.Expert="accordion__label--bg-expert",t.Hard="accordion__label--bg-hard",t.Normal="accordion__label--bg-normal",t.Easy="accordion__label--bg-easy",t))(lo||{});const lc="UI Accordion: ",Zn="accordion__",co=document.querySelectorAll(".accordion__button");co.length||console.error(lc+"empty accordion list, intentional or typo error?");var uo={create:(t,e,n,a=!1)=>{const s=document.createElement("div");s.className="accordion";const i=document.createElement("input");i.className=Zn+"button",i.id=t,i.setAttribute("type","checkbox");const l=document.createElement("label");l.className=Zn+"label unselectable",l.htmlFor=t,l.textContent=e,n&&l.classList.add(lo[n]);const r=document.createElement("div");return r.className=a?Zn+"collapsible-flex":Zn+"collapsible",r.id=t+"-content",s.appendChild(i),s.appendChild(l),s.appendChild(r),s},show:(t,e)=>{co.forEach(n=>{n.id.endsWith(t)&&(n.checked=e)})}};const $r=new Map([[0,"VERBOSE"],[1,"DEBUG"],[2,"INFO"],[3,"WARN"],[4,"!!ERROR!!"],[5,"NONE"]]);var nt=new class{constructor(){this.logLevel=2}log(e,...n){if(e<this.logLevel)return;const a=[$r.get(e),">",...n];switch(e){case 1:return console.debug(...a);case 2:return console.info(...a);case 3:return console.warn(...a);case 4:return console.error(...a);default:return console.log(...a)}}setLevel(e){e=Math.min(e,5),this.logLevel=e,this.info("[logger::setLevel]",`Log level set to ${$r.get(e)}`)}verbose(...e){this.log(0,...e)}debug(...e){this.log(1,...e)}info(...e){this.log(2,...e)}warn(...e){this.log(3,...e)}error(...e){this.log(4,...e)}};const cc=t=>t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),P=(t,e=0)=>Math.round(t*Math.pow(10,e))/Math.pow(10,e),Gi=t=>t*(180/Math.PI),sn=t=>t*(Math.PI/180),Nr=(t,e)=>{e<0&&(e=-e);const n=t%e;return n<0?n+e:n},Mr=(t,e,n)=>Math.min(Nr(t-e,n),Nr(e-t,n)),zi=t=>{if(t.length===0)return 0;t.sort((n,a)=>n-a);const e=Math.floor(t.length/2);return t.length%2?t[e]:(t[e-1]+t[e])/2},uc=(t,e,n)=>Math.min(Math.max(e,t),n),ci=t=>[t.r,t.g,t.b],Jn=t=>{const e=t.toString(16);return e.length===1?"0"+e:e},hc=t=>t>1&&!(t<0)?255:P(t*255),xt=t=>{if(!t)return null;const e={r:0,g:0,b:0};for(const n in t){const a=t[n];a!==void 0&&(e[n]=hc(a))}return`#${Jn(e.r)}${Jn(e.g)}${Jn(e.b)}${e.a?Jn(e.a):""}`},Or=t=>{let e=t[0],n=t[1],a=t[2],s,i,l;return e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92,a=a>.04045?Math.pow((a+.055)/1.055,2.4):a/12.92,s=(e*.4124+n*.3576+a*.1805)/.95047,i=(e*.2126+n*.7152+a*.0722)/1,l=(e*.0193+n*.1192+a*.9505)/1.08883,s=s>.008856?Math.pow(s,1/3):7.787*s+16/116,i=i>.008856?Math.pow(i,1/3):7.787*i+16/116,l=l>.008856?Math.pow(l,1/3):7.787*l+16/116,[116*i-16,500*(s-i),200*(i-l)]},Pr=(t,e)=>{let n=0;return t>=0&&e===0?0:t<0&&e===0?180:t===0&&e>0?90:t===0&&e<0?270:(t>0&&e>0&&(n=0),t<0&&(n=180),t>0&&e<0&&(n=360),Gi(Math.atan(e/t))+n)},Vi=(t,e)=>{const[n,a,s]=Or(t),[i,l,r]=Or(e),o=1,u=1,h=1;let m,g,c,p,_,y,b,v,S,L,D,O,M,X,$,Y,K,C,N,d;return m=Math.sqrt(a*a+s*s),g=Math.sqrt(l*l+r*r),c=(m+g)/2,_=.5*(1-Math.sqrt((c^7)/((c^7)+30))),S=(1+_)*a,m=Math.sqrt(S*S+s*s),y=Pr(S,s),S=(1+_)*l,g=Math.sqrt(S*S+r*r),b=Pr(S,r),C=i-n,N=g-m,m*g==0?d=0:(S=P(b-y,12),Math.abs(S)<=180?d=b-y:S>180?d=b-y-360:d=b-y+360),d=2*Math.sqrt(m*g)*Math.sin(sn(d/2)),L=(n+i)/2,p=(m+g)/2,m*g==0?v=y+b:(S=Math.abs(P(y-b,12)),S>180?b+y<360?v=y+b+360:v=y+b-360:v=y+b,v/=2),D=1-.17*Math.cos(sn(v-30))+.24*Math.cos(sn(2*v))+.32*Math.cos(sn(3*v+6))-.2*Math.cos(sn(4*v-63)),$=30*Math.exp(-((v-275)/25)*((v-275)/25)),Y=2*Math.sqrt((p^7)/((p^7)+30)),O=1+.015*((L-50)*(L-50))/Math.sqrt(20+(L-50)*(L-50)),M=1+.045*p,X=1+.015*p*D,K=-Math.sin(sn(2*$))*Y,C=C/(o*O),N=N/(u*M),d=d/(h*X),Math.sqrt(C*C+N*N+d*d+K*N*d)},dc=t=>`[utils::misc::${t}]`,ho=t=>/[a-fA-F0-9]*/g.test(t),Dt=t=>(typeof t!="object"&&nt.error(dc("deepCopy"),"Received non-object type"),JSON.parse(JSON.stringify(t))),kt=t=>{if(!t)return"0:00";const e=Math.floor(t),n=e/60,a=n<0?`-${Math.ceil(n).toString()}`:Math.floor(n).toString(),s=Math.abs(e%60).toString().padStart(2,"0");return`${a}:${s}`},fc=t=>{if(!t)return"0:00:00";const e=Math.round(t*60%60).toString().padStart(2,"0");return`${kt(t)}:${e}`},mc=t=>{var n;if(!t)return"0:00.000";const e=((n=(t%1).toString().split(".")[1])==null?void 0:n.padEnd(3,"0").slice(0,3))||"000";return`${kt(t)}.${e}`},fo=t=>{const e=/^(http|ftp|https):\/\/([\w_-]+(?:(?:\.[\w_-]+)+))([\w.,@?^=%&:/~+#-]*[\w@?^=%&/~+#-])?/;if(t=t.trim(),/^http:\/\//.test(t)&&(t=t.replace("http://","https://")),e.test(t))return t;throw new Error("Invalid URL")},mo=t=>{const e=/^[0-9a-fA-F]{1,6}$/;if(t=t.trim(),/^!bsr /.test(t)&&(t=t.replace("!bsr ","")),e.test(t))return t;throw new Error("Invalid ID")},Wi=t=>{for(let e=t.options.length-1;e>=0;e--)t.remove(e)},Aa="UI Header: ",qi=document.querySelector(".intro"),Zi=document.querySelector(".metadata"),Je=document.querySelector(".cover__link"),Ba=document.querySelector(".cover__image"),po=document.querySelector(".metadata__song-name"),go=document.querySelector(".metadata__song-subname"),_o=document.querySelector(".metadata__song-author"),bo=document.querySelector(".metadata__song-bpm"),Ji=document.querySelector(".metadata__song-duration"),yo=document.querySelector(".audio"),pc="";if(!qi||!Zi)throw new Error(Aa+"header component is missing one of the two section");if(!Je||!Ba)throw new Error(Aa+"cover component is missing");if(!po||!go||!_o||!bo||!Ji)throw new Error(Aa+"metadata component is missing one of the part");const vo=t=>{t?(qi.classList.remove("hidden"),Zi.classList.add("hidden")):(qi.classList.add("hidden"),Zi.classList.remove("hidden"))},Eo=t=>{Ba.src=t||"./img/unknown.jpg"},gc=()=>Ba.src,wo=(t,e)=>{if(t==null&&e==null){Je.textContent="",Je.href="",Je.classList.add("disabled");return}t!=null&&(Je.textContent=e!=null?e:"Download Link",Je.href=t,Je.classList.remove("disabled"))},_c=t=>{po.textContent=t},bc=t=>{go.textContent=t},yc=t=>{_o.textContent=t},vc=(t,e,n)=>{let a=P(t,2).toString()+"BPM";bo.textContent=a},So=t=>{t?Ji.textContent=mc(t):Ji.textContent="No audio"},Ec=async t=>{const e=new Blob([t],{type:"audio/ogg"});yo.src=window.URL.createObjectURL(e)},Co=()=>{yo.src="",window.URL.revokeObjectURL(pc)},wc=()=>{vo(!0),Eo(null),wo(),So(0),Co()};var Ot={switchHeader:vo,setCoverImage:Eo,getCoverImage:gc,setCoverLink:wo,setSongName:_c,setSongSubname:bc,setSongAuthor:yc,setSongBPM:vc,setSongDuration:So,setAudio:Ec,unloadAudio:Co,reset:wc},Do=(t=>(t.tiny="panel--tiny",t.small="panel--small",t.medium="panel--medium",t.large="panel--large",t.max="panel--max",t))(Do||{}),Lo=(t=>(t.normal="panel--offset",t.half="panel--offset-half",t.none="",t))(Lo||{}),ii={create:(t,e,n,a)=>{const s=document.createElement("div");return s.className=`panel ${Do[t]}`,e&&e!=="none"&&s.classList.add(Lo[e]),n&&s.classList.add("panel--flex"+a?"-column":""),s}},hn=new class{constructor(){this.loading={info:!1,difficulty:!1,analysis:!1,audio:!1,coverImage:!1,contributorImage:!1,finished:!1}}resetLoad(){this.loading.info=!1,this.loading.difficulty=!1,this.loading.analysis=!1,this.loading.audio=!1,this.loading.coverImage=!1,this.loading.contributorImage=!1,this.loading.finished=!1}},at=new class{constructor(){this.beatmapInfo=null,this.beatmapDifficulty=[],this.contributors=[],this.analysis=null,this.duration=null}retrieveSafe(){if(!this.beatmapInfo)throw new Error("Beatmap info is not loaded.");if(!this.analysis)throw new Error("Beatmap analysis is not loaded.");if(this.duration===null)throw new Error("Audio is not loaded.");if(hn.loading.finished)return{beatmapInfo:this.beatmapInfo,beatmapDifficulty:this.beatmapDifficulty,contributors:this.contributors,analysis:this.analysis,duration:this.duration};throw new Error("Could not retrieve saved data, loading process is not finished.")}clear(){hn.loading.finished=!1,this.beatmapInfo=null,this.beatmapDifficulty=[],this.contributors=[],this.analysis=null,this.duration=null}};const xo=class{constructor(t,e=[],n=0){this._bpm=t,this._offset=n/1e3,this._bpmChange=this.getBPMChangeTime([...e])}get value(){return this._bpm}set value(t){this._bpm=t}get change(){return this._bpmChange}set change(t){this._bpmChange=this.getBPMChangeTime([...t])}get offset(){return this._offset*1e3}set offset(t){this._offset=t/1e3}getBPMChangeTime(t=[]){var a;let e;const n=[];for(let s=0;s<t.length;s++){const i={_BPM:(a=t[s]._BPM)!=null?a:t[s]._bpm,_time:t[s]._time,_beatsPerBar:t[s]._beatsPerBar,_metronomeOffset:t[s]._metronomeOffset,_newTime:0};e?i._newTime=Math.ceil((i._time-e._time)/this._bpm*e._BPM+e._newTime-.01):i._newTime=Math.ceil(i._time-this._offset*this._bpm/60-.01),n.push(i),e=i}return n}offsetBegone(t){return(this.toRealTime(t)-this._offset)*this._bpm/60}toRealTime(t){return t/this._bpm*60}toBeatTime(t){return t*this._bpm/60}toJSONTime(t){for(let e=this._bpmChange.length-1;e>=0;e--)if(t>this._bpmChange[e]._newTime)return(t-this._bpmChange[e]._newTime)/this._bpmChange[e]._BPM*this._bpm+this._bpmChange[e]._time;return(this.toRealTime(t)+this._offset)*this._bpm/60}adjustTime(t){for(let e=this._bpmChange.length-1;e>=0;e--)if(t>this._bpmChange[e]._time)return(t-this._bpmChange[e]._time)/this._bpm*this._bpmChange[e]._BPM+this._bpmChange[e]._newTime;return this.offsetBegone(t)}};let _e=xo;_e.create=(t,e,n)=>new xo(t,e,n);var $a=(t=>(t.Standard="Standard",t.NoArrows="No Arrows",t.OneSaber="One Saber",t["360Degree"]="360 Degree",t["90Degree"]="90 Degree",t.Lightshow="Lightshow",t.Lawless="Lawless",t))($a||{}),Ki=(t=>(t[t.Standard=0]="Standard",t[t.NoArrows=1]="NoArrows",t[t.OneSaber=2]="OneSaber",t[t["360Degree"]=3]="360Degree",t[t["90Degree"]=4]="90Degree",t[t.Lightshow=5]="Lightshow",t[t.Lawless=6]="Lawless",t))(Ki||{});const Xt={DefaultEnvironment:"The First",OriginsEnvironment:"Origins",TriangleEnvironment:"The First",NiceEnvironment:"The First",BigMirrorEnvironment:"The First",DragonsEnvironment:"The First",KDAEnvironment:"KDA",MonstercatEnvironment:"The First",CrabRaveEnvironment:"Crab Rave",PanicEnvironment:"The First",RocketEnvironment:"Rocket",GreenDayEnvironment:"Green Day",GreenDayGrenadeEnvironment:"Green Day",TimbalandEnvironment:"Timbaland",FitBeatEnvironment:"FitBeat",LinkinParkEnvironment:"Linkin Park",BTSEnvironment:"BTS",KaleidoscopeEnvironment:"Kaleidoscope",InterscopeEnvironment:"Interscope",SkrillexEnvironment:"Skrillex",BillieEnvironment:"Billie Eilish",HalloweenEnvironment:"Spooky",GagaEnvironment:"Gaga",WeaveEnvironment:"Weave",PyroEnvironment:"Pyro",EDMEnvironment:"EDM",GlassDesertEnvironment:"Glass Desert"},Sc={_colorLeft:"Left Note Color",_colorRight:"Right Note Color",_envColorLeft:"Left Environment Color",_envColorRight:"Right Environment Color",_envColorWhite:"White Environment Color",_envColorLeftBoost:"Left Environment Boost Color",_envColorRightBoost:"Right Environment Boost Color",_envColorWhiteBoost:"White Environment Boost Color",_obstacleColor:"Obstacle Color"},Ut={"Default Custom":{_colorLeft:{r:.7529412,g:.1882353,b:.1882353},_colorRight:{r:.1254902,g:.3921569,b:.6588235},_envColorLeft:{r:.7529412,g:.1882353,b:.1882353},_envColorRight:{r:.1882353,g:.5960785,b:1},_obstacleColor:{r:1,g:.1882353,b:.1882353}},"The First":{_colorLeft:{r:.7843137,g:.07843138,b:.07843138},_colorRight:{r:.1568627,g:.5568627,b:.8235294},_envColorLeft:{r:.85,g:.08499997,b:.08499997},_envColorRight:{r:.1882353,g:.675294,b:1},_obstacleColor:{r:1,g:.1882353,b:.1882353}},Origins:{_colorLeft:{r:.6792453,g:.5712628,b:0},_colorRight:{r:.7075472,g:0,b:.5364411},_envColorLeft:{r:.4910995,g:.6862745,b:.7},_envColorRight:{r:.03844783,g:.6862745,b:.9056604},_obstacleColor:{r:.06167676,g:.2869513,b:.3962264}},KDA:{_colorLeft:{r:.6588235,g:.2627451,b:.1607843},_colorRight:{r:.5019608,g:.08235294,b:.572549},_envColorLeft:{r:1,g:.3960785,b:.2431373},_envColorRight:{r:.7607844,g:.1254902,b:.8666667},_obstacleColor:{r:1,g:.3960785,b:.2431373}},"Crab Rave":{_colorLeft:{r:0,g:.7130001,b:.07806564},_colorRight:{r:.04805952,g:.5068096,b:.734},_envColorLeft:{r:.134568,g:.756,b:.1557533},_envColorRight:{r:.05647058,g:.6211764,b:.9},_obstacleColor:{r:0,g:.8117648,b:.09019608}},Noir:{_colorLeft:{r:.1792453,g:.1792453,b:.1792453},_colorRight:{r:.5943396,g:.5943396,b:.5943396},_envColorLeft:{r:.4056604,g:.4056604,b:.4056604},_envColorRight:{r:.6037736,g:.6037736,b:.6037736},_obstacleColor:{r:.2358491,g:.2358491,b:.2358491}},Rocket:{_colorLeft:{r:1,g:.4980392,b:0},_colorRight:{r:0,g:.5294118,b:1},_envColorLeft:{r:.9,g:.4866279,b:.3244186},_envColorRight:{r:.4,g:.7180724,b:1},_obstacleColor:{r:.3176471,g:.6117647,b:.7254902}},"Green Day":{_colorLeft:{r:.2588235,g:.7843138,b:.01960784},_colorRight:{r:0,g:.7137255,b:.6705883},_envColorLeft:{r:0,g:.7137255,b:.6705883},_envColorRight:{r:.2588235,g:.7843137,b:.01960784},_obstacleColor:{r:0,g:.8117648,b:.09019608}},Timbaland:{_colorLeft:{r:.5019608,g:.5019608,b:.5019608},_colorRight:{r:.1,g:.5517647,b:1},_envColorLeft:{r:.1,g:.5517647,b:1},_envColorRight:{r:.1,g:.5517647,b:1},_obstacleColor:{r:.5,g:.5,b:.5}},FitBeat:{_colorLeft:{r:.8000001,g:.6078432,b:.1568628},_colorRight:{r:.7921569,g:.1607843,b:.682353},_envColorLeft:{r:.8,g:.5594772,b:.5594772},_envColorRight:{r:.5594772,g:.5594772,b:.8},_obstacleColor:{r:.2784314,g:.2784314,b:.4}},"Linkin Park":{_colorLeft:{r:.6627451,g:.1643608,b:.1690187},_colorRight:{r:.3870196,g:.5168997,b:.5568628},_envColorLeft:{r:.7529412,g:.672753,b:.5925647},_envColorRight:{r:.6241197,g:.6890281,b:.709},_envColorLeftBoost:{r:.922,g:.5957885,b:.255394},_envColorRightBoost:{r:.282353,g:.4586275,b:.6235294},_obstacleColor:{r:.6627451,g:.1647059,b:.172549}},BTS:{_colorLeft:{r:1,g:.09019607,b:.4059771},_colorRight:{r:.8018868,g:0,b:.7517689},_envColorLeft:{r:.7843137,g:.1254902,b:.5010797},_envColorRight:{r:.6941177,g:.1254902,b:.8666667},_envColorLeftBoost:{r:.9019608,g:.5411765,b:1},_envColorRightBoost:{r:.3490196,g:.8078431,b:1},_obstacleColor:{r:.6698113,g:.1800908,b:.5528399}},Kaleidoscope:{_colorLeft:{r:.65882355,g:.1254902,b:.1254902},_colorRight:{r:.28235295,g:.28235295,b:.28235295},_envColorLeft:{r:.65882355,g:.1254902,b:.1254902},_envColorRight:{r:.47058824,g:.47058824,b:.47058824},_envColorLeftBoost:{r:.50196081,g:0,b:0},_envColorRightBoost:{r:.49244517,g:0,b:.53725493},_obstacleColor:{r:.25098041,g:.25098041,b:.25098041}},Interscope:{_colorLeft:{r:.726415,g:.62691,b:.31181},_colorRight:{r:.589571,g:.297888,b:.723},_envColorLeft:{r:.724254,g:.319804,b:.913725},_envColorRight:{r:.764706,g:.758971,b:.913725},_envColorLeftBoost:{r:.792453,g:.429686,b:.429868},_envColorRightBoost:{r:.7038,g:.715745,b:.765},_obstacleColor:{r:.588235,g:.298039,b:.721569}},Skrillex:{_colorLeft:{r:.69803923,g:.14117648,b:.36862746},_colorRight:{r:.32933334,g:.32299998,b:.38},_envColorLeft:{r:.80000001,g:.28000003,b:.58594489},_envColorRight:{r:.06525807,g:.57800001,b:.56867743},_envColorLeftBoost:{r:.81176478,g:.30588236,b:.30588236},_envColorRightBoost:{r:.27843139,g:.80000001,b:.44597632},_obstacleColor:{r:.15686275,g:.60392159,b:.60392159}},"Billie Eilish":{_colorLeft:{r:.80000001,g:.64481932,b:.43200001},_colorRight:{r:.54808509,g:.61276591,b:.63999999},_envColorLeft:{r:.81960785,g:.442,b:.184},_envColorRight:{r:.94117647,g:.70677096,b:.56470591},_obstacleColor:{r:.71325314,g:.56140977,b:.78301889},_envColorLeftBoost:{r:.80000001,g:0,b:0},_envColorRightBoost:{r:.55686277,g:.7019608,b:.77647066}},Spooky:{_colorLeft:{r:.81960785,g:.49807876,b:.27702752},_colorRight:{r:.37894738,g:.35789475,b:.40000001},_envColorLeft:{r:.90196079,g:.23009226,b:0},_envColorRight:{r:.46005884,g:.56889427,b:.92941177},_obstacleColor:{r:.81960791,g:.44313729,b:.18431373},_envColorLeftBoost:{r:.33768433,g:.63207543,b:.33690813},_envColorRightBoost:{r:.60209066,g:.3280082,b:.85849059}},Gaga:{_colorLeft:{r:.85,g:.4333333,b:.7833334},_colorRight:{r:.4705882,g:.8,b:.4078431},_envColorLeft:{r:.706,g:.649,b:.2394706},_envColorRight:{r:.894,g:.1625455,b:.7485644},_obstacleColor:{r:.9921569,g:0,b:.7719755},_envColorLeftBoost:{r:.754717,g:.3610244,b:.22071921},_envColorRightBoost:{r:0,g:.7058824,b:1}},Weave:{_colorLeft:{r:.7843137,g:.07843138,b:.07843138},_colorRight:{r:.1568627,g:.5568627,b:.8235294},_envColorLeft:{r:.85,g:.08499997,b:.08499997},_envColorRight:{r:.1882353,g:.675294,b:1},_envColorLeftBoost:{r:.8218409,g:.08627451,b:.8509804},_envColorRightBoost:{r:.5320754,g:.5320754,b:.5320754},_obstacleColor:{r:1,g:.1882353,b:.1882353}},Pyro:{_colorLeft:{r:.5764706,g:0,b:.03921569},_colorRight:{r:1,g:.6705883,b:0},_envColorLeft:{r:1,g:.1098039,b:.2039216},_envColorRight:{r:.8862745,g:.7372549,b:.2627451},_envColorLeftBoost:{r:1,g:0,b:.1764706},_envColorRightBoost:{r:.7647059,g:.7647059,b:.7647059},_obstacleColor:{r:.8490566,g:.7037643,b:.4285333}},EDM:{_colorLeft:{r:.6320754,g:.6320754,b:.6320754},_colorRight:{r:.1764706,g:.6980392,b:.8784314},_envColorLeft:{r:.08220173,g:.7169812,b:0},_envColorRight:{r:0,g:.3671638,b:.7169812},_envColorLeftBoost:{r:.735849,g:0,b:.1758632},_envColorRightBoost:{r:.4284593,g:0,b:.754717},_obstacleColor:{r:.1764706,g:.6980392,b:.8784314}},"Glass Desert":{_colorLeft:{r:.6792453,g:.5712628,b:0},_colorRight:{r:.7075472,g:0,b:.5364411},_envColorLeft:{r:.32222217,g:.6111111,b:.75},_envColorRight:{r:.03844783,g:.62239975,b:.90566039},_obstacleColor:{r:.06167676,g:.2869513,b:.3962264}}},ue=4,Jt={[0]:180,[1]:0,[2]:270,[3]:90,[4]:225,[5]:135,[6]:315,[7]:45,[8]:0},Cc={[0]:1,[1]:0,[2]:3,[3]:2,[4]:7,[5]:6,[6]:5,[7]:4,[8]:8},Ae={[0]:[0,1],[1]:[0,-1],[2]:[-1,0],[3]:[1,0],[4]:[-1,1],[5]:[1,1],[6]:[-1,-1],[7]:[1,-1],[8]:[0,0]},Dc={0:-60,1:-45,2:-30,3:-15,4:15,5:30,6:45,7:60};var Pn=(t=>(t.Easy="Easy",t.Normal="Normal",t.Hard="Hard",t.Expert="Expert",t.ExpertPlus="Expert+",t))(Pn||{});const Lc={DefaultEnvironment:"The First",OriginsEnvironment:"Origins",TriangleEnvironment:"Triangle",NiceEnvironment:"Nice",BigMirrorEnvironment:"Big Mirror",DragonsEnvironment:"Dragons",KDAEnvironment:"K/DA",MonstercatEnvironment:"Monstercat",CrabRaveEnvironment:"Crab Rave",PanicEnvironment:"Panic",RocketEnvironment:"Rocket",GreenDayEnvironment:"Green Day",GreenDayGrenadeEnvironment:"Green Day Grenade",TimbalandEnvironment:"Timbaland",FitBeatEnvironment:"FitBeat",LinkinParkEnvironment:"Linkin Park",BTSEnvironment:"BTS",KaleidoscopeEnvironment:"Kaleidoscope",InterscopeEnvironment:"Interscope",SkrillexEnvironment:"Skrillex",BillieEnvironment:"Billie",HalloweenEnvironment:"Spooky",GagaEnvironment:"Gaga",WeaveEnvironment:"Weave",PyroEnvironment:"Pyro",EDMEnvironment:"EDM",GlassDesertEnvironment:"Glass Desert"},Be={DefaultEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],OriginsEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],TriangleEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],NiceEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],BigMirrorEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],DragonsEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],KDAEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],MonstercatEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],CrabRaveEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],PanicEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],RocketEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],GreenDayEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],GreenDayGrenadeEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],TimbalandEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],FitBeatEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],LinkinParkEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],BTSEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],KaleidoscopeEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],InterscopeEnvironment:[[0,1,2,3,4,5,6,7,8,9,12,13,16,17],[]],SkrillexEnvironment:[[0,1,2,3,4,5,6,7,8,9,12,13],[]],BillieEnvironment:[[0,1,2,3,4,5,6,7,8,9,10,11,12,13,16,17],[]],HalloweenEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],GagaEnvironment:[[0,1,2,3,4,5,6,7,8,9,10,11,12,13,16,17],[]],GlassDesertEnvironment:[[0,1,2,3,4,5,8,9,12,13],[]],WeaveEnvironment:[[],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]],PyroEnvironment:[[0,1,2,3,4,6],[0,1,2,3,4,5,6,7,8,9,10,11,12,13]],EDMEnvironment:[[0,1,4],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]]},tn=class{constructor(t,e=10,n=0){this._bpm=t,this._njs=e,this._sdm=n,this.update()}get value(){return this._njs}set value(t){this._njs=t,this.update()}get offset(){return this._sdm}set offset(t){this._sdm=t,this.update()}get hjd(){return this._hjd}get hjdMin(){return tn.HJD_MIN}get reactTime(){return this._reactionTime}get jd(){return this._jd}get jdMin(){return this._jdMin}update(){this._hjd=this.calcHalfJumpDuration(),this._jd=this.calcJumpDistance(),this._jdMin=this.calcJumpDistance(tn.HJD_MIN),this._reactionTime=this.calcReactionTimeFromHJD()}calcHalfJumpDurationRaw(){const e=this._njs*this._njs/this._njs,n=60/this._bpm.value;let a=tn.HJD_START;for(;e*n*a>17.999;)a/=2;return a<1&&(a=1),a}calcHalfJumpDuration(t=this.offset){return Math.max(this.calcHalfJumpDurationRaw()+t,tn.HJD_MIN)}calcHalfJumpDurationFromJD(t=this.calcJumpDistance()){return t/(60/this._bpm.value*this._njs*2)}calcHalfJumpDurationFromRT(t=this.calcReactionTimeFromHJD()){return t/(60/this._bpm.value)}calcJumpDistance(t=this.calcHalfJumpDuration()){return this._njs*(60/this._bpm.value)*t*2}calcJumpDistanceOptimalHigh(){return 18*(1/1.07)**this._njs+18}calcJumpDistanceOptimalLow(){return-(18/(this._njs+1))+18}calcReactionTimeFromJD(t=this.calcJumpDistance()){return t/(2*this._njs)}calcReactionTimeFromHJD(t=this.calcHalfJumpDuration()){return 60/this._bpm.value*t}calcDistance(t){return this._njs*60/this._bpm.value*t*2}};let $e=tn;$e.HJD_START=4;$e.HJD_MIN=.25;$e.create=(t,e=10,n=0)=>typeof t=="number"?new tn(_e.create(t),e,n):new tn(t,e,n);$e.FallbackNJS={ExpertPlus:16,Expert:12,Hard:10,Normal:10,Easy:10};const xc=(t,e)=>{const n=Fr(t),a=Fr(e);for(const s in n){if(n[s]<a[s])return"old";if(n[s]>a[s])return"new"}return"current"},Fr=t=>t.replace("v","").split(".").map(e=>parseInt(e));class Wt{constructor(e){this.data=e}serialize(){return JSON.stringify(this.toObject())}}class Ni extends Wt{get time(){return this.data._time}set time(e){this.data._time=e}get customData(){return this.data._customData}set customData(e){this.data._customData=e}setCustomData(e){return this.customData=e,this}deleteCustomData(){return this.customData={},this}removeCustomData(e){return this.customData&&delete this.customData[e],this}addCustomData(e){return this.customData=qn(Wn({},this.customData),{object:e}),this}}const Nt=class extends Ni{constructor(t){super(t),this.isNote=()=>this.type===0||this.type===1,this.isBomb=()=>this.type===3,this.getPosition=()=>{var e;return(e=this.customData)!=null&&e._position?[this.customData._position[0],this.customData._position[1]]:[(this.lineIndex<=-1e3?this.lineIndex/1e3:this.lineIndex>=1e3?this.lineIndex/1e3:this.lineIndex)-2,this.lineLayer<=-1e3?this.lineLayer/1e3:this.lineLayer>=1e3?this.lineLayer/1e3:this.lineLayer]},this.getAngle=()=>{var e;return(e=this.customData)!=null&&e._cutDirection?this.customData._cutDirection>0?this.customData._cutDirection%360:360+this.customData._cutDirection%360:this.cutDirection>=1e3?Math.abs(this.cutDirection%1e3%360-360):Jt[this.cutDirection]||0},this.getDistance=e=>{const[n,a]=this.getPosition(),[s,i]=e.getPosition();return Math.sqrt(Math.pow(s-n,2)+Math.pow(i-a,2))},this.isVertical=e=>{const[n]=this.getPosition(),[a]=e.getPosition(),s=n-a;return s>-.001&&s<.001},this.isHorizontal=e=>{const[n,a]=this.getPosition(),[s,i]=e.getPosition(),l=a-i;return l>-.001&&l<.001},this.isDiagonal=e=>{const[n,a]=this.getPosition(),[s,i]=e.getPosition(),l=Math.abs(n-s),r=Math.abs(a-i);return l===r},this.isInline=(e,n=.5)=>this.getDistance(e)<=n,this.isDouble=(e,n)=>{for(let a=n,s=e.length;a<s;a++){if(e[a].time<this.time+.01&&e[a].type!==this.type)return!0;if(e[a].time>this.time+.01)return!1}return!1},this.isAdjacent=e=>{const n=this.getDistance(e);return n>.499&&n<1.001},this.isWindow=e=>this.getDistance(e)>1.8,this.isSlantedWindow=e=>this.isWindow(e)&&!this.isDiagonal(e)&&!this.isHorizontal(e)&&!this.isVertical(e),this.hasChroma=()=>{var e,n;return Array.isArray((e=this.customData)==null?void 0:e._color)||typeof((n=this.customData)==null?void 0:n._disableSpawnEffect)=="boolean"},this.hasNoodleExtensions=()=>{var e,n,a,s,i,l,r,o,u,h,m,g,c;return Array.isArray((e=this.customData)==null?void 0:e._animation)||typeof((n=this.customData)==null?void 0:n._cutDirection)=="number"||typeof((a=this.customData)==null?void 0:a._disableNoteGravity)=="boolean"||typeof((s=this.customData)==null?void 0:s._disableNoteLook)=="boolean"||typeof((i=this.customData)==null?void 0:i._fake)=="boolean"||Array.isArray((l=this.customData)==null?void 0:l._flip)||typeof((r=this.customData)==null?void 0:r._interactable)=="boolean"||Array.isArray((o=this.customData)==null?void 0:o._localRotation)||typeof((u=this.customData)==null?void 0:u._noteJumpMovementSpeed)=="number"||typeof((h=this.customData)==null?void 0:h._noteJumpStartBeatOffset)=="number"||Array.isArray((m=this.customData)==null?void 0:m._position)||Array.isArray((g=this.customData)==null?void 0:g._rotation)||typeof((c=this.customData)==null?void 0:c._track)=="string"},this.hasMappingExtensions=()=>this.cutDirection>=1e3||this.lineIndex>3||this.lineIndex<0||this.lineLayer>2||this.lineLayer<0,this.isValidDirection=()=>this.cutDirection>=0&&this.cutDirection<=8,this.isValid=()=>!this.hasMappingExtensions()&&this.isValidDirection()}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,s,i,l,r,o;return e.push(new Nt({_time:(a=n._time)!=null?a:Nt.default._time,_lineIndex:(s=n._lineIndex)!=null?s:Nt.default._lineIndex,_lineLayer:(i=n._lineLayer)!=null?i:Nt.default._lineLayer,_type:(l=n._type)!=null?l:Nt.default._type,_cutDirection:(r=n._cutDirection)!=null?r:Nt.default._cutDirection,_customData:(o=n._customData)!=null?o:Nt.default._customData()}))}),e.length===1?e[0]:e.length?e:new Nt({_time:Nt.default._time,_lineIndex:Nt.default._lineIndex,_lineLayer:Nt.default._lineLayer,_type:Nt.default._type,_cutDirection:Nt.default._cutDirection,_customData:Nt.default._customData()})}toObject(){return{_time:this.time,_type:this.type,_lineIndex:this.lineIndex,_lineLayer:this.lineLayer,_cutDirection:this.cutDirection,_customData:Dt(this.customData)}}get lineIndex(){return this.data._lineIndex}set lineIndex(t){this.data._lineIndex=t}get lineLayer(){return this.data._lineLayer}set lineLayer(t){this.data._lineLayer=t}get type(){return this.data._type}set type(t){this.data._type=t}get cutDirection(){return this.data._cutDirection}set cutDirection(t){this.data._cutDirection=t}setLineIndex(t){return this.lineIndex=t,this}setLineLayer(t){return this.lineLayer=t,this}setType(t){return this.type=t,this}setCutDirection(t){return this.cutDirection=t,this}};let Qi=Nt;Qi.default={_time:0,_lineIndex:0,_lineLayer:0,_type:0,_cutDirection:0,_customData:()=>({})};const pt=class extends Wt{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,s,i,l,r,o,u,h,m,g,c,p,_,y;return e.push(new pt({_colorType:(a=n._colorType)!=null?a:pt.default._colorType,_headTime:(i=(s=n._headTime)!=null?s:n._tailTime)!=null?i:pt.default._headTime,_headLineIndex:(l=n._headLineIndex)!=null?l:pt.default._headLineIndex,_headLineLayer:(r=n._headLineLayer)!=null?r:pt.default._headLineLayer,_headCutDirection:(o=n._headCutDirection)!=null?o:pt.default._headCutDirection,_headControlPointlengthMultiplier:(u=n._headControlPointlengthMultiplier)!=null?u:pt.default._headControlPointlengthMultiplier,_tailTime:(m=(h=n._tailTime)!=null?h:n._headTime)!=null?m:pt.default._tailTime,_tailLineIndex:(g=n._tailLineIndex)!=null?g:pt.default._tailLineIndex,_tailLineLayer:(c=n._tailLineLayer)!=null?c:pt.default._tailLineLayer,_tailCutDirection:(p=n._tailCutDirection)!=null?p:pt.default._tailCutDirection,_tailControlPointLengthMultiplier:(_=n._tailControlPointLengthMultiplier)!=null?_:pt.default._tailControlPointLengthMultiplier,_sliderMidAnchorMode:(y=n._sliderMidAnchorMode)!=null?y:pt.default._sliderMidAnchorMode}))}),e.length===1?e[0]:e.length?e:new pt({_colorType:pt.default._colorType,_headTime:pt.default._headTime,_headLineIndex:pt.default._headLineIndex,_headLineLayer:pt.default._headLineLayer,_headCutDirection:pt.default._headCutDirection,_headControlPointlengthMultiplier:pt.default._headControlPointlengthMultiplier,_tailTime:pt.default._tailTime,_tailLineIndex:pt.default._tailLineIndex,_tailLineLayer:pt.default._tailLineLayer,_tailCutDirection:pt.default._tailCutDirection,_tailControlPointLengthMultiplier:pt.default._tailControlPointLengthMultiplier,_sliderMidAnchorMode:pt.default._sliderMidAnchorMode})}toObject(){return{_colorType:this.colorType,_headTime:this.headTime,_headLineIndex:this.headLineIndex,_headLineLayer:this.headLineLayer,_headCutDirection:this.headCutDirection,_headControlPointlengthMultiplier:this.headLengthMultiplier,_tailTime:this.tailTime,_tailLineIndex:this.tailLineIndex,_tailLineLayer:this.tailLineLayer,_tailCutDirection:this.tailCutDirection,_tailControlPointLengthMultiplier:this.tailLengthMultiplier,_sliderMidAnchorMode:this.midAnchor}}get colorType(){return this.data._colorType}set colorType(t){this.data._colorType=t}get headTime(){return this.data._headTime}set headTime(t){this.data._headTime=t}get headLineIndex(){return this.data._headLineIndex}set headLineIndex(t){this.data._headLineIndex=t}get headLineLayer(){return this.data._headLineLayer}set headLineLayer(t){this.data._headLineLayer=t}get headCutDirection(){return this.data._headCutDirection}set headCutDirection(t){this.data._headCutDirection=t}get headLengthMultiplier(){return this.data._headControlPointlengthMultiplier}set headLengthMultiplier(t){this.data._headControlPointlengthMultiplier=t}get tailTime(){return this.data._tailTime}set tailTime(t){this.data._tailTime=t}get tailLineIndex(){return this.data._tailLineIndex}set tailLineIndex(t){this.data._tailLineIndex=t}get tailLineLayer(){return this.data._tailLineLayer}set tailLineLayer(t){this.data._tailLineLayer=t}get tailCutDirection(){return this.data._tailCutDirection}set tailCutDirection(t){this.data._tailCutDirection=t}get tailLengthMultiplier(){return this.data._tailControlPointLengthMultiplier}set tailLengthMultiplier(t){this.data._tailControlPointLengthMultiplier=t}get midAnchor(){return this.data._sliderMidAnchorMode}set midAnchor(t){this.data._sliderMidAnchorMode=t}setColor(t){return this.colorType=t,this}setPosX(t){return this.headLineIndex=t,this}setPosY(t){return this.headLineLayer=t,this}setDirection(t){return this.headCutDirection=t,this}setLengthMultiplier(t){return this.headLengthMultiplier=t,this}setTailTime(t){return this.tailTime=t,this}setTailPosX(t){return this.tailLineIndex=t,this}setTailPosY(t){return this.tailLineLayer=t,this}setTailDirection(t){return this.tailCutDirection=t,this}setTailLengthMultiplier(t){return this.tailLengthMultiplier=t,this}setMidAnchor(t){return this.midAnchor=t,this}mirror(t=!0){switch(this.headLineIndex=ue-1-this.headLineIndex,this.tailLineIndex=ue-1-this.tailLineIndex,t&&(this.colorType=(1+this.colorType)%2),this.headCutDirection){case 2:this.headCutDirection=3;break;case 3:this.headCutDirection=2;break;case 6:this.headCutDirection=7;break;case 7:this.headCutDirection=6;break;case 4:this.headCutDirection=5;break;case 5:this.headCutDirection=4;break}switch(this.tailCutDirection){case 2:this.tailCutDirection=3;break;case 3:this.tailCutDirection=2;break;case 6:this.tailCutDirection=7;break;case 7:this.tailCutDirection=6;break;case 4:this.tailCutDirection=5;break;case 5:this.tailCutDirection=4;break}return this.midAnchor&&(this.midAnchor=this.midAnchor===1?2:1),this}hasMappingExtensions(){return this.headLineLayer>2||this.headLineLayer<0||this.headLineIndex<=-1e3||this.headLineIndex>=1e3||this.headCutDirection>=1e3&&this.headCutDirection<=1360||this.tailCutDirection>=1e3&&this.tailCutDirection<=1360}};let ta=pt;ta.default={_colorType:0,_headTime:0,_headLineIndex:0,_headLineLayer:0,_headCutDirection:0,_headControlPointlengthMultiplier:.5,_tailTime:0,_tailLineIndex:0,_tailLineLayer:0,_tailCutDirection:0,_tailControlPointLengthMultiplier:.5,_sliderMidAnchorMode:0};const Ct=class extends Ni{constructor(t){super(t),this.getPosition=()=>{var e;return(e=this.customData)!=null&&e._position?[this.customData._position[0],this.customData._position[1]]:[(this.lineIndex<=-1e3?this.lineIndex/1e3:this.lineIndex>=1e3?this.lineIndex/1e3:this.lineIndex)-2,this.type<=-1e3?this.type/1e3:this.type>=1e3?this.type/1e3:this.type]},this.isInteractive=()=>this.width>=2||this.lineIndex===1||this.lineIndex===2,this.isCrouch=()=>this.type===1&&(this.width>2||this.width===2&&this.lineIndex===1),this.isZero=()=>this.duration===0||this.width===0,this.isLonger=(e,n,a=0)=>e._time+e._duration>n._time+n._duration+a,this.hasChroma=()=>{var e;return Array.isArray((e=this.customData)==null?void 0:e._color)},this.hasNoodleExtensions=()=>{var e,n,a,s,i,l,r,o,u,h;return Array.isArray((e=this.customData)==null?void 0:e._animation)||typeof((n=this.customData)==null?void 0:n._fake)=="boolean"||typeof((a=this.customData)==null?void 0:a._interactable)=="boolean"||Array.isArray((s=this.customData)==null?void 0:s._localRotation)||typeof((i=this.customData)==null?void 0:i._noteJumpMovementSpeed)=="number"||typeof((l=this.customData)==null?void 0:l._noteJumpStartBeatOffset)=="number"||Array.isArray((r=this.customData)==null?void 0:r._position)||Array.isArray((o=this.customData)==null?void 0:o._rotation)||Array.isArray((u=this.customData)==null?void 0:u._scale)||typeof((h=this.customData)==null?void 0:h._track)=="string"},this.hasMappingExtensions=()=>this.width>=1e3||this.type>=1e3||this.lineIndex>3||this.lineIndex<0,this.isValid=()=>!this.hasMappingExtensions()&&this.width>0&&this.width<=4}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,s,i,l,r,o,u,h;return e.push(new Ct({_time:(a=n._time)!=null?a:Ct.default._time,_type:(s=n._type)!=null?s:Ct.default._type,_lineIndex:(i=n._lineIndex)!=null?i:Ct.default._lineIndex,_lineLayer:(l=n._lineLayer)!=null?l:Ct.default._lineLayer,_duration:(r=n._duration)!=null?r:Ct.default._duration,_width:(o=n._width)!=null?o:Ct.default._width,_height:(u=n._height)!=null?u:Ct.default._height,_customData:(h=n._customData)!=null?h:Ct.default._customData()}))}),e.length===1?e[0]:e.length?e:new Ct({_time:Ct.default._time,_type:Ct.default._type,_lineIndex:Ct.default._lineIndex,_lineLayer:Ct.default._lineLayer,_duration:Ct.default._duration,_width:Ct.default._width,_height:Ct.default._height,_customData:Ct.default._customData()})}toObject(){return{_time:this.time,_type:this.type,_lineIndex:this.lineIndex,_lineLayer:this.lineLayer,_duration:this.duration,_width:this.width,_height:this.height,_customData:Dt(this.customData)}}get lineIndex(){return this.data._lineIndex}set lineIndex(t){this.data._lineIndex=t}get lineLayer(){return this.data._lineLayer}set lineLayer(t){this.data._lineLayer=t}get type(){return this.data._type}set type(t){this.data._type=t}get duration(){return this.data._duration}set duration(t){this.data._duration=t}get width(){return this.data._width}set width(t){this.data._width=t}get height(){return this.data._height}set height(t){this.data._height=t}setType(t){return this.type=t,this}setLineIndex(t){return this.lineIndex=t,this}setLineLayer(t){return this.lineLayer=t,this}setDuration(t){return this.duration=t,this}setWidth(t){return this.width=t,this}setHeight(t){return this.height=t,this}};let ea=Ct;ea.default={_time:0,_lineIndex:0,_lineLayer:0,_type:0,_duration:1,_width:1,_height:1,_customData:()=>({})};const Pt=class extends Ni{constructor(t){super(t),this.isOff=()=>this.value===0,this.isOn=()=>this.value===1||this.value===5||this.value===9,this.isFlash=()=>this.value===2||this.value===6||this.value===10,this.isFade=()=>this.value===3||this.value===7||this.value===11,this.isTransition=()=>this.value===4||this.value===8||this.value===12,this.isValidType=()=>this.type>=0&&this.type<=17||this.type===100,this.isLightEvent=()=>this.type===0||this.type===1||this.type===2||this.type===3||this.type===4||this.type===6||this.type===7||this.type===10||this.type===11,this.isColorBoost=()=>this.type===5,this.isRingEvent=()=>this.type===8||this.type===9,this.isLaserRotationEvent=()=>this.type===12||this.type===13,this.isLaneRotationEvent=()=>this.type===14||this.type===15,this.isExtraEvent=()=>this.type===16||this.type===17||this.type===18||this.type===19,this.isSpecialEvent=()=>this.type===40||this.type===41||this.type===42||this.type===43,this.isBPMChangeEvent=()=>this.type===100,this.isLightingEvent=()=>this.isLightEvent()||this.isRingEvent()||this.isLaserRotationEvent()||this.isExtraEvent(),this.hasChroma=()=>{var e,n,a,s,i,l,r,o,u,h,m,g,c,p,_,y,b,v,S,L,D,O;return this.isLightEvent()?Array.isArray((e=this.customData)==null?void 0:e._color)||typeof((n=this.customData)==null?void 0:n._lightID)=="number"||Array.isArray((a=this.customData)==null?void 0:a._lightID)||typeof((s=this.customData)==null?void 0:s._propID)=="number"||typeof((i=this.customData)==null?void 0:i._lightGradient)=="object"||typeof((l=this.customData)==null?void 0:l._easing)=="string"||typeof((r=this.customData)==null?void 0:r._lerpType)=="string":this.isRingEvent()?typeof((o=this.customData)==null?void 0:o._nameFilter)=="string"||typeof((u=this.customData)==null?void 0:u._reset)=="boolean"||typeof((h=this.customData)==null?void 0:h._rotation)=="number"||typeof((m=this.customData)==null?void 0:m._step)=="number"||typeof((g=this.customData)==null?void 0:g._prop)=="number"||typeof((c=this.customData)==null?void 0:c._speed)=="number"||typeof((p=this.customData)==null?void 0:p._direction)=="number"||typeof((_=this.customData)==null?void 0:_._counterSpin)=="boolean"||typeof((y=this.customData)==null?void 0:y._stepMult)=="number"||typeof((b=this.customData)==null?void 0:b._propMult)=="number"||typeof((v=this.customData)==null?void 0:v._speedMult)=="number":this.isLaserRotationEvent()?typeof((S=this.customData)==null?void 0:S._lockPosition)=="boolean"||typeof((L=this.customData)==null?void 0:L._speed)=="number"||typeof((D=this.customData)==null?void 0:D._preciseSpeed)=="number"||typeof((O=this.customData)==null?void 0:O._direction)=="number":!1},this.hasOldChroma=()=>this.value>=2e9,this.hasNoodleExtensions=()=>{var e;return this.isLaneRotationEvent()&&typeof((e=this.customData)==null?void 0:e._rotation)=="number"},this.hasMappingExtensions=()=>this.isLaneRotationEvent()&&this.value>=1e3&&this.value<=1720,this.isValid=()=>this.isValidType()&&this.value>=0&&!(!this.isLaserRotationEvent()&&this.value>12&&!this.hasOldChroma())}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,s,i,l,r;return e.push(new Pt({_time:(a=n._time)!=null?a:Pt.default._time,_type:(s=n._type)!=null?s:Pt.default._type,_value:(i=n._value)!=null?i:Pt.default._value,_floatValue:(l=n._floatValue)!=null?l:Pt.default._floatValue,_customData:(r=n._customData)!=null?r:Pt.default._customData()}))}),e.length===1?e[0]:e.length?e:new Pt({_time:Pt.default._time,_type:Pt.default._type,_value:Pt.default._value,_floatValue:Pt.default._floatValue,_customData:Pt.default._customData()})}toObject(){return{_time:this.time,_type:this.type,_value:this.value,_floatValue:this.floatValue,_customData:Dt(this.customData)}}get type(){return this.data._type}set type(t){this.data._type=t}get value(){return this.data._value}set value(t){this.data._value=t}get floatValue(){return this.data._floatValue}set floatValue(t){this.data._floatValue=t}setType(t){return this.type=t,this}setValue(t){return this.value=t,this}setFloatValue(t){return this.floatValue=t,this}};let na=Pt;na.default={_time:0,_type:0,_value:0,_floatValue:1,_customData:()=>({})};const Ft=class extends Ni{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,s,i,l,r;return e.push(new Ft({_time:(a=n._time)!=null?a:Ft.default._time,_lineIndex:(s=n._lineIndex)!=null?s:Ft.default._lineIndex,_lineLayer:(i=n._lineLayer)!=null?i:Ft.default._lineLayer,_offsetDirection:(l=n._offsetDirection)!=null?l:Ft.default._offsetDirection,_customData:(r=n._customData)!=null?r:Ft.default._customData()}))}),e.length===1?e[0]:e.length?e:new Ft({_time:Ft.default._time,_lineIndex:Ft.default._lineIndex,_lineLayer:Ft.default._lineLayer,_offsetDirection:Ft.default._offsetDirection,_customData:Ft.default._customData()})}toObject(){return{_time:this.time,_lineIndex:this.lineIndex,_lineLayer:this.lineLayer,_offsetDirection:this.direction,_customData:Dt(this.customData)}}get lineIndex(){return this.data._lineIndex}set lineIndex(t){this.data._lineIndex=t}get lineLayer(){return this.data._lineLayer}set lineLayer(t){this.data._lineLayer=t}get direction(){return this.data._offsetDirection}set direction(t){this.data._offsetDirection=t}setLineIndex(t){return this.lineIndex=t,this}setLineLayer(t){return this.lineLayer=t,this}setDirection(t){return this.direction=t,this}mirror(){switch(this.lineIndex=ue-1-this.lineIndex,this.direction){case 2:this.direction=3;break;case 3:this.direction=2;break;case 6:this.direction=7;break;case 7:this.direction=6;break;case 4:this.direction=5;break;case 5:this.direction=4;break}return this}};let ia=Ft;ia.default={_time:0,_lineIndex:0,_lineLayer:0,_offsetDirection:1,_customData:()=>({})};const Ke=class extends Wt{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,s;return e.push(new Ke({_keyword:(a=n._keyword)!=null?a:Ke.default._keyword,_specialEvents:(s=n._specialEvents)!=null?s:Ke.default._specialEvents()}))}),e.length===1?e[0]:e.length?e:new Ke({_keyword:Ke.default._keyword,_specialEvents:Ke.default._specialEvents()})}toObject(){return{_keyword:this.keyword,_specialEvents:this.events}}get keyword(){return this.data._keyword}set keyword(t){this.data._keyword=t}get events(){return this.data._specialEvents}set events(t){this.data._specialEvents=t}setKeyword(t){return this.keyword=t,this}setEvents(t){return this.events=t,this}addEvent(t){return this.events.push(t),this}removeEvent(t){const e=this.events.indexOf(t,0);return e>-1&&this.events.splice(e,1),this}};let aa=Ke;aa.default={_keyword:"",_specialEvents:()=>[]};const ra=class extends Wt{constructor(t){super(t),this.keywords=t._keywords.map(e=>aa.create({_keyword:e._keyword,_specialEvents:e._specialEvents}))}static create(t={}){var e;return new ra({_keywords:(e=t._keywords)!=null?e:ra.default._keywords()})}toObject(){return{_keywords:this.keywords.map(t=>t.toObject())}}setKeyword(t){return this.keywords=t,this}addKeyword(t){return this.keywords.push(aa.create(t)),this}removeKeyword(t){return this.keywords=this.keywords.filter(e=>e.keyword!==t),this}};let ko=ra;ko.default={_keywords:()=>[]};class Na extends Wt{constructor(e){super(e),this.getFirstInteractiveTime=()=>{let n=Number.MAX_VALUE;this.notes.length>0&&(n=this.notes[0].time);const a=this.findFirstInteractiveObstacleTime();return Math.min(n,a)},this.getLastInteractiveTime=()=>{let n=0;this.notes.length>0&&(n=this.notes[this.notes.length-1].time);const a=this.findLastInteractiveObstacleTime();return Math.max(n,a)},this.findFirstInteractiveObstacleTime=()=>{for(let n=0,a=this.obstacles.length;n<a;n++)if(this.obstacles[n].isInteractive())return this.obstacles[n].time;return Number.MAX_VALUE},this.findLastInteractiveObstacleTime=()=>{let n=0;for(let a=this.obstacles.length-1;a>=0;a--)this.obstacles[a].isInteractive()&&(n=Math.max(n,this.obstacles[a].time+this.obstacles[a].duration));return n},this.addNotes=(...n)=>{n.forEach(a=>{this.notes.push(Qi.create(a))})},this.addObstacles=(...n)=>{n.forEach(a=>{this.obstacles.push(ea.create(a))})},this.addEvents=(...n)=>{n.forEach(a=>{this.events.push(na.create(a))})},this.addWaypoints=(...n)=>{n.forEach(a=>{this.waypoints.push(ia.create(a))})},this.addSliders=(...n)=>{n.forEach(a=>{this.sliders.push(ta.create(a))})},this.version="2.6.0",this.notes=e._notes.map(n=>Qi.create(n)),this.sliders=e._sliders.map(n=>ta.create(n)),this.obstacles=e._obstacles.map(n=>ea.create(n)),this.events=e._events.map(n=>na.create(n)),this.waypoints=e._waypoints.map(n=>ia.create(n)),this.specialEventsKeywordFilters=ko.create(e._specialEventsKeywordFilters),this.customData=e._customData}static create(e={}){var n,a,s,i,l,r,o;return new Na({_version:"2.6.0",_notes:(n=e._notes)!=null?n:[],_sliders:(a=e._sliders)!=null?a:[],_obstacles:(s=e._obstacles)!=null?s:[],_events:(i=e._events)!=null?i:[],_waypoints:(l=e._waypoints)!=null?l:[],_specialEventsKeywordFilters:(r=e._specialEventsKeywordFilters)!=null?r:{_keywords:[]},_customData:(o=e._customData)!=null?o:{}})}toObject(){var e;return{_version:this.version||"2.6.0",_notes:this.notes.map(n=>n.toObject()),_sliders:this.sliders.map(n=>n.toObject()),_obstacles:this.obstacles.map(n=>n.toObject()),_events:this.events.map(n=>n.toObject()),_waypoints:this.waypoints.map(n=>n.toObject()),_specialEventsKeywordFilters:(e=this.specialEventsKeywordFilters)==null?void 0:e.toObject(),_customData:Dt(this.customData)}}}class Oe extends Wt{get time(){return this.data.b}set time(e){this.data.b=e}get customData(){return this.data.customData}set customData(e){this.data.customData=e}setTime(e){return this.time=e,this}setCustomData(e){return this.customData=e,this}deleteCustomData(){return this.customData={},this}removeCustomData(e){return this.customData&&delete this.customData[e],this}addCustomData(e){return this.customData=qn(Wn({},this.customData),{object:e}),this}}const zt=class extends Oe{constructor(t){super(t),this.hasChroma=()=>{var e,n,a,s,i,l,r,o,u,h,m,g,c,p,_,y,b,v,S,L,D,O;return this.isLightEvent()?Array.isArray((e=this.customData)==null?void 0:e._color)||typeof((n=this.customData)==null?void 0:n._lightID)=="number"||Array.isArray((a=this.customData)==null?void 0:a._lightID)||typeof((s=this.customData)==null?void 0:s._propID)=="number"||typeof((i=this.customData)==null?void 0:i._lightGradient)=="object"||typeof((l=this.customData)==null?void 0:l._easing)=="string"||typeof((r=this.customData)==null?void 0:r._lerpType)=="string":this.isRingEvent()?typeof((o=this.customData)==null?void 0:o._nameFilter)=="string"||typeof((u=this.customData)==null?void 0:u._reset)=="boolean"||typeof((h=this.customData)==null?void 0:h._rotation)=="number"||typeof((m=this.customData)==null?void 0:m._step)=="number"||typeof((g=this.customData)==null?void 0:g._prop)=="number"||typeof((c=this.customData)==null?void 0:c._speed)=="number"||typeof((p=this.customData)==null?void 0:p._direction)=="number"||typeof((_=this.customData)==null?void 0:_._counterSpin)=="boolean"||typeof((y=this.customData)==null?void 0:y._stepMult)=="number"||typeof((b=this.customData)==null?void 0:b._propMult)=="number"||typeof((v=this.customData)==null?void 0:v._speedMult)=="number":this.isLaserRotationEvent()?typeof((S=this.customData)==null?void 0:S._lockPosition)=="boolean"||typeof((L=this.customData)==null?void 0:L._speed)=="number"||typeof((D=this.customData)==null?void 0:D._preciseSpeed)=="number"||typeof((O=this.customData)==null?void 0:O._direction)=="number":!1}}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,s,i,l,r;return e.push(new zt({b:(a=n.b)!=null?a:zt.default.b,et:(s=n.et)!=null?s:zt.default.et,i:(i=n.i)!=null?i:zt.default.i,f:(l=n.f)!=null?l:zt.default.f,customData:(r=n.customData)!=null?r:zt.default.customData()}))}),e.length===1?e[0]:e.length?e:new zt({b:zt.default.b,et:zt.default.et,i:zt.default.i,f:zt.default.f,customData:zt.default.customData()})}toObject(){return{b:this.time,et:this.type,i:this.value,f:this.floatValue,customData:Dt(this.customData)}}get type(){return this.data.et}set type(t){this.data.et=t}get value(){return this.data.i}set value(t){this.data.i=t}get floatValue(){return this.data.f}set floatValue(t){this.data.f=t}setType(t){return this.type=t,this}setValue(t){return this.value=t,this}setFloatValue(t){return this.floatValue=t,this}isOff(){return this.value===0}isOn(){return this.value===1||this.value===5||this.value===9}isFlash(){return this.value===2||this.value===6||this.value===10}isFade(){return this.value===3||this.value===7||this.value===11}isTransition(){return this.value===4||this.value===8||this.value===12}isValidType(){return this.type>=0&&this.type<=17||this.type===100}isLightEvent(){return this.type===0||this.type===1||this.type===2||this.type===3||this.type===4||this.type===6||this.type===7||this.type===10||this.type===11}isColorBoost(){return this.type===5}isRingEvent(){return this.type===8}isLaserRotationEvent(){return this.type===12||this.type===13}isLaneRotationEvent(){return this.type===14||this.type===15}isExtraEvent(){return this.type===16||this.type===17||this.type===18||this.type===19}isSpecialEvent(){return this.type===40||this.type===41||this.type===42||this.type===43}isBPMChangeEvent(){return this.type===100}isLightingEvent(){return this.isLightEvent()||this.isRingEvent()||this.isLaserRotationEvent()||this.isExtraEvent()}hasOldChroma(){return this.value>=2e9}isValid(){return this.isValidType()&&this.value>=0&&!(!this.isLaserRotationEvent()&&this.value>12&&!this.hasOldChroma())}};let ui=zt;ui.default={b:0,et:0,i:0,f:1,customData:()=>({})};const Qe=class extends Wt{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,s;return e.push(new Qe({k:(a=n.k)!=null?a:Qe.default.k,e:(s=n.e)!=null?s:Qe.default.e()}))}),e.length===1?e[0]:e.length?e:new Qe({k:Qe.default.k,e:Qe.default.e()})}toObject(){return{k:this.keyword,e:this.events}}get keyword(){return this.data.k}set keyword(t){this.data.k=t}get events(){return this.data.e}set events(t){this.data.e=t}setKeyword(t){return this.keyword=t,this}setEvents(t){return this.events=t,this}addEvent(t){return this.events.push(t),this}removeEvent(t){const e=this.events.indexOf(t,0);return e>-1&&this.events.splice(e,1),this}};let sa=Qe;sa.default={k:"",e:()=>[]};const oa=class extends Wt{constructor(t){super(t),this.d=t.d.map(e=>sa.create({e:e.e,k:e.k}))}static create(t={}){var e;return new oa({d:(e=t.d)!=null?e:oa.default.d()})}toObject(){return{d:this.list.map(t=>t.toObject())}}get list(){return this.d}set list(t){this.d=t}setData(t){return this.list=t,this}addData(t){return this.list.push(sa.create(t)),this}removeData(t){return this.list=this.list.filter(e=>e.keyword!==t),this}};let Ma=oa;Ma.default={d:()=>[]};class Oa extends Oe{get posX(){return this.data.x}set posX(e){this.data.x=e}get posY(){return this.data.y}set posY(e){this.data.y=e}setPosX(e){return this.posX=e,this}setPosY(e){return this.posY=e,this}swapPosition(e){const n=e.posX;e.posX=this.posX,this.posX=n;const a=e.posY;return e.posY=this.posY,this.posY=a,this}}const ae=class extends Oa{constructor(t){super(t),this.hasChroma=()=>{var e,n;return Array.isArray((e=this.customData)==null?void 0:e.color)||typeof((n=this.customData)==null?void 0:n.spawnEffect)=="boolean"},this.hasNoodleExtensions=()=>{var e,n,a,s,i,l,r,o,u,h,m,g;return Array.isArray((e=this.customData)==null?void 0:e.animation)||typeof((n=this.customData)==null?void 0:n.disableNoteGravity)=="boolean"||typeof((a=this.customData)==null?void 0:a.disableNoteLook)=="boolean"||Array.isArray((s=this.customData)==null?void 0:s.flip)||typeof((i=this.customData)==null?void 0:i.uninteractable)=="boolean"||Array.isArray((l=this.customData)==null?void 0:l.localRotation)||typeof((r=this.customData)==null?void 0:r.noteJumpMovementSpeed)=="number"||typeof((o=this.customData)==null?void 0:o.noteJumpStartBeatOffset)=="number"||Array.isArray((u=this.customData)==null?void 0:u.coordinates)||Array.isArray((h=this.customData)==null?void 0:h.worldRotation)||typeof((m=this.customData)==null?void 0:m.worldRotation)=="number"||typeof((g=this.customData)==null?void 0:g.track)=="string"}}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,s,i,l;return e.push(new ae({b:(a=n.b)!=null?a:ae.default.b,x:(s=n.x)!=null?s:ae.default.x,y:(i=n.y)!=null?i:ae.default.y,customData:(l=n.customData)!=null?l:ae.default.customData()}))}),e.length===1?e[0]:e.length?e:new ae({b:ae.default.b,x:ae.default.x,y:ae.default.y,customData:ae.default.customData()})}toObject(){return{b:this.time,x:this.posX,y:this.posY,customData:Dt(this.customData)}}mirror(){return this.posX=ue-1-this.posX,this}getPosition(){return[(this.posX<=-1e3?this.posX/1e3:this.posX>=1e3?this.posX/1e3:this.posX)-2,this.posY<=-1e3?this.posY/1e3:this.posY>=1e3?this.posY/1e3:this.posY]}getDistance(t){const[e,n]=this.getPosition(),[a,s]=t.getPosition();return Math.sqrt(Math.pow(a-e,2)+Math.pow(s-n,2))}isVertical(t){const[e]=this.getPosition(),[n]=t.getPosition(),a=e-n;return a>-.001&&a<.001}isHorizontal(t){const[e,n]=this.getPosition(),[a,s]=t.getPosition(),i=n-s;return i>-.001&&i<.001}isDiagonal(t){const[e,n]=this.getPosition(),[a,s]=t.getPosition(),i=Math.abs(e-a),l=Math.abs(n-s);return i===l}isInline(t,e=.5){return this.getDistance(t)<=e}isAdjacent(t){const e=this.getDistance(t);return e>.499&&e<1.001}isWindow(t,e=1.8){return this.getDistance(t)>e}isSlantedWindow(t){return this.isWindow(t)&&!this.isDiagonal(t)&&!this.isHorizontal(t)&&!this.isVertical(t)}hasMappingExtensions(){return this.posX>3||this.posX<0||this.posY>2||this.posY<0}isValid(){return!this.hasMappingExtensions()}};let hi=ae;hi.default={b:0,x:0,y:0,customData:()=>({})};const ve=class extends Oe{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,s,i;return e.push(new ve({b:(a=n.b)!=null?a:ve.default.b,m:(s=n.m)!=null?s:ve.default.m,customData:(i=n.customData)!=null?i:ve.default.customData()}))}),e.length===1?e[0]:e.length?e:new ve({b:ve.default.b,m:ve.default.m,customData:ve.default.customData()})}toObject(){return{b:this.time,m:this.bpm,customData:Dt(this.customData)}}get bpm(){return this.data.m}set bpm(t){this.data.m=t}setBPM(t){return this.bpm=t,this}};let di=ve;di.default={b:0,m:0,customData:()=>({})};class To extends Oa{constructor(){super(...arguments),this.hasChroma=()=>!1,this.hasNoodleExtensions=()=>!1}get color(){return this.data.c}set color(e){this.data.c=e}get direction(){return this.data.d}set direction(e){this.data.d=e}get tailTime(){return this.data.tb}set tailTime(e){this.data.tb=e}get tailPosX(){return this.data.tx}set tailPosX(e){this.data.tx=e}get tailPosY(){return this.data.ty}set tailPosY(e){this.data.ty=e}setColor(e){return this.color=e,this}setPosX(e){return this.posX=e,this}setPosY(e){return this.posY=e,this}setDirection(e){return this.direction=e,this}setTailTime(e){return this.tailTime=e,this}setTailPosX(e){return this.tailPosX=e,this}setTailPosY(e){return this.tailPosY=e,this}getPosition(){return[(this.posX<=-1e3?this.posX/1e3:this.posX>=1e3?this.posX/1e3:this.posX)-2,this.posY<=-1e3?this.posY/1e3:this.posY>=1e3?this.posY/1e3:this.posY]}getDistance(e){const[n,a]=this.getPosition(),[s,i]=e.getPosition();return Math.sqrt(Math.pow(s-n,2)+Math.pow(i-a,2))}isVertical(e){const[n]=this.getPosition(),[a]=e.getPosition(),s=n-a;return s>-.001&&s<.001}isHorizontal(e){const[n,a]=this.getPosition(),[s,i]=e.getPosition(),l=a-i;return l>-.001&&l<.001}isDiagonal(e){const[n,a]=this.getPosition(),[s,i]=e.getPosition(),l=Math.abs(n-s),r=Math.abs(a-i);return l===r}isInline(e,n=.5){return this.getDistance(e)<=n}isAdjacent(e){const n=this.getDistance(e);return n>.499&&n<1.001}isWindow(e,n=1.8){return this.getDistance(e)>n}isSlantedWindow(e){return this.isWindow(e)&&!this.isDiagonal(e)&&!this.isHorizontal(e)&&!this.isVertical(e)}isInverse(){return this.time>this.tailTime}}const bt=class extends To{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,s,i,l,r,o,u,h,m,g,c,p,_;return e.push(new bt({b:(s=(a=n.b)!=null?a:n.tb)!=null?s:bt.default.b,c:(i=n.c)!=null?i:bt.default.c,x:(l=n.x)!=null?l:bt.default.x,y:(r=n.y)!=null?r:bt.default.y,d:(o=n.d)!=null?o:bt.default.d,tb:(h=(u=n.tb)!=null?u:n.b)!=null?h:bt.default.tb,tx:(m=n.tx)!=null?m:bt.default.tx,ty:(g=n.ty)!=null?g:bt.default.ty,sc:(c=n.sc)!=null?c:bt.default.sc,s:(p=n.s)!=null?p:bt.default.s,customData:(_=n.customData)!=null?_:bt.default.customData()}))}),e.length===1?e[0]:e.length?e:new bt({b:bt.default.b,c:bt.default.c,x:bt.default.x,y:bt.default.y,d:bt.default.d,tb:bt.default.tb,tx:bt.default.tx,ty:bt.default.ty,sc:bt.default.sc,s:bt.default.s,customData:bt.default.customData()})}toObject(){return{b:this.time,c:this.color,x:this.posX,y:this.posY,d:this.direction,tb:this.tailTime,tx:this.tailPosX,ty:this.tailPosY,sc:this.sliceCount,s:this.squish,customData:Dt(this.customData)}}get sliceCount(){return this.data.sc}set sliceCount(t){this.data.sc=t}get squish(){return this.data.s}set squish(t){this.data.s=t}setSliceCount(t){return this.sliceCount=t,this}setSquish(t){return this.squish=t,this}mirror(t=!0){switch(this.posX=ue-1-this.posX,this.tailPosX=ue-1-this.tailPosX,t&&(this.color=(1+this.color)%2),this.direction){case 2:this.direction=3;break;case 3:this.direction=2;break;case 6:this.direction=7;break;case 7:this.direction=6;break;case 4:this.direction=5;break;case 5:this.direction=4;break}return this}getAngle(){return this.direction>=1e3?Math.abs(this.direction%1e3%360-360):Jt[this.direction]||0}hasMappingExtensions(){return this.posY>2||this.posY<0||this.posX<=-1e3||this.posX>=1e3||this.direction>=1e3&&this.direction<=1360}isValid(){return!(this.hasMappingExtensions()||this.isInverse())}};let la=bt;la.default={b:0,c:0,x:0,y:0,d:0,tb:0,tx:0,ty:0,sc:1,s:1,customData:()=>({})};const Ee=class extends Oe{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,s,i;return e.push(new Ee({b:(a=n.b)!=null?a:Ee.default.b,o:(s=n.o)!=null?s:Ee.default.o,customData:(i=n.customData)!=null?i:Ee.default.customData()}))}),e.length===1?e[0]:e.length?e:new Ee({b:Ee.default.b,o:Ee.default.o,customData:Ee.default.customData()})}toObject(){return{b:this.time,o:this.toggle,customData:Dt(this.customData)}}get toggle(){return this.data.o}set toggle(t){this.data.o=t}};let fi=Ee;fi.default={b:0,o:!1,customData:()=>({})};const Tt=class extends Oa{constructor(t){super(t),this.hasChroma=()=>{var e,n;return Array.isArray((e=this.customData)==null?void 0:e.color)||typeof((n=this.customData)==null?void 0:n.spawnEffect)=="boolean"},this.hasNoodleExtensions=()=>{var e,n,a,s,i,l,r,o,u,h,m,g;return Array.isArray((e=this.customData)==null?void 0:e.animation)||typeof((n=this.customData)==null?void 0:n.disableNoteGravity)=="boolean"||typeof((a=this.customData)==null?void 0:a.disableNoteLook)=="boolean"||Array.isArray((s=this.customData)==null?void 0:s.flip)||typeof((i=this.customData)==null?void 0:i.uninteractable)=="boolean"||Array.isArray((l=this.customData)==null?void 0:l.localRotation)||typeof((r=this.customData)==null?void 0:r.noteJumpMovementSpeed)=="number"||typeof((o=this.customData)==null?void 0:o.noteJumpStartBeatOffset)=="number"||Array.isArray((u=this.customData)==null?void 0:u.coordinates)||Array.isArray((h=this.customData)==null?void 0:h.worldRotation)||typeof((m=this.customData)==null?void 0:m.worldRotation)=="number"||typeof((g=this.customData)==null?void 0:g.track)=="string"}}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,s,i,l,r,o,u;return e.push(new Tt({b:(a=n.b)!=null?a:Tt.default.b,x:(s=n.x)!=null?s:Tt.default.x,y:(i=n.y)!=null?i:Tt.default.y,c:(l=n.c)!=null?l:Tt.default.c,d:(r=n.d)!=null?r:Tt.default.d,a:(o=n.a)!=null?o:Tt.default.a,customData:(u=n.customData)!=null?u:Tt.default.customData()}))}),e.length===1?e[0]:e.length?e:new Tt({b:Tt.default.b,x:Tt.default.x,y:Tt.default.y,c:Tt.default.c,d:Tt.default.d,a:Tt.default.a,customData:Tt.default.customData()})}toObject(){return{b:this.time,c:this.color,x:this.posX,y:this.posY,d:this.direction,a:this.angleOffset,customData:Dt(this.customData)}}get color(){return this.data.c}set color(t){this.data.c=t}get direction(){return this.data.d}set direction(t){this.data.d=t}get angleOffset(){return this.data.a}set angleOffset(t){this.data.a=t}setColor(t){return this.color=t,this}setDirection(t){return this.direction=t,this}setAngleOffset(t){return this.angleOffset=t,this}mirror(){return this.posX=ue-1-this.posX,this}swapRotation(t,e=!0){const n=t.direction;t.direction=this.direction,this.direction=n;const a=t.angleOffset;return t.angleOffset=this.angleOffset,this.angleOffset=a,e&&(t.angleOffset=0-t.angleOffset,this.angleOffset=0-this.angleOffset),this}getPosition(){return[(this.posX<=-1e3?this.posX/1e3:this.posX>=1e3?this.posX/1e3:this.posX)-2,this.posY<=-1e3?this.posY/1e3:this.posY>=1e3?this.posY/1e3:this.posY]}getAngle(){return this.direction>=1e3?Math.abs(this.direction%1e3%360-360):(Jt[this.direction]||0)+this.angleOffset}getDistance(t){const[e,n]=this.getPosition(),[a,s]=t.getPosition();return Math.sqrt(Math.pow(a-e,2)+Math.pow(s-n,2))}isRed(){return this.color===0}isBlue(){return this.color===1}isVertical(t){if(t){const[e]=this.getPosition(),[n]=t.getPosition(),a=e-n;return a>-.001&&a<.001}return 22.5<=Math.abs(this.getAngle())%180+90&&Math.abs(this.getAngle())%180+90<=67.5}isHorizontal(t){if(t){const[e,n]=this.getPosition(),[a,s]=t.getPosition(),i=n-s;return i>-.001&&i<.001}return 22.5<=Math.abs(this.getAngle())%180+90&&Math.abs(this.getAngle())%180+90<=67.5}isDiagonal(t){if(t){const[e,n]=this.getPosition(),[a,s]=t.getPosition(),i=Math.abs(e-a),l=Math.abs(n-s);return i===l}return 22.5<=Math.abs(this.getAngle())%90&&Math.abs(this.getAngle())%90<=67.5}isInline(t,e=.5){return this.getDistance(t)<=e}isDouble(t,e=.01){return t.time>this.time-e&&t.time<this.time+e&&this.color!==t.color}isAdjacent(t){const e=this.getDistance(t);return e>.499&&e<1.001}isWindow(t,e=1.8){return this.getDistance(t)>e}isSlantedWindow(t){return this.isWindow(t)&&!this.isDiagonal(t)&&!this.isHorizontal(t)&&!this.isVertical(t)}hasMappingExtensions(){return this.posX>3||this.posX<0||this.posY>2||this.posY<0||this.direction>=1e3&&this.direction<=1360||this.direction>=2e3&&this.direction<=2360}isValidDirection(){return this.direction>=0&&this.direction<=8}isValid(){return!this.hasMappingExtensions()&&this.isValidDirection()}};let dn=Tt;dn.default={b:0,c:0,x:0,y:0,d:0,a:0,customData:()=>({})};class kc extends Oe{get groupID(){return this.data.g}set groupID(e){this.data.g=e}}class Ro extends kc{constructor(e,n){super(e),this.e=n}toObject(){return{b:this.time,g:this.groupID,e:this.events.map(e=>e.toObject()),customData:Dt(this.customData)}}get events(){return this.e}set events(e){this.e=e}}const on=class extends Wt{constructor(t){super(t),this.data.f===1&&(this.p0=this.p0?this.p0:1)}static create(t={}){var e,n,a,s;return new on({f:(e=t.f)!=null?e:on.default.f,p:(n=t.p)!=null?n:on.default.p,t:(a=t.t)!=null?a:on.default.t,r:(s=t.r)!=null?s:on.default.r})}toObject(){return{f:this.type,p:this.p0,t:this.p1,r:this.reverse}}get type(){return this.data.f}set type(t){this.data.f=t}get p0(){return this.data.p}set p0(t){this.data.p=t}get p1(){return this.data.t}set p1(t){this.data.t=t}get reverse(){return this.data.r}set reverse(t){this.data.r=t}};let pe=on;pe.default={f:1,p:0,t:0,r:0};class Io extends Wt{constructor(e){super(e),this.f=pe.create(e.f)}get filter(){return this.f}set filter(e){this.f=e}get beatDistribution(){return this.data.w}set beatDistribution(e){this.data.w=e}get beatDistributionType(){return this.data.d}set beatDistributionType(e){this.data.d=e}setFilter(e){return this.filter=e,this}setBeatDistribution(e){return this.beatDistribution=e,this}setBeatDistributionType(e){return this.beatDistributionType=e,this}}const jt=class extends Wt{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,s,i,l,r;return e.push(new jt({b:(a=n.b)!=null?a:jt.default.b,i:(s=n.i)!=null?s:jt.default.i,c:(i=n.c)!=null?i:jt.default.c,s:(l=n.s)!=null?l:jt.default.s,f:(r=n.f)!=null?r:jt.default.f}))}),e.length===1?e[0]:e.length?e:new jt({b:jt.default.b,i:jt.default.i,c:jt.default.c,s:jt.default.s,f:jt.default.f})}toObject(){return{b:this.time,i:this.transition,c:this.color,s:this.brightness,f:this.frequency}}get time(){return this.data.b}set time(t){this.data.b=t}get transition(){return this.data.i}set transition(t){this.data.i=t}get color(){return this.data.c}set color(t){this.data.c=t}get brightness(){return this.data.s}set brightness(t){this.data.s=t}get frequency(){return this.data.f}set frequency(t){this.data.f=t}};let Ao=jt;Ao.default={b:0,i:0,c:0,s:1,f:0};const Rt=class extends Io{constructor(t){super(t),this.e=t.e.map(n=>Ao.create(n));const e=Math.max(...this.e.map(n=>n.time));this.beatDistributionType===2&&(this.beatDistribution=this.beatDistribution<e?e:this.beatDistribution)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,s,i,l,r,o,u;return e.push(new Rt({f:(a=n.f)!=null?a:Rt.default.f(),w:(s=n.w)!=null?s:Rt.default.w,d:(i=n.d)!=null?i:Rt.default.d,r:(l=n.r)!=null?l:Rt.default.r,t:(r=n.t)!=null?r:Rt.default.t,b:(o=n.b)!=null?o:Rt.default.b,e:(u=n.e)!=null?u:Rt.default.e()}))}),e.length===1?e[0]:e.length?e:new Rt({f:Rt.default.f(),w:Rt.default.w,d:Rt.default.d,r:Rt.default.r,t:Rt.default.t,b:Rt.default.b,e:Rt.default.e()})}toObject(){return{f:this.filter.toObject(),w:this.beatDistribution,d:this.beatDistributionType,r:this.brightnessDistribution,t:this.brightnessDistributionType,b:this.affectFirst,e:this.events.map(t=>t.toObject())}}get brightnessDistribution(){return this.data.r}set brightnessDistribution(t){this.data.r=t}get brightnessDistributionType(){return this.data.t}set brightnessDistributionType(t){this.data.t=t}get affectFirst(){return this.data.b}set affectFirst(t){this.data.b=t?1:0}get events(){return this.e}set events(t){this.e=t}};let Bo=Rt;Bo.default={f:()=>({f:pe.default.f,p:pe.default.p,t:pe.default.t,r:pe.default.r}),w:0,d:1,r:0,t:1,b:0,e:()=>[]};const re=class extends Ro{constructor(t){super(t,t.e.map(e=>Bo.create(e)))}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,s,i,l;return e.push(new re({b:(a=n.b)!=null?a:re.default.b,g:(s=n.g)!=null?s:re.default.g,e:(i=n.e)!=null?i:re.default.e(),customData:(l=n.customData)!=null?l:re.default.customData()}))}),e.length===1?e[0]:e.length?e:new re({b:re.default.b,g:re.default.g,e:re.default.e(),customData:re.default.customData()})}};let ca=re;ca.default={b:0,g:0,e:()=>[],customData:()=>({})};const Mt=class extends Wt{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,s,i,l,r,o;return e.push(new Mt({b:(a=n.b)!=null?a:Mt.default.b,p:(s=n.p)!=null?s:Mt.default.p,e:(i=n.e)!=null?i:Mt.default.e,l:(l=n.l)!=null?l:Mt.default.l,r:(r=n.r)!=null?r:Mt.default.r,o:(o=n.o)!=null?o:Mt.default.o}))}),e.length===1?e[0]:e.length?e:new Mt({b:Mt.default.b,p:Mt.default.p,e:Mt.default.e,l:Mt.default.l,r:Mt.default.r,o:Mt.default.o})}toObject(){return{b:this.time,p:this.previous,e:this.ease,l:this.loop,r:this.rotation,o:this.direction}}get time(){return this.data.b}set time(t){this.data.b=t}get previous(){return this.data.p}set previous(t){this.data.p=t}get ease(){return this.data.e}set ease(t){this.data.e=t}get loop(){return this.data.l}set loop(t){this.data.l=t}get rotation(){return this.data.r}set rotation(t){this.data.r=t}get direction(){return this.data.o}set direction(t){this.data.o=t}};let $o=Mt;$o.default={b:0,p:0,e:0,l:0,r:0,o:0};const St=class extends Io{constructor(t){super(t),this.l=t.l.map(n=>$o.create(n));const e=Math.max(...this.l.map(n=>n.time));this.beatDistributionType===2&&(this.beatDistribution=this.beatDistribution<e?e:this.beatDistribution)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,s,i,l,r,o,u,h,m;return e.push(new St({f:(a=n.f)!=null?a:St.default.f(),w:(s=n.w)!=null?s:St.default.w,d:(i=n.d)!=null?i:St.default.d,s:(l=n.s)!=null?l:St.default.s,t:(r=n.t)!=null?r:St.default.t,a:(o=n.a)!=null?o:St.default.a,r:(u=n.r)!=null?u:St.default.r,b:(h=n.b)!=null?h:St.default.b,l:(m=n.l)!=null?m:St.default.l()}))}),e.length===1?e[0]:e.length?e:new St({f:St.default.f(),w:St.default.w,d:St.default.d,s:St.default.s,t:St.default.t,a:St.default.a,r:St.default.r,b:St.default.b,l:St.default.l()})}toObject(){return{f:this.filter.toObject(),w:this.beatDistribution,d:this.beatDistributionType,s:this.rotationDistribution,t:this.rotationDistributionType,a:this.axis,r:this.flip,b:this.affectFirst,l:this.events.map(t=>t.toObject())}}get rotationDistribution(){return this.data.s}set rotationDistribution(t){this.data.s=t}get rotationDistributionType(){return this.data.t}set rotationDistributionType(t){this.data.t=t}get axis(){return this.data.a}set axis(t){this.data.a=t}get flip(){return this.data.r}set flip(t){this.data.r=t?1:0}get affectFirst(){return this.data.b}set affectFirst(t){this.data.b=t?1:0}get events(){return this.l}set events(t){this.l=t}};let No=St;No.default={f:()=>({f:pe.default.f,p:pe.default.p,t:pe.default.t,r:pe.default.r}),w:0,d:1,s:0,t:1,a:0,r:0,b:0,l:()=>[]};const se=class extends Ro{constructor(t){super(t,t.e.map(e=>No.create(e)))}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,s,i,l;return e.push(new se({b:(a=n.b)!=null?a:se.default.b,g:(s=n.g)!=null?s:se.default.g,e:(i=n.e)!=null?i:se.default.e(),customData:(l=n.customData)!=null?l:se.default.customData()}))}),e.length===1?e[0]:e.length?e:new se({b:se.default.b,g:se.default.g,e:se.default.e(),customData:se.default.customData()})}};let ua=se;ua.default={b:0,g:0,e:()=>[],customData:()=>({})};const It=class extends Oe{constructor(t){super(t),this.hasChroma=()=>{var e;return Array.isArray((e=this.customData)==null?void 0:e.color)},this.hasNoodleExtensions=()=>{var e,n,a,s,i,l,r,o,u;return Array.isArray((e=this.customData)==null?void 0:e.animation)||typeof((n=this.customData)==null?void 0:n.uninteractable)=="boolean"||Array.isArray((a=this.customData)==null?void 0:a.localRotation)||typeof((s=this.customData)==null?void 0:s.noteJumpMovementSpeed)=="number"||typeof((i=this.customData)==null?void 0:i.noteJumpStartBeatOffset)=="number"||Array.isArray((l=this.customData)==null?void 0:l.coordinates)||Array.isArray((r=this.customData)==null?void 0:r.worldRotation)||Array.isArray((o=this.customData)==null?void 0:o.size)||typeof((u=this.customData)==null?void 0:u.track)=="string"}}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,s,i,l,r,o,u;return e.push(new It({b:(a=n.b)!=null?a:It.default.b,x:(s=n.x)!=null?s:It.default.x,y:(i=n.y)!=null?i:It.default.y,d:(l=n.d)!=null?l:It.default.d,w:(r=n.w)!=null?r:It.default.w,h:(o=n.h)!=null?o:It.default.h,customData:(u=n.customData)!=null?u:It.default.customData()}))}),e.length===1?e[0]:e.length?e:new It({b:It.default.b,x:It.default.x,y:It.default.y,d:It.default.d,w:It.default.w,h:It.default.h,customData:It.default.customData()})}toObject(){return{b:this.time,x:this.posX,y:this.posY,d:this.duration,w:this.width,h:this.height,customData:Dt(this.customData)}}get posX(){return this.data.x}set posX(t){this.data.x=t}get posY(){return this.data.y}set posY(t){this.data.y=t}get duration(){return this.data.d}set duration(t){this.data.d=t}get width(){return this.data.w}set width(t){this.data.w=t}get height(){return this.data.h}set height(t){this.data.h=t}setPosX(t){return this.posX=t,this}setPosY(t){return this.posY=t,this}setDuration(t){return this.duration=t,this}setWidth(t){return this.width=t,this}setHeight(t){return this.height=t,this}mirror(){return this.posX=ue-1-this.posX,this}isInteractive(){return this.posX<0&&this.width>1-this.posX||this.width>1||this.posX===1||this.posX===2}hasZero(){return this.duration===0||this.width===0||this.height===0}hasNegative(){return this.posY<0||this.duration<0||this.width<0||this.height<0}getPosition(){return[(this.posX<=-1e3?this.posX/1e3:this.posX>=1e3?this.posX/1e3:this.posX)-2,(this.posY<=-1e3?this.posY/1e3:this.posY>=1e3?this.posY/1e3:this.posY)-.5]}isLonger(t,e=0){return this.time+this.duration>t.time+t.duration+e}hasMappingExtensions(){return this.posY>2||this.posX<=-1e3||this.posX>=1e3}isValid(){return!this.hasMappingExtensions()&&!this.hasZero()&&!this.hasNegative()}};let ge=It;ge.default={b:0,x:0,y:0,d:1,w:1,h:1,customData:()=>({})};const oe=class extends Oe{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,s,i,l;return e.push(new oe({b:(a=n.b)!=null?a:oe.default.b,e:(s=n.e)!=null?s:oe.default.e,r:(i=n.r)!=null?i:oe.default.r,customData:(l=n.customData)!=null?l:oe.default.customData()}))}),e.length===1?e[0]:e.length?e:new oe({b:oe.default.b,e:oe.default.e,r:oe.default.r,customData:oe.default.customData()})}toObject(){return{b:this.time,e:this.executionTime,r:this.rotation,customData:Dt(this.customData)}}get executionTime(){return this.data.e}set executionTime(t){this.data.e=t}get rotation(){return this.data.r}set rotation(t){this.data.r=t}setExecutionTime(t){return this.executionTime=t,this}setRotation(t){return this.rotation=t,this}};let mi=oe;mi.default={b:0,e:0,r:0,customData:()=>({})};const ft=class extends To{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,s,i,l,r,o,u,h,m,g,c,p,_;return e.push(new ft({b:(a=n.b)!=null?a:ft.default.b,c:(s=n.c)!=null?s:ft.default.c,x:(i=n.x)!=null?i:ft.default.x,y:(l=n.y)!=null?l:ft.default.y,d:(r=n.d)!=null?r:ft.default.d,mu:(o=n.mu)!=null?o:ft.default.mu,tb:(u=n.tb)!=null?u:ft.default.tb,tx:(h=n.tx)!=null?h:ft.default.tx,ty:(m=n.ty)!=null?m:ft.default.ty,tc:(g=n.tc)!=null?g:ft.default.tc,tmu:(c=n.tmu)!=null?c:ft.default.tmu,m:(p=n.m)!=null?p:ft.default.m,customData:(_=n.customData)!=null?_:ft.default.customData()}))}),e.length===1?e[0]:e.length?e:new ft({b:ft.default.b,c:ft.default.c,x:ft.default.x,y:ft.default.y,d:ft.default.d,mu:ft.default.mu,tb:ft.default.tb,tx:ft.default.tx,ty:ft.default.ty,tc:ft.default.tc,tmu:ft.default.tmu,m:ft.default.m,customData:ft.default.customData()})}toObject(){return{b:this.time,c:this.color,x:this.posX,y:this.posY,d:this.direction,mu:this.lengthMultiplier,tb:this.tailTime,tx:this.tailPosX,ty:this.tailPosY,tc:this.tailDirection,tmu:this.tailLengthMultiplier,m:this.midAnchor,customData:Dt(this.customData)}}get lengthMultiplier(){return this.data.mu}set lengthMultiplier(t){this.data.mu=t}get tailLengthMultiplier(){return this.data.tmu}set tailLengthMultiplier(t){this.data.tmu=t}get tailDirection(){return this.data.tc}set tailDirection(t){this.data.tc=t}get midAnchor(){return this.data.m}set midAnchor(t){this.data.m=t}setLengthMultiplier(t){return this.lengthMultiplier=t,this}setTailLengthMultiplier(t){return this.tailLengthMultiplier=t,this}setTailDirection(t){return this.tailDirection=t,this}setMidAnchor(t){return this.midAnchor=t,this}mirror(t=!0){switch(this.posX=ue-1-this.posX,this.tailPosX=ue-1-this.tailPosX,t&&(this.color=(1+this.color)%2),this.direction){case 2:this.direction=3;break;case 3:this.direction=2;break;case 6:this.direction=7;break;case 7:this.direction=6;break;case 4:this.direction=5;break;case 5:this.direction=4;break}switch(this.tailDirection){case 2:this.tailDirection=3;break;case 3:this.tailDirection=2;break;case 6:this.tailDirection=7;break;case 7:this.tailDirection=6;break;case 4:this.tailDirection=5;break;case 5:this.tailDirection=4;break}return this.midAnchor&&(this.midAnchor=this.midAnchor===1?2:1),this}getAngle(){return this.direction>=1e3?Math.abs(this.direction%1e3%360-360):Jt[this.direction]||0}hasMappingExtensions(){return this.posY>2||this.posY<0||this.posX<=-1e3||this.posX>=1e3||this.direction>=1e3&&this.direction<=1360||this.tailDirection>=1e3&&this.tailDirection<=1360}isValid(){return!(this.hasMappingExtensions()||this.isInverse())}};let pi=ft;pi.default={b:0,c:0,x:0,y:0,d:0,mu:.5,tb:0,tx:0,ty:0,tc:0,tmu:.5,m:1,customData:()=>({})};const Ht=class extends Oe{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,s,i,l,r;return e.push(new Ht({b:(a=n.b)!=null?a:Ht.default.b,x:(s=n.x)!=null?s:Ht.default.x,y:(i=n.y)!=null?i:Ht.default.y,d:(l=n.d)!=null?l:Ht.default.d,customData:(r=n.customData)!=null?r:Ht.default.customData()}))}),e.length===1?e[0]:e.length?e:new Ht({b:Ht.default.b,x:Ht.default.x,y:Ht.default.y,d:Ht.default.d,customData:Ht.default.customData()})}toObject(){return{b:this.time,x:this.posX,y:this.posY,d:this.direction,customData:Dt(this.customData)}}get posX(){return this.data.x}set posX(t){this.data.x=t}get posY(){return this.data.y}set posY(t){this.data.y=t}get direction(){return this.data.d}set direction(t){this.data.d=t}setPosX(t){return this.posX=t,this}setPosY(t){return this.posY=t,this}setDirection(t){return this.direction=t,this}mirror(){switch(this.posX=ue-1-this.posX,this.direction){case 2:this.direction=3;break;case 3:this.direction=2;break;case 6:this.direction=7;break;case 7:this.direction=6;break;case 4:this.direction=5;break;case 5:this.direction=4;break}return this}};let gi=Ht;gi.default={b:0,x:0,y:0,d:1,customData:()=>({})};class Mi extends Wt{constructor(e){var n,a,s,i,l,r,o,u,h,m,g,c,p,_,y,b,v,S,L,D,O,M,X,$,Y,K,C,N;super(e),this.nps=d=>{const k=this.getNoteContainer().filter(J=>J.type!=="bomb");return d?k.length/d:0},this.peak=(d,k)=>{let J=0,j=0;const it=typeof k=="number"?k:k.value,U=this.getNoteContainer().filter(Q=>Q.type!=="bomb");for(let Q=0;Q<U.length;Q++){for(;U[Q].data.time-U[j].data.time>d;)j++;J=Math.max(J,(Q-j+1)/(d/it*60))}return J},this.getFirstInteractiveTime=()=>{const d=this.getNoteContainer().filter(j=>j.type!=="bomb");let k=Number.MAX_VALUE;d.length>0&&(k=d[0].data.time);const J=this.findFirstInteractiveObstacleTime();return Math.min(k,J)},this.getLastInteractiveTime=()=>{const d=this.getNoteContainer().filter(j=>j.type!=="bomb");let k=0;d.length>0&&(k=d[d.length-1].data.time);const J=this.findLastInteractiveObstacleTime();return Math.max(k,J)},this.findFirstInteractiveObstacleTime=()=>{for(let d=0,k=this.obstacles.length;d<k;d++)if(this.obstacles[d].isInteractive())return this.obstacles[d].time;return Number.MAX_VALUE},this.findLastInteractiveObstacleTime=()=>{let d=0;for(let k=this.obstacles.length-1;k>=0;k--)this.obstacles[k].isInteractive()&&(d=Math.max(d,this.obstacles[k].time+this.obstacles[k].duration));return d},this.getNoteContainer=()=>{const d=[];return this.colorNotes.forEach(k=>d.push({type:"note",data:k})),this.sliders.forEach(k=>d.push({type:"slider",data:k})),this.burstSliders.forEach(k=>d.push({type:"burstSlider",data:k})),this.bombNotes.forEach(k=>d.push({type:"bomb",data:k})),d.sort((k,J)=>k.data.time-J.data.time)},this.getEventContainer=()=>{const d=[];return this.basicBeatmapEvents.forEach(k=>d.push({type:"basicEvent",data:k})),this.colorBoostBeatmapEvents.forEach(k=>d.push({type:"boost",data:k})),d.sort((k,J)=>k.data.time-J.data.time)},this.addBPMEvents=(...d)=>{d.forEach(k=>{this.bpmEvents.push(di.create(k))})},this.addRotationEvents=(...d)=>{d.forEach(k=>{this.rotationEvents.push(mi.create(k))})},this.addColorNotes=(...d)=>{d.forEach(k=>{this.colorNotes.push(dn.create(k))})},this.addBombNotes=(...d)=>{d.forEach(k=>{this.bombNotes.push(hi.create(k))})},this.addObstacles=(...d)=>{d.forEach(k=>{this.obstacles.push(ge.create(k))})},this.addSliders=(...d)=>{d.forEach(k=>{this.sliders.push(pi.create(k))})},this.addBurstSliders=(...d)=>{d.forEach(k=>{this.burstSliders.push(la.create(k))})},this.addWaypoints=(...d)=>{d.forEach(k=>{this.waypoints.push(gi.create(k))})},this.addBasicBeatmapEvents=(...d)=>{d.forEach(k=>{this.basicBeatmapEvents.push(ui.create(k))})},this.addColorBoostBeatmapEvents=(...d)=>{d.forEach(k=>{this.colorBoostBeatmapEvents.push(fi.create(k))})},this.addLightColorEventBoxGroups=(...d)=>{d.forEach(k=>{this.lightColorEventBoxGroups.push(ca.create(k))})},this.addLightRotationEventBoxGroups=(...d)=>{d.forEach(k=>{this.lightRotationEventBoxGroups.push(ua.create(k))})},this.version=(n=e.version)!=null?n:"3.0.0",this.bpmEvents=(s=(a=e.bpmEvents)==null?void 0:a.map(d=>di.create(d)))!=null?s:[],this.rotationEvents=(l=(i=e.rotationEvents)==null?void 0:i.map(d=>mi.create(d)))!=null?l:[],this.colorNotes=(o=(r=e.colorNotes)==null?void 0:r.map(d=>dn.create(d)))!=null?o:[],this.bombNotes=(h=(u=e.bombNotes)==null?void 0:u.map(d=>hi.create(d)))!=null?h:[],this.obstacles=(g=(m=e.obstacles)==null?void 0:m.map(d=>ge.create(d)))!=null?g:[],this.sliders=(p=(c=e.sliders)==null?void 0:c.map(d=>pi.create(d)))!=null?p:[],this.burstSliders=(y=(_=e.burstSliders)==null?void 0:_.map(d=>la.create(d)))!=null?y:[],this.waypoints=(v=(b=e.waypoints)==null?void 0:b.map(d=>gi.create(d)))!=null?v:[],this.basicBeatmapEvents=(L=(S=e.basicBeatmapEvents)==null?void 0:S.map(d=>ui.create(d)))!=null?L:[],this.colorBoostBeatmapEvents=(O=(D=e.colorBoostBeatmapEvents)==null?void 0:D.map(d=>fi.create(d)))!=null?O:[],this.lightColorEventBoxGroups=(X=(M=e.lightColorEventBoxGroups)==null?void 0:M.map(d=>ca.create(d)))!=null?X:[],this.lightRotationEventBoxGroups=(Y=($=e.lightRotationEventBoxGroups)==null?void 0:$.map(d=>ua.create(d)))!=null?Y:[],this.basicEventTypesWithKeywords=(K=Ma.create(e.basicEventTypesWithKeywords))!=null?K:{d:[]},this.useNormalEventsAsCompatibleEvents=(C=e.useNormalEventsAsCompatibleEvents)!=null?C:!1,this.customData=(N=e.customData)!=null?N:{}}static create(e={}){var n,a,s,i,l,r,o,u,h,m,g,c,p,_,y;return new Mi({version:e.version||"3.0.0",bpmEvents:(n=e.bpmEvents)!=null?n:[],rotationEvents:(a=e.rotationEvents)!=null?a:[],colorNotes:(s=e.colorNotes)!=null?s:[],bombNotes:(i=e.bombNotes)!=null?i:[],obstacles:(l=e.obstacles)!=null?l:[],sliders:(r=e.sliders)!=null?r:[],burstSliders:(o=e.burstSliders)!=null?o:[],waypoints:(u=e.waypoints)!=null?u:[],basicBeatmapEvents:(h=e.basicBeatmapEvents)!=null?h:[],colorBoostBeatmapEvents:(m=e.colorBoostBeatmapEvents)!=null?m:[],lightColorEventBoxGroups:(g=e.lightColorEventBoxGroups)!=null?g:[],lightRotationEventBoxGroups:(c=e.lightRotationEventBoxGroups)!=null?c:[],basicEventTypesWithKeywords:(p=e.basicEventTypesWithKeywords)!=null?p:{d:[]},useNormalEventsAsCompatibleEvents:(_=e.useNormalEventsAsCompatibleEvents)!=null?_:!1,customData:(y=e.customData)!=null?y:{}})}toObject(){return{version:this.version||"3.0.0",bpmEvents:this.bpmEvents.map(e=>e.toObject()),rotationEvents:this.rotationEvents.map(e=>e.toObject()),colorNotes:this.colorNotes.map(e=>e.toObject()),bombNotes:this.bombNotes.map(e=>e.toObject()),obstacles:this.obstacles.map(e=>e.toObject()),sliders:this.sliders.map(e=>e.toObject()),burstSliders:this.burstSliders.map(e=>e.toObject()),waypoints:this.waypoints.map(e=>e.toObject()),basicBeatmapEvents:this.basicBeatmapEvents.map(e=>e.toObject()),colorBoostBeatmapEvents:this.colorBoostBeatmapEvents.map(e=>e.toObject()),lightColorEventBoxGroups:this.lightColorEventBoxGroups.map(e=>e.toObject()),lightRotationEventBoxGroups:this.lightRotationEventBoxGroups.map(e=>e.toObject()),basicEventTypesWithKeywords:this.basicEventTypesWithKeywords.toObject(),useNormalEventsAsCompatibleEvents:this.useNormalEventsAsCompatibleEvents,customData:Dt(this.customData)}}}const ji=t=>`[convert::${t}]`,Tc=(t,e)=>{var a,s,i,l,r;if(e)nt.warn(ji("V2toV3"),"Converting beatmap v2 to v3 may lose certain data!");else{if(nt.warn(ji("V2toV3"),"Converting beatmap v2 to v3 may lose certain data!"),prompt("Proceed with conversion? (Y/N):","n")[0].toLowerCase()!=="y")throw Error("Conversion to beatmap v3 denied.");nt.info(ji("V2toV3"),"Converting beatmap v2 to v3")}const n=Mi.create();if(t.notes.forEach((o,u)=>{var m,g;let h;if(o.customData&&(h={color:o.customData._color,coordinates:o.customData._position,disableNoteGravity:o.customData._disableNoteGravity,disableNoteLook:o.customData._disableNoteLook,flip:o.customData._flip,localRotation:o.customData._localRotation,noteJumpMovementSpeed:o.customData._noteJumpMovementSpeed,noteJumpStartBeatOffset:o.customData._noteJumpStartBeatOffset,spawnEffect:typeof o.customData._disableSpawnEffect=="boolean"?!o.customData._disableSpawnEffect:void 0,track:o.customData._track,uninteractable:typeof o.customData._interactable=="boolean"?!o.customData._interactable:void 0,worldRotation:o.customData._rotation},o.customData._animation&&(h.animation={color:o.customData._animation._color,definitePosition:o.customData._animation._definitePosition,dissolve:o.customData._animation._dissolve,dissolveArrow:o.customData._animation._dissolveArrow,interactable:o.customData._animation._interactable,localRotation:o.customData._animation._localRotation,offsetPosition:o.customData._animation._position,offsetRotation:o.customData._animation._rotation,scale:o.customData._animation._scale,time:o.customData._animation._time}),typeof o.customData._fake=="boolean"&&nt.warn(`notes${u} at time ${o.time} NE _fake will be removed.`),typeof o.customData._cutDirection=="number"&&nt.debug(`notes${u} at time ${o.time} NE _cutDirection will be converted.`)),o.isBomb()&&n.bombNotes.push(hi.create({b:o.time,x:o.lineIndex,y:o.lineLayer,customData:h})),o.isNote()){let c=0;typeof((m=o.customData)==null?void 0:m._cutDirection)=="number"&&(c=o.customData._cutDirection>0?o.customData._cutDirection%360:360+o.customData._cutDirection%360),o.cutDirection>=1e3&&(c=Math.abs(o.cutDirection%1e3%360-360)),n.colorNotes.push(dn.create({b:o.time,c:o.type,x:o.lineIndex,y:o.lineLayer,d:o.cutDirection>=1e3||typeof((g=o.customData)==null?void 0:g._cutDirection)=="number"?o.cutDirection===8?8:1:uc(o.cutDirection,0,8),a:c,customData:h}))}}),t.obstacles.forEach((o,u)=>{let h;o.customData&&(h={color:o.customData._color,coordinates:o.customData._position,localRotation:o.customData._localRotation,noteJumpMovementSpeed:o.customData._noteJumpMovementSpeed,noteJumpStartBeatOffset:o.customData._noteJumpStartBeatOffset,size:o.customData._scale,track:o.customData._track,uninteractable:typeof o.customData._interactable=="boolean"?!o.customData._interactable:void 0,worldRotation:o.customData._rotation},o.customData._animation&&(h.animation={color:o.customData._animation._color,definitePosition:o.customData._animation._definitePosition,dissolve:o.customData._animation._dissolve,dissolveArrow:o.customData._animation._dissolveArrow,interactable:o.customData._animation._interactable,localRotation:o.customData._animation._localRotation,offsetPosition:o.customData._animation._position,offsetRotation:o.customData._animation._rotation,scale:o.customData._animation._scale,time:o.customData._animation._time}),typeof o.customData._fake=="boolean"&&nt.warn(`obstacles${u} at time ${o.time} NE _fake will be removed.`)),n.obstacles.push(ge.create({b:o.time,x:o.lineIndex,y:o.type===2?o.lineLayer:o.type?2:0,d:o.duration,w:o.width,h:o.type===2?o.height:o.type?3:5,customData:h}))}),t.events.forEach((o,u)=>{var h,m,g;if(o.isColorBoost())n.colorBoostBeatmapEvents.push(fi.create({b:o.time,o:!!o.value}));else if(o.isLaneRotationEvent())n.rotationEvents.push(mi.create({b:o.time,e:o.type===14?0:1,r:typeof((h=o.customData)==null?void 0:h._rotation)=="number"?o.customData._rotation:o.value>=1e3?(o.value-1360)%360:(m=Dc[o.value])!=null?m:0}));else if(o.isBPMChangeEvent())n.bpmEvents.push(di.create({b:o.time,m:o.floatValue}));else{let c;if(o.customData&&(o.isLightEvent()&&(c={color:o.customData._color,lightID:o.customData._lightID,easing:o.customData._easing,lerpType:o.customData._lerpType},o.customData._propID&&nt.warn(`events${u} at time ${o.time} Chroma _propID will be removed.`),o.customData._lightGradient&&nt.warn(`events${u} at time ${o.time} Chroma _lightGradient will be removed.`)),o.isRingEvent()&&(c={nameFilter:o.customData._nameFilter,rotation:o.customData._rotation,step:o.customData._step,prop:o.customData._prop,speed:o.customData._speed,direction:o.customData._direction},o.customData._reset&&nt.warn(`events${u} at time ${o.time} Chroma _reset will be removed.`),o.customData._counterSpin&&nt.warn(`events${u} at time ${o.time} Chroma _counterSpin will be removed.`),(o.customData._stepMult||o.customData._propMult||o.customData._speedMult)&&nt.warn(`events${u} at time ${o.time} Chroma _mult will be removed.`)),o.isLaserRotationEvent())){const p=(g=o.customData._preciseSpeed)!=null?g:o.customData._speed;c={lockPosition:o.customData._lockPosition,direction:o.customData._direction,speed:p}}n.basicBeatmapEvents.push(ui.create({b:o.time,et:o.type,i:o.value,f:o.floatValue,customData:c}))}}),t.waypoints.forEach(o=>{n.waypoints.push(gi.create({b:o.time,x:o.lineIndex,y:o.lineLayer,d:o.direction}))}),t.sliders.forEach(o=>n.sliders.push(pi.create({c:o.colorType,b:o.headTime,x:o.headLineIndex,y:o.headLineLayer,d:o.headCutDirection,mu:o.headLengthMultiplier,tb:o.tailTime,tx:o.tailLineIndex,ty:o.tailLineLayer,tc:o.tailCutDirection,tmu:o.tailLengthMultiplier,m:o.midAnchor}))),n.basicEventTypesWithKeywords=Ma.create({d:(i=(s=(a=t.specialEventsKeywordFilters)==null?void 0:a.keywords)==null?void 0:s.map(o=>({k:o.keyword,e:o.events})))!=null?i:[]}),t.customData)for(const o in t.customData){if(o==="_customEvents"){n.customData.customEvents=(l=t.customData._customEvents.map(u=>({b:u._time,t:u._type,d:u._data})))!=null?l:[];continue}if(o==="_environment"){n.customData.environment=(r=t.customData._environment.map(u=>{var h,m;return{id:u._id,lookupMethod:u._lookupMethod,track:u._track,duplicate:u._duplicate,active:u._active,scale:u._scale,position:(h=u._position)==null?void 0:h.map(g=>g*.6),rotation:u._rotation,localPosition:(m=u._localPosition)==null?void 0:m.map(g=>g*.6),localRotation:u._localRotation,lightID:u._lightID}}))!=null?r:[];continue}n.customData[o]=t.customData[o]}return n};var Mo=(t=>(t[t.Easy=1]="Easy",t[t.Normal=3]="Normal",t[t.Hard=5]="Hard",t[t.Expert=7]="Expert",t[t.ExpertPlus=9]="ExpertPlus",t))(Mo||{}),Oo=(t=>(t.id="Ct",t.lookupMethod="Lm",t.duplicate="D",t.active="A",t.scale="S",t.position="P",t.localPosition="Lp",t.rotation="R",t.localRotation="Lr",t.lightID="Li",t.track="T",t))(Oo||{});const Hi=t=>`[shared::parse::${t}]`,Rc=t=>(nt.info(Hi("info"),"Parsing beatmap info v2.x.x"),t._difficultyBeatmapSets.sort((e,n)=>Ki[e._beatmapCharacteristicName]-Ki[n._beatmapCharacteristicName]),t._difficultyBeatmapSets.forEach(e=>{let n=0;e._difficultyBeatmaps.forEach(a=>{a._difficultyRank-n<=0&&nt.warn(Hi("info"),a._difficulty+" is unordered"),Mo[a._difficulty]!==a._difficultyRank&&nt.error(Hi("info"),a._difficulty+" has invalid rank"),n=a._difficultyRank}),e._difficultyBeatmaps.sort((a,s)=>a._difficultyRank-s._difficultyRank)}),t),zr=t=>`[shared::dataCheck::${t}]`,$n=(t,e,n,a)=>{if(nt.verbose(zr("deepCheck"),`Looking up ${n}`),Array.isArray(t)){t.forEach((i,l)=>$n(i,e,`${n}[${l}]`,a));return}const s=Object.keys(e);for(const i in t){if(!s.length)break;s.includes(i)||nt.warn(zr("deepCheck"),`Unused key ${i} found in ${n}`)}for(const i in e){if(typeof t[i]=="undefined"){if(e[i].optional||xc(a,e[i].version)==="old")continue;throw Error(`Missing ${i} in object ${n}!`)}if(t[i]==null)throw Error(`${i} contain null value in object ${n}!`);if(e[i].type==="array"){if(!Array.isArray(t[i]))throw Error(`${i} is not an array in object ${n}!`);$n(t[i],e[i].check,`${n} ${i}`,a)}if(e[i].type==="object"){if(!Array.isArray(t[i])&&typeof t[i]!="object")throw Error(`${i} is not an object in object ${n}!`);$n(t[i],e[i].check,`${n} ${i}`,a)}if(e[i].type!=="array"&&typeof t[i]!==e[i].type)throw Error(`${i} is not ${e[i].type} in object ${n}!`)}},Ic={_time:{type:"number",version:"2.0.0"},_type:{type:"number",version:"2.0.0"},_lineIndex:{type:"number",version:"2.0.0"},_lineLayer:{type:"number",version:"2.0.0"},_cutDirection:{type:"number",version:"2.0.0"},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},Ac={_colorType:{type:"number",version:"2.0.0"},_headTime:{type:"number",version:"2.0.0"},_headLineIndex:{type:"number",version:"2.0.0"},_headLineLayer:{type:"number",version:"2.0.0"},_headCutDirection:{type:"number",version:"2.0.0"},_headControlPointlengthMultiplier:{type:"number",version:"2.0.0"},_tailTime:{type:"number",version:"2.0.0"},_tailLineIndex:{type:"number",version:"2.0.0"},_tailLineLayer:{type:"number",version:"2.0.0"},_tailCutDirection:{type:"number",version:"2.0.0"},_tailControlPointLengthMultiplier:{type:"number",version:"2.0.0"},_sliderMidAnchorMode:{type:"number",version:"2.0.0"}},Bc={_time:{type:"number",version:"2.0.0"},_lineIndex:{type:"number",version:"2.0.0"},_lineLayer:{type:"number",version:"2.6.0"},_type:{type:"number",version:"2.0.0"},_duration:{type:"number",version:"2.0.0"},_width:{type:"number",version:"2.0.0"},_height:{type:"number",version:"2.6.0"},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},$c={_time:{type:"number",version:"2.0.0"},_type:{type:"number",version:"2.0.0"},_value:{type:"number",version:"2.0.0"},_floatValue:{type:"number",version:"2.5.0"},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},Nc={_time:{type:"number",version:"2.2.0"},_lineIndex:{type:"number",version:"2.2.0"},_lineLayer:{type:"number",version:"2.2.0"},_offsetDirection:{type:"number",version:"2.2.0"},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},Mc={_keyword:{type:"string",version:"2.4.0"},_specialEvents:{type:"number",version:"2.4.0"}},Oc={_keywords:{type:"array",version:"2.4.0",check:Mc}},Pc={_version:{type:"string",version:"2.0.0"},_notes:{type:"array",version:"2.0.0",check:Ic},_sliders:{type:"array",version:"2.6.0",check:Ac},_obstacles:{type:"array",version:"2.0.0",check:Bc},_events:{type:"array",version:"2.0.0",check:$c},_waypoints:{type:"array",version:"2.2.0",check:Nc},_specialEventsKeywordFilters:{type:"object",version:"2.4.0",check:Oc,optional:!0},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},jr=t=>`[v2::parse::${t}]`,Fc=t=>{var e,n,a,s,i,l;return nt.info(jr("difficulty"),"Parsing beatmap difficulty v2.x.x"),(e=t._version)!=null&&e.startsWith("2")||(nt.warn(jr("difficulty"),"Unidentified beatmap version"),t._version="2.0.0"),$n(t,Pc,"difficulty",t._version),t._notes=(n=t._notes)!=null?n:[],t._sliders=(a=t._sliders)!=null?a:[],t._obstacles=(s=t._obstacles)!=null?s:[],t._events=(i=t._events)!=null?i:[],t._waypoints=(l=t._waypoints)!=null?l:[],t._notes.sort((r,o)=>r._time-o._time),t._sliders.sort((r,o)=>r._headTime-o._headTime),t._obstacles.sort((r,o)=>r._time-o._time),t._events.sort((r,o)=>r._time-o._time),t._waypoints.sort((r,o)=>r._time-o._time),Na.create(t)},zc={b:{type:"number",version:"3.0.0"},c:{type:"number",version:"3.0.0"},x:{type:"number",version:"3.0.0"},y:{type:"number",version:"3.0.0"},d:{type:"number",version:"3.0.0"},a:{type:"number",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},jc={b:{type:"number",version:"3.0.0"},x:{type:"number",version:"3.0.0"},y:{type:"number",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Hc={b:{type:"number",version:"3.0.0"},c:{type:"number",version:"3.0.0"},x:{type:"number",version:"3.0.0"},y:{type:"number",version:"3.0.0"},d:{type:"number",version:"3.0.0"},mu:{type:"number",version:"3.0.0"},tb:{type:"number",version:"3.0.0"},tx:{type:"number",version:"3.0.0"},ty:{type:"number",version:"3.0.0"},tc:{type:"number",version:"3.0.0"},tmu:{type:"number",version:"3.0.0"},m:{type:"number",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Xc={b:{type:"number",version:"3.0.0"},c:{type:"number",version:"3.0.0"},x:{type:"number",version:"3.0.0"},y:{type:"number",version:"3.0.0"},d:{type:"number",version:"3.0.0"},tb:{type:"number",version:"3.0.0"},tx:{type:"number",version:"3.0.0"},ty:{type:"number",version:"3.0.0"},sc:{type:"number",version:"3.0.0"},s:{type:"number",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Uc={b:{type:"number",version:"3.0.0"},x:{type:"number",version:"3.0.0"},y:{type:"number",version:"3.0.0"},d:{type:"number",version:"3.0.0"},w:{type:"number",version:"3.0.0"},h:{type:"number",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Yc={b:{type:"number",version:"3.0.0"},et:{type:"number",version:"3.0.0"},i:{type:"number",version:"3.0.0"},f:{type:"number",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Gc={b:{type:"number",version:"3.0.0"},m:{type:"number",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Vc={b:{type:"number",version:"3.0.0"},e:{type:"number",version:"3.0.0"},r:{type:"number",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Wc={b:{type:"number",version:"3.0.0"},o:{type:"boolean",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Po={f:{type:"number",version:"3.0.0"},p:{type:"number",version:"3.0.0"},t:{type:"number",version:"3.0.0"},r:{type:"number",version:"3.0.0"}},qc={b:{type:"number",version:"3.0.0"},i:{type:"number",version:"3.0.0"},c:{type:"number",version:"3.0.0"},s:{type:"number",version:"3.0.0"},f:{type:"number",version:"3.0.0"}},Zc={f:{type:"object",version:"3.0.0",check:Po},w:{type:"number",version:"3.0.0"},d:{type:"number",version:"3.0.0"},r:{type:"number",version:"3.0.0"},t:{type:"number",version:"3.0.0"},e:{type:"array",version:"3.0.0",check:qc},b:{type:"number",version:"3.0.0"}},Jc={b:{type:"number",version:"3.0.0"},g:{type:"number",version:"3.0.0"},e:{type:"array",version:"3.0.0",check:Zc},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Kc={b:{type:"number",version:"3.0.0"},p:{type:"number",version:"3.0.0"},e:{type:"number",version:"3.0.0"},l:{type:"number",version:"3.0.0"},r:{type:"number",version:"3.0.0"},o:{type:"number",version:"3.0.0"}},Qc={f:{type:"object",version:"3.0.0",check:Po},w:{type:"number",version:"3.0.0"},d:{type:"number",version:"3.0.0"},s:{type:"number",version:"3.0.0"},t:{type:"number",version:"3.0.0"},a:{type:"number",version:"3.0.0"},l:{type:"array",version:"3.0.0",check:Kc},r:{type:"number",version:"3.0.0"},b:{type:"number",version:"3.0.0"}},tu={b:{type:"number",version:"3.0.0"},g:{type:"number",version:"3.0.0"},e:{type:"array",version:"3.0.0",check:Qc},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},eu={k:{type:"string",version:"3.0.0"},e:{type:"number",version:"3.0.0"}},nu={d:{type:"array",version:"3.0.0",check:eu,optional:!0}},iu={b:{type:"number",version:"3.0.0"},d:{type:"number",version:"3.0.0"},x:{type:"number",version:"3.0.0"},y:{type:"number",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},au={version:{type:"string",version:"3.0.0"},bpmEvents:{type:"array",version:"3.0.0",check:Gc,optional:!0},rotationEvents:{type:"array",version:"3.0.0",check:Vc,optional:!0},colorNotes:{type:"array",version:"3.0.0",check:zc,optional:!0},bombNotes:{type:"array",version:"3.0.0",check:jc,optional:!0},obstacles:{type:"array",version:"3.0.0",check:Uc,optional:!0},sliders:{type:"array",version:"3.0.0",check:Hc,optional:!0},burstSliders:{type:"array",version:"3.0.0",check:Xc,optional:!0},waypoints:{type:"array",version:"3.0.0",check:iu,optional:!0},basicBeatmapEvents:{type:"array",version:"3.0.0",check:Yc,optional:!0},colorBoostBeatmapEvents:{type:"array",version:"3.0.0",check:Wc,optional:!0},lightColorEventBoxGroups:{type:"array",version:"3.0.0",check:Jc,optional:!0},lightRotationEventBoxGroups:{type:"array",version:"3.0.0",check:tu,optional:!0},basicEventTypesWithKeywords:{type:"object",version:"3.0.0",check:nu},useNormalEventsAsCompatibleEvents:{type:"boolean",version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Hr=t=>`[v3::parse::${t}]`,Zt=(t,e)=>t.b-e.b,ru=t=>{var e,n,a,s,i,l,r,o,u,h,m,g;return nt.info(Hr("difficulty"),"Parsing beatmap difficulty v3.x.x"),t.version!=="3.0.0"&&(nt.warn(Hr("difficulty"),"Unidentified beatmap version"),t.version="3.0.0"),$n(t,au,"difficulty",t.version),t.bpmEvents=(e=t.bpmEvents)!=null?e:[],t.rotationEvents=(n=t.rotationEvents)!=null?n:[],t.colorNotes=(a=t.colorNotes)!=null?a:[],t.bombNotes=(s=t.bombNotes)!=null?s:[],t.obstacles=(i=t.obstacles)!=null?i:[],t.sliders=(l=t.sliders)!=null?l:[],t.burstSliders=(r=t.burstSliders)!=null?r:[],t.waypoints=(o=t.waypoints)!=null?o:[],t.basicBeatmapEvents=(u=t.basicBeatmapEvents)!=null?u:[],t.colorBoostBeatmapEvents=(h=t.colorBoostBeatmapEvents)!=null?h:[],t.lightColorEventBoxGroups=(m=t.lightColorEventBoxGroups)!=null?m:[],t.lightRotationEventBoxGroups=(g=t.lightRotationEventBoxGroups)!=null?g:[],t.bpmEvents.sort(Zt),t.rotationEvents.sort(Zt),t.colorNotes.sort(Zt),t.bombNotes.sort(Zt),t.obstacles.sort(Zt),t.sliders.sort(Zt),t.burstSliders.sort(Zt),t.waypoints.sort(Zt),t.basicBeatmapEvents.sort(Zt),t.colorBoostBeatmapEvents.sort(Zt),t.lightColorEventBoxGroups.sort(Zt),t.lightRotationEventBoxGroups.sort(Zt),Mi.create(t)},Oi="UI Info: ",ha=document.querySelector(".info__level-author"),da=document.querySelector(".info__environment"),ai=document.querySelector(".info__editors"),ri=document.querySelector(".info__contributors"),_i=document.querySelector(".info__contributors-select"),su=document.querySelector(".info__contributors-image"),Fo=document.querySelector(".info__contributors-name"),zo=document.querySelector(".info__contributors-role"),fa=document.querySelector(".info__version"),ma=document.querySelector(".info__time-spend"),pa=document.querySelector(".info__custom-color"),ga=document.querySelector(".info__requirements"),_a=document.querySelector(".info__suggestions"),ba=document.querySelector(".info__information"),ya=document.querySelector(".info__warnings"),va=document.querySelector(".info__bookmarks"),Ea=document.querySelector(".info__bpm-changes"),wa=document.querySelector(".info__environment-enhancement"),Sa=document.querySelector(".info__point-definitions"),Ca=document.querySelector(".info__custom-events");if(!ha||!da||!ai)throw new Error(Oi+"info component is missing part");if(!ri||!Fo||!zo)throw new Error(Oi+"contributors component is missing part");if(_i)_i.addEventListener("change",du);else throw new Error(Oi+"contributors select is missing");if(!fa||!ma||!pa||!ga||!_a||!ba||!ya||!va||!Ea||!wa||!Sa||!Ca)throw new Error(Oi+"table info component is missing part");const Pa=t=>{if(!t){ha.textContent="";return}ha.textContent="Mapped by "+t},Fa=t=>{if(!t){da.textContent="";return}da.textContent=(Lc[t]||"Unknown")+" Environment"},za=t=>{if(!t||!t._lastEditedBy){ai.classList.add("hidden");return}ai.classList.remove("hidden");const e=t._lastEditedBy||"Undefined";let n="Last edited on "+e;if(t[e]){const a=t[e];n+=" v"+a.version}ai.textContent=n},ou=t=>{su.src=t||"./img/unknown.jpg"},lu=t=>{Fo.textContent=t},cu=t=>{zo.textContent=t},ja=t=>{ou(t._base64?"data:image;base64,"+t._base64:null),lu(t._name),cu(t._role)},jo=t=>{if(ri&&(!t||!t.length)){ri.classList.add("hidden"),Wi(_i);return}if(t){ri.classList.remove("hidden");let e=!0;t.forEach((n,a)=>{e&&(e=!1,ja(n));const s=document.createElement("option");s.value=a.toString(),s.text=n._name+" -- "+n._role,_i.add(s)})}},te=t=>{const e=t.querySelector(".info__table-element");e&&(e.innerHTML=""),t.classList.add("hidden")},ee=(t,e)=>{const n=t.querySelector(".info__table-element");if(n){for(;n.firstChild;)n.removeChild(n.firstChild);typeof e=="string"?n.textContent=e:(e.forEach(a=>{if(typeof a=="string"){let s=document.createElement("span");s.textContent=a,n.appendChild(s),n.appendChild(document.createElement("br"))}else n.appendChild(a),n.appendChild(document.createElement("br"))}),n.lastChild&&n.removeChild(n.lastChild))}t.classList.remove("hidden")},bi=t=>{if(t==null){te(fa);return}ee(fa,t)},Ha=t=>{if(t==null){te(ma);return}ee(ma,fc(t))},Xa=(t,e)=>{var o,u,h,m,g,c,p,_,y;if(!t||!t._colorLeft&&!t._colorRight&&!t._envColorLeft&&!t._envColorLeftBoost&&!t._envColorRight&&!t._envColorRightBoost&&!t._obstacleColor){te(pa);return}e||(e="DefaultEnvironment");let n={_colorLeft:xt((o=Ut[Xt[e]])==null?void 0:o._colorLeft)||null,_colorRight:xt((u=Ut[Xt[e]])==null?void 0:u._colorRight)||null,_envColorLeft:xt((h=Ut[Xt[e]])==null?void 0:h._envColorLeft)||null,_envColorRight:xt((m=Ut[Xt[e]])==null?void 0:m._envColorRight)||null,_envColorLeftBoost:xt((g=Ut[Xt[e]])==null?void 0:g._envColorLeftBoost)||null,_envColorRightBoost:xt((c=Ut[Xt[e]])==null?void 0:c._envColorRightBoost)||null,_obstacleColor:xt((p=Ut[Xt[e]])==null?void 0:p._obstacleColor)||null};t._colorLeft&&(n._colorLeft=xt(t._colorLeft)),t._colorRight&&(n._colorRight=xt(t._colorRight)),t._envColorLeft?n._envColorLeft=xt(t._envColorLeft):t._colorLeft&&(n._envColorLeft=xt(t._colorLeft)),t._envColorRight?n._envColorRight=xt(t._envColorRight):t._colorRight&&(n._envColorRight=xt(t._colorRight));let a,s,i=!1;t._envColorLeftBoost?(a=xt(t._envColorLeftBoost),i=!0):a=xt((_=Ut[Xt[e]])==null?void 0:_._envColorLeftBoost)||n._envColorLeft,t._envColorRightBoost?(s=xt(t._envColorRightBoost),i=!0):s=xt((y=Ut[Xt[e]])==null?void 0:y._envColorRightBoost)||n._envColorRight,i&&(n._envColorLeftBoost=a,n._envColorRightBoost=s),t._obstacleColor&&(n._obstacleColor=xt(t._obstacleColor));const l=ii.create("max","none",!0);for(const b in n){if(!n[b])continue;const v=document.createElement("div"),S=document.createElement("div"),L=document.createElement("div"),D=document.createElement("div");S.className="info__color-dot",S.style.backgroundColor=n[b]||"#000000",L.className="info__color-text info__color-text--monospace",L.textContent=`${n[b]}`,D.className="info__color-text",D.textContent=` -- ${Sc[b]}`,v.appendChild(S),v.appendChild(L),v.appendChild(D),l.appendChild(v)}ee(pa,[l])},Ua=t=>{if(t==null||!t.length){te(ga);return}ee(ga,t.join(", "))},Ya=t=>{if(t==null||!t.length){te(_a);return}ee(_a,t.join(", "))},Ga=t=>{if(t==null||!t.length){te(ba);return}ee(ba,t)},Va=t=>{if(t==null||!t.length){te(ya);return}ee(ya,t)},Wa=(t,e)=>{if(t==null||!t.length){te(va);return}const n=t.map(a=>{let s=a._time,i;return e&&(s=e.adjustTime(s),i=e.toRealTime(s)),`${P(a._time,3)}${i?" | "+kt(i):""} -- ${a._name!=""?a._name:"**EMPTY NAME**"}`});ee(va,n)},qa=t=>{if(!t||!t.change.length){te(Ea);return}const e=t.change.map(n=>{let a=P(n._newTime,3),s=t.toRealTime(n._time);return`${a} | ${kt(s)} -- ${n._BPM}`});ee(Ea,e)},Za=t=>{if(t==null||!t.length){te(wa);return}const e=t.map(n=>{let a=[];for(const s in n){if(s=="_lookupMethod"||s=="_id")continue;let i=Oo[s];n[s]!=null&&a.push(i)}return`${n.lookupMethod} [${a.join("")}]${n.track?`(${n.track})`:""} -> ${n.id}`});ee(wa,e)},Ja=t=>{if(t==null||!t.length){te(Sa);return}const e=t.map(n=>`${n.name} -- ${n.points.length} point${n.points.length>1?"s":""}`);ee(Sa,e)},Ka=(t,e)=>{if(t==null||!t.length){te(Ca);return}const n=t.map(a=>{let s=a.b,i;e&&(s=e.adjustTime(s),i=e.toRealTime(s));let l=[];for(const r in a.d)r=="_duration"||r=="_easing"||r=="_track"||a.d[r]!=null&&l.push(r);return`${P(a.b,3)}${i?" | "+kt(i):""} -- ${a.t} -> [${l.join("")}]${a.t!=="AssignTrackParent"?`(${a.d.track})`:""}`});ee(Ca,n)},uu=t=>{var e;Ot.setSongName(t._songName),Ot.setSongSubname(t._songSubName),Ot.setSongAuthor(t._songAuthorName),Ot.setSongBPM(t._beatsPerMinute),Pa(t._levelAuthorName),Fa(t._environmentName),za((e=t._customData)==null?void 0:e._editors)},hu=t=>{var e,n,a,s,i,l,r;if(t.rawVersion===2&&bi(t.rawData._version),t.rawVersion===3&&bi(t.rawData.version),(e=t.info)!=null&&e._customData&&(Xa(t.info._customData),Ua(t.info._customData._requirements),Ya(t.info._customData._suggestions),Ga(t.info._customData._information),Va(t.info._customData._warnings)),(n=t.data)!=null&&n.customData){const o=(a=at.beatmapInfo)!=null&&a._beatsPerMinute?_e.create(at.beatmapInfo._beatsPerMinute,t.data.customData._bpmChanges||t.data.customData._BPMChanges||t.data.customData.BPMChanges):null;Ha((s=t.data.customData._time)!=null?s:t.data.customData.time),Wa((i=t.data.customData._bookmarks)!=null?i:t.data.customData.bookmarks,o),qa(o),Za(t.data.customData.environment),Ja((l=t.data.customData._pointDefinitions)!=null?l:t.data.customData.pointDefinitions),Ka((r=t.data.customData._customEvents)!=null?r:t.data.customData.customEvents,o)}};function du(t){const e=t.target;ja(at.contributors[parseInt(e.value)])}const fu=()=>{Pa(),Fa(),za(),jo(),bi(),Ha(),Xa(),Ua(),Ya(),Ga(),Va(),Wa(),qa(),Za(),Ja(),Ka()};var Fn={setLevelAuthor:Pa,setEnvironment:Fa,setEditors:za,setContributors:ja,populateContributors:jo,setVersion:bi,setTimeSpend:Ha,setCustomColor:Xa,setRequirements:Ua,setSuggestions:Ya,setInformation:Ga,setWarnings:Va,setBookmarks:Wa,setBPMChanges:qa,setEnvironmentEnhancement:Za,setPointDefinitions:Ja,setCustomEvents:Ka,setInfo:uu,setDiffInfoTable:hu,reset:fu};const mu="UI Input: ";var Kn={enable:t=>{const e=document.querySelectorAll(".input-toggle");if(!e.length){console.error(mu+"empty list, intentional or typo error?");return}e.forEach(n=>{n.disabled=!t})}};const pu="UI Loading: ",ln=document.querySelector(".loading__bar"),Xr="loading__bar--error",Ur="loading__bar--download",Ho=document.querySelector(".loading__text");if(!ln||!Ho)throw new Error(pu+"loading component is missing part");const Xo=(t,e,n=100)=>{Ho.textContent=e,ln.style.width=`${n}%`,t==="error"?ln.classList.add(Xr):ln.classList.remove(Xr),t==="download"?ln.classList.add(Ur):ln.classList.remove(Ur)},gu=()=>{Xo("info","No map loaded",0)};var _t={status:Xo,reset:gu},ot=(t=>(t[t.GENERAL_AUDIO=0]="GENERAL_AUDIO",t[t.GENERAL_COVER_IMAGE=1]="GENERAL_COVER_IMAGE",t[t.GENERAL_PREVIEW_TIME=2]="GENERAL_PREVIEW_TIME",t[t.GENERAL_PROGRESSION=3]="GENERAL_PROGRESSION",t[t.OTHERS_INVALID_OBJECT=4]="OTHERS_INVALID_OBJECT",t[t.OTHERS_OUTSIDE_PLAYABLE=5]="OTHERS_OUTSIDE_PLAYABLE",t[t.OTHERS_HOT_START=6]="OTHERS_HOT_START",t[t.OTHERS_NJS=7]="OTHERS_NJS",t[t.OTHERS_DIFFICULTY_LABEL=8]="OTHERS_DIFFICULTY_LABEL",t[t.EVENTS_INSUFFICIENT_LIGHT=9]="EVENTS_INSUFFICIENT_LIGHT",t[t.EVENTS_UNLIT_BOMB=10]="EVENTS_UNLIT_BOMB",t[t.NOTES_EFFECTIVE_BPM=11]="NOTES_EFFECTIVE_BPM",t[t.NOTES_ACCEPTABLE_PRECISION=12]="NOTES_ACCEPTABLE_PRECISION",t[t.NOTES_PARITY=13]="NOTES_PARITY",t[t.NOTES_VARY_SWING=14]="NOTES_VARY_SWING",t[t.NOTES_SLOW_SLIDER=15]="NOTES_SLOW_SLIDER",t[t.NOTES_INLINE_ANGLE=16]="NOTES_INLINE_ANGLE",t[t.NOTES_SHRADO_ANGLE=17]="NOTES_SHRADO_ANGLE",t[t.NOTES_SPEED_PAUSE=18]="NOTES_SPEED_PAUSE",t[t.NOTES_IMPROPER_WINDOW=19]="NOTES_IMPROPER_WINDOW",t[t.NOTES_HITBOX_STAIR=20]="NOTES_HITBOX_STAIR",t[t.NOTES_HITBOX_REVERSE_STAIR=21]="NOTES_HITBOX_REVERSE_STAIR",t[t.NOTES_HITBOX_INLINE=22]="NOTES_HITBOX_INLINE",t[t.NOTES_HITBOX_PATH=23]="NOTES_HITBOX_PATH",t[t.NOTES_COLOR_CHECK=24]="NOTES_COLOR_CHECK",t[t.NOTES_STACKED_NOTE=25]="NOTES_STACKED_NOTE",t[t.NOTES_DOUBLE_DIRECTIONAL=26]="NOTES_DOUBLE_DIRECTIONAL",t[t.NOTES_VISION_BLOCK=27]="NOTES_VISION_BLOCK",t[t.OBSTACLES_SHORT=28]="OBSTACLES_SHORT",t[t.OBSTACLES_CENTER=29]="OBSTACLES_CENTER",t[t.OBSTACLES_ZERO=30]="OBSTACLES_ZERO",t[t.OBSTACLES_NEGATIVE=31]="OBSTACLES_NEGATIVE",t))(ot||{}),lt=(t=>(t[t.GENERAL_AUDIO=0]="GENERAL_AUDIO",t[t.GENERAL_COVER_IMAGE=1]="GENERAL_COVER_IMAGE",t[t.GENERAL_PREVIEW_TIME=2]="GENERAL_PREVIEW_TIME",t[t.GENERAL_PROGRESSION=3]="GENERAL_PROGRESSION",t[t.OTHERS_INVALID_OBJECT=4]="OTHERS_INVALID_OBJECT",t[t.OTHERS_OUTSIDE_PLAYABLE=5]="OTHERS_OUTSIDE_PLAYABLE",t[t.OTHERS_HOT_START=6]="OTHERS_HOT_START",t[t.OTHERS_NJS=7]="OTHERS_NJS",t[t.OTHERS_DIFFICULTY_LABEL=8]="OTHERS_DIFFICULTY_LABEL",t[t.EVENTS_INSUFFICIENT_LIGHT=9]="EVENTS_INSUFFICIENT_LIGHT",t[t.EVENTS_UNLIT_BOMB=10]="EVENTS_UNLIT_BOMB",t[t.NOTES_COLOR_CHECK=11]="NOTES_COLOR_CHECK",t[t.NOTES_EFFECTIVE_BPM=12]="NOTES_EFFECTIVE_BPM",t[t.NOTES_ACCEPTABLE_PRECISION=13]="NOTES_ACCEPTABLE_PRECISION",t[t.NOTES_PARITY=14]="NOTES_PARITY",t[t.NOTES_VARY_SWING=15]="NOTES_VARY_SWING",t[t.NOTES_SLOW_SLIDER=16]="NOTES_SLOW_SLIDER",t[t.NOTES_INLINE_ANGLE=17]="NOTES_INLINE_ANGLE",t[t.NOTES_SHRADO_ANGLE=18]="NOTES_SHRADO_ANGLE",t[t.NOTES_SPEED_PAUSE=19]="NOTES_SPEED_PAUSE",t[t.NOTES_IMPROPER_WINDOW=20]="NOTES_IMPROPER_WINDOW",t[t.NOTES_HITBOX_STAIR=21]="NOTES_HITBOX_STAIR",t[t.NOTES_HITBOX_REVERSE_STAIR=22]="NOTES_HITBOX_REVERSE_STAIR",t[t.NOTES_HITBOX_INLINE=23]="NOTES_HITBOX_INLINE",t[t.NOTES_HITBOX_PATH=24]="NOTES_HITBOX_PATH",t[t.NOTES_STACKED_NOTE=25]="NOTES_STACKED_NOTE",t[t.NOTES_DOUBLE_DIRECTIONAL=26]="NOTES_DOUBLE_DIRECTIONAL",t[t.NOTES_VISION_BLOCK=27]="NOTES_VISION_BLOCK",t[t.OBSTACLES_SHORT=28]="OBSTACLES_SHORT",t[t.OBSTACLES_CENTER=29]="OBSTACLES_CENTER",t[t.OBSTACLES_ZERO=30]="OBSTACLES_ZERO",t[t.OBSTACLES_NEGATIVE=31]="OBSTACLES_NEGATIVE",t))(lt||{});const Yr={version:1,load:{audio:!0,imageCover:!0,imageContributor:!0},sorting:!0,beatNumbering:"beattime",rounding:3,theme:"Dark",onLoad:{stats:!1},show:{info:!1,tools:!1,stats:!1,settings:!1}};var mt=new class{constructor(){this.property=Dt(Yr),this.stringify=()=>JSON.stringify({settings:this.property}),this.init=()=>{var n,a;if(localStorage==null)return;const e=localStorage.getItem("settings");if(e){const s=JSON.parse(e);if(!((n=s.settings)!=null&&n.version)){this.clear();return}this.property=(a=s.settings)!=null?a:this.property,this.save()}},this.save=()=>{localStorage&&localStorage.setItem("settings",this.stringify())},this.clear=()=>{localStorage&&localStorage.clear()},this.reset=()=>{this.property=Dt(Yr)},this.init()}get version(){return this.property.version}get load(){return this.property.load}get sorting(){return this.property.sorting}set sorting(e){this.property.sorting=e}get beatNumbering(){return this.property.beatNumbering}set beatNumbering(e){this.property.beatNumbering=e}get rounding(){return this.property.rounding}set rounding(e){this.property.rounding=e}get theme(){return this.property.theme}set theme(e){this.property.theme=e}get onLoad(){return this.property.onLoad}get show(){return this.property.show}};const ct=(t,e)=>{const n=document.createElement("div");return e?n.innerHTML=`<b>${t}:</b> ${e}`:n.innerHTML=`<b>${t}</b>`,n},dt=(t,e,n)=>{const a=document.createElement("div");return a.innerHTML=`<b>${t} [${e.length}]:</b> ${e.map(s=>P(n.adjustTime(s),3)).join(", ")}`,a},_u="Validate Cover Image",bu="Validate cover image.",yu=!0,Da={name:_u,description:bu,type:"general",order:{input:ot.GENERAL_COVER_IMAGE,output:lt.GENERAL_COVER_IMAGE},input:{enabled:yu,params:{}},output:{html:null},run:vu};function vu(){const t=new Image,e=Ot.getCoverImage(),n=[];if(hn.loading.coverImage&&e!==null?(t.src=e,t.width!==t.height&&n.push(ct("Cover image is not square","resize to fit square")),(t.width<256||t.height<256)&&n.push(ct("Cover image is too small","require at least 256x256"))):n.push(ct("No cover image",mt.load.imageCover?"could not be loaded or found":"no cover image option is enabled")),n.length){const a=document.createElement("div");n.forEach(s=>a.append(s)),Da.output.html=a}else Da.output.html=null}const Eu="Audio Duration",wu="For ranking purpose, check for audio duration.",Su=!0,si={name:Eu,description:wu,type:"general",order:{input:ot.GENERAL_AUDIO,output:lt.GENERAL_AUDIO},input:{enabled:Su,params:{}},output:{html:null},run:Cu};function Cu(t){const{audioDuration:e}=t.settings;e&&e<20?si.output.html=ct("Unrankable audio length",`too short (${kt(e)}s)`):hn.loading.audio?si.output.html=null:si.output.html=ct("No audio",mt.load.audio?"could not be loaded or not found":"no audio mode is enabled")}const Du="Preview Time",Lu="Warn default editor preview time.",xu=!0,La={name:Du,description:Lu,type:"general",order:{input:ot.GENERAL_PREVIEW_TIME,output:lt.GENERAL_PREVIEW_TIME},input:{enabled:xu,params:{}},output:{html:null},run:ku};function ku(t){const{_previewStartTime:e,_previewDuration:n}=t.info;if(e===12&&n===10){const a=document.createElement("div");a.innerHTML="<b>Default preview time:</b> strongly recommended to set for audience's 1st impression",La.output.html=a}else La.output.html=null}const Tu=t=>Math.max(...t.map(e=>e.ebpm),0),Ru=t=>Math.max(...t.map(e=>e.ebpmSwing),0),Uo=(t,e,n)=>t.direction===8&&e.direction===8&&n!==8&&(t.posX>e.posX&&(n===5||n===3||n===7)||t.posX<e.posX&&(n===6||n===2||n===4)||t.posY>e.posY&&(n===4||n===0||n===5)||t.posY<e.posY&&(n===6||n===1||n===7))||t.posX>e.posX&&(t.direction===5||t.direction===3||t.direction===7||(e.direction===5||e.direction===3||e.direction===7)&&t.direction===8)||t.posX<e.posX&&(t.direction===6||t.direction===2||t.direction===4||(e.direction===6||e.direction===2||e.direction===4)&&t.direction===8)||t.posY>e.posY&&(t.direction===4||t.direction===0||t.direction===5||(e.direction===4||e.direction===0||e.direction===5)&&t.direction===8)||t.posY<e.posY&&(t.direction===6||t.direction===1||t.direction===7||(e.direction===6||e.direction===1||e.direction===7)&&t.direction===8),xa=(t,e,n,a=!1)=>{const[s,i]=t.getPosition(),[l,r]=e.getPosition(),o=t.getAngle(),u=e.getAngle(),h=a?540:360;let m=!1;if(t.direction!==8){const c=(Gi(Math.atan2(i-r,s-l))+450)%360;for(const[p,_,y]of n){const b=y!=null?y:0,v=(o+h-p+b)%360,S=(o+h+p+b)%360;if(m=_>=Math.sqrt(Math.pow(s-l,2)+Math.pow(i-r,2))&&(v<S&&v<=c&&c<=S||v>=S&&(c<=S||c>=v))||m,m)break}}let g=!1;if(e.direction!==8){const c=(Gi(Math.atan2(r-i,l-s))+450)%360;for(const[p,_,y]of n){const b=y!=null?y:0,v=(u+h-p+b)%360,S=(u+h+p+b)%360;if(g=_>=Math.sqrt(Math.pow(s-l,2)+Math.pow(i-r,2))&&(v<S&&v<=c&&c<=S||v>=S&&(c<=S||c>=v))||g,g)break}}return[m,g]},Gr=(t,e)=>{if(Uo(t,e,8))return t.direction===8?e.direction:t.direction;if(t.direction!==8)return t.direction;if(t.time>e.time){if(t.posX>e.posX&&t.isHorizontal(e))return 3;if(t.posX<e.posX&&t.isHorizontal(e))return 2;if(t.posY>e.posY){if(t.isVertical(e))return 0;if(t.posX>e.posX)return 5;if(t.posX<e.posX)return 4}if(t.posY<e.posY){if(t.isVertical(e))return 1;if(t.posX>e.posX)return 7;if(t.posX<e.posX)return 6}}return 8},zn=(t,e,n,a)=>{let s,i;if(t===null||e===null)return!1;if(typeof t=="number")s=t;else{if(t.direction===8)return!1;s=t.getAngle()}if(typeof e=="number")i=e;else{if(e.direction===8)return!1;i=e.getAngle()}return a?Mr(s,i,360)<=n:Mr(s,i,360)>=n};class Bt{constructor(e){this.time=e.time,this.duration=e.duration,this.minSpeed=e.minSpeed,this.maxSpeed=e.maxSpeed,this.ebpm=e.ebpm,this.ebpmSwing=e.ebpmSwing,this.data=e.data}static generate(e,n){const a=[];let s=0,i=0,l,r;const o={},u={},h={0:[],1:[]};for(const m of e)m.type==="note"&&(l=0,r=Number.MAX_SAFE_INTEGER,u[m.data.color]?this.next(m,u[m.data.color],n,h[m.data.color])&&(i=this.calcEBPMBetweenObject(m.data,o[m.data.color].data,n.value),s=this.calcEBPMBetweenObject(m.data,u[m.data.color].data,n.value),l=this.calcMinSliderSpeed(h[m.data.color],n),r=this.calcMaxSliderSpeed(h[m.data.color],n),l>0&&r!==1/0||(l=0,r=0),a.push({time:o[m.data.color].data.time,duration:u[m.data.color].data.time-o[m.data.color].data.time,data:h[m.data.color],ebpm:s,ebpmSwing:i,maxSpeed:r,minSpeed:l}),o[m.data.color]=m,h[m.data.color]=[]):o[m.data.color]=m,u[m.data.color]=m,h[m.data.color].push(m));for(let m=0;m<2;m++)u[m]&&(i=0,s=0,l=this.calcMinSliderSpeed(h[m],n),r=this.calcMaxSliderSpeed(h[m],n),l>0&&r!==1/0||(l=0,r=0),a.push({time:o[m].data.time,duration:u[m].data.time-o[m].data.time,data:h[m],ebpm:s,ebpmSwing:i,maxSpeed:r,minSpeed:l}));return a}}Bt.next=(t,e,n,a)=>{if(t.type==="bomb"||e.type==="bomb")throw new Error("Invalid type");if(a&&a.length>0&&n.toRealTime(e.data.time)+.005<n.toRealTime(t.data.time)&&t.data.direction!==8){for(const s of a)if(s.type==="note"&&s.data.direction!==8&&zn(t.data,s.data,90,!1))return!0}if(a&&a.length>0){for(const s of a)if(s.type==="note"&&t.data.isInline(s.data))return!0}return t.data.isWindow(e.data)&&n.toRealTime(t.data.time-e.data.time)>.08||n.toRealTime(t.data.time-e.data.time)>.07};Bt.calcEBPMBetweenObject=(t,e,n)=>n/((t.time-e.time)*2);Bt.calcMinSliderSpeed=(t,e)=>{let n=!1,a=!1,s=0;const i=e.toRealTime(Math.max(...t.map((l,r)=>r===0?0:((t[r].data.isHorizontal(t[r-1].data)||t[r].data.isVertical(t[r-1].data))&&!n&&(n=!0,s=(t[r].data.time-t[r-1].data.time)/(t[r].data.getDistance(t[r-1].data)||1)),a=t[r].data.isDiagonal(t[r-1].data)||t[r].data.isSlantedWindow(t[r-1].data)||a,(t[r].data.time-t[r-1].data.time)/(t[r].data.getDistance(t[r-1].data)||1)))));return n&&a?e.toRealTime(s):i};Bt.calcMaxSliderSpeed=(t,e)=>{let n=!1,a=!1,s=Number.MAX_SAFE_INTEGER;const i=e.toRealTime(Math.min(...t.map((l,r)=>r===0?Number.MAX_SAFE_INTEGER:((t[r].data.isHorizontal(t[r-1].data)||t[r].data.isVertical(t[r-1].data))&&!n&&(n=!0,s=(t[r].data.time-t[r-1].data.time)/(t[r].data.getDistance(t[r-1].data)||1)),a=t[r].data.isDiagonal(t[r-1].data)||t[r].data.isSlantedWindow(t[r-1].data)||a,(t[r].data.time-t[r-1].data.time)/(t[r].data.getDistance(t[r-1].data)||1)))));return n&&a?e.toRealTime(s):i};const Iu=(t,e,n)=>{const a={left:new Array(Math.floor(e+1)).fill(0),right:new Array(Math.floor(e+1)).fill(0)};let s,i;for(const l of t){if(l.type!=="note")continue;const r=n.toRealTime(l.data.time);l.data.color===0&&(s?Bt.next(l,s,n)&&a.left[Math.floor(r)]++:a.left[Math.floor(r)]++,s=l),l.data.color===1&&(i?Bt.next(l,i,n)&&a.right[Math.floor(r)]++:a.right[Math.floor(r)]++,i=l)}return a},Xi=(t,e)=>{if(!t.length)return 0;if(t.length<e)return t.reduce((s,i)=>s+i)/t.length;let n=t.slice(0,e).reduce((s,i)=>s+i),a=n;for(let s=0;s<t.length-e;s++)n=n-t[s]+t[s+e],a=Math.max(a,n);return a/e},Vr=(t,e,n,a)=>{const i={characteristic:n,difficulty:a,red:{count:0,peak:0,median:0,total:0},blue:{count:0,peak:0,median:0,total:0},total:{count:0,peak:0,median:0,total:0},container:Bt.generate(t.getNoteContainer(),e)},l=Math.max(e.toRealTime(t.getLastInteractiveTime()-t.getFirstInteractiveTime()),0),r=Math.max(e.toRealTime(t.getLastInteractiveTime()),0),o=Iu(t.getNoteContainer(),r,e),u=o.left.map((c,p)=>c+o.right[p]);if(u.reduce((c,p)=>c+p)===0)return i;const h=[],m=[],g=[];for(let c=0,p=Math.ceil(u.length/10);c<p;c++){const _=c*10;let y=10;y+_>u.length&&(y=u.length-_);const b=o.left.slice(_,_+y),v=o.right.slice(_,_+y),S=u.slice(_,_+y);h.push(b.reduce((L,D)=>L+D)/y),m.push(v.reduce((L,D)=>L+D)/y),g.push(S.reduce((L,D)=>L+D)/y)}return i.red.total=o.left.reduce((c,p)=>c+p),i.red.count=o.left.reduce((c,p)=>c+p)/l,i.red.peak=Xi(o.left,10),i.red.median=zi(h),i.blue.total=o.right.reduce((c,p)=>c+p),i.blue.count=o.right.reduce((c,p)=>c+p)/l,i.blue.peak=Xi(o.right,10),i.blue.median=zi(m),i.total.total=i.red.total+i.blue.total,i.total.count=u.reduce((c,p)=>c+p)/l,i.total.peak=Xi(u,10),i.total.median=zi(g),i},Au=(t,e)=>{let n=0,a=0;for(const s of t){const i=s.total.count;if(a>0&&i>0&&(n=(1-a/i)*100),a=i>0?i:a,a>e&&n>40)return s}return null},Bu=(t,e)=>{let n=Number.MAX_SAFE_INTEGER,a=0;for(const s of t){const i=s.total.count;if(a>0&&i>0&&(n=(1-a/i)*100),a=i>0?i:a,a>e&&n<10)return s}return null},$u=t=>{let e=0,n=Number.MAX_SAFE_INTEGER;return t.forEach(a=>{const s=a.total.count;s>0&&(e=Math.max(e,s),n=Math.min(n,s))}),e||e&&n?(1-n/e)*100:0},Wr=t=>{let e=Number.MAX_SAFE_INTEGER;return t.forEach(n=>{const a=n.total.count;a>0&&(e=Math.min(e,a))}),e},Nu=t=>Math.max(...t.map(e=>e.minSpeed),0),Mu=t=>{const e=t.map(n=>n.maxSpeed).filter(n=>n!==0);return e.length?Math.min(...e):0},Ou="Difficulty Progression",Pu="For ranking purpose, check difficuly progression to fit rankability criteria.",Fu=!0,In={name:Ou,description:Pu,type:"general",order:{input:ot.GENERAL_PROGRESSION,output:lt.GENERAL_PROGRESSION},input:{enabled:Fu,params:{}},output:{html:null},run:zu};function zu(t){const{audioDuration:e}=t.settings;if(!e){In.output.html=null;return}const n=at.beatmapDifficulty.map(r=>r.swingAnalysis).filter(r=>r.characteristic==="Standard").sort((r,o)=>r.total.count-o.total.count);if(!n.length){In.output.html=null;return}const a=e<120?3.2:e<240?4.2:5.2,s=[];e<240&&Wr(n)>a&&$u(n)<60&&s.push(ct(`Minimum SPS not met (<${a})`,`lowest is ${P(Wr(n),2)}`));const i=Au(n,a),l=Bu(n,a);if(i&&e<360&&s.push(ct("Violates progression",`${i.difficulty} exceeded 40% SPS drop`)),l&&e<360&&s.push(ct("Violates progression",`${l.difficulty} has less than 10% SPS drop`)),s.length){const r=document.createElement("div");s.forEach(o=>r.append(o)),In.output.html=r}else In.output.html=null}var qr=Object.freeze(Object.defineProperty({__proto__:null,coverImage:Da,audio:si,previewTime:La,progression:In},Symbol.toStringTag,{value:"Module"}));const ju="Effective BPM",Hu=`Effective BPM is calculated by one hand making 1/2 precision movement relative to the BPM.
EBPM starts from previous end note to next start note (typically for sliders).
EBPM Swing starts from previous start note to next start note.`,Xu=!0,Qa=450,tr=350,Xn=document.createElement("div"),Pe=document.createElement("input"),er=document.createElement("label"),Fe=document.createElement("input"),nr=document.createElement("label");er.textContent="Effective BPM threshold: ";er.htmlFor="input__tools-ebpm";Pe.id="input__tools-ebpm";Pe.className="input-toggle input--small";Pe.type="number";Pe.min="0";Pe.value=Qa.toString();Pe.addEventListener("change",Yu);nr.textContent=" (swing): ";nr.htmlFor="input__tools-ebpms";Fe.id="input__tools-ebpms";Fe.className="input-toggle input--small";Fe.type="number";Fe.min="0";Fe.value=tr.toString();Fe.addEventListener("change",Gu);Xn.appendChild(er);Xn.appendChild(Pe);Xn.appendChild(nr);Xn.appendChild(Fe);const Yt={name:ju,description:Hu,type:"note",order:{input:ot.NOTES_EFFECTIVE_BPM,output:lt.NOTES_EFFECTIVE_BPM},input:{enabled:Xu,params:{ebpmThres:Qa,ebpmsThres:tr},html:Xn,adjustTime:Uu},output:{html:null},run:Wu};function Uu(t){Yt.input.params.ebpmThres=P(Math.min(Qa,t.value*2*1.285714),1),Yt.input.params.ebpmsThres=P(Math.min(tr,t.value*2),1),Pe.value=Yt.input.params.ebpmThres.toString(),Fe.value=Yt.input.params.ebpmsThres.toString()}function Yu(){Yt.input.params.ebpmThres=P(Math.abs(parseFloat(this.value)),1),this.value=Yt.input.params.ebpmThres.toString()}function Gu(){Yt.input.params.ebpmsThres=P(Math.abs(parseFloat(this.value)),1),this.value=Yt.input.params.ebpmsThres.toString()}function Vu(t){const{swingAnalysis:e}=t.difficulty,{ebpmThres:n,ebpmsThres:a}=Yt.input.params,s=e.container.filter(l=>l.ebpm>n).map(l=>l.time),i=e.container.filter(l=>l.ebpmSwing>a).map(l=>l.time);return{base:s,swing:i}}function Wu(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=Vu(t),{ebpmThres:n,ebpmsThres:a}=Yt.input.params,s=[];if(e.base.length&&s.push(dt(`>${n}EBPM warning`,e.base,t.settings.bpm)),e.swing.length&&s.push(dt(`>${a}EBPM (swing) warning`,e.swing,t.settings.bpm)),s.length){const i=document.createElement("div");s.forEach(l=>i.append(l)),Yt.output.html=i}else Yt.output.html=null}const Yo=[8,6],ir=document.createElement("div"),vn=document.createElement("input"),ar=document.createElement("label"),qu="Acceptable Beat Precision",Zu="Validate note timing placement is within timing precision.",Ju=!0;ar.textContent="Acceptable beat precision: ";ar.htmlFor="input__tools-prec";vn.id="input__tools-prec";vn.className="input-toggle input--small";vn.type="text";vn.value=Yo.join(" ");vn.addEventListener("change",Ku);ir.appendChild(ar);ir.appendChild(vn);const fn={name:qu,description:Zu,type:"note",order:{input:ot.NOTES_ACCEPTABLE_PRECISION,output:lt.NOTES_ACCEPTABLE_PRECISION},input:{enabled:Ju,params:{prec:[...Yo]},html:ir},output:{html:null},run:th};function Ku(){fn.input.params.prec=this.value.trim().split(" ").map(t=>parseInt(t)).filter(t=>t>0?!Number.isNaN(t):!1),this.value=fn.input.params.prec.join(" ")}function Qu(t,e){const{bpm:n}=t,a=e.swingAnalysis.container,{prec:s}=fn.input.params;return a.map(i=>i.time).filter((i,l,r)=>!l||i!==r[l-1]).filter(i=>{if(!s.length)return!1;for(let l=0;l<s.length;l++)if((n.adjustTime(i)+.001)%(1/s[l])<.01)return!1;return!0})}function th(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=Qu(t.settings,t.difficulty);e.length?fn.output.html=dt("Off-beat precision",e,t.settings.bpm):fn.output.html=null}const ka=class{constructor(){}};let yt=ka;yt.list=[];yt.create=(t,e,n,a)=>{const s=t.trim().toLowerCase().replace(" ","-");if(ka.list.includes(s))throw new Error(s+" is already being used.");ka.list.push(s);const i=document.createElement("div"),l=document.createElement("input"),r=document.createElement("label");return r.textContent=" "+t,r.title=e,r.htmlFor="input__tools-"+s,l.id="input__tools-"+s,l.className="input-toggle",l.type="checkbox",l.checked=n,l.addEventListener("change",a),i.appendChild(l),i.appendChild(r),i};const Zr="Varying Swing Speed",Jr="Check for varying swing speed due to changes in slider distance.",Kr=!0,yi={name:Zr,description:Jr,type:"note",order:{input:ot.NOTES_VARY_SWING,output:lt.NOTES_VARY_SWING},input:{enabled:Kr,params:{},html:yt.create(Zr,Jr,Kr,function(){yi.input.enabled=this.checked})},output:{html:null},run:nh};function eh(t){const{swingAnalysis:e}=t;return e.container.filter(n=>Math.abs(n.minSpeed-n.maxSpeed)>.002).map(n=>n.time).filter((n,a,s)=>!a||n!==s[a-1])}function nh(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=eh(t.difficulty);e.length?yi.output.html=dt("Varying swing speed",e,t.settings.bpm):yi.output.html=null}const Go="Slow Slider",Vo="Look for slider that require slow swing.",Wo=!0,qo=.025,En=document.createElement("div"),ze=document.createElement("input"),rr=document.createElement("label"),je=document.createElement("input"),sr=document.createElement("label");let mn;rr.textContent="min speed (ms): ";rr.htmlFor="input__tools-slow-slider-time";ze.id="input__tools-slow-slider-time";ze.className="input-toggle input--small";ze.type="number";ze.min="0";ze.value=P(qo*1e3,1).toString();ze.addEventListener("change",ah);sr.textContent=" (prec): ";sr.htmlFor="input__tools-slow-slider-prec";je.id="input__tools-slow-slider-prec";je.className="input-toggle input--small";je.type="number";je.min="0";je.addEventListener("change",rh);En.appendChild(yt.create(Go,Vo,Wo,function(){Kt.input.enabled=this.checked}));En.appendChild(rr);En.appendChild(ze);En.appendChild(sr);En.appendChild(je);const Kt={name:Go,description:Vo,type:"note",order:{input:ot.NOTES_SLOW_SLIDER,output:lt.NOTES_SLOW_SLIDER},input:{enabled:Wo,params:{minSpeed:qo},html:En,adjustTime:ih},output:{html:null},run:oh};function ih(t){mn=t,je.value=P(1/mn.toBeatTime(Kt.input.params.minSpeed),2).toString()}function ah(){Kt.input.params.minSpeed=Math.abs(parseFloat(this.value))/1e3,this.value=P(Kt.input.params.minSpeed*1e3,1).toString(),mn&&(je.value=P(1/mn.toBeatTime(Kt.input.params.minSpeed),2).toString())}function rh(){if(!mn){this.value="0";return}let t=P(Math.abs(parseFloat(this.value)),2)||1;Kt.input.params.minSpeed=mn.toRealTime(1/t),ze.value=P(Kt.input.params.minSpeed*1e3,1).toString(),this.value=t.toString()}function sh(t){const{swingAnalysis:e}=t.difficulty,{minSpeed:n}=Kt.input.params;return e.container.filter(a=>a.maxSpeed>n||a.minSpeed>n).map(a=>a.time).filter((a,s,i)=>!s||a!==i[s-1])}function oh(t){if(!t.difficulty){console.error("Something went wrong!");return}const{minSpeed:e}=Kt.input.params,n=sh(t);n.length?Kt.output.html=dt(`Slow slider (>${P(e*1e3,1)}ms)`,n,t.settings.bpm):Kt.output.html=null}const Zo="Inline Sharp Angle",Jo="Check for angle changes within inline note.",Ko=!0,Qo=.15;let pn;const wn=document.createElement("div"),He=document.createElement("input"),or=document.createElement("label"),Le=document.createElement("input"),lr=document.createElement("label");or.textContent="max time (ms): ";or.htmlFor="input__tools-inline-angle-time";He.id="input__tools-inline-angle-time";He.className="input-toggle input--small";He.type="number";He.min="0";He.value=P(Qo*1e3,1).toString();He.addEventListener("change",ch);lr.textContent=" (beat): ";lr.htmlFor="input__tools-inline-angle-beat";Le.id="input__tools-inline-angle-beat";Le.className="input-toggle input--small";Le.type="number";Le.min="0";Le.step="0.1";Le.addEventListener("change",uh);wn.appendChild(yt.create(Zo,Jo,Ko,function(){le.input.enabled=this.checked}));wn.appendChild(or);wn.appendChild(He);wn.appendChild(lr);wn.appendChild(Le);const le={name:Zo,description:Jo,type:"note",order:{input:ot.NOTES_INLINE_ANGLE,output:lt.NOTES_INLINE_ANGLE},input:{enabled:Ko,params:{maxTime:Qo},html:wn,adjustTime:lh},output:{html:null},run:dh};function lh(t){pn=t,Le.value=P(pn.toBeatTime(le.input.params.maxTime),2).toString()}function ch(){le.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=P(le.input.params.maxTime*1e3,1).toString(),pn&&(Le.value=P(pn.toBeatTime(le.input.params.maxTime),2).toString())}function uh(){if(!pn){this.value="0";return}let t=P(Math.abs(parseFloat(this.value)),2)||1;le.input.params.maxTime=pn.toRealTime(t),He.value=P(le.input.params.maxTime*1e3,1).toString(),this.value=t.toString()}function hh(t){const{bpm:e}=t.settings,n=t.difficulty.noteContainer,{maxTime:a}=le.input.params,s=e.toBeatTime(a)+.001,i={},l={},r={},o={0:[],1:[],3:[]},u=[];let h=0;for(let m=0,g=n.length;m<g;m++){const c=n[m];c.type==="note"&&i[c.data.color]?Bt.next(c,i[c.data.color],e,o[c.data.color])?(r[c.data.color]&&(r[c.data.color]=null,l[c.data.color]=(l[c.data.color]+180)%360),Qr(c.data,n,h,s)&&zn(c.data,l[c.data.color],90,!0)&&u.push(c.data),c.data.direction===8?r[c.data.color]=c.data:l[c.data.color]=c.data.getAngle(),o[c.data.color]=[]):(r[c.data.color]&&Qr(c.data,n,h,s)&&zn(c.data,l[c.data.color],90,!0)&&(u.push(r[c.data.color]),r[c.data.color]=null),c.data.direction!==8&&(l[c.data.color]=c.data.getAngle())):c.type==="note"&&(l[c.data.color]=c.data.getAngle()),c.type==="note"&&(i[c.data.color]=c,o[c.data.color].push(c)),c.type==="bomb"&&(c.data.posY===0&&(c.data.posX===1&&(l[0]=Jt[0],r[0]=null),c.data.posX===2&&(l[1]=Jt[0],r[1]=null)),c.data.posY===2&&(c.data.posX===1&&(l[0]=Jt[1],r[0]=null),c.data.posX===2&&(l[1]=Jt[1],r[1]=null)))}return u.map(m=>m.time).filter(function(m,g,c){return!g||m!==c[g-1]})}function Qr(t,e,n,a){for(let s=n;e[s].data.time<t.time;s++){const i=e[s];if(i.type==="note"&&t.isInline(i.data)&&t.time-e[s].data.time<=a)return!0}return!1}function dh(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=hh(t);e.length?le.output.html=dt("Inline sharp angle",e,t.settings.bpm):le.output.html=null}const tl="shrado Angle",el="Look for common negative curvature pattern.",nl=!1,il=.15,al=1;let gn;const xe=document.createElement("div"),an=document.createElement("input"),cr=document.createElement("label"),Xe=document.createElement("input"),ur=document.createElement("label"),ke=document.createElement("input"),hr=document.createElement("label");cr.textContent="min distance: ";cr.htmlFor="input__tools-shrado-angle-distance";an.id="input__tools-shrado-angle-distance";an.className="input-toggle input--small";an.type="number";an.min="0";an.value=al.toString();an.addEventListener("change",mh);ur.textContent="max time (ms): ";ur.htmlFor="input__tools-shrado-angle-time";Xe.id="input__tools-shrado-angle-time";Xe.className="input-toggle input--small";Xe.type="number";Xe.min="0";Xe.value=P(il*1e3,1).toString();Xe.addEventListener("change",ph);hr.textContent=" (beat): ";hr.htmlFor="input__tools-shrado-angle-beat";ke.id="input__tools-shrado-angle-beat";ke.className="input-toggle input--small";ke.type="number";ke.min="0";ke.step="0.1";ke.addEventListener("change",gh);xe.appendChild(yt.create(tl,el,nl,function(){Gt.input.enabled=this.checked}));xe.appendChild(cr);xe.appendChild(an);xe.appendChild(document.createElement("br"));xe.appendChild(ur);xe.appendChild(Xe);xe.appendChild(hr);xe.appendChild(ke);const Gt={name:tl,description:el,type:"note",order:{input:ot.NOTES_SHRADO_ANGLE,output:lt.NOTES_SHRADO_ANGLE},input:{enabled:nl,params:{distance:al,maxTime:il},html:xe,adjustTime:fh},output:{html:null},run:bh};function fh(t){gn=t,ke.value=P(gn.toBeatTime(Gt.input.params.maxTime),2).toString()}function mh(){Gt.input.params.distance=Math.max(parseInt(this.value),0),this.value=Gt.input.params.distance.toString()}function ph(){Gt.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=P(Gt.input.params.maxTime*1e3,1).toString(),gn&&(ke.value=P(gn.toBeatTime(Gt.input.params.maxTime),2).toString())}function gh(){if(!gn){this.value="0";return}let t=P(Math.abs(parseFloat(this.value)),2)||1;Gt.input.params.maxTime=gn.toRealTime(t),Xe.value=P(Gt.input.params.maxTime*1e3,1).toString(),this.value=t.toString()}function _h(t){var m;const{bpm:e}=t.settings,{noteContainer:n}=t.difficulty,{maxTime:a,distance:s}=Gt.input.params,i=e.toBeatTime(a)+.001,l={},r={},o={},u={0:[],1:[],3:[]},h=[];for(let g=0,c=n.length;g<c;g++){if(n[g].type!=="note")continue;const p=n[g];l[p.data.color]?Bt.next(p,l[p.data.color],e,u[p.data.color])?(o[p.data.color]&&(o[p.data.color]=null,r[p.data.color]=(m=Cc[r[p.data.color]])!=null?m:8),p.data.getDistance(l[p.data.color].data)>=s&&ts(p.data.direction,r[p.data.color],p.data.color)&&p.data.time-l[p.data.color].data.time<=i&&h.push(p),p.data.direction===8?o[p.data.color]=p:r[p.data.color]=p.data.direction,u[p.data.color]=[]):(o[p.data.color]&&p.data.getDistance(l[p.data.color].data)>=s&&ts(p.data.direction,r[p.data.color],p.data.color)&&p.data.time-l[p.data.color].data.time<=i&&(h.push(o[p.data.color]),o[p.data.color]=null),p.data.direction!==8&&(r[p.data.color]=p.data.direction)):r[p.data.color]=p.data.direction,l[p.data.color]=p,u[p.data.color].push(p)}return h.map(g=>g.data.time).filter(function(g,c,p){return!c||g!==p[c-1]})}function ts(t,e,n){return t===8||e===8?!1:(n===0?e===7:e===6)&&t===0}function bh(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=_h(t);e.length?Gt.output.html=dt("Shrado angle",e,t.settings.bpm):Gt.output.html=null}const rl="Speed Pause",sl="Look for stream/burst containing timing gap causing sudden change of pace.",ol=!1,ll=.075;let _n;const Sn=document.createElement("div"),Ue=document.createElement("input"),dr=document.createElement("label"),Ye=document.createElement("input"),fr=document.createElement("label");dr.textContent="stream speed (ms): ";dr.htmlFor="input__tools-speed-pause-time";Ue.id="input__tools-speed-pause-time";Ue.className="input-toggle input--small";Ue.type="number";Ue.min="0";Ue.value=P(ll*1e3,1).toString();Ue.addEventListener("change",vh);fr.textContent=" (prec): ";fr.htmlFor="input__tools-speed-pause-prec";Ye.id="input__tools-speed-pause-prec";Ye.className="input-toggle input--small";Ye.type="number";Ye.min="0";Ye.addEventListener("change",Eh);Sn.appendChild(yt.create(rl,sl,ol,function(){ce.input.enabled=this.checked}));Sn.appendChild(dr);Sn.appendChild(Ue);Sn.appendChild(fr);Sn.appendChild(Ye);const ce={name:rl,description:sl,type:"note",order:{input:ot.NOTES_SPEED_PAUSE,output:lt.NOTES_SPEED_PAUSE},input:{enabled:ol,params:{maxTime:ll},html:Sn,adjustTime:yh},output:{html:null},run:Sh};function yh(t){_n=t,Ye.value=P(1/_n.toBeatTime(ce.input.params.maxTime),2).toString()}function vh(){ce.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=P(ce.input.params.maxTime*1e3,1).toString(),_n&&(Ye.value=P(1/_n.toBeatTime(ce.input.params.maxTime),2).toString())}function Eh(){if(!_n){this.value="0";return}let t=P(Math.abs(parseFloat(this.value)),2)||1;ce.input.params.maxTime=_n.toRealTime(1/t),Ue.value=P(ce.input.params.maxTime*1e3,1).toString(),this.value=t.toString()}function wh(t,e){const{bpm:n}=t,{noteContainer:a}=e,{maxTime:s}=ce.input.params,i=n.toBeatTime(s)+.001,l={},r={},o={0:!1,1:!1,3:!1},u={0:[],1:[],3:[]},h=[];for(let m=0,g=a.length;m<g;m++){if(a[m].type!=="note")continue;const c=a[m];l[c.data.color]?Bt.next(c,l[c.data.color],n,u[c.data.color])&&(c.data.time-l[c.data.color].data.time<=i*2?(o[0]&&o[1]&&l[c.data.color].data.time-r[c.data.color].data.time<=i*3&&h.push(l[c.data.color]),o[c.data.color]=!1):o[c.data.color]||(o[c.data.color]=!0,r[c.data.color]=l[c.data.color]),u[c.data.color]=[],l[c.data.color]=c):l[c.data.color]=c,u[c.data.color].push(c)}return h.map(m=>m.data.time).filter(function(m,g,c){return!g||m!==c[g-1]})}function Sh(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=wh(t.settings,t.difficulty);e.length?ce.output.html=dt("Speed pause",e,t.settings.bpm):ce.output.html=null}const es="Hitbox Staircase",ns="Check for overlapping post-swing hitbox with note hitbox during swinging.",is=!0,vi={name:es,description:ns,type:"note",order:{input:ot.NOTES_HITBOX_STAIR,output:lt.NOTES_HITBOX_STAIR},input:{enabled:is,params:{},html:yt.create(es,ns,is,function(){vi.input.enabled=this.checked})},output:{html:null},run:Lh},Ch=(t,e,n)=>{for(let a=n,s=e.length;a<s;a++)if(e[a].type==="note"){if(e[a].data.time<t.data.time+.01&&e[a].data.color!==t.data.color)return!0;if(e[a].data.time>t.data.time+.01)return!1}return!1};function Dh(t){const{bpm:e}=t.settings,{noteContainer:n}=t.difficulty,a=e.toBeatTime(.15),s={},i={},l={},r={0:[],1:[],3:[]},o={0:dn.create(),1:dn.create({c:1})},u=[];for(let h=0,m=n.length;h<m;h++){if(n[h].type!=="note")continue;const g=n[h];s[g.data.color]?(Bt.next(g,s[g.data.color],e,r[g.data.color])?(l[g.data.color]=g.data.time-s[g.data.color].data.time,g.data.direction!==8?(o[g.data.color].posX=g.data.posX+Ae[g.data.direction][0],o[g.data.color].posY=g.data.posY+Ae[g.data.direction][1]):(o[g.data.color].posX=-1,o[g.data.color].posY=-1),r[g.data.color]=[],i[g.data.color]=g.data.direction):Uo(g.data,s[g.data.color].data,i[g.data.color])&&(g.data.direction!==8?(o[g.data.color].posX=g.data.posX+Ae[g.data.direction][0],o[g.data.color].posY=g.data.posY+Ae[g.data.direction][1],i[g.data.color]=g.data.direction):(o[g.data.color].posX=g.data.posX+Ae[i[g.data.color]][0],o[g.data.color].posY=g.data.posY+Ae[i[g.data.color]][1])),s[(g.data.color+1)%2]&&g.data.time-s[(g.data.color+1)%2].data.time!==0&&g.data.time-s[(g.data.color+1)%2].data.time<Math.min(a,l[(g.data.color+1)%2])&&g.data.posX===o[(g.data.color+1)%2].posX&&g.data.posY===o[(g.data.color+1)%2].posY&&!Ch(g,n,h)&&u.push(g)):(g.data.direction!==8?(o[g.data.color].posX=g.data.posX+Ae[g.data.direction][0],o[g.data.color].posY=g.data.posY+Ae[g.data.direction][1]):(o[g.data.color].posX=-1,o[g.data.color].posY=-1),i[g.data.color]=g.data.direction),s[g.data.color]=g,r[g.data.color].push(g)}return u.map(h=>h.data.time).filter(function(h,m,g){return!m||h!==g[m-1]})}function Lh(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=Dh(t);e.length?vi.output.html=dt("Hitbox staircase",e,t.settings.bpm):vi.output.html=null}const as="Hitbox Reverse Staircase",rs="Check for overlapping pre-swing hitbox with note hitbox during swinging.",ss=!0,Ei={name:as,description:rs,type:"note",order:{input:ot.NOTES_HITBOX_REVERSE_STAIR,output:lt.NOTES_HITBOX_REVERSE_STAIR},input:{enabled:ss,params:{},html:yt.create(as,rs,ss,function(){Ei.input.enabled=this.checked})},output:{html:null},run:Rh},xh=.03414823529,kh=.03414823529;function Th(t){const{bpm:e,njs:n}=t.settings,{noteContainer:a}=t.difficulty,s={},i={0:[],1:[]},l=[];for(let r=0,o=a.length;r<o;r++){if(a[r].type!=="note")continue;const u=a[r];s[u.data.color]&&Bt.next(u,s[u.data.color],e,i[u.data.color])&&(i[u.data.color]=[]);for(const h of i[(u.data.color+1)%2])if(h.type==="note"&&h.data.direction!==8){if(!(e.toRealTime(u.data.time)>e.toRealTime(h.data.time)+.01))continue;const m=h.data.getAngle()%90>15&&h.data.getAngle()%90<75;if(n.value<1.425/(60*(u.data.time-h.data.time)/e.value+(m?kh:xh))&&xa(u.data,h.data,[[15,1.5]])[1]){l.push(h);break}}s[u.data.color]=u,i[u.data.color].push(u)}return l.map(r=>r.data.time).filter(function(r,o,u){return!o||r!==u[o-1]})}function Rh(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=Th(t);e.length?Ei.output.html=dt("Hitbox reverse Staircase",e,t.settings.bpm):Ei.output.html=null}const os="Hitbox Inline",ls="Check for overlapping note hitbox for inline note.",cs=!0,wi={name:os,description:ls,type:"note",order:{input:ot.NOTES_HITBOX_INLINE,output:lt.NOTES_HITBOX_INLINE},input:{enabled:cs,params:{},html:yt.create(os,ls,cs,function(){wi.input.enabled=this.checked})},output:{html:null},run:Bh},Ih=0;function Ah(t){const{bpm:e,njs:n}=t.settings,{noteContainer:a}=t.difficulty,s={},i={0:[],1:[],3:[]},l=[];for(let r=0,o=a.length;r<o;r++){if(a[r].type!=="note")continue;const u=a[r];s[u.data.color]&&Bt.next(u,s[u.data.color],e,i[u.data.color])&&(i[u.data.color]=[]);for(const h of i[(u.data.color+1)%2])if(h.type==="note"&&n.value<1.425/(60*(u.data.time-h.data.time)/e.value+Ih)&&u.data.isInline(h.data)){l.push(u);break}s[u.data.color]=u,i[u.data.color].push(u)}return l.map(r=>r.data.time).filter(function(r,o,u){return!o||r!==u[o-1]})}function Bh(t){const e=Ah(t);e.length?wi.output.html=dt("Hitbox inline",e,t.settings.bpm):wi.output.html=null}const us="Hitbox Path",hs="Check for overlapping pre-swing note hitbox at same time.",ds=!0,Si={name:us,description:hs,type:"note",order:{input:ot.NOTES_HITBOX_PATH,output:lt.NOTES_HITBOX_PATH},input:{enabled:ds,params:{},html:yt.create(us,hs,ds,function(){Si.input.enabled=this.checked})},output:{html:null},run:Nh};function $h(t){const{bpm:e}=t.settings,{colorNotes:n}=t.difficulty.data,a=[];let s=0;for(let i=0,l=n.length;i<l;i++)if(!(e.toRealTime(n[i].time)<s+.01))for(let r=i+1;r<l&&!(e.toRealTime(n[r].time)>e.toRealTime(n[i].time)+.01);r++)n[i].color!==n[r].color&&((n[i].isHorizontal(n[r])||n[i].isVertical(n[r]))&&xa(n[i],n[r],[[45,1],[15,2]]).some(o=>o)||n[i].isDiagonal(n[r])&&xa(n[i],n[r],[[45,1],[15,1.5]]).some(o=>o))&&(a.push(n[i]),s=e.toRealTime(n[i].time));return a.map(i=>i.time).filter(function(i,l,r){return!l||i!==r[l-1]})}function Nh(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=$h(t);e.length?Si.output.html=dt("Hitbox path",e,t.settings.bpm):Si.output.html=null}const fs="Improper Window Snap",ms="Check for slanted window snap timing.",ps=!0,Ci={name:fs,description:ms,type:"note",order:{input:ot.NOTES_IMPROPER_WINDOW,output:lt.NOTES_IMPROPER_WINDOW},input:{enabled:ps,params:{},html:yt.create(fs,ms,ps,function(){Ci.input.enabled=this.checked})},output:{html:null},run:Oh};function Mh(t){const{bpm:e}=t.settings,{noteContainer:n}=t.difficulty,a={},s={0:[],1:[],3:[]},i=[];for(let l=0,r=n.length;l<r;l++){if(n[l].type!=="note")continue;const o=n[l];a[o.data.color]?Bt.next(o,a[o.data.color],e,s[o.data.color])?(a[o.data.color]=o,s[o.data.color]=[]):o.data.isSlantedWindow(a[o.data.color].data)&&o.data.time-a[o.data.color].data.time>=.001&&o.data.direction===a[o.data.color].data.direction&&o.data.direction!==8&&a[o.data.color].data.direction!==8&&i.push(a[o.data.color]):a[o.data.color]=o,s[o.data.color].push(o)}return i.map(l=>l.data.time).filter(function(l,r,o){return!r||l!==o[r-1]})}function Oh(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=Mh(t);e.length?Ci.output.html=dt("Improper window snap",e,t.settings.bpm):Ci.output.html=null}var Un={create:(t,e,n,a,...s)=>{const i=document.createElement(n);i.className=a;const l=document.createElement("select");l.className="input-toggle",l.id=t,s.forEach(o=>{const u=document.createElement("option");u.textContent=o.text,u.value=o.value,l.append(u)});const r=document.createElement("label");return r.htmlFor=t,r.innerHTML=`<span>${e}</span>`,i.append(r),i.append(l),i}},cl=(t=>(t.forehand="backhand",t.backhand="forehand",t))(cl||{});const Qn={0:{forehand:[1,3,6,7],backhand:[0,2,4,5]},1:{forehand:[1,2,6,7],backhand:[0,3,4,5]}},Ze={0:[0,0,90,90,45,-45,45,-45],1:[0,0,-90,-90,-45,45,-45,45]},gs={0:{forehand:[180,0,-90,90,-135,135,-45,45],backhand:[0,180,90,-90,45,-45,135,-135]},1:{forehand:[-180,0,-90,90,-135,135,-45,45],backhand:[0,-180,90,-90,45,-45,135,-135]}},An=class{constructor(t,e,n,a,s,i){this.color=e,this.warningThreshold=n,this.errorThreshold=a,this.allowedRotation=s,i&&i!=="neutral"?(this.state=i,this.rotation=0):(this.state=this.predictStartState(t,e),this.rotation=this.predictStartRotation(t,e)),this.position=this.predictStartPosition(t,e)}check(t,e){if(this.state==="neutral")return"none";if(!t.length)throw new Error("no notes were given");const n=t[0].data.time,a=this.color;let s=this.state,i=this.rotation;e.forEach(u=>{u.data.time-.001>n||(u.data.posY===0&&u.data.posX===(a?2:1)&&(s="backhand",i=0),u.data.posY===2&&u.data.posX===(a?2:1)&&(s="forehand",i=0))});let l,r=8;for(const u of t)u.type==="note"&&(u.data.direction!==8&&(r=u.data.direction),l&&r===8&&(r=Gr(u.data,l.data)),l=u);if(r===8)return"none";const o=gs[a][cl[s]][r];return(i>o?i-o:o-i)>180||o<An.CONSTRAINT_ROTATION[a][0]+this.errorThreshold||o>An.CONSTRAINT_ROTATION[a][1]-this.errorThreshold?"error":o<An.CONSTRAINT_ROTATION[a][0]+this.warningThreshold||o>An.CONSTRAINT_ROTATION[a][1]-this.warningThreshold||(i>o?i-o:o-i)>this.allowedRotation?"warning":"none"}next(t,e){if(this.check(t,e)!=="error")switch(this.state){case"forehand":{this.state="backhand";break}case"backhand":{this.state="forehand";break}case"neutral":{for(let l=0;l<t.length;l++){if(t[l].type!=="note")continue;const r=t[l];if(Qn[r.data.color].forehand.includes(r.data.direction)){this.state="backhand";break}if(Qn[r.data.color].backhand.includes(r.data.direction)){this.state="forehand";break}this.state==="neutral"&&r.data.direction===8&&(r.data.posY===0&&(this.state="backhand"),r.data.posY>0&&(this.state="forehand"))}break}}if(this.state==="neutral")throw new Error("parity unexpected input");const n=t[0].data.time,a=this.color;e.forEach(l=>{l.data.time-.001>n||(l.data.posY===0&&l.data.posX===(a?2:1)&&(this.state="forehand",this.rotation=0),l.data.posY===2&&l.data.posX===(a?2:1)&&(this.state="backhand",this.rotation=0))});let s,i=8;for(const l of t)l.type==="note"&&(l.data.direction!==8&&(i=l.data.direction),s&&i===8&&(i=Gr(l.data,s.data)),s=l);i!==8&&(this.rotation=gs[this.color][this.state][i])}predictStartState(t,e){let n="neutral";for(let a=0,s=t.length;a<s;a++){if(t[a].type==="bomb"&&(t[a].data.posY===0&&(t[a].data.posX,n="backhand"),t[a].data.posY===2&&(t[a].data.posX,n="forehand")),t[a].type!=="note")continue;let i=t[a];if(i.data.color!==Math.abs(e-1)&&i.data.color===e){if(n!=="neutral")break;const l=i.data.time;for(let r=a;r<t.length&&!(t[r].data.time>i.data.time+.001&&l<i.data.time+.001);r++){if(i=t[r],Qn[i.data.color].forehand.includes(i.data.direction))return"backhand";if(Qn[i.data.color].backhand.includes(i.data.direction))return"forehand";n==="neutral"&&i.data.direction===8&&(i.data.posY===0&&(n="backhand"),i.data.posY>0&&(n="forehand"))}break}}return n}predictStartRotation(t,e){let n=0;for(let a=0,s=t.length;a<s;a++){if(t[a].type!=="note")continue;let i=t[a];if(i.data.color===e&&i.data.color===e){const l=i.data.time;for(let r=a;r<t.length&&!(t[r].data.time>i.data.time+.001&&l<i.data.time+.001);r++){if(i=t[r],i.data.direction!==8)return Ze[i.data.color][i.data.direction];i.data.direction===8&&(i.data.posY===0&&(i.data.posX===0&&(n=Ze[i.data.color][6]),i.data.posX===3&&(n=Ze[i.data.color][7])),i.data.posY===1&&(i.data.posX===0&&(n=Ze[i.data.color][2]),i.data.posX===3&&(n=Ze[i.data.color][3])),i.data.posY===2&&(i.data.posX===0&&(n=Ze[i.data.color][4]),i.data.posX===3&&(n=Ze[i.data.color][5])))}break}}return n}predictStartPosition(t,e){return e?[-.5,1]:[.5,1]}};let Ta=An;Ta.CONSTRAINT_ROTATION=[[-155,195],[-195,155]];const ul="Parity Check",hl="Perform parity check.",dl=!1,fl=document.createElement("div");Un.create("input__tools-parity-rotation","Wrist rotation type: ","div","",{text:"Normal",value:"90"},{text:"Extended",value:"135"},{text:"Squid",value:"180"});Un.create("input__tools-parity-left","Left hand parity: ","div","",{text:"Auto",value:"auto"},{text:"Forehand",value:"forehand"},{text:"Backhand",value:"backhand"});Un.create("input__tools-parity-right","Right hand parity: ","div","",{text:"Auto",value:"auto"},{text:"Forehand",value:"forehand"},{text:"Backhand",value:"backhand"});fl.appendChild(yt.create(ul+" (EXPERIMENTAL)",hl,dl,function(){jn.input.enabled=this.checked}));const jn={name:ul,description:hl,type:"note",order:{input:ot.NOTES_PARITY,output:lt.NOTES_PARITY},input:{enabled:dl,params:{warningThres:90,errorThres:45,allowedRot:90},html:fl},output:{html:null},run:Fh};function Ph(t){const{bpm:e}=t.settings,{noteContainer:n}=t.difficulty,{warningThres:a,errorThres:s,allowedRot:i}=jn.input.params,l={},r={0:[],1:[]},o={0:[],1:[]},u={0:[],1:[]},h={0:new Ta(n,0,a,s,i),1:new Ta(n,1,a,s,i)},m={warning:[],error:[]};for(let g=0,c=n.length;g<c;g++){const p=n[g];if(p.type==="note"&&l[p.data.color]&&Bt.next(p,l[p.data.color],e,r[p.data.color])){switch(h[p.data.color].check(r[p.data.color],u[p.data.color])){case"warning":{m.warning.push(r[p.data.color][0].data.time);break}case"error":{m.error.push(r[p.data.color][0].data.time);break}}h[p.data.color].next(r[p.data.color],u[p.data.color]),u[p.data.color]=o[p.data.color],o[p.data.color]=[],r[p.data.color]=[]}p.type==="bomb"&&(o[0].push(p),o[1].push(p)),p.type==="note"&&(l[p.data.color]=p,r[p.data.color].push(p))}for(let g=0;g<2;g++)if(l[g])switch(h[g].check(r[g],o[g])){case"warning":{m.warning.push(r[g][0].data.time);break}case"error":{m.error.push(r[g][0].data.time);break}}return m}function Fh(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=Ph(t);e.warning=e.warning.filter(function(a,s,i){return!s||a!==i[s-1]}).sort((a,s)=>a-s),e.error=e.error.filter(function(a,s,i){return!s||a!==i[s-1]}).sort((a,s)=>a-s);const n=[];if(e.warning.length&&n.push(dt("Parity warning",e.warning,t.settings.bpm)),e.error.length&&n.push(dt("Parity error",e.error,t.settings.bpm)),n.length){const a=document.createElement("div");n.forEach(s=>a.append(s)),jn.output.html=a}else jn.output.html=null}const _s="Double-directional",bs="Check double-directional note swing (this may not mean parity break).",ys=!0,Di={name:_s,description:bs,type:"note",order:{input:ot.NOTES_DOUBLE_DIRECTIONAL,output:lt.NOTES_DOUBLE_DIRECTIONAL},input:{enabled:ys,params:{},html:yt.create(_s,bs,ys,function(){Di.input.enabled=this.checked})},output:{html:null},run:jh};function zh(t,e){const{bpm:n}=t,a=e.noteContainer,s={},i={},l={},r={0:[],1:[]},o=[];for(let u=0,h=a.length;u<h;u++){const m=a[u];m.type==="note"&&s[m.data.color]?Bt.next(m,s[m.data.color],n,r[m.data.color])?(l[m.data.color]&&(l[m.data.color]=null,i[m.data.color]=(i[m.data.color]+180)%360),zn(m.data,i[m.data.color],45,!0)&&o.push(m.data),m.data.direction===8?l[m.data.color]=m.data:i[m.data.color]=m.data.getAngle(),r[m.data.color]=[]):(l[m.data.color]&&zn(m.data,i[m.data.color],45,!0)&&(o.push(m.data),l[m.data.color]=null,i[m.data.color]=m.data.getAngle()),m.data.direction!==8&&(l[m.data.color]=null,i[m.data.color]=m.data.getAngle())):m.type==="note"&&(i[m.data.color]=m.data.getAngle()),m.type==="note"&&(s[m.data.color]=m,r[m.data.color].push(m)),m.type==="bomb"&&(m.data.posY===0&&(m.data.posX===1&&(i[0]=Jt[0],l[0]=null),m.data.posX===2&&(i[1]=Jt[0],l[1]=null)),m.data.posY===2&&(m.data.posX===1&&(i[0]=Jt[1],l[0]=null),m.data.posX===2&&(i[1]=Jt[1],l[1]=null)))}return o.map(u=>u.time).filter(function(u,h,m){return!h||u!==m[h-1]})}function jh(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=zh(t.settings,t.difficulty);e.length?Di.output.html=dt("Double-directional",e,t.settings.bpm):Di.output.html=null}const ml="Vision Block",pl="Check for vision block caused by center note.",gl=!0,_l=.1,bl=.5;let Vt;const vs={Easy:{min:.025,max:1.2},Normal:{min:.05,max:1},Hard:{min:.08,max:.75},Expert:{min:.1,max:.625},ExpertPlus:{min:.1,max:.5}},$t=document.createElement("div"),rn=document.createElement("input"),mr=document.createElement("label"),Ge=document.createElement("input"),pr=document.createElement("label"),Ve=document.createElement("input"),gr=document.createElement("label"),Te=document.createElement("input"),_r=document.createElement("label"),be=document.createElement("input"),br=document.createElement("label"),he=document.createElement("input"),yr=document.createElement("label");mr.textContent=" VB time specific ";mr.htmlFor="input__tools-vb-time-check";rn.id="input__tools-vb-time-check";rn.className="input-toggle";rn.type="radio";rn.name="input__tools-vb-spec";rn.value="time";rn.addEventListener("change",yl);pr.textContent=" VB difficulty specific ";pr.htmlFor="input__tools-vb-diff-check";Ge.id="input__tools-vb-diff-check";Ge.className="input-toggle";Ge.type="radio";Ge.checked=!0;Ge.name="input__tools-vb-spec";Ge.value="difficulty";Ge.addEventListener("change",yl);gr.textContent="min time (ms): ";gr.htmlFor="input__tools-vb-min-time";Ve.id="input__tools-vb-min-time";Ve.className="input-toggle input--small";Ve.type="number";Ve.min="0";Ve.value=P(_l*1e3,1).toString();Ve.addEventListener("change",Xh);_r.textContent=" (beat): ";_r.htmlFor="input__tools-vb-min-beat";Te.id="input__tools-vb-min-beat";Te.className="input-toggle input--small";Te.type="number";Te.min="0";Te.step="0.1";Te.addEventListener("change",Uh);br.textContent="max time (ms): ";br.htmlFor="input__tools-vb-max-time";be.id="input__tools-vb-max-time";be.className="input-toggle input--small";be.type="number";be.min="0";be.value=P(bl*1e3,1).toString();be.addEventListener("change",Yh);yr.textContent=" (beat): ";yr.htmlFor="input__tools-vb-max-beat";he.id="input__tools-vb-max-beat";he.className="input-toggle input--small";he.type="number";he.min="0";he.step="0.1";he.addEventListener("change",Gh);$t.appendChild(yt.create(ml,pl,gl,function(){ht.input.enabled=this.checked}));$t.appendChild(rn);$t.appendChild(mr);$t.appendChild(Ge);$t.appendChild(pr);$t.appendChild(document.createElement("br"));$t.appendChild(gr);$t.appendChild(Ve);$t.appendChild(_r);$t.appendChild(Te);$t.appendChild(document.createElement("br"));$t.appendChild(br);$t.appendChild(be);$t.appendChild(yr);$t.appendChild(he);const ht={name:ml,description:pl,type:"note",order:{input:ot.NOTES_VISION_BLOCK,output:lt.NOTES_VISION_BLOCK},input:{enabled:gl,params:{specific:"difficulty",minTime:_l,maxTime:bl},html:$t,adjustTime:Hh},output:{html:null},run:Wh};function Hh(t){Vt=t,Te.value=P(Vt.toBeatTime(ht.input.params.minTime),2).toString(),he.value=P(Vt.toBeatTime(ht.input.params.maxTime),2).toString()}function yl(){ht.input.params.specific=this.value}function Xh(){ht.input.params.minTime=Math.abs(parseFloat(this.value))/1e3,this.value=P(ht.input.params.minTime*1e3,1).toString(),Vt&&(Te.value=P(Vt.toBeatTime(ht.input.params.minTime),2).toString(),ht.input.params.minTime>ht.input.params.maxTime&&(ht.input.params.maxTime=ht.input.params.minTime,be.value=P(ht.input.params.maxTime*1e3,1).toString(),he.value=P(Vt.toBeatTime(ht.input.params.maxTime),2).toString()))}function Uh(){if(!Vt){this.value="0";return}const t=Math.abs(parseFloat(this.value))||1;ht.input.params.minTime=Vt.toRealTime(t),Ve.value=P(ht.input.params.minTime*1e3,1).toString(),this.value=P(t,2).toString(),ht.input.params.minTime>ht.input.params.maxTime&&(ht.input.params.maxTime=ht.input.params.minTime,be.value=P(ht.input.params.maxTime*1e3,1).toString(),he.value=P(Vt.toBeatTime(ht.input.params.maxTime),2).toString())}function Yh(){ht.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=P(ht.input.params.maxTime*1e3,1).toString(),Vt&&(he.value=P(Vt.toBeatTime(ht.input.params.maxTime),2).toString())}function Gh(){if(!Vt){this.value="0";return}const t=Math.abs(parseFloat(this.value))||1;ht.input.params.maxTime=Vt.toRealTime(t),be.value=P(ht.input.params.maxTime*1e3,1).toString(),this.value=P(t,2).toString()}function Vh(t){const{bpm:e,njs:n}=t.settings,a=t.difficulty.data.getNoteContainer().filter(g=>g.type!=="slider"),{minTime:s,maxTime:i,specific:l}=ht.input.params,r=l==="time"?e.toBeatTime(s):e.toBeatTime(vs[t.difficulty.difficulty].min),o=l==="time"?e.toBeatTime(i):Math.min(n.hjd,e.toBeatTime(vs[t.difficulty.difficulty].max));let u=null,h=null;const m=[];for(let g=0,c=a.length;g<c;g++){const p=a[g];u&&(p.data.time-u.data.time>=r&&p.data.time-u.data.time<=o?p.data.posX<2&&m.push(p):p.data.time-u.data.time>o&&(u=null)),h&&(p.data.time-h.data.time>=r&&p.data.time-h.data.time<=o?p.data.posX>1&&m.push(p):p.data.time-h.data.time>o&&(h=null)),p.data.posY===1&&p.data.posX===1&&(u=p),p.data.posY===1&&p.data.posX===2&&(h=p)}return m.map(g=>g.data.time).filter(function(g,c,p){return!c||g!==p[c-1]})}function Wh(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=Vh(t);e.length?ht.output.html=dt("Vision block",e,t.settings.bpm):ht.output.html=null}const Es="Stacked Note",ws="Look for stacked note.",Ss=!0,Li={name:Es,description:ws,type:"note",order:{input:ot.NOTES_STACKED_NOTE,output:lt.NOTES_STACKED_NOTE},input:{enabled:Ss,params:{},html:yt.create(Es,ws,Ss,function(){Li.input.enabled=this.checked})},output:{html:null},run:Jh};function qh(t,e){const{bpm:n}=t,{colorNotes:a}=e.data,s=[];let i=0;for(let l=0,r=a.length;l<r;l++)if(!(n.toRealTime(a[l].time)<i+.01))for(let o=l+1;o<r&&!(n.toRealTime(a[o].time)>n.toRealTime(a[l].time)+.01);o++)a[o].isInline(a[l])&&(s.push(a[l]),i=n.toRealTime(a[l].time));return s.map(l=>l.time).filter(function(l,r,o){return!r||l!==o[r-1]})}function Zh(t,e){const{bpm:n,njs:a}=t,{bombNotes:s}=e.data,i=[];for(let l=0,r=s.length;l<r;l++)for(let o=l+1;o<r&&!(n.toRealTime(s[o].time)>n.toRealTime(s[l].time)+1);o++)s[l].isInline(s[o])&&(a.value<n.value/(120*(s[o].time-s[l].time))||n.toRealTime(s[o].time)<n.toRealTime(s[l].time)+.02)&&i.push(s[l]);return i.map(l=>l.time).filter(function(l,r,o){return!r||l!==o[r-1]})}function Jh(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=qh(t.settings,t.difficulty),n=Zh(t.settings,t.difficulty),a=[];if(e.length&&a.push(dt("Stacked note",e,t.settings.bpm)),n.length&&a.push(dt("Stacked bomb",n,t.settings.bpm)),a.length){const s=document.createElement("div");a.forEach(i=>s.append(i)),Li.output.html=s}else Li.output.html=null}const Cs=[1,1,1],Ds={1:"Indistinguishable",5:"Hardly perceivable",10:"Close apparent",20:"Mildly similar",40:"Different",90:"Discernible",100:"Opposite"},Ls=(t,e)=>{var s;let n=(s=Object.keys(t).find(i=>parseFloat(i)>=e))!=null?s:"100",a=parseFloat(n);return t[a]},xs="Color Check",ks="Compare note color with other colored note and the arrow on itself.",Ts=!0,xi={name:xs,description:ks,type:"note",order:{input:ot.NOTES_COLOR_CHECK,output:lt.NOTES_COLOR_CHECK},input:{enabled:Ts,params:{},html:yt.create(xs+" (EXPERIMENTAL)",ks,Ts,function(){xi.input.enabled=this.checked})},output:{html:null},run:td};function Kh(t){var a,s,i,l,r,o,u,h;const e=(l=(s=(a=t.difficulty)==null?void 0:a.info._customData)==null?void 0:s._colorLeft)!=null?l:Ut[(i=Xt[t.info._environmentName])!=null?i:"The First"]._colorLeft,n=(h=(o=(r=t.difficulty)==null?void 0:r.info._customData)==null?void 0:o._colorRight)!=null?h:Ut[(u=Xt[t.info._environmentName])!=null?u:"The First"]._colorRight;return e&&n?Vi(ci(e),ci(n)):100}function Qh(t){var i,l,r,o,u,h,m,g;let e=100,n=100;const a=(o=(l=(i=t.difficulty)==null?void 0:i.info._customData)==null?void 0:l._colorLeft)!=null?o:Ut[(r=Xt[t.info._environmentName])!=null?r:"The First"]._colorLeft,s=(g=(h=(u=t.difficulty)==null?void 0:u.info._customData)==null?void 0:h._colorRight)!=null?g:Ut[(m=Xt[t.info._environmentName])!=null?m:"The First"]._colorRight;return a&&(e=Vi(Cs,ci(a))),s&&(n=Vi(Cs,ci(s))),Math.min(e,n)}function td(t){var s,i,l,r;if(!((i=(s=t.difficulty)==null?void 0:s.info._customData)!=null&&i._colorLeft)&&!((r=(l=t.difficulty)==null?void 0:l.info._customData)!=null&&r._colorRight))return;const e=Kh(t),n=Qh(t),a=[];if(e<=20&&a.push(ct(`${Ls(Ds,e)} note color (dE${P(e,1)})`,"suggest change to better differentiate between 2 note colour")),n<=20&&a.push(ct(`${Ls(Ds,n)} arrow note color (dE${P(n,1)})`,"may be difficult to see the arrow")),a.length){const o=document.createElement("div");a.forEach(u=>o.append(u)),xi.output.html=o}else xi.output.html=null}var Rs=Object.freeze(Object.defineProperty({__proto__:null,effectiveBPM:Yt,acceptablePrec:fn,varySwing:yi,slowSlider:Kt,inlineAngle:le,shradoAngle:Gt,speedPause:ce,hitboxStair:vi,hitboxReverseStair:Ei,hitboxInline:wi,hitboxPath:Si,improperWindow:Ci,parity:jn,doubleDirectional:Di,visionBlock:ht,stackedNote:Li,colorCheck:xi},Symbol.toStringTag,{value:"Module"}));const Is="<15ms Obstacle",As=`Look for obstacle with inadequate duration.
This causes player to not take damage when in collision with obstacle.`,Bs=!0,Hn={name:Is,description:As,type:"obstacle",order:{input:ot.OBSTACLES_SHORT,output:lt.OBSTACLES_SHORT},input:{enabled:Bs,params:{minDur:.015},html:yt.create(Is,As,Bs,function(){Hn.input.enabled=this.checked})},output:{html:null},run:nd};function ed(t){const{obstacles:e}=t.difficulty.data,{bpm:n}=t.settings,{minDur:a}=Hn.input.params,s=n.toBeatTime(a),i=[];let l=ge.create(),r=ge.create(),o=ge.create(),u=ge.create();return e.forEach(h=>{h.posY===0&&h.height>2&&h.duration>0?h.width>2||h.width>1&&h.posX===1?(h.isLonger(l)&&(h.duration<s&&i.push(h),l=h),h.isLonger(r)&&(h.duration<s&&i.push(h),r=h)):h.width===2?h.posX===0?h.isLonger(l)&&(h.duration<s&&i.push(h),l=h):h.posX===2&&h.isLonger(r)&&(h.duration<s&&i.push(h),r=h):h.width===1&&(h.posX===1?h.isLonger(l)&&(h.duration<s&&i.push(h),l=h):h.posX===2&&h.isLonger(r)&&(h.duration<s&&i.push(h),r=h)):h.posY===2&&h.height>2&&h.duration>0&&(h.width>2||h.width>1&&h.posX===1?(h.isLonger(o)&&(h.duration<s&&h.isLonger(l,s)&&h.isLonger(o,s)&&i.push(h),o=h),h.isLonger(u)&&(h.duration<s&&h.isLonger(r,s)&&h.isLonger(u,s)&&i.push(h),u=h)):h.width===2?h.posX===0?h.isLonger(o)&&(h.duration<s&&h.isLonger(l,s)&&h.isLonger(o,s)&&i.push(h),o=h):h.posX===2&&h.isLonger(u)&&(h.duration<s&&h.isLonger(r,s)&&h.isLonger(u,s)&&i.push(h),u=h):h.width===1&&(h.posX===1?h.isLonger(o)&&(h.duration<s&&h.isLonger(l,s)&&h.isLonger(o,s)&&i.push(h),o=h):h.posX===2&&h.isLonger(u)&&(h.duration<s&&h.isLonger(r,s)&&h.isLonger(u,s)&&i.push(h),u=h)))}),i.map(h=>h.time).filter(function(h,m,g){return!m||h!==g[m-1]})}function nd(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=ed(t);e.length?Hn.output.html=dt("<15ms obstacle",e,t.settings.bpm):Hn.output.html=null}const vl="2-wide Center Obstacle",El="Look for 2-wide center obstacle including obstacles that are relatively close to each other.",wl=!0,Sl=.25;let bn;const Cn=document.createElement("div"),We=document.createElement("input"),vr=document.createElement("label"),Re=document.createElement("input"),Er=document.createElement("label");vr.textContent="recovery time (ms): ";vr.htmlFor="input__tools-2wide-wall-time";We.id="input__tools-2wide-wall-time";We.className="input-toggle input--small";We.type="number";We.min="0";We.value=P(Sl*1e3,1).toString();We.addEventListener("change",ad);Er.textContent=" (beat): ";Er.htmlFor="input__tools-2wide-wall-beat";Re.id="input__tools-2wide-wall-beat";Re.className="input-toggle input--small";Re.type="number";Re.min="0";Re.step="0.1";Re.addEventListener("change",rd);Cn.appendChild(yt.create(vl,El,wl,function(){Qt.input.enabled=this.checked}));Cn.appendChild(vr);Cn.appendChild(We);Cn.appendChild(Er);Cn.appendChild(Re);const Qt={name:vl,description:El,type:"obstacle",order:{input:ot.OBSTACLES_CENTER,output:lt.OBSTACLES_CENTER},input:{enabled:wl,params:{recovery:Sl},html:Cn,adjustTime:id},output:{html:null},run:od};function id(t){bn=t,Re.value=P(bn.toBeatTime(Qt.input.params.recovery),2).toString()}function ad(){Qt.input.params.recovery=Math.abs(parseFloat(this.value))/1e3,this.value=P(Qt.input.params.recovery*1e3,1).toString(),bn&&(Re.value=P(bn.toBeatTime(Qt.input.params.recovery),2).toString())}function rd(){if(!bn){this.value="0";return}let t=P(Math.abs(parseFloat(this.value)),2)||1;Qt.input.params.recovery=bn.toRealTime(t),We.value=P(Qt.input.params.recovery*1e3,1).toString(),this.value=t.toString()}function sd(t){const{obstacles:e}=t.difficulty.data,{bpm:n}=t.settings,{recovery:a}=Qt.input.params,s=[];let i=ge.create(),l=ge.create();return e.forEach(r=>{r.posY<2&&r.height>1&&(r.width>2&&(s.push(r),r.isLonger(i)&&(i=r),r.isLonger(l)&&(l=r)),r.width===2&&(r.posX===0&&r.isLonger(i)&&(n.toRealTime(r.time)>n.toRealTime(l.time)-a&&n.toRealTime(r.time)<n.toRealTime(l.time+l.duration)+a&&s.push(r),i=r),r.posX===1&&(s.push(r),r.isLonger(i)&&(i=r),r.isLonger(l)&&(l=r)),r.posX===2&&r.isLonger(l)&&(n.toRealTime(r.time)>n.toRealTime(i.time)-a&&n.toRealTime(r.time)<n.toRealTime(i.time+i.duration)+a&&s.push(r),l=r)),r.width===1&&(r.posX===1&&r.isLonger(i)&&(n.toRealTime(r.time)>n.toRealTime(l.time)-a&&n.toRealTime(r.time)<n.toRealTime(l.time+l.duration)+a&&s.push(r),i=r),r.posX===2&&r.isLonger(l)&&(n.toRealTime(r.time)>n.toRealTime(i.time)-a&&n.toRealTime(r.time)<n.toRealTime(i.time+i.duration)+a&&s.push(r),l=r)))}),s.map(r=>r.time).filter(function(r,o,u){return!o||r!==u[o-1]})}function od(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=sd(t),{recovery:n}=Qt.input.params;e.length?Qt.output.html=dt(`2-wide center obstacle (<${P(n*1e3)}ms)`,e,t.settings.bpm):Qt.output.html=null}const $s="Zero Obstacle",Ns="Look for obstacle with zero value.",Ms=!0,ki={name:$s,description:Ns,type:"obstacle",order:{input:ot.OBSTACLES_ZERO,output:lt.OBSTACLES_ZERO},input:{enabled:Ms,params:{},html:yt.create($s,Ns,Ms,function(){ki.input.enabled=this.checked})},output:{html:null},run:cd};function ld(t){const{obstacles:e}=t.difficulty.data;return e.filter(n=>n.hasZero()).map(n=>n.time)}function cd(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=ld(t);e.length?ki.output.html=dt("Zero value obstacle",e,t.settings.bpm):ki.output.html=null}const Os="Negative obstacle",Ps="Look for obstacle with negative value.",Fs=!0,Ti={name:Os,description:Ps,type:"obstacle",order:{input:ot.OBSTACLES_NEGATIVE,output:lt.OBSTACLES_NEGATIVE},input:{enabled:Fs,params:{},html:yt.create(Os,Ps,Fs,function(){Ti.input.enabled=this.checked})},output:{html:null},run:hd};function ud(t){var n,a,s,i;const{obstacles:e}=t.difficulty.data;return((a=(n=t.difficulty.info._customData)==null?void 0:n._requirements)==null?void 0:a.includes("Mapping Extensions"))||((i=(s=t.difficulty.info._customData)==null?void 0:s._requirements)==null?void 0:i.includes("Noodle Extensions"))?[]:e.filter(l=>l.hasNegative()).map(l=>l.time)}function hd(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=ud(t);e.length?Ti.output.html=dt("Negative obstacle",e,t.settings.bpm):Ti.output.html=null}var zs=Object.freeze(Object.defineProperty({__proto__:null,shortObstacle:Hn,centerObstacle:Qt,zeroObstacle:ki,negativeObstacle:Ti},Symbol.toStringTag,{value:"Module"}));const js="Insufficient Lighting Event",Hs="Check if there is enough light event.",Xs=!0,Ri={name:js,description:Hs,type:"event",order:{input:ot.EVENTS_INSUFFICIENT_LIGHT,output:lt.EVENTS_INSUFFICIENT_LIGHT},input:{enabled:Xs,params:{},html:yt.create(js,Hs,Xs,function(){Ri.input.enabled=this.checked})},output:{html:null},run:fd},dd=t=>{let e=0;for(let n=t.length-1;n>=0;n--)if(t[n].isLightEvent()&&!t[n].isOff()&&(e++,e>10))return!0;return!1};function fd(t){if(!t.difficulty){console.error("Something went wrong!");return}dd(t.difficulty.data.basicBeatmapEvents)?Ri.output.html=null:Ri.output.html=ct("Insufficient light event")}const Us="Unlit Bomb",Ys="Check for lighting around bomb.",Gs=!0,Ii={name:Us,description:Ys,type:"event",order:{input:ot.EVENTS_UNLIT_BOMB,output:lt.EVENTS_UNLIT_BOMB},input:{enabled:Gs,params:{},html:yt.create(Us,Ys,Gs,function(){Ii.input.enabled=this.checked})},output:{html:null},run:pd},md=(t,e,n,a)=>{var m,g,c,p;if(!e.length)return[];const s=[],i=(g=(m=Be[a])==null?void 0:m[0])!=null?g:Be.DefaultEnvironment[0],l=e.filter(_=>_.isLightEvent()&&i.includes(_.type)).sort((_,y)=>_.type-y.type),r={0:{state:"off",time:0,fadeTime:0},1:{state:"off",time:0,fadeTime:0},2:{state:"off",time:0,fadeTime:0},3:{state:"off",time:0,fadeTime:0},4:{state:"off",time:0,fadeTime:0},6:{state:"off",time:0,fadeTime:0},7:{state:"off",time:0,fadeTime:0},10:{state:"off",time:0,fadeTime:0},11:{state:"off",time:0,fadeTime:0}},o={};i.forEach(_=>o[_]=[[0,!1]]);const u=n.toBeatTime(1),h=n.toBeatTime(.25);for(let _=0,y=l.length;_<y;_++){const b=l[_];if((b.isOn()||b.isFlash())&&r[b.type].state!=="on"){r[b.type]={state:"on",time:b.time,fadeTime:0};const v=o[b.type].find(S=>S[0]>=b.time);v?(v[0]=b.time,v[1]=!0):o[b.type].push([b.time,!0])}if(b.isFade()){r[b.type]={state:"off",time:b.time,fadeTime:u};const v=o[b.type].find(S=>S[0]>=b.time);v?(v[0]=b.time,v[1]=!0):o[b.type].push([b.time,!0]),o[b.type].push([b.time+u,!1])}(((c=b==null?void 0:b.floatValue)!=null?c:1)<.25||b.isOff()||((p=b.customData)==null?void 0:p._color)&&(typeof b.customData._color[3]=="number"&&b.customData._color[3]<.25||Math.max(b.customData._color[0],b.customData._color[1],b.customData._color[2])<.25))&&r[b.type].state!=="off"&&(r[b.type]={state:"off",time:b.time,fadeTime:r[b.type].state==="on"?h:Math.min(h,r[b.type].fadeTime)},o[b.type].push([b.time+(r[b.type].state==="on"?h:Math.min(h,r[b.type].fadeTime)),!1]))}for(const _ in o)o[_].reverse();for(let _=0,y=t.length,b=!1;_<y;_++){const v=t[_];b=!1;for(const S in o){const L=o[S].find(D=>D[0]<=v.time);L&&(b=b||L[1])}b||s.push(v)}return s.map(_=>_.time).filter(function(_,y,b){return!y||_!==b[y-1]})};function pd(t){if(!t.difficulty){console.error("Something went wrong!");return}const e=md(t.difficulty.data.bombNotes,t.difficulty.data.basicBeatmapEvents,t.settings.bpm,t.info._environmentName);e.length?Ii.output.html=dt("Unlit bomb",e,t.settings.bpm):Ii.output.html=null}var Vs=Object.freeze(Object.defineProperty({__proto__:null,insufficientLight:Ri,unlitBomb:Ii},Symbol.toStringTag,{value:"Module"}));const gd="Hot Start",_d="Check for first interactive object starting at minimum 1.5s.",bd=!0,Cl=1.5,wr=document.createElement("div"),qe=document.createElement("input"),Sr=document.createElement("label");Sr.textContent="Hot start (s): ";Sr.htmlFor="input__tools-hot-start";qe.id="input__tools-hot-start";qe.className="input-toggle input--small";qe.type="number";qe.min="0";qe.step="0.1";qe.value=Cl.toString();qe.addEventListener("change",yd);wr.appendChild(Sr);wr.appendChild(qe);const un={name:gd,description:_d,type:"other",order:{input:ot.OTHERS_HOT_START,output:lt.OTHERS_HOT_START},input:{enabled:bd,params:{time:Cl},html:wr},output:{html:null},run:vd};function yd(){un.input.params.time=P(Math.abs(parseFloat(this.value)),3),this.value=un.input.params.time.toString()}function vd(t){if(!t.difficulty){console.error("Something went wrong!");return}const{time:e}=un.input.params,n=t.settings.bpm.toRealTime(t.difficulty.data.getFirstInteractiveTime());n<e?un.output.html=ct("Hot start",`${P(n,2)}s`):un.output.html=null}const Ed="Difficulty Label Check",wd="For ranking purpose, check difficulty label to fit rankability criteria.",Sd=!0,Ra={name:Ed,description:wd,type:"other",order:{input:ot.OTHERS_DIFFICULTY_LABEL,output:lt.OTHERS_DIFFICULTY_LABEL},input:{enabled:Sd,params:{}},output:{html:null},run:Cd};function Cd(t){var n;if(!t.difficulty){console.error("Something went wrong!");return}const e=(n=t.difficulty.info._customData)==null?void 0:n._difficultyLabel;e&&e.length>30?Ra.output.html=ct(`Difficulty label is too long (${e.length} characters)`,"exceeded 30 max characters by ranking criteria"):Ra.output.html=null}const Dd="NJS Check",Ld="Check note jump speed for suitable value.",xd=!0,Ia={name:Dd,description:Ld,type:"other",order:{input:ot.OTHERS_NJS,output:lt.OTHERS_NJS},input:{enabled:xd,params:{}},output:{html:null},run:kd};function kd(t){if(!t.difficulty){console.error("Something went wrong!");return}const{njs:e,bpm:n}=t.settings,a=[];if(t.difficulty.info._noteJumpMovementSpeed===0&&a.push(ct("Unset NJS","fallback NJS is used")),e.value>23&&a.push(ct(`NJS is too high (${P(e.value,2)})`,"use lower whenever necessary")),e.jd<18&&a.push(ct("Very low jump distance",`${P(e.jd,2)}`)),e.jd>36&&a.push(ct("Very high jump distance",`${P(e.jd,2)}`)),e.jd>e.calcJumpDistanceOptimalHigh()&&a.push(ct(`High jump distance warning (>${P(e.calcJumpDistanceOptimalHigh(),2)})`,"NJS may be uncomfortable to play")),n.toRealTime(e.hjd)<.45&&a.push(ct(`Very quick reaction time (${P(n.toRealTime(e.hjd)*1e3)}ms)`,"may lead to suboptimal gameplay")),e.calcHalfJumpDurationRaw()+e.offset<e.hjdMin&&a.push(ct("Unnecessary negative offset",`will not drop below ${e.hjdMin}`)),a.length){const s=document.createElement("div");a.forEach(i=>s.append(i)),Ia.output.html=s}else Ia.output.html=null}const Ws="Outside Playable Object",qs="Look for any object starting before and after song timer.",Zs=!0,Ai={name:Ws,description:qs,type:"other",order:{input:ot.OTHERS_OUTSIDE_PLAYABLE,output:lt.OTHERS_OUTSIDE_PLAYABLE},input:{enabled:Zs,params:{},html:yt.create(Ws,qs,Zs,function(){Ai.input.enabled=this.checked})},output:{html:null},run:Td};function Td(t){if(!t.difficulty){console.error("Something went wrong!");return}const{bpm:e,audioDuration:n}=t.settings,{colorNotes:a,bombNotes:s,obstacles:i,basicBeatmapEvents:l,sliders:r,burstSliders:o}=t.difficulty.data,u=[];if(n){let h=e.toBeatTime(n);a.length&&a[0].time<0&&u.push(ct("Note(s) before start time",`${P(a[0].time,3)} (${kt(e.toRealTime(a[0].time))}`)),s.length&&s[0].time<0&&u.push(ct("Bomb(s) before start time",`${P(s[0].time,3)} (${kt(e.toRealTime(s[0].time))}`)),r.length&&r[0].time<0&&u.push(ct("Arc(s) before start time",`${P(r[0].time,3)} (${kt(e.toRealTime(r[0].time))}`)),o.length&&o[0].time<0&&u.push(ct("Chain(s) before start time",`${P(o[0].time,3)} (${kt(e.toRealTime(o[0].time))}`)),i.length&&i[0].time<0&&u.push(ct("Obstacle(s) before start time",`${P(i[0].time,3)} (${kt(e.toRealTime(i[0].time))}`)),l.length&&l[0].time<0&&u.push(ct("Event(s) before start time",`${P(l[0].time,3)} (${kt(e.toRealTime(l[0].time))}`)),a.length&&a[a.length-1].time>h&&u.push(ct("Note(s) after end time",`${P(a[a.length-1].time,3)} (${kt(e.toRealTime(a[a.length-1].time))})`)),s.length&&s[s.length-1].time>h&&u.push(ct("Bomb(s) after end time",`${P(s[s.length-1].time,3)} (${kt(e.toRealTime(s[s.length-1].time))})`)),r.length&&r[r.length-1].time>h&&u.push(ct("Arc(s) after end time",`${P(r[r.length-1].time,3)} (${kt(e.toRealTime(r[r.length-1].time))})`)),o.length&&o[o.length-1].time>h&&u.push(ct("Chain(s) after end time",`${P(o[o.length-1].time,3)} (${kt(e.toRealTime(o[o.length-1].time))})`)),i.length&&i[i.length-1].time>h&&u.push(ct("Obstacle(s) after end time",`${P(i[i.length-1].time,3)} (${kt(e.toRealTime(i[i.length-1].time))})`)),l.length&&l[l.length-1].time>h&&u.push(ct("Event(s) after end time",`${P(l[l.length-1].time,3)} (${kt(e.toRealTime(l[l.length-1].time))})`))}if(u.length){const h=document.createElement("div");u.forEach(m=>h.append(m)),Ai.output.html=h}else Ai.output.html=null}const Js="Invalid Object",Ks="Validate beatmap object to be compatible with vanilla (ignores for modded).",Qs=!0,Bi={name:Js,description:Ks,type:"other",order:{input:ot.OTHERS_INVALID_OBJECT,output:lt.OTHERS_INVALID_OBJECT},input:{enabled:Qs,params:{},html:yt.create(Js,Ks,Qs,function(){Bi.input.enabled=this.checked})},output:{html:null},run:Rd};function Rd(t){var p,_,y,b;if(!t.difficulty){console.error("Something went wrong!");return}const{colorNotes:e,bombNotes:n,obstacles:a,basicBeatmapEvents:s,sliders:i,burstSliders:l}=t.difficulty.data;let r=[],o=[],u=[],h=[],m=[];(_=(p=t.difficulty.info._customData)==null?void 0:p._requirements)!=null&&_.includes("Mapping Extensions")||((b=(y=t.difficulty.info._customData)==null?void 0:y._requirements)!=null&&b.includes("Noodle Extensions")?(r=e.filter(v=>v.hasMappingExtensions()).map(v=>v.time),o=a.filter(v=>v.hasMappingExtensions()).map(v=>v.time),u=n.filter(v=>v.hasMappingExtensions()).map(v=>v.time),h=i.filter(v=>v.hasMappingExtensions()).map(v=>v.time),m=l.filter(v=>v.hasMappingExtensions()).map(v=>v.time)):(r=e.filter(v=>!v.isValid()).map(v=>v.time),o=a.filter(v=>!v.isValid()).map(v=>v.time),u=n.filter(v=>!v.isValid()).map(v=>v.time),h=i.filter(v=>!v.isValid()).map(v=>v.time),m=l.filter(v=>!v.isValid()).map(v=>v.time)));const g=s.filter(v=>!v.isValid()).map(v=>v.time),c=[];if(r.length&&c.push(dt("Invalid note",r,t.settings.bpm)),u.length&&c.push(dt("Invalid bomb",u,t.settings.bpm)),h.length&&c.push(dt("Invalid arc",h,t.settings.bpm)),m.length&&c.push(dt("Invalid chain",m,t.settings.bpm)),o.length&&c.push(dt("Invalid obstacle",o,t.settings.bpm)),g.length&&c.push(dt("Invalid event",g,t.settings.bpm)),c.length){const v=document.createElement("div");c.forEach(S=>v.append(S)),Bi.output.html=v}else Bi.output.html=null}var to=Object.freeze(Object.defineProperty({__proto__:null,hotStart:un,difficultyLabel:Ra,njs:Ia,outsidePlayable:Ai,invalidObject:Bi},Symbol.toStringTag,{value:"Module"}));const me=class{constructor(){}};let Ie=me;Ie.getNote=()=>Object.keys(Rs).map(t=>Rs[t]);Ie.getObstacle=()=>Object.keys(zs).map(t=>zs[t]);Ie.getEvent=()=>Object.keys(Vs).map(t=>Vs[t]);Ie.getOther=()=>Object.keys(to).map(t=>to[t]);Ie.getGeneral=()=>Object.keys(qr).map(t=>qr[t]);Ie.getDifficulty=()=>[...me.getNote(),...me.getObstacle(),...me.getEvent(),...me.getOther()];Ie.getAll=()=>[...me.getNote(),...me.getObstacle(),...me.getEvent(),...me.getOther(),...me.getGeneral()];const en=t=>`[analyzer::${t}]`,Dl=Ie.getAll().sort((t,e)=>t.order.input-e.order.input),Ll=[...Dl].sort((t,e)=>t.order.output-e.order.output),xl=()=>{at.analysis={general:{html:null},map:[]}},Id=()=>{var l,r;const t=at.beatmapInfo;if(!t){nt.error(en("runGeneral"),"Could not analyse, missing map info");return}at.analysis||xl();const e=(l=at.analysis)==null?void 0:l.general,n=_e.create(t._beatsPerMinute),a=$e.create(n),s={bpm:n,njs:a,audioDuration:(r=at.duration)!=null?r:null,mapDuration:0};nt.info(en("runGeneral"),"Analysing general");const i=[];Ll.filter(o=>o.type==="general").forEach(o=>{if(o.input.enabled)try{o.run({settings:s,difficulties:at.beatmapDifficulty,info:t}),o.output.html&&i.push(o.output.html)}catch(u){nt.error(en("runGeneral"),u)}}),e&&(e.html=i)},kl=(t,e)=>{var u,h,m,g,c,p,_,y;const n=at.beatmapInfo;if(!n){nt.error(en("runDifficulty"),"Could not analyse, missing map info");return}at.analysis||xl();const a=(u=at.beatmapDifficulty)==null?void 0:u.find(b=>b.characteristic===t&&b.difficulty===e);if(!a){nt.error(en("runDifficulty"),"Could not analyse, missing map data");return}const s=(h=at.analysis)==null?void 0:h.map.find(b=>b.difficulty===e&&b.mode===t),i=_e.create(n._beatsPerMinute,((m=a.data.customData)==null?void 0:m._BPMChanges)||((g=a.data.customData)==null?void 0:g._bpmChanges)||((c=a.data.customData)==null?void 0:c.BPMChanges),(p=a.info._customData)==null?void 0:p._editorOffset),l=$e.create(i,a.info._noteJumpMovementSpeed,a.info._noteJumpStartBeatOffset),r={bpm:i,njs:l,audioDuration:(_=at.duration)!=null?_:null,mapDuration:i.toRealTime(a.data.getLastInteractiveTime())};nt.info(en("runDifficulty"),`Analysing ${t} ${e}`);const o=[];Ll.filter(b=>b.type!=="general").forEach(b=>{if(b.input.enabled)try{b.run({settings:r,difficulty:a,info:n}),b.output.html&&o.push(b.output.html)}catch(v){nt.error(en("runDifficulty"),v)}}),s?s.html=o:(y=at.analysis)==null||y.map.push({mode:t,difficulty:e,html:o})},Ad=t=>{Ie.getDifficulty().sort((n,a)=>n.order.output-a.order.output).forEach(n=>{n.input.adjustTime&&n.input.adjustTime(t)})},Bd=()=>{var t;(t=at.beatmapDifficulty)==null||t.forEach(e=>kl(e.characteristic,e.difficulty))};var yn={toolListInput:Dl,runGeneral:Id,runDifficulty:kl,adjustTime:Ad,applyAll:Bd};const De="UI Tools: ",Ne=document.querySelectorAll(".tools__select-mode"),Me=document.querySelectorAll(".tools__select-difficulty"),$d=document.querySelectorAll(".difficulty__label"),Tl=document.querySelector(".tools__note-content"),Rl=document.querySelector(".tools__obstacle-content"),Il=document.querySelector(".tools__event-content"),Al=document.querySelector(".tools__other-content"),we=document.querySelector(".tools__output-diff"),Se=document.querySelector(".tools__output-general"),eo=document.querySelector(".tools__apply-this"),no=document.querySelector(".tools__apply-all");if(!Tl||!Rl||!Il||!Al)throw new Error(De+"missing content element");if(!we||!Se)throw new Error(De+"missing output element");if(eo&&no)eo.addEventListener("click",Hd),no.addEventListener("click",Xd);else throw new Error(De+"missing apply element");Ne.forEach(t=>t.addEventListener("change",zd));Me.forEach(t=>t.addEventListener("change",jd));const Nd=()=>{var e;const t=(e=at.analysis)==null?void 0:e.general;if(!t){Se.textContent="ERROR: could not find analysis for general";return}if(!t.html){Se.textContent="ERROR: could not find HTML for general";return}Se.innerHTML="",t.html.forEach(n=>Se.appendChild(n)),Se.firstChild||(Se.textContent="No issues found.")},Yn=(t,e)=>{var a;if(!t&&!e&&(t=Ne[0].value,e=Me[0].value),!t||!e)throw new Error(De+"something went wrong!");we.innerHTML="";const n=(a=at.analysis)==null?void 0:a.map.find(s=>s.difficulty===e&&s.mode===t);if(!n){we.textContent="ERROR: could not find analysis for "+t+" "+e;return}if(!n.html){we.textContent="ERROR: could not find HTML for "+t+" "+e;return}n.html.forEach(s=>we.appendChild(s)),we.firstChild||(we.textContent="No issues found.")},Pi=t=>{$d.forEach(e=>e.textContent=t)},Bl=t=>{if(!t)return;Me.forEach(n=>{for(let a=n.options.length-1;a>=0;a--)n.remove(a)});let e=!0;for(let n=t._difficultyBeatmaps.length-1;n>=0;n--){const a=t._difficultyBeatmaps[n];Me.forEach(s=>{var l,r,o,u;const i=document.createElement("option");if(i.value=a._difficulty,i.textContent=Pn[a._difficulty]+((l=a._customData)!=null&&l._difficultyLabel?" -- "+((r=a._customData)==null?void 0:r._difficultyLabel):""),e){const h=(o=at.beatmapDifficulty)==null?void 0:o.find(m=>m.difficulty===a._difficulty&&m.characteristic===t._beatmapCharacteristicName);if(!h)throw new Error("missing _mapSetData");Fn.setDiffInfoTable(h),Pi(((u=a._customData)==null?void 0:u._difficultyLabel)||Pn[a._difficulty]),Yn(t._beatmapCharacteristicName,a._difficulty)}e=!1,s.add(i)})}},$l=t=>{if(!t){Ne.forEach(n=>Wi(n)),Me.forEach(n=>Wi(n));return}let e=!0;t._difficultyBeatmapSets.forEach(n=>{Ne.forEach(a=>{const s=document.createElement("option");s.value=n._beatmapCharacteristicName,s.textContent=$a[n._beatmapCharacteristicName],a.add(s)}),e&&Bl(n),e=!1})},Md=()=>{const t=at.beatmapInfo;if(!t)throw new Error(De+"could not find map info");const e=_e.create(t._beatsPerMinute);yn.adjustTime(e)},Od=()=>{yn.toolListInput.forEach(t=>{if(t.input.html)switch(t.type){case"note":{Tl.appendChild(t.input.html);break}case"obstacle":{Rl.appendChild(t.input.html);break}case"event":{Il.appendChild(t.input.html);break}case"other":{Al.appendChild(t.input.html);break}case"general":{console.log(De+"ignoring general tool for "+t.name);break}default:console.error(De+"could not recognise type "+t.type+" for "+t.name)}})},Pd=()=>{Se&&(Se.innerHTML="No output."),we&&(we.innerHTML="No output.")},Fd=()=>{Pd(),Pi("Difficulty Label"),$l()};function zd(t){var a;const e=t.target;Ne.forEach(s=>{s!==e&&(s.value=e.value)});const n=(a=at.beatmapInfo)==null?void 0:a._difficultyBeatmapSets.find(s=>s._beatmapCharacteristicName===e.value);Bl(n)}function jd(t){var s,i,l,r;const e=t.target;Me.forEach(o=>{o!==e&&(o.value=e.value)});const n=(s=at.beatmapInfo)==null?void 0:s._difficultyBeatmapSets.find(o=>o._beatmapCharacteristicName===Ne.item(0).value);if(!n)throw new Error("aaaaaaaaaaaaaaaaaaa");const a=(i=at.beatmapDifficulty)==null?void 0:i.find(o=>o.difficulty===e.value&&o.characteristic===n._beatmapCharacteristicName);a&&(Fn.setDiffInfoTable(a),Pi(((r=(l=a.info)==null?void 0:l._customData)==null?void 0:r._difficultyLabel)||Pn[e.value]),Yn(a.characteristic,a.difficulty))}function Hd(){const t=Ne[0].value,e=Me[0].value;if(!t||!e)throw new Error(De+"mode/difficulty does not exist");_t.status("info",`Re-analysing ${t} ${e}`,100),yn.runDifficulty(t,e),_t.status("info",`Re-analysed ${t} ${e}`,100),Yn(t,e)}function Xd(){const t=Ne[0].value,e=Me[0].value;if(!t||!e)throw new Error(De+"mode/difficulty does not exist");_t.status("info","Re-analysing all difficulties",100),yn.applyAll(),_t.status("info","Re-analysed all difficulties",100),Yn(t,e)}var cn={displayOutputGeneral:Nd,displayOutputDifficulty:Yn,setDifficultyLabel:Pi,adjustTime:Md,populateSelect:$l,populateTool:Od,reset:Fd};const Ui=t=>{const e={red:{total:0,chroma:0,noodleExtensions:0,mappingExtensions:0},blue:{total:0,chroma:0,noodleExtensions:0,mappingExtensions:0}};for(let n=t.length-1;n>=0;n--)t[n].color===0?(e.red.total++,t[n].hasChroma()&&e.red.chroma++,t[n].hasNoodleExtensions()&&e.red.noodleExtensions++,t[n].hasMappingExtensions()&&e.red.mappingExtensions++):t[n].color===1&&(e.blue.total++,t[n].hasChroma()&&e.blue.chroma++,t[n].hasNoodleExtensions()&&e.blue.noodleExtensions++,t[n].hasMappingExtensions()&&e.blue.mappingExtensions++);return e},Ud=t=>{const e={total:0,chroma:0,noodleExtensions:0,mappingExtensions:0};for(let n=t.length-1;n>=0;n--)e.total++,t[n].hasChroma()&&e.chroma++,t[n].hasNoodleExtensions()&&e.noodleExtensions++,t[n].hasMappingExtensions()&&e.mappingExtensions++;return e},ti=(t,e)=>t.filter(n=>n.data.posX===e).length,Yd=(t,e)=>t.filter(n=>n.data.posY===e).length,Gd=(t,e,n)=>t.filter(a=>a.data.posX===e&&a.data.posY===n).length,Vd=(t,e)=>t.filter(n=>n.type!=="bomb"&&n.data.direction===e).length,Wd=t=>{const e={total:0,interactive:0,chroma:0,noodleExtensions:0,mappingExtensions:0};for(let n=t.length-1;n>-1;n--)e.total++,t[n].isInteractive()&&e.interactive++,t[n].hasChroma()&&e.chroma++,t[n].hasNoodleExtensions()&&e.noodleExtensions++,t[n].hasMappingExtensions()&&e.mappingExtensions++;return e},qd=(t,e="DefaultEnvironment")=>{var s,i;const n=(i=(s=Be[e])==null?void 0:s[0])!=null?i:Be.DefaultEnvironment[0],a={};for(let l=n.length-1;l>=0;l--)a[n[l]]={total:0,chroma:0,chromaOld:0};for(let l=t.length-1;l>=0;l--)t[l].isValidType()&&(a[t[l].type]||(a[t[l].type]={total:0,chroma:0,chromaOld:0}),a[t[l].type].total++,t[l].hasChroma()&&a[t[l].type].chroma++,t[l].hasOldChroma()&&a[t[l].type].chromaOld++);return a},Zd=(t,e="DefaultEnvironment")=>{var s,i;const n=(i=(s=Be[e])==null?void 0:s[1])!=null?i:Be.DefaultEnvironment[1],a={};console.log(t.length);for(let l=n.length-1;l>=0;l--)a[n[l]]={total:0,eventBox:0,base:0};for(let l=t.length-1;l>=0;l--)a[t[l].groupID]||(a[t[l].groupID]={total:0,eventBox:0,base:0}),a[t[l].groupID].total++,a[t[l].groupID].eventBox+=t[l].events.length,a[t[l].groupID].base+=t[l].events.reduce((r,o)=>r+o.events.length,0);return a},Jd=(t,e="DefaultEnvironment")=>{var s,i;const n=(i=(s=Be[e])==null?void 0:s[1])!=null?i:Be.DefaultEnvironment[1],a={};for(let l=n.length-1;l>=0;l--)a[n[l]]={total:0,eventBox:0,base:0};for(let l=t.length-1;l>=0;l--)a[t[l].groupID]||(a[t[l].groupID]={total:0,eventBox:0,base:0}),a[t[l].groupID].total++,a[t[l].groupID].eventBox+=t[l].events.length,a[t[l].groupID].base+=t[l].events.reduce((r,o)=>r+o.events.length,0);return a},Kd=115,Qd=t=>{let e=0,n=1;for(let a=0,s=t.filter(i=>{var l,r;return i.type==="note"&&!(typeof((l=i.data.customData)==null?void 0:l.uninteractable)!="undefined"||!((r=i.data.customData)!=null&&r.uninteractable))}).length;a<s;a++)n<8&&a===-3+n*4&&(n*=2),e+=Kd*n;return e},tf=(t,e)=>{switch(t){case 0:switch(e){case"BillieEnvironment":return"Water 4";case"PyroEnvironment":return"Video Alpha";case"EDMEnvironment":return"Lane Lights Bottom";default:return"Back Lasers"}case 1:switch(e){case"BillieEnvironment":return"Water 1";case"PyroEnvironment":return"Logo";case"EDMEnvironment":return"Lane Lights Top";default:return"Ring Lights"}case 2:switch(e){case"BillieEnvironment":return"Left Sun Ray";case"PyroEnvironment":return"Left Projectors";default:return"Left Lasers"}case 3:switch(e){case"BillieEnvironment":return"Right Sun Ray";case"PyroEnvironment":return"Right Projectors";default:return"Right Lasers"}case 4:switch(e){case"BillieEnvironment":return"Sun";case"PyroEnvironment":return"Platform";case"EDMEnvironment":return"Player Space & Spectrogram";default:return"Center Lights"}case 5:return"Color Boost";case 6:switch(e){case"BillieEnvironment":return"Water 2";case"PyroEnvironment":return"Ambient";default:return"Extra Left Lights"}case 7:switch(e){case"BillieEnvironment":return"Water 3";default:return"Extra Right Lights"}case 8:switch(e){case"BillieEnvironment":return"Rain Toggle";default:return"Ring Rotation"}case 9:switch(e){case"BillieEnvironment":return"Laser Align Toggle";default:return"Ring Zoom"}case 10:switch(e){default:return"Extra Left Lasers"}case 11:switch(e){default:return"Extra Right Lasers"}case 12:switch(e){case"BillieEnvironment":return"Left Sun Ray Rotation";default:return"Left Laser Rotation"}case 13:switch(e){case"BillieEnvironment":return"Right Sun Ray Rotation";default:return"Right Laser Rotation"}case 14:return"Early Lane Rotation";case 15:return"Late Lane Rotation";case 16:switch(e){case"BillieEnvironment":return"Left Laser Rotation";default:return"Utility Event 1"}case 17:switch(e){case"BillieEnvironment":return"Right Laser Rotation";default:return"Utility Event 2"}case 18:switch(e){default:return"Utility Event 3"}case 19:switch(e){default:return"Utility Event 4"}case 40:switch(e){case"PyroEnvironment":return"Video Projection";default:return"BTS Event 1"}case 41:switch(e){default:return"BTS Event 2"}case 42:switch(e){default:return"BTS Event 3"}case 43:switch(e){default:return"BTS Event 4"}default:return"Unknown"}},ef=(t,e)=>{switch(e){case"WeaveEnvironment":switch(t){case 0:return"Outer Square Bottom Left Laser";case 1:return"Outer Square Bottom Right Laser";case 2:return"Outer Square Top Left Laser";case 3:return"Outer Square Top Right Laser";case 4:return"Inner Square Bottom Left Laser";case 5:return"Inner Square Bottom Right Laser";case 6:return"Inner Square Top Left Laser";case 7:return"Inner Square Top Right Laser";case 8:return"Side Square Bottom Left Laser";case 9:return"Side Square Bottom Right Laser";case 10:return"Side Square Top Left Laser";case 11:return"Side Square Top Right Laser";case 12:return"Distant Square Top Laser";case 13:return"Distant Square Bottom Laser";case 14:return"Distant Square Left Laser";case 15:return"Distant Square Right Laser"}case"PyroEnvironment":switch(t){case 0:return"Left Stage Light";case 1:return"Right Stage Light";case 2:return"Top Left Laser";case 3:return"Top Right Laser";case 4:return"Top Middle Laser";case 5:return"Top Light";case 6:return"Left Light Tower";case 7:return"Right Light Tower";case 8:return"Stage Left Laser";case 9:return"Stage Right Laser";case 10:return"Stage Far Left Laser";case 11:return"Stage Far Right Laser";case 12:return"Left Flame";case 13:return"Right Flame"}case"EDMEnvironment":switch(t){case 0:return"Large Circle Light";case 1:return"Large Circle Light 2";case 2:return"Laser Circle Light";case 3:return"Laser Circle Light 2";case 4:return"Left Vertical Laser";case 5:return"Right Vertical Laser 2";case 6:return"Left Horizontal Laser";case 7:return"Left Horizontal Laser 2";case 8:return"Right Horizontal Laser";case 9:return"Right Horizontal Laser 2";case 10:return"Left Horizontal Laser 3";case 11:return"Right Horizontal Laser 3";case 12:return"Unidentifed";case 13:return"Unidentifed";case 14:return"Unidentifed";case 15:return"Unidentifed";case 16:return"Unidentifed";case 17:return"Unidentifed"}default:return"Unknown"}},nn="UI Stats: ",R="stats__",oi=document.querySelector("#stats .accordion__collapsible"),Nl=(t,e)=>{const n=_e.create(t._beatsPerMinute),a=$e.create(n,e.info._noteJumpMovementSpeed||$e.FallbackNJS[e.difficulty],e.info._noteJumpStartBeatOffset),s=document.createElement("table");return s.className=R+"table",s.innerHTML=`<caption class="${R}table-caption">Map Settings:</caption>
    <tr>
    <th class="${R}table-header" colspan="2">Note Jump Speed</th>
    <td class="${R}table-element">${P(a.value,3)}</td>
    </tr>
    <tr>
    <th class="${R}table-header" colspan="2">Spawn Distance Modifier</th>
    <td class="${R}table-element">${P(a.offset,3)}</td>
    </tr>
    <tr>
    <th class="${R}table-header" colspan="2">Half Jump Duration</th>
    <td class="${R}table-element">${P(a.hjd,3)}</td>
    </tr>
    <tr>
    <th class="${R}table-header" colspan="2">Jump Distance</th>
    <td class="${R}table-element">${P(a.jd,3)}</td>
    </tr>
    <tr>
    <th class="${R}table-header" colspan="2">Reaction Time</th>
    <td class="${R}table-element">${P(a.reactTime*1e3)}ms</td>
    </tr>`,s},Ml=(t,e)=>{const n=_e.create(t._beatsPerMinute),a=at.duration||0,s=n.toRealTime(e.data.getLastInteractiveTime()),i=document.createElement("table");return i.className=R+"table",i.innerHTML=`<caption class="${R}table-caption">Note Per Seconds (NPS):</caption>
    <tr>
    <th class="${R}table-header" colspan="2">Overall</th>
    <td class="${R}table-element">${P(e.data.nps(a),2)}</td>
    </tr>
    <tr>
    <th class="${R}table-header" colspan="2">Mapped</th>
    <td class="${R}table-element">${P(e.data.nps(s),2)}</td>
    </tr>
    <tr>
    <th class="${R}table-header" rowspan="3">Peak</th>
    <th class="${R}table-header">16-beat</th>
    <td class="${R}table-element">${P(e.data.peak(16,n.value),2)}</td>
    </tr>
    <tr>
    <th class="${R}table-header">8-beat</th>
    <td class="${R}table-element">${P(e.data.peak(8,n.value),2)}</td>
    </tr>
    <tr>
    <th class="${R}table-header">4-beat</th>
    <td class="${R}table-element">${P(e.data.peak(4,n.value),2)}</td>
    </tr>`,i},Ol=(t,e)=>{const n=e.swingAnalysis,a=document.createElement("table");return a.className=R+"table",a.innerHTML=`<caption class="${R}table-caption">Swing Per Seconds (SPS):</caption>
    <tr>
    <th class="${R}table-header"></th>
    <th class="${R}table-header">Total</th>
    <th class="${R}table-header">Red</th>
    <th class="${R}table-header">Blue</th>
    </tr>
    <tr>
    <th class="${R}table-header">Count</th>
    <td class="${R}table-element">${P(n.total.count,2)}</td>
    <td class="${R}table-element">${P(n.red.count,2)}</td>
    <td class="${R}table-element">${P(n.blue.count,2)}</td>
    </tr>
    <tr>
    <th class="${R}table-header">Median</th>
    <td class="${R}table-element">${P(n.total.median,2)}</td>
    <td class="${R}table-element">${P(n.red.median,2)}</td>
    <td class="${R}table-element">${P(n.blue.median,2)}</td>
    </tr>
    <tr>
    <th class="${R}table-header">Peak</th>
    <td class="${R}table-element">${P(n.total.peak,2)}</td>
    <td class="${R}table-element">${P(n.red.peak,2)}</td>
    <td class="${R}table-element">${P(n.blue.peak,2)}</td>
    </tr>
    <tr>
    <th class="${R}table-header">Total</th>
    <td class="${R}table-element">${n.total.total}</td>
    <td class="${R}table-element">${n.red.total}</td>
    <td class="${R}table-element">${n.blue.total}</td>
    </tr>`,a},Pl=(t,e)=>{const n=Ui(e.data.colorNotes),a=Ui(e.data.sliders),s=Ui(e.data.burstSliders),i=Ud(e.data.colorNotes);let l=`<caption class="${R}table-caption">Notes: ${n.red.total+n.blue.total}<br>Arc: ${a.red.total+a.blue.total}<br>Chain: ${s.red.total+s.blue.total}<br>Bombs: ${n.red.total+n.blue.total}<br>R/B Ratio: ${P(n.red.total/n.blue.total,2)}</caption>
    <tr>
    <th class="${R}table-header"></th>
    <th class="${R}table-header">Red</th>
    <th class="${R}table-header">Blue</th>
    <th class="${R}table-header">Bomb</th>
    </tr>
    <tr>
    <th class="${R}table-header">Note</th>
    <td class="${R}table-element">${n.red.total}</td>
    <td class="${R}table-element">${n.blue.total}</td>
    <td class="${R}table-element">0</td>
    </tr>
    <tr>
    <th class="${R}table-header">Arc</th>
    <td class="${R}table-element">${a.red.total}</td>
    <td class="${R}table-element">${a.blue.total}</td>
    <td class="${R}table-element">0</td>
    </tr>
    <tr>
    <th class="${R}table-header">Chain</th>
    <td class="${R}table-element">${s.red.total}</td>
    <td class="${R}table-element">${s.blue.total}</td>
    <td class="${R}table-element">0</td>
    </tr>
    <tr>
    <th class="${R}table-header">Bomb</th>
    <td class="${R}table-element">0</td>
    <td class="${R}table-element">0</td>
    <td class="${R}table-element">${i.total}</td>
    </tr>`;(n.red.chroma||n.blue.chroma||i.chroma)&&(l+=`<tr>
        <th class="${R}table-header">Chroma</th>
        <td class="${R}table-element">${n.red.chroma}</td>
        <td class="${R}table-element">${n.blue.chroma}</td>
        <td class="${R}table-element">${i.chroma}</td>
        </tr>`),(n.red.noodleExtensions||n.blue.noodleExtensions||i.noodleExtensions)&&(l+=`<tr>
        <th class="${R}table-header">NE</th>
        <td class="${R}table-element">${n.red.noodleExtensions}</td>
        <td class="${R}table-element">${n.blue.noodleExtensions}</td>
        <td class="${R}table-element">${i.noodleExtensions}</td>
        </tr>`),(n.red.mappingExtensions||n.blue.mappingExtensions||i.mappingExtensions)&&(l+=`<tr>
        <th class="${R}table-header">ME</th>
        <td class="${R}table-element">${n.red.mappingExtensions}</td>
        <td class="${R}table-element">${n.blue.mappingExtensions}</td>
        <td class="${R}table-element">${i.mappingExtensions}</td>
        </tr>`);const r=document.createElement("table");return r.className=R+"table",r.innerHTML=l,r};function nf(t){var o;const e=t.target,n=e.id.replace(`${R}table-select-placement-`,"").split("-"),a=n[0],s=n[1],i=(o=at.beatmapDifficulty.find(u=>u.characteristic===a&&u.difficulty===s))==null?void 0:o.noteContainer;if(!i){console.error(nn+"note could not be found");return}let l;switch(e.value){case"note":{l=i.filter(u=>u.type==="note");break}case"red":{l=i.filter(u=>u.type==="note"&&u.data.color===0);break}case"blue":{l=i.filter(u=>u.type==="note"&&u.data.color===1);break}case"bomb":{l=i.filter(u=>u.type==="bomb");break}default:l=i}const r=document.querySelector(`#${R}table-placement-${a}-${s}`);if(!r){console.error(nn+"table could not be found");return}r.innerHTML=Fl(l)}const Fl=t=>{const e=t.length||1;let n="";for(let a=2;a>=0;a--){n+="<tr>";for(let s=0;s<=3;s++)n+=`<td class="${R}table-element">${Gd(t,s,a)}</td>`;n+=`<td class="${R}table-element ${R}table--no-border">${P(Yd(t,a)/e*100,1)}%</td>
        </tr>`}return n+=`<tr>
    <td class="${R}table-element ${R}table--no-border">${P(ti(t,0)/e*100,1)}%</td>
    <td class="${R}table-element ${R}table--no-border">${P(ti(t,1)/e*100,1)}%</td>
    <td class="${R}table-element ${R}table--no-border">${P(ti(t,2)/e*100,1)}%</td>
    <td class="${R}table-element ${R}table--no-border">${P(ti(t,3)/e*100,1)}%</td>
    </tr>`,n},zl=(t,e)=>{var i;const n=Un.create(`${R}table-select-placement-${e.characteristic}-${e.difficulty}`,"Note Placement: ","caption",`${R}table-caption`,{text:"All",value:"all"},{text:"Note Only",value:"note"},{text:"Red Note",value:"red"},{text:"Blue Note",value:"blue"},{text:"Bomb",value:"bomb"});(i=n.querySelector("select"))==null||i.addEventListener("change",nf);let a=`<tbody id="${R}table-placement-${e.characteristic}-${e.difficulty}">${Fl(e.noteContainer)}</tbody>`;const s=document.createElement("table");return s.className=R+"table",s.innerHTML=a,s.prepend(n),s};function af(t){var o;const e=t.target,n=e.id.replace(`${R}table-select-angle-`,"").split("-"),a=n[0],s=n[1],i=(o=at.beatmapDifficulty.find(u=>u.characteristic===a&&u.difficulty===s))==null?void 0:o.noteContainer;if(!i){console.error(nn+"note could not be found");return}let l;switch(e.value){case"red":{l=i.filter(u=>u.type==="note"&&u.data.color===0);break}case"blue":{l=i.filter(u=>u.type==="note"&&u.data.color===1);break}default:l=i}const r=document.querySelector(`#${R}table-angle-${a}-${s}`);if(!r){console.error(nn+"table could not be found");return}r.innerHTML=jl(l)}const jl=t=>{const e=t.length||1,n=[4,0,5,2,8,3,6,1,7];let a="";for(let s=0;s<3;s++){a+="<tr>";for(let i=0;i<3;i++){let l=Vd(t,n[s*3+i]);a+=`<td class="${R}table-element">${l}<br>(${P(l/e*100,1)}%)</td>`}a+="</tr>"}return a},Hl=(t,e)=>{var i;const n=Un.create(`${R}table-select-angle-${e.characteristic}-${e.difficulty}`,"Note Angle: ","caption",`${R}table-caption`,{text:"All",value:"all"},{text:"Note Only",value:"note"},{text:"Red Note",value:"red"},{text:"Blue Note",value:"blue"});(i=n.querySelector("select"))==null||i.addEventListener("change",af);let a=`<tbody id="${R}table-angle-${e.characteristic}-${e.difficulty}">${jl(e.noteContainer)}</tbody>`;const s=document.createElement("table");return s.className=R+"table",s.innerHTML=a,s.prepend(n),s},Xl=(t,e)=>{let n=`<caption class="${R}table-caption">Note Information:</caption>
    <tr>
    <th class="${R}table-header" colspan="2">Max Score</th>
    <td class="${R}table-element">${cc(Qd(e.noteContainer))}</td>
    </tr>
    <tr>
    <th class="${R}table-header" colspan="2">Effective BPM</th>
    <td class="${R}table-element">${P(Tu(e.swingAnalysis.container),2)}</td>
    </tr>
    <tr>
    <th class="${R}table-header" colspan="2">Effective BPM (swing)</th>
    <td class="${R}table-element">${P(Ru(e.swingAnalysis.container),2)}</td>
    </tr>`,a=P(Nu(e.swingAnalysis.container)*1e3,1),s=P(Mu(e.swingAnalysis.container)*1e3,1);a&&s&&(n+=`
        <tr>
        <th class="${R}table-header" colspan="2">Min. Slider Speed</th>
        <td class="${R}table-element">${a}ms</td>
        </tr>
        <tr>
        <th class="${R}table-header" colspan="2">Max. Slider Speed</th>
        <td class="${R}table-element">${s}ms</td>
        </tr>`);const i=document.createElement("table");return i.className=R+"table",i.innerHTML=n,i},Ul=(t,e)=>{const n=e.characteristic==="360Degree"||e.characteristic==="90Degree"?t._allDirectionsEnvironmentName:t._environmentName,a=qd(e.data.basicBeatmapEvents,n);let s=0,i=0,l=`<caption class="${R}table-caption">Events: ${Object.values(a).reduce((o,{total:u})=>o+u,0)}</caption>`;for(const o in a)s+=a[o].chroma,i+=a[o].chromaOld,l+=`<tr>
        <th class="${R}table-header">${o}</th>
        <th class="${R}table-header" colspan="4">${tf(parseInt(o),n)}</th>
        <td class="${R}table-element">${a[o].total}</td>
        </tr>`;s&&(l+=`<tr>
        <th class="${R}table-header" colspan="5">Chroma</th>
        <td class="${R}table-element">${s}</td>
        </tr>`),i&&(l+=`<tr>
        <th class="${R}table-header" colspan="5">OG Chroma</th>
        <td class="${R}table-element">${i}</td>
        </tr>`);const r=document.createElement("table");return r.className=R+"table",r.innerHTML=l,r},rf=(t,e)=>{const n=e.characteristic==="360Degree"||e.characteristic==="90Degree"?t._allDirectionsEnvironmentName:t._environmentName,a=Zd(e.data.lightColorEventBoxGroups,n),s=Jd(e.data.lightRotationEventBoxGroups,n);let i=`<caption class="${R}table-caption">Color Event Box Groups: ${Object.values(a).reduce((r,{total:o})=>r+o,0)}<br>Rotation Event Box Groups: ${Object.values(s).reduce((r,{total:o})=>r+o,0)}</caption>`;for(const r in a)i+=`<tr>
        <th class="${R}table-header">${r}</th>
        <th class="${R}table-header" colspan="4">${ef(parseInt(r),n)}</th>
        <td class="${R}table-element">${a[r].total}</td>
        <td class="${R}table-element">${s[r].total}</td>
        </tr>`;const l=document.createElement("table");return l.className=R+"table",l.innerHTML=i,l},Yl=(t,e)=>{const n=Wd(e.data.obstacles);let a=`<caption class="${R}table-caption">Obstacles: ${n.total}</caption>`;n.interactive&&(a+=`<tr>
        <th class="${R}table-header" colspan="2">Interactive</th>
        <td class="${R}table-element">${n.interactive}</td>
        </tr>`),n.chroma&&(a+=`<tr>
        <th class="${R}table-header" colspan="2">Chroma</th>
        <td class="${R}table-element">${n.chroma}</td>
        </tr>`),n.noodleExtensions&&(a+=`<tr>
        <th class="${R}table-header" colspan="2">Noodle Extensions</th>
        <td class="${R}table-element">${n.noodleExtensions}</td>
        </tr>`),n.mappingExtensions&&(a+=`<tr>
        <th class="${R}table-header" colspan="2">Mapping Extensions</th>
        <td class="${R}table-element">${n.mappingExtensions}</td>
        </tr>`);const s=document.createElement("table");return s.className=R+"table",s.innerHTML=a,s},sf=()=>{if(!at.beatmapInfo)throw new Error(nn+"map info could not be found in savedData");const t=at.beatmapInfo;t._difficultyBeatmapSets.forEach(e=>{var s,i;const n=document.createElement("div");n.className=R+"mode-"+e._beatmapCharacteristicName;const a=document.createElement("div");a.className=R+"title",a.textContent=$a[e._beatmapCharacteristicName],n.appendChild(a);for(let l=e._difficultyBeatmaps.length-1;l>=0;l--){const r=e._difficultyBeatmaps[l],o=at.beatmapDifficulty.find(_=>_.characteristic===e._beatmapCharacteristicName&&_.difficulty===r._difficulty);if(!o)throw new Error(nn+"Could not find map data");const u=uo.create(`${R}${e._beatmapCharacteristicName}-${r._difficulty}`,Pn[r._difficulty]+((s=r._customData)!=null&&s._difficultyLabel?" -- "+((i=r._customData)==null?void 0:i._difficultyLabel):""),r._difficulty,!0),h=u.querySelector(".accordion__collapsible-flex"),m=u.querySelector(".accordion__button");if(!h||!m)throw new Error(nn+"something went wrong!");m.checked=mt.onLoad.stats;const g=ii.create("small","half"),c=ii.create("small","half"),p=ii.create("small","half");g.append(Nl(t,o)),g.append(document.createElement("br")),g.append(Ml(t,o)),g.append(document.createElement("br")),g.append(Ol(t,o)),c.append(Xl(t,o)),c.append(document.createElement("br")),c.append(zl(t,o)),c.append(document.createElement("br")),c.append(Hl(t,o)),p.append(Pl(t,o)),p.append(document.createElement("br")),p.append(Ul(t,o)),p.append(document.createElement("br")),p.append(rf(t,o)),p.append(document.createElement("br")),p.append(Yl(t,o)),h.appendChild(g),h.appendChild(c),h.appendChild(p),n.appendChild(u)}oi.appendChild(n)})},of=()=>{for(;oi.firstChild;)oi.removeChild(oi.firstChild)};var Gl={createSettingsTable:Nl,createNPSTable:Ml,createSPSTable:Ol,createNoteCountTable:Pl,createNotePlacementTable:zl,createNoteAngleTable:Hl,createInfoTable:Xl,createEventCountTable:Ul,createObstacleCountTable:Yl,populate:sf,reset:of};const Bn=t=>`[load::${t}]`,lf=async t=>{const e=t.file("Info.dat")||t.file("info.dat");if(!e)throw new Error("Couldn't find Info.dat");return nt.info(Bn("loadInfo"),"loading info"),Rc(JSON.parse(await e.async("string")))},cf=async(t,e)=>{var s,i,l,r,o,u;const n=[],a=t._difficultyBeatmapSets;for(let h=a.length-1;h>=0;h--){const m=a[h]._difficultyBeatmaps;if(m.length===0||!m){nt.error(Bn("loadDifficulty"),"Empty difficulty set, removing..."),a.splice(h,1);continue}for(let g=0;g<m.length;g++){const c=m[g],p=e.file(c._beatmapFilename);if(p){nt.info(Bn("loadDifficulty"),`Loading ${a[h]._beatmapCharacteristicName} ${c._difficulty}`);let _;try{_=JSON.parse(await p.async("string"))}catch(y){throw new Error(`${a[h]._beatmapCharacteristicName} ${c._difficulty} ${y}`)}try{if(_._notes&&_.version&&nt.error(Bn("loadDifficulty"),`${a[h]._beatmapCharacteristicName} ${c._difficulty} contains 2 version of the map in the same file, attempting to load v3 instead`),_.version){const y=ru(_),b=_e.create(t._beatsPerMinute,(s=y.customData)==null?void 0:s.BPMChanges,(i=c._customData)==null?void 0:i._editorOffset);n.push({info:c,characteristic:a[h]._beatmapCharacteristicName,difficulty:c._difficulty,bpm:b,data:y,noteContainer:y.getNoteContainer(),eventContainer:y.getEventContainer(),swingAnalysis:Vr(y,b,a[h]._beatmapCharacteristicName,c._difficulty),rawVersion:3,rawData:_})}else{const y=Tc(Fc(_),!0),b=_e.create(t._beatsPerMinute,(o=(l=_._customData)==null?void 0:l._BPMChanges)!=null?o:(r=_._customData)==null?void 0:r._bpmChanges,(u=c._customData)==null?void 0:u._editorOffset);n.push({info:c,characteristic:a[h]._beatmapCharacteristicName,difficulty:c._difficulty,bpm:b,data:y,noteContainer:y.getNoteContainer(),eventContainer:y.getEventContainer(),swingAnalysis:Vr(y,b,a[h]._beatmapCharacteristicName,c._difficulty),rawVersion:2,rawData:_})}}catch(y){throw new Error(`${a[h]._beatmapCharacteristicName} ${c._difficulty} ${y}`)}}else if(nt.error(Bn("loadDifficulty"),`Missing ${c._beatmapFilename} file for ${a[h]._beatmapCharacteristicName} ${c._difficulty}, ignoring.`),a[h]._difficultyBeatmaps.splice(g,1),g--,a[h]._difficultyBeatmaps.length<1){nt.error(`${a[h]._beatmapCharacteristicName} difficulty set now empty, ignoring.`),a.splice(h,1);continue}}}return n},Vl=async t=>new Promise(function(e,n){const a=new XMLHttpRequest;a.open("GET",t,!0),a.responseType="json",a.timeout=5e3;let s=Date.now();a.onprogress=()=>{a.timeout+=Date.now()-s},a.onload=()=>{a.status===200&&e(a.response),a.status===404&&n("Error 404: Map does not exist"),a.status===403&&n("Error 403: Forbidden"),n(`Error ${a.status}`)},a.onerror=()=>{n("Error downloading")},a.ontimeout=()=>{n("Connection timeout")},a.send()}),uf=async t=>{const e=`https://api.beatsaver.com/maps/id/${t}`,n=await Vl(e);if(n!=null&&n.versions.length)return n.versions[n.versions.length-1].downloadURL;throw new Error("could not find map download link")},hf=async t=>{const e=`https://api.beatsaver.com/maps/hash/${t}`,n=await Vl(e);if(n!=null&&n.versions.length)return n.versions[n.versions.length-1].downloadURL;throw new Error("could not find map download link")},Cr=async t=>new Promise(function(e,n){const a=new XMLHttpRequest;a.open("GET",t,!0),a.responseType="arraybuffer",a.timeout=5e3;let s=Date.now();a.onprogress=i=>{a.timeout+=Date.now()-s,_t.status("download",`Downloading map: ${P(i.loaded/1024/1024,1)}MB / ${P(i.total/1024/1024,1)}MB`,i.loaded/i.total*100)},a.onload=()=>{a.status===200&&e(a.response),a.status===404&&n("Error 404: Map/link does not exist"),a.status===403&&n("Error 403: Forbidden"),n(`Error ${a.status}`)},a.onerror=()=>{n("Error downloading")},a.ontimeout=()=>{n("Connection timeout")},a.send()}),Wl=async t=>{const e=mo(t);console.log(`fetching download URL from BeatSaver for map ID ${e}`),_t.status("info","Fetching download URL from BeatSaver",0);const n=await uf(e);console.log(`downloading from BeatSaver for map ID ${e}`),_t.status("info","Requesting download from BeatSaver",0);const a=await Cr(n);return Ot.setCoverLink("https://beatsaver.com/maps/"+e,e),a},df=async t=>{const e=fo(t);if(e.match(/^(https?:\/\/)?(www\.)?beatsaver\.com\/maps\//))return Wl(e.replace(/^https?:\/\/(www\.)?beatsaver\.com\/maps\//,"").match(/[a-fA-F0-9]*/)[0]);_t.status("info","Requesting download from link",0),console.log(`downloading from ${e}`);let n=await Cr(e);return Ot.setCoverLink(e),n},ff=async t=>{let e;if(ho(t.trim()))e=t.trim();else throw new Error("invalid hash");console.log(`fetching download URL from BeatSaver for map hash ${e}`),_t.status("info","Fetching download URL from BeatSaver",0);const n=await hf(e);return console.log(`downloading from BeatSaver for map hash ${e}`),_t.status("info","Requesting download from BeatSaver",0),await Cr(n)};var ei=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function ni(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ql={exports:{}};/*!

JSZip v3.10.0 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(t,e){(function(n){t.exports=n()})(function(){return function n(a,s,i){function l(u,h){if(!s[u]){if(!a[u]){var m=typeof ni=="function"&&ni;if(!h&&m)return m(u,!0);if(r)return r(u,!0);var g=new Error("Cannot find module '"+u+"'");throw g.code="MODULE_NOT_FOUND",g}var c=s[u]={exports:{}};a[u][0].call(c.exports,function(p){var _=a[u][1][p];return l(_||p)},c,c.exports,n,a,s,i)}return s[u].exports}for(var r=typeof ni=="function"&&ni,o=0;o<i.length;o++)l(i[o]);return l}({1:[function(n,a,s){var i=n("./utils"),l=n("./support"),r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(o){for(var u,h,m,g,c,p,_,y=[],b=0,v=o.length,S=v,L=i.getTypeOf(o)!=="string";b<o.length;)S=v-b,m=L?(u=o[b++],h=b<v?o[b++]:0,b<v?o[b++]:0):(u=o.charCodeAt(b++),h=b<v?o.charCodeAt(b++):0,b<v?o.charCodeAt(b++):0),g=u>>2,c=(3&u)<<4|h>>4,p=1<S?(15&h)<<2|m>>6:64,_=2<S?63&m:64,y.push(r.charAt(g)+r.charAt(c)+r.charAt(p)+r.charAt(_));return y.join("")},s.decode=function(o){var u,h,m,g,c,p,_=0,y=0,b="data:";if(o.substr(0,b.length)===b)throw new Error("Invalid base64 input, it looks like a data url.");var v,S=3*(o=o.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(o.charAt(o.length-1)===r.charAt(64)&&S--,o.charAt(o.length-2)===r.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(v=l.uint8array?new Uint8Array(0|S):new Array(0|S);_<o.length;)u=r.indexOf(o.charAt(_++))<<2|(g=r.indexOf(o.charAt(_++)))>>4,h=(15&g)<<4|(c=r.indexOf(o.charAt(_++)))>>2,m=(3&c)<<6|(p=r.indexOf(o.charAt(_++))),v[y++]=u,c!==64&&(v[y++]=h),p!==64&&(v[y++]=m);return v}},{"./support":30,"./utils":32}],2:[function(n,a,s){var i=n("./external"),l=n("./stream/DataWorker"),r=n("./stream/Crc32Probe"),o=n("./stream/DataLengthProbe");function u(h,m,g,c,p){this.compressedSize=h,this.uncompressedSize=m,this.crc32=g,this.compression=c,this.compressedContent=p}u.prototype={getContentWorker:function(){var h=new l(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),m=this;return h.on("end",function(){if(this.streamInfo.data_length!==m.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),h},getCompressedWorker:function(){return new l(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(h,m,g){return h.pipe(new r).pipe(new o("uncompressedSize")).pipe(m.compressWorker(g)).pipe(new o("compressedSize")).withStreamInfo("compression",m)},a.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,a,s){var i=n("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(l){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},s.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,a,s){var i=n("./utils"),l=function(){for(var r,o=[],u=0;u<256;u++){r=u;for(var h=0;h<8;h++)r=1&r?3988292384^r>>>1:r>>>1;o[u]=r}return o}();a.exports=function(r,o){return r!==void 0&&r.length?i.getTypeOf(r)!=="string"?function(u,h,m,g){var c=l,p=g+m;u^=-1;for(var _=g;_<p;_++)u=u>>>8^c[255&(u^h[_])];return-1^u}(0|o,r,r.length,0):function(u,h,m,g){var c=l,p=g+m;u^=-1;for(var _=g;_<p;_++)u=u>>>8^c[255&(u^h.charCodeAt(_))];return-1^u}(0|o,r,r.length,0):0}},{"./utils":32}],5:[function(n,a,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(n,a,s){var i=null;i=typeof Promise!="undefined"?Promise:n("lie"),a.exports={Promise:i}},{lie:37}],7:[function(n,a,s){var i=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",l=n("pako"),r=n("./utils"),o=n("./stream/GenericWorker"),u=i?"uint8array":"array";function h(m,g){o.call(this,"FlateWorker/"+m),this._pako=null,this._pakoAction=m,this._pakoOptions=g,this.meta={}}s.magic="\b\0",r.inherits(h,o),h.prototype.processChunk=function(m){this.meta=m.meta,this._pako===null&&this._createPako(),this._pako.push(r.transformTo(u,m.data),!1)},h.prototype.flush=function(){o.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},h.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},h.prototype._createPako=function(){this._pako=new l[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var m=this;this._pako.onData=function(g){m.push({data:g,meta:m.meta})}},s.compressWorker=function(m){return new h("Deflate",m)},s.uncompressWorker=function(){return new h("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,a,s){function i(c,p){var _,y="";for(_=0;_<p;_++)y+=String.fromCharCode(255&c),c>>>=8;return y}function l(c,p,_,y,b,v){var S,L,D=c.file,O=c.compression,M=v!==u.utf8encode,X=r.transformTo("string",v(D.name)),$=r.transformTo("string",u.utf8encode(D.name)),Y=D.comment,K=r.transformTo("string",v(Y)),C=r.transformTo("string",u.utf8encode(Y)),N=$.length!==D.name.length,d=C.length!==Y.length,k="",J="",j="",it=D.dir,U=D.date,Q={crc32:0,compressedSize:0,uncompressedSize:0};p&&!_||(Q.crc32=c.crc32,Q.compressedSize=c.compressedSize,Q.uncompressedSize=c.uncompressedSize);var A=0;p&&(A|=8),M||!N&&!d||(A|=2048);var I=0,et=0;it&&(I|=16),b==="UNIX"?(et=798,I|=function(W,vt){var At=W;return W||(At=vt?16893:33204),(65535&At)<<16}(D.unixPermissions,it)):(et=20,I|=function(W){return 63&(W||0)}(D.dosPermissions)),S=U.getUTCHours(),S<<=6,S|=U.getUTCMinutes(),S<<=5,S|=U.getUTCSeconds()/2,L=U.getUTCFullYear()-1980,L<<=4,L|=U.getUTCMonth()+1,L<<=5,L|=U.getUTCDate(),N&&(J=i(1,1)+i(h(X),4)+$,k+="up"+i(J.length,2)+J),d&&(j=i(1,1)+i(h(K),4)+C,k+="uc"+i(j.length,2)+j);var q="";return q+=`
\0`,q+=i(A,2),q+=O.magic,q+=i(S,2),q+=i(L,2),q+=i(Q.crc32,4),q+=i(Q.compressedSize,4),q+=i(Q.uncompressedSize,4),q+=i(X.length,2),q+=i(k.length,2),{fileRecord:m.LOCAL_FILE_HEADER+q+X+k,dirRecord:m.CENTRAL_FILE_HEADER+i(et,2)+q+i(K.length,2)+"\0\0\0\0"+i(I,4)+i(y,4)+X+k+K}}var r=n("../utils"),o=n("../stream/GenericWorker"),u=n("../utf8"),h=n("../crc32"),m=n("../signature");function g(c,p,_,y){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=p,this.zipPlatform=_,this.encodeFileName=y,this.streamFiles=c,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}r.inherits(g,o),g.prototype.push=function(c){var p=c.meta.percent||0,_=this.entriesCount,y=this._sources.length;this.accumulate?this.contentBuffer.push(c):(this.bytesWritten+=c.data.length,o.prototype.push.call(this,{data:c.data,meta:{currentFile:this.currentFile,percent:_?(p+100*(_-y-1))/_:100}}))},g.prototype.openedSource=function(c){this.currentSourceOffset=this.bytesWritten,this.currentFile=c.file.name;var p=this.streamFiles&&!c.file.dir;if(p){var _=l(c,p,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:_.fileRecord,meta:{percent:0}})}else this.accumulate=!0},g.prototype.closedSource=function(c){this.accumulate=!1;var p=this.streamFiles&&!c.file.dir,_=l(c,p,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(_.dirRecord),p)this.push({data:function(y){return m.DATA_DESCRIPTOR+i(y.crc32,4)+i(y.compressedSize,4)+i(y.uncompressedSize,4)}(c),meta:{percent:100}});else for(this.push({data:_.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},g.prototype.flush=function(){for(var c=this.bytesWritten,p=0;p<this.dirRecords.length;p++)this.push({data:this.dirRecords[p],meta:{percent:100}});var _=this.bytesWritten-c,y=function(b,v,S,L,D){var O=r.transformTo("string",D(L));return m.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(b,2)+i(b,2)+i(v,4)+i(S,4)+i(O.length,2)+O}(this.dirRecords.length,_,c,this.zipComment,this.encodeFileName);this.push({data:y,meta:{percent:100}})},g.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},g.prototype.registerPrevious=function(c){this._sources.push(c);var p=this;return c.on("data",function(_){p.processChunk(_)}),c.on("end",function(){p.closedSource(p.previous.streamInfo),p._sources.length?p.prepareNextSource():p.end()}),c.on("error",function(_){p.error(_)}),this},g.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},g.prototype.error=function(c){var p=this._sources;if(!o.prototype.error.call(this,c))return!1;for(var _=0;_<p.length;_++)try{p[_].error(c)}catch{}return!0},g.prototype.lock=function(){o.prototype.lock.call(this);for(var c=this._sources,p=0;p<c.length;p++)c[p].lock()},a.exports=g},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,a,s){var i=n("../compressions"),l=n("./ZipFileWorker");s.generateWorker=function(r,o,u){var h=new l(o.streamFiles,u,o.platform,o.encodeFileName),m=0;try{r.forEach(function(g,c){m++;var p=function(v,S){var L=v||S,D=i[L];if(!D)throw new Error(L+" is not a valid compression method !");return D}(c.options.compression,o.compression),_=c.options.compressionOptions||o.compressionOptions||{},y=c.dir,b=c.date;c._compressWorker(p,_).withStreamInfo("file",{name:g,dir:y,date:b,comment:c.comment||"",unixPermissions:c.unixPermissions,dosPermissions:c.dosPermissions}).pipe(h)}),h.entriesCount=m}catch(g){h.error(g)}return h}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,a,s){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var l=new i;for(var r in this)typeof this[r]!="function"&&(l[r]=this[r]);return l}}(i.prototype=n("./object")).loadAsync=n("./load"),i.support=n("./support"),i.defaults=n("./defaults"),i.version="3.10.0",i.loadAsync=function(l,r){return new i().loadAsync(l,r)},i.external=n("./external"),a.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,a,s){var i=n("./utils"),l=n("./external"),r=n("./utf8"),o=n("./zipEntries"),u=n("./stream/Crc32Probe"),h=n("./nodejsUtils");function m(g){return new l.Promise(function(c,p){var _=g.decompressed.getContentWorker().pipe(new u);_.on("error",function(y){p(y)}).on("end",function(){_.streamInfo.crc32!==g.decompressed.crc32?p(new Error("Corrupted zip : CRC32 mismatch")):c()}).resume()})}a.exports=function(g,c){var p=this;return c=i.extend(c||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:r.utf8decode}),h.isNode&&h.isStream(g)?l.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",g,!0,c.optimizedBinaryString,c.base64).then(function(_){var y=new o(c);return y.load(_),y}).then(function(_){var y=[l.Promise.resolve(_)],b=_.files;if(c.checkCRC32)for(var v=0;v<b.length;v++)y.push(m(b[v]));return l.Promise.all(y)}).then(function(_){for(var y=_.shift(),b=y.files,v=0;v<b.length;v++){var S=b[v],L=S.fileNameStr,D=i.resolve(S.fileNameStr);p.file(D,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:c.createFolders}),S.dir||(p.file(D).unsafeOriginalName=L)}return y.zipComment.length&&(p.comment=y.zipComment),p})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,a,s){var i=n("../utils"),l=n("../stream/GenericWorker");function r(o,u){l.call(this,"Nodejs stream input adapter for "+o),this._upstreamEnded=!1,this._bindStream(u)}i.inherits(r,l),r.prototype._bindStream=function(o){var u=this;(this._stream=o).pause(),o.on("data",function(h){u.push({data:h,meta:{percent:0}})}).on("error",function(h){u.isPaused?this.generatedError=h:u.error(h)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},r.prototype.pause=function(){return!!l.prototype.pause.call(this)&&(this._stream.pause(),!0)},r.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},a.exports=r},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,a,s){var i=n("readable-stream").Readable;function l(r,o,u){i.call(this,o),this._helper=r;var h=this;r.on("data",function(m,g){h.push(m)||h._helper.pause(),u&&u(g)}).on("error",function(m){h.emit("error",m)}).on("end",function(){h.push(null)})}n("../utils").inherits(l,i),l.prototype._read=function(){this._helper.resume()},a.exports=l},{"../utils":32,"readable-stream":16}],14:[function(n,a,s){a.exports={isNode:typeof Buffer!="undefined",newBufferFrom:function(i,l){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,l);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,l)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var l=new Buffer(i);return l.fill(0),l},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(n,a,s){function i(D,O,M){var X,$=r.getTypeOf(O),Y=r.extend(M||{},h);Y.date=Y.date||new Date,Y.compression!==null&&(Y.compression=Y.compression.toUpperCase()),typeof Y.unixPermissions=="string"&&(Y.unixPermissions=parseInt(Y.unixPermissions,8)),Y.unixPermissions&&16384&Y.unixPermissions&&(Y.dir=!0),Y.dosPermissions&&16&Y.dosPermissions&&(Y.dir=!0),Y.dir&&(D=b(D)),Y.createFolders&&(X=y(D))&&v.call(this,X,!0);var K=$==="string"&&Y.binary===!1&&Y.base64===!1;M&&M.binary!==void 0||(Y.binary=!K),(O instanceof m&&O.uncompressedSize===0||Y.dir||!O||O.length===0)&&(Y.base64=!1,Y.binary=!0,O="",Y.compression="STORE",$="string");var C=null;C=O instanceof m||O instanceof o?O:p.isNode&&p.isStream(O)?new _(D,O):r.prepareContent(D,O,Y.binary,Y.optimizedBinaryString,Y.base64);var N=new g(D,C,Y);this.files[D]=N}var l=n("./utf8"),r=n("./utils"),o=n("./stream/GenericWorker"),u=n("./stream/StreamHelper"),h=n("./defaults"),m=n("./compressedObject"),g=n("./zipObject"),c=n("./generate"),p=n("./nodejsUtils"),_=n("./nodejs/NodejsStreamInputAdapter"),y=function(D){D.slice(-1)==="/"&&(D=D.substring(0,D.length-1));var O=D.lastIndexOf("/");return 0<O?D.substring(0,O):""},b=function(D){return D.slice(-1)!=="/"&&(D+="/"),D},v=function(D,O){return O=O!==void 0?O:h.createFolders,D=b(D),this.files[D]||i.call(this,D,null,{dir:!0,createFolders:O}),this.files[D]};function S(D){return Object.prototype.toString.call(D)==="[object RegExp]"}var L={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(D){var O,M,X;for(O in this.files)X=this.files[O],(M=O.slice(this.root.length,O.length))&&O.slice(0,this.root.length)===this.root&&D(M,X)},filter:function(D){var O=[];return this.forEach(function(M,X){D(M,X)&&O.push(X)}),O},file:function(D,O,M){if(arguments.length!==1)return D=this.root+D,i.call(this,D,O,M),this;if(S(D)){var X=D;return this.filter(function(Y,K){return!K.dir&&X.test(Y)})}var $=this.files[this.root+D];return $&&!$.dir?$:null},folder:function(D){if(!D)return this;if(S(D))return this.filter(function($,Y){return Y.dir&&D.test($)});var O=this.root+D,M=v.call(this,O),X=this.clone();return X.root=M.name,X},remove:function(D){D=this.root+D;var O=this.files[D];if(O||(D.slice(-1)!=="/"&&(D+="/"),O=this.files[D]),O&&!O.dir)delete this.files[D];else for(var M=this.filter(function($,Y){return Y.name.slice(0,D.length)===D}),X=0;X<M.length;X++)delete this.files[M[X].name];return this},generate:function(D){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(D){var O,M={};try{if((M=r.extend(D||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:l.utf8encode})).type=M.type.toLowerCase(),M.compression=M.compression.toUpperCase(),M.type==="binarystring"&&(M.type="string"),!M.type)throw new Error("No output type specified.");r.checkSupport(M.type),M.platform!=="darwin"&&M.platform!=="freebsd"&&M.platform!=="linux"&&M.platform!=="sunos"||(M.platform="UNIX"),M.platform==="win32"&&(M.platform="DOS");var X=M.comment||this.comment||"";O=c.generateWorker(this,M,X)}catch($){(O=new o("error")).error($)}return new u(O,M.type||"string",M.mimeType)},generateAsync:function(D,O){return this.generateInternalStream(D).accumulate(O)},generateNodeStream:function(D,O){return(D=D||{}).type||(D.type="nodebuffer"),this.generateInternalStream(D).toNodejsStream(O)}};a.exports=L},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,a,s){a.exports=n("stream")},{stream:void 0}],17:[function(n,a,s){var i=n("./DataReader");function l(r){i.call(this,r);for(var o=0;o<this.data.length;o++)r[o]=255&r[o]}n("../utils").inherits(l,i),l.prototype.byteAt=function(r){return this.data[this.zero+r]},l.prototype.lastIndexOfSignature=function(r){for(var o=r.charCodeAt(0),u=r.charCodeAt(1),h=r.charCodeAt(2),m=r.charCodeAt(3),g=this.length-4;0<=g;--g)if(this.data[g]===o&&this.data[g+1]===u&&this.data[g+2]===h&&this.data[g+3]===m)return g-this.zero;return-1},l.prototype.readAndCheckSignature=function(r){var o=r.charCodeAt(0),u=r.charCodeAt(1),h=r.charCodeAt(2),m=r.charCodeAt(3),g=this.readData(4);return o===g[0]&&u===g[1]&&h===g[2]&&m===g[3]},l.prototype.readData=function(r){if(this.checkOffset(r),r===0)return[];var o=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,o},a.exports=l},{"../utils":32,"./DataReader":18}],18:[function(n,a,s){var i=n("../utils");function l(r){this.data=r,this.length=r.length,this.index=0,this.zero=0}l.prototype={checkOffset:function(r){this.checkIndex(this.index+r)},checkIndex:function(r){if(this.length<this.zero+r||r<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+r+"). Corrupted zip ?")},setIndex:function(r){this.checkIndex(r),this.index=r},skip:function(r){this.setIndex(this.index+r)},byteAt:function(r){},readInt:function(r){var o,u=0;for(this.checkOffset(r),o=this.index+r-1;o>=this.index;o--)u=(u<<8)+this.byteAt(o);return this.index+=r,u},readString:function(r){return i.transformTo("string",this.readData(r))},readData:function(r){},lastIndexOfSignature:function(r){},readAndCheckSignature:function(r){},readDate:function(){var r=this.readInt(4);return new Date(Date.UTC(1980+(r>>25&127),(r>>21&15)-1,r>>16&31,r>>11&31,r>>5&63,(31&r)<<1))}},a.exports=l},{"../utils":32}],19:[function(n,a,s){var i=n("./Uint8ArrayReader");function l(r){i.call(this,r)}n("../utils").inherits(l,i),l.prototype.readData=function(r){this.checkOffset(r);var o=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,o},a.exports=l},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,a,s){var i=n("./DataReader");function l(r){i.call(this,r)}n("../utils").inherits(l,i),l.prototype.byteAt=function(r){return this.data.charCodeAt(this.zero+r)},l.prototype.lastIndexOfSignature=function(r){return this.data.lastIndexOf(r)-this.zero},l.prototype.readAndCheckSignature=function(r){return r===this.readData(4)},l.prototype.readData=function(r){this.checkOffset(r);var o=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,o},a.exports=l},{"../utils":32,"./DataReader":18}],21:[function(n,a,s){var i=n("./ArrayReader");function l(r){i.call(this,r)}n("../utils").inherits(l,i),l.prototype.readData=function(r){if(this.checkOffset(r),r===0)return new Uint8Array(0);var o=this.data.subarray(this.zero+this.index,this.zero+this.index+r);return this.index+=r,o},a.exports=l},{"../utils":32,"./ArrayReader":17}],22:[function(n,a,s){var i=n("../utils"),l=n("../support"),r=n("./ArrayReader"),o=n("./StringReader"),u=n("./NodeBufferReader"),h=n("./Uint8ArrayReader");a.exports=function(m){var g=i.getTypeOf(m);return i.checkSupport(g),g!=="string"||l.uint8array?g==="nodebuffer"?new u(m):l.uint8array?new h(i.transformTo("uint8array",m)):new r(i.transformTo("array",m)):new o(m)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,a,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,a,s){var i=n("./GenericWorker"),l=n("../utils");function r(o){i.call(this,"ConvertWorker to "+o),this.destType=o}l.inherits(r,i),r.prototype.processChunk=function(o){this.push({data:l.transformTo(this.destType,o.data),meta:o.meta})},a.exports=r},{"../utils":32,"./GenericWorker":28}],25:[function(n,a,s){var i=n("./GenericWorker"),l=n("../crc32");function r(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(r,i),r.prototype.processChunk=function(o){this.streamInfo.crc32=l(o.data,this.streamInfo.crc32||0),this.push(o)},a.exports=r},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,a,s){var i=n("../utils"),l=n("./GenericWorker");function r(o){l.call(this,"DataLengthProbe for "+o),this.propName=o,this.withStreamInfo(o,0)}i.inherits(r,l),r.prototype.processChunk=function(o){if(o){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+o.data.length}l.prototype.processChunk.call(this,o)},a.exports=r},{"../utils":32,"./GenericWorker":28}],27:[function(n,a,s){var i=n("../utils"),l=n("./GenericWorker");function r(o){l.call(this,"DataWorker");var u=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,o.then(function(h){u.dataIsReady=!0,u.data=h,u.max=h&&h.length||0,u.type=i.getTypeOf(h),u.isPaused||u._tickAndRepeat()},function(h){u.error(h)})}i.inherits(r,l),r.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this.data=null},r.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},r.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},r.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var o=null,u=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":o=this.data.substring(this.index,u);break;case"uint8array":o=this.data.subarray(this.index,u);break;case"array":case"nodebuffer":o=this.data.slice(this.index,u)}return this.index=u,this.push({data:o,meta:{percent:this.max?this.index/this.max*100:0}})},a.exports=r},{"../utils":32,"./GenericWorker":28}],28:[function(n,a,s){function i(l){this.name=l||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(l){this.emit("data",l)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(l){this.emit("error",l)}return!0},error:function(l){return!this.isFinished&&(this.isPaused?this.generatedError=l:(this.isFinished=!0,this.emit("error",l),this.previous&&this.previous.error(l),this.cleanUp()),!0)},on:function(l,r){return this._listeners[l].push(r),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(l,r){if(this._listeners[l])for(var o=0;o<this._listeners[l].length;o++)this._listeners[l][o].call(this,r)},pipe:function(l){return l.registerPrevious(this)},registerPrevious:function(l){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=l.streamInfo,this.mergeStreamInfo(),this.previous=l;var r=this;return l.on("data",function(o){r.processChunk(o)}),l.on("end",function(){r.end()}),l.on("error",function(o){r.error(o)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var l=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),l=!0),this.previous&&this.previous.resume(),!l},flush:function(){},processChunk:function(l){this.push(l)},withStreamInfo:function(l,r){return this.extraStreamInfo[l]=r,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var l in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(l)&&(this.streamInfo[l]=this.extraStreamInfo[l])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var l="Worker "+this.name;return this.previous?this.previous+" -> "+l:l}},a.exports=i},{}],29:[function(n,a,s){var i=n("../utils"),l=n("./ConvertWorker"),r=n("./GenericWorker"),o=n("../base64"),u=n("../support"),h=n("../external"),m=null;if(u.nodestream)try{m=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function g(p,_){return new h.Promise(function(y,b){var v=[],S=p._internalType,L=p._outputType,D=p._mimeType;p.on("data",function(O,M){v.push(O),_&&_(M)}).on("error",function(O){v=[],b(O)}).on("end",function(){try{var O=function(M,X,$){switch(M){case"blob":return i.newBlob(i.transformTo("arraybuffer",X),$);case"base64":return o.encode(X);default:return i.transformTo(M,X)}}(L,function(M,X){var $,Y=0,K=null,C=0;for($=0;$<X.length;$++)C+=X[$].length;switch(M){case"string":return X.join("");case"array":return Array.prototype.concat.apply([],X);case"uint8array":for(K=new Uint8Array(C),$=0;$<X.length;$++)K.set(X[$],Y),Y+=X[$].length;return K;case"nodebuffer":return Buffer.concat(X);default:throw new Error("concat : unsupported type '"+M+"'")}}(S,v),D);y(O)}catch(M){b(M)}v=[]}).resume()})}function c(p,_,y){var b=_;switch(_){case"blob":case"arraybuffer":b="uint8array";break;case"base64":b="string"}try{this._internalType=b,this._outputType=_,this._mimeType=y,i.checkSupport(b),this._worker=p.pipe(new l(b)),p.lock()}catch(v){this._worker=new r("error"),this._worker.error(v)}}c.prototype={accumulate:function(p){return g(this,p)},on:function(p,_){var y=this;return p==="data"?this._worker.on(p,function(b){_.call(y,b.data,b.meta)}):this._worker.on(p,function(){i.delay(_,arguments,y)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(p){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new m(this,{objectMode:this._outputType!=="nodebuffer"},p)}},a.exports=c},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,a,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",s.nodebuffer=typeof Buffer!="undefined",s.uint8array=typeof Uint8Array!="undefined",typeof ArrayBuffer=="undefined")s.blob=!1;else{var i=new ArrayBuffer(0);try{s.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var l=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);l.append(i),s.blob=l.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!n("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(n,a,s){for(var i=n("./utils"),l=n("./support"),r=n("./nodejsUtils"),o=n("./stream/GenericWorker"),u=new Array(256),h=0;h<256;h++)u[h]=252<=h?6:248<=h?5:240<=h?4:224<=h?3:192<=h?2:1;u[254]=u[254]=1;function m(){o.call(this,"utf-8 decode"),this.leftOver=null}function g(){o.call(this,"utf-8 encode")}s.utf8encode=function(c){return l.nodebuffer?r.newBufferFrom(c,"utf-8"):function(p){var _,y,b,v,S,L=p.length,D=0;for(v=0;v<L;v++)(64512&(y=p.charCodeAt(v)))==55296&&v+1<L&&(64512&(b=p.charCodeAt(v+1)))==56320&&(y=65536+(y-55296<<10)+(b-56320),v++),D+=y<128?1:y<2048?2:y<65536?3:4;for(_=l.uint8array?new Uint8Array(D):new Array(D),v=S=0;S<D;v++)(64512&(y=p.charCodeAt(v)))==55296&&v+1<L&&(64512&(b=p.charCodeAt(v+1)))==56320&&(y=65536+(y-55296<<10)+(b-56320),v++),y<128?_[S++]=y:(y<2048?_[S++]=192|y>>>6:(y<65536?_[S++]=224|y>>>12:(_[S++]=240|y>>>18,_[S++]=128|y>>>12&63),_[S++]=128|y>>>6&63),_[S++]=128|63&y);return _}(c)},s.utf8decode=function(c){return l.nodebuffer?i.transformTo("nodebuffer",c).toString("utf-8"):function(p){var _,y,b,v,S=p.length,L=new Array(2*S);for(_=y=0;_<S;)if((b=p[_++])<128)L[y++]=b;else if(4<(v=u[b]))L[y++]=65533,_+=v-1;else{for(b&=v===2?31:v===3?15:7;1<v&&_<S;)b=b<<6|63&p[_++],v--;1<v?L[y++]=65533:b<65536?L[y++]=b:(b-=65536,L[y++]=55296|b>>10&1023,L[y++]=56320|1023&b)}return L.length!==y&&(L.subarray?L=L.subarray(0,y):L.length=y),i.applyFromCharCode(L)}(c=i.transformTo(l.uint8array?"uint8array":"array",c))},i.inherits(m,o),m.prototype.processChunk=function(c){var p=i.transformTo(l.uint8array?"uint8array":"array",c.data);if(this.leftOver&&this.leftOver.length){if(l.uint8array){var _=p;(p=new Uint8Array(_.length+this.leftOver.length)).set(this.leftOver,0),p.set(_,this.leftOver.length)}else p=this.leftOver.concat(p);this.leftOver=null}var y=function(v,S){var L;for((S=S||v.length)>v.length&&(S=v.length),L=S-1;0<=L&&(192&v[L])==128;)L--;return L<0||L===0?S:L+u[v[L]]>S?L:S}(p),b=p;y!==p.length&&(l.uint8array?(b=p.subarray(0,y),this.leftOver=p.subarray(y,p.length)):(b=p.slice(0,y),this.leftOver=p.slice(y,p.length))),this.push({data:s.utf8decode(b),meta:c.meta})},m.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=m,i.inherits(g,o),g.prototype.processChunk=function(c){this.push({data:s.utf8encode(c.data),meta:c.meta})},s.Utf8EncodeWorker=g},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,a,s){var i=n("./support"),l=n("./base64"),r=n("./nodejsUtils"),o=n("./external");function u(_){return _}function h(_,y){for(var b=0;b<_.length;++b)y[b]=255&_.charCodeAt(b);return y}n("setimmediate"),s.newBlob=function(_,y){s.checkSupport("blob");try{return new Blob([_],{type:y})}catch{try{var b=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return b.append(_),b.getBlob(y)}catch{throw new Error("Bug : can't construct the Blob.")}}};var m={stringifyByChunk:function(_,y,b){var v=[],S=0,L=_.length;if(L<=b)return String.fromCharCode.apply(null,_);for(;S<L;)y==="array"||y==="nodebuffer"?v.push(String.fromCharCode.apply(null,_.slice(S,Math.min(S+b,L)))):v.push(String.fromCharCode.apply(null,_.subarray(S,Math.min(S+b,L)))),S+=b;return v.join("")},stringifyByChar:function(_){for(var y="",b=0;b<_.length;b++)y+=String.fromCharCode(_[b]);return y},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,r.allocBuffer(1)).length===1}catch{return!1}}()}};function g(_){var y=65536,b=s.getTypeOf(_),v=!0;if(b==="uint8array"?v=m.applyCanBeUsed.uint8array:b==="nodebuffer"&&(v=m.applyCanBeUsed.nodebuffer),v)for(;1<y;)try{return m.stringifyByChunk(_,b,y)}catch{y=Math.floor(y/2)}return m.stringifyByChar(_)}function c(_,y){for(var b=0;b<_.length;b++)y[b]=_[b];return y}s.applyFromCharCode=g;var p={};p.string={string:u,array:function(_){return h(_,new Array(_.length))},arraybuffer:function(_){return p.string.uint8array(_).buffer},uint8array:function(_){return h(_,new Uint8Array(_.length))},nodebuffer:function(_){return h(_,r.allocBuffer(_.length))}},p.array={string:g,array:u,arraybuffer:function(_){return new Uint8Array(_).buffer},uint8array:function(_){return new Uint8Array(_)},nodebuffer:function(_){return r.newBufferFrom(_)}},p.arraybuffer={string:function(_){return g(new Uint8Array(_))},array:function(_){return c(new Uint8Array(_),new Array(_.byteLength))},arraybuffer:u,uint8array:function(_){return new Uint8Array(_)},nodebuffer:function(_){return r.newBufferFrom(new Uint8Array(_))}},p.uint8array={string:g,array:function(_){return c(_,new Array(_.length))},arraybuffer:function(_){return _.buffer},uint8array:u,nodebuffer:function(_){return r.newBufferFrom(_)}},p.nodebuffer={string:g,array:function(_){return c(_,new Array(_.length))},arraybuffer:function(_){return p.nodebuffer.uint8array(_).buffer},uint8array:function(_){return c(_,new Uint8Array(_.length))},nodebuffer:u},s.transformTo=function(_,y){if(y=y||"",!_)return y;s.checkSupport(_);var b=s.getTypeOf(y);return p[b][_](y)},s.resolve=function(_){for(var y=_.split("/"),b=[],v=0;v<y.length;v++){var S=y[v];S==="."||S===""&&v!==0&&v!==y.length-1||(S===".."?b.pop():b.push(S))}return b.join("/")},s.getTypeOf=function(_){return typeof _=="string"?"string":Object.prototype.toString.call(_)==="[object Array]"?"array":i.nodebuffer&&r.isBuffer(_)?"nodebuffer":i.uint8array&&_ instanceof Uint8Array?"uint8array":i.arraybuffer&&_ instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(_){if(!i[_.toLowerCase()])throw new Error(_+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(_){var y,b,v="";for(b=0;b<(_||"").length;b++)v+="\\x"+((y=_.charCodeAt(b))<16?"0":"")+y.toString(16).toUpperCase();return v},s.delay=function(_,y,b){setImmediate(function(){_.apply(b||null,y||[])})},s.inherits=function(_,y){function b(){}b.prototype=y.prototype,_.prototype=new b},s.extend=function(){var _,y,b={};for(_=0;_<arguments.length;_++)for(y in arguments[_])arguments[_].hasOwnProperty(y)&&b[y]===void 0&&(b[y]=arguments[_][y]);return b},s.prepareContent=function(_,y,b,v,S){return o.Promise.resolve(y).then(function(L){return i.blob&&(L instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(L))!==-1)&&typeof FileReader!="undefined"?new o.Promise(function(D,O){var M=new FileReader;M.onload=function(X){D(X.target.result)},M.onerror=function(X){O(X.target.error)},M.readAsArrayBuffer(L)}):L}).then(function(L){var D=s.getTypeOf(L);return D?(D==="arraybuffer"?L=s.transformTo("uint8array",L):D==="string"&&(S?L=l.decode(L):b&&v!==!0&&(L=function(O){return h(O,i.uint8array?new Uint8Array(O.length):new Array(O.length))}(L))),L):o.Promise.reject(new Error("Can't read the data of '"+_+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,a,s){var i=n("./reader/readerFor"),l=n("./utils"),r=n("./signature"),o=n("./zipEntry"),u=(n("./utf8"),n("./support"));function h(m){this.files=[],this.loadOptions=m}h.prototype={checkSignature:function(m){if(!this.reader.readAndCheckSignature(m)){this.reader.index-=4;var g=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+l.pretty(g)+", expected "+l.pretty(m)+")")}},isSignature:function(m,g){var c=this.reader.index;this.reader.setIndex(m);var p=this.reader.readString(4)===g;return this.reader.setIndex(c),p},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var m=this.reader.readData(this.zipCommentLength),g=u.uint8array?"uint8array":"array",c=l.transformTo(g,m);this.zipComment=this.loadOptions.decodeFileName(c)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var m,g,c,p=this.zip64EndOfCentralSize-44;0<p;)m=this.reader.readInt(2),g=this.reader.readInt(4),c=this.reader.readData(g),this.zip64ExtensibleData[m]={id:m,length:g,value:c}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var m,g;for(m=0;m<this.files.length;m++)g=this.files[m],this.reader.setIndex(g.localHeaderOffset),this.checkSignature(r.LOCAL_FILE_HEADER),g.readLocalPart(this.reader),g.handleUTF8(),g.processAttributes()},readCentralDir:function(){var m;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(r.CENTRAL_FILE_HEADER);)(m=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(m);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var m=this.reader.lastIndexOfSignature(r.CENTRAL_DIRECTORY_END);if(m<0)throw this.isSignature(0,r.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(m);var g=m;if(this.checkSignature(r.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===l.MAX_VALUE_16BITS||this.diskWithCentralDirStart===l.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===l.MAX_VALUE_16BITS||this.centralDirRecords===l.MAX_VALUE_16BITS||this.centralDirSize===l.MAX_VALUE_32BITS||this.centralDirOffset===l.MAX_VALUE_32BITS){if(this.zip64=!0,(m=this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(m),this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,r.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var c=this.centralDirOffset+this.centralDirSize;this.zip64&&(c+=20,c+=12+this.zip64EndOfCentralSize);var p=g-c;if(0<p)this.isSignature(g,r.CENTRAL_FILE_HEADER)||(this.reader.zero=p);else if(p<0)throw new Error("Corrupted zip: missing "+Math.abs(p)+" bytes.")},prepareReader:function(m){this.reader=i(m)},load:function(m){this.prepareReader(m),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},a.exports=h},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(n,a,s){var i=n("./reader/readerFor"),l=n("./utils"),r=n("./compressedObject"),o=n("./crc32"),u=n("./utf8"),h=n("./compressions"),m=n("./support");function g(c,p){this.options=c,this.loadOptions=p}g.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(c){var p,_;if(c.skip(22),this.fileNameLength=c.readInt(2),_=c.readInt(2),this.fileName=c.readData(this.fileNameLength),c.skip(_),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((p=function(y){for(var b in h)if(h.hasOwnProperty(b)&&h[b].magic===y)return h[b];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+l.pretty(this.compressionMethod)+" unknown (inner file : "+l.transformTo("string",this.fileName)+")");this.decompressed=new r(this.compressedSize,this.uncompressedSize,this.crc32,p,c.readData(this.compressedSize))},readCentralPart:function(c){this.versionMadeBy=c.readInt(2),c.skip(2),this.bitFlag=c.readInt(2),this.compressionMethod=c.readString(2),this.date=c.readDate(),this.crc32=c.readInt(4),this.compressedSize=c.readInt(4),this.uncompressedSize=c.readInt(4);var p=c.readInt(2);if(this.extraFieldsLength=c.readInt(2),this.fileCommentLength=c.readInt(2),this.diskNumberStart=c.readInt(2),this.internalFileAttributes=c.readInt(2),this.externalFileAttributes=c.readInt(4),this.localHeaderOffset=c.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");c.skip(p),this.readExtraFields(c),this.parseZIP64ExtraField(c),this.fileComment=c.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var c=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),c==0&&(this.dosPermissions=63&this.externalFileAttributes),c==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(c){if(this.extraFields[1]){var p=i(this.extraFields[1].value);this.uncompressedSize===l.MAX_VALUE_32BITS&&(this.uncompressedSize=p.readInt(8)),this.compressedSize===l.MAX_VALUE_32BITS&&(this.compressedSize=p.readInt(8)),this.localHeaderOffset===l.MAX_VALUE_32BITS&&(this.localHeaderOffset=p.readInt(8)),this.diskNumberStart===l.MAX_VALUE_32BITS&&(this.diskNumberStart=p.readInt(4))}},readExtraFields:function(c){var p,_,y,b=c.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});c.index+4<b;)p=c.readInt(2),_=c.readInt(2),y=c.readData(_),this.extraFields[p]={id:p,length:_,value:y};c.setIndex(b)},handleUTF8:function(){var c=m.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var p=this.findExtraFieldUnicodePath();if(p!==null)this.fileNameStr=p;else{var _=l.transformTo(c,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(_)}var y=this.findExtraFieldUnicodeComment();if(y!==null)this.fileCommentStr=y;else{var b=l.transformTo(c,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(b)}}},findExtraFieldUnicodePath:function(){var c=this.extraFields[28789];if(c){var p=i(c.value);return p.readInt(1)!==1||o(this.fileName)!==p.readInt(4)?null:u.utf8decode(p.readData(c.length-5))}return null},findExtraFieldUnicodeComment:function(){var c=this.extraFields[25461];if(c){var p=i(c.value);return p.readInt(1)!==1||o(this.fileComment)!==p.readInt(4)?null:u.utf8decode(p.readData(c.length-5))}return null}},a.exports=g},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,a,s){function i(p,_,y){this.name=p,this.dir=y.dir,this.date=y.date,this.comment=y.comment,this.unixPermissions=y.unixPermissions,this.dosPermissions=y.dosPermissions,this._data=_,this._dataBinary=y.binary,this.options={compression:y.compression,compressionOptions:y.compressionOptions}}var l=n("./stream/StreamHelper"),r=n("./stream/DataWorker"),o=n("./utf8"),u=n("./compressedObject"),h=n("./stream/GenericWorker");i.prototype={internalStream:function(p){var _=null,y="string";try{if(!p)throw new Error("No output type specified.");var b=(y=p.toLowerCase())==="string"||y==="text";y!=="binarystring"&&y!=="text"||(y="string"),_=this._decompressWorker();var v=!this._dataBinary;v&&!b&&(_=_.pipe(new o.Utf8EncodeWorker)),!v&&b&&(_=_.pipe(new o.Utf8DecodeWorker))}catch(S){(_=new h("error")).error(S)}return new l(_,y,"")},async:function(p,_){return this.internalStream(p).accumulate(_)},nodeStream:function(p,_){return this.internalStream(p||"nodebuffer").toNodejsStream(_)},_compressWorker:function(p,_){if(this._data instanceof u&&this._data.compression.magic===p.magic)return this._data.getCompressedWorker();var y=this._decompressWorker();return this._dataBinary||(y=y.pipe(new o.Utf8EncodeWorker)),u.createWorkerFrom(y,p,_)},_decompressWorker:function(){return this._data instanceof u?this._data.getContentWorker():this._data instanceof h?this._data:new r(this._data)}};for(var m=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],g=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},c=0;c<m.length;c++)i.prototype[m[c]]=g;a.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,a,s){(function(i){var l,r,o=i.MutationObserver||i.WebKitMutationObserver;if(o){var u=0,h=new o(p),m=i.document.createTextNode("");h.observe(m,{characterData:!0}),l=function(){m.data=u=++u%2}}else if(i.setImmediate||i.MessageChannel===void 0)l="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var _=i.document.createElement("script");_.onreadystatechange=function(){p(),_.onreadystatechange=null,_.parentNode.removeChild(_),_=null},i.document.documentElement.appendChild(_)}:function(){setTimeout(p,0)};else{var g=new i.MessageChannel;g.port1.onmessage=p,l=function(){g.port2.postMessage(0)}}var c=[];function p(){var _,y;r=!0;for(var b=c.length;b;){for(y=c,c=[],_=-1;++_<b;)y[_]();b=c.length}r=!1}a.exports=function(_){c.push(_)!==1||r||l()}}).call(this,typeof ei!="undefined"?ei:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],37:[function(n,a,s){var i=n("immediate");function l(){}var r={},o=["REJECTED"],u=["FULFILLED"],h=["PENDING"];function m(b){if(typeof b!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,b!==l&&_(this,b)}function g(b,v,S){this.promise=b,typeof v=="function"&&(this.onFulfilled=v,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function c(b,v,S){i(function(){var L;try{L=v(S)}catch(D){return r.reject(b,D)}L===b?r.reject(b,new TypeError("Cannot resolve promise with itself")):r.resolve(b,L)})}function p(b){var v=b&&b.then;if(b&&(typeof b=="object"||typeof b=="function")&&typeof v=="function")return function(){v.apply(b,arguments)}}function _(b,v){var S=!1;function L(M){S||(S=!0,r.reject(b,M))}function D(M){S||(S=!0,r.resolve(b,M))}var O=y(function(){v(D,L)});O.status==="error"&&L(O.value)}function y(b,v){var S={};try{S.value=b(v),S.status="success"}catch(L){S.status="error",S.value=L}return S}(a.exports=m).prototype.finally=function(b){if(typeof b!="function")return this;var v=this.constructor;return this.then(function(S){return v.resolve(b()).then(function(){return S})},function(S){return v.resolve(b()).then(function(){throw S})})},m.prototype.catch=function(b){return this.then(null,b)},m.prototype.then=function(b,v){if(typeof b!="function"&&this.state===u||typeof v!="function"&&this.state===o)return this;var S=new this.constructor(l);return this.state!==h?c(S,this.state===u?b:v,this.outcome):this.queue.push(new g(S,b,v)),S},g.prototype.callFulfilled=function(b){r.resolve(this.promise,b)},g.prototype.otherCallFulfilled=function(b){c(this.promise,this.onFulfilled,b)},g.prototype.callRejected=function(b){r.reject(this.promise,b)},g.prototype.otherCallRejected=function(b){c(this.promise,this.onRejected,b)},r.resolve=function(b,v){var S=y(p,v);if(S.status==="error")return r.reject(b,S.value);var L=S.value;if(L)_(b,L);else{b.state=u,b.outcome=v;for(var D=-1,O=b.queue.length;++D<O;)b.queue[D].callFulfilled(v)}return b},r.reject=function(b,v){b.state=o,b.outcome=v;for(var S=-1,L=b.queue.length;++S<L;)b.queue[S].callRejected(v);return b},m.resolve=function(b){return b instanceof this?b:r.resolve(new this(l),b)},m.reject=function(b){var v=new this(l);return r.reject(v,b)},m.all=function(b){var v=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=b.length,L=!1;if(!S)return this.resolve([]);for(var D=new Array(S),O=0,M=-1,X=new this(l);++M<S;)$(b[M],M);return X;function $(Y,K){v.resolve(Y).then(function(C){D[K]=C,++O!==S||L||(L=!0,r.resolve(X,D))},function(C){L||(L=!0,r.reject(X,C))})}},m.race=function(b){var v=this;if(Object.prototype.toString.call(b)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=b.length,L=!1;if(!S)return this.resolve([]);for(var D=-1,O=new this(l);++D<S;)M=b[D],v.resolve(M).then(function(X){L||(L=!0,r.resolve(O,X))},function(X){L||(L=!0,r.reject(O,X))});var M;return O}},{immediate:36}],38:[function(n,a,s){var i={};(0,n("./lib/utils/common").assign)(i,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),a.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,a,s){var i=n("./zlib/deflate"),l=n("./utils/common"),r=n("./utils/strings"),o=n("./zlib/messages"),u=n("./zlib/zstream"),h=Object.prototype.toString,m=0,g=-1,c=0,p=8;function _(b){if(!(this instanceof _))return new _(b);this.options=l.assign({level:g,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:c,to:""},b||{});var v=this.options;v.raw&&0<v.windowBits?v.windowBits=-v.windowBits:v.gzip&&0<v.windowBits&&v.windowBits<16&&(v.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var S=i.deflateInit2(this.strm,v.level,v.method,v.windowBits,v.memLevel,v.strategy);if(S!==m)throw new Error(o[S]);if(v.header&&i.deflateSetHeader(this.strm,v.header),v.dictionary){var L;if(L=typeof v.dictionary=="string"?r.string2buf(v.dictionary):h.call(v.dictionary)==="[object ArrayBuffer]"?new Uint8Array(v.dictionary):v.dictionary,(S=i.deflateSetDictionary(this.strm,L))!==m)throw new Error(o[S]);this._dict_set=!0}}function y(b,v){var S=new _(v);if(S.push(b,!0),S.err)throw S.msg||o[S.err];return S.result}_.prototype.push=function(b,v){var S,L,D=this.strm,O=this.options.chunkSize;if(this.ended)return!1;L=v===~~v?v:v===!0?4:0,typeof b=="string"?D.input=r.string2buf(b):h.call(b)==="[object ArrayBuffer]"?D.input=new Uint8Array(b):D.input=b,D.next_in=0,D.avail_in=D.input.length;do{if(D.avail_out===0&&(D.output=new l.Buf8(O),D.next_out=0,D.avail_out=O),(S=i.deflate(D,L))!==1&&S!==m)return this.onEnd(S),!(this.ended=!0);D.avail_out!==0&&(D.avail_in!==0||L!==4&&L!==2)||(this.options.to==="string"?this.onData(r.buf2binstring(l.shrinkBuf(D.output,D.next_out))):this.onData(l.shrinkBuf(D.output,D.next_out)))}while((0<D.avail_in||D.avail_out===0)&&S!==1);return L===4?(S=i.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===m):L!==2||(this.onEnd(m),!(D.avail_out=0))},_.prototype.onData=function(b){this.chunks.push(b)},_.prototype.onEnd=function(b){b===m&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},s.Deflate=_,s.deflate=y,s.deflateRaw=function(b,v){return(v=v||{}).raw=!0,y(b,v)},s.gzip=function(b,v){return(v=v||{}).gzip=!0,y(b,v)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,a,s){var i=n("./zlib/inflate"),l=n("./utils/common"),r=n("./utils/strings"),o=n("./zlib/constants"),u=n("./zlib/messages"),h=n("./zlib/zstream"),m=n("./zlib/gzheader"),g=Object.prototype.toString;function c(_){if(!(this instanceof c))return new c(_);this.options=l.assign({chunkSize:16384,windowBits:0,to:""},_||{});var y=this.options;y.raw&&0<=y.windowBits&&y.windowBits<16&&(y.windowBits=-y.windowBits,y.windowBits===0&&(y.windowBits=-15)),!(0<=y.windowBits&&y.windowBits<16)||_&&_.windowBits||(y.windowBits+=32),15<y.windowBits&&y.windowBits<48&&(15&y.windowBits)==0&&(y.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var b=i.inflateInit2(this.strm,y.windowBits);if(b!==o.Z_OK)throw new Error(u[b]);this.header=new m,i.inflateGetHeader(this.strm,this.header)}function p(_,y){var b=new c(y);if(b.push(_,!0),b.err)throw b.msg||u[b.err];return b.result}c.prototype.push=function(_,y){var b,v,S,L,D,O,M=this.strm,X=this.options.chunkSize,$=this.options.dictionary,Y=!1;if(this.ended)return!1;v=y===~~y?y:y===!0?o.Z_FINISH:o.Z_NO_FLUSH,typeof _=="string"?M.input=r.binstring2buf(_):g.call(_)==="[object ArrayBuffer]"?M.input=new Uint8Array(_):M.input=_,M.next_in=0,M.avail_in=M.input.length;do{if(M.avail_out===0&&(M.output=new l.Buf8(X),M.next_out=0,M.avail_out=X),(b=i.inflate(M,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&$&&(O=typeof $=="string"?r.string2buf($):g.call($)==="[object ArrayBuffer]"?new Uint8Array($):$,b=i.inflateSetDictionary(this.strm,O)),b===o.Z_BUF_ERROR&&Y===!0&&(b=o.Z_OK,Y=!1),b!==o.Z_STREAM_END&&b!==o.Z_OK)return this.onEnd(b),!(this.ended=!0);M.next_out&&(M.avail_out!==0&&b!==o.Z_STREAM_END&&(M.avail_in!==0||v!==o.Z_FINISH&&v!==o.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=r.utf8border(M.output,M.next_out),L=M.next_out-S,D=r.buf2string(M.output,S),M.next_out=L,M.avail_out=X-L,L&&l.arraySet(M.output,M.output,S,L,0),this.onData(D)):this.onData(l.shrinkBuf(M.output,M.next_out)))),M.avail_in===0&&M.avail_out===0&&(Y=!0)}while((0<M.avail_in||M.avail_out===0)&&b!==o.Z_STREAM_END);return b===o.Z_STREAM_END&&(v=o.Z_FINISH),v===o.Z_FINISH?(b=i.inflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===o.Z_OK):v!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(M.avail_out=0))},c.prototype.onData=function(_){this.chunks.push(_)},c.prototype.onEnd=function(_){_===o.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg},s.Inflate=c,s.inflate=p,s.inflateRaw=function(_,y){return(y=y||{}).raw=!0,p(_,y)},s.ungzip=p},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,a,s){var i=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";s.assign=function(o){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var h=u.shift();if(h){if(typeof h!="object")throw new TypeError(h+"must be non-object");for(var m in h)h.hasOwnProperty(m)&&(o[m]=h[m])}}return o},s.shrinkBuf=function(o,u){return o.length===u?o:o.subarray?o.subarray(0,u):(o.length=u,o)};var l={arraySet:function(o,u,h,m,g){if(u.subarray&&o.subarray)o.set(u.subarray(h,h+m),g);else for(var c=0;c<m;c++)o[g+c]=u[h+c]},flattenChunks:function(o){var u,h,m,g,c,p;for(u=m=0,h=o.length;u<h;u++)m+=o[u].length;for(p=new Uint8Array(m),u=g=0,h=o.length;u<h;u++)c=o[u],p.set(c,g),g+=c.length;return p}},r={arraySet:function(o,u,h,m,g){for(var c=0;c<m;c++)o[g+c]=u[h+c]},flattenChunks:function(o){return[].concat.apply([],o)}};s.setTyped=function(o){o?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,l)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,r))},s.setTyped(i)},{}],42:[function(n,a,s){var i=n("./common"),l=!0,r=!0;try{String.fromCharCode.apply(null,[0])}catch{l=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{r=!1}for(var o=new i.Buf8(256),u=0;u<256;u++)o[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;function h(m,g){if(g<65537&&(m.subarray&&r||!m.subarray&&l))return String.fromCharCode.apply(null,i.shrinkBuf(m,g));for(var c="",p=0;p<g;p++)c+=String.fromCharCode(m[p]);return c}o[254]=o[254]=1,s.string2buf=function(m){var g,c,p,_,y,b=m.length,v=0;for(_=0;_<b;_++)(64512&(c=m.charCodeAt(_)))==55296&&_+1<b&&(64512&(p=m.charCodeAt(_+1)))==56320&&(c=65536+(c-55296<<10)+(p-56320),_++),v+=c<128?1:c<2048?2:c<65536?3:4;for(g=new i.Buf8(v),_=y=0;y<v;_++)(64512&(c=m.charCodeAt(_)))==55296&&_+1<b&&(64512&(p=m.charCodeAt(_+1)))==56320&&(c=65536+(c-55296<<10)+(p-56320),_++),c<128?g[y++]=c:(c<2048?g[y++]=192|c>>>6:(c<65536?g[y++]=224|c>>>12:(g[y++]=240|c>>>18,g[y++]=128|c>>>12&63),g[y++]=128|c>>>6&63),g[y++]=128|63&c);return g},s.buf2binstring=function(m){return h(m,m.length)},s.binstring2buf=function(m){for(var g=new i.Buf8(m.length),c=0,p=g.length;c<p;c++)g[c]=m.charCodeAt(c);return g},s.buf2string=function(m,g){var c,p,_,y,b=g||m.length,v=new Array(2*b);for(c=p=0;c<b;)if((_=m[c++])<128)v[p++]=_;else if(4<(y=o[_]))v[p++]=65533,c+=y-1;else{for(_&=y===2?31:y===3?15:7;1<y&&c<b;)_=_<<6|63&m[c++],y--;1<y?v[p++]=65533:_<65536?v[p++]=_:(_-=65536,v[p++]=55296|_>>10&1023,v[p++]=56320|1023&_)}return h(v,p)},s.utf8border=function(m,g){var c;for((g=g||m.length)>m.length&&(g=m.length),c=g-1;0<=c&&(192&m[c])==128;)c--;return c<0||c===0?g:c+o[m[c]]>g?c:g}},{"./common":41}],43:[function(n,a,s){a.exports=function(i,l,r,o){for(var u=65535&i|0,h=i>>>16&65535|0,m=0;r!==0;){for(r-=m=2e3<r?2e3:r;h=h+(u=u+l[o++]|0)|0,--m;);u%=65521,h%=65521}return u|h<<16|0}},{}],44:[function(n,a,s){a.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,a,s){var i=function(){for(var l,r=[],o=0;o<256;o++){l=o;for(var u=0;u<8;u++)l=1&l?3988292384^l>>>1:l>>>1;r[o]=l}return r}();a.exports=function(l,r,o,u){var h=i,m=u+o;l^=-1;for(var g=u;g<m;g++)l=l>>>8^h[255&(l^r[g])];return-1^l}},{}],46:[function(n,a,s){var i,l=n("../utils/common"),r=n("./trees"),o=n("./adler32"),u=n("./crc32"),h=n("./messages"),m=0,g=4,c=0,p=-2,_=-1,y=4,b=2,v=8,S=9,L=286,D=30,O=19,M=2*L+1,X=15,$=3,Y=258,K=Y+$+1,C=42,N=113,d=1,k=2,J=3,j=4;function it(f,F){return f.msg=h[F],F}function U(f){return(f<<1)-(4<f?9:0)}function Q(f){for(var F=f.length;0<=--F;)f[F]=0}function A(f){var F=f.state,B=F.pending;B>f.avail_out&&(B=f.avail_out),B!==0&&(l.arraySet(f.output,F.pending_buf,F.pending_out,B,f.next_out),f.next_out+=B,F.pending_out+=B,f.total_out+=B,f.avail_out-=B,F.pending-=B,F.pending===0&&(F.pending_out=0))}function I(f,F){r._tr_flush_block(f,0<=f.block_start?f.block_start:-1,f.strstart-f.block_start,F),f.block_start=f.strstart,A(f.strm)}function et(f,F){f.pending_buf[f.pending++]=F}function q(f,F){f.pending_buf[f.pending++]=F>>>8&255,f.pending_buf[f.pending++]=255&F}function W(f,F){var B,w,E=f.max_chain_length,x=f.strstart,z=f.prev_length,H=f.nice_match,T=f.strstart>f.w_size-K?f.strstart-(f.w_size-K):0,G=f.window,Z=f.w_mask,V=f.prev,tt=f.strstart+Y,gt=G[x+z-1],st=G[x+z];f.prev_length>=f.good_match&&(E>>=2),H>f.lookahead&&(H=f.lookahead);do if(G[(B=F)+z]===st&&G[B+z-1]===gt&&G[B]===G[x]&&G[++B]===G[x+1]){x+=2,B++;do;while(G[++x]===G[++B]&&G[++x]===G[++B]&&G[++x]===G[++B]&&G[++x]===G[++B]&&G[++x]===G[++B]&&G[++x]===G[++B]&&G[++x]===G[++B]&&G[++x]===G[++B]&&x<tt);if(w=Y-(tt-x),x=tt-Y,z<w){if(f.match_start=F,H<=(z=w))break;gt=G[x+z-1],st=G[x+z]}}while((F=V[F&Z])>T&&--E!=0);return z<=f.lookahead?z:f.lookahead}function vt(f){var F,B,w,E,x,z,H,T,G,Z,V=f.w_size;do{if(E=f.window_size-f.lookahead-f.strstart,f.strstart>=V+(V-K)){for(l.arraySet(f.window,f.window,V,V,0),f.match_start-=V,f.strstart-=V,f.block_start-=V,F=B=f.hash_size;w=f.head[--F],f.head[F]=V<=w?w-V:0,--B;);for(F=B=V;w=f.prev[--F],f.prev[F]=V<=w?w-V:0,--B;);E+=V}if(f.strm.avail_in===0)break;if(z=f.strm,H=f.window,T=f.strstart+f.lookahead,G=E,Z=void 0,Z=z.avail_in,G<Z&&(Z=G),B=Z===0?0:(z.avail_in-=Z,l.arraySet(H,z.input,z.next_in,Z,T),z.state.wrap===1?z.adler=o(z.adler,H,Z,T):z.state.wrap===2&&(z.adler=u(z.adler,H,Z,T)),z.next_in+=Z,z.total_in+=Z,Z),f.lookahead+=B,f.lookahead+f.insert>=$)for(x=f.strstart-f.insert,f.ins_h=f.window[x],f.ins_h=(f.ins_h<<f.hash_shift^f.window[x+1])&f.hash_mask;f.insert&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[x+$-1])&f.hash_mask,f.prev[x&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=x,x++,f.insert--,!(f.lookahead+f.insert<$)););}while(f.lookahead<K&&f.strm.avail_in!==0)}function At(f,F){for(var B,w;;){if(f.lookahead<K){if(vt(f),f.lookahead<K&&F===m)return d;if(f.lookahead===0)break}if(B=0,f.lookahead>=$&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+$-1])&f.hash_mask,B=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart),B!==0&&f.strstart-B<=f.w_size-K&&(f.match_length=W(f,B)),f.match_length>=$)if(w=r._tr_tally(f,f.strstart-f.match_start,f.match_length-$),f.lookahead-=f.match_length,f.match_length<=f.max_lazy_match&&f.lookahead>=$){for(f.match_length--;f.strstart++,f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+$-1])&f.hash_mask,B=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart,--f.match_length!=0;);f.strstart++}else f.strstart+=f.match_length,f.match_length=0,f.ins_h=f.window[f.strstart],f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+1])&f.hash_mask;else w=r._tr_tally(f,0,f.window[f.strstart]),f.lookahead--,f.strstart++;if(w&&(I(f,!1),f.strm.avail_out===0))return d}return f.insert=f.strstart<$-1?f.strstart:$-1,F===g?(I(f,!0),f.strm.avail_out===0?J:j):f.last_lit&&(I(f,!1),f.strm.avail_out===0)?d:k}function rt(f,F){for(var B,w,E;;){if(f.lookahead<K){if(vt(f),f.lookahead<K&&F===m)return d;if(f.lookahead===0)break}if(B=0,f.lookahead>=$&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+$-1])&f.hash_mask,B=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart),f.prev_length=f.match_length,f.prev_match=f.match_start,f.match_length=$-1,B!==0&&f.prev_length<f.max_lazy_match&&f.strstart-B<=f.w_size-K&&(f.match_length=W(f,B),f.match_length<=5&&(f.strategy===1||f.match_length===$&&4096<f.strstart-f.match_start)&&(f.match_length=$-1)),f.prev_length>=$&&f.match_length<=f.prev_length){for(E=f.strstart+f.lookahead-$,w=r._tr_tally(f,f.strstart-1-f.prev_match,f.prev_length-$),f.lookahead-=f.prev_length-1,f.prev_length-=2;++f.strstart<=E&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+$-1])&f.hash_mask,B=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart),--f.prev_length!=0;);if(f.match_available=0,f.match_length=$-1,f.strstart++,w&&(I(f,!1),f.strm.avail_out===0))return d}else if(f.match_available){if((w=r._tr_tally(f,0,f.window[f.strstart-1]))&&I(f,!1),f.strstart++,f.lookahead--,f.strm.avail_out===0)return d}else f.match_available=1,f.strstart++,f.lookahead--}return f.match_available&&(w=r._tr_tally(f,0,f.window[f.strstart-1]),f.match_available=0),f.insert=f.strstart<$-1?f.strstart:$-1,F===g?(I(f,!0),f.strm.avail_out===0?J:j):f.last_lit&&(I(f,!1),f.strm.avail_out===0)?d:k}function ut(f,F,B,w,E){this.good_length=f,this.max_lazy=F,this.nice_length=B,this.max_chain=w,this.func=E}function Lt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=v,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new l.Buf16(2*M),this.dyn_dtree=new l.Buf16(2*(2*D+1)),this.bl_tree=new l.Buf16(2*(2*O+1)),Q(this.dyn_ltree),Q(this.dyn_dtree),Q(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new l.Buf16(X+1),this.heap=new l.Buf16(2*L+1),Q(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new l.Buf16(2*L+1),Q(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Et(f){var F;return f&&f.state?(f.total_in=f.total_out=0,f.data_type=b,(F=f.state).pending=0,F.pending_out=0,F.wrap<0&&(F.wrap=-F.wrap),F.status=F.wrap?C:N,f.adler=F.wrap===2?0:1,F.last_flush=m,r._tr_init(F),c):it(f,p)}function de(f){var F=Et(f);return F===c&&function(B){B.window_size=2*B.w_size,Q(B.head),B.max_lazy_match=i[B.level].max_lazy,B.good_match=i[B.level].good_length,B.nice_match=i[B.level].nice_length,B.max_chain_length=i[B.level].max_chain,B.strstart=0,B.block_start=0,B.lookahead=0,B.insert=0,B.match_length=B.prev_length=$-1,B.match_available=0,B.ins_h=0}(f.state),F}function ne(f,F,B,w,E,x){if(!f)return p;var z=1;if(F===_&&(F=6),w<0?(z=0,w=-w):15<w&&(z=2,w-=16),E<1||S<E||B!==v||w<8||15<w||F<0||9<F||x<0||y<x)return it(f,p);w===8&&(w=9);var H=new Lt;return(f.state=H).strm=f,H.wrap=z,H.gzhead=null,H.w_bits=w,H.w_size=1<<H.w_bits,H.w_mask=H.w_size-1,H.hash_bits=E+7,H.hash_size=1<<H.hash_bits,H.hash_mask=H.hash_size-1,H.hash_shift=~~((H.hash_bits+$-1)/$),H.window=new l.Buf8(2*H.w_size),H.head=new l.Buf16(H.hash_size),H.prev=new l.Buf16(H.w_size),H.lit_bufsize=1<<E+6,H.pending_buf_size=4*H.lit_bufsize,H.pending_buf=new l.Buf8(H.pending_buf_size),H.d_buf=1*H.lit_bufsize,H.l_buf=3*H.lit_bufsize,H.level=F,H.strategy=x,H.method=B,de(f)}i=[new ut(0,0,0,0,function(f,F){var B=65535;for(B>f.pending_buf_size-5&&(B=f.pending_buf_size-5);;){if(f.lookahead<=1){if(vt(f),f.lookahead===0&&F===m)return d;if(f.lookahead===0)break}f.strstart+=f.lookahead,f.lookahead=0;var w=f.block_start+B;if((f.strstart===0||f.strstart>=w)&&(f.lookahead=f.strstart-w,f.strstart=w,I(f,!1),f.strm.avail_out===0)||f.strstart-f.block_start>=f.w_size-K&&(I(f,!1),f.strm.avail_out===0))return d}return f.insert=0,F===g?(I(f,!0),f.strm.avail_out===0?J:j):(f.strstart>f.block_start&&(I(f,!1),f.strm.avail_out),d)}),new ut(4,4,8,4,At),new ut(4,5,16,8,At),new ut(4,6,32,32,At),new ut(4,4,16,16,rt),new ut(8,16,32,32,rt),new ut(8,16,128,128,rt),new ut(8,32,128,256,rt),new ut(32,128,258,1024,rt),new ut(32,258,258,4096,rt)],s.deflateInit=function(f,F){return ne(f,F,v,15,8,0)},s.deflateInit2=ne,s.deflateReset=de,s.deflateResetKeep=Et,s.deflateSetHeader=function(f,F){return f&&f.state?f.state.wrap!==2?p:(f.state.gzhead=F,c):p},s.deflate=function(f,F){var B,w,E,x;if(!f||!f.state||5<F||F<0)return f?it(f,p):p;if(w=f.state,!f.output||!f.input&&f.avail_in!==0||w.status===666&&F!==g)return it(f,f.avail_out===0?-5:p);if(w.strm=f,B=w.last_flush,w.last_flush=F,w.status===C)if(w.wrap===2)f.adler=0,et(w,31),et(w,139),et(w,8),w.gzhead?(et(w,(w.gzhead.text?1:0)+(w.gzhead.hcrc?2:0)+(w.gzhead.extra?4:0)+(w.gzhead.name?8:0)+(w.gzhead.comment?16:0)),et(w,255&w.gzhead.time),et(w,w.gzhead.time>>8&255),et(w,w.gzhead.time>>16&255),et(w,w.gzhead.time>>24&255),et(w,w.level===9?2:2<=w.strategy||w.level<2?4:0),et(w,255&w.gzhead.os),w.gzhead.extra&&w.gzhead.extra.length&&(et(w,255&w.gzhead.extra.length),et(w,w.gzhead.extra.length>>8&255)),w.gzhead.hcrc&&(f.adler=u(f.adler,w.pending_buf,w.pending,0)),w.gzindex=0,w.status=69):(et(w,0),et(w,0),et(w,0),et(w,0),et(w,0),et(w,w.level===9?2:2<=w.strategy||w.level<2?4:0),et(w,3),w.status=N);else{var z=v+(w.w_bits-8<<4)<<8;z|=(2<=w.strategy||w.level<2?0:w.level<6?1:w.level===6?2:3)<<6,w.strstart!==0&&(z|=32),z+=31-z%31,w.status=N,q(w,z),w.strstart!==0&&(q(w,f.adler>>>16),q(w,65535&f.adler)),f.adler=1}if(w.status===69)if(w.gzhead.extra){for(E=w.pending;w.gzindex<(65535&w.gzhead.extra.length)&&(w.pending!==w.pending_buf_size||(w.gzhead.hcrc&&w.pending>E&&(f.adler=u(f.adler,w.pending_buf,w.pending-E,E)),A(f),E=w.pending,w.pending!==w.pending_buf_size));)et(w,255&w.gzhead.extra[w.gzindex]),w.gzindex++;w.gzhead.hcrc&&w.pending>E&&(f.adler=u(f.adler,w.pending_buf,w.pending-E,E)),w.gzindex===w.gzhead.extra.length&&(w.gzindex=0,w.status=73)}else w.status=73;if(w.status===73)if(w.gzhead.name){E=w.pending;do{if(w.pending===w.pending_buf_size&&(w.gzhead.hcrc&&w.pending>E&&(f.adler=u(f.adler,w.pending_buf,w.pending-E,E)),A(f),E=w.pending,w.pending===w.pending_buf_size)){x=1;break}x=w.gzindex<w.gzhead.name.length?255&w.gzhead.name.charCodeAt(w.gzindex++):0,et(w,x)}while(x!==0);w.gzhead.hcrc&&w.pending>E&&(f.adler=u(f.adler,w.pending_buf,w.pending-E,E)),x===0&&(w.gzindex=0,w.status=91)}else w.status=91;if(w.status===91)if(w.gzhead.comment){E=w.pending;do{if(w.pending===w.pending_buf_size&&(w.gzhead.hcrc&&w.pending>E&&(f.adler=u(f.adler,w.pending_buf,w.pending-E,E)),A(f),E=w.pending,w.pending===w.pending_buf_size)){x=1;break}x=w.gzindex<w.gzhead.comment.length?255&w.gzhead.comment.charCodeAt(w.gzindex++):0,et(w,x)}while(x!==0);w.gzhead.hcrc&&w.pending>E&&(f.adler=u(f.adler,w.pending_buf,w.pending-E,E)),x===0&&(w.status=103)}else w.status=103;if(w.status===103&&(w.gzhead.hcrc?(w.pending+2>w.pending_buf_size&&A(f),w.pending+2<=w.pending_buf_size&&(et(w,255&f.adler),et(w,f.adler>>8&255),f.adler=0,w.status=N)):w.status=N),w.pending!==0){if(A(f),f.avail_out===0)return w.last_flush=-1,c}else if(f.avail_in===0&&U(F)<=U(B)&&F!==g)return it(f,-5);if(w.status===666&&f.avail_in!==0)return it(f,-5);if(f.avail_in!==0||w.lookahead!==0||F!==m&&w.status!==666){var H=w.strategy===2?function(T,G){for(var Z;;){if(T.lookahead===0&&(vt(T),T.lookahead===0)){if(G===m)return d;break}if(T.match_length=0,Z=r._tr_tally(T,0,T.window[T.strstart]),T.lookahead--,T.strstart++,Z&&(I(T,!1),T.strm.avail_out===0))return d}return T.insert=0,G===g?(I(T,!0),T.strm.avail_out===0?J:j):T.last_lit&&(I(T,!1),T.strm.avail_out===0)?d:k}(w,F):w.strategy===3?function(T,G){for(var Z,V,tt,gt,st=T.window;;){if(T.lookahead<=Y){if(vt(T),T.lookahead<=Y&&G===m)return d;if(T.lookahead===0)break}if(T.match_length=0,T.lookahead>=$&&0<T.strstart&&(V=st[tt=T.strstart-1])===st[++tt]&&V===st[++tt]&&V===st[++tt]){gt=T.strstart+Y;do;while(V===st[++tt]&&V===st[++tt]&&V===st[++tt]&&V===st[++tt]&&V===st[++tt]&&V===st[++tt]&&V===st[++tt]&&V===st[++tt]&&tt<gt);T.match_length=Y-(gt-tt),T.match_length>T.lookahead&&(T.match_length=T.lookahead)}if(T.match_length>=$?(Z=r._tr_tally(T,1,T.match_length-$),T.lookahead-=T.match_length,T.strstart+=T.match_length,T.match_length=0):(Z=r._tr_tally(T,0,T.window[T.strstart]),T.lookahead--,T.strstart++),Z&&(I(T,!1),T.strm.avail_out===0))return d}return T.insert=0,G===g?(I(T,!0),T.strm.avail_out===0?J:j):T.last_lit&&(I(T,!1),T.strm.avail_out===0)?d:k}(w,F):i[w.level].func(w,F);if(H!==J&&H!==j||(w.status=666),H===d||H===J)return f.avail_out===0&&(w.last_flush=-1),c;if(H===k&&(F===1?r._tr_align(w):F!==5&&(r._tr_stored_block(w,0,0,!1),F===3&&(Q(w.head),w.lookahead===0&&(w.strstart=0,w.block_start=0,w.insert=0))),A(f),f.avail_out===0))return w.last_flush=-1,c}return F!==g?c:w.wrap<=0?1:(w.wrap===2?(et(w,255&f.adler),et(w,f.adler>>8&255),et(w,f.adler>>16&255),et(w,f.adler>>24&255),et(w,255&f.total_in),et(w,f.total_in>>8&255),et(w,f.total_in>>16&255),et(w,f.total_in>>24&255)):(q(w,f.adler>>>16),q(w,65535&f.adler)),A(f),0<w.wrap&&(w.wrap=-w.wrap),w.pending!==0?c:1)},s.deflateEnd=function(f){var F;return f&&f.state?(F=f.state.status)!==C&&F!==69&&F!==73&&F!==91&&F!==103&&F!==N&&F!==666?it(f,p):(f.state=null,F===N?it(f,-3):c):p},s.deflateSetDictionary=function(f,F){var B,w,E,x,z,H,T,G,Z=F.length;if(!f||!f.state||(x=(B=f.state).wrap)===2||x===1&&B.status!==C||B.lookahead)return p;for(x===1&&(f.adler=o(f.adler,F,Z,0)),B.wrap=0,Z>=B.w_size&&(x===0&&(Q(B.head),B.strstart=0,B.block_start=0,B.insert=0),G=new l.Buf8(B.w_size),l.arraySet(G,F,Z-B.w_size,B.w_size,0),F=G,Z=B.w_size),z=f.avail_in,H=f.next_in,T=f.input,f.avail_in=Z,f.next_in=0,f.input=F,vt(B);B.lookahead>=$;){for(w=B.strstart,E=B.lookahead-($-1);B.ins_h=(B.ins_h<<B.hash_shift^B.window[w+$-1])&B.hash_mask,B.prev[w&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=w,w++,--E;);B.strstart=w,B.lookahead=$-1,vt(B)}return B.strstart+=B.lookahead,B.block_start=B.strstart,B.insert=B.lookahead,B.lookahead=0,B.match_length=B.prev_length=$-1,B.match_available=0,f.next_in=H,f.input=T,f.avail_in=z,B.wrap=x,c},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,a,s){a.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,a,s){a.exports=function(i,l){var r,o,u,h,m,g,c,p,_,y,b,v,S,L,D,O,M,X,$,Y,K,C,N,d,k;r=i.state,o=i.next_in,d=i.input,u=o+(i.avail_in-5),h=i.next_out,k=i.output,m=h-(l-i.avail_out),g=h+(i.avail_out-257),c=r.dmax,p=r.wsize,_=r.whave,y=r.wnext,b=r.window,v=r.hold,S=r.bits,L=r.lencode,D=r.distcode,O=(1<<r.lenbits)-1,M=(1<<r.distbits)-1;t:do{S<15&&(v+=d[o++]<<S,S+=8,v+=d[o++]<<S,S+=8),X=L[v&O];e:for(;;){if(v>>>=$=X>>>24,S-=$,($=X>>>16&255)===0)k[h++]=65535&X;else{if(!(16&$)){if((64&$)==0){X=L[(65535&X)+(v&(1<<$)-1)];continue e}if(32&$){r.mode=12;break t}i.msg="invalid literal/length code",r.mode=30;break t}Y=65535&X,($&=15)&&(S<$&&(v+=d[o++]<<S,S+=8),Y+=v&(1<<$)-1,v>>>=$,S-=$),S<15&&(v+=d[o++]<<S,S+=8,v+=d[o++]<<S,S+=8),X=D[v&M];n:for(;;){if(v>>>=$=X>>>24,S-=$,!(16&($=X>>>16&255))){if((64&$)==0){X=D[(65535&X)+(v&(1<<$)-1)];continue n}i.msg="invalid distance code",r.mode=30;break t}if(K=65535&X,S<($&=15)&&(v+=d[o++]<<S,(S+=8)<$&&(v+=d[o++]<<S,S+=8)),c<(K+=v&(1<<$)-1)){i.msg="invalid distance too far back",r.mode=30;break t}if(v>>>=$,S-=$,($=h-m)<K){if(_<($=K-$)&&r.sane){i.msg="invalid distance too far back",r.mode=30;break t}if(N=b,(C=0)===y){if(C+=p-$,$<Y){for(Y-=$;k[h++]=b[C++],--$;);C=h-K,N=k}}else if(y<$){if(C+=p+y-$,($-=y)<Y){for(Y-=$;k[h++]=b[C++],--$;);if(C=0,y<Y){for(Y-=$=y;k[h++]=b[C++],--$;);C=h-K,N=k}}}else if(C+=y-$,$<Y){for(Y-=$;k[h++]=b[C++],--$;);C=h-K,N=k}for(;2<Y;)k[h++]=N[C++],k[h++]=N[C++],k[h++]=N[C++],Y-=3;Y&&(k[h++]=N[C++],1<Y&&(k[h++]=N[C++]))}else{for(C=h-K;k[h++]=k[C++],k[h++]=k[C++],k[h++]=k[C++],2<(Y-=3););Y&&(k[h++]=k[C++],1<Y&&(k[h++]=k[C++]))}break}}break}}while(o<u&&h<g);o-=Y=S>>3,v&=(1<<(S-=Y<<3))-1,i.next_in=o,i.next_out=h,i.avail_in=o<u?u-o+5:5-(o-u),i.avail_out=h<g?g-h+257:257-(h-g),r.hold=v,r.bits=S}},{}],49:[function(n,a,s){var i=n("../utils/common"),l=n("./adler32"),r=n("./crc32"),o=n("./inffast"),u=n("./inftrees"),h=1,m=2,g=0,c=-2,p=1,_=852,y=592;function b(C){return(C>>>24&255)+(C>>>8&65280)+((65280&C)<<8)+((255&C)<<24)}function v(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(C){var N;return C&&C.state?(N=C.state,C.total_in=C.total_out=N.total=0,C.msg="",N.wrap&&(C.adler=1&N.wrap),N.mode=p,N.last=0,N.havedict=0,N.dmax=32768,N.head=null,N.hold=0,N.bits=0,N.lencode=N.lendyn=new i.Buf32(_),N.distcode=N.distdyn=new i.Buf32(y),N.sane=1,N.back=-1,g):c}function L(C){var N;return C&&C.state?((N=C.state).wsize=0,N.whave=0,N.wnext=0,S(C)):c}function D(C,N){var d,k;return C&&C.state?(k=C.state,N<0?(d=0,N=-N):(d=1+(N>>4),N<48&&(N&=15)),N&&(N<8||15<N)?c:(k.window!==null&&k.wbits!==N&&(k.window=null),k.wrap=d,k.wbits=N,L(C))):c}function O(C,N){var d,k;return C?(k=new v,(C.state=k).window=null,(d=D(C,N))!==g&&(C.state=null),d):c}var M,X,$=!0;function Y(C){if($){var N;for(M=new i.Buf32(512),X=new i.Buf32(32),N=0;N<144;)C.lens[N++]=8;for(;N<256;)C.lens[N++]=9;for(;N<280;)C.lens[N++]=7;for(;N<288;)C.lens[N++]=8;for(u(h,C.lens,0,288,M,0,C.work,{bits:9}),N=0;N<32;)C.lens[N++]=5;u(m,C.lens,0,32,X,0,C.work,{bits:5}),$=!1}C.lencode=M,C.lenbits=9,C.distcode=X,C.distbits=5}function K(C,N,d,k){var J,j=C.state;return j.window===null&&(j.wsize=1<<j.wbits,j.wnext=0,j.whave=0,j.window=new i.Buf8(j.wsize)),k>=j.wsize?(i.arraySet(j.window,N,d-j.wsize,j.wsize,0),j.wnext=0,j.whave=j.wsize):(k<(J=j.wsize-j.wnext)&&(J=k),i.arraySet(j.window,N,d-k,J,j.wnext),(k-=J)?(i.arraySet(j.window,N,d-k,k,0),j.wnext=k,j.whave=j.wsize):(j.wnext+=J,j.wnext===j.wsize&&(j.wnext=0),j.whave<j.wsize&&(j.whave+=J))),0}s.inflateReset=L,s.inflateReset2=D,s.inflateResetKeep=S,s.inflateInit=function(C){return O(C,15)},s.inflateInit2=O,s.inflate=function(C,N){var d,k,J,j,it,U,Q,A,I,et,q,W,vt,At,rt,ut,Lt,Et,de,ne,f,F,B,w,E=0,x=new i.Buf8(4),z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!C||!C.state||!C.output||!C.input&&C.avail_in!==0)return c;(d=C.state).mode===12&&(d.mode=13),it=C.next_out,J=C.output,Q=C.avail_out,j=C.next_in,k=C.input,U=C.avail_in,A=d.hold,I=d.bits,et=U,q=Q,F=g;t:for(;;)switch(d.mode){case p:if(d.wrap===0){d.mode=13;break}for(;I<16;){if(U===0)break t;U--,A+=k[j++]<<I,I+=8}if(2&d.wrap&&A===35615){x[d.check=0]=255&A,x[1]=A>>>8&255,d.check=r(d.check,x,2,0),I=A=0,d.mode=2;break}if(d.flags=0,d.head&&(d.head.done=!1),!(1&d.wrap)||(((255&A)<<8)+(A>>8))%31){C.msg="incorrect header check",d.mode=30;break}if((15&A)!=8){C.msg="unknown compression method",d.mode=30;break}if(I-=4,f=8+(15&(A>>>=4)),d.wbits===0)d.wbits=f;else if(f>d.wbits){C.msg="invalid window size",d.mode=30;break}d.dmax=1<<f,C.adler=d.check=1,d.mode=512&A?10:12,I=A=0;break;case 2:for(;I<16;){if(U===0)break t;U--,A+=k[j++]<<I,I+=8}if(d.flags=A,(255&d.flags)!=8){C.msg="unknown compression method",d.mode=30;break}if(57344&d.flags){C.msg="unknown header flags set",d.mode=30;break}d.head&&(d.head.text=A>>8&1),512&d.flags&&(x[0]=255&A,x[1]=A>>>8&255,d.check=r(d.check,x,2,0)),I=A=0,d.mode=3;case 3:for(;I<32;){if(U===0)break t;U--,A+=k[j++]<<I,I+=8}d.head&&(d.head.time=A),512&d.flags&&(x[0]=255&A,x[1]=A>>>8&255,x[2]=A>>>16&255,x[3]=A>>>24&255,d.check=r(d.check,x,4,0)),I=A=0,d.mode=4;case 4:for(;I<16;){if(U===0)break t;U--,A+=k[j++]<<I,I+=8}d.head&&(d.head.xflags=255&A,d.head.os=A>>8),512&d.flags&&(x[0]=255&A,x[1]=A>>>8&255,d.check=r(d.check,x,2,0)),I=A=0,d.mode=5;case 5:if(1024&d.flags){for(;I<16;){if(U===0)break t;U--,A+=k[j++]<<I,I+=8}d.length=A,d.head&&(d.head.extra_len=A),512&d.flags&&(x[0]=255&A,x[1]=A>>>8&255,d.check=r(d.check,x,2,0)),I=A=0}else d.head&&(d.head.extra=null);d.mode=6;case 6:if(1024&d.flags&&(U<(W=d.length)&&(W=U),W&&(d.head&&(f=d.head.extra_len-d.length,d.head.extra||(d.head.extra=new Array(d.head.extra_len)),i.arraySet(d.head.extra,k,j,W,f)),512&d.flags&&(d.check=r(d.check,k,W,j)),U-=W,j+=W,d.length-=W),d.length))break t;d.length=0,d.mode=7;case 7:if(2048&d.flags){if(U===0)break t;for(W=0;f=k[j+W++],d.head&&f&&d.length<65536&&(d.head.name+=String.fromCharCode(f)),f&&W<U;);if(512&d.flags&&(d.check=r(d.check,k,W,j)),U-=W,j+=W,f)break t}else d.head&&(d.head.name=null);d.length=0,d.mode=8;case 8:if(4096&d.flags){if(U===0)break t;for(W=0;f=k[j+W++],d.head&&f&&d.length<65536&&(d.head.comment+=String.fromCharCode(f)),f&&W<U;);if(512&d.flags&&(d.check=r(d.check,k,W,j)),U-=W,j+=W,f)break t}else d.head&&(d.head.comment=null);d.mode=9;case 9:if(512&d.flags){for(;I<16;){if(U===0)break t;U--,A+=k[j++]<<I,I+=8}if(A!==(65535&d.check)){C.msg="header crc mismatch",d.mode=30;break}I=A=0}d.head&&(d.head.hcrc=d.flags>>9&1,d.head.done=!0),C.adler=d.check=0,d.mode=12;break;case 10:for(;I<32;){if(U===0)break t;U--,A+=k[j++]<<I,I+=8}C.adler=d.check=b(A),I=A=0,d.mode=11;case 11:if(d.havedict===0)return C.next_out=it,C.avail_out=Q,C.next_in=j,C.avail_in=U,d.hold=A,d.bits=I,2;C.adler=d.check=1,d.mode=12;case 12:if(N===5||N===6)break t;case 13:if(d.last){A>>>=7&I,I-=7&I,d.mode=27;break}for(;I<3;){if(U===0)break t;U--,A+=k[j++]<<I,I+=8}switch(d.last=1&A,I-=1,3&(A>>>=1)){case 0:d.mode=14;break;case 1:if(Y(d),d.mode=20,N!==6)break;A>>>=2,I-=2;break t;case 2:d.mode=17;break;case 3:C.msg="invalid block type",d.mode=30}A>>>=2,I-=2;break;case 14:for(A>>>=7&I,I-=7&I;I<32;){if(U===0)break t;U--,A+=k[j++]<<I,I+=8}if((65535&A)!=(A>>>16^65535)){C.msg="invalid stored block lengths",d.mode=30;break}if(d.length=65535&A,I=A=0,d.mode=15,N===6)break t;case 15:d.mode=16;case 16:if(W=d.length){if(U<W&&(W=U),Q<W&&(W=Q),W===0)break t;i.arraySet(J,k,j,W,it),U-=W,j+=W,Q-=W,it+=W,d.length-=W;break}d.mode=12;break;case 17:for(;I<14;){if(U===0)break t;U--,A+=k[j++]<<I,I+=8}if(d.nlen=257+(31&A),A>>>=5,I-=5,d.ndist=1+(31&A),A>>>=5,I-=5,d.ncode=4+(15&A),A>>>=4,I-=4,286<d.nlen||30<d.ndist){C.msg="too many length or distance symbols",d.mode=30;break}d.have=0,d.mode=18;case 18:for(;d.have<d.ncode;){for(;I<3;){if(U===0)break t;U--,A+=k[j++]<<I,I+=8}d.lens[z[d.have++]]=7&A,A>>>=3,I-=3}for(;d.have<19;)d.lens[z[d.have++]]=0;if(d.lencode=d.lendyn,d.lenbits=7,B={bits:d.lenbits},F=u(0,d.lens,0,19,d.lencode,0,d.work,B),d.lenbits=B.bits,F){C.msg="invalid code lengths set",d.mode=30;break}d.have=0,d.mode=19;case 19:for(;d.have<d.nlen+d.ndist;){for(;ut=(E=d.lencode[A&(1<<d.lenbits)-1])>>>16&255,Lt=65535&E,!((rt=E>>>24)<=I);){if(U===0)break t;U--,A+=k[j++]<<I,I+=8}if(Lt<16)A>>>=rt,I-=rt,d.lens[d.have++]=Lt;else{if(Lt===16){for(w=rt+2;I<w;){if(U===0)break t;U--,A+=k[j++]<<I,I+=8}if(A>>>=rt,I-=rt,d.have===0){C.msg="invalid bit length repeat",d.mode=30;break}f=d.lens[d.have-1],W=3+(3&A),A>>>=2,I-=2}else if(Lt===17){for(w=rt+3;I<w;){if(U===0)break t;U--,A+=k[j++]<<I,I+=8}I-=rt,f=0,W=3+(7&(A>>>=rt)),A>>>=3,I-=3}else{for(w=rt+7;I<w;){if(U===0)break t;U--,A+=k[j++]<<I,I+=8}I-=rt,f=0,W=11+(127&(A>>>=rt)),A>>>=7,I-=7}if(d.have+W>d.nlen+d.ndist){C.msg="invalid bit length repeat",d.mode=30;break}for(;W--;)d.lens[d.have++]=f}}if(d.mode===30)break;if(d.lens[256]===0){C.msg="invalid code -- missing end-of-block",d.mode=30;break}if(d.lenbits=9,B={bits:d.lenbits},F=u(h,d.lens,0,d.nlen,d.lencode,0,d.work,B),d.lenbits=B.bits,F){C.msg="invalid literal/lengths set",d.mode=30;break}if(d.distbits=6,d.distcode=d.distdyn,B={bits:d.distbits},F=u(m,d.lens,d.nlen,d.ndist,d.distcode,0,d.work,B),d.distbits=B.bits,F){C.msg="invalid distances set",d.mode=30;break}if(d.mode=20,N===6)break t;case 20:d.mode=21;case 21:if(6<=U&&258<=Q){C.next_out=it,C.avail_out=Q,C.next_in=j,C.avail_in=U,d.hold=A,d.bits=I,o(C,q),it=C.next_out,J=C.output,Q=C.avail_out,j=C.next_in,k=C.input,U=C.avail_in,A=d.hold,I=d.bits,d.mode===12&&(d.back=-1);break}for(d.back=0;ut=(E=d.lencode[A&(1<<d.lenbits)-1])>>>16&255,Lt=65535&E,!((rt=E>>>24)<=I);){if(U===0)break t;U--,A+=k[j++]<<I,I+=8}if(ut&&(240&ut)==0){for(Et=rt,de=ut,ne=Lt;ut=(E=d.lencode[ne+((A&(1<<Et+de)-1)>>Et)])>>>16&255,Lt=65535&E,!(Et+(rt=E>>>24)<=I);){if(U===0)break t;U--,A+=k[j++]<<I,I+=8}A>>>=Et,I-=Et,d.back+=Et}if(A>>>=rt,I-=rt,d.back+=rt,d.length=Lt,ut===0){d.mode=26;break}if(32&ut){d.back=-1,d.mode=12;break}if(64&ut){C.msg="invalid literal/length code",d.mode=30;break}d.extra=15&ut,d.mode=22;case 22:if(d.extra){for(w=d.extra;I<w;){if(U===0)break t;U--,A+=k[j++]<<I,I+=8}d.length+=A&(1<<d.extra)-1,A>>>=d.extra,I-=d.extra,d.back+=d.extra}d.was=d.length,d.mode=23;case 23:for(;ut=(E=d.distcode[A&(1<<d.distbits)-1])>>>16&255,Lt=65535&E,!((rt=E>>>24)<=I);){if(U===0)break t;U--,A+=k[j++]<<I,I+=8}if((240&ut)==0){for(Et=rt,de=ut,ne=Lt;ut=(E=d.distcode[ne+((A&(1<<Et+de)-1)>>Et)])>>>16&255,Lt=65535&E,!(Et+(rt=E>>>24)<=I);){if(U===0)break t;U--,A+=k[j++]<<I,I+=8}A>>>=Et,I-=Et,d.back+=Et}if(A>>>=rt,I-=rt,d.back+=rt,64&ut){C.msg="invalid distance code",d.mode=30;break}d.offset=Lt,d.extra=15&ut,d.mode=24;case 24:if(d.extra){for(w=d.extra;I<w;){if(U===0)break t;U--,A+=k[j++]<<I,I+=8}d.offset+=A&(1<<d.extra)-1,A>>>=d.extra,I-=d.extra,d.back+=d.extra}if(d.offset>d.dmax){C.msg="invalid distance too far back",d.mode=30;break}d.mode=25;case 25:if(Q===0)break t;if(W=q-Q,d.offset>W){if((W=d.offset-W)>d.whave&&d.sane){C.msg="invalid distance too far back",d.mode=30;break}vt=W>d.wnext?(W-=d.wnext,d.wsize-W):d.wnext-W,W>d.length&&(W=d.length),At=d.window}else At=J,vt=it-d.offset,W=d.length;for(Q<W&&(W=Q),Q-=W,d.length-=W;J[it++]=At[vt++],--W;);d.length===0&&(d.mode=21);break;case 26:if(Q===0)break t;J[it++]=d.length,Q--,d.mode=21;break;case 27:if(d.wrap){for(;I<32;){if(U===0)break t;U--,A|=k[j++]<<I,I+=8}if(q-=Q,C.total_out+=q,d.total+=q,q&&(C.adler=d.check=d.flags?r(d.check,J,q,it-q):l(d.check,J,q,it-q)),q=Q,(d.flags?A:b(A))!==d.check){C.msg="incorrect data check",d.mode=30;break}I=A=0}d.mode=28;case 28:if(d.wrap&&d.flags){for(;I<32;){if(U===0)break t;U--,A+=k[j++]<<I,I+=8}if(A!==(4294967295&d.total)){C.msg="incorrect length check",d.mode=30;break}I=A=0}d.mode=29;case 29:F=1;break t;case 30:F=-3;break t;case 31:return-4;case 32:default:return c}return C.next_out=it,C.avail_out=Q,C.next_in=j,C.avail_in=U,d.hold=A,d.bits=I,(d.wsize||q!==C.avail_out&&d.mode<30&&(d.mode<27||N!==4))&&K(C,C.output,C.next_out,q-C.avail_out)?(d.mode=31,-4):(et-=C.avail_in,q-=C.avail_out,C.total_in+=et,C.total_out+=q,d.total+=q,d.wrap&&q&&(C.adler=d.check=d.flags?r(d.check,J,q,C.next_out-q):l(d.check,J,q,C.next_out-q)),C.data_type=d.bits+(d.last?64:0)+(d.mode===12?128:0)+(d.mode===20||d.mode===15?256:0),(et==0&&q===0||N===4)&&F===g&&(F=-5),F)},s.inflateEnd=function(C){if(!C||!C.state)return c;var N=C.state;return N.window&&(N.window=null),C.state=null,g},s.inflateGetHeader=function(C,N){var d;return C&&C.state?(2&(d=C.state).wrap)==0?c:((d.head=N).done=!1,g):c},s.inflateSetDictionary=function(C,N){var d,k=N.length;return C&&C.state?(d=C.state).wrap!==0&&d.mode!==11?c:d.mode===11&&l(1,N,k,0)!==d.check?-3:K(C,N,k,k)?(d.mode=31,-4):(d.havedict=1,g):c},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,a,s){var i=n("../utils/common"),l=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],r=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];a.exports=function(h,m,g,c,p,_,y,b){var v,S,L,D,O,M,X,$,Y,K=b.bits,C=0,N=0,d=0,k=0,J=0,j=0,it=0,U=0,Q=0,A=0,I=null,et=0,q=new i.Buf16(16),W=new i.Buf16(16),vt=null,At=0;for(C=0;C<=15;C++)q[C]=0;for(N=0;N<c;N++)q[m[g+N]]++;for(J=K,k=15;1<=k&&q[k]===0;k--);if(k<J&&(J=k),k===0)return p[_++]=20971520,p[_++]=20971520,b.bits=1,0;for(d=1;d<k&&q[d]===0;d++);for(J<d&&(J=d),C=U=1;C<=15;C++)if(U<<=1,(U-=q[C])<0)return-1;if(0<U&&(h===0||k!==1))return-1;for(W[1]=0,C=1;C<15;C++)W[C+1]=W[C]+q[C];for(N=0;N<c;N++)m[g+N]!==0&&(y[W[m[g+N]]++]=N);if(M=h===0?(I=vt=y,19):h===1?(I=l,et-=257,vt=r,At-=257,256):(I=o,vt=u,-1),C=d,O=_,it=N=A=0,L=-1,D=(Q=1<<(j=J))-1,h===1&&852<Q||h===2&&592<Q)return 1;for(;;){for(X=C-it,Y=y[N]<M?($=0,y[N]):y[N]>M?($=vt[At+y[N]],I[et+y[N]]):($=96,0),v=1<<C-it,d=S=1<<j;p[O+(A>>it)+(S-=v)]=X<<24|$<<16|Y|0,S!==0;);for(v=1<<C-1;A&v;)v>>=1;if(v!==0?(A&=v-1,A+=v):A=0,N++,--q[C]==0){if(C===k)break;C=m[g+y[N]]}if(J<C&&(A&D)!==L){for(it===0&&(it=J),O+=d,U=1<<(j=C-it);j+it<k&&!((U-=q[j+it])<=0);)j++,U<<=1;if(Q+=1<<j,h===1&&852<Q||h===2&&592<Q)return 1;p[L=A&D]=J<<24|j<<16|O-_|0}}return A!==0&&(p[O+A]=C-it<<24|64<<16|0),b.bits=J,0}},{"../utils/common":41}],51:[function(n,a,s){a.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,a,s){var i=n("../utils/common"),l=0,r=1;function o(E){for(var x=E.length;0<=--x;)E[x]=0}var u=0,h=29,m=256,g=m+1+h,c=30,p=19,_=2*g+1,y=15,b=16,v=7,S=256,L=16,D=17,O=18,M=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],X=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],$=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=new Array(2*(g+2));o(K);var C=new Array(2*c);o(C);var N=new Array(512);o(N);var d=new Array(256);o(d);var k=new Array(h);o(k);var J,j,it,U=new Array(c);function Q(E,x,z,H,T){this.static_tree=E,this.extra_bits=x,this.extra_base=z,this.elems=H,this.max_length=T,this.has_stree=E&&E.length}function A(E,x){this.dyn_tree=E,this.max_code=0,this.stat_desc=x}function I(E){return E<256?N[E]:N[256+(E>>>7)]}function et(E,x){E.pending_buf[E.pending++]=255&x,E.pending_buf[E.pending++]=x>>>8&255}function q(E,x,z){E.bi_valid>b-z?(E.bi_buf|=x<<E.bi_valid&65535,et(E,E.bi_buf),E.bi_buf=x>>b-E.bi_valid,E.bi_valid+=z-b):(E.bi_buf|=x<<E.bi_valid&65535,E.bi_valid+=z)}function W(E,x,z){q(E,z[2*x],z[2*x+1])}function vt(E,x){for(var z=0;z|=1&E,E>>>=1,z<<=1,0<--x;);return z>>>1}function At(E,x,z){var H,T,G=new Array(y+1),Z=0;for(H=1;H<=y;H++)G[H]=Z=Z+z[H-1]<<1;for(T=0;T<=x;T++){var V=E[2*T+1];V!==0&&(E[2*T]=vt(G[V]++,V))}}function rt(E){var x;for(x=0;x<g;x++)E.dyn_ltree[2*x]=0;for(x=0;x<c;x++)E.dyn_dtree[2*x]=0;for(x=0;x<p;x++)E.bl_tree[2*x]=0;E.dyn_ltree[2*S]=1,E.opt_len=E.static_len=0,E.last_lit=E.matches=0}function ut(E){8<E.bi_valid?et(E,E.bi_buf):0<E.bi_valid&&(E.pending_buf[E.pending++]=E.bi_buf),E.bi_buf=0,E.bi_valid=0}function Lt(E,x,z,H){var T=2*x,G=2*z;return E[T]<E[G]||E[T]===E[G]&&H[x]<=H[z]}function Et(E,x,z){for(var H=E.heap[z],T=z<<1;T<=E.heap_len&&(T<E.heap_len&&Lt(x,E.heap[T+1],E.heap[T],E.depth)&&T++,!Lt(x,H,E.heap[T],E.depth));)E.heap[z]=E.heap[T],z=T,T<<=1;E.heap[z]=H}function de(E,x,z){var H,T,G,Z,V=0;if(E.last_lit!==0)for(;H=E.pending_buf[E.d_buf+2*V]<<8|E.pending_buf[E.d_buf+2*V+1],T=E.pending_buf[E.l_buf+V],V++,H===0?W(E,T,x):(W(E,(G=d[T])+m+1,x),(Z=M[G])!==0&&q(E,T-=k[G],Z),W(E,G=I(--H),z),(Z=X[G])!==0&&q(E,H-=U[G],Z)),V<E.last_lit;);W(E,S,x)}function ne(E,x){var z,H,T,G=x.dyn_tree,Z=x.stat_desc.static_tree,V=x.stat_desc.has_stree,tt=x.stat_desc.elems,gt=-1;for(E.heap_len=0,E.heap_max=_,z=0;z<tt;z++)G[2*z]!==0?(E.heap[++E.heap_len]=gt=z,E.depth[z]=0):G[2*z+1]=0;for(;E.heap_len<2;)G[2*(T=E.heap[++E.heap_len]=gt<2?++gt:0)]=1,E.depth[T]=0,E.opt_len--,V&&(E.static_len-=Z[2*T+1]);for(x.max_code=gt,z=E.heap_len>>1;1<=z;z--)Et(E,G,z);for(T=tt;z=E.heap[1],E.heap[1]=E.heap[E.heap_len--],Et(E,G,1),H=E.heap[1],E.heap[--E.heap_max]=z,E.heap[--E.heap_max]=H,G[2*T]=G[2*z]+G[2*H],E.depth[T]=(E.depth[z]>=E.depth[H]?E.depth[z]:E.depth[H])+1,G[2*z+1]=G[2*H+1]=T,E.heap[1]=T++,Et(E,G,1),2<=E.heap_len;);E.heap[--E.heap_max]=E.heap[1],function(st,qt){var xn,fe,kn,wt,Gn,Fi,ye=qt.dyn_tree,Rr=qt.max_code,Ql=qt.stat_desc.static_tree,tc=qt.stat_desc.has_stree,ec=qt.stat_desc.extra_bits,Ir=qt.stat_desc.extra_base,Tn=qt.stat_desc.max_length,Vn=0;for(wt=0;wt<=y;wt++)st.bl_count[wt]=0;for(ye[2*st.heap[st.heap_max]+1]=0,xn=st.heap_max+1;xn<_;xn++)Tn<(wt=ye[2*ye[2*(fe=st.heap[xn])+1]+1]+1)&&(wt=Tn,Vn++),ye[2*fe+1]=wt,Rr<fe||(st.bl_count[wt]++,Gn=0,Ir<=fe&&(Gn=ec[fe-Ir]),Fi=ye[2*fe],st.opt_len+=Fi*(wt+Gn),tc&&(st.static_len+=Fi*(Ql[2*fe+1]+Gn)));if(Vn!==0){do{for(wt=Tn-1;st.bl_count[wt]===0;)wt--;st.bl_count[wt]--,st.bl_count[wt+1]+=2,st.bl_count[Tn]--,Vn-=2}while(0<Vn);for(wt=Tn;wt!==0;wt--)for(fe=st.bl_count[wt];fe!==0;)Rr<(kn=st.heap[--xn])||(ye[2*kn+1]!==wt&&(st.opt_len+=(wt-ye[2*kn+1])*ye[2*kn],ye[2*kn+1]=wt),fe--)}}(E,x),At(G,gt,E.bl_count)}function f(E,x,z){var H,T,G=-1,Z=x[1],V=0,tt=7,gt=4;for(Z===0&&(tt=138,gt=3),x[2*(z+1)+1]=65535,H=0;H<=z;H++)T=Z,Z=x[2*(H+1)+1],++V<tt&&T===Z||(V<gt?E.bl_tree[2*T]+=V:T!==0?(T!==G&&E.bl_tree[2*T]++,E.bl_tree[2*L]++):V<=10?E.bl_tree[2*D]++:E.bl_tree[2*O]++,G=T,gt=(V=0)===Z?(tt=138,3):T===Z?(tt=6,3):(tt=7,4))}function F(E,x,z){var H,T,G=-1,Z=x[1],V=0,tt=7,gt=4;for(Z===0&&(tt=138,gt=3),H=0;H<=z;H++)if(T=Z,Z=x[2*(H+1)+1],!(++V<tt&&T===Z)){if(V<gt)for(;W(E,T,E.bl_tree),--V!=0;);else T!==0?(T!==G&&(W(E,T,E.bl_tree),V--),W(E,L,E.bl_tree),q(E,V-3,2)):V<=10?(W(E,D,E.bl_tree),q(E,V-3,3)):(W(E,O,E.bl_tree),q(E,V-11,7));G=T,gt=(V=0)===Z?(tt=138,3):T===Z?(tt=6,3):(tt=7,4)}}o(U);var B=!1;function w(E,x,z,H){q(E,(u<<1)+(H?1:0),3),function(T,G,Z,V){ut(T),V&&(et(T,Z),et(T,~Z)),i.arraySet(T.pending_buf,T.window,G,Z,T.pending),T.pending+=Z}(E,x,z,!0)}s._tr_init=function(E){B||(function(){var x,z,H,T,G,Z=new Array(y+1);for(T=H=0;T<h-1;T++)for(k[T]=H,x=0;x<1<<M[T];x++)d[H++]=T;for(d[H-1]=T,T=G=0;T<16;T++)for(U[T]=G,x=0;x<1<<X[T];x++)N[G++]=T;for(G>>=7;T<c;T++)for(U[T]=G<<7,x=0;x<1<<X[T]-7;x++)N[256+G++]=T;for(z=0;z<=y;z++)Z[z]=0;for(x=0;x<=143;)K[2*x+1]=8,x++,Z[8]++;for(;x<=255;)K[2*x+1]=9,x++,Z[9]++;for(;x<=279;)K[2*x+1]=7,x++,Z[7]++;for(;x<=287;)K[2*x+1]=8,x++,Z[8]++;for(At(K,g+1,Z),x=0;x<c;x++)C[2*x+1]=5,C[2*x]=vt(x,5);J=new Q(K,M,m+1,g,y),j=new Q(C,X,0,c,y),it=new Q(new Array(0),$,0,p,v)}(),B=!0),E.l_desc=new A(E.dyn_ltree,J),E.d_desc=new A(E.dyn_dtree,j),E.bl_desc=new A(E.bl_tree,it),E.bi_buf=0,E.bi_valid=0,rt(E)},s._tr_stored_block=w,s._tr_flush_block=function(E,x,z,H){var T,G,Z=0;0<E.level?(E.strm.data_type===2&&(E.strm.data_type=function(V){var tt,gt=4093624447;for(tt=0;tt<=31;tt++,gt>>>=1)if(1&gt&&V.dyn_ltree[2*tt]!==0)return l;if(V.dyn_ltree[18]!==0||V.dyn_ltree[20]!==0||V.dyn_ltree[26]!==0)return r;for(tt=32;tt<m;tt++)if(V.dyn_ltree[2*tt]!==0)return r;return l}(E)),ne(E,E.l_desc),ne(E,E.d_desc),Z=function(V){var tt;for(f(V,V.dyn_ltree,V.l_desc.max_code),f(V,V.dyn_dtree,V.d_desc.max_code),ne(V,V.bl_desc),tt=p-1;3<=tt&&V.bl_tree[2*Y[tt]+1]===0;tt--);return V.opt_len+=3*(tt+1)+5+5+4,tt}(E),T=E.opt_len+3+7>>>3,(G=E.static_len+3+7>>>3)<=T&&(T=G)):T=G=z+5,z+4<=T&&x!==-1?w(E,x,z,H):E.strategy===4||G===T?(q(E,2+(H?1:0),3),de(E,K,C)):(q(E,4+(H?1:0),3),function(V,tt,gt,st){var qt;for(q(V,tt-257,5),q(V,gt-1,5),q(V,st-4,4),qt=0;qt<st;qt++)q(V,V.bl_tree[2*Y[qt]+1],3);F(V,V.dyn_ltree,tt-1),F(V,V.dyn_dtree,gt-1)}(E,E.l_desc.max_code+1,E.d_desc.max_code+1,Z+1),de(E,E.dyn_ltree,E.dyn_dtree)),rt(E),H&&ut(E)},s._tr_tally=function(E,x,z){return E.pending_buf[E.d_buf+2*E.last_lit]=x>>>8&255,E.pending_buf[E.d_buf+2*E.last_lit+1]=255&x,E.pending_buf[E.l_buf+E.last_lit]=255&z,E.last_lit++,x===0?E.dyn_ltree[2*z]++:(E.matches++,x--,E.dyn_ltree[2*(d[z]+m+1)]++,E.dyn_dtree[2*I(x)]++),E.last_lit===E.lit_bufsize-1},s._tr_align=function(E){q(E,2,3),W(E,S,K),function(x){x.bi_valid===16?(et(x,x.bi_buf),x.bi_buf=0,x.bi_valid=0):8<=x.bi_valid&&(x.pending_buf[x.pending++]=255&x.bi_buf,x.bi_buf>>=8,x.bi_valid-=8)}(E)}},{"../utils/common":41}],53:[function(n,a,s){a.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,a,s){(function(i){(function(l,r){if(!l.setImmediate){var o,u,h,m,g=1,c={},p=!1,_=l.document,y=Object.getPrototypeOf&&Object.getPrototypeOf(l);y=y&&y.setTimeout?y:l,o={}.toString.call(l.process)==="[object process]"?function(L){process.nextTick(function(){v(L)})}:function(){if(l.postMessage&&!l.importScripts){var L=!0,D=l.onmessage;return l.onmessage=function(){L=!1},l.postMessage("","*"),l.onmessage=D,L}}()?(m="setImmediate$"+Math.random()+"$",l.addEventListener?l.addEventListener("message",S,!1):l.attachEvent("onmessage",S),function(L){l.postMessage(m+L,"*")}):l.MessageChannel?((h=new MessageChannel).port1.onmessage=function(L){v(L.data)},function(L){h.port2.postMessage(L)}):_&&"onreadystatechange"in _.createElement("script")?(u=_.documentElement,function(L){var D=_.createElement("script");D.onreadystatechange=function(){v(L),D.onreadystatechange=null,u.removeChild(D),D=null},u.appendChild(D)}):function(L){setTimeout(v,0,L)},y.setImmediate=function(L){typeof L!="function"&&(L=new Function(""+L));for(var D=new Array(arguments.length-1),O=0;O<D.length;O++)D[O]=arguments[O+1];var M={callback:L,args:D};return c[g]=M,o(g),g++},y.clearImmediate=b}function b(L){delete c[L]}function v(L){if(p)setTimeout(v,0,L);else{var D=c[L];if(D){p=!0;try{(function(O){var M=O.callback,X=O.args;switch(X.length){case 0:M();break;case 1:M(X[0]);break;case 2:M(X[0],X[1]);break;case 3:M(X[0],X[1],X[2]);break;default:M.apply(r,X)}})(D)}finally{b(L),p=!1}}}}function S(L){L.source===l&&typeof L.data=="string"&&L.data.indexOf(m)===0&&v(+L.data.slice(m.length))}})(typeof self=="undefined"?i===void 0?this:i:self)}).call(this,typeof ei!="undefined"?ei:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}]},{},[10])(10)})})(ql);var mf=ql.exports;const pf=async t=>await mf.loadAsync(t),ie=()=>"[main]";var Ce=async t=>{var e;try{console.time("loading time"),Kn.enable(!1);let n;if(t.file)n=t.file;else if(t.link)n=await df(fo(decodeURI(t.link)));else if(t.id)n=await Wl(mo(decodeURI(t.id)));else if(t.hash&&ho(decodeURI(t.hash).trim()))n=await ff(decodeURI(t.hash).trim());else throw new Error("Could not search for file.");_t.status("info","Extracting zip",0),Ot.switchHeader(!1);const a=await pf(n);Kn.enable(!1),_t.status("info","Parsing map info...",0),nt.info(ie(),"Parsing map info");const s=await lf(a);at.beatmapInfo=s,Fn.setInfo(s),_t.status("info","Loading image...",10.4375),nt.info(ie(),"Loading cover image");let i=a.file(s._coverImageFilename);if(mt.load.imageCover&&i){let r=await i.async("base64");Ot.setCoverImage("data:image;base64,"+r),hn.loading.coverImage=!0}else nt.error(ie(),`${s._coverImageFilename} does not exists.`);if(at.contributors=[],(e=s==null?void 0:s._customData)!=null&&e._contributors)for(const r of s._customData._contributors){nt.info(ie(),"Loading contributor image "+r._name),i=a.file(r._iconPath);let o=null;mt.load.imageContributor&&i?o=await i.async("base64"):nt.error(ie(),`${r._iconPath} does not exists.`),at.contributors.push(qn(Wn({},r),{_base64:o}))}_t.status("info","Loading audio...",20.875),nt.info(ie(),"Loading audio");let l=a.file(s._songFilename);if(mt.load.audio&&l){let r=!1;setTimeout(()=>{r||_t.status("info","Loading audio... (this may take a while)",20.875)},1e4);let o=await l.async("arraybuffer");Ot.setAudio(o),await new AudioContext().decodeAudioData(o).then(h=>{r=!0;let m=h.duration;at.duration=m,Ot.setSongDuration(m),hn.loading.audio=!0}).catch(function(h){Ot.setSongDuration(),nt.error(ie(),h)})}else Ot.setSongDuration(),nt.error(ie(),`${s._songFilename} does not exist.`);_t.status("info","Parsing difficulty...",70),at.beatmapDifficulty=await cf(s,a),cn.adjustTime(),_t.status("info","Adding map difficulty stats...",80),nt.info(ie(),"Adding map stats"),Gl.populate(),Fn.populateContributors(at.contributors),_t.status("info","Analysing map...",85),nt.info(ie(),"Analysing map"),yn.runGeneral(),cn.displayOutputGeneral(),_t.status("info","Analysing difficulty...",90),yn.applyAll(),cn.populateSelect(s),cn.displayOutputDifficulty(),Kn.enable(!0),_t.status("info","Map successfully loaded!"),console.timeEnd("loading time")}catch(n){_t.status("error",n,100),nt.error(ie(),n),at.clear(),Kn.enable(!0),Ot.switchHeader(!0)}};const Dn="UI Intro: ",Nn=document.querySelector(".input__intro-url"),Mn=document.querySelector(".input__intro-id"),On=document.querySelector(".input__intro-hash"),io=document.querySelector(".input__search-button"),ao=document.querySelector(".input__file"),Yi=document.querySelector(".input__file-zone");if(Nn)Nn.addEventListener("keydown",Dr);else throw new Error(Dn+"URL input is missing");if(Mn)Mn.addEventListener("keydown",Dr);else throw new Error(Dn+"ID input is missing");if(On)On.addEventListener("keydown",Dr);else throw new Error(Dn+"Hash input is missing");if(io)io.addEventListener("click",gf);else throw new Error(Dn+"search button is missing");if(ao)ao.addEventListener("change",_f);else throw new Error(Dn+"file input is missing");if(Yi)Yi.addEventListener("drop",bf),Yi.addEventListener("dragover",yf);else throw new Error(Dn+"file drop zone is missing");function Dr(t){const e=t.target;t.key==="Enter"&&e.value!==""&&(e.classList.contains("input__intro-url")&&Ce({link:e.value}),e.classList.contains("input__intro-id")&&Ce({id:e.value}),e.classList.contains("input__intro-hash")&&Ce({hash:e.value}))}function gf(t){if(Nn&&Nn.value!==""){Ce({link:Nn.value});return}if(Mn&&Mn.value!==""){Ce({id:Mn.value});return}if(On&&On.value!==""){Ce({hash:On.value});return}}function _f(t){const e=t.target;_t.status("info","Reading file input",0);const n=e.files?e.files[0]:null;try{if(n==null)throw _t.status("info","No file input",0),new Error("No file input");if(n&&(n.name.substr(-4)===".zip"||n.name.substr(-4)===".bsl")){const a=new FileReader;a.readAsArrayBuffer(n),a.addEventListener("load",()=>{Ce({file:n})})}else throw new Error("Unsupported file format, please enter zip file")}catch(a){_t.status("error",a,0),console.error(a)}}function bf(t){t.preventDefault(),t.stopPropagation();try{if(t.dataTransfer==null)throw new Error("No file input");if(t.dataTransfer.items&&t.dataTransfer.items[0].kind==="file"){let e=t.dataTransfer.items[0].getAsFile();if(e&&(e.name.substr(-4)===".zip"||e.name.substr(-4)===".bsl")){const n=new FileReader;n.readAsArrayBuffer(e),n.addEventListener("load",()=>{Ce({file:e})})}else throw new Error("Unsupported file format, please enter zip file")}}catch(e){_t.status("error",e,0),console.error(e)}}function yf(t){t.preventDefault(),t.stopPropagation()}const vf=document.querySelector("body"),Ef=["Dark","Light","Monochrome"];var Lr={list:Ef,set:t=>{vf.className="theme-"+t.toLowerCase().replace(" ","")}};const Ln="UI Settings: ",li=document.querySelector(".settings__theme"),xr=document.querySelectorAll(".settings__load"),$i=document.querySelector(".settings__sort"),kr=document.querySelectorAll(".settings__show"),Tr=document.querySelectorAll(".settings__onload"),ro=document.querySelector(".settings__clear-button");if(li)li.addEventListener("change",wf),Lr.list.forEach(t=>{const e=document.createElement("option");e.value=t,e.textContent=t,li.add(e)});else throw new Error(Ln+"theme select is missing");xr.length||console.error(Ln+"empty load list, intentional or typo error?");xr.forEach(t=>t.addEventListener("change",xf));if($i)$i.addEventListener("change",Df);else throw new Error(Ln+"sort check is missing");Tr.length||console.error(Ln+"empty onload list, intentional or typo error?");Tr.forEach(t=>t.addEventListener("change",Tf));kr.length||console.error(Ln+"empty show list, intentional or typo error?");kr.forEach(t=>t.addEventListener("change",Sf));if(ro)ro.addEventListener("click",Zl);else throw new Error(Ln+"clear button is missing");function wf(t){const e=t.target;mt.theme=e.options[e.options.selectedIndex].value,Lr.set(mt.theme),mt.save()}function Sf(t){const e=t.target,n=e.id.replace("settings__show-","");mt.show[n]=e.checked,mt.save()}const Cf=(t,e)=>{kr.forEach(n=>{n.id.endsWith(t)&&(n.checked=e)})};function Df(t){const e=t.target;mt.sorting=e.checked,mt.save()}const Lf=t=>{$i&&($i.checked=t)};function xf(t){const e=t.target,n=e.name;mt.load[n]=e.checked,mt.save()}const kf=(t,e)=>{xr.forEach(n=>{n.name===t&&(n.checked=e)})};function Tf(t){const e=t.target,n=e.name;mt.onLoad[n]=e.checked,mt.save()}const Rf=(t,e)=>{Tr.forEach(n=>{n.name===t&&(n.checked=e)})},If=t=>{li.value=t};function Zl(){mt.clear(),mt.reset(),location.reload()}var Rn={setShowCheck:Cf,setSortCheck:Lf,setLoadCheck:kf,setOnLoadCheck:Rf,setTheme:If,clear:Zl};const Af=document.querySelectorAll(".input__reset-button");Af.forEach(t=>t.addEventListener("click",Bf));function Bf(){_t.reset(),Ot.reset(),Fn.reset(),cn.reset(),Gl.reset(),at.clear()}const $f=2,Nf=5,Mf=0,Of="Kival Evan#5480";var so=new class{constructor(){this._version=`pre-${$f}.${Nf}.${Mf}-2`,this._wm=Of}get value(){return this._version}get watermark(){return this._wm}};const Pf="UI Footer: ",Jl=document.querySelectorAll(".link__watermark"),Kl=document.querySelectorAll(".link__version");(!Jl.length||!Kl.length)&&console.error(Pf+"missing part");var oo={setWatermark:t=>{Jl.forEach(e=>e.textContent=t)},setVersion:t=>{Kl.forEach(e=>e.textContent=t)}},Ff=function(){let t=!1;return function(){if(!t){t=!0,Rn.setTheme(mt.theme),oo.setWatermark(so.watermark),oo.setVersion(so.value),cn.populateTool();for(const e in mt.load)Rn.setLoadCheck(e,mt.load[e]);Rn.setSortCheck(mt.sorting);for(const e in mt.show)uo.show(e,mt.show[e]),Rn.setShowCheck(e,mt.show[e]);for(const e in mt.onLoad)Rn.setOnLoadCheck(e,mt.onLoad[e]);Lr.set(mt.theme),nt.info("User interface initialised")}}}();(function(){Ff();const t=new URL(location.href),e=t.searchParams.get("url"),n=t.searchParams.get("id"),a=t.searchParams.get("hash");(n||e||a)&&Ce({link:e,id:n,hash:a})})();
