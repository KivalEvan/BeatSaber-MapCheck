(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();document.querySelectorAll(".accordion__button");function _f(t){return t.toString().split(".").map((e,n)=>n?e:e.replace(/\B(?=(\d{3})+(?!\d))/g,",")).join(".")}Ef(Math.random());function yf(t,e,n=!1,i=Math.random){if(typeof t=="boolean"||!t&&typeof t!="number")return t?Math.round(i()):i();if(typeof e=="boolean"||!e&&typeof e!="number"){let r=i()*t;return e&&(r=Math.round(r)),r}[t,e]=wf(t,e);const o=i()*(e-t)+t;return n?M(o,typeof n=="number"&&n>0?n:0):o}function Ef(t){t=t.toString();let e=0;for(let n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e|=0;return e}function Co(t,e,n=!1){return yf(t,e,n,Math.random)}function wf(t,e,n){return t>e?[e,t]:[t,e]}function M(t,e=0){const n=Math.pow(10,e);return Math.round(t*n)/n}function Qo(t){return t*(180/Math.PI)}function Tn(t){return t*(Math.PI/180)}function Ur(t,e){const n=t%e;return n<0?n+e:n}function Wr(t,e,n){return Math.min(Ur(t-e,n),Ur(e-t,n))}function ko(t){if(!t.length)return 0;const e=t.map(i=>i).sort((i,o)=>i-o),n=Math.floor(e.length/2);return e.length%2?e[n]:(e[n-1]+e[n])/2}function ul(t,e,n){return Math.min(Math.max(e,t),n)}function Df(t,e,n){return e===n?1:(t-e)/(n-e)}function Ai(t,e,n){return e+(n-e)*t}function Sf(t,e,n){return(t-e)/(n-e)}function cl(t,e,n,i,o){const r=Sf(t,e,n);return Ai(r,i,o)}function Nt(t){return t==null||typeof t!="object"?t:Array.isArray(t)?[...t]:{...t}}function N(t){if(t==null||typeof t!="object")return t;const e=Array.isArray(t)?Array(t.length):{};for(const n in t)e[n]=N(t[n]);return e}function gr(t){return/^[a-fA-F0-9]+$/g.test(t)}function He(t){return parseInt(t,16)}function hi(t,e,n,i){Array.isArray(t)&&(i=t[3],n=t[2],e=t[1],t=t[0]),t=t,e=e,n=n;let o=0;const r=Math.max(t,e,n),l=Math.min(t,e,n),s=r-l,a=r===0?0:s/r,u=r;switch(r){case l:break;case t:o=e-n+s*(e<n?6:0),o/=6*s;break;case e:o=n-t+s*2,o/=6*s;break;case n:o=t-e+s*4,o/=6*s;break}const c=[o*360,a,u];return typeof i=="number"&&c.push(i),c}function Cf(t,e,n,i){Array.isArray(t)&&(i=t[3],n=t[2],e=t[1],t=t[0]),t=t/360,e=e,n=n,t<0&&(t+=Math.abs(Math.floor(t)));let o=0,r=0,l=0;const s=Math.floor(t*6),a=t*6-s,u=n*(1-e),c=n*(1-a*e),p=n*(1-(1-a)*e);switch(s%6){case 0:o=n,r=p,l=u;break;case 1:o=c,r=n,l=u;break;case 2:o=u,r=n,l=p;break;case 3:o=u,r=c,l=n;break;case 4:o=p,r=u,l=n;break;case 5:o=n,r=u,l=c;break}const v=[o,r,l];return typeof i=="number"&&v.push(i),v}function fi(t){const e=t.toString(16);return e.length===1?"0"+e:e}function kf(t){return Math.round(t*255)}function Pe(t){return t/255}function se(t,e){if(Array.isArray(t)){const i={r:t[0],g:t[1],b:t[2]};return typeof t[3]=="number"&&(i.a=t[3]),e&&(i.a??(i.a=1)),i}if(typeof t=="string"||"type"in t)return se(Qt(t),e);const n={r:t.r,g:t.g,b:t.b};return typeof t.a=="number"&&(n.a=t.a),e&&(n.a??(n.a=1)),n}function ft(t){const e=se(t);let n=1;for(const i in e)n=Math.max(Math.abs(e[i]),n);for(const i in e)e[i]=kf(e[i]/n);return`#${fi(e.r)}${fi(e.g)}${fi(e.b)}${typeof e.a=="number"?fi(e.a):""}`}function ge(t){if(t=t.trim(),t.startsWith("#")&&(t=t.substring(1)),!gr(t))throw new Error("Not valid hexadecimal");let e=[0,0,0];if(t.length===3||t.length===4)e=[Pe(He(t.slice(0,1)+t.slice(0,1))),Pe(He(t.slice(1,2)+t.slice(1,2))),Pe(He(t.slice(2,3)+t.slice(2,3)))],t.length===4&&e.push(Pe(He(t.slice(3,4)+t.slice(3,4))));else if(t.length===6||t.length===8)e=[Pe(He(t.slice(0,2))),Pe(He(t.slice(2,4))),Pe(He(t.slice(4,6)))],t.length===8&&e.push(Pe(He(t.slice(6,8))));else throw new Error("Not valid colour hexadecimal");return e}function Ln(t,e="rgba",n="rgba"){if(typeof t=="string"){const i=ge(t);return n==="hsva"?hi(i):i}else if(Array.isArray(t)){if(e==="hsva")return n==="hsva"?[...t]:Cf(t);const i=e==="rgba255"?t.map(o=>Pe(o)):[...t];return n==="hsva"?hi(i):i}else if("type"in t){let i;switch(t.type){case"hsva":i=Qt(t.value,"hsva");break;case"rgba":i=Qt(t.value,"rgba");break;case"rgba255":i=Qt(t.value,"rgba255")}return n==="hsva"?hi(i):i}else{const i=[t.r,t.g,t.b];return typeof t.a=="number"&&i.push(t.a),n==="hsva"?hi(i):i}}function Yr(t){let e=t[0],n=t[1],i=t[2],o,r,l;e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92,i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92,o=(e*.4124+n*.3576+i*.1805)/.95047,r=(e*.2126+n*.7152+i*.0722)/1,l=(e*.0193+n*.1192+i*.9505)/1.08883,o=o>.008856?Math.pow(o,1/3):7.787*o+16/116,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,l=l>.008856?Math.pow(l,1/3):7.787*l+16/116;const s=[116*r-16,500*(o-r),200*(r-l)];return typeof t[3]=="number"&&s.push(t[3]),s}function Xr(t,e){let n=0;return t>=0&&e===0?0:t<0&&e===0?180:t===0&&e>0?90:t===0&&e<0?270:(t>0&&e>0&&(n=0),t<0&&(n=180),t>0&&e<0&&(n=360),Qo(Math.atan(e/t))+n)}function tr(t,e){const[n,i,o]=Yr(t),[r,l,s]=Yr(e),a=1,u=1,c=1;let p,v,m,h,d,y,g,_,D,C,k,P,A,V,x,W,et,S,$,b;return p=Math.sqrt(i*i+o*o),v=Math.sqrt(l*l+s*s),m=(p+v)/2,d=.5*(1-Math.sqrt((m^7)/((m^7)+30))),D=(1+d)*i,p=Math.sqrt(D*D+o*o),y=Xr(D,o),D=(1+d)*l,v=Math.sqrt(D*D+s*s),g=Xr(D,s),S=r-n,$=v-p,p*v==0?b=0:(D=M(g-y,12),Math.abs(D)<=180?b=g-y:D>180?b=g-y-360:b=g-y+360),b=2*Math.sqrt(p*v)*Math.sin(Tn(b/2)),C=(n+r)/2,h=(p+v)/2,p*v==0?_=y+g:(D=Math.abs(M(y-g,12)),D>180?g+y<360?_=y+g+360:_=y+g-360:_=y+g,_/=2),k=1-.17*Math.cos(Tn(_-30))+.24*Math.cos(Tn(2*_))+.32*Math.cos(Tn(3*_+6))-.2*Math.cos(Tn(4*_-63)),x=30*Math.exp(-((_-275)/25)*((_-275)/25)),W=2*Math.sqrt((h^7)/((h^7)+30)),P=1+.015*((C-50)*(C-50))/Math.sqrt(20+(C-50)*(C-50)),A=1+.045*h,V=1+.015*h*k,et=-Math.sin(Tn(2*x))*W,S=S/(a*P),$=$/(u*A),b=b/(c*V),Math.sqrt(S*S+$*$+b*b+et*$*b)}function Qt(){const t=arguments;if(typeof t[0]=="number"&&typeof t[1]=="number"&&typeof t[2]=="number"){let e=[t[0],t[1],t[2]];return typeof t[3]=="number"&&e.push(t[3]),typeof t[3]=="string"&&(t[3]==="hsva"&&(e=Ln(e,"hsva")),t[3]==="rgba255"&&(e=Ln(e,"rgba255"))),typeof t[4]=="string"&&(t[4]==="hsva"&&(e=Ln(e,"hsva")),t[4]==="rgba255"&&(e=Ln(e,"rgba255"))),e}if(typeof t[0]=="number")return typeof t[1]=="boolean"&&t[1]?[t[0]/255,t[0]/255,t[0]/255]:typeof t[1]=="number"?[t[0],t[0],t[0],t[1]]:[t[0],t[0],t[0]];if(typeof t[0]=="string")return ge(t[0]);if(Array.isArray(t[0])){const e=t[0];let n=[e[0],e[1],e[2]];if(!n.every(i=>typeof i=="number"))throw new Error("Unable to parse color; array contain undefined or non-numeric value");return typeof e[3]=="number"&&n.push(e[3]),typeof t[1]=="string"&&(t[1]==="hsva"&&(n=Ln(n,"hsva")),t[1]==="rgba255"&&(n=Ln(n,"rgba255"))),n}if(typeof t[0]=="object"){const e=t[0];if("type"in e)switch(e.type){case"hsva":return Qt(e.value,"hsva");case"rgba":return Qt(e.value,"rgba");case"rgba255":return Qt(e.value,"rgba255")}if("r"in e&&"g"in e&&"b"in e){const n=[e.r,e.g,e.b];if(!n.every(i=>typeof i=="number"))throw new Error("Unable to parse color; array contain undefined or non-numeric value");return typeof e.a=="number"&&n.push(e.a),n}}throw new Error("Unable to parse color; input is invalid")}function Jt(t){if(!t)return"0:00";const e=Math.floor(t),n=e/60,i=n<0?`-${Math.ceil(n).toString()}`:Math.floor(n).toString(),o=Math.abs(e%60).toString().padStart(2,"0");return`${i}:${o}`}function Tf(t){if(!t)return"0:00:00";const e=Math.abs(Math.round(t*60%60)).toString().padStart(2,"0");return`${Jt(t>0?Math.floor(t):Math.ceil(t))}:${e}`}function Ci(t){var n;if(!t)return"0:00.000";const e=((n=(t%1).toString().split(".")[1])==null?void 0:n.padEnd(3,"0").slice(0,3))||"000";return`${Jt(t>0?Math.floor(t):Math.ceil(t))}.${e}`}function ml(t){return Array.isArray(t)&&t.length===3&&t.every(e=>typeof e=="number")}function Be(t,e){if(!t)return t;if(typeof e=="number")return t.map(n=>n*e);if(t=[...t],e)if(Array.isArray(e))for(let n=0;n<t.length;n++)typeof e[n]=="number"&&(t[n]*=e[n]);else switch(t.length){case 4:t[3]=t[3]*(e.w??1);case 3:t[2]=t[2]*(e.z??1);case 2:t[1]=t[1]*(e.y??1),t[0]=t[0]*(e.x??1)}return t}const qr=document.querySelector(".intro"),Kr=document.querySelector(".metadata"),Rn=document.querySelector(".cover__link"),hl=document.querySelector(".cover__image"),Lf=document.querySelector(".metadata__song-name"),Rf=document.querySelector(".metadata__song-subname"),Bf=document.querySelector(".metadata__song-author"),xf=document.querySelector(".metadata__song-bpm"),To=document.querySelector(".metadata__song-duration"),fl=document.querySelector(".audio");function pl(t){t?(qr.classList.remove("hidden"),Kr.classList.add("hidden")):(qr.classList.add("hidden"),Kr.classList.remove("hidden"))}function dl(t){hl.src=t||"./img/unknown.jpg"}function If(){return hl.src}function bl(t,e){if(t==null&&e==null){Rn.textContent="",Rn.href="",Rn.classList.add("disabled");return}t!=null&&(Rn.textContent=e??"Download Link",Rn.href=t,Rn.classList.remove("disabled"))}function Nf(t){Lf.textContent=t}function Of(t){Rf.textContent=t}function Af(t){Bf.textContent=t}function Pf(t,e,n){e==null&&typeof n=="number"&&(e=Math.min(t,n)),n==null&&typeof e=="number"&&(n=Math.max(t,e));let i=M(t,2).toString()+"BPM";e&&n&&e!==n&&(i+=` (${M(e,2)}-${M(n,2)})`),xf.textContent=i}function gl(t){typeof t=="number"?To.textContent=Ci(t):typeof t=="string"?To.textContent=t:To.textContent="No audio"}async function $f(t){const e=new Blob([t],{type:"audio/ogg"});fl.src=window.URL.createObjectURL(e)}function vl(){fl.src="",window.URL.revokeObjectURL("")}function Mf(){pl(!0),dl(null),bl(),gl(0),vl()}const At={switchHeader:pl,setCoverImage:dl,getCoverImage:If,setCoverLink:bl,setSongName:Nf,setSongSubname:Of,setSongAuthor:Af,setSongBPM:Pf,setSongDuration:gl,setAudio:$f,unloadAudio:vl,reset:Mf};var pi=function(t,e,n,i,o){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!o:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?o.call(t,n):o?o.value=n:e.set(t,n),n},Ce=function(t,e,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(t):i?i.value:e.get(t)},ki,On,Ti,Te;function Ff(t){return`\x1B[33m${t}\x1B[39m`}function jf(t){return`\x1B[31m${t}\x1B[39m`}function Zr(t){return`\x1B[2m${t}\x1B[22m`}var Bt;(function(t){t[t.NONE=0]="NONE",t[t.ERROR=1]="ERROR",t[t.WARN=2]="WARN",t[t.INFO=3]="INFO",t[t.DEBUG=4]="DEBUG",t[t.TRACE=5]="TRACE"})(Bt||(Bt={}));class Yi{constructor(){On.set(this,Bt.INFO),Ti.set(this,(e,n)=>`${ki.LogPrefixes.get(n)} ${Zr(">")} [${Zr(e.join("::"))}]`),Te.set(this,"script")}set logLevel(e){pi(this,On,e,"f"),this.tInfo(["logger","logLevel"],`Log level set to ${ki.LogPrefixes.get(e)}`)}get logLevel(){return Ce(this,On,"f")}set tagPrint(e){pi(this,Ti,e,"f"),this.tInfo(["logger","tagPrint"],"Update tag print function")}get tagPrint(){return Ce(this,Ti,"f")}set untagged(e){pi(this,Te,e.trim(),"f"),this.tInfo(["logger","untagged"],`Update untagged string to ${Ce(this,Te,"f")}`)}get untagged(){return Ce(this,Te,"f")}log(e,n,i){if(e>Ce(this,On,"f"))return;const o=this.tagPrint(n,e);switch(e){case Bt.TRACE:return o?console.trace(o,...i):console.trace(...i);case Bt.DEBUG:return o?console.debug(o,...i):console.debug(...i);case Bt.INFO:return o?console.info(o,...i):console.info(...i);case Bt.WARN:return o?console.warn(o,...i):console.warn(...i);case Bt.ERROR:return o?console.error(o,...i):console.error(...i);default:return o?console.log(o,...i):console.log(...i)}}setLevel(e){e=Math.min(Math.max(e,0),5),pi(this,On,e,"f"),this.tInfo(["logger","setLevel"],`Log level set to ${ki.LogPrefixes.get(e)}`)}tTrace(e,...n){this.log(Bt.TRACE,e,n)}tDebug(e,...n){this.log(Bt.DEBUG,e,n)}tInfo(e,...n){this.log(Bt.INFO,e,n)}tWarn(e,...n){this.log(Bt.WARN,e,n)}tError(e,...n){this.log(Bt.ERROR,e,n)}trace(...e){this.tTrace([Ce(this,Te,"f")],...e)}debug(...e){this.tDebug([Ce(this,Te,"f")],...e)}info(...e){this.tInfo([Ce(this,Te,"f")],...e)}warn(...e){this.tWarn([Ce(this,Te,"f")],...e)}error(...e){this.tError([Ce(this,Te,"f")],...e)}}ki=Yi,On=new WeakMap,Ti=new WeakMap,Te=new WeakMap;Object.defineProperty(Yi,"LogLevels",{enumerable:!0,configurable:!0,writable:!0,value:Bt});Object.defineProperty(Yi,"LogPrefixes",{enumerable:!0,configurable:!0,writable:!0,value:new Map([[Bt.TRACE,"TRACE"],[Bt.DEBUG,"DEBUG"],[Bt.INFO,"INFO"],[Bt.WARN,Ff("WARN")],[Bt.ERROR,jf("!!ERROR!!")],[Bt.NONE,"NONE"]])});let Z=new Yi;class zf{clone(){return new this.constructor(this)}}class Oe extends zf{constructor(){super(...arguments),Object.defineProperty(this,"customData",{enumerable:!0,configurable:!0,writable:!0,value:{}})}setCustomData(e){return this.customData=e,this}resetCustomData(){return this.customData={},this}removeCustomData(e){return typeof e=="string"?delete this.customData[e]:e.forEach(n=>delete this.customData[n]),this}addCustomData(e){for(const n in e)this.customData[n]=e[n];return this}sort(e){return e==null||e(this),this}perform(e){return e(this),this}isValid(e,n){return e?!!e(this):!0}check(e){return e?!!e(this):!1}}class Ae extends Oe{constructor(){super(...arguments),Object.defineProperty(this,"time",{enumerable:!0,configurable:!0,writable:!0,value:0})}setTime(e){return this.time=e,this}}var ot;(function(t){t[t.NONE=-1]="NONE",t[t.RED=0]="RED",t[t.BLUE=1]="BLUE"})(ot||(ot={}));var B;(function(t){t[t.UP=0]="UP",t[t.DOWN=1]="DOWN",t[t.LEFT=2]="LEFT",t[t.RIGHT=3]="RIGHT",t[t.UP_LEFT=4]="UP_LEFT",t[t.UP_RIGHT=5]="UP_RIGHT",t[t.DOWN_LEFT=6]="DOWN_LEFT",t[t.DOWN_RIGHT=7]="DOWN_RIGHT",t[t.ANY=8]="ANY"})(B||(B={}));var ut;(function(t){t[t.LEFT=0]="LEFT",t[t.MIDDLE_LEFT=1]="MIDDLE_LEFT",t[t.MIDDLE_RIGHT=2]="MIDDLE_RIGHT",t[t.RIGHT=3]="RIGHT"})(ut||(ut={}));var Rt;(function(t){t[t.BOTTOM=0]="BOTTOM",t[t.MIDDLE=1]="MIDDLE",t[t.TOP=2]="TOP"})(Rt||(Rt={}));var wt;(function(t){t[t.OFF=0]="OFF",t[t.BLUE_ON=1]="BLUE_ON",t[t.BLUE_FLASH=2]="BLUE_FLASH",t[t.BLUE_FADE=3]="BLUE_FADE",t[t.BLUE_TRANSITION=4]="BLUE_TRANSITION",t[t.RED_ON=5]="RED_ON",t[t.RED_FLASH=6]="RED_FLASH",t[t.RED_FADE=7]="RED_FADE",t[t.RED_TRANSITION=8]="RED_TRANSITION",t[t.WHITE_ON=9]="WHITE_ON",t[t.WHITE_FLASH=10]="WHITE_FLASH",t[t.WHITE_FADE=11]="WHITE_FADE",t[t.WHITE_TRANSITION=12]="WHITE_TRANSITION"})(wt||(wt={}));var Ot;(function(t){t[t.BACK_LASERS=0]="BACK_LASERS",t[t.RING_LIGHTS=1]="RING_LIGHTS",t[t.LEFT_LASERS=2]="LEFT_LASERS",t[t.RIGHT_LASERS=3]="RIGHT_LASERS",t[t.CENTER_LIGHTS=4]="CENTER_LIGHTS",t[t.COLOR_BOOST=5]="COLOR_BOOST",t[t.EXTRA_LEFT_LIGHTS=6]="EXTRA_LEFT_LIGHTS",t[t.EXTRA_RIGHT_LIGHTS=7]="EXTRA_RIGHT_LIGHTS",t[t.RING_ROTATION=8]="RING_ROTATION",t[t.RING_ZOOM=9]="RING_ZOOM",t[t.EXTRA_LEFT_LASERS=10]="EXTRA_LEFT_LASERS",t[t.EXTRA_RIGHT_LASERS=11]="EXTRA_RIGHT_LASERS",t[t.LEFT_LASER_ROTATION=12]="LEFT_LASER_ROTATION",t[t.RIGHT_LASER_ROTATION=13]="RIGHT_LASER_ROTATION",t[t.EARLY_LANE_ROTATION=14]="EARLY_LANE_ROTATION",t[t.LATE_LANE_ROTATION=15]="LATE_LANE_ROTATION",t[t.UTILITY_EVENT_0=16]="UTILITY_EVENT_0",t[t.UTILITY_EVENT_1=17]="UTILITY_EVENT_1",t[t.UTILITY_EVENT_2=18]="UTILITY_EVENT_2",t[t.UTILITY_EVENT_3=19]="UTILITY_EVENT_3",t[t.SPECIAL_EVENT_0=40]="SPECIAL_EVENT_0",t[t.SPECIAL_EVENT_1=41]="SPECIAL_EVENT_1",t[t.SPECIAL_EVENT_2=42]="SPECIAL_EVENT_2",t[t.SPECIAL_EVENT_3=43]="SPECIAL_EVENT_3",t[t.BPM_CHANGE=100]="BPM_CHANGE"})(Ot||(Ot={}));var er;(function(t){t[t.DIVISION=1]="DIVISION",t[t.STEP_AND_OFFSET=2]="STEP_AND_OFFSET"})(er||(er={}));var nr;(function(t){t[t.NONE=0]="NONE",t[t.DURATION=1]="DURATION",t[t.DISTRIBUTION=2]="DISTRIBUTION",t[t.ALL=3]="ALL"})(nr||(nr={}));var ir;(function(t){t[t.NO_RANDOM=0]="NO_RANDOM",t[t.KEEP_ORDER=1]="KEEP_ORDER",t[t.RANDOM_ELEMENTS=2]="RANDOM_ELEMENTS",t[t.ALL=3]="ALL"})(ir||(ir={}));var Jr;(function(t){t[t.NONE=-1]="NONE",t[t.RED=0]="RED",t[t.BLUE=1]="BLUE",t[t.WHITE=2]="WHITE"})(Jr||(Jr={}));var Qr;(function(t){t[t.WAVE=1]="WAVE",t[t.STEP=2]="STEP"})(Qr||(Qr={}));var Kn;(function(t){t[t.NONE=-1]="NONE",t[t.LINEAR=0]="LINEAR",t[t.IN_QUAD=1]="IN_QUAD",t[t.OUT_QUAD=2]="OUT_QUAD",t[t.INOUT_QUAD=3]="INOUT_QUAD",t[t.IN_SINE=4]="IN_SINE",t[t.OUT_SINE=5]="OUT_SINE",t[t.INOUT_SINE=6]="INOUT_SINE",t[t.IN_CUBIC=7]="IN_CUBIC",t[t.OUT_CUBIC=8]="OUT_CUBIC",t[t.INOUT_CUBIC=9]="INOUT_CUBIC",t[t.IN_QUART=10]="IN_QUART",t[t.OUT_QUART=11]="OUT_QUART",t[t.INOUT_QUART=12]="INOUT_QUART",t[t.IN_QUINT=13]="IN_QUINT",t[t.OUT_QUINT=14]="OUT_QUINT",t[t.INOUT_QUINT=15]="INOUT_QUINT",t[t.IN_EXPO=16]="IN_EXPO",t[t.OUT_EXPO=17]="OUT_EXPO",t[t.INOUT_EXPO=18]="INOUT_EXPO",t[t.IN_CIRC=19]="IN_CIRC",t[t.OUT_CIRC=20]="OUT_CIRC",t[t.INOUT_CIRC=21]="INOUT_CIRC",t[t.IN_BACK=22]="IN_BACK",t[t.OUT_BACK=23]="OUT_BACK",t[t.INOUT_BACK=24]="INOUT_BACK",t[t.IN_ELASTIC=25]="IN_ELASTIC",t[t.OUT_ELASTIC=26]="OUT_ELASTIC",t[t.INOUT_ELASTIC=27]="INOUT_ELASTIC",t[t.IN_BOUNCE=28]="IN_BOUNCE",t[t.OUT_BOUNCE=29]="OUT_BOUNCE",t[t.INOUT_BOUNCE=30]="INOUT_BOUNCE",t[t.BS_INOUT_BACK=100]="BS_INOUT_BACK",t[t.BS_INOUT_ELASTIC=101]="BS_INOUT_ELASTIC",t[t.BS_INOUT_BOUNCE=102]="BS_INOUT_BOUNCE"})(Kn||(Kn={}));var or;(function(t){t[t.EARLY=0]="EARLY",t[t.LATE=1]="LATE"})(or||(or={}));var gn;(function(t){t[t.INSTANT=0]="INSTANT",t[t.INTERPOLATE=1]="INTERPOLATE",t[t.EXTEND=2]="EXTEND"})(gn||(gn={}));var ts;(function(t){t[t.X=0]="X",t[t.Y=1]="Y",t[t.Z=2]="Z"})(ts||(ts={}));var rr;(function(t){t[t.INT=0]="INT",t[t.FLOAT=1]="FLOAT",t[t.BOOL=2]="BOOL"})(rr||(rr={}));var es;(function(t){t[t.AUTOMATIC=0]="AUTOMATIC",t[t.CLOCKWISE=1]="CLOCKWISE",t[t.COUNTER_CLOCKWISE=2]="COUNTER_CLOCKWISE"})(es||(es={}));var ns;(function(t){t[t.STRAIGHT=0]="STRAIGHT",t[t.CLOCKWISE=1]="CLOCKWISE",t[t.COUNTER_CLOCKWISE=2]="COUNTER_CLOCKWISE"})(ns||(ns={}));var Ie;(function(t){t[t.NONE=0]="NONE",t[t.COLOR=1]="COLOR",t[t.ROTATION=2]="ROTATION",t[t.TRANSLATION=3]="TRANSLATION",t[t.FX_FLOAT=4]="FX_FLOAT"})(Ie||(Ie={}));const Xi=4,Se={[B.UP]:180,[B.DOWN]:0,[B.LEFT]:270,[B.RIGHT]:90,[B.UP_LEFT]:225,[B.UP_RIGHT]:135,[B.DOWN_LEFT]:315,[B.DOWN_RIGHT]:45,[B.ANY]:0},Vf={[B.UP]:B.DOWN,[B.DOWN]:B.UP,[B.LEFT]:B.RIGHT,[B.RIGHT]:B.LEFT,[B.UP_LEFT]:B.DOWN_RIGHT,[B.UP_RIGHT]:B.DOWN_LEFT,[B.DOWN_LEFT]:B.UP_RIGHT,[B.DOWN_RIGHT]:B.UP_LEFT,[B.ANY]:B.ANY},Lo={[B.UP]:[0,1],[B.DOWN]:[0,-1],[B.LEFT]:[-1,0],[B.RIGHT]:[1,0],[B.UP_LEFT]:[-1,1],[B.UP_RIGHT]:[1,1],[B.DOWN_LEFT]:[-1,-1],[B.DOWN_RIGHT]:[1,-1],[B.ANY]:[0,0]},_l={0:-60,1:-45,2:-30,3:-15,4:15,5:30,6:45,7:60},yl={"-60":0,"-45":1,"-30":2,"-15":3,15:4,30:5,45:6,60:7};class Me extends Ae{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"floatValue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.time=e.time??Me.defaultValue.time,this.type=e.type??Me.defaultValue.type,this.value=e.value??Me.defaultValue.value,this.floatValue=e.floatValue??Me.defaultValue.floatValue,this.customData=N(e.customData??Me.defaultValue.customData)}isValidType(){return this.type>=0&&this.type<=19||this.type>=40&&this.type<=43||this.type===100}isValid(e,n){return n?super.isValid(e,n):super.isValid(e,n)&&this.isValidType()&&this.value>=0&&!(!this.isLaserRotationEvent()&&this.value>12&&!this.isOldChroma())}setType(e){return this.type=e,this}setValue(e){return this.value=e,this}setFloatValue(e){return this.floatValue=e,this}isOff(){return this.value===wt.OFF}isOn(){return this.value===wt.BLUE_ON||this.value===wt.RED_ON||this.value===wt.WHITE_ON}isFlash(){return this.value===wt.BLUE_FLASH||this.value===wt.RED_FLASH||this.value===wt.WHITE_FLASH}isFade(){return this.value===wt.BLUE_FADE||this.value===wt.RED_FADE||this.value===wt.WHITE_FADE}isTransition(){return this.value===wt.BLUE_TRANSITION||this.value===wt.RED_TRANSITION||this.value===wt.WHITE_TRANSITION}isBlue(){return this.value===wt.BLUE_ON||this.value===wt.BLUE_FLASH||this.value===wt.BLUE_FADE||this.value===wt.BLUE_TRANSITION}isRed(){return this.value===wt.RED_ON||this.value===wt.RED_FLASH||this.value===wt.RED_FADE||this.value===wt.RED_TRANSITION}isWhite(){return this.value===wt.WHITE_ON||this.value===wt.WHITE_FLASH||this.value===wt.WHITE_FADE||this.value===wt.WHITE_TRANSITION}isLightEvent(){return this.type===0||this.type===1||this.type===2||this.type===3||this.type===4||this.type===6||this.type===7||this.type===10||this.type===11}isColorBoost(){return this.type===Ot.COLOR_BOOST}isRingEvent(){return this.type===Ot.RING_ROTATION||this.type===Ot.RING_ZOOM}isLaserRotationEvent(){return this.type===Ot.LEFT_LASER_ROTATION||this.type===Ot.RIGHT_LASER_ROTATION}isLaneRotationEvent(){return this.type===Ot.EARLY_LANE_ROTATION||this.type===Ot.LATE_LANE_ROTATION}isExtraEvent(){return this.type===Ot.UTILITY_EVENT_0||this.type===Ot.UTILITY_EVENT_1||this.type===Ot.UTILITY_EVENT_2||this.type===Ot.UTILITY_EVENT_3}isSpecialEvent(){return this.type===Ot.SPECIAL_EVENT_0||this.type===Ot.SPECIAL_EVENT_1||this.type===Ot.SPECIAL_EVENT_2||this.type===Ot.SPECIAL_EVENT_3}isBpmEvent(){return this.type===Ot.BPM_CHANGE}isLightingEvent(){return this.isLightEvent()||this.isRingEvent()||this.isLaserRotationEvent()||this.isExtraEvent()}isOldChroma(){return this.value>=2e9}}Object.defineProperty(Me,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,type:0,value:0,floatValue:0,customData:{}}});const Ee={DefaultEnvironment:"The First",OriginsEnvironment:"Origins",TriangleEnvironment:"The First",NiceEnvironment:"The First",BigMirrorEnvironment:"The First",DragonsEnvironment:"The First",KDAEnvironment:"KDA",MonstercatEnvironment:"The First",CrabRaveEnvironment:"Crab Rave",PanicEnvironment:"The First",RocketEnvironment:"Rocket",GreenDayEnvironment:"Green Day",GreenDayGrenadeEnvironment:"Green Day",TimbalandEnvironment:"Timbaland",FitBeatEnvironment:"FitBeat",LinkinParkEnvironment:"Linkin Park",BTSEnvironment:"BTS",KaleidoscopeEnvironment:"Kaleidoscope",InterscopeEnvironment:"Interscope",SkrillexEnvironment:"Skrillex",BillieEnvironment:"Billie Eilish",HalloweenEnvironment:"Spooky",GagaEnvironment:"Gaga",WeaveEnvironment:"Weave",PyroEnvironment:"Pyro",EDMEnvironment:"EDM",TheSecondEnvironment:"The Second",LizzoEnvironment:"Lizzo",TheWeekndEnvironment:"The Weeknd",RockMixtapeEnvironment:"Rock Mixtape",Dragons2Environment:"Dragons 2.0",Panic2Environment:"Panic 2.0",QueenEnvironment:"Queen",LinkinPark2Environment:"Linkin Park 2.0",TheRollingStonesEnvironment:"The Rolling Stones",LatticeEnvironment:"Lattice",DaftPunkEnvironment:"Daft Punk",HipHopEnvironment:"Hip Hop Mixtape",ColliderEnvironment:"Collider",BritneyEnvironment:"Britney Spears",GlassDesertEnvironment:"Glass Desert",MultiplayerEnvironment:"Origins"},Gf={_colorLeft:"Left Note Color",_colorRight:"Right Note Color",_envColorLeft:"Left Environment Color",_envColorRight:"Right Environment Color",_envColorWhite:"White Environment Color",_envColorLeftBoost:"Left Environment Boost Color",_envColorRightBoost:"Right Environment Boost Color",_envColorWhiteBoost:"White Environment Boost Color",_obstacleColor:"Obstacle Color"},Hf={saberLeftColor:"Left Note Color",saberRightColor:"Right Note Color",environment0Color:"Left Environment Color",environment1Color:"Right Environment Color",environmentWColor:"White Environment Color",environment0ColorBoost:"Left Environment Boost Color",environment1ColorBoost:"Right Environment Boost Color",environmentWColorBoost:"White Environment Boost Color",obstaclesColor:"Obstacle Color"},we={"Default Custom":{_colorLeft:{r:.7529412,g:.1882353,b:.1882353},_colorRight:{r:.1254902,g:.3921569,b:.6588235},_envColorLeft:{r:.7529412,g:.1882353,b:.1882353},_envColorRight:{r:.1882353,g:.5960785,b:1},_obstacleColor:{r:1,g:.1882353,b:.1882353}},"The First":{_colorLeft:{r:.7843137,g:.07843138,b:.07843138},_colorRight:{r:.1568627,g:.5568627,b:.8235294},_envColorLeft:{r:.85,g:.08499997,b:.08499997},_envColorRight:{r:.1882353,g:.675294,b:1},_obstacleColor:{r:1,g:.1882353,b:.1882353}},Origins:{_colorLeft:{r:.6792453,g:.5712628,b:0},_colorRight:{r:.7075472,g:0,b:.5364411},_envColorLeft:{r:.4910995,g:.6825916,b:.7},_envColorRight:{r:.03844783,g:.6862745,b:.9056604},_obstacleColor:{r:.06167676,g:.2869513,b:.3962264}},KDA:{_colorLeft:{r:.6588235,g:.2627451,b:.1607843},_colorRight:{r:.5019608,g:.08235294,b:.572549},_envColorLeft:{r:1,g:.3960785,b:.2431373},_envColorRight:{r:.7607844,g:.1254902,b:.8666667},_obstacleColor:{r:1,g:.3960785,b:.2431373}},"Crab Rave":{_colorLeft:{r:0,g:.7130001,b:.07806564},_colorRight:{r:.04805952,g:.5068096,b:.734},_envColorLeft:{r:.134568,g:.756,b:.1557533},_envColorRight:{r:.05647058,g:.6211764,b:.9},_envColorLeftBoost:{r:.1333333,g:.7568628,b:.1568628},_envColorRightBoost:{r:.05490196,g:.6196079,b:.9019608},_obstacleColor:{r:0,g:.8117648,b:.09019608}},Noir:{_colorLeft:{r:.1792453,g:.1792453,b:.1792453},_colorRight:{r:.5943396,g:.5943396,b:.5943396},_envColorLeft:{r:.4056604,g:.4056604,b:.4056604},_envColorRight:{r:.6037736,g:.6037736,b:.6037736},_obstacleColor:{r:.2358491,g:.2358491,b:.2358491}},Rocket:{_colorLeft:{r:1,g:.4980392,b:0},_colorRight:{r:0,g:.5294118,b:1},_envColorLeft:{r:.9,g:.4866279,b:.3244186},_envColorRight:{r:.4,g:.7180724,b:1},_obstacleColor:{r:.3176471,g:.6117647,b:.7254902}},"Green Day":{_colorLeft:{r:.2588235,g:.7843138,b:.01960784},_colorRight:{r:0,g:.7137255,b:.6705883},_envColorLeft:{r:0,g:.7137255,b:.6705883},_envColorRight:{r:.2588235,g:.7843137,b:.01960784},_obstacleColor:{r:0,g:.8117648,b:.09019608}},Timbaland:{_colorLeft:{r:.5019608,g:.5019608,b:.5019608},_colorRight:{r:.1,g:.5517647,b:1},_envColorLeft:{r:.1,g:.5517647,b:1},_envColorRight:{r:.1,g:.5517647,b:1},_obstacleColor:{r:.5,g:.5,b:.5}},FitBeat:{_colorLeft:{r:.8000001,g:.6078432,b:.1568628},_colorRight:{r:.7921569,g:.1607843,b:.682353},_envColorLeft:{r:.8,g:.5594772,b:.5594772},_envColorRight:{r:.5594772,g:.5594772,b:.8},_obstacleColor:{r:.2784314,g:.2784314,b:.4}},"Linkin Park":{_colorLeft:{r:.6627451,g:.1643608,b:.1690187},_colorRight:{r:.3870196,g:.5168997,b:.5568628},_envColorLeft:{r:.7529412,g:.672753,b:.5925647},_envColorRight:{r:.6241197,g:.6890281,b:.709},_envColorLeftBoost:{r:.922,g:.5957885,b:.255394},_envColorRightBoost:{r:.282353,g:.4586275,b:.6235294},_obstacleColor:{r:.6627451,g:.1647059,b:.172549}},BTS:{_colorLeft:{r:1,g:.09019607,b:.4059771},_colorRight:{r:.8018868,g:0,b:.7517689},_envColorLeft:{r:.7843137,g:.1254902,b:.5010797},_envColorRight:{r:.6941177,g:.1254902,b:.8666667},_envColorLeftBoost:{r:.9019608,g:.5411765,b:1},_envColorRightBoost:{r:.3490196,g:.8078431,b:1},_obstacleColor:{r:.6698113,g:.1800908,b:.5528399}},Kaleidoscope:{_colorLeft:{r:.6588235,g:.1254902,b:.1254902},_colorRight:{r:.282353,g:.282353,b:.282353},_envColorLeft:{r:.6588235,g:.1254902,b:.1254902},_envColorRight:{r:.4705882,g:.4705882,b:.4705882},_envColorLeftBoost:{r:.5019608,g:0,b:0},_envColorRightBoost:{r:.4924452,g:0,b:.5372549},_obstacleColor:{r:.2509804,g:.2509804,b:.2509804}},Interscope:{_colorLeft:{r:.7264151,g:.6269099,b:.3118103},_colorRight:{r:.5895709,g:.2978884,b:.723},_envColorLeft:{r:.7242536,g:.319804,b:.9137255},_envColorRight:{r:.7647059,g:.7589706,b:.7188236},_envColorLeftBoost:{r:.7924528,g:.4298683,b:.4298683},_envColorRightBoost:{r:.7038,g:.7157449,b:.765},_obstacleColor:{r:.5882353,g:.2980392,b:.7215686}},Skrillex:{_colorLeft:{r:.6980392,g:.1411765,b:.3686275},_colorRight:{r:.3293333,g:.323,b:.38},_envColorLeft:{r:.8,g:.28,b:.5859449},_envColorRight:{r:.06525807,g:.578,b:.5686774},_envColorLeftBoost:{r:.8117648,g:.3058824,b:.3058824},_envColorRightBoost:{r:.2784314,g:.8,b:.4459763},_obstacleColor:{r:.1568628,g:.6039216,b:.6039216}},"Billie Eilish":{_colorLeft:{r:.8,g:.6448193,b:.432},_colorRight:{r:.5480851,g:.6127659,b:.64},_envColorLeft:{r:.8196079,g:.442,b:.184},_envColorRight:{r:.9411765,g:.706771,b:.5647059},_envColorLeftBoost:{r:.8,g:0,b:0},_envColorRightBoost:{r:.5568628,g:.7019608,b:.7764707},_obstacleColor:{r:.7132531,g:.5614098,b:.7830189}},Spooky:{_colorLeft:{r:.8196079,g:.4980788,b:.2770275},_colorRight:{r:.3789474,g:.3578947,b:.4},_envColorLeft:{r:.9019608,g:.2300923,b:0},_envColorRight:{r:.4600588,g:.5688943,b:.9294118},_envColorLeftBoost:{r:.3376843,g:.6320754,b:.3369081},_envColorRightBoost:{r:.6020907,g:.3280082,b:.8584906},_obstacleColor:{r:.8196079,g:.4431373,b:.1843137}},Gaga:{_colorLeft:{r:.85,g:.4333333,b:.7833334},_colorRight:{r:.4705882,g:.8,b:.4078431},_envColorLeft:{r:.708,g:.649,b:.2394706},_envColorRight:{r:.894,g:.1625455,b:.7485644},_envColorLeftBoost:{r:.754717,g:.3610244,b:.2207191},_envColorRightBoost:{r:0,g:.7058824,b:1},_obstacleColor:{r:.9921569,g:0,b:.7719755}},"Glass Desert":{_colorLeft:{r:.6792453,g:.5712628,b:0},_colorRight:{r:.7075472,g:0,b:.5364411},_envColorLeft:{r:.32222217,g:.6111111,b:.75},_envColorRight:{r:.03844783,g:.62239975,b:.90566039},_obstacleColor:{r:.06167676,g:.2869513,b:.3962264}},Weave:{_colorLeft:{r:.7843137,g:.07843138,b:.07843138},_colorRight:{r:.1568627,g:.5568627,b:.8235294},_envColorLeft:{r:.85,g:.08499997,b:.08499997},_envColorRight:{r:.1882353,g:.675294,b:1},_envColorLeftBoost:{r:.8218409,g:.08627451,b:.8509804},_envColorRightBoost:{r:.6320754,g:.6320754,b:.6320754},_obstacleColor:{r:1,g:.1882353,b:.1882353}},Pyro:{_colorLeft:{r:.5764706,g:0,b:.03921569},_colorRight:{r:1,g:.6705883,b:0},_envColorLeft:{r:1,g:.1098039,b:.2039216},_envColorRight:{r:.8862745,g:.7372549,b:.2627451},_envColorLeftBoost:{r:1,g:0,b:.1764706},_envColorRightBoost:{r:.7647059,g:.7647059,b:.7647059},_obstacleColor:{r:.8490566,g:.7037643,b:.4285333}},EDM:{_colorLeft:{r:.6320754,g:.6320754,b:.6320754},_colorRight:{r:.1764706,g:.6980392,b:.8784314},_envColorLeft:{r:.08220173,g:.7169812,b:0},_envColorRight:{r:0,g:.3671638,b:.7169812},_envColorLeftBoost:{r:.735849,g:0,b:.1758632},_envColorRightBoost:{r:.4284593,g:0,b:.754717},_obstacleColor:{r:.1764706,g:.6980392,b:.8784314}},"The Second":{_colorLeft:{r:.7843137,g:.07843138,b:.07843138},_colorRight:{r:.1568627,g:.5568627,b:.8235294},_envColorLeft:{r:.85,g:.08499997,b:.08499997},_envColorRight:{r:.1882353,g:.675294,b:1},_envColorLeftBoost:{r:.8235294,g:.08627451,b:.8509804},_envColorRightBoost:{r:0,g:1,b:.6478302},_obstacleColor:{r:1,g:.1882353,b:.1882353}},Lizzo:{_colorLeft:{r:1,g:.8132076,b:.3773585},_colorRight:{r:.6705883,g:.254902,b:.8980392},_envColorLeft:{r:.8392157,g:.6470588,b:.2156863},_envColorRight:{r:.8196079,g:.2392157,b:.8784314},_envColorLeftBoost:{r:1,g:.4,b:.5529412},_envColorRightBoost:{r:.3686275,g:.7960784,b:1},_obstacleColor:{r:1,g:.5020987,b:.1882353}},"The Weeknd":{_colorLeft:{r:.5843138,g:.1294118,b:.1294118},_colorRight:{r:.2235294,g:.2901961,b:.3294118},_envColorLeft:{r:1,g:.2979701,b:.1411765},_envColorRight:{r:.1668743,g:.3753689,b:.7075472},_envColorWhite:{r:.8773585,g:.8773585,b:.8773585},_envColorLeftBoost:{r:.9568628,g:.6039216,b:.1215686},_envColorRightBoost:{r:.5254902,g:.8274511,b:.9921569},_envColorWhiteBoost:{r:.9811321,g:.9308866,b:.8608046},_obstacleColor:{r:.9176471,g:.2980392,b:.007843138}},"Rock Mixtape":{_colorLeft:{r:.6,g:.4233,b:.042},_colorRight:{r:.6006,g:.7441199,b:.78},_envColorLeft:{r:.75,g:.12,b:.162},_envColorRight:{r:.95,g:.5820333,b:.1615},_envColorLeftBoost:{r:.96,g:.1344,b:.9187202},_envColorRightBoost:{r:.378,g:.813,b:.9},_obstacleColor:{r:1,g:1,b:1}},"Dragons 2.0":{_colorLeft:{r:.7264151,g:.6587077,b:.2809719},_colorRight:{r:.2509804,g:.7647059,b:.405098},_envColorLeft:{r:.01960784,g:.9960785,b:.06666667},_envColorRight:{r:0,g:.05490196,b:1},_envColorLeftBoost:{r:.9764706,g:.03137255,b:.01960784},_envColorRightBoost:{r:1,g:.8292086,b:.2264151},_obstacleColor:{r:.5548979,g:.2470588,b:1}},"Panic 2.0":{_colorLeft:{r:.9019608,g:.3333333,b:.5686275},_colorRight:{r:.1529412,g:.5568628,b:.4862745},_envColorLeft:{r:.6980392,g:.1137255,b:.372549},_envColorRight:{r:.1882353,g:.6196079,b:.6235294},_envColorWhite:{r:.8329412,g:.9008105,b:.9254902},_envColorLeftBoost:{r:.9019608,g:.4470589,b:.06666667},_envColorRightBoost:{r:.6365692,g:.4373443,b:.8584906},_envColorWhiteBoost:{r:.8803849,g:.8313726,b:.9254902},_obstacleColor:{r:.9686275,g:.3803922,b:.2745098}},Queen:{_colorLeft:{r:.58,g:.5675714,b:.5551428},_colorRight:{r:.5236231,g:.1345675,b:.6792453},_envColorLeft:{r:.9333334,g:.6392157,b:.1215686},_envColorRight:{r:.04313726,g:.7176471,b:.8980393},_envColorLeftBoost:{r:.7686275,g:.145098,b:.07450981},_envColorRightBoost:{r:.4,g:.007843138,b:.7254902},_obstacleColor:{r:.9333334,g:.6392157,b:.1215686}},"Linkin Park 2.0":{_colorLeft:{r:.6627451,g:.1643608,b:.1690187},_colorRight:{r:.3870196,g:.5168997,b:.5568628},_envColorLeft:{r:.6627451,g:.1647059,b:.172549},_envColorRight:{r:.6235294,g:.6901961,b:.7098039},_envColorWhite:{r:.7529413,g:.6745098,b:.5921569},_envColorLeftBoost:{r:.922,g:.5957885,b:.255394},_envColorRightBoost:{r:.282353,g:.4586275,b:.6235294},_obstacleColor:{r:.6627451,g:.1647059,b:.172549}},"The Rolling Stones":{_colorLeft:{r:.8980392,g:0,b:.1150319},_colorRight:{r:.5254902,g:.1333333,b:.6784314},_envColorLeft:{r:.9529412,g:.01176471,b:.4039216},_envColorRight:{r:.4784314,g:.4039216,b:1},_envColorLeftBoost:{r:.5647059,g:.4622677,b:0},_envColorRightBoost:{r:.003921554,g:.6383545,b:.6705883},_obstacleColor:{r:.9529412,g:.01176471,b:.4039216}},Lattice:{_colorLeft:{r:.8392157,g:.172549,b:.5456773},_colorRight:{r:0,g:.6717121,b:.9803922},_envColorLeft:{r:.8941177,g:.1607843,b:.7490196},_envColorRight:{r:.1960784,g:.5843138,b:.7960785},_envColorLeftBoost:{r:.5450981,g:.1333333,b:.8156863},_envColorRightBoost:{r:.4039216,g:.9176471,b:.9176471},_obstacleColor:{r:.4685534,g:.7095922,b:1}},"Daft Punk":{_colorLeft:{r:.7215686,g:.2254902,b:.1803922},_colorRight:{r:.1215686,g:.6980392,b:.6901961},_envColorLeft:{r:1,g:.7017543,b:.2515723},_envColorRight:{r:.5215687,g:.3294118,b:.8196079},_envColorWhite:{r:.4784314,g:.8117647,b:1},_envColorLeftBoost:{r:.8588235,g:0,b:.4784314},_envColorRightBoost:{r:0,g:.8196079,b:.8039216},_envColorWhiteBoost:{r:1,g:.834256,b:.4874213},_obstacleColor:{r:.6068091,g:0,b:1}},"Hip Hop Mixtape":{_colorLeft:{r:1,g:.583857,b:.3137255},_colorRight:{r:.01542656,g:.6132076,b:.5896002},_envColorLeft:{r:.9137256,g:.4941177,b:0},_envColorRight:{r:.05882353,g:.8039216,b:.1843137},_envColorWhite:{r:.8000001,g:.7568628,b:.7058824},_envColorLeftBoost:{r:.1411765,g:1,b:.9686275},_envColorRightBoost:{r:.227451,g:.2745098,b:1},_envColorWhiteBoost:{r:.8784314,g:.8784314,b:.8784314},_obstacleColor:{r:1,g:.3137255,b:.5529412}},Collider:{_colorLeft:{r:.9647059,g:.4947137,b:.1504941},_colorRight:{r:.1686274,g:.5998134,b:.8588235},_envColorLeft:{r:.9637059,g:.4092787,b:0},_envColorRight:{r:.1686275,g:.3921569,b:.8588236},_envColorLeftBoost:{r:.8980393,g:.03529412,b:.02352941},_envColorRightBoost:{r:.854902,g:.4117647,b:.9725491},_obstacleColor:{r:.8396226,g:.09639232,b:0}},"Britney Spears":{_colorLeft:{r:.9137255,g:.1411765,b:.6008013},_colorRight:{r:.2484275,g:.578789,b:1},_envColorLeft:{r:.9921569,g:.01176471,b:.9882353},_envColorRight:{r:.1921569,g:.5058824,b:.9058824},_envColorLeftBoost:{r:1,g:.4591194,b:.5087922},_envColorRightBoost:{r:.482353,g:.9294118,b:.7960785},_obstacleColor:{r:.8396226,g:.09639232,b:0}}};class vr extends Ae{constructor(){super(...arguments),Object.defineProperty(this,"posX",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"posY",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"laneRotation",{enumerable:!0,configurable:!0,writable:!0,value:0})}setPosX(e){return this.posX=e,this}setPosY(e){return this.posY=e,this}setLaneRotation(e){return this.laneRotation=e,this}mirror(e,n){return n==null||n(this),this.posX=Xi-1-this.posX,this}getPosition(e){return(e==null?void 0:e(this))??[this.posX-2,this.posY]}getDistance(e,n){const[i,o]=this.getPosition(n),[r,l]=e.getPosition(n);return Math.sqrt(Math.pow(r-i,2)+Math.pow(l-o,2))}isVertical(e,n){const[i]=this.getPosition(n),[o]=e.getPosition(n),r=i-o;return r>-.001&&r<.001}isHorizontal(e,n){const[i,o]=this.getPosition(n),[r,l]=e.getPosition(n),s=o-l;return s>-.001&&s<.001}isDiagonal(e,n){const[i,o]=this.getPosition(n),[r,l]=e.getPosition(n),s=Math.abs(i-r),a=Math.abs(o-l);return s===a}isInline(e,n,i){return n??(n=.5),this.getDistance(e,i)<=n}isAdjacent(e,n){const i=this.getDistance(e,n);return i>.499&&i<1.001}isWindow(e,n,i){return n??(n=1.8),this.getDistance(e,i)>n}isSlantedWindow(e,n){return this.isWindow(e,null,n)&&!this.isDiagonal(e,n)&&!this.isHorizontal(e,n)&&!this.isVertical(e,n)}}class _r extends vr{constructor(){super(...arguments),Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"direction",{enumerable:!0,configurable:!0,writable:!0,value:0})}setColor(e){return this.color=e,this}setDirection(e){return this.direction=e,this}mirror(e=!0,n){switch(n==null||n(this),e&&(this.color=(1+this.color)%2),this.direction){case 2:this.direction=3;break;case 3:this.direction=2;break;case 6:this.direction=7;break;case 7:this.direction=6;break;case 4:this.direction=5;break;case 5:this.direction=4;break}return super.mirror(e)}isRed(){return this.color===0}isBlue(){return this.color===1}getAngle(e){return(e==null?void 0:e(this))??(Se[this.direction]||0)}isDouble(e,n=.01){return e.time>this.time-n&&e.time<this.time+n&&this.color!==e.color}isValid(e,n){return n?super.isValid(e,n):super.isValid(e,n)&&this.direction>=0&&this.direction<=8}}class on extends _r{constructor(){super(...arguments),Object.defineProperty(this,"tailTime",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"tailPosX",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"tailPosY",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"tailLaneRotation",{enumerable:!0,configurable:!0,writable:!0,value:0})}setTailTime(e){return this.tailTime=e,this}setTailPosX(e){return this.tailPosX=e,this}setTailPosY(e){return this.tailPosY=e,this}setTailLaneRotation(e){return this.tailLaneRotation=e,this}mirror(e=!0,n){return n==null||n(this),this.tailPosX=Xi-1-this.tailPosX,super.mirror(e)}getTailPosition(e){return(e==null?void 0:e(this))??[this.tailPosX-2,this.tailPosY]}isInverse(){return this.time>this.tailTime}}function xt(t,e){return t.time-e.time}function An(t,e){return Array.isArray(t.customData.coordinates)&&Array.isArray(e.customData.coordinates)?t.time-e.time||t.customData.coordinates[0]-e.customData.coordinates[0]||t.customData.coordinates[1]-e.customData.coordinates[1]:Array.isArray(t.customData._position)&&Array.isArray(e.customData._position)?t.time-e.time||t.customData._position[0]-e.customData._position[0]||t.customData._position[1]-e.customData._position[1]:t.time-e.time||t.posX-e.posX||t.posY-e.posY}function Uf(t,e){return t._time-e._time}function Wf(t,e){var n,i;return Array.isArray((n=t._customData)==null?void 0:n._position)&&Array.isArray((i=e._customData)==null?void 0:i._position)?t._time-e._time||t._customData._position[0]-e._customData._position[0]||t._customData._position[1]-e._customData._position[1]:t._time-e._time||t._lineIndex-e._lineLayer||t._lineIndex-e._lineLayer}function sr(t){return["convert","toV1Beatmap",t]}function Yf(t,e=t.version){switch(Z.tWarn(sr("main"),"Converting beatmap to v1 may lose certain data!"),e){case 1:case 2:t.version=1;break;case 3:t.version=1,Xf(t);break;case 4:t.version=1,qf(t);break;default:Z.tWarn(sr("main"),"Unknown version: version not supported; misinput? Returning original data.")}return t}function Xf(t){var e,n;t.difficulty.customData._time=t.difficulty.customData.time,t.difficulty.customData._BPMChanges=(e=t.difficulty.customData.BPMChanges)==null?void 0:e.map(i=>({_time:i.b,_BPM:i.m,_beatsPerBar:i.p,_metronomeOffset:i.o})),t.difficulty.customData._bookmarks=(n=t.difficulty.customData.bookmarks)==null?void 0:n.map(i=>({_time:i.b,_name:i.n})),delete t.difficulty.customData.time,delete t.difficulty.customData.BPMChanges,delete t.difficulty.customData.bookmarks}function qf(t){t.difficulty.customData._time=t.difficulty.customData.time??0;let e=!1;const n={},i=[t.arcs,t.bombNotes,t.chains,t.colorNotes,t.obstacles,t.waypoints].flat().sort(xt);for(let o=0;o<i.length;o++){const r=i[o];if(!(r.time in n))n[r.time]=r.laneRotation;else if(n[r.time]!==r.laneRotation){e=!0;break}}e?Z.warn(sr("fromV4"),"Impossible rotation event cannot be represented in v1!"):(t.rotationEvents=[],t.addRotationEvents(...Object.entries(n).map(([o,r])=>({time:+o,rotation:r}))));for(let o=0;o<i.length;o++){const r=i[o];r.laneRotation=0,r instanceof on&&(r.tailLaneRotation=0)}}function Mn(t){return t==="GlassDesertEnvironment"||t==="MultiplayerEnvironment"}function is(t){return["convert","toV1Info",t]}function Kf(t,e=t.version){switch(Z.tWarn(is("main"),"Converting to beatmap v1 may lose certain data!"),e){case 1:case 2:case 3:case 4:t.environmentBase.normal=t.environmentBase.normal||t.environmentNames.find(n=>!Mn(n))||"DefaultEnvironment",t.version=1;break;default:Z.tWarn(is("main"),"Unknown version: version not supported; misinput? Returning original data.")}return t}function os(t){return["convert","toV2Audio",t]}function Zf(t,e=t.version){switch(Z.tWarn(os("main"),"Converting to beatmap v2 may lose certain data!"),e){case 1:case 2:case 3:case 4:t.version=2;break;default:Z.tWarn(os("main"),"Unknown version: version not supported; misinput? Returning original data.")}return t}function mt(t,e,n){t[n]??(t[n]=t[e]),delete t[e]}function Bn(t){if(!t)return{};const e={...t};return Object.keys(e).length?(mt(e,"color","_color"),mt(e,"coordinates","_position"),mt(e,"disableNoteGravity","_disableNoteGravity"),mt(e,"disableNoteLook","_disableNoteLook"),mt(e,"flip","_flip"),mt(e,"localRotation","_localRotation"),mt(e,"noteJumpMovementSpeed","_noteJumpMovementSpeed"),mt(e,"noteJumpStartBeatOffset","_noteJumpStartBeatOffset"),mt(e,"size","_scale"),mt(e,"track","_track"),mt(e,"worldRotation","_rotation"),e._disableSpawnEffect??(e._disableSpawnEffect=typeof e.spawnEffect=="boolean"?!e.spawnEffect:void 0),delete e.spawnEffect,e._interactable??(e._interactable=typeof e.uninteractable=="boolean"?!e.uninteractable:void 0),delete e.uninteractable,e.animation&&(e._animation??(e._animation={_color:e.animation.color,_definitePosition:e.animation.definitePosition,_dissolve:e.animation.dissolve,_dissolveArrow:e.animation.dissolveArrow,_interactable:e.animation.interactable,_localRotation:e.animation.localRotation,_position:e.animation.offsetPosition,_rotation:e.animation.offsetRotation,_scale:e.animation.scale,_time:e.animation.time})),delete e.animation,e):{}}function Jf(t){if(!t)return{};const e={...t};return Object.keys(e).length?(mt(e,"color","_color"),mt(e,"lightID","_lightID"),mt(e,"easing","_easing"),mt(e,"lerpType","_lerpType"),mt(e,"nameFilter","_nameFilter"),mt(e,"rotation","_rotation"),mt(e,"step","_step"),mt(e,"prop","_prop"),mt(e,"speed","_speed"),mt(e,"direction","_direction"),mt(e,"lockRotation","_lockPosition"),e):{}}function Zn(t){return["convert","toV2Beatmap",t]}function Qf(t,e=t.version){switch(Z.tWarn(Zn("main"),"Converting to beatmap v2 may lose certain data!"),e){case 1:case 2:t.version=2;break;case 3:t.version=2,rs(t);break;case 4:t.version=2,rs(t),tp(t);break;default:Z.tWarn(Zn("main"),"Unknown version: version not supported; misinput? Returning original data.")}return t}function rs(t){var e,n,i,o,r;t.colorNotes.forEach(l=>{l.customData=Bn(l.customData)}),(e=t.difficulty.customData.fakeColorNotes)==null||e.forEach(l=>{const s=Bn(l.customData);t.addColorNotes({time:l.b,posX:l.x,posY:l.y,color:l.c,direction:l.d,customData:s})}),delete t.difficulty.customData.fakeColorNotes,t.bombNotes.forEach(l=>{l.customData=Bn(l.customData)}),(n=t.difficulty.customData.fakeBombNotes)==null||n.forEach(l=>{const s=Bn(l.customData);t.addColorNotes({time:l.b,posX:l.x,posY:l.y,customData:s})}),t.difficulty.obstacles.forEach(l=>{l.customData=Bn(l.customData)}),(i=t.difficulty.customData.fakeObstacles)==null||i.forEach(l=>{const s=Bn(l.customData);t.addObstacles({time:l.b,posX:l.x,posY:l.y,duration:l.d,width:l.w,height:l.h,customData:s})}),t.basicEvents.forEach(l=>{l.customData=Jf(l.customData),l.isLaserRotationEvent()?delete l.customData._speed:delete l.customData._preciseSpeed});for(const l in t.difficulty.customData){if(l==="customEvents"){t.difficulty.customData._customEvents=[];for(const s of t.difficulty.customData.customEvents){if(s.t==="AnimateTrack")for(let a=0,u=s.d.repeat??0;a<=u;a++)t.difficulty.customData._customEvents.push({_time:s.b+(s.d.duration??0)*a,_type:"AnimateTrack",_data:{_track:s.d.track,_duration:s.d.duration,_easing:s.d.easing,_position:s.d.position,_rotation:s.d.rotation,_localRotation:s.d.localRotation,_scale:s.d.scale,_dissolve:s.d.dissolve,_dissolveArrow:s.d.dissolveArrow,_color:s.d.color,_interactable:s.d.interactable,_time:s.d.time}});s.t==="AssignPathAnimation"&&t.difficulty.customData._customEvents.push({_time:s.b,_type:"AssignPathAnimation",_data:{_track:s.d.track,_easing:s.d.easing,_position:s.d.position,_rotation:s.d.rotation,_localRotation:s.d.localRotation,_scale:s.d.scale,_dissolve:s.d.dissolve,_dissolveArrow:s.d.dissolveArrow,_color:s.d.color,_interactable:s.d.interactable,_definitePosition:s.d.definitePosition}}),s.t==="AssignTrackParent"&&t.difficulty.customData._customEvents.push({_time:s.b,_type:"AssignTrackParent",_data:{_childrenTracks:s.d.childrenTracks,_parentTrack:s.d.parentTrack,_worldPositionStays:s.d.worldPositionStays}}),s.t==="AssignPlayerToTrack"&&t.difficulty.customData._customEvents.push({_time:s.b,_type:"AssignPlayerToTrack",_data:{_track:s.d.track,_target:s.d.target}}),s.t==="AnimateComponent"&&s.d.BloomFogEnvironment&&t.difficulty.customData._customEvents.push({_time:s.b,_type:"AssignFogTrack",_data:{_track:s.d.track,_duration:s.d.duration,_attenuation:s.d.BloomFogEnvironment.attenuation,_height:s.d.BloomFogEnvironment.height,_offset:s.d.BloomFogEnvironment.offset,_startY:s.d.BloomFogEnvironment.startY}})}delete t.difficulty.customData.customEvents;continue}if(l==="environment"){t.difficulty.customData._environment=t.difficulty.customData.environment.map(s=>{var a,u,c,p,v,m,h,d;if(s.id&&s.lookupMethod)return{_id:s.id,_lookupMethod:s.lookupMethod,_track:s.track,_duplicate:s.duplicate,_active:s.active,_scale:s.scale,_position:Be(s.position,1/.6),_rotation:s.rotation,_localPosition:Be(s.localPosition,1/.6),_localRotation:s.localRotation,_lightID:(u=(a=s.components)==null?void 0:a.ILightWithId)==null?void 0:u.lightID};if(s.geometry)return((p=(c=s.components)==null?void 0:c.ILightWithId)!=null&&p.type||(m=(v=s.components)==null?void 0:v.ILightWithId)!=null&&m.lightID)&&Z.tWarn(Zn("fromV2"),"v2 geometry cannot be made assignable light to specific type"),{_geometry:s.geometry.type==="CUSTOM"?{_type:s.geometry.type,_mesh:{_vertices:s.geometry.mesh.vertices,_uv:s.geometry.mesh.uv,_triangles:s.geometry.mesh.triangles},_material:typeof s.geometry.material=="string"?s.geometry.material:{_shader:s.geometry.material.shader,_shaderKeywords:s.geometry.material.shaderKeywords,_collision:s.geometry.material.collision,_track:s.geometry.material.track,_color:s.geometry.material.color},_collision:s.geometry.collision}:{_type:s.geometry.type,_material:typeof s.geometry.material=="string"?s.geometry.material:{_shader:s.geometry.material.shader,_shaderKeywords:s.geometry.material.shaderKeywords,_collision:s.geometry.material.collision,_track:s.geometry.material.track,_color:s.geometry.material.color},_collision:s.geometry.collision},_track:s.track,_duplicate:s.duplicate,_active:s.active,_scale:s.scale,_position:Be(s.position,1/.6),_rotation:s.rotation,_localPosition:Be(s.localPosition,1/.6),_localRotation:s.localRotation,_lightID:(d=(h=s.components)==null?void 0:h.ILightWithId)==null?void 0:d.lightID};throw new Error("Error converting environment v3 to v2")}),delete t.difficulty.customData.environment;continue}if(l==="materials"){t.difficulty.customData._materials={};for(const s in t.difficulty.customData.materials)t.difficulty.customData._materials[s]={_shader:t.difficulty.customData.materials[s].shader,_shaderKeywords:t.difficulty.customData.materials[s].shaderKeywords,_collision:t.difficulty.customData.materials[s].collision,_track:t.difficulty.customData.materials[s].track,_color:t.difficulty.customData.materials[s].color};delete t.difficulty.customData.materials;continue}if(l==="pointDefinitions"){t.difficulty.customData._pointDefinitions=[];for(const s in t.difficulty.customData.pointDefinitions)t.difficulty.customData._pointDefinitions.push({_name:s,_points:t.difficulty.customData.pointDefinitions[s]});delete t.difficulty.customData.pointDefinitions;continue}if(l==="time"){t.difficulty.customData._time=t.difficulty.customData[l],delete t.difficulty.customData.time;continue}if(l==="BPMChanges"){t.difficulty.customData._BPMChanges=(o=t.difficulty.customData[l])==null?void 0:o.map(s=>({_time:s.b,_BPM:s.m,_beatsPerBar:s.p,_metronomeOffset:s.o})),delete t.difficulty.customData.BPMChanges;continue}if(l==="bookmarks"){t.difficulty.customData._bookmarks=(r=t.difficulty.customData[l])==null?void 0:r.map(s=>({_time:s.b,_name:s.n,_color:s.c})),delete t.difficulty.customData.bookmarks;continue}}if(t.difficulty.customData._environment){const l=[];for(const a of t.difficulty.customData._environment)a._track&&l.push(a._track);const s=[];if(t.difficulty.customData._customEvents){for(const a of t.difficulty.customData._customEvents)if(a._type==="AnimateTrack"){if(typeof a._data._track=="string"&&l.includes(a._data._track))s.push(a);else if(Array.isArray(a._data._track)){for(const u of a._data._track)if(l.includes(u)){s.push(a);break}}}}for(const a of s)typeof a._data._track=="string"?typeof a._data._position=="string"?Z.tWarn(Zn("fromV2"),"Cannot convert point definitions, unknown use."):Array.isArray(a._data._position)&&(ml(a._data._position)?Be(a._data._position,.6):a._data._position.forEach(u=>{u[0]*=.6,u[1]*=.6,u[2]*=.6})):Z.tWarn(Zn("fromV2"),"Environment animate track array conversion not yet implemented.")}}function tp(t){let e=!1;const n={},i=[t.arcs,t.bombNotes,t.chains,t.colorNotes,t.obstacles,t.waypoints].flat().sort(xt);for(let o=0;o<i.length;o++){const r=i[o];if(!(r.time in n))n[r.time]=r.laneRotation;else if(n[r.time]!==r.laneRotation){e=!0;break}}if(e)for(let o=0;o<i.length;o++){const r=i[o];r.laneRotation&&(r.customData._rotation=r.laneRotation)}else t.rotationEvents=[],t.addRotationEvents(...Object.entries(n).map(([o,r])=>({time:+o,rotation:r})));for(let o=0;o<i.length;o++){const r=i[o];r.laneRotation=0,r instanceof on&&(r.tailLaneRotation=0)}}function ss(t){return["convert","toV2Info",t]}function ep(t,e=t.version){switch(Z.tWarn(ss("main"),"Converting to beatmap v2 may lose certain data!"),e){case 1:case 2:case 3:case 4:t.environmentBase.normal=t.environmentBase.normal||t.environmentNames.find(n=>!Mn(n))||"DefaultEnvironment",t.environmentBase.allDirections=t.environmentBase.allDirections||t.environmentNames.find(n=>Mn(n))||"DefaultEnvironment",t.version=2;break;default:Z.tWarn(ss("main"),"Unknown version: version not supported; misinput? Returning original data.")}return t}function Ro(t){if(!t)return{};const e={...t};return Object.keys(e).length?(mt(e,"_color","color"),mt(e,"_position","coordinates"),mt(e,"_disableNoteGravity","disableNoteGravity"),mt(e,"_disableNoteLook","disableNoteLook"),mt(e,"_flip","flip"),mt(e,"_localRotation","localRotation"),mt(e,"_noteJumpMovementSpeed","noteJumpMovementSpeed"),mt(e,"_noteJumpStartBeatOffset","noteJumpStartBeatOffset"),mt(e,"_scale","size"),mt(e,"_track","track"),mt(e,"_rotation","worldRotation"),e.spawnEffect??(e.spawnEffect=typeof e._disableSpawnEffect=="boolean"?!e._disableSpawnEffect:void 0),delete e._disableSpawnEffect,e.uninteractable??(e.uninteractable=typeof e._interactable=="boolean"?!e._interactable:void 0),delete e._interactable,e._animation&&(e.animation??(e.animation={color:e._animation._color,definitePosition:e._animation._definitePosition,dissolve:e._animation._dissolve,dissolveArrow:e._animation._dissolveArrow,interactable:e._animation._interactable,localRotation:e._animation._localRotation,offsetPosition:e._animation._position,offsetRotation:e._animation._rotation,scale:e._animation._scale,time:e._animation._time})),delete e._animation,e):{}}function np(t){if(!t)return{};const e={...t};return Object.keys(e).length?(mt(e,"_color","color"),mt(e,"_lightID","lightID"),mt(e,"_easing","easing"),mt(e,"_lerpType","lerpType"),mt(e,"_nameFilter","nameFilter"),mt(e,"_rotation","rotation"),mt(e,"_step","step"),mt(e,"_prop","prop"),mt(e,"_direction","direction"),mt(e,"_lockPosition","lockRotation"),typeof e._preciseSpeed=="number"?e.speed=e._preciseSpeed:e.speed??(e.speed=e._speed),delete e._speed,delete e._preciseSpeed,delete e._propID,delete e._lightGradient,delete e._reset,delete e._counterSpin,delete e._stepMult,delete e._propMult,delete e._speedMult,e):{}}function ve(t){return["convert","toV3Beatmap",t]}function El(t,e=t.version){switch(Z.tWarn(ve("main"),"Converting to beatmap v3 may lose certain data!"),e){case 1:t.version=3,ip(t);break;case 2:t.version=3,op(t);break;case 3:break;case 4:rp(t),t.version=3;break;default:Z.tWarn(ve("main"),"Unknown version: version not supported; misinput? Returning original data.")}return t}function ip(t){var e,n;t.colorNotes.forEach(i=>{i.direction>=1e3&&(i.angleOffset=Math.abs(i.direction%1e3%360-360),i.direction=i.direction>=1e3||typeof i.customData._cutDirection=="number"?i.direction===8?8:1:ul(i.direction,0,8))}),t.difficulty.customData.time=t.difficulty.customData._time,t.difficulty.customData.BPMChanges=(e=t.difficulty.customData._BPMChanges)==null?void 0:e.map(i=>({b:i._time,m:i._bpm??i._BPM,p:i._beatsPerBar,o:i._metronomeOffset})),t.difficulty.customData.bookmarks=(n=t.difficulty.customData._bookmarks)==null?void 0:n.map(i=>({b:i._time,n:i._name}))}function op(t){var o,r,l;t.difficulty.customData.fakeColorNotes=[],t.difficulty.customData.fakeBombNotes=[],t.difficulty.customData.fakeObstacles=[];const e=[];t.colorNotes.forEach((s,a)=>{const u=Ro(s.customData);typeof s.customData._cutDirection=="number"&&Z.tDebug(ve("fromV2"),`colorNotes[${a}] at time ${s.time} NE _cutDirection will be converted.`);let c=0;typeof s.customData._cutDirection=="number"?c=s.customData._cutDirection>0?s.customData._cutDirection%360:360+s.customData._cutDirection%360:s.direction>=1e3&&(c=Math.abs(s.direction%1e3%360-360));const p=s.direction>=1e3||typeof s.customData._cutDirection=="number"?s.direction===8?8:1:ul(s.direction,0,8);s.customData._fake?t.difficulty.customData.fakeColorNotes.push({b:s.time,c:s.color,x:s.posX,y:s.posY,d:p,a:c,customData:u}):(s.direction=p,s.angleOffset=c,s.customData=u,e.push(s))}),t.colorNotes=e;const n=[];t.bombNotes.forEach((s,a)=>{const u=Ro(s.customData);typeof s.customData._cutDirection=="number"&&Z.tDebug(ve("fromV2"),`bombNotes[${a}] at time ${s.time} NE _cutDirection will be converted.`),s.customData._fake?t.difficulty.customData.fakeBombNotes.push({b:s.time,x:s.posX,y:s.posY,customData:u}):(s.customData=u,n.push(s))}),t.bombNotes=n;const i=[];t.obstacles.forEach(s=>{const a=Ro(s.customData);s.customData._fake?t.difficulty.customData.fakeObstacles.push({b:s.time,x:s.posX,y:s.posY,d:s.duration,w:s.width,h:s.height,customData:a}):(s.customData=a,i.push(s))}),t.obstacles=i,t.basicEvents.forEach((s,a)=>{const u=np(s.customData);s.isLightEvent()&&(s.customData._propID&&Z.tWarn(ve("fromV2"),`events[${a}] at time ${s.time} Chroma _propID will be removed.`),s.customData._lightGradient&&Z.tWarn(ve("fromV2"),`events[${a}] at time ${s.time} Chroma _lightGradient will be removed.`)),s.isRingEvent()&&(s.customData._reset&&Z.tWarn(ve("fromV2"),`events[${a}] at time ${s.time} Chroma _reset will be removed.`),s.customData._counterSpin&&Z.tWarn(ve("fromV2"),`events[${a}] at time ${s.time} Chroma _counterSpin will be removed.`),(s.customData._stepMult||s.customData._propMult||s.customData._speedMult)&&Z.tWarn(ve("fromV2"),`events[${a}] at time ${s.time} Chroma _mult will be removed.`)),s.customData=u});for(const s in t.difficulty.customData){if(s==="_customEvents"){t.difficulty.customData.customEvents=[],t.difficulty.customData._customEvents.forEach(a=>{var u,c,p,v,m;a._type==="AnimateTrack"&&((u=t.difficulty.customData.customEvents)==null||u.push({b:a._time,t:"AnimateTrack",d:{track:a._data._track,duration:a._data._duration,easing:a._data._easing,position:a._data._position,rotation:a._data._rotation,localRotation:a._data._localRotation,scale:a._data._scale,dissolve:a._data._dissolve,dissolveArrow:a._data._dissolveArrow,color:a._data._color,interactable:a._data._interactable,time:a._data._time}})),a._type==="AssignPathAnimation"&&((c=t.difficulty.customData.customEvents)==null||c.push({b:a._time,t:"AssignPathAnimation",d:{track:a._data._track,easing:a._data._easing,position:a._data._position,rotation:a._data._rotation,localRotation:a._data._localRotation,scale:a._data._scale,dissolve:a._data._dissolve,dissolveArrow:a._data._dissolveArrow,color:a._data._color,interactable:a._data._interactable,definitePosition:a._data._definitePosition}})),a._type==="AssignTrackParent"&&((p=t.difficulty.customData.customEvents)==null||p.push({b:a._time,t:"AssignTrackParent",d:{childrenTracks:a._data._childrenTracks,parentTrack:a._data._parentTrack,worldPositionStays:a._data._worldPositionStays}})),a._type==="AssignPlayerToTrack"&&((v=t.difficulty.customData.customEvents)==null||v.push({b:a._time,t:"AssignPlayerToTrack",d:{track:a._data._track,target:a._data._target}})),a._type==="AssignFogTrack"&&((m=t.difficulty.customData.customEvents)==null||m.push({b:a._time,t:"AnimateComponent",d:{track:a._data._track,duration:a._data._duration||0,BloomFogEnvironment:{attenuation:typeof a._data._attenuation=="number"?[[a._data._attenuation,0]]:a._data._attenuation,height:typeof a._data._height=="number"?[[a._data._height,0]]:a._data._height,offset:typeof a._data._offset=="number"?[[a._data._offset,0]]:a._data._offset,startY:typeof a._data._startY=="number"?[[a._data._startY,0]]:a._data._startY}}}))}),delete t.difficulty.customData._customEvents;continue}if(s==="_environment"){t.difficulty.customData.environment=t.difficulty.customData._environment.map(a=>{let u={};if(a._lightID&&(u={ILightWithId:{lightID:a._lightID}}),a._id&&a._lookupMethod)return{id:a._id,lookupMethod:a._lookupMethod,track:a._track,duplicate:a._duplicate,active:a._active,scale:a._scale,position:Be(a._position,.6),rotation:a._rotation,localPosition:Be(a._localPosition,.6),localRotation:a._localRotation,components:u};if(a._geometry)return a._lightID&&u.ILightWithId&&(u.ILightWithId.type=0),{geometry:a._geometry._type==="CUSTOM"?{type:a._geometry._type,mesh:{vertices:a._geometry._mesh._vertices,uv:a._geometry._mesh._uv,triangles:a._geometry._mesh._triangles},material:typeof a._geometry._material=="string"?a._geometry._material:{shader:a._geometry._material._shader,shaderKeywords:a._geometry._material._shaderKeywords,collision:a._geometry._material._collision,track:a._geometry._material._track,color:a._geometry._material._color},collision:a._geometry._collision}:{type:a._geometry._type,material:typeof a._geometry._material=="string"?a._geometry._material:{shader:a._geometry._material._shader,shaderKeywords:a._geometry._material._shaderKeywords,collision:a._geometry._material._collision,track:a._geometry._material._track,color:a._geometry._material._color},collision:a._geometry._collision},track:a._track,duplicate:a._duplicate,active:a._active,scale:a._scale,position:Be(a._position,.6),rotation:a._rotation,localPosition:Be(a._localPosition,.6),localRotation:a._localRotation,components:u};throw new Error("Error converting environment v2 to v3")}),delete t.difficulty.customData._environment;continue}if(s==="_materials"){t.difficulty.customData.materials={};for(const a in t.difficulty.customData._materials)t.difficulty.customData.materials[a]={shader:t.difficulty.customData._materials[a]._shader,shaderKeywords:t.difficulty.customData._materials[a]._shaderKeywords,collision:t.difficulty.customData._materials[a]._collision,track:t.difficulty.customData._materials[a]._track,color:t.difficulty.customData._materials[a]._color};delete t.difficulty.customData._materials;continue}if(s==="_pointDefinitions"){t.difficulty.customData.pointDefinitions={},t.difficulty.customData._pointDefinitions.forEach(a=>{t.difficulty.customData.pointDefinitions[a._name]=a._points}),delete t.difficulty.customData._pointDefinitions;continue}if(s==="_time"){t.difficulty.customData.time=t.difficulty.customData[s],delete t.difficulty.customData._time;continue}if(s==="_BPMChanges"){t.difficulty.customData.BPMChanges=(o=t.difficulty.customData[s])==null?void 0:o.map(a=>({b:a._time,m:a._BPM,p:a._beatsPerBar,o:a._metronomeOffset})),delete t.difficulty.customData._BPMChanges;continue}if(s==="_bpmChanges"){t.difficulty.customData.BPMChanges=(r=t.difficulty.customData[s])==null?void 0:r.map(a=>({b:a._time,m:a._bpm,p:a._beatsPerBar,o:a._metronomeOffset})),delete t.difficulty.customData._bpmChanges;continue}if(s==="_bookmarks"){t.difficulty.customData.bookmarks=(l=t.difficulty.customData._bookmarks)==null?void 0:l.map(a=>({b:a._time,n:a._name,c:a._color})),delete t.difficulty.customData._bookmarks;continue}}if(t.difficulty.customData.environment){const s=[];for(const u of t.difficulty.customData.environment)u.track&&s.push(u.track);const a=[];if(t.difficulty.customData.customEvents){for(const u of t.difficulty.customData.customEvents)if(u.t==="AnimateTrack"){if(typeof u.d.track=="string"&&s.includes(u.d.track))a.push(u);else if(Array.isArray(u.d.track)){for(const c of u.d.track)if(s.includes(c)){a.push(u);break}}}}for(const u of a)typeof u.d.track=="string"?typeof u.d.position=="string"?Z.tWarn(ve("fromV2"),"Cannot convert point definitions, unknown use."):Array.isArray(u.d.position)&&(ml(u.d.position)?Be(u.d.position,.6):u.d.position.forEach(c=>{typeof c!="string"&&(c[0]*=.6,c[1]*=.6,c[2]*=.6)})):Z.tWarn(ve("fromV2"),"Environment animate track array conversion not yet implemented.")}t.lightshow.useNormalEventsAsCompatibleEvents=!0}function rp(t){let e=!1;const n={},i=[t.arcs,t.bombNotes,t.chains,t.colorNotes,t.obstacles,t.waypoints].flat().sort(xt);for(let o=0;o<i.length;o++){const r=i[o];if(!(r.time in n))n[r.time]=r.laneRotation;else if(n[r.time]!==r.laneRotation){e=!0;break}}if(e)for(let o=0;o<i.length;o++){const r=i[o];r.laneRotation&&(r.customData.worldRotation=r.laneRotation)}else t.rotationEvents=[],t.addRotationEvents(...Object.entries(n).map(([o,r])=>({time:+o,rotation:r})));for(let o=0;o<i.length;o++){const r=i[o];r.laneRotation=0,r instanceof on&&(r.tailLaneRotation=0)}}function as(t){return["convert","toV4Audio",t]}function sp(t,e=t.version){switch(Z.tWarn(as("main"),"Converting to beatmap v4 may lose certain data!"),e){case 1:case 2:case 3:case 4:t.version=4;break;default:Z.tWarn(as("main"),"Unknown version: version not supported; misinput? Returning original data.")}return t}function ap(t){return["convert","toV4Beatmap",t]}function lp(t,e=t.version){Z.tWarn(ap("main"),"As v4 is similar to v3, the conversion will use v3 convertor alongside."),El(t,e),t.version=4;const n=[t.arcs,t.bombNotes,t.chains,t.colorNotes,t.obstacles,t.waypoints].flat().sort(xt);if(t.rotationEvents.length){const i=[...t.rotationEvents].sort((r,l)=>r.executionTime-l.executionTime).sort(xt);let o=0;for(const r of i)o+=r.rotation;for(let r=n.length-1;r>=0;r--){const l=n[r];let s=i.at(-1);for(;s&&s.time>l.time;)i.pop(),o-=s.rotation,s=i.at(-1);if(!s)break;if(s.time===l.time&&s.executionTime===or.EARLY){l.laneRotation=o%360,l instanceof on&&(l.tailLaneRotation=l.laneRotation);continue}for(;s&&s.time>=l.time;)i.pop(),o-=s.rotation,s=i.at(-1);if(!s)break;l.laneRotation=o%360,l instanceof on&&(l.tailLaneRotation=l.laneRotation)}t.rotationEvents=[]}for(let i=0;i<n.length;i++){const o=n[i];typeof o.customData.worldRotation=="number"&&(o.laneRotation=o.customData.worldRotation,o instanceof on&&(o.tailLaneRotation=o.customData.worldRotation),delete o.customData.worldRotation)}return t}function ls(t){return["convert","toV4Info",t]}function up(t,e=t.version){switch(Z.tWarn(ls("main"),"Converting to beatmap v4 may lose certain data!"),e){case 1:t.environmentNames=[t.environmentBase.normal||"DefaultEnvironment"],t.difficulties.forEach(n=>{n.environmentId=0});case 2:case 3:case 4:t.version=4;break;default:Z.tWarn(ls("main"),"Unknown version: version not supported; misinput? Returning original data.")}return t}class qi extends Oe{constructor(){super(...arguments),Object.defineProperty(this,"filter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"beatDistribution",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"beatDistributionType",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"easing",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"affectFirst",{enumerable:!0,configurable:!0,writable:!0,value:0})}setFilter(e){return this.filter=e,this}setBeatDistribution(e){return this.beatDistribution=e,this}setBeatDistributionType(e){return this.beatDistributionType=e,this}setEasing(e){return this.easing=e,this}setAffectFirst(e){return this.affectFirst=e,this}isValid(e,n){return n?super.isValid(e,n):super.isValid(e,n)&&(this.beatDistributionType===1||this.beatDistributionType===2)&&this.easing>=-1&&this.easing<=103&&this.events.every(i=>typeof i=="number"||i.isValid())&&this.filter.isValid()}}class Ki extends Ae{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:0})}isValid(e,n){return n?super.isValid(e,n):super.isValid(e,n)&&this.id>=0&&this.boxes.every(i=>i.isValid())}}class It extends on{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"lengthMultiplier",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tailLengthMultiplier",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tailDirection",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"midAnchor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.time=e.time??It.defaultValue.time,this.posX=e.posX??It.defaultValue.posX,this.posY=e.posY??It.defaultValue.posY,this.color=e.color??It.defaultValue.color,this.direction=e.direction??It.defaultValue.direction,this.lengthMultiplier=e.lengthMultiplier??It.defaultValue.lengthMultiplier,this.tailTime=e.tailTime??It.defaultValue.tailTime,this.tailPosX=e.tailPosX??It.defaultValue.tailPosX,this.tailPosY=e.tailPosY??It.defaultValue.tailPosY,this.tailDirection=e.tailDirection??It.defaultValue.tailDirection,this.tailLengthMultiplier=e.tailLengthMultiplier??It.defaultValue.tailLengthMultiplier,this.midAnchor=e.midAnchor??It.defaultValue.midAnchor,this.laneRotation=e.laneRotation??It.defaultValue.laneRotation,this.tailLaneRotation=e.tailLaneRotation??It.defaultValue.tailLaneRotation,this.customData=N(e.customData??It.defaultValue.customData)}isValid(e,n){return n?super.isValid(e,n):super.isValid(e,n)&&!(this.isInverse()||this.posX<0||this.posX>3||this.tailPosX<0||this.tailPosX>3||this.posX===this.tailPosX&&this.posY===this.tailPosY&&this.time===this.tailTime)}setLengthMultiplier(e){return this.lengthMultiplier=e,this}setTailLengthMultiplier(e){return this.tailLengthMultiplier=e,this}setTailDirection(e){return this.tailDirection=e,this}setMidAnchor(e){return this.midAnchor=e,this}mirror(e=!0,n){switch(n==null||n(this),this.tailDirection){case 2:this.tailDirection=3;break;case 3:this.tailDirection=2;break;case 6:this.tailDirection=7;break;case 7:this.tailDirection=6;break;case 4:this.tailDirection=5;break;case 5:this.tailDirection=4;break}return this.midAnchor&&(this.midAnchor=this.midAnchor===1?2:1),super.mirror(e)}getTailAngle(e){return(e==null?void 0:e(this))||Se[this.tailDirection]||0}}Object.defineProperty(It,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,posX:0,posY:0,color:0,direction:0,lengthMultiplier:0,tailTime:0,tailPosX:0,tailPosY:0,tailDirection:0,tailLengthMultiplier:0,midAnchor:0,laneRotation:0,tailLaneRotation:0,customData:{}}});class _e extends Oe{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filename",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"audioChecksum",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sampleCount",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"frequency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"bpmData",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lufsData",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.version=e.version??_e.defaultValue.version,this.filename=e.filename??_e.defaultValue.filename,this.audioChecksum=e.audioChecksum??_e.defaultValue.audioChecksum,this.sampleCount=e.sampleCount??_e.defaultValue.sampleCount,this.frequency=e.frequency??_e.defaultValue.frequency,this.bpmData=(e.bpmData??_e.defaultValue.bpmData).map(n=>({startBeat:(n==null?void 0:n.startBeat)||0,startSampleIndex:(n==null?void 0:n.startSampleIndex)||0,endBeat:(n==null?void 0:n.endBeat)||0,endSampleIndex:(n==null?void 0:n.endSampleIndex)||0})),this.lufsData=(e.lufsData??_e.defaultValue.lufsData).map(n=>({startSampleIndex:(n==null?void 0:n.startSampleIndex)||0,endSampleIndex:(n==null?void 0:n.endSampleIndex)||0,lufs:(n==null?void 0:n.lufs)||0})),this.customData=N(e.customData??_e.defaultValue.customData)}isValid(e,n){return n?super.isValid(e,n):super.isValid(e,n)&&this.frequency>=0&&this.sampleCount>=0&&this.bpmData.every(i=>i.endBeat>i.startBeat&&i.endSampleIndex>i.startSampleIndex)}setFilename(e){return this.filename=e,this}setVersion(e){return this.version=e,this}setSampleCount(e){return this.sampleCount=e,this}setFrequency(e){return this.frequency=e,this}fromBpmEvents(e,n=44100,i){if(!e.length)return this;this.frequency=n,i&&(this.sampleCount=i),this.bpmData=[];for(let a=0;a<e.length-1;a++){const u=e[a],c=e[a+1];this.bpmData.push({startSampleIndex:Math.floor(u.time*this.frequency),endSampleIndex:Math.floor(c.time*this.frequency),startBeat:u.time,endBeat:c.time})}const o=e[e.length-1],r=Math.floor(o.time*this.frequency),s=(this.sampleCount-r)/this.frequency*(o.bpm/60);return this.bpmData.push({startSampleIndex:r,endSampleIndex:this.sampleCount,startBeat:o.time,endBeat:o.time+s}),this}getBpmEvents(){return this.bpmData.map(e=>{const n=e.endSampleIndex-e.startSampleIndex,i=(e.endBeat-e.startBeat)/(n/this.frequency)*60;return{time:e.startBeat,bpm:i,customData:{}}})}sort(){return this.bpmData.sort((e,n)=>e.startBeat-n.startBeat),this}}Object.defineProperty(_e,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{version:-1,filename:"AudioData.dat",audioChecksum:"",sampleCount:44100,frequency:0,bpmData:[],lufsData:[],customData:{}}});class yn extends Ae{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"bpm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.time=e.time??yn.defaultValue.time,this.bpm=e.bpm??yn.defaultValue.bpm,this.customData=N(e.customData??yn.defaultValue.customData)}isValid(e,n){return n?super.isValid(e,n):super.isValid(e,n)&&this.bpm>0}setBPM(e){return this.bpm=e,this}}Object.defineProperty(yn,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,bpm:0,customData:{}}});class Ke extends Ae{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"executionTime",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"rotation",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.time=e.time??Ke.defaultValue.time,this.executionTime=e.executionTime??Ke.defaultValue.executionTime,this.rotation=e.rotation??Ke.defaultValue.rotation,this.customData=N(e.customData??Ke.defaultValue.customData)}setExecutionTime(e){return this.executionTime=e,this}setRotation(e){return this.rotation=e,this}isValid(e,n){return n?super.isValid(e,n):super.isValid(e,n)&&(this.executionTime===0||this.executionTime===1)}}Object.defineProperty(Ke,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,executionTime:0,rotation:0,customData:{}}});class Wt extends _r{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"angleOffset",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.time=e.time??Wt.defaultValue.time,this.posX=e.posX??Wt.defaultValue.posX,this.posY=e.posY??Wt.defaultValue.posY,this.color=e.color??Wt.defaultValue.color,this.direction=e.direction??Wt.defaultValue.direction,this.angleOffset=e.angleOffset??Wt.defaultValue.angleOffset,this.laneRotation=e.laneRotation??Wt.defaultValue.laneRotation,this.customData=N(e.customData??Wt.defaultValue.customData)}isValid(e,n){return n?super.isValid(e,n):super.isValid(e,n)&&this.posX>=0&&this.posX<=3&&this.posY>=0&&this.posY<=2&&this.direction>=0&&this.direction<=8}setAngleOffset(e){return this.angleOffset=e,this}mirror(e=!0,n){return n==null||n(this),super.mirror(e)}getAngle(e){return(e==null?void 0:e(this))??(Se[this.direction]||0)+this.angleOffset}}Object.defineProperty(Wt,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,posX:0,posY:0,color:0,direction:0,angleOffset:0,laneRotation:0,customData:{}}});class De extends _r{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),this.time=e.time??De.defaultValue.time,this.posX=e.posX??De.defaultValue.posX,this.posY=e.posY??De.defaultValue.posY,this.color=-1,this.direction=e.direction??De.defaultValue.direction,this.laneRotation=e.laneRotation??De.defaultValue.laneRotation,this.customData=N(e.customData??De.defaultValue.customData)}isValid(e,n){return n?super.isValid(e,n):super.isValid(e,n)&&this.posX>=0&&this.posX<=3&&this.posY>=0&&this.posY<=2}}Object.defineProperty(De,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,posX:0,posY:0,color:-1,direction:0,laneRotation:0,customData:{}}});class Pt extends vr{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"duration",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.time=e.time??Pt.defaultValue.time,this.posX=e.posX??Pt.defaultValue.posX,this.posY=e.posY??Pt.defaultValue.posY,this.width=e.width??Pt.defaultValue.width,this.height=e.height??Pt.defaultValue.height,this.duration=e.duration??Pt.defaultValue.duration,this.laneRotation=e.laneRotation??Pt.defaultValue.laneRotation,this.customData=N(e.customData??Pt.defaultValue.customData)}isValid(e,n){return n?super.isValid(e,n):super.isValid(e,n)&&!this.hasZero()&&!this.hasNegative()}setDuration(e){return this.duration=e,this}setWidth(e){return this.width=e,this}setHeight(e){return this.height=e,this}mirror(e,n){return n==null||n(this),this.posX=Xi-1-(this.posX+this.width-1),this}getPosition(e){return(e==null?void 0:e(this))??[this.posX-2,this.posY-.5]}isInteractive(){return this.posX<0&&this.width>1-this.posX||this.posX===0&&this.width>1||this.posX===1||this.posX===2}isLonger(e,n=0){return this.time+this.duration>e.time+e.duration+n}hasZero(){return this.duration===0||this.width===0||this.height===0}hasNegative(){return this.posY<0||this.duration<0||this.width<0||this.height<0}}Object.defineProperty(Pt,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,posX:0,posY:0,width:0,height:0,duration:0,laneRotation:0,customData:{}}});class Mt extends on{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"sliceCount",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"squish",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.time=e.time??Mt.defaultValue.time,this.posX=e.posX??Mt.defaultValue.posX,this.posY=e.posY??Mt.defaultValue.posY,this.color=e.color??Mt.defaultValue.color,this.direction=e.direction??Mt.defaultValue.direction,this.laneRotation=e.laneRotation??Mt.defaultValue.laneRotation,this.tailTime=e.tailTime??Mt.defaultValue.tailTime,this.tailPosX=e.tailPosX??Mt.defaultValue.tailPosX,this.tailPosY=e.tailPosY??Mt.defaultValue.tailPosY,this.tailLaneRotation=e.tailLaneRotation??Mt.defaultValue.tailLaneRotation,this.sliceCount=e.sliceCount??Mt.defaultValue.sliceCount,this.squish=e.squish??Mt.defaultValue.squish,this.customData=N(e.customData??Mt.defaultValue.customData)}isValid(e,n){return n?super.isValid(e,n):super.isValid(e,n)&&(!this.isInverse()||this.posY>=0||this.posY<=2||this.tailPosY>=0||this.tailPosY<=2)}setSliceCount(e){return this.sliceCount=e,this}setSquish(e){return this.squish=e,this}}Object.defineProperty(Mt,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,posX:0,posY:0,color:0,direction:0,laneRotation:0,tailTime:0,tailPosX:0,tailPosY:0,tailLaneRotation:0,sliceCount:0,squish:0,customData:{}}});class ye extends Oe{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"bpmEvents",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"rotationEvents",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"colorNotes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"bombNotes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"obstacles",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"arcs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"chains",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bpmEvents=(e.bpmEvents??ye.defaultValue.bpmEvents).map(n=>new yn(n)),this.rotationEvents=(e.rotationEvents??ye.defaultValue.rotationEvents).map(n=>new Ke(n)),this.colorNotes=(e.colorNotes??ye.defaultValue.colorNotes).map(n=>new Wt(n)),this.bombNotes=(e.bombNotes??ye.defaultValue.bombNotes).map(n=>new De(n)),this.obstacles=(e.obstacles??ye.defaultValue.obstacles).map(n=>new Pt(n)),this.arcs=(e.arcs??ye.defaultValue.arcs).map(n=>new It(n)),this.chains=(e.chains??ye.defaultValue.chains).map(n=>new Mt(n)),this.customData=N(e.customData??ye.defaultValue.customData)}isValid(e,n){return n?super.isValid(e,n):super.isValid(e,n)&&this.bpmEvents.every(i=>i.isValid())&&this.rotationEvents.every(i=>i.isValid())&&this.colorNotes.every(i=>i.isValid())&&this.bombNotes.every(i=>i.isValid())&&this.obstacles.every(i=>i.isValid())&&this.arcs.every(i=>i.isValid())&&this.chains.every(i=>i.isValid())}sort(){return this.bpmEvents.sort(xt),this.rotationEvents.sort(xt),this.colorNotes.sort(An),this.bombNotes.sort(An),this.obstacles.sort(xt),this.arcs.sort(An),this.chains.sort(An),this}addBpmEvents(...e){for(const n of e)this.bpmEvents.push(new yn(n));return this}addRotationEvents(...e){for(const n of e)this.rotationEvents.push(new Ke(n));return this}addColorNotes(...e){for(const n of e)this.colorNotes.push(new Wt(n));return this}addBombNotes(...e){for(const n of e)this.bombNotes.push(new De(n));return this}addObstacles(...e){for(const n of e)this.obstacles.push(new Pt(n));return this}addArcs(...e){for(const n of e)this.arcs.push(new It(n));return this}addChains(...e){for(const n of e)this.chains.push(new Mt(n));return this}}Object.defineProperty(ye,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{bpmEvents:[],rotationEvents:[],colorNotes:[],bombNotes:[],obstacles:[],arcs:[],chains:[],customData:{}}});class Re extends vr{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"direction",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.time=e.time??Re.defaultValue.time,this.posX=e.posX??Re.defaultValue.posX,this.posY=e.posY??Re.defaultValue.posY,this.direction=e.direction??Re.defaultValue.direction,this.laneRotation=e.laneRotation??Re.defaultValue.laneRotation,this.customData=N(e.customData??Re.defaultValue.customData)}setDirection(e){return this.direction=e,this}mirror(e,n){switch(n==null||n(this),this.posX=Xi-1-this.posX,this.direction){case 2:this.direction=3;break;case 3:this.direction=2;break;case 6:this.direction=7;break;case 7:this.direction=6;break;case 4:this.direction=5;break;case 5:this.direction=4;break}return this}isValid(e,n){return n?super.isValid(e,n):super.isValid(e,n)&&this.direction>=0&&this.direction<=9&&this.direction!==8}}Object.defineProperty(Re,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,posX:0,posY:0,direction:0,laneRotation:0,customData:{}}});class En extends Ae{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"toggle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.time=e.time??En.defaultValue.time,this.toggle=e.toggle??En.defaultValue.toggle,this.customData=N(e.customData??En.defaultValue.customData)}setToggle(e){return this.toggle=e,this}}Object.defineProperty(En,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,toggle:!1,customData:{}}});class Vt extends Oe{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"p0",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"p1",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reverse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"chunks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"limit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"limitAffectsType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"random",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"seed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.type=e.type??Vt.defaultValue.type,this.p0=e.p0??Vt.defaultValue.p0,this.p1=e.p1??Vt.defaultValue.p1,this.reverse=e.reverse??Vt.defaultValue.reverse,this.chunks=e.chunks??Vt.defaultValue.chunks,this.random=e.random??Vt.defaultValue.random,this.seed=e.seed??Vt.defaultValue.seed,this.limit=e.limit??Vt.defaultValue.limit,this.limitAffectsType=e.limitAffectsType??Vt.defaultValue.limitAffectsType,this.customData=N(e.customData??Vt.defaultValue.customData)}setType(e){return this.type=e,this}setP0(e){return this.p0=e,this}setP1(e){return this.p1=e,this}setReverse(e){return this.reverse=e,this}setChunks(e){return this.chunks=e,this}setRandom(e){return this.random=e,this}setSeed(e){return this.seed=e,this}setLimit(e){return this.limit=e,this}setLimitAffectsType(e){return this.limitAffectsType=e,this}isValid(e,n){return n?super.isValid(e,n):super.isValid(e,n)&&(this.type===1||this.type===2)&&this.p0>=0&&this.p1>=0&&(this.reverse===0||this.reverse===1)&&this.chunks>=0&&this.random>=0&&this.random<=ir.ALL&&this.limit>=0&&this.limit<=1&&this.limitAffectsType>=0&&this.limitAffectsType<=nr.ALL}}Object.defineProperty(Vt,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{type:1,p0:0,p1:0,reverse:0,chunks:0,random:0,seed:0,limit:0,limitAffectsType:0,customData:{}}});class ae extends Ae{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"previous",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"brightness",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"frequency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"strobeBrightness",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"strobeFade",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"easing",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.time=e.time??ae.defaultValue.time,this.previous=e.previous??ae.defaultValue.previous,this.color=e.color??ae.defaultValue.color,this.frequency=e.frequency??ae.defaultValue.frequency,this.brightness=e.brightness??ae.defaultValue.brightness,this.strobeBrightness=e.strobeBrightness??ae.defaultValue.strobeBrightness,this.strobeFade=e.strobeFade??ae.defaultValue.strobeFade,this.easing=e.easing??ae.defaultValue.easing,this.customData=N(e.customData??ae.defaultValue.customData)}setPrevious(e){return this.previous=e,this}setColor(e){return this.color=e,this}setBrightness(e){return this.brightness=e,this}setFrequency(e){return this.frequency=e,this}setStrobeBrightness(e){return this.strobeBrightness=e,this}setStrobeFade(e){return this.strobeFade=e,this}setEasing(e){return this.easing=e,this}isValid(e,n){return n?super.isValid(e,n):super.isValid(e,n)&&(this.previous===0||this.previous===1)&&this.easing>=-1&&this.easing<=103&&this.color>=-1&&this.color<=2&&this.brightness>=0&&this.frequency>=0}}Object.defineProperty(ae,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,previous:0,color:0,frequency:0,brightness:0,strobeBrightness:0,strobeFade:0,easing:0,customData:{}}});class le extends qi{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"brightnessDistribution",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"brightnessDistributionType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.filter=new Vt(e.filter??le.defaultValue.filter),this.beatDistribution=e.beatDistribution??le.defaultValue.beatDistribution,this.beatDistributionType=e.beatDistributionType??le.defaultValue.beatDistributionType,this.brightnessDistribution=e.brightnessDistribution??le.defaultValue.brightnessDistribution,this.brightnessDistributionType=e.brightnessDistributionType??le.defaultValue.brightnessDistributionType,this.affectFirst=e.affectFirst??le.defaultValue.affectFirst,this.easing=e.easing??le.defaultValue.easing,this.events=(e.events??le.defaultValue.events).map(n=>new ae(n)),this.customData=N(e.customData??le.defaultValue.customData)}setBrightnessDistribution(e){return this.brightnessDistribution=e,this}setBrightnessDistributionType(e){return this.brightnessDistributionType=e,this}setEvents(e){return this.events=e,this}isValid(e,n){return n?super.isValid(e,n):super.isValid(e,n)&&(this.brightnessDistributionType===1||this.brightnessDistributionType===2)&&(this.affectFirst===0||this.affectFirst===1)}}Object.defineProperty(le,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{filter:{type:1,p0:0,p1:0,reverse:0,chunks:0,random:0,seed:0,limit:0,limitAffectsType:0,customData:{}},beatDistribution:0,beatDistributionType:1,brightnessDistribution:0,brightnessDistributionType:1,affectFirst:0,easing:0,events:[],customData:{}}});class Ze extends Ki{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"boxes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.time=e.time??Ze.defaultValue.time,this.id=e.id??Ze.defaultValue.id,this.boxes=(e.boxes??Ze.defaultValue.boxes).map(n=>new le(n)),this.customData=N(e.customData??Ze.defaultValue.customData)}}Object.defineProperty(Ze,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,id:0,boxes:[],customData:{}}});class Le extends Ae{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"previous",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"easing",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"loop",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"rotation",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"direction",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.time=e.time??Le.defaultValue.time,this.easing=e.easing??Le.defaultValue.easing,this.loop=e.loop??Le.defaultValue.loop,this.direction=e.direction??Le.defaultValue.direction,this.previous=e.previous??Le.defaultValue.previous,this.rotation=e.rotation??Le.defaultValue.rotation,this.customData=N(e.customData??Le.defaultValue.customData)}setPrevious(e){return this.previous=e,this}setEasing(e){return this.easing=e,this}setLoop(e){return this.loop=e,this}setRotation(e){return this.rotation=e,this}setDirection(e){return this.direction=e,this}isValid(e,n){return n?super.isValid(e,n):super.isValid(e,n)&&(this.previous===0||this.previous===1)&&this.easing>=-1&&this.easing<=103&&this.loop>=0&&this.direction>=0&&this.direction<=2}}Object.defineProperty(Le,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,easing:0,loop:0,direction:0,previous:0,rotation:0,customData:{}}});class Xt extends qi{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"rotationDistribution",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"rotationDistributionType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"axis",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"flip",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.filter=new Vt(e.filter??Xt.defaultValue.filter),this.axis=e.axis??Xt.defaultValue.axis,this.flip=e.flip??Xt.defaultValue.flip,this.beatDistribution=e.beatDistribution??Xt.defaultValue.beatDistribution,this.beatDistributionType=e.beatDistributionType??Xt.defaultValue.beatDistributionType,this.rotationDistribution=e.rotationDistribution??Xt.defaultValue.rotationDistribution,this.rotationDistributionType=e.rotationDistributionType??Xt.defaultValue.rotationDistributionType,this.affectFirst=e.affectFirst??Xt.defaultValue.affectFirst,this.easing=e.easing??Xt.defaultValue.easing,this.events=(e.events??Xt.defaultValue.events).map(n=>new Le(n)),this.customData=N(e.customData??Xt.defaultValue.customData)}setRotationDistribution(e){return this.rotationDistribution=e,this}setRotationDistributionType(e){return this.rotationDistributionType=e,this}setAxis(e){return this.axis=e,this}setFlip(e){return this.flip=e,this}setEvents(e){return this.events=e,this}isValid(e,n){return n?super.isValid(e,n):super.isValid(e,n)&&(this.rotationDistributionType===1||this.rotationDistributionType===2)&&(this.axis===0||this.axis===1||this.axis===2)&&(this.flip===0||this.flip===1)&&(this.affectFirst===0||this.affectFirst===1)}}Object.defineProperty(Xt,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{filter:{type:1,p0:0,p1:0,reverse:0,chunks:0,random:0,seed:0,limit:0,limitAffectsType:0,customData:{}},axis:0,flip:0,beatDistribution:0,beatDistributionType:1,rotationDistribution:0,rotationDistributionType:1,affectFirst:0,easing:0,events:[],customData:{}}});class Je extends Ki{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"boxes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.time=e.time??Je.defaultValue.time,this.id=e.id??Je.defaultValue.id,this.boxes=(e.boxes??Je.defaultValue.boxes).map(n=>new Xt(n)),this.customData=N(e.customData??Je.defaultValue.customData)}}Object.defineProperty(Je,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,id:0,boxes:[],customData:{}}});class Xe extends Ae{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"previous",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"easing",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"translation",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.time=e.time??Xe.defaultValue.time,this.easing=e.easing??Xe.defaultValue.easing,this.previous=e.previous??Xe.defaultValue.previous,this.translation=e.translation??Xe.defaultValue.translation,this.customData=N(e.customData??Xe.defaultValue.customData)}setPrevious(e){return this.previous=e,this}setEasing(e){return this.easing=e,this}setTranslation(e){return this.translation=e,this}isValid(e,n){return n?super.isValid(e,n):super.isValid(e,n)&&(this.previous===0||this.previous===1)&&this.easing>=-1&&this.easing<=103}}Object.defineProperty(Xe,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,easing:0,previous:0,translation:0,customData:{}}});class qt extends qi{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"gapDistribution",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"gapDistributionType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"axis",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"flip",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.filter=new Vt(e.filter??qt.defaultValue.filter),this.axis=e.axis??qt.defaultValue.axis,this.flip=e.flip??qt.defaultValue.flip,this.beatDistribution=e.beatDistribution??qt.defaultValue.beatDistribution,this.beatDistributionType=e.beatDistributionType??qt.defaultValue.beatDistributionType,this.gapDistribution=e.gapDistribution??qt.defaultValue.gapDistribution,this.gapDistributionType=e.gapDistributionType??qt.defaultValue.gapDistributionType,this.affectFirst=e.affectFirst??qt.defaultValue.affectFirst,this.easing=e.easing??qt.defaultValue.easing,this.events=(e.events??qt.defaultValue.events).map(n=>new Xe(n)),this.customData=N(e.customData??qt.defaultValue.customData)}setGapDistribution(e){return this.gapDistribution=e,this}setGapDistributionType(e){return this.gapDistributionType=e,this}setAxis(e){return this.axis=e,this}setFlip(e){return this.flip=e,this}setEvents(e){return this.events=e,this}isValid(e,n){return n?super.isValid(e,n):super.isValid(e,n)&&(this.gapDistributionType===1||this.gapDistributionType===2)&&(this.axis===0||this.axis===1||this.axis===2)&&(this.flip===0||this.flip===1)&&(this.affectFirst===0||this.affectFirst===1)}}Object.defineProperty(qt,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{filter:{type:1,p0:0,p1:0,reverse:0,chunks:0,random:0,seed:0,limit:0,limitAffectsType:0,customData:{}},axis:0,flip:0,beatDistribution:0,beatDistributionType:1,gapDistribution:0,gapDistributionType:1,affectFirst:0,easing:0,events:[],customData:{}}});class Qe extends Ki{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"boxes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.time=e.time??Qe.defaultValue.time,this.id=e.id??Qe.defaultValue.id,this.boxes=(e.boxes??Qe.defaultValue.boxes).map(n=>new qt(n)),this.customData=N(e.customData??Qe.defaultValue.customData)}}Object.defineProperty(Qe,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,id:0,boxes:[],customData:{}}});class qe extends Ae{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"easing",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"previous",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.time=e.time??qe.defaultValue.time,this.easing=e.easing??qe.defaultValue.easing,this.previous=e.previous??qe.defaultValue.previous,this.value=e.value??qe.defaultValue.value,this.customData=N(e.customData??qe.defaultValue.customData)}setEasing(e){return this.easing=e,this}setPrevious(e){return this.previous=e,this}setValue(e){return this.value=e,this}isValid(e,n){return n?super.isValid(e,n):super.isValid(e,n)&&(this.previous===0||this.previous===1)&&this.easing>=-1&&this.easing<=103}}Object.defineProperty(qe,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,easing:0,previous:0,value:0,customData:{}}});class ue extends qi{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"fxDistribution",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fxDistributionType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.filter=new Vt(e.filter??ue.defaultValue.filter),this.beatDistribution=e.beatDistribution??ue.defaultValue.beatDistribution,this.beatDistributionType=e.beatDistributionType??ue.defaultValue.beatDistributionType,this.fxDistribution=e.fxDistribution??ue.defaultValue.fxDistribution,this.fxDistributionType=e.fxDistributionType??ue.defaultValue.fxDistributionType,this.affectFirst=e.affectFirst??ue.defaultValue.affectFirst,this.easing=e.easing??ue.defaultValue.easing,this.events=(e.events??ue.defaultValue.events).map(n=>new qe(n)),this.customData=N(e.customData??ue.defaultValue.customData)}setFxDistribution(e){return this.fxDistribution=e,this}setFxDistributionType(e){return this.fxDistributionType=e,this}setEvents(e){return this.events=e,this}isValid(e,n){return n?super.isValid(e,n):super.isValid(e,n)&&(this.fxDistributionType===1||this.fxDistributionType===2)&&(this.affectFirst===0||this.affectFirst===1)}}Object.defineProperty(ue,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{filter:{type:1,p0:0,p1:0,reverse:0,chunks:0,random:0,seed:0,limit:0,limitAffectsType:0,customData:{}},beatDistribution:0,beatDistributionType:1,fxDistribution:0,fxDistributionType:1,affectFirst:0,easing:0,events:[],customData:{}}});class tn extends Ki{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"boxes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.time=e.time??tn.defaultValue.time,this.id=e.id??tn.defaultValue.id,this.boxes=(e.boxes??tn.defaultValue.boxes).map(n=>new ue(n)),this.customData=N(e.customData??tn.defaultValue.customData)}}Object.defineProperty(tn,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{time:0,id:0,boxes:[],customData:{}}});class Pn extends Oe{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"keyword",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyword=e.keyword??Pn.defaultValue.keyword,this.events=(e.events??Pn.defaultValue.events).map(n=>n).filter(n=>n),this.customData=N(e.customData??Pn.defaultValue.customData)}setKeyword(e){return this.keyword=e,this}setEvents(e){return this.events=e,this}addEvent(e){return this.events.push(e),this}removeEvent(e){const n=this.events.indexOf(e,0);return n>-1&&this.events.splice(n,1),this}}Object.defineProperty(Pn,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{keyword:"",events:[],customData:{}}});class ce extends Oe{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){var n;super(),Object.defineProperty(this,"waypoints",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"basicEvents",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"colorBoostEvents",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lightColorEventBoxGroups",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lightRotationEventBoxGroups",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lightTranslationEventBoxGroups",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fxEventBoxGroups",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"basicEventTypesWithKeywords",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"useNormalEventsAsCompatibleEvents",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.waypoints=(e.waypoints??ce.defaultValue.waypoints).map(i=>new Re(i)),this.basicEvents=(e.basicEvents??ce.defaultValue.basicEvents).map(i=>new Me(i)),this.colorBoostEvents=(e.colorBoostEvents??ce.defaultValue.colorBoostEvents).map(i=>new En(i)),this.lightColorEventBoxGroups=(e.lightColorEventBoxGroups??ce.defaultValue.lightColorEventBoxGroups).map(i=>new Ze(i)),this.lightRotationEventBoxGroups=(e.lightRotationEventBoxGroups??ce.defaultValue.lightRotationEventBoxGroups).map(i=>new Je(i)),this.lightTranslationEventBoxGroups=(e.lightTranslationEventBoxGroups??ce.defaultValue.lightTranslationEventBoxGroups).map(i=>new Qe(i)),this.fxEventBoxGroups=(e.fxEventBoxGroups??ce.defaultValue.fxEventBoxGroups).map(i=>new tn(i)),this.basicEventTypesWithKeywords={list:(((n=e.basicEventTypesWithKeywords)==null?void 0:n.list)??ce.defaultValue.basicEventTypesWithKeywords.list).map(i=>new Pn(i))},this.useNormalEventsAsCompatibleEvents=!!e.useNormalEventsAsCompatibleEvents,this.customData=N(e.customData??ce.defaultValue.customData)}isValid(e,n){return n?super.isValid(e,n):super.isValid(e,n)&&this.waypoints.every(i=>i.isValid())&&this.basicEvents.every(i=>i.isValid())&&this.colorBoostEvents.every(i=>i.isValid())&&this.lightColorEventBoxGroups.every(i=>i.isValid())&&this.lightRotationEventBoxGroups.every(i=>i.isValid())&&this.lightTranslationEventBoxGroups.every(i=>i.isValid())&&this.fxEventBoxGroups.every(i=>i.isValid())&&this.basicEventTypesWithKeywords.list.every(i=>i.isValid())}sort(){this.waypoints.sort(xt),this.basicEvents.sort(xt),this.colorBoostEvents.sort(xt),this.lightColorEventBoxGroups.sort(xt),this.lightRotationEventBoxGroups.sort(xt),this.lightTranslationEventBoxGroups.sort(xt),this.fxEventBoxGroups.sort(xt);for(let e=0;e<this.lightColorEventBoxGroups.length;e++)for(let n=0;n<this.lightColorEventBoxGroups[e].boxes.length;n++)this.lightColorEventBoxGroups[e].boxes[n].events.sort(xt);for(let e=0;e<this.lightRotationEventBoxGroups.length;e++)for(let n=0;n<this.lightRotationEventBoxGroups[e].boxes.length;n++)this.lightRotationEventBoxGroups[e].boxes[n].events.sort(xt);for(let e=0;e<this.lightTranslationEventBoxGroups.length;e++)for(let n=0;n<this.lightTranslationEventBoxGroups[e].boxes.length;n++)this.lightTranslationEventBoxGroups[e].boxes[n].events.sort(xt);for(let e=0;e<this.fxEventBoxGroups.length;e++)for(let n=0;n<this.fxEventBoxGroups[e].boxes.length;n++)this.fxEventBoxGroups[e].boxes[n].events.sort(xt);return this}addWaypoints(...e){for(const n of e)this.waypoints.push(new Re(n));return this}addBasicEvents(...e){for(const n of e)this.basicEvents.push(new Me(n));return this}addColorBoostEvents(...e){for(const n of e)this.colorBoostEvents.push(new En(n));return this}addLightColorEventBoxGroups(...e){for(const n of e)this.lightColorEventBoxGroups.push(new Ze(n));return this}addLightRotationEventBoxGroups(...e){for(const n of e)this.lightRotationEventBoxGroups.push(new Je(n));return this}addLightTranslationEventBoxGroups(...e){for(const n of e)this.lightTranslationEventBoxGroups.push(new Qe(n));return this}addFxEventBoxGroups(...e){for(const n of e)this.fxEventBoxGroups.push(new tn(n));return this}}Object.defineProperty(ce,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{waypoints:[],basicEvents:[],colorBoostEvents:[],lightColorEventBoxGroups:[],lightRotationEventBoxGroups:[],lightTranslationEventBoxGroups:[],fxEventBoxGroups:[],basicEventTypesWithKeywords:{list:[]},useNormalEventsAsCompatibleEvents:!1,customData:{}}});class xe extends Oe{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){super(),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"difficulty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lightshow",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filename",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lightshowFilename",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.version=e.version??xe.defaultValue.version,this.filename=e.filename??xe.defaultValue.filename,this.lightshowFilename=e.lightshowFilename??xe.defaultValue.lightshowFilename,this.difficulty=new ye(e.difficulty??xe.defaultValue.difficulty),this.lightshow=new ce(e.lightshow??xe.defaultValue.lightshow)}isValid(e,n){return super.isValid(e)}get bpmEvents(){return this.difficulty.bpmEvents}set bpmEvents(e){this.difficulty.bpmEvents=e}get rotationEvents(){return this.difficulty.rotationEvents}set rotationEvents(e){this.difficulty.rotationEvents=e}get colorNotes(){return this.difficulty.colorNotes}set colorNotes(e){this.difficulty.colorNotes=e}get bombNotes(){return this.difficulty.bombNotes}set bombNotes(e){this.difficulty.bombNotes=e}get obstacles(){return this.difficulty.obstacles}set obstacles(e){this.difficulty.obstacles=e}get arcs(){return this.difficulty.arcs}set arcs(e){this.difficulty.arcs=e}get chains(){return this.difficulty.chains}set chains(e){this.difficulty.chains=e}get waypoints(){return this.lightshow.waypoints}set waypoints(e){this.lightshow.waypoints=e}get basicEvents(){return this.lightshow.basicEvents}set basicEvents(e){this.lightshow.basicEvents=e}get colorBoostEvents(){return this.lightshow.colorBoostEvents}set colorBoostEvents(e){this.lightshow.colorBoostEvents=e}get lightColorEventBoxGroups(){return this.lightshow.lightColorEventBoxGroups}set lightColorEventBoxGroups(e){this.lightshow.lightColorEventBoxGroups=e}get lightRotationEventBoxGroups(){return this.lightshow.lightRotationEventBoxGroups}set lightRotationEventBoxGroups(e){this.lightshow.lightRotationEventBoxGroups=e}get lightTranslationEventBoxGroups(){return this.lightshow.lightTranslationEventBoxGroups}set lightTranslationEventBoxGroups(e){this.lightshow.lightTranslationEventBoxGroups=e}get fxEventBoxGroups(){return this.lightshow.fxEventBoxGroups}set fxEventBoxGroups(e){this.lightshow.fxEventBoxGroups=e}get basicEventTypesWithKeywords(){return this.lightshow.basicEventTypesWithKeywords}set basicEventTypesWithKeywords(e){this.lightshow.basicEventTypesWithKeywords=e}get useNormalEventsAsCompatibleEvents(){return this.lightshow.useNormalEventsAsCompatibleEvents}set useNormalEventsAsCompatibleEvents(e){this.lightshow.useNormalEventsAsCompatibleEvents=e}setFilename(e){return this.filename=e,this}setLightshowFilename(e){return this.lightshowFilename=e,this}setVersion(e){return this.version=e,this}sort(e){return this.difficulty.sort(),this.lightshow.sort(),super.sort(e)}addBpmEvents(...e){return this.difficulty.addBpmEvents(...e),this}addRotationEvents(...e){return this.difficulty.addRotationEvents(...e),this}addColorNotes(...e){return this.difficulty.addColorNotes(...e),this}addBombNotes(...e){return this.difficulty.addBombNotes(...e),this}addObstacles(...e){return this.difficulty.addObstacles(...e),this}addArcs(...e){return this.difficulty.addArcs(...e),this}addChains(...e){return this.difficulty.addChains(...e),this}addWaypoints(...e){return this.lightshow.addWaypoints(...e),this}addBasicEvents(...e){return this.lightshow.addBasicEvents(...e),this}addColorBoostEvents(...e){return this.lightshow.addColorBoostEvents(...e),this}addLightColorEventBoxGroups(...e){return this.lightshow.addLightColorEventBoxGroups(...e),this}addLightRotationEventBoxGroups(...e){return this.lightshow.addLightRotationEventBoxGroups(...e),this}addLightTranslationEventBoxGroups(...e){return this.lightshow.addLightTranslationEventBoxGroups(...e),this}addFxEventBoxGroups(...e){return this.lightshow.addFxEventBoxGroups(...e),this}}Object.defineProperty(xe,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{version:-1,filename:"Unnamed.beatmap.dat",lightshowFilename:"Unnamed.lightshow.dat",customData:{},difficulty:{bpmEvents:[],rotationEvents:[],colorNotes:[],bombNotes:[],obstacles:[],arcs:[],chains:[],customData:{}},lightshow:{waypoints:[],basicEvents:[],colorBoostEvents:[],lightColorEventBoxGroups:[],lightRotationEventBoxGroups:[],lightTranslationEventBoxGroups:[],fxEventBoxGroups:[],basicEventTypesWithKeywords:{list:[]},useNormalEventsAsCompatibleEvents:!1,customData:{}}}});const us={Standard:"Standard",NoArrows:"No Arrows",OneSaber:"One Saber",Legacy:"Legacy","360Degree":"360 Degree","90Degree":"90 Degree",Lightshow:"Lightshow",Lawless:"Lawless"},cs={Standard:0,NoArrows:1,OneSaber:2,Legacy:3,"360Degree":4,"90Degree":5,Lightshow:6,Lawless:7},Pi={Easy:1,Normal:3,Hard:5,Expert:7,ExpertPlus:9,"Expert+":9},en={Easy:"Easy",Normal:"Normal",Hard:"Hard",Expert:"Expert",ExpertPlus:"Expert+","Expert+":"Expert+"};class Ut extends Oe{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){var n,i;super(),Object.defineProperty(this,"characteristic",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"difficulty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filename",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lightshowFilename",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"authors",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"njs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"njsOffset",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"colorSchemeId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"environmentId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.characteristic=e.characteristic??Ut.defaultValue.characteristic,this.difficulty=e.difficulty??Ut.defaultValue.difficulty,this.filename=e.filename??Ut.defaultValue.filename,this.lightshowFilename=e.lightshowFilename??Ut.defaultValue.lightshowFilename,this.authors={mappers:(((n=e.authors)==null?void 0:n.mappers)??Ut.defaultValue.authors.mappers).map(o=>o),lighters:(((i=e.authors)==null?void 0:i.lighters)??Ut.defaultValue.authors.lighters).map(o=>o)},this.njs=e.njs??Ut.defaultValue.njs,this.njsOffset=e.njsOffset??Ut.defaultValue.njsOffset,this.colorSchemeId=e.colorSchemeId??Ut.defaultValue.colorSchemeId,this.environmentId=e.environmentId??Ut.defaultValue.environmentId,this.customData=N(e.customData??Ut.defaultValue.customData)}isValid(e,n){return n?super.isValid(e,n):super.isValid(e,n)&&this.njs>0&&this.colorSchemeId>=-1&&this.environmentId>=0}}Object.defineProperty(Ut,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{characteristic:"Standard",difficulty:"Easy",filename:"Unnamed.beatmap.dat",lightshowFilename:"Unnamed.lightshow.dat",authors:{mappers:[],lighters:[]},njs:10,njsOffset:0,colorSchemeId:-1,environmentId:0,customData:{}}});class St extends Oe{static createOne(e={}){return new this(e)}static create(...e){return e.length?e.map(n=>new this(n)):[new this]}constructor(e={}){var n,i,o,r,l,s,a,u,c,p,v,m,h,d,y;super(),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filename",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"song",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"audio",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"songPreviewFilename",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"coverImageFilename",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"environmentBase",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"environmentNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"colorSchemes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"difficulties",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.version=e.version??St.defaultValue.version,this.filename=e.filename??St.defaultValue.filename,this.song={title:((n=e.song)==null?void 0:n.title)??St.defaultValue.song.title,subTitle:((i=e.song)==null?void 0:i.subTitle)??St.defaultValue.song.subTitle,author:((o=e.song)==null?void 0:o.author)??St.defaultValue.song.author},this.audio={filename:((r=e.audio)==null?void 0:r.filename)??St.defaultValue.audio.filename,duration:((l=e.audio)==null?void 0:l.duration)??St.defaultValue.audio.duration,audioDataFilename:((s=e.audio)==null?void 0:s.audioDataFilename)??St.defaultValue.audio.audioDataFilename,bpm:((a=e.audio)==null?void 0:a.bpm)??St.defaultValue.audio.bpm,lufs:((u=e.audio)==null?void 0:u.lufs)??St.defaultValue.audio.lufs,previewStartTime:((c=e.audio)==null?void 0:c.previewStartTime)??St.defaultValue.audio.previewStartTime,previewDuration:((p=e.audio)==null?void 0:p.previewDuration)??St.defaultValue.audio.previewDuration,audioOffset:((v=e.audio)==null?void 0:v.audioOffset)??St.defaultValue.audio.audioOffset,shuffle:((m=e.audio)==null?void 0:m.shuffle)??St.defaultValue.audio.shuffle,shufflePeriod:((h=e.audio)==null?void 0:h.shufflePeriod)??St.defaultValue.audio.shufflePeriod},this.songPreviewFilename=e.songPreviewFilename??St.defaultValue.songPreviewFilename,this.coverImageFilename=e.coverImageFilename??St.defaultValue.coverImageFilename,this.environmentBase={normal:((d=e.environmentBase)==null?void 0:d.normal)??St.defaultValue.environmentBase.normal,allDirections:((y=e.environmentBase)==null?void 0:y.allDirections)??St.defaultValue.environmentBase.allDirections},this.environmentNames=(e.environmentNames??St.defaultValue.environmentNames).map(g=>g),this.colorSchemes=(e.colorSchemes??St.defaultValue.colorSchemes).map(g=>{var D,C,k,P,A,V,x,W,et,S,$,b,j,st,H,ct,Y,rt,I,R,nt,J,K,yt,Lt,ht,gt,kt,Et,zt,$t,f,F,O,w,E;const _={useOverride:g.useOverride||!1,name:g.name||"",saberLeftColor:{r:((D=g.saberLeftColor)==null?void 0:D.r)||0,g:((C=g.saberLeftColor)==null?void 0:C.g)||0,b:((k=g.saberLeftColor)==null?void 0:k.b)||0,a:((P=g.saberLeftColor)==null?void 0:P.a)||0},saberRightColor:{r:((A=g.saberRightColor)==null?void 0:A.r)||0,g:((V=g.saberRightColor)==null?void 0:V.g)||0,b:((x=g.saberRightColor)==null?void 0:x.b)||0,a:((W=g.saberRightColor)==null?void 0:W.a)||0},environment0Color:{r:((et=g.environment0Color)==null?void 0:et.r)||0,g:((S=g.environment0Color)==null?void 0:S.g)||0,b:(($=g.environment0Color)==null?void 0:$.b)||0,a:((b=g.environment0Color)==null?void 0:b.a)||0},environment1Color:{r:((j=g.environment1Color)==null?void 0:j.r)||0,g:((st=g.environment1Color)==null?void 0:st.g)||0,b:((H=g.environment1Color)==null?void 0:H.b)||0,a:((ct=g.environment1Color)==null?void 0:ct.a)||0},environment0ColorBoost:{r:((Y=g.environment0ColorBoost)==null?void 0:Y.r)||0,g:((rt=g.environment0ColorBoost)==null?void 0:rt.g)||0,b:((I=g.environment0ColorBoost)==null?void 0:I.b)||0,a:((R=g.environment0ColorBoost)==null?void 0:R.a)||0},environment1ColorBoost:{r:((nt=g.environment1ColorBoost)==null?void 0:nt.r)||0,g:((J=g.environment1ColorBoost)==null?void 0:J.g)||0,b:((K=g.environment1ColorBoost)==null?void 0:K.b)||0,a:((yt=g.environment1ColorBoost)==null?void 0:yt.a)||0},obstaclesColor:{r:((Lt=g.obstaclesColor)==null?void 0:Lt.r)||0,g:((ht=g.obstaclesColor)==null?void 0:ht.g)||0,b:((gt=g.obstaclesColor)==null?void 0:gt.b)||0,a:((kt=g.obstaclesColor)==null?void 0:kt.a)||0}};return g.environmentWColor&&(_.environmentWColor={r:((Et=g.environmentWColor)==null?void 0:Et.r)||0,g:((zt=g.environmentWColor)==null?void 0:zt.g)||0,b:(($t=g.environmentWColor)==null?void 0:$t.b)||0,a:((f=g.environmentWColor)==null?void 0:f.a)||0}),g.environmentWColorBoost&&(_.environmentWColorBoost={r:((F=g.environmentWColorBoost)==null?void 0:F.r)||0,g:((O=g.environmentWColorBoost)==null?void 0:O.g)||0,b:((w=g.environmentWColorBoost)==null?void 0:w.b)||0,a:((E=g.environmentWColorBoost)==null?void 0:E.a)||0}),_}),this.difficulties=(e.difficulties??St.defaultValue.difficulties).map(g=>new Ut(g)),this.customData=N(e.customData??St.defaultValue.customData)}isValid(e,n){return n?super.isValid(e,n):super.isValid(e,n)&&this.audio.filename!==""&&this.audio.duration>0&&this.audio.previewDuration>0&&this.audio.previewStartTime>0&&this.audio.audioOffset>=0&&this.difficulties.every(i=>i.isValid())}clone(){return super.clone().setFilename(this.filename)}setFilename(e){return this.filename=e,this}setVersion(e){return this.version=e,this}sort(){return this.difficulties.sort((e,n)=>Pi[e.difficulty]-Pi[n.difficulty]).sort((e,n)=>(cs[e.characteristic]||0)-(cs[n.characteristic]||0)),this}addMap(e){return this.difficulties.push(new Ut(e)),this}}Object.defineProperty(St,"defaultValue",{enumerable:!0,configurable:!0,writable:!0,value:{version:-1,filename:"Info.dat",song:{title:"Untitled",subTitle:"",author:"NoAuthor"},audio:{filename:"",duration:0,audioDataFilename:"",bpm:0,lufs:0,previewStartTime:0,previewDuration:0,audioOffset:0,shuffle:0,shufflePeriod:.5},songPreviewFilename:"",coverImageFilename:"",environmentBase:{normal:null,allDirections:null},environmentNames:[],colorSchemes:[],difficulties:[],customData:{}}});function cp(t){return Array.isArray(t.customData._color)||typeof t.customData._lightID=="number"||Array.isArray(t.customData._lightID)||typeof t.customData._propID=="number"||typeof t.customData._lightGradient=="object"||typeof t.customData._easing=="string"||typeof t.customData._lerpType=="string"||typeof t.customData._nameFilter=="string"||typeof t.customData._reset=="boolean"||typeof t.customData._rotation=="number"||typeof t.customData._step=="number"||typeof t.customData._prop=="number"||typeof t.customData._speed=="number"||typeof t.customData._direction=="number"||typeof t.customData._counterSpin=="boolean"||typeof t.customData._stepMult=="number"||typeof t.customData._propMult=="number"||typeof t.customData._speedMult=="number"||typeof t.customData._lockPosition=="boolean"||typeof t.customData._speed=="number"||typeof t.customData._preciseSpeed=="number"||typeof t.customData._direction=="number"}function wl(t){return Array.isArray(t.customData._color)||typeof t.customData._disableSpawnEffect=="boolean"}function Dl(t){return Array.isArray(t.customData._animation)||typeof t.customData._cutDirection=="number"||typeof t.customData._disableNoteGravity=="boolean"||typeof t.customData._disableNoteLook=="boolean"||typeof t.customData._fake=="boolean"||Array.isArray(t.customData._flip)||typeof t.customData._interactable=="boolean"||Array.isArray(t.customData._localRotation)||typeof t.customData._noteJumpMovementSpeed=="number"||typeof t.customData._noteJumpStartBeatOffset=="number"||Array.isArray(t.customData._position)||Array.isArray(t.customData._rotation)}function mp(t){return Array.isArray(t.customData._color)}function hp(t){return Array.isArray(t.customData._animation)||typeof t.customData._fake=="boolean"||typeof t.customData._interactable=="boolean"||Array.isArray(t.customData._localRotation)||typeof t.customData._noteJumpMovementSpeed=="number"||typeof t.customData._noteJumpStartBeatOffset=="number"||Array.isArray(t.customData._position)||Array.isArray(t.customData._rotation)||Array.isArray(t.customData._scale)}function Sl(t){return t.posX<0||t.posX>3||t.width<0||t.width>4||t.posY<0||t.posY>2||t.posY===1||t.posY===0&&t.height!==5||t.posY===2&&t.height!==3}function fp(t){return Array.isArray(t.customData.color)||typeof t.customData.lightID=="number"||Array.isArray(t.customData.lightID)||typeof t.customData.easing=="string"||typeof t.customData.lerpType=="string"||typeof t.customData.nameFilter=="string"||typeof t.customData.rotation=="number"||typeof t.customData.step=="number"||typeof t.customData.prop=="number"||typeof t.customData.speed=="number"||typeof t.customData.direction=="number"||typeof t.customData.lockRotation=="boolean"||typeof t.customData.speed=="number"||typeof t.customData.direction=="number"}function Cl(t){return Array.isArray(t.customData.color)||typeof t.customData.spawnEffect=="boolean"||typeof t.customData.disableDebris=="boolean"}function kl(t){return Array.isArray(t.customData.animation)||typeof t.customData.disableNoteGravity=="boolean"||typeof t.customData.disableNoteLook=="boolean"||typeof t.customData.disableBadCutDirection=="boolean"||typeof t.customData.disableBadCutSaberType=="boolean"||typeof t.customData.disableBadCutSpeed=="boolean"||Array.isArray(t.customData.flip)||typeof t.customData.uninteractable=="boolean"||Array.isArray(t.customData.localRotation)||typeof t.customData.noteJumpMovementSpeed=="number"||typeof t.customData.noteJumpStartBeatOffset=="number"||Array.isArray(t.customData.coordinates)||Array.isArray(t.customData.worldRotation)||typeof t.customData.worldRotation=="number"||typeof t.customData.link=="string"}function pp(t){return Array.isArray(t.customData.color)}function dp(t){return Array.isArray(t.customData.animation)||typeof t.customData.uninteractable=="boolean"||Array.isArray(t.customData.localRotation)||typeof t.customData.noteJumpMovementSpeed=="number"||typeof t.customData.noteJumpStartBeatOffset=="number"||Array.isArray(t.customData.coordinates)||Array.isArray(t.customData.worldRotation)||Array.isArray(t.customData.size)}function Tl(t){return t.posY<0||t.posY>2||t.posX<=-1e3||t.posX>=1e3||t.width<=-1e3||t.width>=1e3||t.height<=-1e3||t.height>=1e3}function bp(t){return t.posY>2||t.posY<0||t.posX<=-1e3||t.posX>=1e3||t.direction>=1e3&&t.direction<=1360||t.tailDirection>=1e3&&t.tailDirection<=1360}function Ll(t){return t.posX>3||t.posX<0||t.posY>2||t.posY<0}function gp(t){return t.posY>2||t.posY<0||t.posX<=-1e3||t.posX>=1e3||t.direction>=1e3&&t.direction<=1360}function Rl(t){return t.posX>3||t.posX<0||t.posY>2||t.posY<0||t.direction>=1e3&&t.direction<=1360||t.direction>=2e3&&t.direction<=2360}function ms(t,e){const n=t.difficulty.colorNotes;return e?n.length/e:0}function Bo(t,e,n){let i=0,o=0;const r=t.difficulty.colorNotes;for(let l=0;l<r.length;l++){for(;r[l].time-r[o].time>e;)o++;i=Math.max(i,(l-o+1)/n.toRealTime(e))}return i}function yr(t){const e=[...t.difficulty.colorNotes,...t.difficulty.bombNotes,...t.difficulty.chains].sort(An);let n=Number.MAX_VALUE;e.length>0&&(n=e[0].time);const i=vp(t);return Math.min(n,i)}function ti(t){const e=[...t.difficulty.colorNotes,...t.difficulty.bombNotes,...t.difficulty.chains].sort(An);let n=0;e.length>0&&(n=e[e.length-1].time);const i=_p(t);return Math.max(n,i)}function vp(t){for(let e=0,n=t.obstacles.length;e<n;e++)if(t.obstacles[e].isInteractive())return t.obstacles[e].time;return Number.MAX_VALUE}function _p(t){let e=0;for(let n=t.difficulty.obstacles.length-1;n>=0;n--)t.difficulty.obstacles[n].isInteractive()&&(e=Math.max(e,t.difficulty.obstacles[n].time+t.difficulty.obstacles[n].duration));return e}class he{constructor(e,n=10,i=0){Object.defineProperty(this,"bpm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"offset",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bpm=e,this.value=n,this.offset=i}static create(e,n,i){return new he(e,n,i)}get hjd(){return this.calcHjd()}get jd(){return this.calcJd()}get reactionTime(){return this.calcRtFromHjd()}calcHjd(e=this.offset){const i=60/this.bpm;let o=he.HJD_START;for(;this.value*i*o>17.999;)o/=2;return o<1&&(o=1),Math.max(o+e,he.HJD_MIN)}calcHjdFromJd(e=this.calcJd()){return e/(60/this.bpm*this.value*2)}calcHjdFromRt(e=this.calcRtFromHjd()){return e/(60/this.bpm)}calcJd(e=this.calcHjd()){return this.value*(60/this.bpm)*e*2}calcJdOptimal(){return[-(18/(this.value+1))+18,18*(1/1.07)**this.value+18]}calcRtFromJd(e=this.calcJd()){return e/(2*this.value)}calcRtFromHjd(e=this.calcHjd()){return 60/this.bpm*e}calcDistance(e){return this.value*60/this.bpm*e*2}}Object.defineProperty(he,"HJD_START",{enumerable:!0,configurable:!0,writable:!0,value:4});Object.defineProperty(he,"HJD_MIN",{enumerable:!0,configurable:!0,writable:!0,value:.25});Object.defineProperty(he,"FallbackNJS",{enumerable:!0,configurable:!0,writable:!0,value:{"Expert+":16,ExpertPlus:16,Expert:12,Hard:10,Normal:10,Easy:10}});var me;(function(t){t[t.NONE=0]="NONE",t[t.NORMAL=1]="NORMAL",t[t.ARC_HEAD=2]="ARC_HEAD",t[t.ARC_TAIL=3]="ARC_TAIL",t[t.CHAIN_HEAD=4]="CHAIN_HEAD",t[t.CHAIN_ELEMENT=5]="CHAIN_ELEMENT"})(me||(me={}));const yp={[me.NONE]:0,[me.NORMAL]:115,[me.ARC_HEAD]:115,[me.ARC_TAIL]:115,[me.CHAIN_HEAD]:85,[me.CHAIN_ELEMENT]:20};function Ep(t){let e=0,n=1;const i=wp(t);for(let o=0;o<i.length;o++)n<8&&o===-3+n*4&&(n*=2),e+=yp[i[o].type]*n;return e}function wp(t){return[Dp(t),Sp(t.difficulty.chains)].flat().sort((e,n)=>e.time-n.time)}function Dp(t){const e=new Map,n=new Map,i=new Map;for(let o=0;o<t.difficulty.arcs.length;o++){const r=t.difficulty.arcs[o];e.has(r.time)||e.set(r.time,[]),n.has(r.tailTime)||n.set(r.tailTime,[]),e.get(r.time).push(r),n.get(r.tailTime).push(r)}for(let o=0;o<t.difficulty.chains.length;o++){const r=t.difficulty.chains[o];i.has(r.time)||i.set(r.time,[]),i.get(r.time).push(r)}return t.difficulty.colorNotes.map(o=>{var s,a,u;return((s=e.get(o.time))==null?void 0:s.some(c=>c.color===o.color&&c.tailPosX===o.posX&&c.tailPosY===o.posY))||((a=n.get(o.time))==null?void 0:a.some(c=>c.color===o.color&&c.tailPosX===o.posX&&c.tailPosY===o.posY))?{type:me.ARC_HEAD,time:o.time}:((u=i.get(o.time))==null?void 0:u.some(c=>c.color===o.color&&c.posX===o.posX&&c.posY===o.posY))?{type:me.CHAIN_HEAD,time:o.time}:{type:me.NORMAL,time:o.time}})}function Sp(t){return t.flatMap(e=>e.sliceCount>1?Array(e.sliceCount-1).map((n,i)=>({type:me.CHAIN_ELEMENT,time:Ai(Df(i+1,0,e.sliceCount),e.time,e.tailTime)})):[])}function Cp(t){return["helpers","timeProcessor",t]}class $i{constructor(e,n=[],i=0){Object.defineProperty(this,"bpm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_bpmChange",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_timeScale",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_offset",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bpm=e,this._offset=i/1e3,this._timeScale=this.getTimeScale(n.filter(o=>("m"in o||"bpm"in o||"timescale"in o)&&!("o"in o))),this._bpmChange=this.getBpmChangeTime(n.filter(o=>"BPM"in o&&"metronomeOffset"in o||("_bpm"in o||"_BPM"in o)&&"_metronomeOffset"in o||"m"in o&&"o"in o)),this._timeScale.length&&this._bpmChange.length&&Z.tWarn(Cp("constructor"),"BPM change and BPM event should not be used along side together to avoid confusion between editors and in-game behaviour")}get change(){return this._bpmChange}set change(e){this._bpmChange=this.getBpmChangeTime(e)}get timescale(){return this._timeScale}set timescale(e){this._timeScale=this.getTimeScale(e)}get offset(){return this._offset*1e3}set offset(e){this._offset=e/1e3}getBpmChangeTime(e=[]){let n;const i=[];e=[...e].sort((o,r)=>(o.time??o._time??o.b)-(r.time??r._time??r.b));for(let o=0;o<e.length;o++){const r={time:e[o].time??e[o]._time??e[o].b,BPM:e[o].BPM??e[o]._BPM??e[o]._bpm??e[o].m,beatsPerBar:e[o].beatsPerBar??e[o]._beatsPerBar??e[o].p,metronomeOffset:e[o].metronomeOffset??e[o]._metronomeOffset??e[o].o,newTime:0};n?r.newTime=Math.ceil((r.time-n.time)/this.bpm*n.BPM+n.newTime-.01):r.newTime=Math.ceil(r.time-this._offset*this.bpm/60-.01),i.push(r),n=r}return i}getTimeScale(e=[]){return[...e].sort((n,i)=>(n.time??n.b)-(i.time??i.b)).map(n=>"scale"in n?n:"bpm"in n?{time:n.time,scale:this.bpm/n.bpm}:{time:n.b||0,scale:this.bpm/n.m})}offsetBegone(e){return this._offset===0?e:this.toBeatTime(this.toRealTime(e,!1)-this._offset)}toRealTime(e,n=!0){if(!n)return e/this.bpm*60;let i=0;for(let o=this._timeScale.length-1;o>=0;o--)e>this._timeScale[o].time&&(i+=(e-this._timeScale[o].time)*this._timeScale[o].scale,e=this._timeScale[o].time);return(e+i)/this.bpm*60}toBeatTime(e,n=!0){if(!n)return e*this.bpm/60;let i=0;for(let o=this._timeScale.length-1;o>=0;o--){const r=this.toRealTime(this._timeScale[o].time,n);e>r&&(i+=(e-r)/this._timeScale[o].scale,e=r)}return this.toBeatTime(e+i,!1)}toJsonTime(e){for(let n=this._bpmChange.length-1;n>=0;n--)if(e>this._bpmChange[n].newTime)return(e-this._bpmChange[n].newTime)/this._bpmChange[n].BPM*this.bpm+this._bpmChange[n].time;return this.toBeatTime(this.toRealTime(e,!1)+this._offset)}adjustTime(e){for(let n=this._bpmChange.length-1;n>=0;n--)if(e>this._bpmChange[n].time)return(e-this._bpmChange[n].time)/this.bpm*this._bpmChange[n].BPM+this._bpmChange[n].newTime;return this.offsetBegone(e)}}Object.defineProperty($i,"create",{enumerable:!0,configurable:!0,writable:!0,value:(t,e,n)=>new $i(t,e,n)});function Bl(t){switch(t){case"info":case"difficulty":return"2.0.0";case"lightshow":return"3.0.0";default:return"4.0.0"}}function xl(t){const e=t._version??t.version;return typeof e!="string"?null:e}function Il(t,e){const n=hs(t),i=hs(e);for(const o in n){if(n[o]<i[o])return-1;if(n[o]>i[o])return 1}return 0}function hs(t){return t.split(".").map(e=>parseInt(e))}const kp={1:Kf,2:ep,4:up},Tp={2:Zf,4:sp},fs={1:Yf,2:Qf,3:El,4:lp},ps={serialize(t){return{difficulty:t.difficulty,difficultyRank:Pi[t.difficulty],audioPath:"",jsonPath:t.filename,characteristic:t.characteristic,offset:t.customData._editorOffset,oldOffset:t.customData._editorOldOffset,chromaToggle:t.customData._chromaToggle,customColors:t.customData._customColors,difficultyLabel:t.customData._difficultyLabel,colorLeft:Nt(t.customData._colorLeft),colorRight:Nt(t.customData._colorRight),envColorLeft:Nt(t.customData._envColorLeft),envColorRight:Nt(t.customData._envColorRight),obstacleColor:Nt(t.customData._obstacleColor)}},deserialize(t={}){return{difficulty:t.difficulty,filename:t.jsonPath,njs:0,njsOffset:0,characteristic:t.characteristic,customData:{_editorOffset:t.offset,_editorOldOffset:t.oldOffset,_chromaToggle:t.chromaToggle,_customColors:t.customColors,_difficultyLabel:t.difficultyLabel,_colorLeft:Nt(t.colorLeft),_colorRight:Nt(t.colorRight),_envColorLeft:Nt(t.envColorLeft),_envColorRight:Nt(t.envColorRight),_obstacleColor:Nt(t.obstacleColor)}}}},Lp={serialize(t){return{songName:t.song.title,songSubName:t.song.subTitle,authorName:t.song.author,beatsPerMinute:t.audio.bpm,previewStartTime:t.audio.previewStartTime,previewDuration:t.audio.previewDuration,coverImagePath:t.coverImageFilename,environmentName:t.environmentBase.normal||t.environmentNames.find(e=>!Mn(e))||"DefaultEnvironment",difficultyLevels:t.difficulties.map(ps.serialize),oneSaber:t.difficulties.some(e=>e.characteristic==="OneSaber"),contributors:N(t.customData._contributors),customEnvironment:t.customData._customEnvironment,customEnvironmentHash:t.customData._customEnvironmentHash}},deserialize(t={}){var e,n,i,o,r;return{version:1,song:{title:t.songName,subTitle:t.songSubName,author:t.authorName},audio:{filename:(n=(e=t.difficultyLevels)==null?void 0:e.find(l=>l==null?void 0:l.audioPath))==null?void 0:n.audioPath,bpm:t.beatsPerMinute,previewStartTime:t.previewStartTime,previewDuration:t.previewDuration},songPreviewFilename:(o=(i=t.difficultyLevels)==null?void 0:i.find(l=>l==null?void 0:l.audioPath))==null?void 0:o.audioPath,coverImageFilename:t.coverImagePath,environmentBase:{normal:t.environmentName},difficulties:(r=t.difficultyLevels)==null?void 0:r.map(ps.deserialize),customData:{_contributors:t.contributors,_customEnvironment:t.customEnvironment,_customEnvironmentHash:t.customEnvironmentHash}}}},ds={serialize(t){return{_difficulty:t.difficulty,_difficultyRank:Pi[t.difficulty],_beatmapFilename:t.filename,_noteJumpMovementSpeed:t.njs,_noteJumpStartBeatOffset:t.njsOffset,_beatmapColorSchemeIdx:t.colorSchemeId,_environmentNameIdx:t.environmentId,_customData:N(t.customData)}},deserialize(t={}){return{difficulty:t._difficulty,filename:t._beatmapFilename,njs:t._noteJumpMovementSpeed,njsOffset:t._noteJumpStartBeatOffset,colorSchemeId:t._beatmapColorSchemeIdx,environmentId:t._environmentNameIdx,customData:t._customData}}},Rp={serialize(t){const e=new Set,n={_version:"2.1.0",_songName:t.song.title,_songSubName:t.song.subTitle,_songAuthorName:t.song.author,_levelAuthorName:"",_beatsPerMinute:t.audio.bpm,_songTimeOffset:t.audio.audioOffset,_shuffle:t.audio.shuffle,_shufflePeriod:t.audio.shufflePeriod,_previewStartTime:t.audio.previewStartTime,_previewDuration:t.audio.previewDuration,_songFilename:t.audio.filename,_coverImageFilename:t.coverImageFilename,_environmentName:t.environmentBase.normal||t.environmentNames.find(i=>!Mn(i))||"DefaultEnvironment",_allDirectionsEnvironmentName:t.environmentBase.allDirections||t.environmentNames.find(i=>Mn(i))||"GlassDesertEnvironment",_environmentNames:t.environmentNames.map(i=>i),_colorSchemes:t.colorSchemes.map(i=>{const o={useOverride:i.useOverride,colorScheme:{colorSchemeId:i.name,saberAColor:Nt(i.saberLeftColor),saberBColor:Nt(i.saberRightColor),environmentColor0:Nt(i.environment0Color),environmentColor1:Nt(i.environment1Color),obstaclesColor:Nt(i.obstaclesColor),environmentColor0Boost:Nt(i.environment0ColorBoost),environmentColor1Boost:Nt(i.environment1ColorBoost)}};return i.environmentWColor&&(o.colorScheme.environmentColorW=Nt(i.environmentWColor)),i.environmentWColorBoost&&(o.colorScheme.environmentColorWBoost=Nt(i.environmentWColorBoost)),o}),_customData:N(t.customData),_difficultyBeatmapSets:t.difficulties.reduce((i,o)=>{let r=i.find(l=>l._beatmapCharacteristicName===o.characteristic);return r||(r={_beatmapCharacteristicName:o.characteristic,_difficultyBeatmaps:[]},i.push(r)),o.authors.mappers.forEach(l=>e.add(l)),o.authors.lighters.forEach(l=>e.add(l)),r._difficultyBeatmaps.push(ds.serialize(o)),i},[])};return n._levelAuthorName=[...e].join(", "),n},deserialize(t={}){var n,i,o;return{version:2,song:{title:t._songName,subTitle:t._songSubName,author:t._songAuthorName},audio:{bpm:t._beatsPerMinute,previewStartTime:t._previewStartTime,previewDuration:t._previewDuration,filename:t._songFilename,audioOffset:t._songTimeOffset,shuffle:t._shuffle,shufflePeriod:t._shufflePeriod},songPreviewFilename:t._songFilename,coverImageFilename:t._coverImageFilename,environmentBase:{normal:t._environmentName,allDirections:t._allDirectionsEnvironmentName},environmentNames:(n=t._environmentNames)==null?void 0:n.map(r=>r),colorSchemes:(i=t._colorSchemes)==null?void 0:i.map(r=>{var s,a,u,c,p,v,m,h,d,y,g,_,D,C,k,P,A,V,x,W,et,S,$,b,j,st,H,ct,Y,rt,I,R,nt,J,K,yt,Lt,ht,gt,kt,Et,zt,$t,f,F,O,w,E,T,z,G,L,X,Q,q,it,_t,bt,Ht,ze,Zt,Ve,Tt,mn,kn,ie,Un,ui,ci,mi,Wn,Ge,hn,Gr,Hr;const l={useOverride:!!r.useOverride,name:(s=r.colorScheme)==null?void 0:s.colorSchemeId,saberLeftColor:{r:(u=(a=r.colorScheme)==null?void 0:a.saberAColor)==null?void 0:u.r,g:(p=(c=r.colorScheme)==null?void 0:c.saberAColor)==null?void 0:p.g,b:(m=(v=r.colorScheme)==null?void 0:v.saberAColor)==null?void 0:m.b,a:(d=(h=r.colorScheme)==null?void 0:h.saberAColor)==null?void 0:d.a},saberRightColor:{r:(g=(y=r.colorScheme)==null?void 0:y.saberBColor)==null?void 0:g.r,g:(D=(_=r.colorScheme)==null?void 0:_.saberBColor)==null?void 0:D.g,b:(k=(C=r.colorScheme)==null?void 0:C.saberBColor)==null?void 0:k.b,a:(A=(P=r.colorScheme)==null?void 0:P.saberBColor)==null?void 0:A.a},environment0Color:{r:(x=(V=r.colorScheme)==null?void 0:V.environmentColor0)==null?void 0:x.r,g:(et=(W=r.colorScheme)==null?void 0:W.environmentColor0)==null?void 0:et.g,b:($=(S=r.colorScheme)==null?void 0:S.environmentColor0)==null?void 0:$.b,a:(j=(b=r.colorScheme)==null?void 0:b.environmentColor0)==null?void 0:j.a},environment1Color:{r:(H=(st=r.colorScheme)==null?void 0:st.environmentColor1)==null?void 0:H.r,g:(Y=(ct=r.colorScheme)==null?void 0:ct.environmentColor1)==null?void 0:Y.g,b:(I=(rt=r.colorScheme)==null?void 0:rt.environmentColor1)==null?void 0:I.b,a:(nt=(R=r.colorScheme)==null?void 0:R.environmentColor1)==null?void 0:nt.a},obstaclesColor:{r:(K=(J=r.colorScheme)==null?void 0:J.obstaclesColor)==null?void 0:K.r,g:(Lt=(yt=r.colorScheme)==null?void 0:yt.obstaclesColor)==null?void 0:Lt.g,b:(gt=(ht=r.colorScheme)==null?void 0:ht.obstaclesColor)==null?void 0:gt.b,a:(Et=(kt=r.colorScheme)==null?void 0:kt.obstaclesColor)==null?void 0:Et.a},environment0ColorBoost:{r:($t=(zt=r.colorScheme)==null?void 0:zt.environmentColor0Boost)==null?void 0:$t.r,g:(F=(f=r.colorScheme)==null?void 0:f.environmentColor0Boost)==null?void 0:F.g,b:(w=(O=r.colorScheme)==null?void 0:O.environmentColor0Boost)==null?void 0:w.b,a:(T=(E=r.colorScheme)==null?void 0:E.environmentColor0Boost)==null?void 0:T.a},environment1ColorBoost:{r:(G=(z=r.colorScheme)==null?void 0:z.environmentColor1Boost)==null?void 0:G.r,g:(X=(L=r.colorScheme)==null?void 0:L.environmentColor1Boost)==null?void 0:X.g,b:(q=(Q=r.colorScheme)==null?void 0:Q.environmentColor1Boost)==null?void 0:q.b,a:(_t=(it=r.colorScheme)==null?void 0:it.environmentColor1Boost)==null?void 0:_t.a}};return(bt=r.colorScheme)!=null&&bt.environmentColorW&&(l.environmentWColor={r:(ze=(Ht=r.colorScheme)==null?void 0:Ht.environmentColorW)==null?void 0:ze.r,g:(Ve=(Zt=r.colorScheme)==null?void 0:Zt.environmentColorW)==null?void 0:Ve.g,b:(mn=(Tt=r.colorScheme)==null?void 0:Tt.environmentColorW)==null?void 0:mn.b,a:(ie=(kn=r.colorScheme)==null?void 0:kn.environmentColorW)==null?void 0:ie.a}),(Un=r.colorScheme)!=null&&Un.environmentColorWBoost&&(l.environmentWColorBoost={r:(ci=(ui=r.colorScheme)==null?void 0:ui.environmentColorWBoost)==null?void 0:ci.r,g:(Wn=(mi=r.colorScheme)==null?void 0:mi.environmentColorWBoost)==null?void 0:Wn.g,b:(hn=(Ge=r.colorScheme)==null?void 0:Ge.environmentColorWBoost)==null?void 0:hn.b,a:(Hr=(Gr=r.colorScheme)==null?void 0:Gr.environmentColorWBoost)==null?void 0:Hr.a}),l}),difficulties:(o=t._difficultyBeatmapSets)==null?void 0:o.flatMap(r=>{var l;return(l=r._difficultyBeatmaps)==null?void 0:l.map(s=>{const a=ds.deserialize(s);return a.characteristic=r._beatmapCharacteristicName,a.authors={mappers:[t._levelAuthorName]},a})}),customData:t._customData}}},bs={serialize(t){return{characteristic:t.characteristic,difficulty:t.difficulty,beatmapAuthors:{mappers:[...t.authors.mappers],lighters:[...t.authors.lighters]},environmentNameIdx:t.environmentId,beatmapColorSchemeIdx:t.colorSchemeId,noteJumpMovementSpeed:t.njs,noteJumpStartBeatOffset:t.njsOffset,lightshowDataFilename:t.lightshowFilename,beatmapDataFilename:t.filename,customData:N(t.customData)}},deserialize(t={}){var e,n,i,o;return{characteristic:t.characteristic,difficulty:t.difficulty,authors:{mappers:(n=(e=t.beatmapAuthors)==null?void 0:e.mappers)==null?void 0:n.map(r=>r),lighters:(o=(i=t.beatmapAuthors)==null?void 0:i.lighters)==null?void 0:o.map(r=>r)},filename:t.beatmapDataFilename,lightshowFilename:t.lightshowDataFilename,njs:t.noteJumpMovementSpeed,njsOffset:t.noteJumpStartBeatOffset,colorSchemeId:t.beatmapColorSchemeIdx,environmentId:t.environmentNameIdx,customData:t.customData}}},Bp={serialize(t){return{version:"4.0.0",song:{author:t.song.author,title:t.song.title,subTitle:t.song.subTitle},audio:{songFilename:t.audio.filename,songDuration:t.audio.duration,audioDataFilename:t.audio.audioDataFilename,bpm:t.audio.bpm,lufs:t.audio.lufs,previewStartTime:t.audio.previewStartTime,previewDuration:t.audio.previewDuration},songPreviewFilename:t.songPreviewFilename,coverImageFilename:t.coverImageFilename,environmentNames:t.environmentNames.map(e=>e),colorSchemes:t.colorSchemes.map(e=>{const n={colorSchemeName:e.name,saberAColor:ft(e.saberLeftColor),saberBColor:ft(e.saberRightColor),environmentColor0:ft(e.environment0Color),environmentColor1:ft(e.environment1Color),obstaclesColor:ft(e.obstaclesColor),environmentColor0Boost:ft(e.environment0ColorBoost),environmentColor1Boost:ft(e.environment1ColorBoost)};return e.environmentWColor&&(n.environmentColorW=ft(e.environmentWColor)),e.environmentWColorBoost&&(n.environmentColorWBoost=ft(e.environmentWColorBoost)),n}),difficultyBeatmaps:t.difficulties.map(bs.serialize),customData:N(t.customData)}},deserialize(t={}){var e,n,i,o,r,l,s,a,u,c,p,v;return{version:4,song:{author:(e=t.song)==null?void 0:e.author,title:(n=t.song)==null?void 0:n.title,subTitle:(i=t.song)==null?void 0:i.subTitle},audio:{filename:(o=t.audio)==null?void 0:o.songFilename,duration:(r=t.audio)==null?void 0:r.songDuration,audioDataFilename:(l=t.audio)==null?void 0:l.audioDataFilename,bpm:(s=t.audio)==null?void 0:s.bpm,lufs:(a=t.audio)==null?void 0:a.lufs,previewStartTime:(u=t.audio)==null?void 0:u.previewStartTime,previewDuration:(c=t.audio)==null?void 0:c.previewDuration},songPreviewFilename:t.songPreviewFilename,coverImageFilename:t.coverImageFilename,environmentNames:(p=t.environmentNames)==null?void 0:p.map(m=>m),colorSchemes:(v=t.colorSchemes)==null?void 0:v.map(m=>{m=m;const h={useOverride:!0,name:m.colorSchemeName||"",saberLeftColor:se(ge(m.saberAColor),!0),saberRightColor:se(ge(m.saberBColor),!0),environment0Color:se(ge(m.environmentColor0),!0),environment1Color:se(ge(m.environmentColor1),!0),obstaclesColor:se(ge(m.obstaclesColor),!0),environment0ColorBoost:se(ge(m.environmentColor0Boost),!0),environment1ColorBoost:se(ge(m.environmentColor1Boost),!0)};return m.environmentColorW&&(h.environmentWColor=se(ge(m.environmentColorW),!0)),m.environmentColorWBoost&&(h.environmentWColorBoost=se(ge(m.environmentColorWBoost),!0)),h}),difficulties:(t.difficultyBeatmaps??[]).map(m=>bs.deserialize(m)),customData:t.customData}}},xp={serialize(t){return{_version:"2.0.0",_songSampleCount:t.sampleCount,_songFrequency:t.frequency,_regions:t.bpmData.map(e=>({_startBeat:e.startBeat,_endBeat:e.endBeat,_startSampleIndex:e.startSampleIndex,_endSampleIndex:e.endSampleIndex}))}},deserialize(t={}){var e;return{version:2,sampleCount:t._songSampleCount,frequency:t._songFrequency,bpmData:(e=t._regions)==null?void 0:e.map(n=>({startBeat:n==null?void 0:n._startBeat,endBeat:n==null?void 0:n._endBeat,startSampleIndex:n==null?void 0:n._startSampleIndex,endSampleIndex:n==null?void 0:n._endSampleIndex}))}}},Ip={serialize(t){return{version:"4.0.0",songChecksum:t.audioChecksum,songSampleCount:t.sampleCount,songFrequency:t.frequency,bpmData:t.bpmData.map(e=>({sb:e.startBeat,eb:e.endBeat,si:e.startSampleIndex,ei:e.endSampleIndex})),lufsData:t.lufsData.map(e=>({l:e.lufs,si:e.startSampleIndex,ei:e.endSampleIndex}))}},deserialize(t={}){var e,n;return{version:4,audioChecksum:t.songChecksum,sampleCount:t.songSampleCount,frequency:t.songFrequency,bpmData:(e=t.bpmData)==null?void 0:e.map(i=>({startBeat:i==null?void 0:i.sb,endBeat:i==null?void 0:i.eb,startSampleIndex:i==null?void 0:i.si,endSampleIndex:i==null?void 0:i.ei})),lufsData:(n=t.lufsData)==null?void 0:n.map(i=>({lufs:i==null?void 0:i.l,startSampleIndex:i==null?void 0:i.si,endSampleIndex:i==null?void 0:i.ei}))}}},gs={serialize(t){return{_time:t.time,_lineIndex:t.posX,_lineLayer:t.posY,_type:3,_cutDirection:t.direction}},deserialize(t={}){return{time:t._time,posX:t._lineIndex,posY:t._lineLayer,direction:t._cutDirection}}},vs={serialize(t){return{_time:t.time,_lineIndex:t.posX,_lineLayer:t.posY,_type:t.color,_cutDirection:t.direction}},deserialize(t={}){return{time:t._time,posX:t._lineIndex,posY:t._lineLayer,color:t._type,direction:t._cutDirection}}},_s={serialize(t){return{_time:t.time,_type:t.type,_value:t.value}},deserialize(t={}){return{time:t._time,type:t._type,value:t._value,floatValue:1}}},ys={serialize(t){return{_time:t.time,_type:5,_value:t.toggle?1:0}},deserialize(t={}){return{time:t._time,toggle:t._value===1}}},Es={serialize(t){let e=t.rotation%360;return e>=-60&&e<=60&&e%15===0&&e/15!==0?e=yl[e]||e+1360:e+=1360,{_time:t.time,_type:t.executionTime===1?15:14,_value:e}},deserialize(t={}){const e=t._value??0;return{time:t._time,executionTime:t._type===15?1:0,rotation:e>=1e3?(e-1360)%360:_l[e]??0}}},ws={serialize(t){return{_time:t.time,_type:100,_value:Math.round(t.bpm)}},deserialize(t={}){return{time:t._time,bpm:t._value}}},Ds={serialize(t){let e=0;return t.height>=0&&t.posY>=0&&(e=t.height*1e3+t.posY+4001),{_time:t.time,_type:t.posY===2&&t.height===3?1:t.posY===0&&t.height===5?0:e,_lineIndex:t.posX,_duration:t.duration,_width:t.width}},deserialize(t={}){const e=t._type??0,n=e===1?3:e>=1e3&&e<=4e3?cl(e,1e3,4e3,0,15):e>4e3&&e<=4005e3?0:5,i=e===1?2:e>4e3&&e<=4005e3?Math.floor((e-4001)/1e3):0;return{time:t._time,posY:i,posX:t._lineIndex,duration:t._duration,width:t._width,height:n}}},Np={serialize(t){return{_version:"1.5.0",_beatsPerMinute:120,_beatsPerBar:4,_shuffle:0,_shufflePeriod:.5,_noteJumpSpeed:10,_noteJumpStartBeatOffset:0,_notes:[...t.difficulty.colorNotes.map(vs.serialize),...t.difficulty.bombNotes.map(gs.serialize)],_obstacles:t.difficulty.obstacles.map(Ds.serialize),_events:[...t.lightshow.basicEvents.map(_s.serialize),...t.lightshow.colorBoostEvents.map(ys.serialize),...t.difficulty.rotationEvents.map(Es.serialize),...t.difficulty.bpmEvents.map(ws.serialize)],_time:t.difficulty.customData._time,_BPMChanges:t.difficulty.customData._bpmChanges,_bookmarks:t.difficulty.customData._bookmarks}},deserialize(t={}){var u;const e=[],n=[],i=t._notes||[];for(let c=0;c<i.length;c++){const p=i[c];(p==null?void 0:p._type)===3?n.push(gs.deserialize(p)):e.push(vs.deserialize(p))}const o=[],r=[],l=[],s=[],a=t._events||[];for(let c=0;c<a.length;c++){const p=a[c];switch(p==null?void 0:p._type){case 5:r.push(ys.deserialize(p));break;case 14:case 15:l.push(Es.deserialize(p));break;case 100:case 10:s.push(ws.deserialize(p));break;default:o.push(_s.deserialize(p))}}return{version:1,difficulty:{colorNotes:e,bombNotes:n,obstacles:(u=t._obstacles)==null?void 0:u.map(Ds.deserialize),bpmEvents:s,rotationEvents:l,customData:{_bpmChanges:t._BPMChanges,_bookmarks:t._bookmarks,_time:t._time}},lightshow:{basicEvents:o,colorBoostEvents:r}}}},Ss={serialize(t){return{_time:t.time,_type:t.color,_lineIndex:t.posX,_lineLayer:t.posY,_cutDirection:t.direction,_customData:N(t.customData)}},deserialize(t={}){return{time:t._time,posX:t._lineIndex,posY:t._lineLayer,color:t._type,direction:t._cutDirection,customData:t._customData}}},Op={serialize(t){return{_colorType:t.color,_headTime:t.time,_headLineIndex:t.posX,_headLineLayer:t.posY,_headCutDirection:t.direction,_headControlPointLengthMultiplier:t.lengthMultiplier,_tailTime:t.tailTime,_tailLineIndex:t.tailPosX,_tailLineLayer:t.tailPosY,_tailCutDirection:t.tailDirection,_tailControlPointLengthMultiplier:t.tailLengthMultiplier,_sliderMidAnchorMode:t.midAnchor,_customData:N(t.customData)}},deserialize(t={}){return{color:t._colorType,time:t._headTime,posX:t._headLineIndex,posY:t._headLineLayer,direction:t._headCutDirection,lengthMultiplier:t._headControlPointLengthMultiplier,tailTime:t._tailTime,tailPosX:t._tailLineIndex,tailPosY:t._tailLineLayer,tailDirection:t._tailCutDirection,tailLengthMultiplier:t._tailControlPointLengthMultiplier,midAnchor:t._sliderMidAnchorMode,customData:t._customData}}},Cs={serialize(t){let e=0;return t.height>=0&&t.posY>=0&&(e=Math.floor(t.height*1e3+t.posY+4001)),{_time:t.time,_type:t.posY===2&&t.height===3?1:t.posY===0&&t.height===5?0:e,_lineIndex:t.posX,_duration:t.duration,_width:t.width,_customData:N(t.customData)}},deserialize(t={}){const e=t._type??0,n=e===1?3:e>=1e3&&e<=4e3?cl(e,1e3,4e3,0,15):e>4e3&&e<=4005e3?0:5,i=e===1?2:e>4e3&&e<=4005e3?Math.floor((e-4001)/1e3):0;return{time:t._time,posY:i,posX:t._lineIndex,duration:t._duration,width:t._width,height:n,customData:t._customData}}},ks={serialize(t){return{_time:t.time,_type:t.type,_value:t.value,_floatValue:t.floatValue,_customData:N(t.customData)}},deserialize(t={}){return{time:t._time,type:t._type,value:t._value,floatValue:t._floatValue,customData:t._customData}}},Ts={serialize(t){return{_time:t.time,_lineIndex:t.posX,_lineLayer:t.posY,_offsetDirection:t.direction,_customData:N(t.customData)}},deserialize(t={}){return{time:t._time,posX:t._lineIndex,posY:t._lineLayer,direction:t._offsetDirection,customData:t._customData}}},Ls={serialize(t){return{_keyword:t.keyword,_specialEvents:t.events}},deserialize(t={}){return{keyword:t._keyword,events:t._specialEvents}}},Rs={serialize(t){return{_keywords:t.list.map(Ls.serialize)}},deserialize(t={}){var e;return{list:(e=t._keywords)==null?void 0:e.map(Ls.deserialize)}}},Bs={serialize(t){return{_time:t.time,_type:3,_lineIndex:t.posX,_lineLayer:t.posY,_cutDirection:t.direction,_customData:N(t.customData)}},deserialize(t={}){return{time:t._time,posX:t._lineIndex,posY:t._lineLayer,customData:t._customData}}},xs={serialize(t){return{_time:t.time,_type:5,_value:t.toggle?1:0,_floatValue:0,_customData:N(t.customData)}},deserialize(t={}){return{time:t._time,toggle:t._value===1,customData:t._customData}}},Is={serialize(t){let e=t.rotation%360;const n=N(t.customData);return e>=-60&&e<=60&&e%15===0&&e/15!==0?e=yl[e]||e+1360:(n._rotation=e,e+=1360),{_time:t.time,_type:t.executionTime===1?15:14,_value:e,_floatValue:0,_customData:n}},deserialize(t={}){var n;const e=t._value??0;return{time:t._time,executionTime:t._type===15?1:0,rotation:typeof((n=t._customData)==null?void 0:n._rotation)=="number"?t._customData._rotation:e>=1e3?(e-1360)%360:_l[e]??0,customData:t._customData}}},xo={serialize(t){return{_time:t.time,_type:100,_value:0,_floatValue:t.bpm,_customData:N(t.customData)}},deserialize(t={}){return{time:t._time,bpm:t._floatValue??t._value,customData:t._customData}}},Ap={serialize(t){return{_version:"2.6.0",_notes:[...t.difficulty.colorNotes.map(Ss.serialize),...t.difficulty.bombNotes.map(Bs.serialize)].sort(Wf),_sliders:t.difficulty.arcs.map(Op.serialize),_obstacles:t.difficulty.obstacles.map(Cs.serialize),_events:[...t.lightshow.basicEvents.map(ks.serialize),...t.lightshow.colorBoostEvents.map(xs.serialize),...t.difficulty.rotationEvents.map(Is.serialize),...t.difficulty.bpmEvents.map(xo.serialize)].sort(Uf),_waypoints:t.lightshow.waypoints.map(Ts.serialize),_specialEventsKeywordFilters:Rs.serialize(t.lightshow.basicEventTypesWithKeywords),_customData:N(t.difficulty.customData)}},deserialize(t={}){var c,p;const e=[],n=[],i=t._notes||[];for(let v=0;v<i.length;v++){const m=i[v];(m==null?void 0:m._type)===3?n.push(Bs.deserialize(m)):e.push(Ss.deserialize(m))}const o=Il(t._version||"2.0.0","2.5.0"),r=[],l=[],s=[],a=[],u=t._events||[];for(let v=0;v<u.length;v++){const m=u[v];switch(m==null?void 0:m._type){case 5:l.push(xs.deserialize(m));break;case 14:case 15:s.push(Is.deserialize(m));break;case 100:a.push(xo.deserialize(m));break;default:{const h=ks.deserialize(m);o<0?m._type===10?a.push(xo.deserialize(m)):(h.floatValue=1,r.push(h)):r.push(h)}}}return{version:2,difficulty:{colorNotes:e,bombNotes:n,obstacles:(c=t._obstacles)==null?void 0:c.map(Cs.deserialize),bpmEvents:a,rotationEvents:s,customData:t._customData},lightshow:{basicEvents:r,colorBoostEvents:l,waypoints:(p=t._waypoints)==null?void 0:p.map(Ts.deserialize),basicEventTypesWithKeywords:Rs.deserialize(t._specialEventsKeywordFilters)}}}},Mi={serialize(t){return{b:t.time,et:t.type,i:t.value,f:t.floatValue,customData:N(t.customData)}},deserialize(t={}){return{time:t.b,type:t.et,value:t.i,floatValue:t.f,customData:t.customData}}},Ns={serialize(t){return{k:t.keyword,e:t.events.map(e=>e)}},deserialize(t={}){var e;return{keyword:t.k,events:(e=t.e)==null?void 0:e.map(n=>n)}}},Fi={serialize(t){return{d:t.list.map(Ns.serialize)}},deserialize(t={}){var e;return{list:(e=t.d)==null?void 0:e.map(Ns.deserialize)}}},Os={serialize(t){return{b:t.time,x:t.posX,y:t.posY,customData:N(t.customData)}},deserialize(t={}){return{time:t.b,posX:t.x,posY:t.y,customData:t.customData}}},As={serialize(t){return{b:t.time,m:t.bpm,customData:N(t.customData)}},deserialize(t={}){return{time:t.b,bpm:t.m,customData:t.customData}}},Ps={serialize(t){return{b:t.time,c:t.color,x:t.posX,y:t.posY,d:t.direction,tb:t.tailTime,tx:t.tailPosX,ty:t.tailPosY,sc:t.sliceCount,s:t.squish,customData:N(t.customData)}},deserialize(t={}){return{time:t.b,color:t.c,posX:t.x,posY:t.y,direction:t.d,tailTime:t.tb,tailPosX:t.tx,tailPosY:t.ty,sliceCount:t.sc,squish:t.s,customData:t.customData}}},ji={serialize(t){return{b:t.time,o:t.toggle,customData:N(t.customData)}},deserialize(t={}){return{time:t.b,toggle:t.o,customData:t.customData}}},$s={serialize(t){return{b:t.time,c:t.color,x:t.posX,y:t.posY,d:t.direction,a:t.angleOffset,customData:N(t.customData)}},deserialize(t={}){return{time:t.b,posX:t.x,posY:t.y,color:t.c,direction:t.d,angleOffset:t.a,customData:t.customData}}},rn={serialize(t){return{f:t.type,p:t.p0,t:t.p1,r:t.reverse,c:t.chunks,n:t.random,s:t.seed,l:t.limit,d:t.limitAffectsType,customData:N(t.customData)}},deserialize(t={}){return{type:t.f,p0:t.p,p1:t.t,reverse:t.r,chunks:t.c,random:t.n,seed:t.s,limit:t.l,limitAffectsType:t.d,customData:t.customData}}},Ms={serialize(t){return{b:t.time,c:t.color,f:t.frequency,i:t.previous?gn.EXTEND:t.easing===Kn.NONE?gn.INSTANT:gn.INTERPOLATE,s:t.brightness,sb:t.strobeBrightness,sf:t.strobeFade,customData:N(t.customData)}},deserialize(t={}){return{time:t.b,color:t.c,frequency:t.f,previous:t.i===gn.EXTEND?1:0,easing:t.i===gn.INTERPOLATE?Kn.LINEAR:Kn.NONE,brightness:t.s,strobeBrightness:t.sb,strobeFade:t.sf,customData:t.customData}}},Fs={serialize(t){return{f:rn.serialize(t.filter),w:t.beatDistribution,d:t.beatDistributionType,r:t.brightnessDistribution,t:t.brightnessDistributionType,b:t.affectFirst,i:t.easing,e:t.events.map(Ms.serialize),customData:N(t.customData)}},deserialize(t={}){var e;return{filter:rn.deserialize(t.f),beatDistribution:t.w,beatDistributionType:t.d,brightnessDistribution:t.r,brightnessDistributionType:t.t,affectFirst:t.b,easing:t.i,events:(e=t.e)==null?void 0:e.map(Ms.deserialize),customData:t.customData}}},zi={serialize(t){return{b:t.time,g:t.id,e:t.boxes.map(Fs.serialize),customData:N(t.customData)}},deserialize(t={}){var e;return{time:t.b,id:t.g,boxes:(e=t.e)==null?void 0:e.map(Fs.deserialize),customData:t.customData}}},js={serialize(t){return{b:t.time,e:t.easing,l:t.loop,o:t.direction,p:t.previous,r:t.rotation,customData:N(t.customData)}},deserialize(t={}){return{time:t.b,easing:t.e,loop:t.l,direction:t.o,previous:t.p,rotation:t.r,customData:t.customData}}},zs={serialize(t){return{f:rn.serialize(t.filter),w:t.beatDistribution,d:t.beatDistributionType,s:t.rotationDistribution,t:t.rotationDistributionType,a:t.axis,r:t.flip,b:t.affectFirst,i:t.easing,l:t.events.map(js.serialize),customData:N(t.customData)}},deserialize(t={}){var e;return{filter:rn.deserialize(t.f),beatDistribution:t.w,beatDistributionType:t.d,rotationDistribution:t.s,rotationDistributionType:t.t,axis:t.a,flip:t.r,affectFirst:t.b,easing:t.i,events:(e=t.l)==null?void 0:e.map(js.deserialize),customData:t.customData}}},Vi={serialize(t){return{b:t.time,g:t.id,e:t.boxes.map(zs.serialize),customData:N(t.customData)}},deserialize(t={}){var e;return{time:t.b,id:t.g,boxes:(e=t.e)==null?void 0:e.map(zs.deserialize),customData:t.customData}}},Vs={serialize(t){return{b:t.time,e:t.easing,p:t.previous,t:t.translation,customData:N(t.customData)}},deserialize(t={}){return{time:t.b,easing:t.e,previous:t.p,translation:t.t,customData:t.customData}}},Gs={serialize(t){return{f:rn.serialize(t.filter),w:t.beatDistribution,d:t.beatDistributionType,s:t.gapDistribution,t:t.gapDistributionType,a:t.axis,r:t.flip,b:t.affectFirst,i:t.easing,l:t.events.map(Vs.serialize),customData:N(t.customData)}},deserialize(t={}){var e;return{filter:rn.deserialize(t.f),beatDistribution:t.w,beatDistributionType:t.d,gapDistribution:t.s,gapDistributionType:t.t,axis:t.a,flip:t.r,affectFirst:t.b,easing:t.i,events:(e=t.l)==null?void 0:e.map(Vs.deserialize),customData:t.customData}}},Gi={serialize(t){return{b:t.time,g:t.id,e:t.boxes.map(Gs.serialize),customData:N(t.customData)}},deserialize(t={}){var e;return{time:t.b,id:t.g,boxes:(e=t.e)==null?void 0:e.map(Gs.deserialize),customData:t.customData}}},Hs={serialize(t){return{b:t.time,x:t.posX,y:t.posY,d:t.duration,w:t.width,h:t.height,customData:N(t.customData)}},deserialize(t={}){return{time:t.b,posX:t.x,posY:t.y,duration:t.d,width:t.w,height:t.h,customData:t.customData}}},Us={serialize(t){return{b:t.time,e:t.executionTime,r:t.rotation,customData:N(t.customData)}},deserialize(t={}){return{time:t.b,executionTime:t.e,rotation:t.r,customData:t.customData}}},Ws={serialize(t){return{b:t.time,c:t.color,x:t.posX,y:t.posY,d:t.direction,mu:t.lengthMultiplier,tb:t.tailTime,tx:t.tailPosX,ty:t.tailPosY,tc:t.tailDirection,tmu:t.tailLengthMultiplier,m:t.midAnchor,customData:N(t.customData)}},deserialize(t={}){return{time:t.b,color:t.c,posX:t.x,posY:t.y,direction:t.d,lengthMultiplier:t.mu,tailTime:t.tb,tailPosX:t.tx,tailPosY:t.ty,tailDirection:t.tc,tailLengthMultiplier:t.tmu,midAnchor:t.m,customData:t.customData}}},Ys={serialize(t){return{b:t.time,x:t.posX,y:t.posY,d:t.direction,customData:N(t.customData)}},deserialize(t={}){return{time:t.b,posX:t.x,posY:t.y,direction:t.d,customData:t.customData}}},Xs={serialize(t){return{b:t.time,i:t.easing,p:t.previous,v:t.value,customData:N(t.customData)}},deserialize(t={}){return{time:t.b,easing:t.i,previous:t.p,value:t.v,customData:t.customData}}},qs={serialize(t){return{data:{f:rn.serialize(t.filter),w:t.beatDistribution,d:t.beatDistributionType,s:t.fxDistribution,t:t.fxDistributionType,b:t.affectFirst,i:t.easing,l:[],customData:N(t.customData)},eventData:t.events.map(Xs.serialize)}},deserialize(t={}){var e,n,i,o,r,l,s,a,u;return{filter:rn.deserialize((e=t.data)==null?void 0:e.f),beatDistribution:(n=t.data)==null?void 0:n.w,beatDistributionType:(i=t.data)==null?void 0:i.d,fxDistribution:(o=t.data)==null?void 0:o.s,fxDistributionType:(r=t.data)==null?void 0:r.t,affectFirst:(l=t.data)==null?void 0:l.b,easing:(s=t.data)==null?void 0:s.i,events:(a=t.eventData)==null?void 0:a.map(Xs.deserialize),customData:(u=t.data)==null?void 0:u.customData}}},Hi={serialize(t){return{object:{t:rr.FLOAT,b:t.time,g:t.id,e:[],customData:N(t.customData)},boxData:t.boxes.map(qs.serialize)}},deserialize(t={}){var n,i,o,r;const e={};return e.time=(n=t.object)==null?void 0:n.b,e.id=(i=t.object)==null?void 0:i.g,e.boxes=(o=t.boxData)==null?void 0:o.map(qs.deserialize),e.customData=(r=t.object)==null?void 0:r.customData,e}},Pp={serialize(t){const e={version:"3.3.0",bpmEvents:t.difficulty.bpmEvents.map(As.serialize),rotationEvents:t.difficulty.rotationEvents.map(Us.serialize),colorNotes:t.difficulty.colorNotes.map($s.serialize),bombNotes:t.difficulty.bombNotes.map(Os.serialize),obstacles:t.difficulty.obstacles.map(Hs.serialize),sliders:t.difficulty.arcs.map(Ws.serialize),burstSliders:t.difficulty.chains.map(Ps.serialize),waypoints:t.lightshow.waypoints.map(Ys.serialize),basicBeatmapEvents:t.lightshow.basicEvents.map(Mi.serialize),colorBoostBeatmapEvents:t.lightshow.colorBoostEvents.map(ji.serialize),lightColorEventBoxGroups:t.lightshow.lightColorEventBoxGroups.map(zi.serialize),lightRotationEventBoxGroups:t.lightshow.lightRotationEventBoxGroups.map(Vi.serialize),lightTranslationEventBoxGroups:t.lightshow.lightTranslationEventBoxGroups.map(Gi.serialize),vfxEventBoxGroups:[],basicEventTypesWithKeywords:Fi.serialize(t.lightshow.basicEventTypesWithKeywords),_fxEventsCollection:{_fl:[],_il:[]},useNormalEventsAsCompatibleEvents:t.lightshow.useNormalEventsAsCompatibleEvents,customData:N(t.difficulty.customData)};for(const n of t.lightshow.fxEventBoxGroups.map(Hi.serialize)){e.vfxEventBoxGroups.push(n.object);for(const i of n.boxData){n.object.e.push(i.data);for(const o of i.eventData)i.data.l.push(e._fxEventsCollection._fl.length),e._fxEventsCollection._fl.push(o)}}return e},deserialize:function(t={}){var i,o,r,l,s,a,u,c,p,v,m,h,d,y,g;const e={version:3,difficulty:{},lightshow:{}};e.difficulty.bpmEvents=(i=t.bpmEvents)==null?void 0:i.map(As.deserialize),e.difficulty.rotationEvents=(o=t.rotationEvents)==null?void 0:o.map(Us.deserialize),e.difficulty.colorNotes=(r=t.colorNotes)==null?void 0:r.map($s.deserialize),e.difficulty.bombNotes=(l=t.bombNotes)==null?void 0:l.map(Os.deserialize),e.difficulty.obstacles=(s=t.obstacles)==null?void 0:s.map(Hs.deserialize),e.difficulty.arcs=(a=t.sliders)==null?void 0:a.map(Ws.deserialize),e.difficulty.chains=(u=t.burstSliders)==null?void 0:u.map(Ps.deserialize),e.lightshow.waypoints=(c=t.waypoints)==null?void 0:c.map(Ys.deserialize),e.lightshow.basicEvents=(p=t.basicBeatmapEvents)==null?void 0:p.map(Mi.deserialize),e.lightshow.colorBoostEvents=(v=t.colorBoostBeatmapEvents)==null?void 0:v.map(ji.deserialize),e.lightshow.lightColorEventBoxGroups=(m=t.lightColorEventBoxGroups)==null?void 0:m.map(zi.deserialize),e.lightshow.lightRotationEventBoxGroups=(h=t.lightRotationEventBoxGroups)==null?void 0:h.map(Vi.deserialize),e.lightshow.lightTranslationEventBoxGroups=(d=t.lightTranslationEventBoxGroups)==null?void 0:d.map(Gi.deserialize);const n=(y=t._fxEventsCollection)==null?void 0:y._fl;return e.lightshow.fxEventBoxGroups=(g=t.vfxEventBoxGroups)==null?void 0:g.map(_=>{var D;return Hi.deserialize({object:_,boxData:(D=_.e)==null?void 0:D.map(C=>{var k;return{data:C,eventData:(k=C.l)==null?void 0:k.map(P=>n[P])}})})}),e.lightshow.basicEventTypesWithKeywords=Fi.deserialize(t.basicEventTypesWithKeywords),e.lightshow.useNormalEventsAsCompatibleEvents=t.useNormalEventsAsCompatibleEvents,e.difficulty.customData=t.customData,e}},Ks={serialize(t){return{object:{b:t.time,i:0,r:t.laneRotation,customData:{}},data:{x:t.posX,y:t.posY,customData:N(t.customData)}}},deserialize(t={}){var e,n,i,o,r;return{time:(e=t.object)==null?void 0:e.b,laneRotation:(n=t.object)==null?void 0:n.r,posX:(i=t.data)==null?void 0:i.x,posY:(o=t.data)==null?void 0:o.y,customData:(r=t.data)==null?void 0:r.customData}}},Zs={serialize(t){return{object:{hb:t.time,hr:t.laneRotation,tb:t.tailTime,tr:t.tailLaneRotation,i:0,ci:0,customData:{}},data:{c:t.color,x:t.posX,y:t.posY,d:t.direction,a:0,customData:{}},chainData:{tx:t.tailPosX,ty:t.tailPosY,c:t.sliceCount,s:t.squish,customData:N(t.customData)}}},deserialize(t={}){var e,n,i,o,r,l,s,a,u,c,p,v,m;return{time:(e=t.object)==null?void 0:e.hb,laneRotation:(n=t.object)==null?void 0:n.hr,color:(i=t.data)==null?void 0:i.c,posX:(o=t.data)==null?void 0:o.x,posY:(r=t.data)==null?void 0:r.y,direction:(l=t.data)==null?void 0:l.d,tailTime:(s=t.object)==null?void 0:s.tb,tailLaneRotation:(a=t.object)==null?void 0:a.tr,tailPosX:(u=t.chainData)==null?void 0:u.tx,tailPosY:(c=t.chainData)==null?void 0:c.ty,sliceCount:(p=t.chainData)==null?void 0:p.c,squish:(v=t.chainData)==null?void 0:v.s,customData:(m=t.chainData)==null?void 0:m.customData}}},Js={serialize(t){return{object:{b:t.time,i:0,r:t.laneRotation,customData:{}},data:{c:t.color,x:t.posX,y:t.posY,d:t.direction,a:t.angleOffset,customData:N(t.customData)}}},deserialize(t={}){var e,n,i,o,r,l,s,a;return{time:(e=t.object)==null?void 0:e.b,laneRotation:(n=t.object)==null?void 0:n.r,posX:(i=t.data)==null?void 0:i.x,posY:(o=t.data)==null?void 0:o.y,color:(r=t.data)==null?void 0:r.c,direction:(l=t.data)==null?void 0:l.d,angleOffset:(s=t.data)==null?void 0:s.a,customData:(a=t.data)==null?void 0:a.customData}}},Qs={serialize(t){return{object:{b:t.time,i:0,r:t.laneRotation,customData:{}},data:{x:t.posX,y:t.posY,d:t.duration,w:t.width,h:t.height,customData:N(t.customData)}}},deserialize(t={}){var e,n,i,o,r,l,s,a;return{time:(e=t.object)==null?void 0:e.b,laneRotation:(n=t.object)==null?void 0:n.r,posX:(i=t.data)==null?void 0:i.x,posY:(o=t.data)==null?void 0:o.y,duration:(r=t.data)==null?void 0:r.d,width:(l=t.data)==null?void 0:l.w,height:(s=t.data)==null?void 0:s.h,customData:(a=t.data)==null?void 0:a.customData}}},ta={serialize(t){return{object:{ai:0,hb:t.time,hi:0,hr:t.laneRotation,tb:t.tailTime,ti:0,tr:t.tailLaneRotation,customData:{}},data:{m:t.lengthMultiplier,tm:t.tailLengthMultiplier,a:t.midAnchor,customData:N(t.customData)},headData:{c:t.color,x:t.posX,y:t.posY,d:t.direction,a:0,customData:{}},tailData:{c:t.color,x:t.tailPosX,y:t.tailPosY,d:t.tailDirection,a:0,customData:{}}}},deserialize(t={}){var e,n,i,o,r,l,s,a,u,c,p,v,m,h,d;return{time:(e=t.object)==null?void 0:e.hb,laneRotation:(n=t.object)==null?void 0:n.hr,tailTime:(i=t.object)==null?void 0:i.tb,tailLaneRotation:(o=t.object)==null?void 0:o.tr,color:(r=t.headData)==null?void 0:r.c,posX:(l=t.headData)==null?void 0:l.x,posY:(s=t.headData)==null?void 0:s.y,direction:(a=t.headData)==null?void 0:a.d,lengthMultiplier:(u=t.data)==null?void 0:u.m,tailPosX:(c=t.tailData)==null?void 0:c.x,tailPosY:(p=t.tailData)==null?void 0:p.y,tailDirection:(v=t.tailData)==null?void 0:v.d,tailLengthMultiplier:(m=t.data)==null?void 0:m.tm,midAnchor:(h=t.data)==null?void 0:h.a,customData:(d=t.data)==null?void 0:d.customData}}},ea={serialize(t){return{object:{b:t.time},data:{e:t.executionTime,r:t.rotation,customData:N(t.customData)}}},deserialize(t={}){var e,n,i,o;return{time:(e=t.object)==null?void 0:e.b,executionTime:(n=t.data)==null?void 0:n.e,rotation:(i=t.data)==null?void 0:i.r,customData:(o=t.data)==null?void 0:o.customData}}},$p={serialize(t){const e={version:"4.0.0",colorNotes:[],bombNotes:[],obstacles:[],chains:[],arcs:[],spawnRotations:[],colorNotesData:[],bombNotesData:[],obstaclesData:[],chainsData:[],arcsData:[],spawnRotationsData:[],customData:N(t.difficulty.customData)};for(const n of t.difficulty.colorNotes.map(Js.serialize))e.colorNotes.push(n.object),n.object.i=e.colorNotesData.length,e.colorNotesData.push(n.data);for(const n of t.difficulty.bombNotes.map(Ks.serialize))e.bombNotes.push(n.object),n.object.i=e.bombNotesData.length,e.bombNotesData.push(n.data);for(const n of t.difficulty.obstacles.map(Qs.serialize))e.obstacles.push(n.object),n.object.i=e.obstaclesData.length,e.obstaclesData.push(n.data);for(const n of t.difficulty.arcs.map(ta.serialize))e.arcs.push(n.object),n.object.ai=e.arcsData.length,e.arcsData.push(n.data),n.object.hi=e.colorNotesData.length,e.colorNotesData.push(n.headData),n.object.ti=e.colorNotesData.length,e.colorNotesData.push(n.tailData);for(const n of t.difficulty.chains.map(Zs.serialize))e.chains.push(n.object),n.object.i=e.colorNotesData.length,e.colorNotesData.push(n.data),n.object.ci=e.chainsData.length,e.chainsData.push(n.chainData);for(const n of t.difficulty.rotationEvents.map(ea.serialize))e.spawnRotations.push(n.object),n.object.i=e.spawnRotationsData.length,e.spawnRotationsData.push(n.data);return e},deserialize(t={}){var e,n,i,o,r,l;return{version:4,difficulty:{colorNotes:(e=t.colorNotes)==null?void 0:e.map(s=>{var a;return Js.deserialize({object:s,data:(a=t.colorNotesData)==null?void 0:a[(s==null?void 0:s.i)||0]})}),bombNotes:(n=t.bombNotes)==null?void 0:n.map(s=>{var a;return Ks.deserialize({object:s,data:(a=t.bombNotesData)==null?void 0:a[(s==null?void 0:s.i)||0]})}),obstacles:(i=t.obstacles)==null?void 0:i.map(s=>{var a;return Qs.deserialize({object:s,data:(a=t.obstaclesData)==null?void 0:a[(s==null?void 0:s.i)||0]})}),arcs:(o=t.arcs)==null?void 0:o.map(s=>{var a,u,c;return ta.deserialize({object:s,data:(a=t.arcsData)==null?void 0:a[(s==null?void 0:s.ai)||0],headData:(u=t.colorNotesData)==null?void 0:u[(s==null?void 0:s.hi)||0],tailData:(c=t.colorNotesData)==null?void 0:c[(s==null?void 0:s.ti)||0]})}),chains:(r=t.chains)==null?void 0:r.map(s=>{var a,u;return Zs.deserialize({object:s,data:(a=t.colorNotesData)==null?void 0:a[(s==null?void 0:s.i)||0],chainData:(u=t.chainsData)==null?void 0:u[(s==null?void 0:s.ci)||0]})}),rotationEvents:(l=t.spawnRotations)==null?void 0:l.map(s=>{var a;return ea.deserialize({object:s,data:(a=t.spawnRotationsData)==null?void 0:a[(s==null?void 0:s.i)||0]})}),customData:t.customData}}}},Mp={serialize(t){const e={basicBeatmapEvents:t.lightshow.basicEvents.map(Mi.serialize),colorBoostBeatmapEvents:t.lightshow.colorBoostEvents.map(ji.serialize),lightColorEventBoxGroups:t.lightshow.lightColorEventBoxGroups.map(zi.serialize),lightRotationEventBoxGroups:t.lightshow.lightRotationEventBoxGroups.map(Vi.serialize),lightTranslationEventBoxGroups:t.lightshow.lightTranslationEventBoxGroups.map(Gi.serialize),vfxEventBoxGroups:[],_fxEventsCollection:{_fl:[],_il:[]},customData:N(t.lightshow.customData)};for(const n of t.lightshow.fxEventBoxGroups.map(Hi.serialize)){e.vfxEventBoxGroups.push(n.object);for(const i of n.boxData){n.object.e.push(i.data);for(const o of i.eventData)i.data.l.push(e._fxEventsCollection._fl.length),e._fxEventsCollection._fl.push(o)}}return e},deserialize(t={}){var i,o,r,l,s,a,u;const e={version:3,lightshow:{}};e.lightshow.basicEvents=(i=t.basicBeatmapEvents)==null?void 0:i.map(Mi.deserialize),e.lightshow.colorBoostEvents=(o=t.colorBoostBeatmapEvents)==null?void 0:o.map(ji.deserialize),e.lightshow.lightColorEventBoxGroups=(r=t.lightColorEventBoxGroups)==null?void 0:r.map(zi.deserialize),e.lightshow.lightRotationEventBoxGroups=(l=t.lightRotationEventBoxGroups)==null?void 0:l.map(Vi.deserialize),e.lightshow.lightTranslationEventBoxGroups=(s=t.lightTranslationEventBoxGroups)==null?void 0:s.map(Gi.deserialize);const n=((a=t._fxEventsCollection)==null?void 0:a._fl)??[];return e.lightshow.fxEventBoxGroups=(u=t.vfxEventBoxGroups)==null?void 0:u.map(c=>{var p;return Hi.deserialize({object:c,boxData:(p=c.e)==null?void 0:p.map(v=>{var m;return{data:v,eventData:(m=v.l)==null?void 0:m.map(h=>n[h])}})})}),e.lightshow.customData=t.customData,e}},na={serialize(t){return{object:{b:t.time,i:0,r:t.laneRotation,customData:{}},data:{x:t.posX,y:t.posY,d:t.direction,customData:N(t.customData)}}},deserialize(t={}){var e,n,i,o,r,l;return{time:(e=t.object)==null?void 0:e.b,laneRotation:(n=t.object)==null?void 0:n.r,posX:(i=t.data)==null?void 0:i.x,posY:(o=t.data)==null?void 0:o.y,direction:(r=t.data)==null?void 0:r.d,customData:(l=t.data)==null?void 0:l.customData}}},ia={serialize(t){return{object:{b:t.time,i:0,customData:{}},data:{t:t.type,i:t.value,f:t.floatValue,customData:N(t.customData)}}},deserialize(t={}){var e,n,i,o,r;return{time:(e=t.object)==null?void 0:e.b,type:(n=t.data)==null?void 0:n.t,value:(i=t.data)==null?void 0:i.i,floatValue:(o=t.data)==null?void 0:o.f,customData:(r=t.data)==null?void 0:r.customData}}},oa={serialize(t){return{object:{b:t.time,i:0,customData:{}},data:{b:t.toggle?1:0,customData:N(t.customData)}}},deserialize(t={}){var e,n,i;return{time:(e=t.object)==null?void 0:e.b,toggle:!!((n=t.data)!=null&&n.b),customData:(i=t.data)==null?void 0:i.customData}}},sn={serialize(t){return{f:t.type,p:t.p0,t:t.p1,r:t.reverse,c:t.chunks,n:t.random,s:t.seed,l:t.limit,d:t.limitAffectsType,customData:N(t.customData)}},deserialize(t={}){return{type:t.f,p0:t.p,p1:t.t,reverse:t.r,chunks:t.c,random:t.n,seed:t.s,limit:t.l,limitAffectsType:t.d,customData:t.customData}}},ra={serialize(t){return{data:{p:t.previous,c:t.color,e:t.easing,b:t.brightness,f:t.frequency,sb:t.strobeBrightness,sf:t.strobeFade,customData:N(t.customData)},time:t.time}},deserialize(t={}){var e,n,i,o,r,l,s,a;return{time:t.time,previous:(e=t.data)==null?void 0:e.p,color:(n=t.data)==null?void 0:n.c,frequency:(i=t.data)==null?void 0:i.f,easing:(o=t.data)==null?void 0:o.e,brightness:(r=t.data)==null?void 0:r.b,strobeBrightness:(l=t.data)==null?void 0:l.sb,strobeFade:(s=t.data)==null?void 0:s.sf,customData:(a=t.data)==null?void 0:a.customData}}},sa={serialize(t){return{data:{w:t.beatDistribution,d:t.beatDistributionType,s:t.brightnessDistribution,t:t.brightnessDistributionType,b:t.affectFirst,e:t.easing,customData:N(t.customData)},eventData:t.events.map(ra.serialize),filterData:sn.serialize(t.filter)}},deserialize(t={}){var e,n,i,o,r,l,s,a;return{filter:sn.deserialize(t.filterData),beatDistribution:(e=t.data)==null?void 0:e.w,beatDistributionType:(n=t.data)==null?void 0:n.d,brightnessDistribution:(i=t.data)==null?void 0:i.s,brightnessDistributionType:(o=t.data)==null?void 0:o.t,affectFirst:(r=t.data)==null?void 0:r.b,easing:(l=t.data)==null?void 0:l.e,events:(s=t.eventData)==null?void 0:s.map(ra.deserialize),customData:(a=t.data)==null?void 0:a.customData}}},aa={serialize(t){return{object:{t:Ie.COLOR,b:t.time,g:t.id,e:[],customData:N(t.customData)},boxData:t.boxes.map(sa.serialize)}},deserialize(t={}){var e,n,i,o;return{time:(e=t.object)==null?void 0:e.b,id:(n=t.object)==null?void 0:n.g,boxes:(i=t.boxData)==null?void 0:i.map(sa.deserialize),customData:(o=t.object)==null?void 0:o.customData}}},la={serialize(t){return{data:{p:t.previous,l:t.loop,e:t.easing,r:t.rotation,d:t.direction,customData:N(t.customData)},time:t.time}},deserialize(t={}){var e,n,i,o,r,l;return{time:t.time,previous:(e=t.data)==null?void 0:e.p,easing:(n=t.data)==null?void 0:n.e,loop:(i=t.data)==null?void 0:i.l,rotation:(o=t.data)==null?void 0:o.r,direction:(r=t.data)==null?void 0:r.d,customData:(l=t.data)==null?void 0:l.customData}}},ua={serialize(t){return{data:{w:t.beatDistribution,d:t.beatDistributionType,s:t.rotationDistribution,t:t.rotationDistributionType,b:t.affectFirst,e:t.easing,a:t.axis,f:t.flip,customData:N(t.customData)},eventData:t.events.map(la.serialize),filterData:sn.serialize(t.filter)}},deserialize(t={}){var e,n,i,o,r,l,s,a,u,c;return{filter:sn.deserialize(t.filterData),beatDistribution:(e=t.data)==null?void 0:e.w,beatDistributionType:(n=t.data)==null?void 0:n.d,rotationDistribution:(i=t.data)==null?void 0:i.s,rotationDistributionType:(o=t.data)==null?void 0:o.t,affectFirst:(r=t.data)==null?void 0:r.b,easing:(l=t.data)==null?void 0:l.e,axis:(s=t.data)==null?void 0:s.a,flip:(a=t.data)==null?void 0:a.f,events:(u=t.eventData)==null?void 0:u.map(la.deserialize),customData:(c=t.data)==null?void 0:c.customData}}},ca={serialize(t){return{object:{t:Ie.ROTATION,b:t.time,g:t.id,e:[],customData:N(t.customData)},boxData:t.boxes.map(ua.serialize)}},deserialize(t={}){var e,n,i,o;return{time:(e=t.object)==null?void 0:e.b,id:(n=t.object)==null?void 0:n.g,boxes:(i=t.boxData)==null?void 0:i.map(ua.deserialize),customData:(o=t.object)==null?void 0:o.customData}}},ma={serialize(t){return{data:{p:t.previous,e:t.easing,t:t.translation,customData:N(t.customData)},time:t.time}},deserialize(t={}){var e,n,i,o;return{time:t.time,previous:(e=t.data)==null?void 0:e.p,easing:(n=t.data)==null?void 0:n.e,translation:(i=t.data)==null?void 0:i.t,customData:(o=t.data)==null?void 0:o.customData}}},ha={serialize(t){return{data:{w:t.beatDistribution,d:t.beatDistributionType,s:t.gapDistribution,t:t.gapDistributionType,b:t.affectFirst,e:t.easing,a:t.axis,f:t.flip,customData:N(t.customData)},eventData:t.events.map(ma.serialize),filterData:sn.serialize(t.filter)}},deserialize(t={}){var e,n,i,o,r,l,s,a,u,c;return{filter:sn.deserialize(t.filterData),beatDistribution:(e=t.data)==null?void 0:e.w,beatDistributionType:(n=t.data)==null?void 0:n.d,gapDistribution:(i=t.data)==null?void 0:i.s,gapDistributionType:(o=t.data)==null?void 0:o.t,affectFirst:(r=t.data)==null?void 0:r.b,easing:(l=t.data)==null?void 0:l.e,axis:(s=t.data)==null?void 0:s.a,flip:(a=t.data)==null?void 0:a.f,events:(u=t.eventData)==null?void 0:u.map(ma.deserialize),customData:(c=t.data)==null?void 0:c.customData}}},fa={serialize(t){return{object:{t:Ie.TRANSLATION,b:t.time,g:t.id,e:[],customData:N(t.customData)},boxData:t.boxes.map(ha.serialize)}},deserialize(t={}){var e,n,i,o;return{time:(e=t.object)==null?void 0:e.b,id:(n=t.object)==null?void 0:n.g,boxes:(i=t.boxData)==null?void 0:i.map(ha.deserialize),customData:(o=t.object)==null?void 0:o.customData}}},pa={serialize(t){return{data:{p:t.previous,e:t.easing,v:t.value,customData:N(t.customData)},time:t.time}},deserialize(t={}){var e,n,i,o;return{time:t.time,previous:(e=t.data)==null?void 0:e.p,easing:(n=t.data)==null?void 0:n.e,value:(i=t.data)==null?void 0:i.v,customData:(o=t.data)==null?void 0:o.customData}}},da={serialize(t){return{data:{w:t.beatDistribution,d:t.beatDistributionType,s:t.fxDistribution,t:t.fxDistributionType,b:t.affectFirst,e:t.easing,customData:N(t.customData)},eventData:t.events.map(pa.serialize),filterData:sn.serialize(t.filter)}},deserialize(t={}){var e,n,i,o,r,l,s,a;return{filter:sn.deserialize(t.filterData),beatDistribution:(e=t.data)==null?void 0:e.w,beatDistributionType:(n=t.data)==null?void 0:n.d,fxDistribution:(i=t.data)==null?void 0:i.s,fxDistributionType:(o=t.data)==null?void 0:o.t,affectFirst:(r=t.data)==null?void 0:r.b,easing:(l=t.data)==null?void 0:l.e,events:(s=t.eventData)==null?void 0:s.map(pa.deserialize),customData:(a=t.data)==null?void 0:a.customData}}},ba={serialize(t){return{object:{t:Ie.FX_FLOAT,b:t.time,g:t.id,e:[],customData:N(t.customData)},boxData:t.boxes.map(da.serialize)}},deserialize(t={}){var e,n,i,o;return{time:(e=t.object)==null?void 0:e.b,id:(n=t.object)==null?void 0:n.g,boxes:(i=t.boxData)==null?void 0:i.map(da.deserialize),customData:(o=t.object)==null?void 0:o.customData}}},Fp={serialize(t){const e={version:"4.0.0",waypoints:[],waypointsData:[],basicEvents:[],basicEventsData:[],colorBoostEvents:[],colorBoostEventsData:[],eventBoxGroups:[],indexFilters:[],lightColorEventBoxes:[],lightColorEvents:[],lightRotationEventBoxes:[],lightRotationEvents:[],lightTranslationEventBoxes:[],lightTranslationEvents:[],fxEventBoxes:[],floatFxEvents:[],basicEventTypesWithKeywords:Fi.serialize(t.lightshow.basicEventTypesWithKeywords),useNormalEventsAsCompatibleEvents:t.lightshow.useNormalEventsAsCompatibleEvents,customData:N(t.difficulty.customData)};for(const n of t.lightshow.waypoints.map(na.serialize))e.waypoints.push(n.object),n.object.i=e.waypointsData.length,e.waypointsData.push(n.data);for(const n of t.lightshow.basicEvents.map(ia.serialize))e.basicEvents.push(n.object),n.object.i=e.basicEventsData.length,e.basicEventsData.push(n.data);for(const n of t.lightshow.colorBoostEvents.map(oa.serialize))e.colorBoostEvents.push(n.object),n.object.i=e.colorBoostEventsData.length,e.colorBoostEventsData.push(n.data);for(const n of t.lightshow.lightColorEventBoxGroups.map(aa.serialize)){e.eventBoxGroups.push(n.object);for(const i of n.boxData){const o=[];for(const r of i.eventData)o.push({b:r.time,i:e.lightColorEvents.length}),e.lightColorEvents.push(r.data);n.object.e.push({e:e.lightColorEventBoxes.length,f:e.indexFilters.length,l:o,customData:{}}),e.lightColorEventBoxes.push(i.data),e.indexFilters.push(i.filterData)}}for(const n of t.lightshow.lightRotationEventBoxGroups.map(ca.serialize)){e.eventBoxGroups.push(n.object);for(const i of n.boxData){const o=[];for(const r of i.eventData)o.push({b:r.time,i:e.lightRotationEvents.length}),e.lightRotationEvents.push(r.data);n.object.e.push({e:e.lightRotationEventBoxes.length,f:e.indexFilters.length,l:o,customData:{}}),e.lightRotationEventBoxes.push(i.data),e.indexFilters.push(i.filterData)}}for(const n of t.lightshow.lightTranslationEventBoxGroups.map(fa.serialize)){e.eventBoxGroups.push(n.object);for(const i of n.boxData){const o=[];for(const r of i.eventData)o.push({b:r.time,i:e.lightTranslationEvents.length}),e.lightTranslationEvents.push(r.data);n.object.e.push({e:e.lightTranslationEventBoxes.length,f:e.indexFilters.length,l:o,customData:{}}),e.lightTranslationEventBoxes.push(i.data),e.indexFilters.push(i.filterData)}}for(const n of t.lightshow.fxEventBoxGroups.map(ba.serialize)){e.eventBoxGroups.push(n.object);for(const i of n.boxData){const o=[];for(const r of i.eventData)o.push({b:r.time,i:e.floatFxEvents.length}),e.floatFxEvents.push(r.data);n.object.e.push({e:e.fxEventBoxes.length,f:e.indexFilters.length,l:o,customData:{}}),e.fxEventBoxes.push(i.data),e.indexFilters.push(i.filterData)}}return e},deserialize(t={}){var p,v,m,h,d,y,g;const e={version:4,lightshow:{lightColorEventBoxGroups:[],lightRotationEventBoxGroups:[],lightTranslationEventBoxGroups:[],fxEventBoxGroups:[]}};e.lightshow.waypoints=(p=t.waypoints)==null?void 0:p.map(_=>{var D;return na.deserialize({object:_,data:(D=t.waypointsData)==null?void 0:D[(_==null?void 0:_.i)||0]})}),e.lightshow.basicEvents=(v=t.basicEvents)==null?void 0:v.map(_=>{var D;return ia.deserialize({object:_,data:(D=t.basicEventsData)==null?void 0:D[(_==null?void 0:_.i)||0]})}),e.lightshow.colorBoostEvents=(m=t.colorBoostEvents)==null?void 0:m.map(_=>{var D;return oa.deserialize({object:_,data:(D=t.colorBoostEventsData)==null?void 0:D[(_==null?void 0:_.i)||0]})});const n=t.indexFilters??[],i=t.lightColorEventBoxes??[],o=t.lightColorEvents??[],r=t.lightRotationEventBoxes??[],l=t.lightRotationEvents??[],s=t.lightTranslationEventBoxes??[],a=t.lightTranslationEvents??[],u=t.fxEventBoxes??[],c=t.floatFxEvents??[];for(const _ of t.eventBoxGroups||[])switch((_==null?void 0:_.t)||0){case Ie.COLOR:e.lightshow.lightColorEventBoxGroups.push(aa.deserialize({object:_,boxData:(h=_==null?void 0:_.e)==null?void 0:h.map(C=>{var k;return{data:i[C.e||0],filterData:n[C.f||0],eventData:(k=C.l)==null?void 0:k.map(P=>({time:P.b,data:o[P.i||0]}))}})}));break;case Ie.ROTATION:e.lightshow.lightRotationEventBoxGroups.push(ca.deserialize({object:_,boxData:(d=_==null?void 0:_.e)==null?void 0:d.map(C=>{var k;return{data:r[C.e||0],filterData:n[C.f||0],eventData:(k=C.l)==null?void 0:k.map(P=>({time:P.b,data:l[P.i||0]}))}})}));break;case Ie.TRANSLATION:e.lightshow.lightTranslationEventBoxGroups.push(fa.deserialize({object:_,boxData:(y=_==null?void 0:_.e)==null?void 0:y.map(C=>{var k;return{data:s[C.e||0],filterData:n[C.f||0],eventData:(k=C.l)==null?void 0:k.map(P=>({time:P.b,data:a[P.i||0]}))}})}));break;case Ie.FX_FLOAT:e.lightshow.fxEventBoxGroups.push(ba.deserialize({object:_,boxData:(g=_==null?void 0:_.e)==null?void 0:g.map(C=>{var k;return{data:u[C.e||0],filterData:n[C.f||0],eventData:(k=C.l)==null?void 0:k.map(P=>({time:P.b,data:c[P.i||0]}))}})}));break}return e.lightshow.basicEventTypesWithKeywords=Fi.deserialize(t.basicEventTypesWithKeywords),e.lightshow.useNormalEventsAsCompatibleEvents=!!t.useNormalEventsAsCompatibleEvents,e.lightshow.customData=t.customData,e}},jp={1:Lp,2:Rp,4:Bp},zp={2:xp,4:Ip},Vp={1:Np,2:Ap,3:Pp,4:$p},Gp={3:Mp,4:Fp};function Nl(){return["helpers","schemaCheck"]}function be(t,e,n){if(e)throw new Error(t);Z.tWarn(Nl(),t),n.push(t)}function Li(t,e,n,i,o,r=[]){if(Z.tDebug(Nl(),`Looking up ${n}`),Array.isArray(t)){for(let s=0;s<t.length;s++)Li(t[s],e,`${n}[${s}]`,i,o,r);return r}const l=Object.keys(e);if(!l.length)return r;for(const s in t)s in e||be(`Unused key ${s} found in ${n}`,o.unused,r);for(let s=0;s<l.length;s++){const a=l[s],u=e[a],c=t[a];if(c===void 0){if(!o.ignoreOptional&&e[a].optional||Il(i,u.version)===-1)continue;be(`Missing ${a} in object ${n}!`,o.missing,r);continue}if(c===null){be(`${a} contain null value in object ${n}!`,o.nullish,r);continue}if(u.type==="array"){Array.isArray(c)||be(`${a} is not an array in object ${n}!`,o.wrongType,r),Li(c,u.check,`${n}.${a}`,i,o,r);continue}if(u.type==="object"){!Array.isArray(c)&&typeof c!="object"?be(`${a} is not an object in object ${n}!`,o.wrongType,r):Li(c,u.check,`${n}.${a}`,i,o,r);continue}if(u.array){if(!Array.isArray(c)){be(`${a} is not ${u.type} in object ${n}!`,o.wrongType,r);continue}c.every(p=>typeof p===u.type||u.type==="number"&&typeof p=="number"&&(isNaN(p)||(u.int?p%1!==0:!0)&&(u.unsigned?p<0:!0)))||be(`${a} is not ${u.type} in object ${n}!`,o.wrongType,r);continue}if(!u.array&&typeof c!==u.type){be(`${a} is not ${u.type} in object ${n}!`,o.wrongType,r);continue}if(u.type==="number"){if(isNaN(c)){be(`${n}.${a} is NaN!`,o.nullish,r);continue}if(u.int&&c%1!==0){be(`${n}.${a} cannot be float!`,o.notInt,r);continue}if(u.unsigned&&c<0){be(`${n}.${a} cannot be negative!`,o.notUnsigned,r);continue}}}return r}const Hp={_time:{type:"number",version:"1.5.0"},_type:{type:"number",int:!0,unsigned:!0,version:"1.5.0"},_lineIndex:{type:"number",int:!0,version:"1.5.0"},_lineLayer:{type:"number",int:!0,version:"1.5.0"},_cutDirection:{type:"number",int:!0,unsigned:!0,version:"1.5.0"}},Up={_time:{type:"number",version:"1.5.0"},_lineIndex:{type:"number",int:!0,version:"1.5.0"},_type:{type:"number",int:!0,unsigned:!0,version:"1.5.0"},_duration:{type:"number",version:"1.5.0"},_width:{type:"number",int:!0,version:"1.5.0"}},Wp={_time:{type:"number",version:"1.5.0"},_type:{type:"number",int:!0,version:"1.5.0"},_value:{type:"number",int:!0,version:"1.5.0"}},Yp={_version:{type:"string",version:"1.5.0"},_beatsPerMinute:{type:"number",version:"1.5.0"},_beatsPerBar:{type:"number",version:"1.5.0"},_shuffle:{type:"number",version:"1.5.0"},_shufflePeriod:{type:"number",version:"1.5.0"},_noteJumpSpeed:{type:"number",version:"1.5.0",optional:!0},_noteJumpStartBeatOffset:{type:"number",version:"1.5.0",optional:!0},_notes:{type:"array",version:"1.5.0",check:Hp},_obstacles:{type:"array",version:"1.5.0",check:Up},_events:{type:"array",version:"1.5.0",check:Wp},_time:{type:"number",version:"1.5.0",optional:!0},_BPMChanges:{type:"array",version:"1.5.0",optional:!0,check:{}},_bookmarks:{type:"array",version:"1.5.0",optional:!0,check:{}}},Xp={difficulty:{type:"string",version:"1.0.0"},difficultyRank:{type:"number",version:"1.0.0"},audioPath:{type:"string",version:"1.0.0"},jsonPath:{type:"string",version:"1.0.0"},characteristic:{type:"string",version:"1.0.0"},offset:{type:"number",version:"1.0.0",optional:!0},oldOffset:{type:"number",version:"1.0.0",optional:!0},chromaToggle:{type:"string",version:"1.0.0",optional:!0},customColors:{type:"boolean",version:"1.0.0",optional:!0},difficultyLabel:{type:"string",version:"1.0.0",optional:!0},colorLeft:{type:"object",version:"1.0.0",check:{},optional:!0},colorRight:{type:"object",version:"1.0.0",check:{},optional:!0},envColorLeft:{type:"object",version:"1.0.0",check:{},optional:!0},envColorRight:{type:"object",version:"1.0.0",check:{},optional:!0},obstacleColor:{type:"object",version:"1.0.0",check:{},optional:!0}},qp={songName:{type:"string",version:"1.0.0"},songSubName:{type:"string",version:"1.0.0"},authorName:{type:"string",version:"1.0.0"},beatsPerMinute:{type:"number",version:"1.0.0"},previewStartTime:{type:"number",version:"1.0.0"},previewDuration:{type:"number",version:"1.0.0"},coverImagePath:{type:"string",version:"1.0.0"},environmentName:{type:"string",version:"1.0.0"},difficultyLevels:{type:"array",version:"1.0.0",check:Xp},oneSaber:{type:"boolean",version:"1.0.0",optional:!0},contributors:{type:"array",version:"1.0.0",optional:!0,check:{}},customEnvironment:{type:"string",version:"1.0.0",optional:!0},customEnvironmentHash:{type:"string",version:"1.0.0",optional:!0}},Kp={_time:{type:"number",version:"2.0.0",optional:!0},_type:{type:"number",int:!0,unsigned:!0,version:"2.0.0",optional:!0},_lineIndex:{type:"number",int:!0,version:"2.0.0",optional:!0},_lineLayer:{type:"number",int:!0,version:"2.0.0",optional:!0},_cutDirection:{type:"number",int:!0,unsigned:!0,version:"2.0.0",optional:!0},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},Zp={_colorType:{type:"number",version:"2.0.0",optional:!0},_headTime:{type:"number",version:"2.0.0",optional:!0},_headLineIndex:{type:"number",int:!0,version:"2.0.0",optional:!0},_headLineLayer:{type:"number",int:!0,version:"2.0.0",optional:!0},_headCutDirection:{type:"number",int:!0,unsigned:!0,version:"2.0.0",optional:!0},_headControlPointLengthMultiplier:{type:"number",version:"2.0.0",optional:!0},_tailTime:{type:"number",version:"2.0.0",optional:!0},_tailLineIndex:{type:"number",int:!0,version:"2.0.0",optional:!0},_tailLineLayer:{type:"number",int:!0,version:"2.0.0",optional:!0},_tailCutDirection:{type:"number",int:!0,unsigned:!0,version:"2.0.0",optional:!0},_tailControlPointLengthMultiplier:{type:"number",version:"2.0.0",optional:!0},_sliderMidAnchorMode:{type:"number",version:"2.0.0",optional:!0},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},Jp={_time:{type:"number",version:"2.0.0",optional:!0},_lineIndex:{type:"number",int:!0,version:"2.0.0",optional:!0},_type:{type:"number",int:!0,unsigned:!0,version:"2.0.0",optional:!0},_duration:{type:"number",version:"2.0.0",optional:!0},_width:{type:"number",int:!0,version:"2.0.0",optional:!0},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},Qp={_time:{type:"number",version:"2.0.0",optional:!0},_type:{type:"number",int:!0,version:"2.0.0",optional:!0},_value:{type:"number",int:!0,version:"2.0.0",optional:!0},_floatValue:{type:"number",version:"2.5.0",optional:!0},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},td={_time:{type:"number",version:"2.2.0",optional:!0},_lineIndex:{type:"number",int:!0,version:"2.2.0",optional:!0},_lineLayer:{type:"number",int:!0,version:"2.2.0",optional:!0},_offsetDirection:{type:"number",int:!0,version:"2.2.0",optional:!0},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},ed={_keyword:{type:"string",version:"2.4.0",optional:!0},_specialEvents:{type:"number",int:!0,array:!0,version:"2.4.0",optional:!0}},nd={_keywords:{type:"array",version:"2.4.0",check:ed,optional:!0}},id={_version:{type:"string",version:"2.0.0",optional:!0},_notes:{type:"array",version:"2.0.0",check:Kp,optional:!0},_sliders:{type:"array",version:"2.6.0",check:Zp,optional:!0},_obstacles:{type:"array",version:"2.0.0",check:Jp,optional:!0},_events:{type:"array",version:"2.0.0",check:Qp,optional:!0},_waypoints:{type:"array",version:"2.2.0",check:td,optional:!0},_specialEventsKeywordFilters:{type:"object",version:"2.4.0",check:nd,optional:!0},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},od={_difficulty:{type:"string",version:"2.0.0"},_difficultyRank:{type:"number",version:"2.0.0"},_beatmapFilename:{type:"string",version:"2.0.0"},_noteJumpMovementSpeed:{type:"number",version:"2.0.0"},_noteJumpStartBeatOffset:{type:"number",version:"2.0.0"},_beatmapColorSchemeIdx:{type:"number",version:"2.1.0"},_environmentNameIdx:{type:"number",version:"2.1.0"},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},rd={_beatmapCharacteristicName:{type:"string",version:"2.0.0"},_difficultyBeatmaps:{type:"array",version:"2.0.0",check:od}},fn={r:{type:"number",version:"2.1.0"},g:{type:"number",version:"2.1.0"},b:{type:"number",version:"2.1.0"},a:{type:"number",version:"2.1.0"}},sd={colorSchemeId:{type:"string",version:"2.1.0"},saberAColor:{type:"object",version:"2.1.0",check:fn},saberBColor:{type:"object",version:"2.1.0",check:fn},environmentColor0:{type:"object",version:"2.1.0",check:fn},environmentColor1:{type:"object",version:"2.1.0",check:fn},obstaclesColor:{type:"object",version:"2.1.0",check:fn},environmentColor0Boost:{type:"object",version:"2.1.0",check:fn},environmentColor1Boost:{type:"object",version:"2.1.0",check:fn}},ad={useOverride:{type:"boolean",version:"2.1.0"},colorScheme:{type:"object",version:"2.1.0",check:sd}},ld={_version:{type:"string",version:"2.0.0",optional:!0},_songName:{type:"string",version:"2.0.0"},_songSubName:{type:"string",version:"2.0.0"},_songAuthorName:{type:"string",version:"2.0.0"},_levelAuthorName:{type:"string",version:"2.0.0"},_beatsPerMinute:{type:"number",version:"2.0.0"},_songTimeOffset:{type:"number",version:"2.0.0"},_shuffle:{type:"number",version:"2.0.0"},_shufflePeriod:{type:"number",version:"2.0.0"},_previewStartTime:{type:"number",version:"2.0.0"},_previewDuration:{type:"number",version:"2.0.0"},_songFilename:{type:"string",version:"2.0.0"},_coverImageFilename:{type:"string",version:"2.0.0"},_environmentName:{type:"string",version:"2.0.0"},_allDirectionsEnvironmentName:{type:"string",version:"2.0.0",optional:!0},_environmentNames:{type:"string",version:"2.1.0",array:!0},_colorSchemes:{type:"array",version:"2.1.0",check:ad},_customData:{type:"object",version:"2.0.0",check:{},optional:!0},_difficultyBeatmapSets:{type:"array",version:"2.0.0",check:rd}},ud={_startSampleIndex:{type:"number",version:"2.0.0",int:!0,unsigned:!0},_endSampleIndex:{type:"number",version:"2.0.0",int:!0,unsigned:!0},_startBeat:{type:"number",version:"2.0.0"},_endBeat:{type:"number",version:"2.0.0"}},cd={_version:{type:"string",version:"2.0.0"},_songSampleCount:{type:"number",version:"2.0.0",int:!0,unsigned:!0},_songFrequency:{type:"number",version:"2.0.0",int:!0,unsigned:!0},_regions:{type:"object",version:"2.0.0",check:ud,array:!0}},md={b:{type:"number",version:"3.0.0",optional:!0},c:{type:"number",int:!0,version:"3.0.0",optional:!0},x:{type:"number",int:!0,version:"3.0.0",optional:!0},y:{type:"number",int:!0,version:"3.0.0",optional:!0},d:{type:"number",int:!0,version:"3.0.0",optional:!0},a:{type:"number",int:!0,version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},hd={b:{type:"number",version:"3.0.0",optional:!0},x:{type:"number",int:!0,version:"3.0.0",optional:!0},y:{type:"number",int:!0,version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},fd={b:{type:"number",version:"3.0.0",optional:!0},c:{type:"number",int:!0,version:"3.0.0",optional:!0},x:{type:"number",int:!0,version:"3.0.0",optional:!0},y:{type:"number",int:!0,version:"3.0.0",optional:!0},d:{type:"number",int:!0,version:"3.0.0",optional:!0},mu:{type:"number",version:"3.0.0",optional:!0},tb:{type:"number",version:"3.0.0",optional:!0},tx:{type:"number",int:!0,version:"3.0.0",optional:!0},ty:{type:"number",int:!0,version:"3.0.0",optional:!0},tc:{type:"number",int:!0,version:"3.0.0",optional:!0},tmu:{type:"number",version:"3.0.0",optional:!0},m:{type:"number",int:!0,version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},pd={b:{type:"number",version:"3.0.0",optional:!0},c:{type:"number",int:!0,version:"3.0.0",optional:!0},x:{type:"number",int:!0,version:"3.0.0",optional:!0},y:{type:"number",int:!0,version:"3.0.0",optional:!0},d:{type:"number",int:!0,version:"3.0.0",optional:!0},tb:{type:"number",version:"3.0.0",optional:!0},tx:{type:"number",int:!0,version:"3.0.0",optional:!0},ty:{type:"number",int:!0,version:"3.0.0",optional:!0},sc:{type:"number",int:!0,version:"3.0.0",optional:!0},s:{type:"number",version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},dd={b:{type:"number",version:"3.0.0",optional:!0},x:{type:"number",int:!0,version:"3.0.0",optional:!0},y:{type:"number",int:!0,version:"3.0.0",optional:!0},d:{type:"number",version:"3.0.0",optional:!0},w:{type:"number",int:!0,version:"3.0.0",optional:!0},h:{type:"number",int:!0,version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Ol={b:{type:"number",version:"3.0.0",optional:!0},et:{type:"number",int:!0,version:"3.0.0",optional:!0},i:{type:"number",int:!0,version:"3.0.0",optional:!0},f:{type:"number",version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},bd={b:{type:"number",version:"3.0.0",optional:!0},m:{type:"number",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},gd={b:{type:"number",version:"3.0.0",optional:!0},e:{type:"number",int:!0,version:"3.0.0",optional:!0},r:{type:"number",version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Al={b:{type:"number",version:"3.0.0",optional:!0},o:{type:"boolean",version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Zi={f:{type:"number",int:!0,version:"3.0.0",optional:!0},p:{type:"number",version:"3.0.0",optional:!0},t:{type:"number",version:"3.0.0",optional:!0},r:{type:"number",int:!0,version:"3.0.0",optional:!0},c:{type:"number",int:!0,version:"3.1.0",optional:!0},l:{type:"number",version:"3.1.0",optional:!0},d:{type:"number",int:!0,version:"3.1.0",optional:!0},n:{type:"number",int:!0,version:"3.1.0",optional:!0},s:{type:"number",int:!0,version:"3.1.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},vd={b:{type:"number",version:"3.0.0",optional:!0},c:{type:"number",int:!0,version:"3.0.0",optional:!0},f:{type:"number",version:"3.0.0",optional:!0},i:{type:"number",int:!0,version:"3.0.0",optional:!0},s:{type:"number",version:"3.0.0",optional:!0},sb:{type:"number",version:"3.3.0",optional:!0},sf:{type:"number",int:!0,version:"3.3.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},_d={f:{type:"object",version:"3.0.0",check:Zi,optional:!0},w:{type:"number",version:"3.0.0",optional:!0},d:{type:"number",int:!0,version:"3.0.0",optional:!0},r:{type:"number",version:"3.0.0",optional:!0},t:{type:"number",int:!0,version:"3.0.0",optional:!0},e:{type:"array",version:"3.0.0",check:vd,optional:!0},b:{type:"number",int:!0,version:"3.0.0",optional:!0},i:{type:"number",int:!0,version:"3.2.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Pl={b:{type:"number",version:"3.0.0",optional:!0},g:{type:"number",int:!0,version:"3.0.0",optional:!0},e:{type:"array",version:"3.0.0",check:_d,optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},yd={b:{type:"number",version:"3.0.0",optional:!0},p:{type:"number",int:!0,version:"3.0.0",optional:!0},e:{type:"number",int:!0,version:"3.0.0",optional:!0},l:{type:"number",version:"3.0.0",optional:!0},r:{type:"number",version:"3.0.0",optional:!0},o:{type:"number",int:!0,version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Ed={f:{type:"object",version:"3.0.0",check:Zi,optional:!0},w:{type:"number",version:"3.0.0",optional:!0},d:{type:"number",int:!0,version:"3.0.0",optional:!0},s:{type:"number",version:"3.0.0",optional:!0},t:{type:"number",int:!0,version:"3.0.0",optional:!0},a:{type:"number",int:!0,version:"3.0.0",optional:!0},l:{type:"array",version:"3.0.0",check:yd,optional:!0},r:{type:"number",int:!0,version:"3.0.0",optional:!0},b:{type:"number",int:!0,version:"3.0.0",optional:!0},i:{type:"number",int:!0,version:"3.2.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},$l={b:{type:"number",version:"3.0.0",optional:!0},g:{type:"number",int:!0,version:"3.0.0",optional:!0},e:{type:"array",version:"3.0.0",check:Ed,optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},wd={b:{type:"number",version:"3.2.0",optional:!0},p:{type:"number",int:!0,version:"3.2.0",optional:!0},e:{type:"number",int:!0,version:"3.2.0",optional:!0},t:{type:"number",version:"3.2.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Dd={f:{type:"object",version:"3.2.0",check:Zi,optional:!0},w:{type:"number",version:"3.2.0",optional:!0},d:{type:"number",int:!0,version:"3.2.0",optional:!0},s:{type:"number",version:"3.2.0",optional:!0},t:{type:"number",int:!0,version:"3.2.0",optional:!0},a:{type:"number",int:!0,version:"3.2.0",optional:!0},l:{type:"array",version:"3.2.0",check:wd,optional:!0},r:{type:"number",int:!0,version:"3.2.0",optional:!0},b:{type:"number",int:!0,version:"3.2.0",optional:!0},i:{type:"number",int:!0,version:"3.2.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Ml={b:{type:"number",version:"3.2.0",optional:!0},g:{type:"number",int:!0,version:"3.2.0",optional:!0},e:{type:"array",version:"3.2.0",check:Dd,optional:!0},customData:{type:"object",version:"3.2.0",check:{},optional:!0}},Sd={f:{type:"object",version:"3.3.0",check:Zi,optional:!0},w:{type:"number",version:"3.3.0",optional:!0},d:{type:"number",int:!0,version:"3.3.0",optional:!0},s:{type:"number",version:"3.3.0",optional:!0},t:{type:"number",int:!0,version:"3.3.0",optional:!0},l:{type:"number",int:!0,array:!0,version:"3.3.0",optional:!0},b:{type:"number",int:!0,version:"3.3.0",optional:!0},i:{type:"number",int:!0,version:"3.3.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Fl={b:{type:"number",version:"3.3.0",optional:!0},g:{type:"number",int:!0,version:"3.3.0",optional:!0},e:{type:"array",version:"3.3.0",check:Sd,optional:!0},t:{type:"number",int:!0,version:"3.3.0",optional:!0},customData:{type:"object",version:"3.3.0",check:{},optional:!0}},Cd={k:{type:"string",version:"3.0.0",optional:!0},e:{type:"number",int:!0,array:!0,version:"3.0.0",optional:!0}},jl={d:{type:"array",version:"3.0.0",check:Cd,optional:!0}},kd={b:{type:"number",version:"3.3.0",optional:!0},i:{type:"number",int:!0,version:"3.3.0",optional:!0},p:{type:"number",int:!0,version:"3.3.0",optional:!0},v:{type:"number",version:"3.3.0",optional:!0},customData:{type:"object",version:"3.3.0",check:{},optional:!0}},Td={b:{type:"number",version:"3.3.0",optional:!0},p:{type:"number",int:!0,version:"3.3.0",optional:!0},v:{type:"number",int:!0,version:"3.3.0",optional:!0},customData:{type:"object",version:"3.3.0",check:{},optional:!0}},zl={_fl:{type:"array",version:"3.3.0",check:kd,optional:!0},_il:{type:"array",version:"3.3.0",check:Td,optional:!0}},Ld={b:{type:"number",version:"3.0.0",optional:!0},d:{type:"number",int:!0,version:"3.0.0",optional:!0},x:{type:"number",int:!0,version:"3.0.0",optional:!0},y:{type:"number",int:!0,version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Rd={version:{type:"string",version:"3.0.0",optional:!0},bpmEvents:{type:"array",version:"3.0.0",check:bd,optional:!0},rotationEvents:{type:"array",version:"3.0.0",check:gd,optional:!0},colorNotes:{type:"array",version:"3.0.0",check:md,optional:!0},bombNotes:{type:"array",version:"3.0.0",check:hd,optional:!0},obstacles:{type:"array",version:"3.0.0",check:dd,optional:!0},sliders:{type:"array",version:"3.0.0",check:fd,optional:!0},burstSliders:{type:"array",version:"3.0.0",check:pd,optional:!0},waypoints:{type:"array",version:"3.0.0",check:Ld,optional:!0},basicBeatmapEvents:{type:"array",version:"3.0.0",check:Ol,optional:!0},colorBoostBeatmapEvents:{type:"array",version:"3.0.0",check:Al,optional:!0},lightColorEventBoxGroups:{type:"array",version:"3.0.0",check:Pl,optional:!0},lightRotationEventBoxGroups:{type:"array",version:"3.0.0",check:$l,optional:!0},lightTranslationEventBoxGroups:{type:"array",version:"3.2.0",check:Ml,optional:!0},vfxEventBoxGroups:{type:"array",version:"3.3.0",check:Fl,optional:!0},basicEventTypesWithKeywords:{type:"object",version:"3.0.0",check:jl,optional:!0},_fxEventsCollection:{type:"object",version:"3.3.0",check:zl,optional:!0},useNormalEventsAsCompatibleEvents:{type:"boolean",version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Bd={basicBeatmapEvents:{type:"array",version:"3.0.0",check:Ol,optional:!0},colorBoostBeatmapEvents:{type:"array",version:"3.0.0",check:Al,optional:!0},lightColorEventBoxGroups:{type:"array",version:"3.0.0",check:Pl,optional:!0},lightRotationEventBoxGroups:{type:"array",version:"3.0.0",check:$l,optional:!0},lightTranslationEventBoxGroups:{type:"array",version:"3.2.0",check:Ml,optional:!0},vfxEventBoxGroups:{type:"array",version:"3.3.0",check:Fl,optional:!0},_fxEventsCollection:{type:"object",version:"3.3.0",check:zl,optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},ar={b:{type:"number",version:"4.0.0",optional:!0},i:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Ri={b:{type:"number",version:"4.0.0",optional:!0},i:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},r:{type:"number",version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},xd={hb:{type:"number",version:"4.0.0",optional:!0},hr:{type:"number",version:"4.0.0",optional:!0},tb:{type:"number",version:"4.0.0",optional:!0},tr:{type:"number",version:"4.0.0",optional:!0},i:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},ci:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},ga={hb:{type:"number",version:"4.0.0",optional:!0},hi:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},hr:{type:"number",version:"4.0.0",optional:!0},tb:{type:"number",version:"4.0.0",optional:!0},ti:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},tr:{type:"number",version:"4.0.0",optional:!0},ai:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Id={x:{type:"number",int:!0,version:"4.0.0",optional:!0},y:{type:"number",int:!0,version:"4.0.0",optional:!0},a:{type:"number",int:!0,version:"4.0.0",optional:!0},c:{type:"number",int:!0,version:"4.0.0",optional:!0},d:{type:"number",int:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Nd={x:{type:"number",int:!0,version:"4.0.0",optional:!0},y:{type:"number",int:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Od={x:{type:"number",int:!0,version:"4.0.0",optional:!0},y:{type:"number",int:!0,version:"4.0.0",optional:!0},d:{type:"number",version:"4.0.0",optional:!0},w:{type:"number",int:!0,version:"4.0.0",optional:!0},h:{type:"number",int:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Ad={tx:{type:"number",int:!0,version:"4.0.0",optional:!0},ty:{type:"number",int:!0,version:"4.0.0",optional:!0},c:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},s:{type:"number",version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Pd={m:{type:"number",version:"4.0.0",optional:!0},tm:{type:"number",version:"4.0.0",optional:!0},a:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},$d={e:{type:"number",int:!0,version:"4.0.0",optional:!0},r:{type:"number",version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Md={version:{type:"string",version:"4.0.0"},colorNotes:{type:"object",array:!0,version:"4.0.0",check:Ri,optional:!0},bombNotes:{type:"object",array:!0,version:"4.0.0",check:Ri,optional:!0},obstacles:{type:"object",array:!0,version:"4.0.0",check:Ri,optional:!0},chains:{type:"object",array:!0,version:"4.0.0",check:xd,optional:!0},arcs:{type:"object",array:!0,version:"4.0.0",check:ga,optional:!0},spawnRotations:{type:"object",array:!0,version:"4.0.0",check:ga,optional:!0},colorNotesData:{type:"object",array:!0,version:"4.0.0",check:Id,optional:!0},bombNotesData:{type:"object",array:!0,version:"4.0.0",check:Nd,optional:!0},obstaclesData:{type:"object",array:!0,version:"4.0.0",check:Od,optional:!0},chainsData:{type:"object",array:!0,version:"4.0.0",check:Ad,optional:!0},arcsData:{type:"object",array:!0,version:"4.0.0",check:Pd,optional:!0},spawnRotationsData:{type:"object",array:!0,version:"4.0.0",check:$d,optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Fd={x:{type:"number",int:!0,version:"4.0.0",optional:!0},y:{type:"number",int:!0,version:"4.0.0",optional:!0},d:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},jd={t:{type:"number",int:!0,version:"4.0.0",optional:!0},i:{type:"number",int:!0,version:"4.0.0",optional:!0},f:{type:"number",version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},zd={b:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Vd={e:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},f:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},l:{type:"object",array:!0,version:"4.0.0",check:ar,optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Gd={t:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},b:{type:"number",version:"4.0.0",optional:!0},g:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},e:{type:"object",array:!0,version:"4.0.0",check:Vd,optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Hd={f:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},p:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},t:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},r:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},c:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},n:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},s:{type:"number",int:!0,version:"4.0.0",optional:!0},l:{type:"number",unsigned:!0,version:"4.0.0",optional:!0},d:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Ud={w:{type:"number",version:"4.0.0",optional:!0},d:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},s:{type:"number",version:"4.0.0",optional:!0},t:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},b:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},e:{type:"number",int:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Wd={p:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},c:{type:"number",int:!0,version:"4.0.0",optional:!0},e:{type:"number",int:!0,version:"4.0.0",optional:!0},b:{type:"number",version:"4.0.0",optional:!0},f:{type:"number",int:!0,version:"4.0.0",optional:!0},sb:{type:"number",version:"4.0.0",optional:!0},sf:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Yd={w:{type:"number",version:"4.0.0",optional:!0},d:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},s:{type:"number",version:"4.0.0",optional:!0},t:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},b:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},e:{type:"number",int:!0,version:"4.0.0",optional:!0},a:{type:"number",int:!0,version:"4.0.0",optional:!0},f:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Xd={p:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},e:{type:"number",int:!0,version:"4.0.0",optional:!0},l:{type:"number",int:!0,version:"4.0.0",optional:!0},r:{type:"number",version:"4.0.0",optional:!0},d:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},qd={w:{type:"number",version:"4.0.0",optional:!0},d:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},s:{type:"number",version:"4.0.0",optional:!0},t:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},b:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},e:{type:"number",int:!0,version:"4.0.0",optional:!0},a:{type:"number",int:!0,version:"4.0.0",optional:!0},f:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Kd={p:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},e:{type:"number",int:!0,version:"4.0.0",optional:!0},t:{type:"number",version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Zd={w:{type:"number",version:"4.0.0",optional:!0},d:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},s:{type:"number",version:"4.0.0",optional:!0},t:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},b:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},e:{type:"number",int:!0,version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Jd={p:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},e:{type:"number",int:!0,version:"4.0.0",optional:!0},v:{type:"number",version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},Qd={version:{type:"string",version:"4.0.0"},waypoints:{type:"object",array:!0,version:"4.0.0",check:Ri,optional:!0},waypointsData:{type:"object",array:!0,version:"4.0.0",check:Fd,optional:!0},basicEvents:{type:"object",array:!0,version:"4.0.0",check:ar,optional:!0},basicEventsData:{type:"object",array:!0,version:"4.0.0",check:jd,optional:!0},colorBoostEvents:{type:"object",array:!0,version:"4.0.0",check:ar,optional:!0},colorBoostEventsData:{type:"object",array:!0,version:"4.0.0",check:zd,optional:!0},eventBoxGroups:{type:"object",array:!0,version:"4.0.0",check:Gd,optional:!0},indexFilters:{type:"object",array:!0,version:"4.0.0",check:Hd,optional:!0},lightColorEventBoxes:{type:"object",array:!0,version:"4.0.0",check:Ud,optional:!0},lightColorEvents:{type:"object",array:!0,version:"4.0.0",check:Wd,optional:!0},lightRotationEventBoxes:{type:"object",array:!0,version:"4.0.0",check:Yd,optional:!0},lightRotationEvents:{type:"object",array:!0,version:"4.0.0",check:Xd,optional:!0},lightTranslationEventBoxes:{type:"object",array:!0,version:"4.0.0",check:qd,optional:!0},lightTranslationEvents:{type:"object",array:!0,version:"4.0.0",check:Kd,optional:!0},fxEventBoxes:{type:"object",array:!0,version:"4.0.0",check:Zd,optional:!0},floatFxEvents:{type:"object",array:!0,version:"4.0.0",check:Jd,optional:!0},basicEventTypesWithKeywords:{type:"object",version:"4.0.0",check:jl},useNormalEventsAsCompatibleEvents:{type:"boolean",version:"4.0.0",optional:!0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},t0={title:{type:"string",version:"4.0.0",optional:!0},subTitle:{type:"string",version:"4.0.0",optional:!0},author:{type:"string",version:"4.0.0",optional:!0}},e0={songFilename:{type:"string",version:"4.0.0",optional:!0},songDuration:{type:"number",version:"4.0.0",optional:!0},audioDataFilename:{type:"string",version:"4.0.0",optional:!0},bpm:{type:"number",version:"4.0.0"},lufs:{type:"number",version:"4.0.0"},previewStartTime:{type:"number",version:"4.0.0",optional:!0},previewDuration:{type:"number",version:"4.0.0",optional:!0}},n0={colorSchemeName:{type:"string",version:"4.0.0",optional:!0},saberAColor:{type:"string",version:"4.0.0",optional:!0},saberBColor:{type:"string",version:"4.0.0",optional:!0},obstaclesColor:{type:"string",version:"4.0.0",optional:!0},environmentColor0:{type:"string",version:"4.0.0",optional:!0},environmentColor1:{type:"string",version:"4.0.0",optional:!0},environmentColorW:{type:"string",version:"4.0.0",optional:!0},environmentColor0Boost:{type:"string",version:"4.0.0",optional:!0},environmentColor1Boost:{type:"string",version:"4.0.0",optional:!0},environmentColorWBoost:{type:"string",version:"4.0.0",optional:!0}},i0={mappers:{type:"string",array:!0,version:"4.0.0"},lighters:{type:"string",array:!0,version:"4.0.0"}},o0={characteristic:{type:"string",version:"4.0.0",optional:!0},difficulty:{type:"string",version:"4.0.0",optional:!0},beatmapAuthors:{type:"object",version:"4.0.0",check:i0},environmentNameIdx:{type:"number",int:!0,unsigned:!0,version:"4.0.0",optional:!0},beatmapColorSchemeIdx:{type:"number",int:!0,version:"4.0.0",optional:!0},noteJumpMovementSpeed:{type:"number",version:"4.0.0",optional:!0},noteJumpStartBeatOffset:{type:"number",version:"4.0.0",optional:!0},lightshowDataFilename:{type:"string",version:"4.0.0",optional:!0},beatmapDataFilename:{type:"string",version:"4.0.0"},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},r0={version:{type:"string",version:"4.0.0"},song:{type:"object",version:"4.0.0",check:t0},audio:{type:"object",version:"4.0.0",check:e0},songPreviewFilename:{type:"string",version:"4.0.0",optional:!0},coverImageFilename:{type:"string",version:"4.0.0",optional:!0},environmentNames:{type:"string",array:!0,version:"4.0.0"},colorSchemes:{type:"object",array:!0,version:"4.0.0",check:n0},difficultyBeatmaps:{type:"object",array:!0,version:"4.0.0",check:o0},customData:{type:"object",version:"4.0.0",check:{},optional:!0}},s0={si:{type:"number",version:"4.0.0",int:!0,unsigned:!0},ei:{type:"number",version:"4.0.0",int:!0,unsigned:!0},sb:{type:"number",version:"4.0.0"},eb:{type:"number",version:"4.0.0"}},a0={si:{type:"number",version:"4.0.0",int:!0,unsigned:!0},ei:{type:"number",version:"4.0.0",int:!0,unsigned:!0},l:{type:"number",version:"4.0.0"}},l0={version:{type:"string",version:"4.0.0"},songChecksum:{type:"string",version:"4.0.0"},songSampleCount:{type:"number",version:"4.0.0",int:!0,unsigned:!0},songFrequency:{type:"number",version:"4.0.0",int:!0,unsigned:!0},bpmData:{type:"object",version:"4.0.0",check:s0,array:!0},lufsData:{type:"object",version:"4.0.0",check:a0,array:!0}},u0={1:qp,2:ld,4:r0},c0={2:cd,4:l0},m0={1:Yp,2:id,3:Rd,4:Md},h0={3:Bd,4:Qd};function f0(t){return["validator",t]}const va={enabled:!0,throwOn:{unused:!1,missing:!0,ignoreOptional:!1,nullish:!0,wrongType:!0,notInt:!1,notUnsigned:!1}};function p0(t,e,n,i){const o={enabled:(i==null?void 0:i.enabled)??va.enabled,throwOn:{...va.throwOn,...i==null?void 0:i.throwOn}};let r={};switch(t){case"info":r=u0;break;case"audioData":r=c0;break;case"difficulty":r=m0;break;case"lightshow":r=h0;break}const l=xl(e)??Bl(t);return Z.tInfo(f0("validateJSON"),"Validating beatmap JSON for "+t+" with version",n),Li(e,r[n],t,l,o.throwOn),e}function vn(t){return["loader",t]}const Yn={forceConvert:!0,schemaCheck:{},sort:!0,preprocess:[],postprocess:[]};function Er(t,e,n,i={}){var v;const o={forceConvert:i.forceConvert??Yn.forceConvert,schemaCheck:{...Yn.schemaCheck,...i.schemaCheck},sort:i.sort??Yn.sort,preprocess:i.preprocess??Yn.preprocess,postprocess:i.postprocess??Yn.postprocess};let r,l,s;switch(t){case"info":r=St,l=jp,s=kp;break;case"audioData":r=_e,l=zp,s=Tp;break;case"difficulty":r=xe,l=Vp,s=fs;break;case"lightshow":r=xe,l=Gp,s=fs;break}o.preprocess.forEach((m,h)=>{Z.tInfo(vn("loadBeatmap"),"Running preprocess function #"+(h+1)),e=m(e)});const a=(v=xl(e))==null?void 0:v.at(0);let u;a?u=parseInt(a):(u=+Bl(t).at(0),Z.tWarn(vn("loadBeatmap"),"Could not identify beatmap version from JSON, assume implicit version",u));let c;const p=l[u];if(p)o.schemaCheck.enabled&&p0(t,e,u,o.schemaCheck),c=new r(p.deserialize(e));else throw new Error(`Beatmap version ${u} is not supported, this may be an error in JSON or is newer than currently supported.`);if(n&&u!==n){if(!o.forceConvert)throw new Error(`Beatmap version unmatched, expected ${n} but received ${u}`);Z.tWarn(vn("loadBeatmap"),"Beatmap version unmatched, expected",n,"but received",u,"for version; Converting to beatmap version",n),c=s[n](c,c.version)}return o.sort&&c.sort(),o.postprocess.forEach((m,h)=>{Z.tInfo(vn("loadBeatmap"),"Running postprocess function #"+(h+1)),c=m(c)}),c}function d0(t,e,n){const i=typeof e=="number"?e:null,o=(typeof e!="number"?e:n)??{};return Z.tInfo(vn("loadDifficulty"),"Loading difficulty from JSON"),Er("difficulty",t,i,o)}function b0(t,e,n){const i=typeof e=="number"?e:null,o=(typeof e!="number"?e:n)??{};return Z.tInfo(vn("loadInfo"),"Loading info from JSON"),Er("info",t,i,o)}function g0(t,e,n){const i=typeof e=="number"?e:null,o=(typeof e!="number"?e:n)??{};return Z.tInfo(vn("loadLightshow"),"Loading lightshow from JSON"),Er("lightshow",t,i,o)}const lr={DefaultEnvironment:"The First",OriginsEnvironment:"Origins",TriangleEnvironment:"Triangle",NiceEnvironment:"Nice",BigMirrorEnvironment:"Big Mirror",DragonsEnvironment:"Dragons",KDAEnvironment:"K/DA",MonstercatEnvironment:"Monstercat",CrabRaveEnvironment:"Crab Rave",PanicEnvironment:"Panic",RocketEnvironment:"Rocket",GreenDayEnvironment:"Green Day",GreenDayGrenadeEnvironment:"Green Day Grenade",TimbalandEnvironment:"Timbaland",FitBeatEnvironment:"FitBeat",LinkinParkEnvironment:"Linkin Park",BTSEnvironment:"BTS",KaleidoscopeEnvironment:"Kaleidoscope",InterscopeEnvironment:"Interscope",SkrillexEnvironment:"Skrillex",BillieEnvironment:"Billie",HalloweenEnvironment:"Spooky",GagaEnvironment:"Gaga",WeaveEnvironment:"Weave",PyroEnvironment:"Pyro",EDMEnvironment:"EDM",TheSecondEnvironment:"The Second",LizzoEnvironment:"Lizzo",TheWeekndEnvironment:"The Weeknd",RockMixtapeEnvironment:"Rock Mixtape",Dragons2Environment:"Dragons 2.0",Panic2Environment:"Panic 2.0",QueenEnvironment:"Queen",LinkinPark2Environment:"Linkin Park 2.0",TheRollingStonesEnvironment:"The Rolling Stones",LatticeEnvironment:"Lattice",DaftPunkEnvironment:"Daft Punk",HipHopEnvironment:"Hip Hop Mixtape",ColliderEnvironment:"Collider",GlassDesertEnvironment:"Glass Desert",MultiplayerEnvironment:"Origins",BritneyEnvironment:"Britney Spears"},Dn={DefaultEnvironment:[[0,1,2,3,4,8,9,12,13],[]],OriginsEnvironment:[[0,1,2,3,4,8,9,12,13],[]],TriangleEnvironment:[[0,1,2,3,4,8,9,12,13],[]],NiceEnvironment:[[0,1,2,3,4,8,9,12,13],[]],BigMirrorEnvironment:[[0,1,2,3,4,8,9,12,13],[]],DragonsEnvironment:[[0,1,2,3,4,8,9,12,13],[]],KDAEnvironment:[[0,1,2,3,4,8,9,12,13],[]],MonstercatEnvironment:[[0,1,2,3,4,8,9,12,13],[]],CrabRaveEnvironment:[[0,1,2,3,4,8,9,12,13],[]],PanicEnvironment:[[0,1,2,3,4,8,9,12,13],[]],RocketEnvironment:[[0,1,2,3,4,8,9,12,13],[]],GreenDayEnvironment:[[0,1,2,3,4,8,9,12,13],[]],GreenDayGrenadeEnvironment:[[0,1,2,3,4,8,9,12,13],[]],TimbalandEnvironment:[[0,1,2,3,4,8,9,12,13],[]],FitBeatEnvironment:[[0,1,2,3,4,8,9,12,13],[]],LinkinParkEnvironment:[[0,1,2,3,4,8,9,12,13],[]],BTSEnvironment:[[0,1,2,3,4,8,9,12,13],[]],KaleidoscopeEnvironment:[[0,1,2,3,4,8,9,12,13],[]],InterscopeEnvironment:[[0,1,2,3,4,6,7,8,9,12,13,16,17],[]],SkrillexEnvironment:[[0,1,2,3,4,6,7,8,9,12,13],[]],BillieEnvironment:[[0,1,2,3,4,6,7,8,9,10,11,12,13],[]],HalloweenEnvironment:[[0,1,2,3,4,8,9,12,13],[]],GagaEnvironment:[[0,1,2,3,4,6,7,8,9,10,11,12,13,16,17],[]],GlassDesertEnvironment:[[0,1,2,3,4,8,9,12,13],[]],MultiplayerEnvironment:[[4],[]],WeaveEnvironment:[[],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]],PyroEnvironment:[[0,1,2,3,4,6,40],[0,1,2,3,4,5,6,7,8,9,10,11,12,13]],EDMEnvironment:[[0,1,4],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]],TheSecondEnvironment:[[0,1,2,3,4,9],[0,1,2,3,4,5,6,7,8,9,10,11,12,13]],LizzoEnvironment:[[0,1,2,3,4,6,7,8,9,10,11,12,16,17],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]],TheWeekndEnvironment:[[0,1,6],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,29,30,31,32,33,34,35,36,37,38,40]],RockMixtapeEnvironment:[[3,4,6],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37]],Dragons2Environment:[[0,1,2,3,4,6],[0,1,2,3,4,5,6,7,8,9,10,11,12]],Panic2Environment:[[3],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23]],QueenEnvironment:[[6,40],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]],LinkinPark2Environment:[[3,40,41],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]],TheRollingStonesEnvironment:[[6,40],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45]],LatticeEnvironment:[[6],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30]],DaftPunkEnvironment:[[6,40,41,42,43],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55]],HipHopEnvironment:[[6],[0,1,2,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41]],ColliderEnvironment:[[6],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27]],BritneyEnvironment:[[6,8,9,12],[0,1,2,3,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22]]},v0={},_0=Object.freeze(Object.defineProperty({__proto__:null,default:v0},Symbol.toStringTag,{value:"Module"}));function _a(){throw new Error("`path` function not provided; please supply `path` function inside the `path` object from the module")}const xn=_0,y0={resolve:(xn==null?void 0:xn.resolve)||_a,basename:(xn==null?void 0:xn.basename)||_a};function di(){throw new Error("`fs` function not provided; please supply `fs` function inside the `fs` object from the module")}typeof Deno<"u"?(Deno.readTextFile,Deno.readTextFileSync,Deno.writeTextFile,Deno.writeTextFileSync):typeof Bun<"u"&&Bun.write;var ya=function(t,e,n,i){if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?i:n==="a"?i.call(t):i?i.value:e.get(t)},E0=function(t,e,n,i,o){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!o:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?o.call(t,n):o?o.value=n:e.set(t,n),n},qn;function w0(t){return["globals",t]}class D0{constructor(){qn.set(this,"./")}get directory(){return ya(this,qn,"f")}set directory(e){e=y0.resolve(e.trim()),E0(this,qn,e,"f"),Z.tInfo(w0("directory"),`Global map directory is set to ${ya(this,qn,"f")}`)}}qn=new WeakMap;new D0;const Io=document.querySelector(".info__level-author"),Ea=document.querySelector(".info__environment"),No=document.querySelector(".info__editors"),wa=document.querySelector(".info__contributors");document.querySelector(".info__contributors-image");document.querySelector(".info__contributors-name");document.querySelector(".info__contributors-role");const bi=document.querySelector(".info__contributors-list");function Vl(t,e){if(!t){Io.textContent="";return}e!=null&&e.length?Io.textContent="Mapped by "+t.join(", ")+" and lit by "+e.join(", "):Io.textContent="Mapped by "+t.join(", ")}function Gl(t){if(!t){Ea.textContent="";return}Ea.textContent=t.map(e=>(lr[e]||`Unknown (${e})`)+" Environment").join(", ")}function Hl(t){if(!t||!t._lastEditedBy){No.classList.add("hidden");return}No.classList.remove("hidden");const e=t._lastEditedBy||"Undefined";let n="Last edited on "+e;if(t[e]){const i=t[e];n+=" v"+i.version}No.textContent=n}function Ul(t){for(;bi.firstChild;)bi.removeChild(bi.firstChild);if(!t||!t.length){wa.classList.add("hidden");return}wa.classList.remove("hidden"),t.forEach((e,n)=>{const i=document.createElement("div");i.classList.add("info__contributors-card");const o=document.createElement("img");o.classList.add("info__contributors-image"),o.src=e._base64?"data:image;base64,"+e._base64:"./img/unknown.jpg",o.alt="contributor image: "+e._name;const r=document.createElement("div");r.classList.add("info__contributors-content");const l=document.createElement("span");l.classList.add("info__contributors-name"),l.textContent=e._name;const s=document.createElement("span");s.classList.add("info__contributors-role"),s.textContent=e._role,r.appendChild(l),r.appendChild(document.createElement("br")),r.appendChild(s),i.appendChild(o),i.appendChild(r),bi.appendChild(i)})}const In={version:6,load:{audio:!0,imageCover:!0,imageContributor:!0},sorting:!0,beatNumbering:"beattime",infoRowCount:5,rounding:3,dataCheck:!0,deduplicateTime:!0,theme:"Dark",show:"info",checks:{persistent:!0,preset:"Default"},aprilFooled:1},tt=new class{constructor(){this.props=N(In),this.init()}get version(){return this.props.version}get load(){return this.props.load}get sorting(){return this.props.sorting}set sorting(e){this.props.sorting=e}get beatNumbering(){return this.props.beatNumbering}set beatNumbering(e){this.props.beatNumbering=e}get infoRowCount(){return this.props.infoRowCount}set infoRowCount(e){this.props.infoRowCount=e}get rounding(){return this.props.rounding}set rounding(e){this.props.rounding=e}get dataCheck(){return this.props.dataCheck}set dataCheck(e){this.props.dataCheck=e}get deduplicateTime(){return this.props.deduplicateTime}set deduplicateTime(e){this.props.deduplicateTime=e}get theme(){return this.props.theme}set theme(e){this.props.theme=e}get show(){return this.props.show}set show(e){this.props.show=e}get checks(){return this.props.checks}set checks(e){this.props.checks=e}get aprilFooled(){return this.props.aprilFooled}set aprilFooled(e){this.props.aprilFooled=e}init(){if(localStorage==null)return;const e=localStorage.getItem("settings");if(e){const n=JSON.parse(e);if(!n.version){this.clear();return}this.props=n??this.props;for(const i in In){const o=i;typeof this.props[o]!=typeof In[o]&&(this.props[o]=In[o])}this.props.version=In.version,this.save()}}save(){localStorage&&localStorage.setItem("settings",JSON.stringify(this.props))}clear(){localStorage&&localStorage.clear()}reset(){this.props=N(In)}},Da=document.querySelector(".info__version"),Sa=document.querySelector(".info__mappers"),Ca=document.querySelector(".info__lighters"),ka=document.querySelector(".info__environmentId"),Ta=document.querySelector(".info__play-time"),La=document.querySelector(".info__time-spend"),Ra=document.querySelector(".info__color-scheme"),Ba=document.querySelector(".info__custom-color"),xa=document.querySelector(".info__requirements"),Ia=document.querySelector(".info__suggestions"),Na=document.querySelector(".info__information"),Oa=document.querySelector(".info__warnings"),Aa=document.querySelector(".info__bookmarks"),Pa=document.querySelector(".info__bpm-changes"),$a=document.querySelector(".info__environment-enhancement"),Ma=document.querySelector(".info__point-definitions"),Fa=document.querySelector(".info__custom-events");document.querySelectorAll(".info__table-element");document.querySelectorAll(".info__table-contents");function Ft(t){const e=t.querySelector(".info__table-element"),n=e==null?void 0:e.querySelector(".info__table-content");n&&(n.innerHTML=""),t.classList.add("hidden")}let Gt={};function S0(t,e){t.textContent=e}function C0(t,e){const n=Gt[t];return function(){n.page++,n.page*tt.infoRowCount>=n.content.length&&(n.page=0),e()}}function k0(t,e){const n=Gt[t];return function(){n.page--,n.page<0&&(n.page=Math.ceil(n.content.length/tt.infoRowCount)-1),e()}}function T0(t,e){const n=Gt[t];return function(){const o=n.content.slice(n.page*tt.infoRowCount,n.page*tt.infoRowCount+tt.infoRowCount);for(S0(e,`${n.page+1} / ${Math.ceil(n.content.length/tt.infoRowCount)}`);n.html.firstChild;)n.html.removeChild(n.html.firstChild);o.forEach(r=>{if(typeof r=="string"){const l=document.createElement("div");l.textContent=r,n.html.appendChild(l)}else n.html.appendChild(r)})}}function jt(t,e,n=""){const i=t.querySelector(".info__table-element");if(!i)return;const o=i.querySelector(".info__table-content");if(o){for(;o.firstChild;)o.removeChild(o.firstChild);if(typeof e=="string")o.textContent=e;else if(n){const r=i.querySelector(".info__table-paginate-button--next"),l=i.querySelector(".info__table-paginate-button--prev"),s=i.querySelector(".info__table-paginate-total");s.textContent=`${e.length}`;const a=i.querySelector(".info__table-paginate-page");n in Gt&&(r.removeEventListener("click",Gt[n].nextCb),l.removeEventListener("click",Gt[n].prevCb)),Gt[n]={content:e,html:o,page:0,nextCb:null,prevCb:null,cb:null},Gt[n].cb=T0(n,a);const u=C0(n,Gt[n].cb),c=k0(n,Gt[n].cb);r&&(r.addEventListener("click",u),Gt[n].nextCb=u),l&&(l.addEventListener("click",c),Gt[n].prevCb=c),Gt[n].cb()}else{for(;o.firstChild;)o.removeChild(o.firstChild);e.forEach(r=>{if(typeof r=="string"){const l=document.createElement("div");l.textContent=r,o.appendChild(l)}else o.appendChild(r)})}}t.classList.remove("hidden")}function Wl(){Object.keys(Gt).forEach(t=>{var e,n;Gt[t].page=0,(n=(e=Gt[t]).cb)==null||n.call(e)})}function Yl(t,e){if(t==null||!t.length){Ft(Aa);return}const n=[];t.forEach((i,o)=>{let r=i.b??i._time??0,l;const s=document.createElement("div"),a=document.createElement("div"),u=document.createElement("div");s.appendChild(a),s.appendChild(u),s.className="info__color",a.className="info__color-dot",a.style.backgroundColor="#000000",u.className="info__color-text";const c=i.n??i._name;typeof c!="string"&&(u.textContent=`Error parsing bookmarks[${o}]`,n.push(s)),e&&(r=e.adjustTime(r),l=e.toRealTime(r));const p=i.c??i._color;a.style.backgroundColor=p?ft({r:p[0],g:p[1],b:p[2]}):"#333333",u.textContent=`${M(r,tt.rounding)}${l?" | "+Jt(l):""} -- ${c!=""?c:"**EMPTY NAME**"}`,n.push(s)}),jt(Aa,n,"bookmarks")}function Xl(t){if(!t||!t.change.length){Ft(Pa);return}const e=t.change.map(n=>{const i=M(n.newTime,tt.rounding),o=t.toRealTime(n.time);return`${i} | ${Jt(o)} -- ${n.BPM}`});jt(Pa,e,"bpmChanges")}function ql(t,e){var u,c,p,v,m,h,d;if(!t||!t._colorLeft&&!t._colorRight&&!t._envColorLeft&&!t._envColorLeftBoost&&!t._envColorRight&&!t._envColorRightBoost&&!t._envColorWhite&&!t._envColorWhiteBoost&&!t._obstacleColor){Ft(Ba);return}e||(e="DefaultEnvironment");const n={_colorLeft:((u=we[Ee[e]])==null?void 0:u._colorLeft)||null,_colorRight:((c=we[Ee[e]])==null?void 0:c._colorRight)||null,_envColorLeft:((p=we[Ee[e]])==null?void 0:p._envColorLeft)||null,_envColorRight:((v=we[Ee[e]])==null?void 0:v._envColorRight)||null,_envColorWhite:null,_envColorLeftBoost:((m=we[Ee[e]])==null?void 0:m._envColorLeftBoost)||null,_envColorRightBoost:((h=we[Ee[e]])==null?void 0:h._envColorRightBoost)||null,_envColorWhiteBoost:null,_obstacleColor:((d=we[Ee[e]])==null?void 0:d._obstacleColor)||null},i={_colorLeft:n._colorLeft?ft(n._colorLeft):null,_colorRight:n._colorRight?ft(n._colorRight):null,_envColorLeft:n._envColorLeft?ft(n._envColorLeft):null,_envColorRight:n._envColorRight?ft(n._envColorRight):null,_envColorWhite:null,_envColorLeftBoost:n._envColorLeftBoost?ft(n._envColorLeftBoost):null,_envColorRightBoost:n._envColorRightBoost?ft(n._envColorRightBoost):null,_envColorWhiteBoost:null,_obstacleColor:n._obstacleColor?ft(n._obstacleColor):null},o={noteColor:!!(t._colorLeft||t._colorRight),eventColor:!!(t._envColorLeft||t._envColorRight),eventBoostColor:!!(t._envColorLeftBoost||t._envColorRightBoost),obstacleColor:!!t._obstacleColor};t._colorLeft&&(i._colorLeft=ft(t._colorLeft)),t._colorRight&&(i._colorRight=ft(t._colorRight)),t._envColorLeft?i._envColorLeft=ft(t._envColorLeft):t._colorLeft&&(i._envColorLeft=ft(t._colorLeft)),t._envColorRight?i._envColorRight=ft(t._envColorRight):t._colorRight&&(i._envColorRight=ft(t._colorRight));let r,l,s=!1;t._envColorLeftBoost?(r=ft(t._envColorLeftBoost),s=!0):r=n._envColorLeftBoost?ft(n._envColorLeftBoost):i._envColorLeft,t._envColorRightBoost?(l=ft(t._envColorRightBoost),s=!0):l=n._envColorRightBoost?ft(n._envColorRightBoost):i._envColorRight,t._envColorWhite&&(i._envColorWhite=ft(t._envColorWhite)),t._envColorWhiteBoost&&(i._envColorWhiteBoost=ft(t._envColorWhiteBoost)),s&&(i._envColorLeftBoost=r,i._envColorRightBoost=l),t._obstacleColor&&(i._obstacleColor=ft(t._obstacleColor)),o.noteColor||(i._colorLeft=null,i._colorRight=null),o.eventColor||(i._envColorLeft=null,i._envColorRight=null),o.noteColor&&!o.eventColor&&(i._envColorLeft=i._colorLeft,i._envColorRight=i._colorRight),o.obstacleColor||(i._obstacleColor=null);const a=[];for(const y in i){if(!i[y])continue;const g=document.createElement("div"),_=document.createElement("div"),D=document.createElement("div"),C=document.createElement("div");g.className="info__color",_.className="info__color-dot",_.style.backgroundColor=i[y]||"#000000",D.className="info__color-text info__color-text--monospace",D.textContent=`${i[y]}`,C.className="info__color-text",C.textContent=` -- ${Gf[y]}`,g.appendChild(_),g.appendChild(D),g.appendChild(C),a.push(g)}jt(Ba,a)}class L0{constructor(){Object.defineProperty(this,"_regex",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"_string",{enumerable:!0,configurable:!0,writable:!0,value:""})}get regex(){return this._regex}get string(){return this._string}}class gi extends L0{constructor(e){super(),Object.defineProperty(this,"hasNested",{enumerable:!0,configurable:!0,writable:!0,value:!1}),e&&(this._string=e,this._regex=e)}static create(e){return e?new this(e):new this}name(e){return this._string+=e.trim(),this._regex+=e.trim(),this}id(e,n){return e!==null?(n?this._regex+=`( \\(${e}\\))?`:this._regex+=` \\(${e}\\)`,this._string+=` (${e})`):(n?this._regex+="( \\(\\d+\\))?":this._regex+=" \\(\\d+\\)",this._string+=" (1)"),this}space(e=1){for(let n=0;n<e;n++)this._string+=" ",this._regex+=" ";return this}clone(e=1){for(let n=0;n<e;n++)this._string+=" (Clone)",this._regex+=" \\(Clone\\)";return this}end(){return this._regex+="$",this}child(e){return this._string+=`.[${typeof e=="number"?e:1}]`,this._regex+=`\\.\\[${typeof e=="number"?e:"\\d+"}\\]`,this}}Object.defineProperty(gi,"Preset",{enumerable:!0,configurable:!0,writable:!0,value:{ENVIRONMENT:new gi().child().name("Environment").end(),CONSTRUCTION:new gi("Environment").child().name("Construction").end(),SMOKE:new gi().child().name("BigSmokePS").end()}});var ur;(function(t){t.forehand="backhand",t.backhand="forehand"})(ur||(ur={}));function Kl(t,e,n){return t.direction===B.ANY&&e.direction===B.ANY&&n!==B.ANY&&(t.posX>e.posX&&(n===B.UP_RIGHT||n===B.RIGHT||n===B.DOWN_RIGHT)||t.posX<e.posX&&(n===B.DOWN_LEFT||n===B.LEFT||n===B.UP_LEFT)||t.posY>e.posY&&(n===B.UP_LEFT||n===B.UP||n===B.UP_RIGHT)||t.posY<e.posY&&(n===B.DOWN_LEFT||n===B.DOWN||n===B.DOWN_RIGHT))||t.posX>e.posX&&(t.direction===B.UP_RIGHT||t.direction===B.RIGHT||t.direction===B.DOWN_RIGHT||(e.direction===B.UP_RIGHT||e.direction===B.RIGHT||e.direction===B.DOWN_RIGHT)&&t.direction===B.ANY)||t.posX<e.posX&&(t.direction===B.DOWN_LEFT||t.direction===B.LEFT||t.direction===B.UP_LEFT||(e.direction===B.DOWN_LEFT||e.direction===B.LEFT||e.direction===B.UP_LEFT)&&t.direction===B.ANY)||t.posY>e.posY&&(t.direction===B.UP_LEFT||t.direction===B.UP||t.direction===B.UP_RIGHT||(e.direction===B.UP_LEFT||e.direction===B.UP||e.direction===B.UP_RIGHT)&&t.direction===B.ANY)||t.posY<e.posY&&(t.direction===B.DOWN_LEFT||t.direction===B.DOWN||t.direction===B.DOWN_RIGHT||(e.direction===B.DOWN_LEFT||e.direction===B.DOWN||e.direction===B.DOWN_RIGHT)&&t.direction===B.ANY)}function cr(t,e,n,i=!1){const[o,r]=t.getPosition(),[l,s]=e.getPosition(),a=i?540:360;let u=!1;if(t.direction!==8){const p=t.getAngle(),v=(Qo(Math.atan2(r-s,o-l))+450)%360;for(const[m,h,d]of n){const y=d??0,g=(p+a-m+y)%360,_=(p+a+m+y)%360;if(u=h>=Math.sqrt(Math.pow(o-l,2)+Math.pow(r-s,2))&&(g<_&&g<=v&&v<=_||g>=_&&(v<=_||v>=g))||u,u)break}}let c=!1;if(e instanceof Wt&&e.direction!==8){const p=e.getAngle(),v=(Qo(Math.atan2(s-r,l-o))+450)%360;for(const[m,h,d]of n){const y=d??0,g=(p+a-m+y)%360,_=(p+a+m+y)%360;if(c=h>=Math.sqrt(Math.pow(o-l,2)+Math.pow(r-s,2))&&(g<_&&g<=v&&v<=_||g>=_&&(v<=_||v>=g))||c,c)break}}return[u,c]}function ja(t,e){if(Kl(t,e,B.ANY))return t.direction===B.ANY?e.direction:t.direction;if(t.direction!==B.ANY)return t.direction;if(t.time>e.time){if(t.posX>e.posX&&t.isHorizontal(e))return B.RIGHT;if(t.posX<e.posX&&t.isHorizontal(e))return B.LEFT;if(t.posY>e.posY){if(t.isVertical(e))return B.UP;if(t.posX>e.posX)return B.UP_RIGHT;if(t.posX<e.posX)return B.UP_LEFT}if(t.posY<e.posY){if(t.isVertical(e))return B.DOWN;if(t.posX>e.posX)return B.DOWN_RIGHT;if(t.posX<e.posX)return B.DOWN_LEFT}}return B.ANY}function ei(t,e,n,i){let o,r;if(t===null||e===null)return!1;if(typeof t=="number")o=t;else{if(t.direction===B.ANY)return!1;o=t.getAngle()}if(typeof e=="number")r=e;else{if(e.direction===B.ANY)return!1;r=e.getAngle()}return i?Wr(o,r,360)<=n:Wr(o,r,360)>=n}const vi={[ot.RED]:{forehand:[B.DOWN,B.RIGHT,B.DOWN_LEFT,B.DOWN_RIGHT],backhand:[B.UP,B.LEFT,B.UP_LEFT,B.UP_RIGHT]},[ot.BLUE]:{forehand:[B.DOWN,B.LEFT,B.DOWN_LEFT,B.DOWN_RIGHT],backhand:[B.UP,B.RIGHT,B.UP_LEFT,B.UP_RIGHT]}},pn={[ot.RED]:[0,0,90,90,45,-45,45,-45],[ot.BLUE]:[0,0,-90,-90,-45,45,-45,45]},za={0:{forehand:[180,0,-90,90,-135,135,-45,45],backhand:[0,180,90,-90,45,-45,135,-135]},1:{forehand:[-180,0,-90,90,-135,135,-45,45],backhand:[0,-180,90,-90,45,-45,135,-135]}};class nn{constructor(e,n,i,o,r,l,s){Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"rotation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"position",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"warningThreshold",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"errorThreshold",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"allowedRotation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.color=i,this.warningThreshold=o,this.errorThreshold=r,this.allowedRotation=l,s&&s!=="neutral"?(this.state=s,this.rotation=0):(this.state=this.predictStartState(e,n,i),this.rotation=this.predictStartRotation(e,i)),this.position=this.predictStartPosition(e,i)}check(e,n){if(this.state==="neutral")return"none";if(!e.length)throw new Error("no notes were given");const i=e[0].time,o=this.color;let r=this.state,l=this.rotation;n.forEach(c=>{c.time-.001>i||(c.posY===Rt.BOTTOM&&c.posX===(o?ut.MIDDLE_RIGHT:ut.MIDDLE_LEFT)&&(r="backhand",l=0),c.posY===Rt.TOP&&c.posX===(o?ut.MIDDLE_RIGHT:ut.MIDDLE_LEFT)&&(r="forehand",l=0))});let s,a=B.ANY;for(const c of e)c.direction!==B.ANY&&(a=c.direction),s&&a===B.ANY&&(a=ja(c,s)),s=c;if(a===B.ANY)return"none";const u=za[o][ur[r]][a];return(l>u?l-u:u-l)>180||u<nn.CONSTRAINT_ROTATION[o][0]+this.errorThreshold||u>nn.CONSTRAINT_ROTATION[o][1]-this.errorThreshold?"error":u<nn.CONSTRAINT_ROTATION[o][0]+this.warningThreshold||u>nn.CONSTRAINT_ROTATION[o][1]-this.warningThreshold||(l>u?l-u:u-l)>this.allowedRotation?"warning":"none"}next(e,n){if(this.check(e,n)!=="error")switch(this.state){case"forehand":{this.state="backhand";break}case"backhand":{this.state="forehand";break}case"neutral":{for(let s=0;s<e.length;s++){const a=e[s];if(vi[a.color].forehand.includes(a.direction)){this.state="backhand";break}if(vi[a.color].backhand.includes(a.direction)){this.state="forehand";break}this.state==="neutral"&&a.direction===B.ANY&&(a.posY===0&&(this.state="backhand"),a.posY>0&&(this.state="forehand"))}break}}if(this.state==="neutral")throw new Error("parity unexpected input");const i=e[0].time,o=this.color;n.forEach(s=>{s.time-.001>i||(s.posY===Rt.BOTTOM&&s.posX===(o?ut.MIDDLE_RIGHT:ut.MIDDLE_LEFT)&&(this.state="forehand",this.rotation=0),s.posY===Rt.TOP&&s.posX===(o?ut.MIDDLE_RIGHT:ut.MIDDLE_LEFT)&&(this.state="backhand",this.rotation=0))});let r,l=B.ANY;for(const s of e)s.direction!==B.ANY&&(l=s.direction),r&&l===B.ANY&&(l=ja(s,r)),r=s;l!==B.ANY&&(this.rotation=za[this.color][this.state][l])}predictStartState(e,n,i){const o=[...e,...n].sort((l,s)=>l.time-s.time);let r="neutral";for(let l=0,s=o.length;l<s;l++){if(o[l]instanceof De){o[l].posY===Rt.BOTTOM&&(o[l].posX===i?ut.MIDDLE_RIGHT:ut.MIDDLE_LEFT)&&(r="backhand"),o[l].posY===Rt.TOP&&(o[l].posX===i?ut.MIDDLE_RIGHT:ut.MIDDLE_LEFT)&&(r="forehand");continue}let a=o[l];if(a.color!==Math.abs(i-1)&&a.color===i){if(r!=="neutral")break;const u=a.time;for(let c=l;c<o.length&&!(o[c].time>a.time+.001&&u<a.time+.001);c++){if(a=o[c],vi[a.color].forehand.includes(a.direction))return"backhand";if(vi[a.color].backhand.includes(a.direction))return"forehand";r==="neutral"&&a.direction===B.ANY&&(a.posY===Rt.BOTTOM&&(r="backhand"),a.posY>Rt.BOTTOM&&(r="forehand"))}break}}return r}predictStartRotation(e,n){let i=0;for(let o=0,r=e.length;o<r;o++){let l=e[o];if(l.color===n&&l.color===n){const s=l.time;for(let a=o;a<e.length&&!(e[a].time>l.time+.001&&s<l.time+.001);a++){if(l=e[a],l.direction!==B.ANY)return pn[l.color][l.direction];l.direction===B.ANY&&(l.posY===Rt.BOTTOM&&(l.posX===ut.LEFT&&(i=pn[l.color][6]),l.posX===ut.RIGHT&&(i=pn[l.color][7])),l.posY===Rt.MIDDLE&&(l.posX===ut.LEFT&&(i=pn[l.color][2]),l.posX===ut.RIGHT&&(i=pn[l.color][3])),l.posY===Rt.BOTTOM&&(l.posX===ut.LEFT&&(i=pn[l.color][4]),l.posX===ut.RIGHT&&(i=pn[l.color][5])))}break}}return i}predictStartPosition(e,n){return n?[-.5,1]:[.5,1]}}Object.defineProperty(nn,"CONSTRAINT_ROTATION",{enumerable:!0,configurable:!0,writable:!0,value:[[-155,195],[-195,155]]});var mr;(function(t){t.duplicate="D",t.active="A",t.scale="S",t.position="P",t.localPosition="Lp",t.rotation="R",t.localRotation="Lr",t.lightID="Li",t.track="T"})(mr||(mr={}));var hr;(function(t){t.childrenTracks="Ct",t.color="C",t.definitePosition="Dp",t.dissolve="D",t.dissolveArrow="Da",t.duration="Dur",t.easing="E",t.interactable="I",t.localRotation="Lr",t.parentTrack="Pt",t.position="P",t.rotation="R",t.scale="S",t.time="T",t.track="Tr",t.worldPositionStays="Wps"})(hr||(hr={}));const R0={0:"Back Lasers",1:"Ring Lights",2:"Left Lasers",3:"Right Lasers",4:"Center Lights",5:"Boost Colors",6:"Extra Left Lights",7:"Extra Right Lights",8:"Ring Rotation",9:"Ring Zoom",10:"Extra Left Lasers",11:"Extra Right Lasers",12:"Left Laser Speed",13:"Right Laser Speed",14:"Early Lane Rotation",15:"Late Lane Rotation",16:"Utility Event 1",17:"Utility Event 2",18:"Utility Event 3",19:"Utility Event 4",40:"Special Event 1",41:"Special Event 2",42:"Special Event 3",43:"Special Event 4"},B0={LinkinParkEnvironment:{0:"Lane Light",1:"Ceiling Lights",8:"Laser Mode"},BTSEnvironment:{0:"Door Light",1:"Vertical Pillar Lights",8:"Distant Tower Spin",9:"Raise/Lower Pillars",40:"BTS Event 1",41:"BTS Event 2",42:"BTS Event 3",43:"BTS Event 4"},KaleidoscopeEnvironment:{0:"Spike Tip Lights",1:"Spike Mid Lights",2:"Spike Left Lights",3:"Spike Right Lights",4:"Distant Lasers and Spike Top Lights"},InterscopeEnvironment:{0:"Gate 1",1:"Gate 2",2:"Gate 3",3:"Gate 4",4:"Gate 5",6:"Extra 1",7:"Extra 2"},SkrillexEnvironment:{0:"Logo",1:"Top Lanes and 1st Ring Set",4:"Bottom Lanes and 2nd Ring Set",6:"Left Panel",7:"Right Panel",12:"Left Laser & Panel Speed",13:"Right Laser & Panel Speed"},BillieEnvironment:{0:"Water 4",1:"Water 1",2:"Left Sun Beams",3:"Right Sun Beams",4:"Sun",6:"Water 2",7:"Water 3",8:"Toggle Rain",9:"Sunbeam Mode",10:"Left Bottom Lasers",11:"Right Bottom Lasers",12:"Left Sun Beams Speed",13:"Right Sun Beams Speed"},HalloweenEnvironment:{0:"Sky Lasers",1:"Moon",4:"Lane + Castle Interior"},GagaEnvironment:{0:"Aurora 1",1:"Aurora 2",2:"Tower 1",3:"Tower 2",4:"Logo",6:"Tower 3",7:"Tower 4",10:"Tower 5",11:"Tower 6",14:"Tower 1 Height",15:"Tower 2 Height",16:"Tower 3 Height",17:"Tower 4 Height",18:"Tower 5 Height",19:"Tower 6 Height"},WeaveEnvironment:{4:"Player Space"},PyroEnvironment:{0:"Video Alpha",1:"Logo",2:"Left Projectors",3:"Right Projectors",4:"Platform",6:"Ambient",40:"Video Projection"},EDMEnvironment:{0:"Lane Lights Bottom",1:"Lane Lights Top",4:"Player Space & Spectrogram"},TheSecondEnvironment:{0:"Logo",1:"Runway",2:"Left Flags",3:"Right Flags",4:"Buildings"},LizzoEnvironment:{0:"Runway Left",1:"Runway Right",2:"Left Ring",3:"Right Ring",4:"Top Square",6:"Ambient",7:"Cherry Left",8:"Cherry Right",9:"LI Sign",10:"Z Left Sign",11:"Z Right Sign",12:"O Sign",16:"Left Balloon Particles",17:"Right Balloon Particles"},TheWeekndEnvironment:{0:"Runway Left",1:"Runway Right",6:"Ambient"},RockMixtapeEnvironment:{3:"BG Bloom",4:"Aurora",6:"Ambient"},Dragons2Environment:{0:"Inner Laser Left",1:"Inner Laser Right",2:"Outer Laser Left",3:"Outer Laser Right",4:"Logo",6:"Ambient"},Panic2Environment:{3:"Ambient"},QueenEnvironment:{6:"Ambient",40:"Silhouettes"},LinkinPark2Environment:{3:"Ambient",40:"Logos",41:"Floor Logos"},TheRollingStonesEnvironment:{6:"Ambient",40:"Logo"},LatticeEnvironment:{6:"Ambient"},DaftPunkEnvironment:{6:"Ambient",40:"Helmet 01 Switch",41:"Helmet 02 Switch",42:"Helmet 01 Text",43:"Helmet 02 Text"},HipHopEnvironment:{6:"Ambient"},ColliderEnvironment:{6:"Ambient"},BritneyEnvironment:{6:"Ambient",8:"Player Place",9:"Dust Particles",12:"Icons"}};function x0(t,e){var n;return((n=B0[e])==null?void 0:n[t])||R0[t]||"Unknown"}const I0={WeaveEnvironment:{0:"Outer Square Bottom Left Laser",1:"Outer Square Bottom Right Laser",2:"Outer Square Top Left Laser",3:"Outer Square Top Right Laser",4:"Inner Square Bottom Left Laser",5:"Inner Square Bottom Right Laser",6:"Inner Square Top Left Laser",7:"Inner Square Top Right Laser",8:"Side Square Bottom Left Laser",9:"Side Square Bottom Right Laser",10:"Side Square Top Left Laser",11:"Side Square Top Right Laser",12:"Distant Square Top Laser",13:"Distant Square Bottom Laser",14:"Distant Square Left Laser",15:"Distant Square Right Laser"},PyroEnvironment:{0:"Stage Left Platform",1:"Stage Right Platform",2:"Top Stage Left Laser",3:"Top Stage Right Laser",4:"Top Stage Middle Laser",5:"Top Stage Light",6:"Side Panels Left Tower",7:"Side Panels Right Tower",8:"Stage Left Laser",9:"Stage Right Laser",10:"Side Panels Left Laser",11:"Side Panels Right Laser",12:"Fire Left",13:"Fire Right"},EDMEnvironment:{0:"Circles Top",1:"Circles Close",2:"Circles Distant",3:"Circles Distant 2",4:"Single Source Circles Left",5:"Single Source Circles Right",6:"Single Source Lasers Left (Up)",7:"Single Source Lasers Left (Out)",8:"Single Source Lasers Right (Up)",9:"Single Source Lasers Right (Out)",10:"Single Source Lasers Left (Down)",11:"Single Source Lasers Right (Down)",12:"Single Source Lasers Left (Down) / Circle Rotations Top",13:"Single Source Lasers Right (Up) / Circle Rotations Close",14:"Circle Rotations Distant",15:"Circle Rotations Distant 2",16:"Circle Rotations Single Source Left",17:"Circle Rotations Single Source Right"},TheSecondEnvironment:{0:"Rings Big",1:"Rings Small",2:"Runway Left",3:"Runway Right",4:"Spotlight Left",5:"Spotlight Right",6:"Top Lasers Left Bottom",7:"Top Lasers Right Bottom",8:"Top Lasers Left Top",9:"Top Lasers Right Top",10:"Bottom Lasers Left Bottom",11:"Bottom Lasers Right Bottom",12:"Bottom Lasers Left Top",13:"Bottom Lasers Right Top"},LizzoEnvironment:{0:"Main Floor",1:"Rainbow Arcs Inner",2:"Rainbow Arcs 2",3:"Rainbow Arcs 3",4:"Rainbow Arcs 4",5:"Rainbow Arcs Outer",6:"Rainbow Rings Left",7:"Rainbow Rings Right",8:"Rainbow Rings Lasers Left",9:"Rainbow Rings Lasers Right",10:"Main Top Lasers",11:"Environment Stands Left",12:"Environment Stands Right",13:"Environment Clouds Left",14:"Environment Clouds Right",15:"Main Left Lasers",16:"Main Right Lasers",17:"Environment Stand Lasers Left",18:"Environment Stand Lasers Right",19:"Rainbow Arcs Laser"},TheWeekndEnvironment:{0:"Lamps Poles Left",1:"Lamps Poles Right",2:"Lamps Rings Left",3:"Lamps Rings Right",4:"Environment Arrows",5:"Environment Side Lasers Left",6:"Environment Side Lasers Right",7:"Environment Runway Lane",8:"Environment Center Ring",9:"Environment Center Ring Lasers",10:"Windows Left 1 Front",11:"Windows Left 1 Side",12:"Windows Left 2 Side",13:"Windows Left 3 Front",14:"Windows Left 3 Side",15:"Windows Right 1 Front",16:"Windows Right 1 Side",17:"Windows Right 2 Side",18:"Windows Right 3 Front",19:"Windows Right 3 Side",20:"Buildings Left",21:"Buildings Right",22:"Buildings Roof Left",23:"Buildings Roof Right",29:"Lamp Rings Left 1",30:"Lamp Rings Left 2",31:"Lamp Rings Left 3",32:"Lamp Rings Left 4",33:"Lamp Rings Right 1",34:"Lamp Rings Right 2",35:"Lamp Rings Right 3",36:"Lamp Rings Right 4",37:"Buildings Background Left",38:"Buildings Background Right",40:"Buildings Side Buildings"},RockMixtapeEnvironment:{0:"Lasers Far Left",1:"Lasers Far Right",2:"Mountain 1",3:"Mountain 2",4:"Mountain 3",5:"Mountain 4",6:"Mountain 5",7:"Mountain 6",8:"Mountain 7",9:"Mountain 8",10:"Mountain 9",11:"Mountain 10",12:"Mountain 11",13:"Mountain 12",14:"Face Eyes",15:"Runway Frets",16:"Runway Strings",17:"Runway Tunnel",18:"Lasers Side Left",19:"Lasers Side Right",20:"Lasers Side Left Rotation",21:"Lasers Side Right Rotation",22:"Face Left",23:"Face Right",24:"Spikes Left",25:"Spikes Left Movement",26:"Spikes Right",27:"Spikes Right Movement",28:"Runway Dots",29:"Face Movement",30:"Runway Equilizer",31:"Screens Left 1",32:"Screens Left 2",33:"Screens Right 1",34:"Screens Right 2",35:"Screens Left Movement",36:"Screens Right Movement",37:"Lasers Side Z Translation"},Dragons2Environment:{0:"Small Rings (R/T)",1:"Small Rings (Colors)",2:"Underground",3:"Big Rings",4:"Top Spotlights",5:"Runway Left",6:"Runway Right",7:"Particles Left",8:"Particles Right",9:"Main Lasers Bottom Left",10:"Main Lasers Top Left",11:"Main Lasers Top Right",12:"Main Lasers Bottom Right"},Panic2Environment:{0:"Left Cones Local",1:"Right Cones Local",2:"Left Cones Global",3:"Right Cones Global",4:"Center Cones Local",5:"Center Cones Global",6:"Diamond Rings Local Left",7:"Diamond Rings Local Right",8:"Diamond Rings Global",9:"Lasers Bottom Left",10:"Lasers Bottom Right",11:"Lasers Top Left",12:"Lasers Top Right",13:"Runway Lasers Left",14:"Runway Lasers Right",15:"Runway Inner Laser",16:"Spectrogram Left",17:"Spectrogram Right",18:"Runway Lasers Left Transform Z",19:"Runway Lasers Right Transform Z",20:"Window Left Pirces",21:"Window Left Aura",22:"Window Right Pieces",23:"Window Right Aura"},QueenEnvironment:{0:"Vinyls Left",1:"Vinyl Left 1",2:"Vinyl Left 2",3:"Vinyl Left 3",4:"Vinyl Left 4",5:"Vinyls Right",6:"Vinyl Right 1",7:"Vinyl Right 2",8:"Vinyl Right 3",9:"Vinyl Right 4",10:"Tunnel Rings Wrapper",11:"Distant Circular Lasers Z",12:"Distant Circular Lasers",13:"Top Circular Lasers Rot Y",14:"Top Circular Lasers",15:"Platform Lane Left",16:"Platform Lane Right",17:"Silhouette Contour"},LinkinPark2Environment:{0:"Circular Lasers Global Distant",1:"Circular Lasers Local Distant",2:"Circular Lasers Global Close",3:"Circular Lasers Local Close",4:"Tunnels Rings",5:"Big Arcs Local",6:"Laser Beams Local Left",7:"Laser Beams Local Right",8:"Floor Lasers Left",9:"Floor Lasers Right",10:"Tunnels Lights",11:"Logo",12:"Big Arcs Global",13:"Spectrograms Floor Left",14:"Spectrograms Floor Right",15:"Spectrograms Tunnel Left",16:"Spectrograms Tunnel Right",17:"Laser Beams Global Left",18:"Laser Beams Global Right"},TheRollingStonesEnvironment:{0:"Cube Local Left",1:"Cube Local Right",2:"Columns Left 01",3:"Columns Left 02",4:"Columns Left 03",5:"Columns Left 04",6:"Columns Right 01",7:"Columns Right 02",8:"Columns Right 03",9:"Columns Right 04",10:"Floor Blocks Left",11:"Floor Blocks Right",12:"Heart Local Left",13:"Heart Local Right",14:"Lasers Left 01",15:"Lasers Left 02",16:"Lasers Left 03",17:"Lasers Left 04",18:"Lasers Right 01",19:"Lasers Right 02",20:"Lasers Right 03",21:"Lasers Right 04",22:"Columns Lasers 01",23:"Columns Lasers 02",24:"Lasers Left Sphere",25:"Lasers Right Sphere",26:"Cube Global",27:"Heart Global",28:"Logo Local",29:"Logo Global",30:"Splinters",31:"Cube Rot Z Left",32:"Cube Rot Z Right",33:"Heart Rot Z Left",34:"Heart Rot Z Right",35:"Floor Side Laser Left",36:"Floor Side Laser Right",37:"Cube Lasers",38:"Splinters Global Translation",39:"Floor Below Block",40:"Floor Inner Light Left",41:"Floor Inner Light Right",42:"Logo Iridescence",43:"Logo Color",44:"Floor Side Laser Bottom Left",45:"Floor Side Laser Bottom Right"},LatticeEnvironment:{0:"Bottom Left Global",1:"Bottom Left Cube",2:"Bottom Left Radial",3:"Bottom Left Spot 1",4:"Bottom Left Spot 2",5:"Bottom Left Laser 1",6:"Bottom Left Laser 2",7:"Bottom Right Global",8:"Bottom Right Cube",9:"Bottom Right Radial",10:"Bottom Right Spot 1",11:"Bottom Right Spot 2",12:"Bottom Right Laser 1",13:"Bottom Right Laser 2",14:"Top Left Global",15:"Top Left Cube",16:"Top Left Radial",17:"Top Left Spot 1",18:"Top Left Spot 2",19:"Top Left Laser 1",20:"Top Left Laser 2",21:"Top Right Global",22:"Top Right Cube",23:"Top Right Radial",24:"Top Right Spot 1",25:"Top Right Spot 2",26:"Top Right Laser 1",27:"Top Right Laser 2",28:"Runway Diagonals",29:"Runway Outline",30:"Runway Chevron"},DaftPunkEnvironment:{0:"Tris Wall Left",1:"Tris Wall Right",2:"Lasers Top Sideset 01 L",3:"Lasers Top Sideset 02 L",4:"Lasers Top Sideset 01 R",5:"Lasers Top Sideset 02 R",6:"Lasers Bottom Sideset 01 L",7:"Lasers Bottom Sideset 02 L",8:"Lasers Bottom Sideset 01 R",9:"Lasers Bottom Sideset 02 R",10:"Lasers Top Wall L",11:"Lasers Top Wall R",12:"Lasers Bottom Wall L",13:"Lasers Bottom Wall R",14:"Orbit 1",15:"Orbit 2",16:"Orbit 3",17:"Orbit 4",18:"Runway Middle",19:"Visor 01 Spectrogram",20:"Visor 02 Spectrogram",21:"Visor 01 Text",22:"Visor 02 Text",23:"Helmet 01",24:"Helmet 02",25:"Runway Left",26:"Runway Right",27:"Background Stars",28:"Orbit 1 Star 1",29:"Orbit 1 Star 2",30:"Orbit 1 Star 3",31:"Orbit 1 Star 4",32:"Orbit 2 Star 1",33:"Orbit 2 Star 2",34:"Orbit 2 Star 3",35:"Orbit 2 Star 4",36:"Orbit 3 Star 1",37:"Orbit 3 Star 2",38:"Orbit 3 Star 3",39:"Orbit 3 Star 4",40:"Orbit 4 Star 1",41:"Orbit 4 Star 2",42:"Orbit 4 Star 3",43:"Orbit 4 Star 4",44:"Orbit 1 Stars Transform",45:"Orbit 2 Stars Transform",46:"Orbit 3 Stars Transform",47:"Orbit 4 Stars Transform",48:"Visor 02 Offset X",49:"Visor 02 Offset Y",50:"Visor 02 Padding X",51:"Visor 02 Padding Y",52:"Visor 01 Offset X",53:"Visor 01 Offset Y",54:"Visor 01 Padding X",55:"Visor 01 Padding Y"},HipHopEnvironment:{0:"Environment Side Lasers Left",1:"Environment Side Lasers Right",2:"Ceiling Lights Left",5:"Ceiling Lights Right",6:"Trains Long 1 Transforms",7:"Trains Long 1 Color",8:"Trains Long 2 Transforms",9:"Trains Long 2 Color",10:"Trains Short L Transforms",11:"Trains Short L Color",12:"Trains Short R Transforms",13:"Trains Short R Color",14:"Geo Walls",15:"Geo Roof",16:"Geo Platforms",17:"Geo Pillars Left",18:"Geo Pillars Right",19:"Environment Runway Ring",20:"Hoops L1",21:"Hoops Pieces L1",22:"Balls L1",23:"Hoops L2",24:"Hoops Pieces L2",25:"Balls L2",26:"Hoops R1",27:"Hoops Pieces R1",28:"Balls R1",29:"Hoops R2",30:"Hoops Pieces R2",31:"Balls R2",32:"Graffiti Floating Graffiti R",33:"Graffiti Floating Graffiti L",34:"Graffiti Boombox",35:"Graffiti Boombox Shards",36:"Environment Spectrogram Left",37:"Environment Spectrogram Right",38:"Trains Short L Graffiti",39:"Trains Short R Graffiti",40:"Environment Runway Lights",41:"Environment Spectrogram Y"},ColliderEnvironment:{0:"Center Blocks Local",1:"Center Blocks Global",2:"Center Blocks Inner Lasers",3:"Center Blocks Outer Lasers",4:"Center Blocks Side 01 Lasers",5:"Center Blocks Side 02 Lasers",6:"Colliders Diamonds",7:"Side Blocks Set 01 (Left) Local",8:"Side Blocks Set 02 (Right) Local",9:"Side Blocks Set 01 (Left) Global",10:"Side Blocks Set 02 (Right) Global",11:"Side Blocks Set 01 (Left) Inner Lasers",12:"Side Blocks Set 02 (Right) Inner Lasers",13:"Side Blocks Set 01 (Left) Outer Lasers",14:"Side Blocks Set 02 (Right) Outer Lasers",15:"Side Blocks Set 01 (Left) Side 01 Lasers",16:"Side Blocks Set 02 (Right) Side 01 Lasers",17:"Side Blocks Set 01 (Left) Side 02 Lasers",18:"Side Blocks Set 02 (Right) Side 02 Lasers",19:"Runway Left",20:"Runway Right",21:"Colliders Left",22:"Colliders Right",23:"Chevron Local",24:"Chevron Mask Strength",25:"Center Blocks Mask Strength",26:"Side Blocks Set 01 (Left) Mask Strength",27:"Side Blocks Set 02 (Right) Mask Strength"},BritneyEnvironment:{0:"Cubes Local Left",1:"Cubes Global Left",2:"Cubes Local Right",3:"Cubes Global Right",5:"Display Local",6:"Top Lasers Set 01 Global",7:"Top Lasers Set 01 Local",8:"Top Lasers Set 02 Global",9:"Top Lasers Set 02 Local",10:"Chevron",11:"Outer Cylinders Bottom Lasers",12:"Runway",13:"Stage Mask Offset",14:"Outer Cylinders Local",15:"Spirals Local",16:"Stage Top",17:"Stage Sides",18:"Cubes Speaker Lights L",19:"Cubes Speaker Lights R",20:"Display Mask Strength",21:"Stars Color",22:"Chevron Mask Strength"}};function N0(t,e){var n;return((n=I0[e])==null?void 0:n[t])||"Unknown"}function O0(t,e,n="DefaultEnvironment",i=2){var s;const o=((s=Dn[n])==null?void 0:s[0])??Dn.DefaultEnvironment[0],r={};for(let a=o.length-1;a>=0;a--)r[o[a]]={total:0,chroma:0,chromaOld:0};const l=i>=3?fp:cp;r[5]={total:e.length,chroma:0,chromaOld:0};for(let a=t.length-1;a>=0;a--)t[a].isValidType()&&(r[t[a].type]||(r[t[a].type]={total:0,chroma:0,chromaOld:0}),r[t[a].type].total++,l(t[a])&&r[t[a].type].chroma++,t[a].isOldChroma()&&r[t[a].type].chromaOld++);return r}function _i(t,e="DefaultEnvironment"){var o;const n=((o=Dn[e])==null?void 0:o[1])??Dn.DefaultEnvironment[1],i={};for(let r=n.length-1;r>=0;r--)i[n[r]]={groups:0,boxes:0,bases:0};for(let r=t.length-1;r>=0;r--)i[t[r].id]||(i[t[r].id]={groups:0,boxes:0,bases:0}),i[t[r].id].groups++,i[t[r].id].boxes+=t[r].boxes.length,i[t[r].id].bases+=t[r].boxes.reduce((l,s)=>l+s.events.length,0);return i}function Oo(t,e=2){const n={red:{total:0,chroma:0,noodleExtensions:0,mappingExtensions:0},blue:{total:0,chroma:0,noodleExtensions:0,mappingExtensions:0}},i=e>=3?Cl:wl,o=e>=3?kl:Dl;for(let r=t.length-1;r>=0;r--){if(t[r].color!==0&&t[r].color!==1)continue;const l=t[r].color?"blue":"red";n[l].total++,i(t[r])&&n[l].chroma++,o(t[r])&&n[l].noodleExtensions++,Rl(t[r])&&n[l].mappingExtensions++}return n}function A0(t,e=2){const n={total:0,chroma:0,noodleExtensions:0,mappingExtensions:0},i=e>=3?Cl:wl,o=e>=3?kl:Dl;for(let r=t.length-1;r>=0;r--)n.total++,i(t[r])&&n.chroma++,o(t[r])&&n.noodleExtensions++,Ll(t[r])&&n.mappingExtensions++;return n}function yi(t,e){return t.filter(n=>n.posX===e).length}function P0(t,e){return t.filter(n=>n.posY===e).length}function $0(t,e,n){return t.filter(i=>i.posX===e&&i.posY===n).length}function M0(t,e){return t.filter(n=>n.direction===e).length}function F0(t,e=2){const n={total:0,interactive:0,chroma:0,noodleExtensions:0,mappingExtensions:0},i=e>=3?pp:mp,o=e>=3?dp:hp,r=e>=3?Tl:Sl;for(let l=t.length-1;l>-1;l--)n.total++,t[l].isInteractive()&&n.interactive++,i(t[l])&&n.chroma++,o(t[l])&&n.noodleExtensions++,r(t[l])&&n.mappingExtensions++;return n}function j0(t){return Math.max(...t.map(e=>e.ebpm),0)}function z0(t){return Math.max(...t.map(e=>e.ebpmSwing),0)}function V0(t,e){const n=[];let i=0,o=0,r,l;const s={},a={},u={0:[],1:[]};for(const c of t)r=0,l=Number.MAX_SAFE_INTEGER,a[c.color]?de(c,a[c.color],e,u[c.color])&&(r=Ga(u[c.color],e),l=Ha(u[c.color],e),r>0&&l!==1/0||(r=0,l=0),o=Va(c,s[c.color],e),i=Va(c,a[c.color],e),n.push({time:s[c.color].time,duration:a[c.color].time-s[c.color].time,data:u[c.color],ebpm:i,ebpmSwing:o,maxSpeed:l,minSpeed:r}),s[c.color]=c,u[c.color]=[]):s[c.color]=c,a[c.color]=c,u[c.color].push(c);for(let c=0;c<2;c++)a[c]&&(r=Ga(u[c],e),l=Ha(u[c],e),r>0&&l!==1/0||(r=0,l=0),n.push({time:s[c].time,duration:a[c].time-s[c].time,data:u[c],ebpm:i,ebpmSwing:o,maxSpeed:l,minSpeed:r}));return n}function de(t,e,n,i){if(i&&i.length>0&&n.toRealTime(e.time)+.005<n.toRealTime(t.time)&&t.direction!==B.ANY){for(const o of i)if(o.direction!==B.ANY&&ei(t,o,90,!1))return!0}if(i&&i.length>0){for(const o of i)if(t.isInline(o))return!0}return t.isWindow(e)&&n.toRealTime(t.time-e.time)>.08||n.toRealTime(t.time-e.time)>.07}function Va(t,e,n){return n.bpm/(n.toBeatTime(n.toRealTime(t.time)-n.toRealTime(e.time),!1)*2)}function Ga(t,e){let n=!1,i=!1,o=0;const r=e.toRealTime(Math.max(...t.map((l,s)=>s===0?0:((t[s].isHorizontal(t[s-1])||t[s].isVertical(t[s-1]))&&!n&&(n=!0,o=(t[s].time-t[s-1].time)/(t[s].getDistance(t[s-1])||1)),i=t[s].isDiagonal(t[s-1])||t[s].isSlantedWindow(t[s-1])||i,(t[s].time-t[s-1].time)/(t[s].getDistance(t[s-1])||1)))));return n&&i?e.toRealTime(o):r}function Ha(t,e){let n=!1,i=!1,o=Number.MAX_SAFE_INTEGER;const r=e.toRealTime(Math.min(...t.map((l,s)=>s===0?Number.MAX_SAFE_INTEGER:((t[s].isHorizontal(t[s-1])||t[s].isVertical(t[s-1]))&&!n&&(n=!0,o=(t[s].time-t[s-1].time)/(t[s].getDistance(t[s-1])||1)),i=t[s].isDiagonal(t[s-1])||t[s].isSlantedWindow(t[s-1])||i,(t[s].time-t[s-1].time)/(t[s].getDistance(t[s-1])||1)))));return n&&i?e.toRealTime(o):r}function G0(t,e,n){const i={left:new Array(Math.floor(e+1)).fill(0),right:new Array(Math.floor(e+1)).fill(0)};let o,r;for(const l of t){const s=n.toRealTime(l.time);l.color===0&&(o?de(l,o,n)&&i.left[Math.floor(s)]++:i.left[Math.floor(s)]++,o=l),l.color===1&&(r?de(l,r,n)&&i.right[Math.floor(s)]++:i.right[Math.floor(s)]++,r=l)}return i}function Ao(t,e){if(!t.length)return 0;if(t.length<e)return t.reduce((o,r)=>o+r)/t.length;let n=t.slice(0,e).reduce((o,r)=>o+r),i=n;for(let o=0;o<t.length-e;o++)n=n-t[o]+t[o+e],i=Math.max(i,n);return i/e}function H0(t,e,n,i){const r={characteristic:n,difficulty:i,red:{perSecond:0,peak:0,median:0,total:0},blue:{perSecond:0,peak:0,median:0,total:0},total:{perSecond:0,peak:0,median:0,total:0},container:V0(t.colorNotes,e)},l=Math.max(e.toRealTime(ti(t)-yr(t)),0),s=Math.max(e.toRealTime(ti(t)),0),a=G0(t.colorNotes,s,e),u=a.left.map((m,h)=>m+a.right[h]);if(u.reduce((m,h)=>m+h)===0)return r;const c=[],p=[],v=[];for(let m=0,h=Math.ceil(u.length/10);m<h;m++){const d=m*10;let y=10;y+d>u.length&&(y=u.length-d);const g=a.left.slice(d,d+y),_=a.right.slice(d,d+y),D=u.slice(d,d+y);c.push(g.reduce((C,k)=>C+k)/y),p.push(_.reduce((C,k)=>C+k)/y),v.push(D.reduce((C,k)=>C+k)/y)}return r.red.total=a.left.reduce((m,h)=>m+h),r.red.perSecond=a.left.reduce((m,h)=>m+h)/l,r.red.peak=Ao(a.left,10),r.red.median=ko(c),r.blue.total=a.right.reduce((m,h)=>m+h),r.blue.perSecond=a.right.reduce((m,h)=>m+h)/l,r.blue.peak=Ao(a.right,10),r.blue.median=ko(p),r.total.total=r.red.total+r.blue.total,r.total.perSecond=u.reduce((m,h)=>m+h)/l,r.total.peak=Ao(u,10),r.total.median=ko(v),r}function U0(t,e){let n=0,i=0,o;for(const r of t){const l=r.total.perSecond;if(i>0&&l>0&&(n=Math.abs(1-i/l)*100),i=l>0?l:i,i>e&&n>40)return{result:r,comparedTo:o};o=r}return null}function W0(t,e){let n=Number.MAX_SAFE_INTEGER,i=0,o;for(const r of t){const l=r.total.perSecond;if(i>0&&l>0&&(n=Math.abs(1-i/l)*100),i=l>0?l:i,i>e&&n<10)return{result:r,comparedTo:o};o=r}return null}function Y0(t){let e=0,n=Number.MAX_SAFE_INTEGER;return t.forEach(i=>{const o=i.total.perSecond;o>0&&(e=Math.max(e,o),n=Math.min(n,o))}),e||e&&n?(1-n/e)*100:0}function Ua(t){return Math.min(...t.map(e=>e.total.perSecond),Number.MAX_SAFE_INTEGER)}function Wa(t){return Math.max(...t.map(e=>e.total.perSecond),0)}function X0(t){return Math.max(...t.map(e=>e.minSpeed),0)}function q0(t){const e=t.map(n=>n.maxSpeed).filter(n=>n!==0);return e.length?Math.min(...e):0}function Zl(t,e){if(t==null||!t.length){Ft(Fa);return}const n=t.map((i,o)=>{var p,v;let r=i.b??i._time??0,l;e&&(r=e.adjustTime(r),l=e.toRealTime(r));const s=[],a=i.d??i._data;if(!a)return`Error parsing customEvents[${o}]`;for(const m in a){if(m=="_duration"||m=="_easing"||m=="_track"||m=="duration"||m=="easing"||m=="track")continue;const h=hr[m];a[m]!=null&&s.push(h)}const u=i.t??i._type,c=((p=i.d)==null?void 0:p.track)??((v=i._data)==null?void 0:v._track);return`${M(r,tt.rounding)}${l?" | "+Jt(l):""} -- ${u} -> [${s.join("")}]${u!=="AssignTrackParent"?`(${c})`:""}`});jt(Fa,n,"customEvents")}function Jl(t){if(t==null||!t.length){Ft($a);return}const e=t.map((n,i)=>{const o=[];if(!n.id&&!n.geometry&&!n._id&&!n._geometry)return`Error parsing environment[${i}]`;for(const a in n){if(a=="lookupMethod"||a=="id"||a=="geometry"||a=="_lookupMethod"||a=="_id"||a=="_geometry")continue;const u=mr[a];n[a]!=null&&o.push(u)}const r=n.geometry||n._geometry,l=n.track||n._track,s=n.id||n._id;return`${r?"Geometry":n.lookupMethod||n._lookupMethod} [${o.join("")}]${l?`(${l})`:""} -> ${r?r.type||r._type:s}`});jt($a,e,"environments")}function Ql(t){if(t==null){Ft(Da);return}jt(Da,t)}function tu(t){if(t==null||!t.length){Ft(Sa);return}let e=t.join(", ");jt(Sa,e)}function eu(t){if(t==null||!t.length){Ft(Ca);return}let e=t.join(", ");jt(Ca,e)}function nu(t){if(t==null){Ft(ka);return}let e=(lr[t]||"Unknown")+" Environment";lr[t]||(e+=` (${t})`),jt(ka,e)}function iu(t){if(t==null){Ft(La);return}jt(La,Tf(t))}function ou(t){if(t==null||!t.length){Ft(xa);return}jt(xa,t,"requirements")}function ru(t){if(t==null||!t.length){Ft(Ia);return}jt(Ia,t,"suggestions")}function su(t){if(t==null||!t.length){Ft(Na);return}jt(Na,t,"informations")}function au(t){if(t==null||!t.length){Ft(Oa);return}jt(Oa,t,"warnings")}function lu(t){if(t==null){Ft(Ma);return}const e=[];if(Array.isArray(t))for(const n of t)n||e.push("Error parsing pointDefinitions"),e.push(`${n._name} -- ${n._points.length} point${n._points.length>1?"s":""}`);else{t=t;for(const n in t){t[n]||e.push(`Error parsing pointDefinitions[${n}]`);const i=t[n];Array.isArray(i)||e.push(`Error parsing pointDefinitions[${n}]`),e.push(`${n} -- ${i.length} point${i.length>1?"s":""}`)}}jt(Ma,e,"pointDefinitions")}const Fe=new class{constructor(){this.loading={nested:!1,info:!1,difficulty:!1,analysis:!1,audio:!1,coverImage:!1,contributorImage:!1,finished:!1}}resetLoad(){this.loading.nested=!1,this.loading.info=!1,this.loading.difficulty=!1,this.loading.analysis=!1,this.loading.audio=!1,this.loading.coverImage=!1,this.loading.contributorImage=!1,this.loading.finished=!1}},at=new class{constructor(){this.beatmapInfo=null,this.beatmaps=[],this.contributors=[],this.analysis=null,this.duration=null}clear(){Fe.loading.finished=!1,this.beatmapInfo=null,this.beatmaps=[],this.contributors=[],this.analysis=null,this.duration=null}};function uu(t,e){if(t==null||e==null){Ft(Ta);return}jt(Ta,`${Jt(t)} to ${Jt(e)}${at.duration?` -- [ ${Jt(e-t)} / ${Jt(at.duration)} ]`:""}`)}function cu(t){if(!t||!t.saberLeftColor&&!t.saberRightColor&&!t.environment0Color&&!t.environment0ColorBoost&&!t.environment1Color&&!t.environment1ColorBoost&&!t.environmentWColor&&!t.environmentWColorBoost&&!t.obstaclesColor){Ft(Ra);return}const e={};e.saberLeftColor=ft(t.saberLeftColor),e.saberRightColor=ft(t.saberRightColor),e.environment0Color=ft(t.environment0Color),e.environment1Color=ft(t.environment1Color),e.environment0ColorBoost=ft(t.environment0ColorBoost),e.environment1ColorBoost=ft(t.environment1ColorBoost),e.obstaclesColor=ft(t.obstaclesColor),t.environmentWColor&&(e.environmentWColor=ft(t.environmentWColor)),t.environmentWColorBoost&&(e.environmentWColorBoost=ft(t.environmentWColorBoost));const n=[];for(const i in e){if(!e[i])continue;const o=document.createElement("div"),r=document.createElement("div"),l=document.createElement("div"),s=document.createElement("div");o.className="info__color",r.className="info__color-dot",r.style.backgroundColor=e[i]||"#000000",l.className="info__color-text info__color-text--monospace",l.textContent=`${e[i]}`,s.className="info__color-text",s.textContent=` -- ${Hf[i]}`,o.appendChild(r),o.appendChild(l),o.appendChild(s),n.push(o)}jt(Ra,n)}function K0(t){At.setSongName(t.song.title),At.setSongSubname(t.song.subTitle),At.setSongAuthor(t.song.author),At.setSongBPM(t.audio.bpm);const e=new Set,n=new Set,i=new Set([t.environmentBase.normal,t.environmentBase.allDirections]);t.difficulties.forEach(o=>{o.authors.mappers.forEach(r=>e.add(r)),o.authors.lighters.forEach(r=>n.add(r)),i.add(t.environmentNames.at(o.environmentId))}),Vl([...e],[...n]),Gl([...i].filter(o=>o)),Hl(t.customData._editors)}function mu(t,e){Ql(e.rawData._version||e.rawData.version||"Unknown"),tu(e.settings.authors.mappers),eu(e.settings.authors.lighters),nu(t.environmentNames.at(e.settings.environmentId)),cu(t.colorSchemes.at(e.settings.colorSchemeId)),ql(e.settings.customData),ou(e.settings.customData._requirements),ru(e.settings.customData._suggestions),su(e.settings.customData._information),au(e.settings.customData._warnings);const n=e.timeProcessor;iu(e.data.difficulty.customData.time??e.data.difficulty.customData._time),Yl(e.data.difficulty.customData.bookmarks??e.data.difficulty.customData._bookmarks,n),Xl(n),Jl(e.data.difficulty.customData.environment??e.data.difficulty.customData._environment),lu(e.data.difficulty.customData.pointDefinitions??e.data.difficulty.customData._pointDefinitions),Zl(e.data.difficulty.customData.customEvents??e.data.difficulty.customData._customEvents,n),uu(e.timeProcessor.toRealTime(yr(e.data)),e.timeProcessor.toRealTime(ti(e.data)))}function Z0(){Vl(),Gl(),Hl(),Ul(),Ql(),tu(),eu(),nu(),uu(),iu(),cu(),ql(),ou(),ru(),su(),au(),Yl(),Xl(),Jl(),lu(),Zl()}const Ei={enable:t=>{document.querySelectorAll(".input-toggle").forEach(n=>{n.disabled=!t})}},Xn=document.querySelector(".loading__bar"),Ya="loading__bar--error",Xa="loading__bar--download",J0=document.querySelector(".loading__text");function hu(t,e,n=100){J0.textContent=e,Xn.style.width=`${n}%`,t==="error"?Xn.classList.add(Ya):Xn.classList.remove(Ya),t==="download"?Xn.classList.add(Xa):Xn.classList.remove(Xa)}function Q0(){hu("info","No map loaded",0)}const Ct={status:hu,reset:Q0};var pt=(t=>(t[t.APRIL_FOOLS=0]="APRIL_FOOLS",t[t.GENERAL_ZIP=1]="GENERAL_ZIP",t[t.GENERAL_AUDIO=2]="GENERAL_AUDIO",t[t.GENERAL_COVER_IMAGE=3]="GENERAL_COVER_IMAGE",t[t.GENERAL_PREVIEW_TIME=4]="GENERAL_PREVIEW_TIME",t[t.GENERAL_PROGRESSION=5]="GENERAL_PROGRESSION",t[t.OTHERS_INVALID_OBJECT=6]="OTHERS_INVALID_OBJECT",t[t.OTHERS_OUTSIDE_PLAYABLE=7]="OTHERS_OUTSIDE_PLAYABLE",t[t.OTHERS_HOT_START=8]="OTHERS_HOT_START",t[t.OTHERS_NJS=9]="OTHERS_NJS",t[t.OTHERS_DIFFICULTY_LABEL=10]="OTHERS_DIFFICULTY_LABEL",t[t.EVENTS_INSUFFICIENT_LIGHT=11]="EVENTS_INSUFFICIENT_LIGHT",t[t.EVENTS_INVALID_EVENT_BOX=12]="EVENTS_INVALID_EVENT_BOX",t[t.EVENTS_UNLIT_BOMB=13]="EVENTS_UNLIT_BOMB",t[t.NOTES_EFFECTIVE_BPM=14]="NOTES_EFFECTIVE_BPM",t[t.NOTES_ACCEPTABLE_PRECISION=15]="NOTES_ACCEPTABLE_PRECISION",t[t.NOTES_PARITY=16]="NOTES_PARITY",t[t.NOTES_VARY_SWING=17]="NOTES_VARY_SWING",t[t.NOTES_SLOW_SLIDER=18]="NOTES_SLOW_SLIDER",t[t.NOTES_INLINE_ANGLE=19]="NOTES_INLINE_ANGLE",t[t.NOTES_SHRADO_ANGLE=20]="NOTES_SHRADO_ANGLE",t[t.NOTES_SPEED_PAUSE=21]="NOTES_SPEED_PAUSE",t[t.NOTES_IMPROPER_ARC=22]="NOTES_IMPROPER_ARC",t[t.NOTES_IMPROPER_CHAIN=23]="NOTES_IMPROPER_CHAIN",t[t.NOTES_IMPROPER_WINDOW=24]="NOTES_IMPROPER_WINDOW",t[t.NOTES_HITBOX_STAIR=25]="NOTES_HITBOX_STAIR",t[t.NOTES_HITBOX_REVERSE_STAIR=26]="NOTES_HITBOX_REVERSE_STAIR",t[t.NOTES_HITBOX_INLINE=27]="NOTES_HITBOX_INLINE",t[t.NOTES_HITBOX_PATH=28]="NOTES_HITBOX_PATH",t[t.NOTES_ONE_SABER=29]="NOTES_ONE_SABER",t[t.NOTES_COLOR_CHECK=30]="NOTES_COLOR_CHECK",t[t.NOTES_STACKED_NOTE=31]="NOTES_STACKED_NOTE",t[t.NOTES_DOUBLE_DIRECTIONAL=32]="NOTES_DOUBLE_DIRECTIONAL",t[t.NOTES_VISION_BLOCK=33]="NOTES_VISION_BLOCK",t[t.OBSTACLES_SHORT=34]="OBSTACLES_SHORT",t[t.OBSTACLES_CENTER=35]="OBSTACLES_CENTER",t[t.OBSTACLES_ZERO=36]="OBSTACLES_ZERO",t[t.OBSTACLES_NEGATIVE=37]="OBSTACLES_NEGATIVE",t))(pt||{}),dt=(t=>(t[t.APRIL_FOOLS=0]="APRIL_FOOLS",t[t.GENERAL_ZIP=1]="GENERAL_ZIP",t[t.GENERAL_AUDIO=2]="GENERAL_AUDIO",t[t.GENERAL_COVER_IMAGE=3]="GENERAL_COVER_IMAGE",t[t.GENERAL_PREVIEW_TIME=4]="GENERAL_PREVIEW_TIME",t[t.GENERAL_PROGRESSION=5]="GENERAL_PROGRESSION",t[t.OTHERS_INVALID_OBJECT=6]="OTHERS_INVALID_OBJECT",t[t.OTHERS_OUTSIDE_PLAYABLE=7]="OTHERS_OUTSIDE_PLAYABLE",t[t.OTHERS_HOT_START=8]="OTHERS_HOT_START",t[t.OTHERS_NJS=9]="OTHERS_NJS",t[t.OTHERS_DIFFICULTY_LABEL=10]="OTHERS_DIFFICULTY_LABEL",t[t.EVENTS_INSUFFICIENT_LIGHT=11]="EVENTS_INSUFFICIENT_LIGHT",t[t.EVENTS_INVALID_EVENT_BOX=12]="EVENTS_INVALID_EVENT_BOX",t[t.EVENTS_UNLIT_BOMB=13]="EVENTS_UNLIT_BOMB",t[t.NOTES_ONE_SABER=14]="NOTES_ONE_SABER",t[t.NOTES_COLOR_CHECK=15]="NOTES_COLOR_CHECK",t[t.NOTES_EFFECTIVE_BPM=16]="NOTES_EFFECTIVE_BPM",t[t.NOTES_ACCEPTABLE_PRECISION=17]="NOTES_ACCEPTABLE_PRECISION",t[t.NOTES_PARITY=18]="NOTES_PARITY",t[t.NOTES_VARY_SWING=19]="NOTES_VARY_SWING",t[t.NOTES_SLOW_SLIDER=20]="NOTES_SLOW_SLIDER",t[t.NOTES_INLINE_ANGLE=21]="NOTES_INLINE_ANGLE",t[t.NOTES_SHRADO_ANGLE=22]="NOTES_SHRADO_ANGLE",t[t.NOTES_SPEED_PAUSE=23]="NOTES_SPEED_PAUSE",t[t.NOTES_IMPROPER_ARC=24]="NOTES_IMPROPER_ARC",t[t.NOTES_IMPROPER_CHAIN=25]="NOTES_IMPROPER_CHAIN",t[t.NOTES_IMPROPER_WINDOW=26]="NOTES_IMPROPER_WINDOW",t[t.NOTES_HITBOX_STAIR=27]="NOTES_HITBOX_STAIR",t[t.NOTES_HITBOX_REVERSE_STAIR=28]="NOTES_HITBOX_REVERSE_STAIR",t[t.NOTES_HITBOX_INLINE=29]="NOTES_HITBOX_INLINE",t[t.NOTES_HITBOX_PATH=30]="NOTES_HITBOX_PATH",t[t.NOTES_STACKED_NOTE=31]="NOTES_STACKED_NOTE",t[t.NOTES_DOUBLE_DIRECTIONAL=32]="NOTES_DOUBLE_DIRECTIONAL",t[t.NOTES_VISION_BLOCK=33]="NOTES_VISION_BLOCK",t[t.OBSTACLES_SHORT=34]="OBSTACLES_SHORT",t[t.OBSTACLES_CENTER=35]="OBSTACLES_CENTER",t[t.OBSTACLES_ZERO=36]="OBSTACLES_ZERO",t[t.OBSTACLES_NEGATIVE=37]="OBSTACLES_NEGATIVE",t))(dt||{});const tb="April Fools",eb="xdd.",nb=!0,fu={name:tb,description:eb,type:"general",order:{input:pt.APRIL_FOOLS,output:dt.APRIL_FOOLS},input:{params:{enabled:nb}},run:ib};function ib(t){const e=new Date("01 April 1984"),n=new Date,i=e.getDate()===n.getDate()&&e.getMonth()===n.getMonth();if(!tt.aprilFooled&&i){const o=document.createElement("div"),r=document.createElement("a");return r.text="this link for more info.",r.href="https://youtu.be/dQw4w9WgXcQ",r.addEventListener("click",function(){tt.aprilFooled=1,tt.save()}),o.innerHTML='<b><span title="Info: no action necessary, take note.">  </span>AI generated content detected:</b> this may violate TOS, please refer to ',o.append(r),[{type:"html",label:"",value:[o]}]}return[]}let wi=0;const U={createBlock:function(...t){const e=document.createElement("div");for(const n of t)if(Array.isArray(n))for(const i of n)e.append(i);else e.appendChild(n);return e},createText:function(t,e,n){const i=`input-${wi++}`,o=document.createElement("input"),r=document.createElement("label");return o.id="input__gen-"+i,o.className="input-toggle input--small",o.type="text",o.value=n,o.addEventListener("change",t),e&&(r.textContent=e,r.htmlFor="input__gen-"+i),[o,r]},createNumber:function(t,e,n,i,o,r){const l=`input-${wi++}`,s=document.createElement("input"),a=document.createElement("label");return s.id="input__gen-"+l,s.className="input-toggle input--small",s.type="text",s.value=n.toString(),s.addEventListener("change",t),e&&(a.textContent=e,a.htmlFor="input__gen-"+l),typeof i=="number"&&(s.min=i.toString()),typeof o=="number"&&(s.max=o.toString()),typeof r=="number"&&(s.step=r.toString()),[a,s]},createCheckbox:function(t,e,n,i){const o=`input-${wi++}`,r=document.createElement("input"),l=document.createElement("label");return l.textContent=" "+e,l.title=n,l.htmlFor="input__gen-"+o,r.id="input__gen-"+o,r.className="input-toggle",r.type="checkbox",r.checked=i,r.addEventListener("change",t),[r,l]},createRadio:function(t,e,n,i,o){const r=`input-${wi++}`,l=document.createElement("input"),s=document.createElement("label");return s.textContent=e,s.htmlFor="input__gen-"+r,l.id="input__gen-"+r,l.name=n,l.className="input-toggle",l.type="radio",l.checked=o,l.value=i,l.addEventListener("change",t),[s,l]}},pu="Beatmap ZIP",du="Entrypoint not in root directory.",bu=!0,[gu,ob]=U.createCheckbox(function(){Ji.input.params.enabled=this.checked},pu,du,bu);function rb(){gu.checked=Ji.input.params.enabled}const Ji={name:pu,description:du,type:"general",order:{input:pt.GENERAL_ZIP,output:dt.GENERAL_ZIP},input:{params:{enabled:bu},html:U.createBlock(gu,ob),update:rb},run:sb};function sb(t){return Fe.loading.nested?[{type:"string",label:"Beatmap in folder ZIP",value:"Info file and the rest should be in the root of zip file.",symbol:"error"}]:[]}const vu="Audio Duration",_u="For ranking purpose, check for audio duration.",yu=!0,[Eu,ab]=U.createCheckbox(function(){Qi.input.params.enabled=this.checked},vu,_u,yu);function lb(){Eu.checked=Qi.input.params.enabled}const Qi={name:vu,description:_u,type:"general",order:{input:pt.GENERAL_AUDIO,output:dt.GENERAL_AUDIO},input:{params:{enabled:yu},html:U.createBlock(Eu,ab),update:lb},run:ub};function ub(t){const e=t.audioDuration;return e&&e<20?[{type:"string",label:"Unrankable audio length",value:`too short (${Jt(e)}s)`,symbol:"rank"}]:Fe.loading.audio?[]:[{type:"string",label:"No audio",value:tt.load.audio?"could not be loaded or not found":"no audio mode is enabled"}]}const wu="Validate Cover Image",Du="Validate cover image.",Su=!0,[Cu,cb]=U.createCheckbox(function(){to.input.params.enabled=this.checked},wu,Du,Su);function mb(){Cu.checked=to.input.params.enabled}const to={name:wu,description:Du,type:"general",order:{input:pt.GENERAL_COVER_IMAGE,output:dt.GENERAL_COVER_IMAGE},input:{params:{enabled:Su},html:U.createBlock(Cu,cb),update:mb},run:hb};function hb(){const t=new Image,e=At.getCoverImage(),n=[];return Fe.loading.coverImage&&e!==null?(t.src=e,t.width!==t.height&&n.push({type:"string",label:"Cover image is not square",value:"resize to fit square",symbol:"error"}),(t.width<256||t.height<256)&&n.push({type:"string",label:"Cover image is too small",value:"require at least 256x256",symbol:"error"})):n.push({type:"string",label:"No cover image",value:tt.load.imageCover?"could not be loaded or found":"no cover image option is enabled"}),n}const ku="Preview Time",Tu="Warn default editor preview time.",Lu=!0,[Ru,fb]=U.createCheckbox(function(){eo.input.params.enabled=this.checked},ku,Tu,Lu);function pb(){Ru.checked=eo.input.params.enabled}const eo={name:ku,description:Tu,type:"general",order:{input:pt.GENERAL_PREVIEW_TIME,output:dt.GENERAL_PREVIEW_TIME},input:{params:{enabled:Lu},html:U.createBlock(Ru,fb),update:pb},run:db};function db(t){const{previewStartTime:e,previewDuration:n}=t.info.audio;return e===12&&n===10?[{type:"string",label:"Default preview time",value:"strongly recommended to set for audience's 1st impression",symbol:"info"}]:[]}const Bu="Difficulty Progression",xu="For ranking purpose, check difficuly progression to fit rankability criteria.",Iu=!0,fr={"Expert+":null,ExpertPlus:null,Expert:null,Hard:null,Normal:null,Easy:null},Nu=document.createElement("ul"),Ou=["ExpertPlus","Expert","Hard","Normal","Easy"];for(const t of Ou){const[e,n]=U.createCheckbox(function(){Sn.input.params[t]=this.checked},en[t],`Toggle check progression for Standard ${en[t]}`,!0);fr[t]=e,Nu.appendChild(U.createBlock(e,n))}const[Au,bb]=U.createCheckbox(function(){Sn.input.params.enabled=this.checked},Bu,xu,Iu);function gb(){Au.checked=Sn.input.params.enabled;for(const t of Ou)fr[t]&&(fr[t].checked=Sn.input.params[t])}const Sn={name:Bu,description:xu,type:"general",order:{input:pt.GENERAL_PROGRESSION,output:dt.GENERAL_PROGRESSION},input:{params:{enabled:Iu,"Expert+":!0,ExpertPlus:!0,Expert:!0,Hard:!0,Normal:!0,Easy:!0},html:U.createBlock(U.createBlock(Au,bb),Nu),update:gb},run:vb};function vb(t){var s,a,u,c,p,v,m,h;const e=t.audioDuration;if(!e)return[];const n=at.beatmaps.filter(d=>d.settings.characteristic==="Standard").map(d=>d.swingAnalysis).filter(d=>Sn.input.params[d.difficulty]&&d.total.total>0).sort((d,y)=>y.total.perSecond-d.total.perSecond);if(!n.length)return[];const i=Math.max(e<120?3.2:e<240?4.2:5.2,M(Wa(n)*.4,2)),o=[];e<360&&Ua(n)>i&&(n.forEach(d=>d.total.perSecond),o.push({type:"string",label:`Minimum SPS not met (<${i})`,value:`lowest SPS is ${M(Ua(n),2)}, ${M(Y0(n),2)}% drop from highest SPS (${M(Wa(n),2)})`,symbol:"rank"}));const r=U0(n,i),l=W0(n,i);return r&&e<360&&o.push({type:"string",label:"Violates progression",value:`${en[r.result.difficulty]} exceeded 40% SPS drop, ${M(r.result.total.perSecond,2)} from ${M(((a=(s=r.comparedTo)==null?void 0:s.total)==null?void 0:a.perSecond)||0,2)} ${en[r.comparedTo.difficulty]}, acceptable range (${M((((c=(u=r.comparedTo)==null?void 0:u.total)==null?void 0:c.perSecond)||0)*.6,2)}-${M((((p=r.comparedTo)==null?void 0:p.total.perSecond)||0)*.9,2)})`,symbol:"rank"}),l&&e<360&&o.push({type:"string",label:"Violates progression",value:`${en[l.result.difficulty]} has less than 10% SPS drop, ${M(l.result.total.perSecond,2)} from ${M(((v=l.comparedTo)==null?void 0:v.total.perSecond)||0,2)} ${en[l.comparedTo.difficulty]}, acceptable range (${M((((m=l.comparedTo)==null?void 0:m.total.perSecond)||0)*.6,2)}-${M((((h=l.comparedTo)==null?void 0:h.total.perSecond)||0)*.9,2)})`,symbol:"rank"}),o}const Pu=Object.freeze(Object.defineProperty({__proto__:null,aprilFools:fu,audio:Qi,coverImage:to,previewTime:eo,progression:Sn,zip:Ji},Symbol.toStringTag,{value:"Module"})),$u="Acceptable Beat Precision",Mu=`Validate note timing placement is within timing precision.
i.e: 1/8 1/6 1/x`,Fu=!0,ju=[8,6],[zu,_b]=U.createCheckbox(function(){an.input.params.enabled=this.checked},$u+": ",Mu,Fu),[Vu,yb]=U.createText(function(){an.input.params.prec=this.value.trim().split(" ").map(t=>parseInt(t)).filter(t=>t>0?!Number.isNaN(t):!1),this.value=an.input.params.prec.join(" ")},"",ju.join(" "));function Eb(){zu.checked=an.input.params.enabled,Vu.value=an.input.params.prec.join(" ")}const an={name:$u,description:Mu,type:"note",order:{input:pt.NOTES_ACCEPTABLE_PRECISION,output:dt.NOTES_ACCEPTABLE_PRECISION},input:{params:{enabled:Fu,prec:[...ju]},html:U.createBlock(zu,_b,Vu,yb),update:Eb},run:Db};function wb(t){const e=t.swingAnalysis.container,{prec:n}=an.input.params;return e.map(i=>i.data.sort(xt)[0]).filter(i=>{if(!n.length)return!1;const o=i.customData.__mapcheck_beattime;for(let r=0;r<n.length;r++)if((o+.001)%(1/n[r])<.01)return!1;return!0})}function Db(t){const e=wb(t.beatmap);return e.length?[{type:"time",label:"Off-beat precision",value:e,symbol:"warning"}]:[]}const Gu="Color Check",Hu="Compare note color with other colored note and the arrow on itself.",Uu=!0,qa=[1,1,1],Ka={1:"Indistinguishable",5:"Hardly perceivable",10:"Close apparent",20:"Mildly similar",40:"Different",90:"Discernible",100:"Opposite"};function Za(t,e){let n=Object.keys(t).find(o=>parseFloat(o)>=e)??"100",i=parseFloat(n);return t[i]}const[Wu,Sb]=U.createCheckbox(function(){no.input.params.enabled=this.checked},Gu+" (EXPERIMENTAL)",Hu,Uu);function Cb(){Wu.checked=no.input.params.enabled}const no={name:Gu,description:Hu,type:"note",order:{input:pt.NOTES_COLOR_CHECK,output:dt.NOTES_COLOR_CHECK},input:{params:{enabled:Uu},html:U.createBlock(Wu,Sb),update:Cb},run:Lb};function kb(t){var o,r,l,s;const e=t.info.colorSchemes[t.beatmap.settings.colorSchemeId],n=((r=(o=t.beatmap)==null?void 0:o.settings.customData)==null?void 0:r._colorLeft)??e.saberLeftColor??we[Ee[t.beatmap.environment]??"The First"]._colorLeft,i=((s=(l=t.beatmap)==null?void 0:l.settings.customData)==null?void 0:s._colorRight)??e.saberRightColor??we[Ee[t.beatmap.environment]??"The First"]._colorRight;return n&&i?tr(Qt(n),Qt(i)):100}function Tb(t){var l,s,a,u;const e=t.info.colorSchemes[t.beatmap.settings.colorSchemeId];let n=100,i=100;const o=((s=(l=t.beatmap)==null?void 0:l.settings.customData)==null?void 0:s._colorLeft)??e.saberLeftColor??we[Ee[t.beatmap.environment]??"The First"]._colorLeft,r=((u=(a=t.beatmap)==null?void 0:a.settings.customData)==null?void 0:u._colorRight)??e.saberRightColor??we[Ee[t.beatmap.environment]??"The First"]._colorRight;return o&&(n=tr(qa,Qt(o))),r&&(i=tr(qa,Qt(r))),Math.min(n,i)}function Lb(t){var r,l;const e=t.info.colorSchemes[t.beatmap.settings.colorSchemeId];if(!((r=t.beatmap.settings.customData)!=null&&r._colorLeft)&&!((l=t.beatmap.settings.customData)!=null&&l._colorRight)&&!e)return[];const n=kb(t),i=Tb(t),o=[];return n<=20&&o.push({type:"string",label:`${Za(Ka,n)} note color (dE${M(n,1)})`,value:"suggest change to better differentiate between 2 note colour",symbol:"warning"}),i<=20&&o.push({type:"string",label:`${Za(Ka,i)} arrow note color (dE${M(i,1)})`,value:"may be difficult to see the arrow",symbol:"warning"}),o}var lt=(t=>(t[t.OBJECT=-1]="OBJECT",t[t.COLOR=0]="COLOR",t[t.BOMB=1]="BOMB",t[t.ARC=2]="ARC",t[t.CHAIN=3]="CHAIN",t))(lt||{});const Yu="Double-directional",Xu="Check double-directional note swing (this may not mean parity break).",qu=!0,[Ku,Rb]=U.createCheckbox(function(){io.input.params.enabled=this.checked},Yu,Xu,qu);function Bb(){Ku.checked=io.input.params.enabled}const io={name:Yu,description:Xu,type:"note",order:{input:pt.NOTES_DOUBLE_DIRECTIONAL,output:dt.NOTES_DOUBLE_DIRECTIONAL},input:{params:{enabled:qu},html:U.createBlock(Ku,Rb),update:Bb},run:Ib};function xb(t){const e=t.timeProcessor,n=t.noteContainer,i={},o={},r={},l={[ot.RED]:[],[ot.BLUE]:[]},s=[];for(let a=0,u=n.length;a<u;a++){const c=n[a];c.type===lt.COLOR&&i[c.data.color]?de(c.data,i[c.data.color],e,l[c.data.color])?(r[c.data.color]&&(r[c.data.color]=null,o[c.data.color]=(o[c.data.color]+180)%360),ei(c.data,o[c.data.color],45,!0)&&s.push(c.data),c.data.direction===B.ANY?r[c.data.color]=c.data:o[c.data.color]=c.data.getAngle(),l[c.data.color]=[]):(r[c.data.color]&&ei(c.data,o[c.data.color],45,!0)&&(s.push(c.data),r[c.data.color]=null,o[c.data.color]=c.data.getAngle()),c.data.direction!==B.ANY&&(r[c.data.color]=null,o[c.data.color]=c.data.getAngle())):c.type===lt.COLOR&&(o[c.data.color]=c.data.getAngle()),c.type===lt.COLOR&&(i[c.data.color]=c.data,l[c.data.color].push(c.data)),c.type===lt.BOMB&&(c.data.posY===Rt.BOTTOM&&(c.data.posX===ut.MIDDLE_LEFT&&(o[ot.RED]=Se[B.UP],r[ot.RED]=null),c.data.posX===ut.MIDDLE_RIGHT&&(o[ot.BLUE]=Se[B.UP],r[ot.BLUE]=null)),c.data.posY===Rt.TOP&&(c.data.posX===ut.MIDDLE_LEFT&&(o[ot.RED]=Se[B.DOWN],r[ot.RED]=null),c.data.posX===ut.MIDDLE_RIGHT&&(o[ot.BLUE]=Se[B.DOWN],r[ot.BLUE]=null)))}return s}function Ib(t){const e=xb(t.beatmap);return e.length?[{type:"time",label:"Double-directional",value:e,symbol:"warning"}]:[]}const Zu="Effective BPM",Ju=`Effective BPM is calculated by one hand making 1/2 precision movement relative to the BPM.
EBPM starts from previous end note to next start note (typically for sliders).
EBPM Swing starts from previous start note to next start note.`,Qu=!0,wr=450,Dr=350,tc=U.createCheckbox(function(){Kt.input.params.enabled=this.checked},Zu+" threshold",Ju,Qu),ec=U.createNumber(function(){Kt.input.params.ebpmThres=M(Math.abs(parseFloat(this.value)),1),this.value=Kt.input.params.ebpmThres.toString()},": ",wr,0),nc=U.createNumber(function(){Kt.input.params.ebpmsThres=M(Math.abs(parseFloat(this.value)),1),this.value=Kt.input.params.ebpmsThres.toString()}," (swing): ",Dr,0);function Nb(t){tc[0].checked=Kt.input.params.enabled,t&&ic(t)}const Kt={name:Zu,description:Ju,type:"note",order:{input:pt.NOTES_EFFECTIVE_BPM,output:dt.NOTES_EFFECTIVE_BPM},input:{params:{enabled:Qu,ebpmThres:wr,ebpmsThres:Dr},html:U.createBlock(tc,ec,nc),update:Nb,adjustTime:ic},run:Ab};function ic(t){Kt.input.params.ebpmThres=M(Math.min(wr,t.bpm*2*1.285714),1),Kt.input.params.ebpmsThres=M(Math.min(Dr,t.bpm*2),1),ec[1].value=Kt.input.params.ebpmThres.toString(),nc[1].value=Kt.input.params.ebpmsThres.toString()}function Ob(t){const{swingAnalysis:e}=t.beatmap;let{ebpmThres:n,ebpmsThres:i}=Kt.input.params;n+=.001,i+=.001;const o=e.container.filter(l=>l.ebpm>n).map(l=>l.data[0]),r=e.container.filter(l=>l.ebpmSwing>i).map(l=>l.data[0]);return{base:o,swing:r}}function Ab(t){const e=Ob(t),{ebpmThres:n,ebpmsThres:i}=Kt.input.params,o=[];return e.base.length&&o.push({type:"time",label:`>${n}EBPM warning`,value:e.base,symbol:"warning"}),e.swing.length&&o.push({type:"time",label:`>${i}EBPM (swing) warning`,value:e.swing,symbol:"warning"}),o}const oc="Hitbox Inline",rc="Check for overlapping note hitbox for inline note.",sc=!0,[ac,Pb]=U.createCheckbox(function(){oo.input.params.enabled=this.checked},oc,rc,sc);function $b(){ac.checked=oo.input.params.enabled}const oo={name:oc,description:rc,type:"note",order:{input:pt.NOTES_HITBOX_INLINE,output:dt.NOTES_HITBOX_INLINE},input:{params:{enabled:sc},html:U.createBlock(ac,Pb),update:$b},run:jb},Mb=0;function Fb(t){const{timeProcessor:e,njs:n}=t.beatmap,i={},o={[ot.RED]:[],[ot.BLUE]:[]},r=[];for(let l=0,s=t.beatmap.data.colorNotes.length;l<s;l++){const a=t.beatmap.data.colorNotes[l];i[a.color]&&de(a,i[a.color],e,o[a.color])&&(o[a.color]=[]);for(const u of o[(a.color+1)%2])if(n.value<1.425/(60*(a.time-u.time)/e.bpm+Mb)&&a.isInline(u)){r.push(a);break}i[a.color]=a,o[a.color].push(a)}return r}function jb(t){const e=Fb(t);return e.length?[{type:"time",label:"Hitbox inline",value:e,symbol:"rank"}]:[]}const lc="Hitbox Path",uc="Check for overlapping pre-swing note hitbox at same time.",cc=!0,[mc,zb]=U.createCheckbox(function(){ro.input.params.enabled=this.checked},lc,uc,cc);function Vb(){mc.checked=ro.input.params.enabled}const ro={name:lc,description:uc,type:"note",order:{input:pt.NOTES_HITBOX_PATH,output:dt.NOTES_HITBOX_PATH},input:{params:{enabled:cc},html:U.createBlock(mc,zb),update:Vb},run:Hb};function Gb(t){t.beatmap.timeProcessor;const e=t.beatmap.noteContainer.filter(o=>o.type===lt.BOMB||o.type===lt.COLOR),n=[];let i=0;for(let o=0,r=e.length;o<r;o++){const l=e[o];if(!(l.type!==lt.COLOR||l.data.customData.__mapcheck_secondtime<i+.01))for(let s=o+1;s<r;s++){const a=e[s];if(a.data.customData.__mapcheck_secondtime>l.data.customData.__mapcheck_secondtime+.01)break;a.type===lt.COLOR&&l.data.color===a.data.color||((l.data.isHorizontal(a.data)||l.data.isVertical(a.data))&&cr(l.data,a.data,[[45,1],[15,2]]).some(u=>u)||l.data.isDiagonal(a.data)&&cr(l.data,a.data,[[45,1],[15,1.5]]).some(u=>u))&&(n.push(l.data),i=l.data.customData.__mapcheck_secondtime)}}return n}function Hb(t){const e=Gb(t);return e.length?[{type:"time",label:"Hitbox path",value:e,symbol:"error"}]:[]}const hc="Hitbox Reverse Staircase",fc="Check for overlapping pre-swing hitbox with note hitbox during swing.",pc=!0,[dc,Ub]=U.createCheckbox(function(){so.input.params.enabled=this.checked},hc,fc,pc);function Wb(){dc.checked=so.input.params.enabled}const so={name:hc,description:fc,type:"note",order:{input:pt.NOTES_HITBOX_REVERSE_STAIR,output:dt.NOTES_HITBOX_REVERSE_STAIR},input:{params:{enabled:pc},html:U.createBlock(dc,Ub),update:Wb},run:Kb},Yb=.03414823529,Xb=.03414823529;function qb(t){const{timeProcessor:e,njs:n,noteContainer:i}=t.beatmap,o={},r={[ot.RED]:[],[ot.BLUE]:[]},l=[];for(let s=0,a=i.length;s<a;s++){if(i[s].type!==lt.COLOR)continue;const u=i[s];o[u.data.color]&&de(u.data,o[u.data.color],e,r[u.data.color])&&(r[u.data.color]=[]);for(const c of r[(u.data.color+1)%2])if(c.direction!==B.ANY){if(!(e.toRealTime(u.data.time)>e.toRealTime(c.time)+.01))continue;const p=c.getAngle()%90>15&&c.getAngle()%90<75;if(n.value<1.425/(60*(u.data.time-c.time)/e.bpm+(p?Xb:Yb))&&cr(u.data,c,[[15,1.5]])[1]){l.push(c);break}}o[u.data.color]=u.data,r[u.data.color].push(u.data)}return l}function Kb(t){const e=qb(t);return e.length?[{type:"time",label:"Hitbox reverse Staircase",value:e,symbol:"rank"}]:[]}const bc="Hitbox Staircase",gc="Check for overlapping post-swing hitbox with note hitbox during swing.",vc=!0,[_c,Zb]=U.createCheckbox(function(){ao.input.params.enabled=this.checked},bc,gc,vc);function Jb(){_c.checked=ao.input.params.enabled}const ao={name:bc,description:gc,type:"note",order:{input:pt.NOTES_HITBOX_STAIR,output:dt.NOTES_HITBOX_STAIR},input:{params:{enabled:vc},html:U.createBlock(_c,Zb),update:Jb},run:eg};function Qb(t,e,n){for(let i=n,o=e.length;i<o;i++){if(e[i].time<t.time+.01&&e[i].color!==t.color)return!0;if(e[i].time>t.time+.01)return!1}return!1}function tg(t){var c,p;const{timeProcessor:e}=t.beatmap,n=t.beatmap.data.colorNotes,i=e.toBeatTime(.15,!1),o={},r={},l={},s={[ot.RED]:[],[ot.BLUE]:[]},a={[ot.RED]:new Wt,[ot.BLUE]:new Wt({color:1})},u=[];for(let v=0,m=n.length;v<m;v++){const h=n[v],d=Lo[h.direction]||[0,0];o[h.color]?(de(h,o[h.color],e,s[h.color])?(l[h.color]=h.time-o[h.color].time,h.direction!==B.ANY?(a[h.color].posX=h.posX+d[0],a[h.color].posY=h.posY+d[1]):(a[h.color].posX=-1,a[h.color].posY=-1),s[h.color]=[],r[h.color]=h.direction):Kl(h,o[h.color],r[h.color])&&(h.direction!==B.ANY?(a[h.color].posX=h.posX+d[0],a[h.color].posY=h.posY+d[1],r[h.color]=h.direction):(a[h.color].posX=h.posX+(((c=Lo[r[h.color]])==null?void 0:c[0])||0),a[h.color].posY=h.posY+(((p=Lo[r[h.color]])==null?void 0:p[1])||0))),o[(h.color+1)%2]&&h.time-o[(h.color+1)%2].time!==0&&h.time-o[(h.color+1)%2].time<Math.min(i,l[(h.color+1)%2])&&h.posX===a[(h.color+1)%2].posX&&h.posY===a[(h.color+1)%2].posY&&!Qb(h,t.beatmap.data.colorNotes,v)&&u.push(h)):(h.direction!==B.ANY?(a[h.color].posX=h.posX+d[0],a[h.color].posY=h.posY+d[1]):(a[h.color].posX=-1,a[h.color].posY=-1),r[h.color]=h.direction),o[h.color]=h,s[h.color].push(h)}return u}function eg(t){const e=tg(t);return e.length?[{type:"time",label:"Hitbox staircase",value:e,symbol:"rank"}]:[]}const yc="Improper Arc",Ec="Check for correct use of arc.",wc=!0,[Dc,ng]=U.createCheckbox(function(){lo.input.params.enabled=this.checked},yc,Ec,wc);function ig(){Dc.checked=lo.input.params.enabled}const lo={name:yc,description:Ec,type:"note",order:{input:pt.NOTES_IMPROPER_ARC,output:dt.NOTES_IMPROPER_ARC},input:{params:{enabled:wc},html:U.createBlock(Dc,ng),update:ig},run:rg};function og(t){const e=[...t.beatmap.noteContainer].sort((i,o)=>i.type!==lt.ARC?1:o.type!==lt.ARC?-1:0).sort((i,o)=>i.data.time-o.data.time),n=[];for(let i=0,o=!0,r=e.length;i<r;i++){const l=e[i],s=e.at(-1).data.time;if(l.type===lt.ARC){o=!0;for(let a=i,u=!1;a<r;a++){const c=e[a];if(c.type===lt.COLOR&&l.data.posX===c.data.posX&&l.data.posY===c.data.posY&&c.data.time<=l.data.time+.001&&l.data.color===c.data.color&&(c.data.direction===B.ANY||l.data.direction===c.data.direction)){for(let p=a;p<r;p++){const v=e[a];if(v.type===lt.BOMB&&l.data.posX===v.data.posX&&l.data.posY===v.data.posY&&v.data.time<=l.data.time+.001){u=!0;break}if(!(v.type!==lt.COLOR||v.data.time<l.data.tailTime)){if(l.data.posX===c.data.posX&&l.data.posY===c.data.posY&&c.data.time<=l.data.time+.001&&(l.data.color!==c.data.color||(c.data.direction===B.ANY||l.data.direction!==c.data.direction))){u=!0;break}if(c.data.time>l.data.tailTime+.001)break}}o=u||!1;break}if(c.type===lt.COLOR&&l.data.posX===c.data.posX&&l.data.posY===c.data.posY&&c.data.time<=l.data.time+.001)break;if(c.data.time>l.data.time+.001){o=!1;break}(c.type===lt.ARC||c.type===lt.CHAIN)&&c.data.time+.001>s&&(o=!1)}o&&n.push(l.data)}}return n}function rg(t){const e=og(t);return e.length?[{type:"time",label:"Improper arc",value:e,symbol:"error"}]:[]}const Sc="Improper Chain",Cc="Check for correct use of chain.",kc=!0,[Tc,sg]=U.createCheckbox(function(){uo.input.params.enabled=this.checked},Sc,Cc,kc);function ag(){Tc.checked=uo.input.params.enabled}const uo={name:Sc,description:Cc,type:"note",order:{input:pt.NOTES_IMPROPER_CHAIN,output:dt.NOTES_IMPROPER_CHAIN},input:{params:{enabled:kc},html:U.createBlock(Tc,sg),update:ag},run:ug};function lg(t){const e=[...t.beatmap.noteContainer].sort((i,o)=>i.type!==lt.CHAIN?1:o.type!==lt.CHAIN?-1:0).sort((i,o)=>i.data.time-o.data.time),n=[];for(let i=0,o=!0,r=e.length;i<r;i++){const l=e[i];if(l.type===lt.CHAIN){o=!0;for(let s=i;s<r;s++){const a=e[s];if(a.type===lt.COLOR&&l.data.posX===a.data.posX&&l.data.posY===a.data.posY&&a.data.time<=l.data.time+.001&&l.data.color===a.data.color&&(a.data.direction===B.ANY||l.data.direction===a.data.direction)){o=!1;break}if(a.type===lt.BOMB&&l.data.posX===a.data.posX&&l.data.posY===a.data.posY&&a.data.time<=l.data.time+.001||a.data.time>l.data.time+.001)break}o&&n.push(l)}}return n}function ug(t){const e=lg(t);return e.length?[{type:"time",label:"Improper chain",value:e.map(n=>n.data),symbol:"error"}]:[]}const Lc="Improper Window Snap",Rc="Check for slanted window snap timing.",Bc=!0,[xc,cg]=U.createCheckbox(function(){co.input.params.enabled=this.checked},Lc,Rc,Bc);function mg(){xc.checked=co.input.params.enabled}const co={name:Lc,description:Rc,type:"note",order:{input:pt.NOTES_IMPROPER_WINDOW,output:dt.NOTES_IMPROPER_WINDOW},input:{params:{enabled:Bc},html:U.createBlock(xc,cg),update:mg},run:fg};function hg(t){const{timeProcessor:e,noteContainer:n}=t.beatmap,i={},o={[ot.RED]:[],[ot.BLUE]:[]},r=[];for(let l=0,s=n.length;l<s;l++){if(n[l].type!==lt.COLOR)continue;const a=n[l].data;i[a.color]?de(a,i[a.color],e,o[a.color])?(i[a.color]=a,o[a.color]=[]):a.isSlantedWindow(i[a.color])&&a.time-i[a.color].time>=.001&&a.direction===i[a.color].direction&&a.direction!==B.ANY&&i[a.color].direction!==B.ANY&&r.push(i[a.color]):i[a.color]=a,o[a.color].push(a)}return r}function fg(t){const e=hg(t);return e.length?[{type:"time",label:"Improper window snap",value:e,symbol:"error"}]:[]}const Ic="Inline Sharp Angle",Nc="Check for angle changes within inline note.",Oc=!0,Ac=.15;let Fn;const[pg,Sr]=U.createNumber(function(){fe.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=M(fe.input.params.maxTime*1e3,1).toString(),Fn&&(Cr.value=M(Fn.toBeatTime(fe.input.params.maxTime,!1),2).toString())},"max time (ms): ",M(Ac*1e3,1),0),[dg,Cr]=U.createNumber(function(){if(!Fn){this.value="0";return}let t=M(Math.abs(parseFloat(this.value)),2)||1;fe.input.params.maxTime=Fn.toRealTime(t),Sr.value=M(fe.input.params.maxTime*1e3,1).toString(),this.value=t.toString()}," (beat): ",0,0,null,.1),Pc=U.createCheckbox(function(){fe.input.params.enabled=this.checked},Ic,Nc,Oc);function bg(t){Pc[0].checked=fe.input.params.enabled,Sr.value=(fe.input.params.maxTime*1e3).toString(),t&&$c(t)}const fe={name:Ic,description:Nc,type:"note",order:{input:pt.NOTES_INLINE_ANGLE,output:dt.NOTES_INLINE_ANGLE},input:{params:{enabled:Oc,maxTime:Ac},html:U.createBlock(Pc,document.createElement("br"),pg,Sr,dg,Cr),update:bg,adjustTime:$c},run:vg};function $c(t){Fn=t,Cr.value=M(Fn.toBeatTime(fe.input.params.maxTime,!1),2).toString()}function gg(t){const{timeProcessor:e}=t.beatmap,n=t.beatmap.noteContainer,{maxTime:i}=fe.input.params,o=e.toBeatTime(i,!1)+.001,r={},l={},s={},a={[ot.RED]:[],[ot.BLUE]:[]},u=[];let c=0;for(let p=0,v=n.length;p<v;p++){const m=n[p];m.type===lt.COLOR&&r[m.data.color]?de(m.data,r[m.data.color],e,a[m.data.color])?(s[m.data.color]&&(s[m.data.color]=null,l[m.data.color]=(l[m.data.color]+180)%360),Ja(m.data,n,c,o)&&ei(m.data,l[m.data.color],90,!0)&&u.push(m.data),m.data.direction===B.ANY?s[m.data.color]=m.data:l[m.data.color]=m.data.getAngle(),a[m.data.color]=[]):(s[m.data.color]&&Ja(m.data,n,c,o)&&ei(m.data,l[m.data.color],90,!0)&&(u.push(s[m.data.color]),s[m.data.color]=null),m.data.direction!==B.ANY&&(l[m.data.color]=m.data.getAngle())):m.type===lt.COLOR&&(l[m.data.color]=m.data.getAngle()),m.type===lt.COLOR&&(r[m.data.color]=m.data,a[m.data.color].push(m.data)),m.type===lt.BOMB&&(m.data.posY===Rt.BOTTOM&&(m.data.posX===ut.MIDDLE_LEFT&&(l[ot.RED]=Se[B.UP],s[ot.RED]=null),m.data.posX===ut.MIDDLE_RIGHT&&(l[ot.BLUE]=Se[B.UP],s[ot.BLUE]=null)),m.data.posY===Rt.TOP&&(m.data.posX===ut.MIDDLE_LEFT&&(l[ot.RED]=Se[B.DOWN],s[ot.RED]=null),m.data.posX===ut.MIDDLE_RIGHT&&(l[ot.BLUE]=Se[B.DOWN],s[ot.BLUE]=null)))}return u}function Ja(t,e,n,i){for(let o=n;e[o].data.time<t.time;o++){const r=e[o];if(r.type===lt.COLOR&&t.isInline(r.data)&&t.time-e[o].data.time<=i)return!0}return!1}function vg(t){const e=gg(t);return e.length?[{type:"time",label:"Inline sharp angle",value:e,symbol:"warning"}]:[]}const Mc="One Saber",Fc="Check for one saber.",jc=!0,[zc,_g]=U.createCheckbox(function(){mo.input.params.enabled=this.checked},Mc,Fc,jc);function yg(){zc.checked=mo.input.params.enabled}const mo={name:Mc,description:Fc,type:"note",order:{input:pt.NOTES_ONE_SABER,output:dt.NOTES_ONE_SABER},input:{params:{enabled:jc},html:U.createBlock(zc,_g),update:yg},run:Eg};function Eg(t){let e,n=!1;if(t.beatmap.settings.characteristic==="OneSaber"||t.beatmap.settings.customData.oneSaber)e=t.beatmap.data.colorNotes.filter(o=>o.isRed());else{const o=t.beatmap.data.colorNotes.filter(l=>l.isBlue()).length>0,r=t.beatmap.data.colorNotes.filter(l=>l.isRed()).length>0;n=o?!r:r}return e!=null&&e.length?[{type:"time",label:"Wrong One Saber Note",value:e,symbol:"error"}]:n?[{type:"string",label:"Unintended One Saber",value:"One Saber gameplay outside of One Saber characteristic",symbol:"rank"}]:[]}const kr={create:(t,e,n,i,...o)=>{const r=document.createElement(n);r.className=i;const l=document.createElement("select");l.className="input-toggle",l.id=t,o.forEach(a=>{const u=document.createElement("option");u.textContent=a.text,u.value=a.value,l.append(u)});const s=document.createElement("label");return s.htmlFor=t,s.innerHTML=`<span>${e}</span>`,r.append(s),r.append(l),r}},Vc="Parity Check",Gc="Perform parity check.",Hc=!1,Uc=document.createElement("div");kr.create("input__checks-parity-rotation","Wrist rotation type: ","div","",{text:"Normal",value:"90"},{text:"Extended",value:"135"},{text:"Squid",value:"180"});kr.create("input__checks-parity-left","Left hand parity: ","div","",{text:"Auto",value:"auto"},{text:"Forehand",value:"forehand"},{text:"Backhand",value:"backhand"});kr.create("input__checks-parity-right","Right hand parity: ","div","",{text:"Auto",value:"auto"},{text:"Forehand",value:"forehand"},{text:"Backhand",value:"backhand"});const[Wc,wg]=U.createCheckbox(function(){ii.input.params.enabled=this.checked},Vc,Gc,Hc);Uc.appendChild(U.createBlock(Wc,wg));function Dg(){Wc.checked=ii.input.params.enabled}const ii={name:Vc,description:Gc,type:"note",order:{input:pt.NOTES_PARITY,output:dt.NOTES_PARITY},input:{params:{enabled:Hc,warningThres:90,errorThres:45,allowedRot:90},html:Uc,update:Dg},run:Cg};function Sg(t){const{timeProcessor:e,noteContainer:n}=t.beatmap,{warningThres:i,errorThres:o,allowedRot:r}=ii.input.params,l={},s={[ot.RED]:[],[ot.BLUE]:[]},a={[ot.RED]:[],[ot.BLUE]:[]},u={[ot.RED]:[],[ot.BLUE]:[]},c={[ot.RED]:new nn(t.beatmap.data.colorNotes,t.beatmap.data.bombNotes,0,i,o,r),[ot.BLUE]:new nn(t.beatmap.data.colorNotes,t.beatmap.data.bombNotes,1,i,o,r)},p={warning:[],error:[]};for(let v=0,m=n.length;v<m;v++){const h=n[v];if(h.type===lt.COLOR&&l[h.data.color]&&de(h.data,l[h.data.color],e,s[h.data.color])){switch(c[h.data.color].check(s[h.data.color],u[h.data.color])){case"warning":{p.warning.push(s[h.data.color][0]);break}case"error":{p.error.push(s[h.data.color][0]);break}}c[h.data.color].next(s[h.data.color],u[h.data.color]),u[h.data.color]=a[h.data.color],a[h.data.color]=[],s[h.data.color]=[]}h.type===lt.BOMB&&(a[ot.RED].push(h.data),a[ot.BLUE].push(h.data)),h.type===lt.COLOR&&(l[h.data.color]=h.data,s[h.data.color].push(h.data))}for(let v=0;v<2;v++)if(l[v])switch(c[v].check(s[v],a[v])){case"warning":{p.warning.push(s[v][0]);break}case"error":{p.error.push(s[v][0]);break}}return p}function Cg(t){const e=Sg(t);e.warning=e.warning,e.error=e.error;const n=[];return e.warning.length&&n.push({type:"time",label:"Parity warning",value:e.warning,symbol:"warning"}),e.error.length&&n.push({type:"time",label:"Parity error",value:e.error,symbol:"error"}),n}const Yc="shrado Angle",Xc="Look for common negative curvature pattern.",qc=!1,Kc=.15,Zc=1;let jn;const[kg,Tr]=U.createNumber(function(){Yt.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=M(Yt.input.params.maxTime*1e3,1).toString(),jn&&(Lr.value=M(jn.toBeatTime(Yt.input.params.maxTime,!1),2).toString())},"max time (ms): ",M(Kc*1e3,1),0),[Tg,Lr]=U.createNumber(function(){if(!jn){this.value="0";return}let t=M(Math.abs(parseFloat(this.value)),2)||1;Yt.input.params.maxTime=jn.toRealTime(t),Tr.value=M(Yt.input.params.maxTime*1e3,1).toString(),this.value=t.toString()}," (beat): ",0,0,null,.1),Jc=U.createNumber(function(){Yt.input.params.distance=Math.max(parseInt(this.value),0),this.value=Yt.input.params.distance.toString()},"min distance: ",Zc,0),Qc=U.createCheckbox(function(){Yt.input.params.enabled=this.checked},Yc,Xc,qc);function Lg(t){Qc[0].checked=Yt.input.params.enabled,Jc[1].value=Yt.input.params.distance.toString(),Tr.value=(Yt.input.params.maxTime*1e3).toString(),t&&tm(t)}const Yt={name:Yc,description:Xc,type:"note",order:{input:pt.NOTES_SHRADO_ANGLE,output:dt.NOTES_SHRADO_ANGLE},input:{params:{enabled:qc,distance:Zc,maxTime:Kc},html:U.createBlock(Qc,document.createElement("br"),Jc,document.createElement("br"),kg,Tr,Tg,Lr),update:Lg,adjustTime:tm},run:Bg};function tm(t){jn=t,Lr.value=M(jn.toBeatTime(Yt.input.params.maxTime,!1),2).toString()}function Rg(t){const{timeProcessor:e,noteContainer:n}=t.beatmap,{maxTime:i,distance:o}=Yt.input.params,r=e.toBeatTime(i,!1)+.001,l={},s={},a={},u={[ot.RED]:[],[ot.BLUE]:[]},c=[];for(let p=0,v=n.length;p<v;p++){if(n[p].type!==lt.COLOR)continue;const m=n[p].data;l[m.color]?de(m,l[m.color],e,u[m.color])?(a[m.color]&&(a[m.color]=null,s[m.color]=Vf[s[m.color]]??8),m.getDistance(l[m.color])>=o&&Qa(m.direction,s[m.color],m.color)&&m.time-l[m.color].time<=r&&c.push(m),m.direction===B.ANY?a[m.color]=m:s[m.color]=m.direction,u[m.color]=[]):(a[m.color]&&m.getDistance(l[m.color])>=o&&Qa(m.direction,s[m.color],m.color)&&m.time-l[m.color].time<=r&&(c.push(a[m.color]),a[m.color]=null),m.direction!==B.ANY&&(s[m.color]=m.direction)):s[m.color]=m.direction,l[m.color]=m,u[m.color].push(m)}return c}function Qa(t,e,n){return t===8||e===8?!1:(n===0?e===7:e===6)&&t===0}function Bg(t){const e=Rg(t);return e.length?[{type:"time",label:"Shrado angle",value:e,symbol:"warning"}]:[]}const em="Slow Slider",nm="Look for slider that require slow swing.",im=!0,om=.025;let zn;const[xg,Rr]=U.createNumber(function(){te.input.params.minSpeed=Math.abs(parseFloat(this.value))/1e3,this.value=M(te.input.params.minSpeed*1e3,1).toString(),zn&&(Br.value=M(1/zn.toBeatTime(te.input.params.minSpeed,!1),2).toString())},"min speed (ms): ",M(om*1e3,1),0),[Ig,Br]=U.createNumber(function(){if(!zn){this.value="0";return}let t=M(Math.abs(parseFloat(this.value)),2)||1;te.input.params.minSpeed=zn.toRealTime(1/t),Rr.value=M(te.input.params.minSpeed*1e3,1).toString(),this.value=t.toString()}," (prec): ",0,0),rm=U.createCheckbox(function(){te.input.params.enabled=this.checked},em,nm,im);function Ng(t){rm[0].checked=te.input.params.enabled,Rr.value=(te.input.params.minSpeed*1e3).toString(),t&&sm(t)}const te={name:em,description:nm,type:"note",order:{input:pt.NOTES_SLOW_SLIDER,output:dt.NOTES_SLOW_SLIDER},input:{params:{enabled:im,minSpeed:om},html:U.createBlock(rm,document.createElement("br"),xg,Rr,Ig,Br),update:Ng,adjustTime:sm},run:Ag};function sm(t){zn=t,Br.value=M(1/zn.toBeatTime(te.input.params.minSpeed,!1),2).toString()}function Og(t){const{swingAnalysis:e}=t.beatmap,{minSpeed:n}=te.input.params;return e.container.filter(i=>i.maxSpeed>n||i.minSpeed>n)}function Ag(t){const{minSpeed:e}=te.input.params,n=Og(t);return n.length?[{type:"time",label:`Slow slider (>${M(e*1e3,1)}ms)`,value:n.map(i=>i.data[0]),symbol:"warning"}]:[]}const am="Speed Pause",lm="Look for stream/burst containing timing gap causing sudden change of pace.",um=!1,cm=.075;let Vn;const[Pg,xr]=U.createNumber(function(){pe.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=M(pe.input.params.maxTime*1e3,1).toString(),Vn&&(Ir.value=M(1/Vn.toBeatTime(pe.input.params.maxTime,!1),2).toString())},"stream speed (ms): ",M(cm*1e3,1),0),[$g,Ir]=U.createNumber(function(){if(!Vn){this.value="0";return}let e=M(Math.abs(parseFloat(this.value)),2)||1;pe.input.params.maxTime=Vn.toRealTime(1/e),xr.value=M(pe.input.params.maxTime*1e3,1).toString(),this.value=e.toString()}," (prec): ",0,0),mm=U.createCheckbox(function(){pe.input.params.enabled=this.checked},am,lm,um);function Mg(t){mm[0].checked=pe.input.params.enabled,xr.value=(pe.input.params.maxTime*1e3).toString(),t&&hm(t)}const pe={name:am,description:lm,type:"note",order:{input:pt.NOTES_SPEED_PAUSE,output:dt.NOTES_SPEED_PAUSE},input:{params:{enabled:um,maxTime:cm},html:U.createBlock(mm,document.createElement("br"),Pg,xr,$g,Ir),update:Mg,adjustTime:hm},run:jg};function hm(t){Vn=t,Ir.value=M(1/Vn.toBeatTime(pe.input.params.maxTime,!1),2).toString()}function Fg(t){const e=t.timeProcessor,n=t.data.colorNotes,{maxTime:i}=pe.input.params,o=e.toBeatTime(i,!1)+.001,r={},l={},s={[ot.RED]:!1,[ot.BLUE]:!1},a={[ot.RED]:[],[ot.BLUE]:[]},u=[];for(let c=0,p=n.length;c<p;c++){const v=n[c];r[v.color]?de(v,r[v.color],e,a[v.color])&&(v.time-r[v.color].time<=o*2?(s[ot.RED]&&s[ot.BLUE]&&r[v.color].time-l[v.color].time<=o*3&&u.push(r[v.color]),s[v.color]=!1):s[v.color]||(s[v.color]=!0,l[v.color]=r[v.color]),a[v.color]=[],r[v.color]=v):r[v.color]=v,a[v.color].push(v)}return u}function jg(t){const e=Fg(t.beatmap);return e.length?[{type:"time",label:"Speed pause",value:e,symbol:"warning"}]:[]}const fm="Stacked Note",pm="Look for stacked note.",dm=!0,[bm,zg]=U.createCheckbox(function(){ho.input.params.enabled=this.checked},fm,pm,dm);function Vg(){bm.checked=ho.input.params.enabled}const ho={name:fm,description:pm,type:"note",order:{input:pt.NOTES_STACKED_NOTE,output:dt.NOTES_STACKED_NOTE},input:{params:{enabled:dm},html:U.createBlock(bm,zg),update:Vg},run:Ug};function Gg(t){const e=t.data.colorNotes,n=[];let i=0;for(let o=0,r=e.length;o<r;o++)if(!(e[o].customData.__mapcheck_secondtime<i+.01))for(let l=o+1;l<r&&!(e[l].customData.__mapcheck_secondtime>e[o].customData.__mapcheck_secondtime+.01);l++)e[l].isInline(e[o])&&(n.push(e[o]),i=e[o].customData.__mapcheck_secondtime);return n}function Hg(t){const e=t.timeProcessor,n=t.njs,i=t.data.bombNotes,o=[];for(let r=0,l=i.length;r<l;r++)for(let s=r+1;s<l&&!(i[s].customData.__mapcheck_secondtime>i[r].customData.__mapcheck_secondtime+1);s++)i[r].isInline(i[s])&&(n.value<e.bpm/(120*(i[s].time-i[r].time))||i[s].customData.__mapcheck_secondtime<i[r].customData.__mapcheck_secondtime+.02)&&o.push(i[r]);return o}function Ug(t){const e=Gg(t.beatmap),n=Hg(t.beatmap),i=[];return e.length&&i.push({type:"time",label:"Stacked note",value:e,symbol:"error"}),n.length&&i.push({type:"time",label:"Stacked bomb",value:n,symbol:"error"}),i}const gm="Varying Swing Speed",vm="Check for varying swing speed due to changes in slider distance.",_m=!0,[ym,Wg]=U.createCheckbox(function(){fo.input.params.enabled=this.checked},gm,vm,_m);function Yg(){ym.checked=fo.input.params.enabled}const fo={name:gm,description:vm,type:"note",order:{input:pt.NOTES_VARY_SWING,output:dt.NOTES_VARY_SWING},input:{params:{enabled:_m},html:U.createBlock(ym,Wg),update:Yg},run:qg};function Xg(t){const{swingAnalysis:e}=t;return e.container.filter(n=>Math.abs(n.minSpeed-n.maxSpeed)>.002)}function qg(t){const e=Xg(t.beatmap);return e.length?[{type:"time",label:"Varying swing speed",value:e.map(n=>n.data[0]),symbol:"error"}]:[]}const Em="Vision Block",wm="Check for vision block caused by center note.",Dm=!0,Sm=.1,Cm=.5;let ee;const tl={Easy:{min:.025,max:1.2},Normal:{min:.05,max:1},Hard:{min:.08,max:.75},Expert:{min:.1,max:.625},ExpertPlus:{min:.1,max:.5}},[Kg,pr]=U.createRadio(Lm," VB time specific ","vb-spec","time",!1),[Zg,dr]=U.createRadio(Lm," VB difficulty specific ","vb-spec","difficulty",!0),[Jg,Nr]=U.createNumber(function(){vt.input.params.minTime=Math.abs(parseFloat(this.value))/1e3,this.value=M(vt.input.params.minTime*1e3,1).toString(),ee&&(Or.value=M(ee.toBeatTime(vt.input.params.minTime,!1),2).toString(),vt.input.params.minTime>vt.input.params.maxTime&&(vt.input.params.maxTime=vt.input.params.minTime,oi.value=M(vt.input.params.maxTime*1e3,1).toString(),ri.value=M(ee.toBeatTime(vt.input.params.maxTime,!1),2).toString()))},"min time (ms): ",M(Sm*1e3,1),0),[Qg,Or]=U.createNumber(function(){if(!ee){this.value="0";return}const t=Math.abs(parseFloat(this.value))||1;vt.input.params.minTime=ee.toRealTime(t),Nr.value=M(vt.input.params.minTime*1e3,1).toString(),this.value=M(t,2).toString(),vt.input.params.minTime>vt.input.params.maxTime&&(vt.input.params.maxTime=vt.input.params.minTime,oi.value=M(vt.input.params.maxTime*1e3,1).toString(),ri.value=M(ee.toBeatTime(vt.input.params.maxTime,!1),2).toString())}," (beat): ",0,0,null,.1),[tv,oi]=U.createNumber(function(){vt.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=M(vt.input.params.maxTime*1e3,1).toString(),ee&&(ri.value=M(ee.toBeatTime(vt.input.params.maxTime,!1),2).toString())},"max time (ms): ",M(Cm*1e3,1),0),[ev,ri]=U.createNumber(function(){if(!ee){this.value="0";return}const t=Math.abs(parseFloat(this.value))||1;vt.input.params.maxTime=ee.toRealTime(t),oi.value=M(vt.input.params.maxTime*1e3,1).toString(),this.value=M(t,2).toString()}," (beat): ",0,0,null,.1),km=U.createCheckbox(function(){vt.input.params.enabled=this.checked},Em,wm,Dm);function nv(t){km[0].checked=vt.input.params.enabled,vt.input.params.specific==="difficulty"?(dr.checked=!0,pr.checked=!1):(dr.checked=!1,pr.checked=!0),Nr.value=(vt.input.params.minTime*1e3).toString(),oi.value=(vt.input.params.maxTime*1e3).toString(),t&&Tm(t)}const vt={name:Em,description:wm,type:"note",order:{input:pt.NOTES_VISION_BLOCK,output:dt.NOTES_VISION_BLOCK},input:{params:{enabled:Dm,specific:"difficulty",minTime:Sm,maxTime:Cm},html:U.createBlock(km,document.createElement("br"),pr,Kg,dr,Zg,document.createElement("br"),Jg,Nr,Qg,Or,document.createElement("br"),tv,oi,ev,ri),update:nv,adjustTime:Tm},run:ov};function Tm(t){ee=t,Or.value=M(ee.toBeatTime(vt.input.params.minTime,!1),2).toString(),ri.value=M(ee.toBeatTime(vt.input.params.maxTime,!1),2).toString()}function Lm(){vt.input.params.specific=this.value}function iv(t){const{timeProcessor:e,njs:n}=t.beatmap,i=t.beatmap.noteContainer.filter(v=>v.type!==lt.ARC),{minTime:o,maxTime:r,specific:l}=vt.input.params,s=l==="time"?e.toBeatTime(o,!1):e.toBeatTime(tl[t.beatmap.settings.difficulty].min,!1),a=l==="time"?e.toBeatTime(r,!1):Math.min(n.hjd,e.toBeatTime(tl[t.beatmap.settings.difficulty].max,!1));let u=null,c=null;const p=[];for(let v=0,m=i.length;v<m;v++){const h=i[v];u&&(h.data.time-u.data.time>=s&&h.data.time-u.data.time<=a?h.data.posX<ut.MIDDLE_RIGHT&&p.push(h):h.data.time-u.data.time>a&&(u=null)),c&&(h.data.time-c.data.time>=s&&h.data.time-c.data.time<=a?h.data.posX>ut.MIDDLE_LEFT&&p.push(h):h.data.time-c.data.time>a&&(c=null)),h.data.posY===Rt.MIDDLE&&h.data.posX===ut.MIDDLE_LEFT&&(u=h),h.data.posY===Rt.MIDDLE&&h.data.posX===ut.MIDDLE_RIGHT&&(c=h)}return p}function ov(t){const e=iv(t);return e.length?[{type:"time",label:"Vision block",value:e.map(n=>n.data),symbol:"warning"}]:[]}const Rm=Object.freeze(Object.defineProperty({__proto__:null,acceptablePrec:an,colorCheck:no,doubleDirectional:io,effectiveBPM:Kt,hitboxInline:oo,hitboxPath:ro,hitboxReverseStair:so,hitboxStair:ao,improperArc:lo,improperChain:uo,improperWindow:co,inlineAngle:fe,oneSaber:mo,parity:ii,shradoAngle:Yt,slowSlider:te,speedPause:pe,stackedNote:ho,varySwing:fo,visionBlock:vt},Symbol.toStringTag,{value:"Module"})),Bm="<15ms Obstacle",xm=`Look for obstacle with inadequate duration.
This causes player to not take damage when in collision with obstacle.`,Im=!0,[Nm,rv]=U.createCheckbox(function(){si.input.params.enabled=this.checked},Bm,xm,Im);function sv(){Nm.checked=si.input.params.enabled}const si={name:Bm,description:xm,type:"obstacle",order:{input:pt.OBSTACLES_SHORT,output:dt.OBSTACLES_SHORT},input:{params:{enabled:Im,minDur:.015},html:U.createBlock(Nm,rv),update:sv},run:lv};function av(t){const{obstacles:e}=t.beatmap.data,{timeProcessor:n}=t.beatmap,{minDur:i}=si.input.params,o=n.toBeatTime(i,!1),r=[];let l=new Pt,s=new Pt,a=new Pt,u=new Pt;for(let c=0;c<e.length;c++){const p=e[c];p.posY===Rt.BOTTOM&&p.height>2&&p.duration>0?p.width>2||p.width>1&&p.posX===1?(p.isLonger(l)&&(p.duration<o&&r.push(p),l=p),p.isLonger(s)&&(p.duration<o&&r.push(p),s=p)):p.width===2?p.posX===ut.LEFT?p.isLonger(l)&&(p.duration<o&&r.push(p),l=p):p.posX===ut.MIDDLE_RIGHT&&p.isLonger(s)&&(p.duration<o&&r.push(p),s=p):p.width===1&&(p.posX===ut.MIDDLE_LEFT?p.isLonger(l)&&(p.duration<o&&r.push(p),l=p):p.posX===ut.MIDDLE_RIGHT&&p.isLonger(s)&&(p.duration<o&&r.push(p),s=p)):p.posY===Rt.TOP&&p.height>2&&p.duration>0&&(p.width>2||p.width>1&&p.posX===ut.MIDDLE_LEFT?(p.isLonger(a)&&(p.duration<o&&p.isLonger(l,o)&&p.isLonger(a,o)&&r.push(p),a=p),p.isLonger(u)&&(p.duration<o&&p.isLonger(s,o)&&p.isLonger(u,o)&&r.push(p),u=p)):p.width===2?p.posX===ut.LEFT?p.isLonger(a)&&(p.duration<o&&p.isLonger(l,o)&&p.isLonger(a,o)&&r.push(p),a=p):p.posX===ut.MIDDLE_RIGHT&&p.isLonger(u)&&(p.duration<o&&p.isLonger(s,o)&&p.isLonger(u,o)&&r.push(p),u=p):p.width===1&&(p.posX===ut.MIDDLE_LEFT?p.isLonger(a)&&(p.duration<o&&p.isLonger(l,o)&&p.isLonger(a,o)&&r.push(p),a=p):p.posX===ut.MIDDLE_RIGHT&&p.isLonger(u)&&(p.duration<o&&p.isLonger(s,o)&&p.isLonger(u,o)&&r.push(p),u=p)))}return r}function lv(t){const e=av(t);return e.length?[{type:"time",label:"<15ms obstacle",value:e,symbol:"warning"}]:[]}const Om="2-wide Center Obstacle",Am="Look for 2-wide center obstacle including obstacles that are relatively close to each other.",Pm=!0,$m=.25;let Gn;const[uv,Ar]=U.createNumber(function(){ne.input.params.recovery=Math.abs(parseFloat(this.value))/1e3,this.value=M(ne.input.params.recovery*1e3,1).toString(),Gn&&(Pr.value=M(Gn.toBeatTime(ne.input.params.recovery,!1),2).toString())},"recovery time (ms): ",M($m*1e3,1),0),[cv,Pr]=U.createNumber(function(){if(!Gn){this.value="0";return}let t=M(Math.abs(parseFloat(this.value)),2)||1;ne.input.params.recovery=Gn.toRealTime(t,!0),Ar.value=M(ne.input.params.recovery*1e3,1).toString(),this.value=t.toString()}," (beat): ",0,0,.1),Mm=U.createCheckbox(function(){ne.input.params.enabled=this.checked},Om,Am,Pm);function mv(t){Mm[0].checked=ne.input.params.enabled,Ar.value=(ne.input.params.recovery*1e3).toString(),t&&Fm(t)}const ne={name:Om,description:Am,type:"obstacle",order:{input:pt.OBSTACLES_CENTER,output:dt.OBSTACLES_CENTER},input:{params:{enabled:Pm,recovery:$m},html:U.createBlock(Mm,document.createElement("br"),uv,Ar,cv,Pr),update:mv,adjustTime:Fm},run:fv};function Fm(t){Gn=t,Pr.value=M(Gn.toBeatTime(ne.input.params.recovery,!1),2).toString()}function hv(t){const{obstacles:e}=t.beatmap.data,{timeProcessor:n}=t.beatmap,{recovery:i}=ne.input.params,o=[];let r=new Pt,l=new Pt;for(let s=0;s<e.length;s++){const a=e[s];a.posY<Rt.TOP&&a.height>1&&(a.width>2&&(o.push(a),a.isLonger(r)&&(r=a),a.isLonger(l)&&(l=a)),a.width===2&&(a.posX===ut.LEFT&&a.isLonger(r)&&(a.customData.__mapcheck_secondtime>l.customData.__mapcheck_secondtime-i&&a.customData.__mapcheck_secondtime<l.customData.__mapcheck_secondtime+n.toRealTime(l.duration)+i&&o.push(a),r=a),a.posX===ut.MIDDLE_LEFT&&(o.push(a),a.isLonger(r)&&(r=a),a.isLonger(l)&&(l=a)),a.posX===ut.MIDDLE_RIGHT&&a.isLonger(l)&&(a.customData.__mapcheck_secondtime>r.customData.__mapcheck_secondtime-i&&a.customData.__mapcheck_secondtime<r.customData.__mapcheck_secondtime+n.toRealTime(r.duration)+i&&o.push(a),l=a)),a.width===1&&(a.posX===ut.MIDDLE_LEFT&&a.isLonger(r)&&(a.customData.__mapcheck_secondtime>l.customData.__mapcheck_secondtime-i&&a.customData.__mapcheck_secondtime<l.customData.__mapcheck_secondtime+n.toRealTime(l.duration)+i&&o.push(a),r=a),a.posX===ut.MIDDLE_RIGHT&&a.isLonger(l)&&(a.customData.__mapcheck_secondtime>r.customData.__mapcheck_secondtime-i&&a.customData.__mapcheck_secondtime<r.customData.__mapcheck_secondtime+n.toRealTime(r.duration)+i&&o.push(a),l=a)))}return o}function fv(t){const e=hv(t),{recovery:n}=ne.input.params;return e.length?[{type:"time",label:`2-wide center obstacle (<${M(n*1e3)}ms)`,value:e,symbol:"error"}]:[]}const jm="Zero Obstacle",zm="Look for obstacle with zero value.",Vm=!0,[Gm,pv]=U.createCheckbox(function(){po.input.params.enabled=this.checked},jm,zm,Vm);function dv(){Gm.checked=po.input.params.enabled}const po={name:jm,description:zm,type:"obstacle",order:{input:pt.OBSTACLES_ZERO,output:dt.OBSTACLES_ZERO},input:{params:{enabled:Vm},html:U.createBlock(Gm,pv),update:dv},run:gv};function bv(t){const{obstacles:e}=t.beatmap.data;return e.filter(n=>n.hasZero())}function gv(t){const e=bv(t);return e.length?[{type:"time",label:"Zero value obstacle",value:e,symbol:"error"}]:[]}const Hm=Object.freeze(Object.defineProperty({__proto__:null,centerObstacle:ne,shortObstacle:si,zeroObstacle:po},Symbol.toStringTag,{value:"Module"})),Um="Insufficient Lighting Event",Wm="Check if there is enough light event.",Ym=!0,[Xm,vv]=U.createCheckbox(function(){bo.input.params.enabled=this.checked},Um,Wm,Ym);function _v(){Xm.checked=bo.input.params.enabled}const bo={name:Um,description:Wm,type:"event",order:{input:pt.EVENTS_INSUFFICIENT_LIGHT,output:dt.EVENTS_INSUFFICIENT_LIGHT},input:{params:{enabled:Ym},html:U.createBlock(Xm,vv),update:_v},run:Ev};function yv(t,e){let n=0;for(let i=t.length-1;i>=0;i--)if(t[i].isLightEvent(e)&&!t[i].isOff()&&(n++,n>10))return!0;return!1}function Ev(t){const e=t.beatmap.environment;if(!yv(t.beatmap.data.basicEvents,e))switch(e){case"DefaultEnvironment":case"OriginsEnvironment":case"TriangleEnvironment":case"NiceEnvironment":case"BigMirrorEnvironment":case"DragonsEnvironment":case"KDAEnvironment":case"MonstercatEnvironment":case"CrabRaveEnvironment":case"PanicEnvironment":case"RocketEnvironment":case"GreenDayEnvironment":case"GreenDayGrenadeEnvironment":case"TimbalandEnvironment":case"FitBeatEnvironment":case"LinkinParkEnvironment":case"BTSEnvironment":case"KaleidoscopeEnvironment":case"InterscopeEnvironment":case"SkrillexEnvironment":case"BillieEnvironment":case"HalloweenEnvironment":case"GagaEnvironment":case"GlassDesertEnvironment":return[{type:"string",label:"Insufficient light event",value:"",symbol:"rank"}];default:return[{type:"string",label:"Unknown light event",value:"v3 environment light should be manually checked",symbol:"rank"}]}return[]}const qm="Invalid Event Box",Km="Check for valid event box group usage.",Zm=!0,[Jm,wv]=U.createCheckbox(function(){go.input.params.enabled=this.checked},qm,Km,Zm);function Dv(){Jm.checked=go.input.params.enabled}const go={name:qm,description:Km,type:"event",order:{input:pt.EVENTS_INVALID_EVENT_BOX,output:dt.EVENTS_INVALID_EVENT_BOX},input:{params:{enabled:Zm},html:U.createBlock(Jm,wv),update:Dv},run:Cv},el={EDMEnvironment:{0:24,1:24,2:24,3:24,4:24,5:24,6:10,7:10,8:10,9:10,10:10,11:10,12:10,13:10,14:1,15:1,16:1,17:1},LizzoEnvironment:{0:40,1:16,2:16,3:16,4:16,5:16,6:1,7:1,8:12,9:12,10:12,11:6,12:6,13:14,14:14,15:4,16:4,17:3,18:3,19:14},PyroEnvironment:{0:3,1:3,2:5,3:5,4:3,5:12,6:48,7:48,8:4,9:4,10:3,11:3,12:10,13:10},TheSecondEnvironment:{0:15,1:24,2:12,3:12,4:12,5:12,6:4,7:4,8:4,9:4,10:4,11:4,12:4,13:4},TheWeekndEnvironment:{0:4,1:4,2:4,3:4,4:8,5:4,6:4,7:12,8:1,9:6,10:25,11:25,12:25,13:25,14:25,15:25,16:25,17:25,18:25,19:25,20:3,21:3,22:8,23:8,29:3,30:3,31:3,32:3,33:3,34:3,35:3,36:3,37:6,38:6,40:2},RockMixtapeEnvironment:{0:5,1:5,2:10,3:10,4:10,5:10,6:10,7:10,8:10,9:10,10:10,11:10,12:10,13:10,14:3,15:10,16:5,17:5,18:24,19:24,20:12,21:12,22:8,23:8,24:36,25:3,26:36,27:3,28:5,29:2,30:16,31:4,32:4,33:4,34:4,35:2,36:2,37:2},WeaveEnvironment:{0:8,1:8,2:8,3:8,4:8,5:8,6:8,7:8,8:8,9:8,10:8,11:8,12:12,13:12,14:8,15:8},Dragons2Environment:{0:24,1:96,2:35,3:15,4:8,5:12,6:12,7:5,8:5,9:5,10:5,11:5,12:5},Panic2Environment:{0:7,1:7,2:7,3:7,4:8,5:8,6:24,7:24,8:24,9:6,10:6,11:6,12:6,13:14,14:14,15:2,16:28,17:28,18:1,19:1,20:12,21:1,22:12,23:1}};function Sv(t,e){const n=[],i=[];if(!el[e])return{defectID:[],defectFilter:[]};const o=e,r=Dn[o][1],l=[...t.lightColorEventBoxGroups,...t.lightRotationEventBoxGroups,...t.lightTranslationEventBoxGroups];for(const s of l){r.includes(s.id)||n.push(s);for(const a of s.boxes){const u=a.filter;u.type===er.STEP_AND_OFFSET&&u.p0>el[o][s.id]&&i.push(s)}}return{defectID:n,defectFilter:i}}function Cv(t){const e=Sv(t.beatmap.data,t.beatmap.environment),n=[];return e.defectID.length&&n.push({type:"time",label:"Invalid event box group ID",value:e.defectID,symbol:"error"}),e.defectFilter.length&&n.push({type:"time",label:"Invalid event box filter",value:e.defectFilter,symbol:"error"}),n}const Qm="Unlit Bomb",th="Check for lighting around bomb.",eh=!0,[nh,kv]=U.createCheckbox(function(){vo.input.params.enabled=this.checked},Qm,th,eh);function Tv(){nh.checked=vo.input.params.enabled}const vo={name:Qm,description:th,type:"event",order:{input:pt.EVENTS_UNLIT_BOMB,output:dt.EVENTS_UNLIT_BOMB},input:{params:{enabled:eh},html:U.createBlock(nh,kv),update:Tv},run:Rv},Lv=(t,e,n,i)=>{var p;if(!e.length)return[];const o=[],r=((p=Dn[i])==null?void 0:p[0])??Dn.DefaultEnvironment[0],l=e.filter(v=>v.isLightEvent(i)&&r.includes(v.type)).sort((v,m)=>v.type-m.type),s={0:{state:"off",time:0,fadeTime:0},1:{state:"off",time:0,fadeTime:0},2:{state:"off",time:0,fadeTime:0},3:{state:"off",time:0,fadeTime:0},4:{state:"off",time:0,fadeTime:0},6:{state:"off",time:0,fadeTime:0},7:{state:"off",time:0,fadeTime:0},10:{state:"off",time:0,fadeTime:0},11:{state:"off",time:0,fadeTime:0}},a={};r.forEach(v=>a[v]=[[0,!1]]);const u=n.toBeatTime(1,!1),c=n.toBeatTime(.25,!1);for(let v=0,m=l.length;v<m;v++){const h=l[v];if((h.isOn()||h.isFlash())&&s[h.type].state!=="on"){s[h.type]={state:"on",time:h.time,fadeTime:0};const d=a[h.type].find(y=>y[0]>=h.time);d?(d[0]=h.time,d[1]=!0):a[h.type].push([h.time,!0])}if(h.isFade()){s[h.type]={state:"off",time:h.time,fadeTime:u};const d=a[h.type].find(y=>y[0]>=h.time);d?(d[0]=h.time,d[1]=!0):a[h.type].push([h.time,!0]),a[h.type].push([h.time+u,!1])}(((h==null?void 0:h.floatValue)??1)<.25||h.isOff()||h.customData._color&&(typeof h.customData._color[3]=="number"&&h.customData._color[3]<.25||Math.max(h.customData._color[0],h.customData._color[1],h.customData._color[2])<.25)||h.customData.color&&(typeof h.customData.color[3]=="number"&&h.customData.color[3]<.25||Math.max(h.customData.color[0],h.customData.color[1],h.customData.color[2])<.25))&&s[h.type].state!=="off"&&(s[h.type]={state:"off",time:h.time,fadeTime:s[h.type].state==="on"?c:Math.min(c,s[h.type].fadeTime)},a[h.type].push([h.time+(s[h.type].state==="on"?c:Math.min(c,s[h.type].fadeTime)),!1]))}for(const v in a)a[v].reverse();for(let v=0,m=t.length,h=!1;v<m;v++){const d=t[v];h=!1;for(const y in a){const g=a[y].find(_=>_[0]<=d.time);g&&(h=h||g[1])}h||o.push(d)}return o};function Rv(t){const e=Lv(t.beatmap.data.bombNotes,t.beatmap.data.basicEvents,t.beatmap.timeProcessor,t.beatmap.environment);return e.length?[{type:"time",label:"Unlit bomb",value:e,symbol:"warning"}]:[]}const ih=Object.freeze(Object.defineProperty({__proto__:null,insufficientLight:bo,invalidEventBox:go,unlitBomb:vo},Symbol.toStringTag,{value:"Module"})),oh="Hot Start",rh="Check for first interactive object starting from start time.",sh=!0,ah=1.5,[lh,Bv]=U.createCheckbox(function(){ln.input.params.enabled=this.checked},oh+" (s): ",rh,sh),[xv,uh]=U.createNumber(function(){ln.input.params.time=M(Math.abs(parseFloat(this.value)),3),this.value=ln.input.params.time.toString()},"",ah,0,null,.1);function Iv(){lh.checked=ln.input.params.enabled,uh.value=ln.input.params.time.toString()}const ln={name:oh,description:rh,type:"other",order:{input:pt.OTHERS_HOT_START,output:dt.OTHERS_HOT_START},input:{params:{enabled:sh,time:ah},html:U.createBlock(lh,Bv,xv,uh),update:Iv},run:Nv};function Nv(t){const{time:e}=ln.input.params,n=t.beatmap.timeProcessor.toRealTime(yr(t.beatmap.data));return n<e?[{type:"string",label:"Hot start",value:`${M(n,2)}s`,symbol:"warning"}]:[]}const ch="Difficulty Label Check",mh="For ranking purpose, check difficulty label to fit rankability criteria.",hh=!0,[fh,Ov]=U.createCheckbox(function(){_o.input.params.enabled=this.checked},ch,mh,hh);function Av(){fh.checked=_o.input.params.enabled}const _o={name:ch,description:mh,type:"other",order:{input:pt.OTHERS_DIFFICULTY_LABEL,output:dt.OTHERS_DIFFICULTY_LABEL},input:{params:{enabled:hh},html:U.createBlock(fh,Ov),update:Av},run:Pv};function Pv(t){const e=t.beatmap.settings.customData._difficultyLabel;return e&&e.length>30?[{type:"string",label:`Difficulty label is too long (${e.length} characters)`,value:"exceeded 30 max characters by ranking criteria",symbol:"rank"}]:[]}const ph="NJS Check",dh="Check note jump speed for suitable value.",bh=!0,[gh,$v]=U.createCheckbox(function(){yo.input.params.enabled=this.checked},ph,dh,bh);function Mv(){gh.checked=yo.input.params.enabled}const yo={name:ph,description:dh,type:"other",order:{input:pt.OTHERS_NJS,output:dt.OTHERS_NJS},input:{params:{enabled:bh},html:U.createBlock(gh,$v),update:Mv},run:Fv};function Fv(t){const{njs:e,timeProcessor:n}=t.beatmap,i=[];return t.beatmap.settings.njs===0&&i.push({type:"string",label:"Unset NJS",value:"fallback NJS is used",symbol:"error"}),e.value>23&&i.push({type:"string",label:`NJS is too high (${M(e.value,2)})`,value:"use lower whenever possible",symbol:"warning"}),e.value<3&&i.push({type:"string",label:`NJS is too low (${M(e.value,2)})`,value:"timing is less significant below this",symbol:"warning"}),e.jd>36&&i.push({type:"string",label:"Very high jump distance",value:`${M(e.jd,2)}`,symbol:"warning"}),e.jd<18&&i.push({type:"string",label:"Very low jump distance",value:`${M(e.jd,2)}`,symbol:"warning"}),e.jd>e.calcJdOptimal()[1]&&i.push({type:"string",label:`High jump distance warning (>${M(e.calcJdOptimal()[1],2)})`,value:"NJS & offset may be uncomfortable to play",symbol:"warning"}),n.toRealTime(e.hjd,!1)<.42&&i.push({type:"string",label:`Very quick reaction time (${M(n.toRealTime(e.hjd,!1)*1e3)}ms)`,value:"may lead to suboptimal gameplay",symbol:"warning"}),e.calcHjd(0)+e.offset<he.HJD_MIN&&i.push({type:"string",label:"Unnecessary negative offset",value:`will not drop below ${he.HJD_MIN}`,symbol:"warning"}),i}const vh="Outside Playable Object",_h="Look for any object starting before and after song timer.",yh=!0,[Eh,jv]=U.createCheckbox(function(){Eo.input.params.enabled=this.checked},vh,_h,yh);function zv(){Eh.checked=Eo.input.params.enabled}const Eo={name:vh,description:_h,type:"other",order:{input:pt.OTHERS_OUTSIDE_PLAYABLE,output:dt.OTHERS_OUTSIDE_PLAYABLE},input:{params:{enabled:yh},html:U.createBlock(Eh,jv),update:zv},run:Vv};function oe(t,e,n){e.length&&e[0].time<0&&n.push({type:"string",label:t+"(s) before start time",value:`${M(e[0].time,3)} (${Jt(e[0].customData.__mapcheck_secondtime)}`,symbol:"error"})}function re(t,e,n,i){e.length&&e[e.length-1].time>n&&i.push({type:"string",label:t+"(s) after end time",value:`${M(e[e.length-1].time,3)} (${Jt(e[e.length-1].customData.__mapcheck_secondtime)})`,symbol:"error"})}function Vv(t){const e=t.audioDuration,n=t.beatmap.timeProcessor,{colorNotes:i,bombNotes:o,obstacles:r,arcs:l,chains:s,basicEvents:a,colorBoostEvents:u,waypoints:c,lightColorEventBoxGroups:p,lightRotationEventBoxGroups:v,lightTranslationEventBoxGroups:m,fxEventBoxGroups:h}=t.beatmap.data,d=[];if(e){let y=n.toBeatTime(e,!0);oe("Note",i,d),oe("Bomb",o,d),oe("Obstacle",r,d),oe("Arc",l,d),oe("Chain",s,d),oe("Event",a,d),oe("Color Boost",u,d),oe("Waypoint",c,d),oe("Light Color Event Box Group",p,d),oe("Light Rotation Event Box Group",v,d),oe("Light Translation Event Box Group",m,d),oe("FX Event Box Group",h,d),re("Note",i,y,d),re("Bomb",o,y,d),re("Obstacle",r,y,d),re("Arc",l,y,d),re("Chain",s,y,d),re("Event",a,y,d),re("Color Boost",u,y,d),re("Waypoint",c,y,d),re("Light Color Event Box Group",p,y,d),re("Light Rotation Event Box Group",v,y,d),re("Light Translation Event Box Group",m,y,d),re("FX Event Box Group",h,y,d)}return d}const wh="Invalid Object",Dh="Validate beatmap object to be compatible with vanilla (ignores for modded).",Sh=!0,[Ch,Gv]=U.createCheckbox(function(){wo.input.params.enabled=this.checked},wh,Dh,Sh);function Hv(){Ch.checked=wo.input.params.enabled}const wo={name:wh,description:Dh,type:"other",order:{input:pt.OTHERS_INVALID_OBJECT,output:dt.OTHERS_INVALID_OBJECT},input:{params:{enabled:Sh},html:U.createBlock(Ch,Gv),update:Hv},run:Uv};function Uv(t){var W,et;const{colorNotes:e,bombNotes:n,obstacles:i,arcs:o,chains:r,waypoints:l,basicEvents:s,colorBoostEvents:a,lightColorEventBoxGroups:u,lightRotationEventBoxGroups:c,lightTranslationEventBoxGroups:p,fxEventBoxGroups:v}=t.beatmap.data;let m=[],h=[],d=[],y=[],g=[];if(!((W=t.beatmap.settings.customData._requirements)!=null&&W.includes("Mapping Extensions")))if((et=t.beatmap.settings.customData._requirements)!=null&&et.includes("Noodle Extensions")){const S=t.beatmap.rawVersion===2?Sl:Tl;m=e.filter(Rl),h=i.filter(S),d=n.filter(Ll),y=o.filter(bp),g=r.filter(gp)}else m=e.filter(S=>!S.isValid()),h=i.filter(S=>!S.isValid()),d=n.filter(S=>!S.isValid()),y=o.filter(S=>!S.isValid()),g=r.filter(S=>!S.isValid());const _=l.filter(S=>!S.isValid()),D=s.filter(S=>!S.isValid()),C=a.filter(S=>!S.isValid()),k=u.filter(S=>!S.isValid()),P=c.filter(S=>!S.isValid()),A=p.filter(S=>!S.isValid()),V=v.filter(S=>!S.isValid()),x=[];return m.length&&x.push({type:"time",label:"Invalid note",value:m,symbol:"error"}),d.length&&x.push({type:"time",label:"Invalid bomb",value:d,symbol:"error"}),y.length&&x.push({type:"time",label:"Invalid arc",value:y,symbol:"error"}),g.length&&x.push({type:"time",label:"Invalid chain",value:g,symbol:"error"}),h.length&&x.push({type:"time",label:"Invalid obstacle",value:h,symbol:"error"}),_.length&&x.push({type:"time",label:"Invalid waypoint",value:_,symbol:"error"}),D.length&&x.push({type:"time",label:"Invalid event",value:D,symbol:"error"}),C.length&&x.push({type:"time",label:"Invalid color boost",value:C,symbol:"error"}),k.length&&x.push({type:"time",label:"Invalid light color event",value:k,symbol:"error"}),P.length&&x.push({type:"time",label:"Invalid light rotation event",value:P,symbol:"error"}),A.length&&x.push({type:"time",label:"Invalid light translation event",value:A,symbol:"error"}),V.length&&x.push({type:"time",label:"Invalid FX event",value:V,symbol:"error"}),x}const kh=Object.freeze(Object.defineProperty({__proto__:null,difficultyLabel:_o,hotStart:ln,invalidObject:wo,njs:yo,outsidePlayable:Eo},Symbol.toStringTag,{value:"Module"}));function Th(){return Object.values(Rm)}function Lh(){return Object.values(Hm)}function Rh(){return Object.values(ih)}function Bh(){return Object.values(kh)}function Wv(){return Object.values(Pu)}function Yv(){return[...Th(),...Lh(),...Rh(),...Bh()]}function Xv(){return[...Th(),...Lh(),...Rh(),...Bh(),...Wv()]}const nl={...Rm,...Hm,...ih,...kh,...Pu},xh={aprilFools:{params:{enabled:!0}},audio:{params:{enabled:!0}},coverImage:{params:{enabled:!0}},previewTime:{params:{enabled:!0}},progression:{params:{enabled:!0,"Expert+":!0,ExpertPlus:!0,Expert:!0,Hard:!0,Normal:!0,Easy:!0}},zip:{params:{enabled:!0}},acceptablePrec:{params:{enabled:!0,prec:[8,6]}},colorCheck:{params:{enabled:!0}},doubleDirectional:{params:{enabled:!0}},effectiveBPM:{params:{enabled:!0,ebpmThres:450,ebpmsThres:350}},hitboxInline:{params:{enabled:!0}},hitboxPath:{params:{enabled:!0}},hitboxReverseStair:{params:{enabled:!0}},hitboxStair:{params:{enabled:!0}},improperArc:{params:{enabled:!0}},improperChain:{params:{enabled:!0}},improperWindow:{params:{enabled:!0}},inlineAngle:{params:{enabled:!0,maxTime:.15}},oneSaber:{params:{enabled:!0}},parity:{params:{enabled:!1,warningThres:90,errorThres:45,allowedRot:90}},shradoAngle:{params:{enabled:!1,distance:1,maxTime:.15}},slowSlider:{params:{enabled:!0,minSpeed:.025}},speedPause:{params:{enabled:!1,maxTime:.075}},stackedNote:{params:{enabled:!0}},varySwing:{params:{enabled:!0}},visionBlock:{params:{enabled:!0,specific:"difficulty",minTime:.1,maxTime:.5}},centerObstacle:{params:{enabled:!0,recovery:.25}},shortObstacle:{params:{enabled:!0,minDur:.015}},zeroObstacle:{params:{enabled:!0}},insufficientLight:{params:{enabled:!0}},invalidEventBox:{params:{enabled:!0}},unlitBomb:{params:{enabled:!0}},difficultyLabel:{params:{enabled:!0}},hotStart:{params:{enabled:!0,time:1.5}},invalidObject:{params:{enabled:!0}},njs:{params:{enabled:!0}},outsidePlayable:{params:{enabled:!0}}},Ih={aprilFools:{params:{enabled:!0}},audio:{params:{enabled:!1}},coverImage:{params:{enabled:!0}},previewTime:{params:{enabled:!0}},progression:{params:{enabled:!1,"Expert+":!0,ExpertPlus:!0,Expert:!0,Hard:!0,Normal:!0,Easy:!0}},zip:{params:{enabled:!0}},acceptablePrec:{params:{enabled:!0,prec:[8,6]}},colorCheck:{params:{enabled:!0}},doubleDirectional:{params:{enabled:!0}},effectiveBPM:{params:{enabled:!0,ebpmThres:450,ebpmsThres:350}},hitboxInline:{params:{enabled:!0}},hitboxPath:{params:{enabled:!0}},hitboxReverseStair:{params:{enabled:!0}},hitboxStair:{params:{enabled:!0}},improperArc:{params:{enabled:!0}},improperChain:{params:{enabled:!0}},improperWindow:{params:{enabled:!0}},inlineAngle:{params:{enabled:!0,maxTime:.25}},oneSaber:{params:{enabled:!0}},parity:{params:{enabled:!0,warningThres:90,errorThres:45,allowedRot:90}},shradoAngle:{params:{enabled:!1,distance:1,maxTime:.15}},slowSlider:{params:{enabled:!0,minSpeed:.02}},speedPause:{params:{enabled:!1,maxTime:.075}},stackedNote:{params:{enabled:!0}},varySwing:{params:{enabled:!0}},visionBlock:{params:{enabled:!0,specific:"time",minTime:.1,maxTime:.75}},centerObstacle:{params:{enabled:!0,recovery:.4}},shortObstacle:{params:{enabled:!0,minDur:.015}},zeroObstacle:{params:{enabled:!0}},insufficientLight:{params:{enabled:!0}},invalidEventBox:{params:{enabled:!0}},unlitBomb:{params:{enabled:!0}},difficultyLabel:{params:{enabled:!1}},hotStart:{params:{enabled:!0,time:1.5}},invalidObject:{params:{enabled:!0}},njs:{params:{enabled:!0}},outsidePlayable:{params:{enabled:!0}}},$r={aprilFools:{params:N(fu.input.params)},audio:{params:N(Qi.input.params)},coverImage:{params:N(to.input.params)},previewTime:{params:N(eo.input.params)},progression:{params:N(Sn.input.params)},zip:{params:N(Ji.input.params)},acceptablePrec:{params:N(an.input.params)},colorCheck:{params:N(no.input.params)},doubleDirectional:{params:N(io.input.params)},effectiveBPM:{params:N(Kt.input.params)},hitboxInline:{params:N(oo.input.params)},hitboxPath:{params:N(ro.input.params)},hitboxReverseStair:{params:N(so.input.params)},hitboxStair:{params:N(ao.input.params)},improperArc:{params:N(lo.input.params)},improperChain:{params:N(uo.input.params)},improperWindow:{params:N(co.input.params)},inlineAngle:{params:N(fe.input.params)},oneSaber:{params:N(mo.input.params)},parity:{params:N(ii.input.params)},shradoAngle:{params:N(Yt.input.params)},slowSlider:{params:N(te.input.params)},speedPause:{params:N(pe.input.params)},stackedNote:{params:N(ho.input.params)},varySwing:{params:N(fo.input.params)},visionBlock:{params:N(vt.input.params)},centerObstacle:{params:N(ne.input.params)},shortObstacle:{params:N(si.input.params)},zeroObstacle:{params:N(po.input.params)},insufficientLight:{params:N(bo.input.params)},invalidEventBox:{params:N(go.input.params)},unlitBomb:{params:N(vo.input.params)},difficultyLabel:{params:N(_o.input.params)},hotStart:{params:N(ln.input.params)},invalidObject:{params:N(wo.input.params)},njs:{params:N(yo.input.params)},outsidePlayable:{params:N(Eo.input.params)}},Jn=N($r);(function(){if(localStorage==null)return;const e=localStorage.getItem("checks");if(e){const n=JSON.parse(e);if(!n)return;for(const i in Jn){const o=i;typeof Jn[o]==typeof n[o]&&(Jn[o]=n[o])}}})();const Nh={aprilFools:{params:{enabled:!0}},audio:{params:{enabled:!0}},coverImage:{params:{enabled:!0}},previewTime:{params:{enabled:!0}},progression:{params:{enabled:!0,"Expert+":!0,ExpertPlus:!0,Expert:!0,Hard:!0,Normal:!0,Easy:!0}},zip:{params:{enabled:!0}},acceptablePrec:{params:{enabled:!0,prec:[8,6]}},colorCheck:{params:{enabled:!0}},doubleDirectional:{params:{enabled:!0}},effectiveBPM:{params:{enabled:!0,ebpmThres:450,ebpmsThres:350}},hitboxInline:{params:{enabled:!0}},hitboxPath:{params:{enabled:!0}},hitboxReverseStair:{params:{enabled:!0}},hitboxStair:{params:{enabled:!0}},improperArc:{params:{enabled:!0}},improperChain:{params:{enabled:!0}},improperWindow:{params:{enabled:!0}},inlineAngle:{params:{enabled:!0,maxTime:.15}},oneSaber:{params:{enabled:!0}},parity:{params:{enabled:!1,warningThres:90,errorThres:45,allowedRot:90}},shradoAngle:{params:{enabled:!1,distance:1,maxTime:.15}},slowSlider:{params:{enabled:!0,minSpeed:.025}},speedPause:{params:{enabled:!1,maxTime:.075}},stackedNote:{params:{enabled:!0}},varySwing:{params:{enabled:!0}},visionBlock:{params:{enabled:!0,specific:"difficulty",minTime:.1,maxTime:.5}},centerObstacle:{params:{enabled:!0,recovery:.25}},shortObstacle:{params:{enabled:!0,minDur:.015}},zeroObstacle:{params:{enabled:!0}},insufficientLight:{params:{enabled:!0}},invalidEventBox:{params:{enabled:!0}},unlitBomb:{params:{enabled:!0}},difficultyLabel:{params:{enabled:!0}},hotStart:{params:{enabled:!0,time:1.5}},invalidObject:{params:{enabled:!0}},njs:{params:{enabled:!0}},outsidePlayable:{params:{enabled:!0}}},Ui={BeatLeader:xh,Beginner:Ih,Custom:Jn,Default:$r,ScoreSaber:Nh},il={BeatLeader:N(xh),Beginner:N(Ih),Custom:N(Jn),Default:N($r),ScoreSaber:N(Nh)};function Oh(t,e,n,i,o,r){const l=document.createElement("div");l.className="tabs__container";const s=document.createElement("input");s.className="tabs__radio",s.type="radio",s.id=t,s.name=n,s.value=i,s.checked=o,s.addEventListener("change",r),l.appendChild(s);const a=document.createElement("label");a.className="tabs__label tabs__label-block unselectable",a.htmlFor=t;const u=document.createElement("div"),c=e.split(`
`);for(let p=0;p<c.length;p++){const v=c[p],m=document.createElement("span");m.textContent=v,u.appendChild(m),p!==c.length-1&&u.appendChild(document.createElement("br"))}return a.appendChild(u),l.appendChild(a),l}const qv=document.getElementById("tabs__info"),Kv=document.getElementById("tabs__checks"),Zv=document.getElementById("tabs__stats"),Jv=document.getElementById("tabs__settings");function Qv(t){qv.checked=t==="info",Kv.checked=t==="checks",Zv.checked=t==="stats",Jv.checked=t==="settings"}const Nn=document.querySelector("#select-characteristic"),$e=document.querySelector("#select-difficulty");let Bi=[],Qn=[];const Do=[];function Ah(t){for(;Nn.firstChild;)Nn.removeChild(Nn.firstChild);for(Bi=[];$e.firstChild;)$e.removeChild($e.firstChild);if(Qn=[],!t){const i=document.createElement("div");i.className="selection__content";const o=document.createElement("span");o.textContent="Empty",i.appendChild(o),Nn.appendChild(i),xi();return}let e=!0;const n=new Set;if(t.difficulties.forEach(i=>{var s;if(n.has(i.characteristic))return;n.add(i.characteristic);const o=(s=t.customData._characteristics)==null?void 0:s.find(a=>a.characteristic===i.characteristic),r=o?`${o.label}
(${us[i.characteristic]||i.characteristic})`:us[i.characteristic]||i.characteristic,l=Oh(`select-${i.characteristic}`,r,"select-characteristic",i.characteristic,e,t_);Bi.push(l.firstChild),Nn.appendChild(l),e&&(xi(i.characteristic),e=!1)}),Bi.length===0){const i=document.createElement("div");i.className="selection__content";const o=document.createElement("span");o.textContent="Empty",i.appendChild(o),Nn.appendChild(i),xi()}}function xi(t){const e=at.beatmapInfo;let n=cn();for(;$e.firstChild;)$e.removeChild($e.firstChild);if(Qn=[],!t||!e){const o=document.createElement("div");o.className="selection__content";const r=document.createElement("span");r.textContent="Empty",o.appendChild(r),$e.appendChild(o);return}const i=e.difficulties.findIndex(o=>o.difficulty===n&&o.characteristic===t);for(let o=0;o<e.difficulties.length;o++){const r=e.difficulties[o];if(t!==r.characteristic)continue;const l=r.customData._difficultyLabel?`${r.customData._difficultyLabel}
(${en[r.difficulty]||r.difficulty})`:en[r.difficulty]||r.difficulty,s=Oh(`select-${r.difficulty}`,l,"select-difficulty",r.difficulty,i===-1||o===i,e_);if(Qn.push(s.firstChild),$e.appendChild(s),i===-1||o===i){const a=at.beatmaps.find(u=>u.settings.difficulty===r.difficulty&&u.settings.characteristic===e.difficulties[o].characteristic);if(!a)throw new Error("missing data");mu(at.beatmapInfo,a),Do.forEach(u=>u(r.characteristic,r.difficulty))}}if(Qn.length===0){const o=document.createElement("div");o.className="selection__content";const r=document.createElement("span");r.textContent="Empty",o.appendChild(r),$e.appendChild(o)}}function t_(t){var i;const e=t.target,n=(i=at.beatmapInfo)==null?void 0:i.difficulties.find(o=>o.characteristic===e.value);xi(n==null?void 0:n.characteristic)}function e_(t){var o,r;const e=t.target,n=(o=at.beatmapInfo)==null?void 0:o.difficulties.find(l=>l.characteristic===un());if(!n)throw new Error("aaaaaaaaaaaaaaaaaaa");const i=(r=at.beatmaps)==null?void 0:r.find(l=>l.settings.difficulty===e.value&&l.settings.characteristic===n.characteristic);i&&(mu(at.beatmapInfo,i),Do.forEach(l=>l(i.settings.characteristic,i.settings.difficulty)))}function un(){var t;return((t=Bi.filter(e=>e.checked)[0])==null?void 0:t.value)??null}function cn(){var t;return((t=Qn.filter(e=>e.checked)[0])==null?void 0:t.value)??null}function n_(){Ah()}const Ph={populateSelectCharacteristic:Ah,reset:n_};function _n(t){return["checks",t]}const $h=Xv().sort((t,e)=>t.order.input-e.order.input),Mh=[...$h].sort((t,e)=>t.order.output-e.order.output);function Fh(){at.analysis={general:{output:[]},beatmap:[]}}function i_(t){var o,r,l;const e=un(),n=cn(),i=(o=at.beatmaps)==null?void 0:o.find(s=>s.settings.characteristic===e&&s.settings.difficulty===n);for(const s in t){const a=s;nl[a].input.params=t[a].params,(l=(r=nl[a].input).update)==null||l.call(r,i==null?void 0:i.timeProcessor)}}function o_(){var i;const t=at.beatmapInfo;if(!t)return Z.tError(_n("checkGeneral"),"Could not analyse, missing map info"),[];at.analysis||Fh();const e=(i=at.analysis)==null?void 0:i.general;Z.tInfo(_n("checkGeneral"),"Analysing general");const n=[];return Mh.filter(o=>o.type==="general").forEach(o=>{if(o.input.params.enabled)try{const r=o.run({audioDuration:at.duration??null,mapDuration:0,beatmap:null,info:t});n.push(...r)}catch(r){Z.tError(_n("checkGeneral"),r)}}),e&&(e.output=n),n}function jh(t,e){var l,s,a;const n=at.beatmapInfo;if(!n)return Z.tError(_n("checkDifficulty"),"Could not analyse, missing map info"),[];at.analysis||Fh();const i=(l=at.beatmaps)==null?void 0:l.find(u=>u.settings.characteristic===t&&u.settings.difficulty===e);if(!i)return Z.tError(_n("checkDifficulty"),"Could not analyse, missing map data"),[];const o=(s=at.analysis)==null?void 0:s.beatmap.find(u=>u.difficulty===e&&u.characteristic===t);Z.tInfo(_n("checkDifficulty"),`Analysing ${t} ${e}`);const r=[];return Mh.filter(u=>u.type!=="general").forEach(u=>{if(u.input.params.enabled)try{const c=u.run({audioDuration:at.duration??null,mapDuration:i.timeProcessor.toRealTime(ti(i.data)),beatmap:i,info:n});r.push(...c)}catch(c){Z.tError(_n("runDifficulty"),c)}}),o?o.output=r:(a=at.analysis)==null||a.beatmap.push({characteristic:t,difficulty:e,output:r}),r}function r_(t){Yv().sort((n,i)=>n.order.output-i.order.output).forEach(n=>{n.input.adjustTime&&n.input.adjustTime(t)})}function s_(){var t;(t=at.beatmaps)==null||t.forEach(e=>jh(e.settings.characteristic,e.settings.difficulty))}const Cn={toolListInput:$h,runGeneral:o_,runDifficulty:jh,adjustTime:r_,applyAll:s_};function zh(t,e){switch(e){case"rank":t='<span title="Ranking: for rankability reason.">  </span>'+t;break;case"error":t='<span title="Error: should be fixed unless you know what you are doing.">  </span>'+t;break;case"warning":t='<span title="Warning: not necessarily needed to be fixed, worth considering.">  </span>'+t;break;case"info":t='<span title="Info: no action necessary, take note.">  </span>'+t;break}return t}function ol(t,e,n){const i=document.createElement("div");return t=zh(t,n),e?i.innerHTML=`<b>${t}:</b> ${e}`:i.innerHTML=`<b>${t}</b>`,i}function a_(t,e,n){return e===0||t.time!==n[e-1].time}function l_(t,e,n){const i=document.createElement("div");return tt.deduplicateTime&&(e=e.filter(a_)),t=zh(t,n),i.innerHTML=`<b>${t} [${e.length}]:</b> ${e.map(o=>{switch(tt.beatNumbering){case"realtime":return`<span title="Beat ${M(o.customData.__mapcheck_beattime,tt.rounding)}">${Jt(o.customData.__mapcheck_secondtime)}</span>`;case"realtimems":return`<span title="Beat ${M(o.customData.__mapcheck_beattime,tt.rounding)}">${Ci(o.customData.__mapcheck_secondtime)}</span>`;case"jsontime":return`<span title="Time ${Ci(o.customData.__mapcheck_secondtime)}">${M(o.time,tt.rounding)}</span>`;case"beattime":default:return`<span title="Time ${Ci(o.customData.__mapcheck_secondtime)}">${M(o.customData.__mapcheck_beattime,tt.rounding)}</span>`}}).join(", ")}`,i}const wn=document.querySelector(".checks__preset"),u_=document.querySelector(".checks__preset-reset"),Vh=document.querySelector(".checks__preset-save");wn.addEventListener("change",Mr);u_.addEventListener("click",m_);Vh.addEventListener("click",h_);function c_(){tt.checks.persistent?wn.value=tt.checks.preset:wn.value=wn.options[0].value,Mr()}function Mr(){const t=wn.value;tt.checks.persistent&&(tt.checks.preset=t,tt.save()),Vh.disabled=t!=="Custom",i_(Ui[t])}function m_(){const t=wn.value;t==="Custom"?Ui[t]=N(il.Default):Ui[t]=N(il[t]),Mr()}function h_(){wn.value==="Custom"&&f_()}function f_(){localStorage&&localStorage.setItem("checks",JSON.stringify(Ui.Custom))}const p_=document.querySelector(".checks__output-button");p_.addEventListener("click",d_);function d_(){var u;const t=un(),e=cn();if(!t||!e)return;const n=(u=at.analysis)==null?void 0:u.beatmap.find(c=>c.difficulty===e&&c.characteristic===t);if(!n)return;const i={Easy:"3cb472",Normal:"57b0f4",Hard:"ff6347",Expert:"c02a43",ExpertPlus:"8f48db","Expert+":"8f48db"},o=ft(Qt(Co(0,360),Co(.6,.8),Co(.75,.875),"hsva")).slice(1).toUpperCase(),r={name:"Map Check Auto-generated",difficulty:e,characteristic:t,color:i[e]??o,bookmarks:n.output.filter(c=>c.type==="time").flatMap(c=>{const p=c;return p.value.map(v=>({beat:v.time,label:p.label,text:""}))}).sort((c,p)=>c.beat-p.beat)},l=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),s=URL.createObjectURL(l),a=document.createElement("a");a.href=s,a.download=`MC.${t}.${e}.bookmarks.dat`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)}const ai="UI Checks: ",b_=document.querySelectorAll(".difficulty__label"),g_=document.querySelector(".checks__note-content"),v_=document.querySelector(".checks__obstacle-content"),__=document.querySelector(".checks__event-content"),y_=document.querySelector(".checks__other-content"),E_=document.querySelector(".checks__general-content"),We=document.querySelector(".checks__output-diff"),Ye=document.querySelector(".checks__output-general"),w_=document.querySelector(".checks__apply-this"),D_=document.querySelector(".checks__apply-all"),S_=document.querySelector(".checks__apply-general");w_.addEventListener("click",R_);D_.addEventListener("click",B_);S_.addEventListener("click",x_);function Gh(t){switch(t.type){case"string":return ol(t.label,t.value,t.symbol);case"number":return ol(t.label,t.value.join(", "),t.symbol);case"time":return l_(t.label,t.value,t.symbol);case"html":const e=document.createElement("div");return t.value.forEach(n=>e.appendChild(n)),e;default:throw new Error("Unexpected result type")}}function Hh(){var e;const t=(e=at.analysis)==null?void 0:e.general;if(!t){Ye.textContent="ERROR: could not find analysis for general";return}if(!t.output){Ye.textContent="ERROR: could not find HTML for general";return}Ye.innerHTML="",t.output.forEach(n=>Ye.appendChild(Gh(n))),Ye.firstChild||(Ye.textContent="No issues found.")}function So(t,e){var i;if(!t&&!e&&(t=un(),e=cn()),!t||!e)throw new Error(ai+"something went wrong!");We.innerHTML="";const n=(i=at.analysis)==null?void 0:i.beatmap.find(o=>o.difficulty===e&&o.characteristic===t);if(!n){We.textContent="ERROR: could not find analysis for "+t+" "+e;return}if(!n.output){We.textContent="ERROR: could not find HTML for "+t+" "+e;return}n.output.forEach(o=>We.appendChild(Gh(o))),We.firstChild||(We.textContent="No issues found.")}function Uh(t){b_.forEach(e=>e.textContent=t)}function C_(){const t=at.beatmapInfo;if(!t)throw new Error(ai+"could not find map info");const e=$i.create(t.audio.bpm);Cn.adjustTime(e)}function k_(){Cn.toolListInput.forEach(t=>{if(t.input.html)switch(t.type){case"note":{g_.appendChild(t.input.html);break}case"obstacle":{v_.appendChild(t.input.html);break}case"event":{__.appendChild(t.input.html);break}case"other":{y_.appendChild(t.input.html);break}case"general":{E_.appendChild(t.input.html);break}default:console.error(ai+"could not recognise type "+t.type+" for "+t.name)}})}function T_(){Ye&&(Ye.innerHTML="No output."),We&&(We.innerHTML="No output.")}function L_(){T_(),Uh("Difficulty Label")}function R_(){const t=un(),e=cn();if(!t||!e)throw new Error(ai+"characteristic/difficulty does not exist");Ct.status("info",`Re-analysing ${t} ${e}`),Cn.runDifficulty(t,e),Ct.status("info",`Re-analysed ${t} ${e}`),So(t,e)}function B_(){const t=un(),e=cn();if(!t||!e)throw new Error(ai+"characteristic/difficulty does not exist");Ct.status("info","Re-analysing all difficulties"),Cn.applyAll(),Ct.status("info","Re-analysed all difficulties"),So(t,e)}function x_(){Ct.status("info","Re-analysing general"),Cn.runGeneral(),Ct.status("info","Re-analysed general"),Hh()}Do.push(So);const $n={displayOutputGeneral:Hh,displayOutputDifficulty:So,setDifficultyLabel:Uh,adjustBeatTime:C_,populateTool:k_,reset:L_,init:c_};function Ne(t){return["load",t]}async function I_(t,e,n=""){if(t.version===4){const o=e.file(n+t.audio.audioDataFilename);if(Z.tInfo(Ne("extractBPMInfo"),"loading",t.audio.audioDataFilename),o){const r=await o.async("string").then(JSON.parse);return{duration:r.songSampleCount/r.songFrequency,bpm:r.bpmData.map(l=>({time:l.sb,bpm:(l.eb-l.sb)/((l.ei-l.si)/r.songFrequency)*60}))}}}const i=e.file(n+"BPMInfo.dat");if(Z.tInfo(Ne("extractBPMInfo"),"loading BPMInfo.dat"),i){const o=await i.async("string").then(JSON.parse);return{duration:o._songSampleCount/o._songFrequency,bpm:o._regions.map(r=>({time:r._startBeat,bpm:(r._endBeat-r._startBeat)/((r._endSampleIndex-r._startSampleIndex)/o._songFrequency)*60}))}}return null}async function N_(t,e=""){const n=t.file(e+"Info.dat")||t.file(e+"info.dat")||t.file(e+"Info.json")||t.file(e+"info.json");if(!n)throw new Error("Couldn't find Info.dat");return Z.tInfo(Ne("extractInfo"),"loading info"),n.async("string").then(JSON.parse).then(b0)}async function O_(t,e,n=""){const i=t.file(n+e.lightshowFilename);i||Z.tError(Ne("extractBeatmaps"),`Missing ${e.lightshowFilename} lightshow file for ${e.characteristic} ${e.difficulty}, ignoring.`),Z.tInfo(Ne("extractBeatmaps"),`Loading ${e.characteristic} ${e.difficulty} lightshow`);try{const o=await i.async("string").then(JSON.parse),r=g0(o,{sort:tt.sorting,schemaCheck:{enabled:tt.dataCheck}});return[o,r]}catch(o){Z.tError(Ne("extractBeatmaps"),`Could not load ${e.lightshowFilename} lightshow file; ${o}`)}return null}function A_(t,e,n=""){const i={};return t.difficulties.map(async o=>{var d;const r=o,l=e.file(n+r.filename);if(!l)return Z.tError(Ne("extractBeatmaps"),`Missing ${r.filename} file for ${r.characteristic} ${r.difficulty}, ignoring.`),null;Z.tInfo(Ne("extractBeatmaps"),`Loading ${r.characteristic} ${r.difficulty}`);let s;try{s=await l.async("string").then(JSON.parse)}catch(y){throw new Error(`${r.characteristic} ${r.difficulty} ${y}`)}let a=typeof s._version=="string"?s._version.at(0):typeof s.version=="string"?s.version.at(0):null,u;a?u=parseInt(a):(Z.tWarn(Ne("extractBeatmaps"),"Could not identify beatmap version from JSON, assume implicit version",2),u=2),s._notes&&s.version&&Z.tError(Ne("extractBeatmaps"),`${r.characteristic} ${r.difficulty} contains 2 version of the map in the same file, attempting to load v3 instead`);let c=d0(s,{sort:tt.sorting,schemaCheck:{enabled:tt.dataCheck}}),p=u===4?new xe:c,v;if(u===4){i[r.lightshowFilename]||(i[r.lightshowFilename]=O_(e,r,n));const y=await i[r.lightshowFilename];y&&(v=y[0],p=y[1])}c.lightshow=p.lightshow;const m=$i.create(t.audio.bpm,u===3?[...c.customData.BPMChanges??[],...(s.bpmEvents??[]).map(y=>y)]:u===2?c.customData._BPMChanges??c.customData._bpmChanges:u===1?s._BPMChanges:[],(d=r.customData)==null?void 0:d._editorOffset);$_(c,m);const h=t.environmentNames.at(r.environmentId)||(r.characteristic==="360Degree"||r.characteristic==="90Degree"?t.environmentBase.allDirections:t.environmentBase.normal)||"DefaultEnvironment";return{settings:r,environment:h,timeProcessor:m,njs:new he(m.bpm,r.njs,r.njsOffset),data:c,noteContainer:P_(c),swingAnalysis:H0(c,m,r.characteristic,r.difficulty),score:Ep(c),stats:{basicEvents:O0(c.basicEvents,c.colorBoostEvents,h),lightColorEventBoxGroups:_i(c.lightColorEventBoxGroups,h),lightRotationEventBoxGroups:_i(c.lightRotationEventBoxGroups,h),lightTranslationEventBoxGroups:_i(c.lightTranslationEventBoxGroups,h),fxEventBoxGroups:_i(c.fxEventBoxGroups,h),notes:Oo(c.colorNotes),bombs:A0(c.bombNotes),arcs:Oo(c.arcs),chains:Oo(c.chains),obstacles:F0(c.obstacles)},rawVersion:u,rawData:s,rawLightshow:v}})}function P_(t){return[...t.colorNotes.map(e=>({data:e,type:lt.COLOR})),...t.bombNotes.map(e=>({data:e,type:lt.BOMB})),...t.chains.map(e=>({data:e,type:lt.CHAIN})),...t.arcs.map(e=>({data:e,type:lt.ARC}))].sort((e,n)=>e.data.time-n.data.time)}function $_(t,e){const n=M_(e);t.difficulty.customData.__mapcheck_precalculatetime||(t.bpmEvents.forEach(n),t.rotationEvents.forEach(n),t.colorNotes.forEach(n),t.bombNotes.forEach(n),t.obstacles.forEach(n),t.arcs.forEach(n),t.chains.forEach(n),t.difficulty.customData.__mapcheck_precalculatetime=!0),t.lightshow.customData.__mapcheck_precalculatetimelightshow||(t.waypoints.forEach(n),t.basicEvents.forEach(n),t.colorBoostEvents.forEach(n),t.lightColorEventBoxGroups.forEach(n),t.lightRotationEventBoxGroups.forEach(n),t.lightTranslationEventBoxGroups.forEach(n),t.fxEventBoxGroups.forEach(n),t.lightshow.customData.__mapcheck_precalculatetimelightshow=!0)}function M_(t){return function(e){e.customData.__mapcheck_secondtime=t.toRealTime(e.time,!0),e.customData.__mapcheck_beattime=t.adjustTime(e.time)}}async function Wh(t){return new Promise(function(e,n){const i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="json",i.timeout=5e3;let o=Date.now();i.onprogress=()=>{i.timeout+=Date.now()-o},i.onload=()=>{i.status===200&&e(i.response),i.status===404&&n("Error 404: Map does not exist"),i.status===403&&n("Error 403: Forbidden"),n(`Error ${i.status}`)},i.onerror=()=>{n("Error downloading")},i.ontimeout=()=>{n("Connection timeout")},i.send()})}async function F_(t){const e=`https://api.beatsaver.com/maps/id/${t}`,n=await Wh(e);if(n!=null&&n.versions.length)return n.versions[n.versions.length-1].downloadURL;throw new Error("could not find map download link")}async function j_(t){const e=`https://api.beatsaver.com/maps/hash/${t}`,n=await Wh(e);if(n!=null&&n.versions.length)return n.versions[n.versions.length-1].downloadURL;throw new Error("could not find map download link")}function Yh(t){const e=/^(http|ftp|https):\/\/([\w_-]+(?:(?:\.[\w_-]+)+))([\w.,@?^=%&:/~+#-]*[\w@?^=%&/~+#-])?/;if(t=t.trim(),/^http:\/\//.test(t)&&(t=t.replace("http://","https://")),e.test(t))return t;throw new Error("Invalid URL")}function Xh(t){const e=/^[0-9a-fA-F]{1,6}$/;if(t=t.trim(),/^!bsr /.test(t)&&(t=t.replace("!bsr ","")),e.test(t))return t;throw new Error("Invalid ID")}function rl(t){return new Promise(e=>setTimeout(e,t))}function ni(t){return["download",t]}async function Fr(t){return new Promise(function(e,n){const i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer",i.timeout=5e3;let o=Date.now();i.onprogress=r=>{i.timeout+=Date.now()-o,Ct.status("download",`Downloading map: ${M(r.loaded/1024/1024,1)}MB / ${M(r.total/1024/1024,1)}MB`,r.loaded/r.total*100)},i.onload=()=>{i.status===200&&e(i.response),i.status===404&&n("Error 404: Map/link does not exist"),i.status===403&&n("Error 403: Forbidden"),n(`Error ${i.status}`)},i.onerror=()=>{n("Error downloading")},i.ontimeout=()=>{n("Connection timeout")},i.send()})}async function qh(t){const e=Xh(t);Z.tInfo(ni("downloadFromID"),`fetching download URL from BeatSaver for map ID ${e}`),Ct.status("info","Fetching download URL from BeatSaver",0);const n=await F_(e);Z.tInfo(ni("downloadFromID"),`downloading from BeatSaver for map ID ${e}`),Ct.status("info","Requesting download from BeatSaver",0);const i=await Fr(n);return At.setCoverLink("https://beatsaver.com/maps/"+e,e),i}async function z_(t){const e=Yh(t);if(e.match(/^(https?:\/\/)?(www\.)?beatsaver\.com\/maps\//))return qh(e.replace(/^https?:\/\/(www\.)?beatsaver\.com\/maps\//,"").match(/[a-fA-F0-9]*/)[0]);Ct.status("info","Requesting download from link",0),Z.tInfo(ni("downloadFromURL"),`downloading from ${e}`);let n=await Fr("https://cors.bsmg.dev/"+e);return At.setCoverLink(e),n}async function V_(t){let e;if(gr(t.trim()))e=t.trim();else throw new Error("invalid hash");Z.tInfo(ni("downloadFromHash"),`fetching download URL from BeatSaver for map hash ${e}`),Ct.status("info","Fetching download URL from BeatSaver",0);const n=await j_(e);return Z.tInfo(ni("downloadFromHash"),`downloading from BeatSaver for map hash ${e}`),Ct.status("info","Requesting download from BeatSaver",0),await Fr(n)}var Di=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function G_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Si(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Kh={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(t,e){(function(n){t.exports=n()})(function(){return function n(i,o,r){function l(u,c){if(!o[u]){if(!i[u]){var p=typeof Si=="function"&&Si;if(!c&&p)return p(u,!0);if(s)return s(u,!0);var v=new Error("Cannot find module '"+u+"'");throw v.code="MODULE_NOT_FOUND",v}var m=o[u]={exports:{}};i[u][0].call(m.exports,function(h){var d=i[u][1][h];return l(d||h)},m,m.exports,n,i,o,r)}return o[u].exports}for(var s=typeof Si=="function"&&Si,a=0;a<r.length;a++)l(r[a]);return l}({1:[function(n,i,o){var r=n("./utils"),l=n("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";o.encode=function(a){for(var u,c,p,v,m,h,d,y=[],g=0,_=a.length,D=_,C=r.getTypeOf(a)!=="string";g<a.length;)D=_-g,p=C?(u=a[g++],c=g<_?a[g++]:0,g<_?a[g++]:0):(u=a.charCodeAt(g++),c=g<_?a.charCodeAt(g++):0,g<_?a.charCodeAt(g++):0),v=u>>2,m=(3&u)<<4|c>>4,h=1<D?(15&c)<<2|p>>6:64,d=2<D?63&p:64,y.push(s.charAt(v)+s.charAt(m)+s.charAt(h)+s.charAt(d));return y.join("")},o.decode=function(a){var u,c,p,v,m,h,d=0,y=0,g="data:";if(a.substr(0,g.length)===g)throw new Error("Invalid base64 input, it looks like a data url.");var _,D=3*(a=a.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(a.charAt(a.length-1)===s.charAt(64)&&D--,a.charAt(a.length-2)===s.charAt(64)&&D--,D%1!=0)throw new Error("Invalid base64 input, bad content length.");for(_=l.uint8array?new Uint8Array(0|D):new Array(0|D);d<a.length;)u=s.indexOf(a.charAt(d++))<<2|(v=s.indexOf(a.charAt(d++)))>>4,c=(15&v)<<4|(m=s.indexOf(a.charAt(d++)))>>2,p=(3&m)<<6|(h=s.indexOf(a.charAt(d++))),_[y++]=u,m!==64&&(_[y++]=c),h!==64&&(_[y++]=p);return _}},{"./support":30,"./utils":32}],2:[function(n,i,o){var r=n("./external"),l=n("./stream/DataWorker"),s=n("./stream/Crc32Probe"),a=n("./stream/DataLengthProbe");function u(c,p,v,m,h){this.compressedSize=c,this.uncompressedSize=p,this.crc32=v,this.compression=m,this.compressedContent=h}u.prototype={getContentWorker:function(){var c=new l(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),p=this;return c.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),c},getCompressedWorker:function(){return new l(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(c,p,v){return c.pipe(new s).pipe(new a("uncompressedSize")).pipe(p.compressWorker(v)).pipe(new a("compressedSize")).withStreamInfo("compression",p)},i.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,i,o){var r=n("./stream/GenericWorker");o.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},o.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,i,o){var r=n("./utils"),l=function(){for(var s,a=[],u=0;u<256;u++){s=u;for(var c=0;c<8;c++)s=1&s?3988292384^s>>>1:s>>>1;a[u]=s}return a}();i.exports=function(s,a){return s!==void 0&&s.length?r.getTypeOf(s)!=="string"?function(u,c,p,v){var m=l,h=v+p;u^=-1;for(var d=v;d<h;d++)u=u>>>8^m[255&(u^c[d])];return-1^u}(0|a,s,s.length,0):function(u,c,p,v){var m=l,h=v+p;u^=-1;for(var d=v;d<h;d++)u=u>>>8^m[255&(u^c.charCodeAt(d))];return-1^u}(0|a,s,s.length,0):0}},{"./utils":32}],5:[function(n,i,o){o.base64=!1,o.binary=!1,o.dir=!1,o.createFolders=!0,o.date=null,o.compression=null,o.compressionOptions=null,o.comment=null,o.unixPermissions=null,o.dosPermissions=null},{}],6:[function(n,i,o){var r=null;r=typeof Promise<"u"?Promise:n("lie"),i.exports={Promise:r}},{lie:37}],7:[function(n,i,o){var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",l=n("pako"),s=n("./utils"),a=n("./stream/GenericWorker"),u=r?"uint8array":"array";function c(p,v){a.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=v,this.meta={}}o.magic="\b\0",s.inherits(c,a),c.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(u,p.data),!1)},c.prototype.flush=function(){a.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},c.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},c.prototype._createPako=function(){this._pako=new l[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(v){p.push({data:v,meta:p.meta})}},o.compressWorker=function(p){return new c("Deflate",p)},o.uncompressWorker=function(){return new c("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,i,o){function r(m,h){var d,y="";for(d=0;d<h;d++)y+=String.fromCharCode(255&m),m>>>=8;return y}function l(m,h,d,y,g,_){var D,C,k=m.file,P=m.compression,A=_!==u.utf8encode,V=s.transformTo("string",_(k.name)),x=s.transformTo("string",u.utf8encode(k.name)),W=k.comment,et=s.transformTo("string",_(W)),S=s.transformTo("string",u.utf8encode(W)),$=x.length!==k.name.length,b=S.length!==W.length,j="",st="",H="",ct=k.dir,Y=k.date,rt={crc32:0,compressedSize:0,uncompressedSize:0};h&&!d||(rt.crc32=m.crc32,rt.compressedSize=m.compressedSize,rt.uncompressedSize=m.uncompressedSize);var I=0;h&&(I|=8),A||!$&&!b||(I|=2048);var R=0,nt=0;ct&&(R|=16),g==="UNIX"?(nt=798,R|=function(K,yt){var Lt=K;return K||(Lt=yt?16893:33204),(65535&Lt)<<16}(k.unixPermissions,ct)):(nt=20,R|=function(K){return 63&(K||0)}(k.dosPermissions)),D=Y.getUTCHours(),D<<=6,D|=Y.getUTCMinutes(),D<<=5,D|=Y.getUTCSeconds()/2,C=Y.getUTCFullYear()-1980,C<<=4,C|=Y.getUTCMonth()+1,C<<=5,C|=Y.getUTCDate(),$&&(st=r(1,1)+r(c(V),4)+x,j+="up"+r(st.length,2)+st),b&&(H=r(1,1)+r(c(et),4)+S,j+="uc"+r(H.length,2)+H);var J="";return J+=`
\0`,J+=r(I,2),J+=P.magic,J+=r(D,2),J+=r(C,2),J+=r(rt.crc32,4),J+=r(rt.compressedSize,4),J+=r(rt.uncompressedSize,4),J+=r(V.length,2),J+=r(j.length,2),{fileRecord:p.LOCAL_FILE_HEADER+J+V+j,dirRecord:p.CENTRAL_FILE_HEADER+r(nt,2)+J+r(et.length,2)+"\0\0\0\0"+r(R,4)+r(y,4)+V+j+et}}var s=n("../utils"),a=n("../stream/GenericWorker"),u=n("../utf8"),c=n("../crc32"),p=n("../signature");function v(m,h,d,y){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=h,this.zipPlatform=d,this.encodeFileName=y,this.streamFiles=m,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(v,a),v.prototype.push=function(m){var h=m.meta.percent||0,d=this.entriesCount,y=this._sources.length;this.accumulate?this.contentBuffer.push(m):(this.bytesWritten+=m.data.length,a.prototype.push.call(this,{data:m.data,meta:{currentFile:this.currentFile,percent:d?(h+100*(d-y-1))/d:100}}))},v.prototype.openedSource=function(m){this.currentSourceOffset=this.bytesWritten,this.currentFile=m.file.name;var h=this.streamFiles&&!m.file.dir;if(h){var d=l(m,h,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:d.fileRecord,meta:{percent:0}})}else this.accumulate=!0},v.prototype.closedSource=function(m){this.accumulate=!1;var h=this.streamFiles&&!m.file.dir,d=l(m,h,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(d.dirRecord),h)this.push({data:function(y){return p.DATA_DESCRIPTOR+r(y.crc32,4)+r(y.compressedSize,4)+r(y.uncompressedSize,4)}(m),meta:{percent:100}});else for(this.push({data:d.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},v.prototype.flush=function(){for(var m=this.bytesWritten,h=0;h<this.dirRecords.length;h++)this.push({data:this.dirRecords[h],meta:{percent:100}});var d=this.bytesWritten-m,y=function(g,_,D,C,k){var P=s.transformTo("string",k(C));return p.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(g,2)+r(g,2)+r(_,4)+r(D,4)+r(P.length,2)+P}(this.dirRecords.length,d,m,this.zipComment,this.encodeFileName);this.push({data:y,meta:{percent:100}})},v.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},v.prototype.registerPrevious=function(m){this._sources.push(m);var h=this;return m.on("data",function(d){h.processChunk(d)}),m.on("end",function(){h.closedSource(h.previous.streamInfo),h._sources.length?h.prepareNextSource():h.end()}),m.on("error",function(d){h.error(d)}),this},v.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},v.prototype.error=function(m){var h=this._sources;if(!a.prototype.error.call(this,m))return!1;for(var d=0;d<h.length;d++)try{h[d].error(m)}catch{}return!0},v.prototype.lock=function(){a.prototype.lock.call(this);for(var m=this._sources,h=0;h<m.length;h++)m[h].lock()},i.exports=v},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,i,o){var r=n("../compressions"),l=n("./ZipFileWorker");o.generateWorker=function(s,a,u){var c=new l(a.streamFiles,u,a.platform,a.encodeFileName),p=0;try{s.forEach(function(v,m){p++;var h=function(_,D){var C=_||D,k=r[C];if(!k)throw new Error(C+" is not a valid compression method !");return k}(m.options.compression,a.compression),d=m.options.compressionOptions||a.compressionOptions||{},y=m.dir,g=m.date;m._compressWorker(h,d).withStreamInfo("file",{name:v,dir:y,date:g,comment:m.comment||"",unixPermissions:m.unixPermissions,dosPermissions:m.dosPermissions}).pipe(c)}),c.entriesCount=p}catch(v){c.error(v)}return c}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,i,o){function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var l=new r;for(var s in this)typeof this[s]!="function"&&(l[s]=this[s]);return l}}(r.prototype=n("./object")).loadAsync=n("./load"),r.support=n("./support"),r.defaults=n("./defaults"),r.version="3.10.1",r.loadAsync=function(l,s){return new r().loadAsync(l,s)},r.external=n("./external"),i.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,i,o){var r=n("./utils"),l=n("./external"),s=n("./utf8"),a=n("./zipEntries"),u=n("./stream/Crc32Probe"),c=n("./nodejsUtils");function p(v){return new l.Promise(function(m,h){var d=v.decompressed.getContentWorker().pipe(new u);d.on("error",function(y){h(y)}).on("end",function(){d.streamInfo.crc32!==v.decompressed.crc32?h(new Error("Corrupted zip : CRC32 mismatch")):m()}).resume()})}i.exports=function(v,m){var h=this;return m=r.extend(m||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),c.isNode&&c.isStream(v)?l.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",v,!0,m.optimizedBinaryString,m.base64).then(function(d){var y=new a(m);return y.load(d),y}).then(function(d){var y=[l.Promise.resolve(d)],g=d.files;if(m.checkCRC32)for(var _=0;_<g.length;_++)y.push(p(g[_]));return l.Promise.all(y)}).then(function(d){for(var y=d.shift(),g=y.files,_=0;_<g.length;_++){var D=g[_],C=D.fileNameStr,k=r.resolve(D.fileNameStr);h.file(k,D.decompressed,{binary:!0,optimizedBinaryString:!0,date:D.date,dir:D.dir,comment:D.fileCommentStr.length?D.fileCommentStr:null,unixPermissions:D.unixPermissions,dosPermissions:D.dosPermissions,createFolders:m.createFolders}),D.dir||(h.file(k).unsafeOriginalName=C)}return y.zipComment.length&&(h.comment=y.zipComment),h})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,i,o){var r=n("../utils"),l=n("../stream/GenericWorker");function s(a,u){l.call(this,"Nodejs stream input adapter for "+a),this._upstreamEnded=!1,this._bindStream(u)}r.inherits(s,l),s.prototype._bindStream=function(a){var u=this;(this._stream=a).pause(),a.on("data",function(c){u.push({data:c,meta:{percent:0}})}).on("error",function(c){u.isPaused?this.generatedError=c:u.error(c)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},s.prototype.pause=function(){return!!l.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},i.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,i,o){var r=n("readable-stream").Readable;function l(s,a,u){r.call(this,a),this._helper=s;var c=this;s.on("data",function(p,v){c.push(p)||c._helper.pause(),u&&u(v)}).on("error",function(p){c.emit("error",p)}).on("end",function(){c.push(null)})}n("../utils").inherits(l,r),l.prototype._read=function(){this._helper.resume()},i.exports=l},{"../utils":32,"readable-stream":16}],14:[function(n,i,o){i.exports={isNode:typeof Buffer<"u",newBufferFrom:function(r,l){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(r,l);if(typeof r=="number")throw new Error('The "data" argument must not be a number');return new Buffer(r,l)},allocBuffer:function(r){if(Buffer.alloc)return Buffer.alloc(r);var l=new Buffer(r);return l.fill(0),l},isBuffer:function(r){return Buffer.isBuffer(r)},isStream:function(r){return r&&typeof r.on=="function"&&typeof r.pause=="function"&&typeof r.resume=="function"}}},{}],15:[function(n,i,o){function r(k,P,A){var V,x=s.getTypeOf(P),W=s.extend(A||{},c);W.date=W.date||new Date,W.compression!==null&&(W.compression=W.compression.toUpperCase()),typeof W.unixPermissions=="string"&&(W.unixPermissions=parseInt(W.unixPermissions,8)),W.unixPermissions&&16384&W.unixPermissions&&(W.dir=!0),W.dosPermissions&&16&W.dosPermissions&&(W.dir=!0),W.dir&&(k=g(k)),W.createFolders&&(V=y(k))&&_.call(this,V,!0);var et=x==="string"&&W.binary===!1&&W.base64===!1;A&&A.binary!==void 0||(W.binary=!et),(P instanceof p&&P.uncompressedSize===0||W.dir||!P||P.length===0)&&(W.base64=!1,W.binary=!0,P="",W.compression="STORE",x="string");var S=null;S=P instanceof p||P instanceof a?P:h.isNode&&h.isStream(P)?new d(k,P):s.prepareContent(k,P,W.binary,W.optimizedBinaryString,W.base64);var $=new v(k,S,W);this.files[k]=$}var l=n("./utf8"),s=n("./utils"),a=n("./stream/GenericWorker"),u=n("./stream/StreamHelper"),c=n("./defaults"),p=n("./compressedObject"),v=n("./zipObject"),m=n("./generate"),h=n("./nodejsUtils"),d=n("./nodejs/NodejsStreamInputAdapter"),y=function(k){k.slice(-1)==="/"&&(k=k.substring(0,k.length-1));var P=k.lastIndexOf("/");return 0<P?k.substring(0,P):""},g=function(k){return k.slice(-1)!=="/"&&(k+="/"),k},_=function(k,P){return P=P!==void 0?P:c.createFolders,k=g(k),this.files[k]||r.call(this,k,null,{dir:!0,createFolders:P}),this.files[k]};function D(k){return Object.prototype.toString.call(k)==="[object RegExp]"}var C={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(k){var P,A,V;for(P in this.files)V=this.files[P],(A=P.slice(this.root.length,P.length))&&P.slice(0,this.root.length)===this.root&&k(A,V)},filter:function(k){var P=[];return this.forEach(function(A,V){k(A,V)&&P.push(V)}),P},file:function(k,P,A){if(arguments.length!==1)return k=this.root+k,r.call(this,k,P,A),this;if(D(k)){var V=k;return this.filter(function(W,et){return!et.dir&&V.test(W)})}var x=this.files[this.root+k];return x&&!x.dir?x:null},folder:function(k){if(!k)return this;if(D(k))return this.filter(function(x,W){return W.dir&&k.test(x)});var P=this.root+k,A=_.call(this,P),V=this.clone();return V.root=A.name,V},remove:function(k){k=this.root+k;var P=this.files[k];if(P||(k.slice(-1)!=="/"&&(k+="/"),P=this.files[k]),P&&!P.dir)delete this.files[k];else for(var A=this.filter(function(x,W){return W.name.slice(0,k.length)===k}),V=0;V<A.length;V++)delete this.files[A[V].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(k){var P,A={};try{if((A=s.extend(k||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:l.utf8encode})).type=A.type.toLowerCase(),A.compression=A.compression.toUpperCase(),A.type==="binarystring"&&(A.type="string"),!A.type)throw new Error("No output type specified.");s.checkSupport(A.type),A.platform!=="darwin"&&A.platform!=="freebsd"&&A.platform!=="linux"&&A.platform!=="sunos"||(A.platform="UNIX"),A.platform==="win32"&&(A.platform="DOS");var V=A.comment||this.comment||"";P=m.generateWorker(this,A,V)}catch(x){(P=new a("error")).error(x)}return new u(P,A.type||"string",A.mimeType)},generateAsync:function(k,P){return this.generateInternalStream(k).accumulate(P)},generateNodeStream:function(k,P){return(k=k||{}).type||(k.type="nodebuffer"),this.generateInternalStream(k).toNodejsStream(P)}};i.exports=C},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,i,o){i.exports=n("stream")},{stream:void 0}],17:[function(n,i,o){var r=n("./DataReader");function l(s){r.call(this,s);for(var a=0;a<this.data.length;a++)s[a]=255&s[a]}n("../utils").inherits(l,r),l.prototype.byteAt=function(s){return this.data[this.zero+s]},l.prototype.lastIndexOfSignature=function(s){for(var a=s.charCodeAt(0),u=s.charCodeAt(1),c=s.charCodeAt(2),p=s.charCodeAt(3),v=this.length-4;0<=v;--v)if(this.data[v]===a&&this.data[v+1]===u&&this.data[v+2]===c&&this.data[v+3]===p)return v-this.zero;return-1},l.prototype.readAndCheckSignature=function(s){var a=s.charCodeAt(0),u=s.charCodeAt(1),c=s.charCodeAt(2),p=s.charCodeAt(3),v=this.readData(4);return a===v[0]&&u===v[1]&&c===v[2]&&p===v[3]},l.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var a=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,a},i.exports=l},{"../utils":32,"./DataReader":18}],18:[function(n,i,o){var r=n("../utils");function l(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}l.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(){},readInt:function(s){var a,u=0;for(this.checkOffset(s),a=this.index+s-1;a>=this.index;a--)u=(u<<8)+this.byteAt(a);return this.index+=s,u},readString:function(s){return r.transformTo("string",this.readData(s))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},i.exports=l},{"../utils":32}],19:[function(n,i,o){var r=n("./Uint8ArrayReader");function l(s){r.call(this,s)}n("../utils").inherits(l,r),l.prototype.readData=function(s){this.checkOffset(s);var a=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,a},i.exports=l},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,i,o){var r=n("./DataReader");function l(s){r.call(this,s)}n("../utils").inherits(l,r),l.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},l.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},l.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},l.prototype.readData=function(s){this.checkOffset(s);var a=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,a},i.exports=l},{"../utils":32,"./DataReader":18}],21:[function(n,i,o){var r=n("./ArrayReader");function l(s){r.call(this,s)}n("../utils").inherits(l,r),l.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var a=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,a},i.exports=l},{"../utils":32,"./ArrayReader":17}],22:[function(n,i,o){var r=n("../utils"),l=n("../support"),s=n("./ArrayReader"),a=n("./StringReader"),u=n("./NodeBufferReader"),c=n("./Uint8ArrayReader");i.exports=function(p){var v=r.getTypeOf(p);return r.checkSupport(v),v!=="string"||l.uint8array?v==="nodebuffer"?new u(p):l.uint8array?new c(r.transformTo("uint8array",p)):new s(r.transformTo("array",p)):new a(p)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,i,o){o.LOCAL_FILE_HEADER="PK",o.CENTRAL_FILE_HEADER="PK",o.CENTRAL_DIRECTORY_END="PK",o.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",o.ZIP64_CENTRAL_DIRECTORY_END="PK",o.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,i,o){var r=n("./GenericWorker"),l=n("../utils");function s(a){r.call(this,"ConvertWorker to "+a),this.destType=a}l.inherits(s,r),s.prototype.processChunk=function(a){this.push({data:l.transformTo(this.destType,a.data),meta:a.meta})},i.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(n,i,o){var r=n("./GenericWorker"),l=n("../crc32");function s(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(s,r),s.prototype.processChunk=function(a){this.streamInfo.crc32=l(a.data,this.streamInfo.crc32||0),this.push(a)},i.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,i,o){var r=n("../utils"),l=n("./GenericWorker");function s(a){l.call(this,"DataLengthProbe for "+a),this.propName=a,this.withStreamInfo(a,0)}r.inherits(s,l),s.prototype.processChunk=function(a){if(a){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+a.data.length}l.prototype.processChunk.call(this,a)},i.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(n,i,o){var r=n("../utils"),l=n("./GenericWorker");function s(a){l.call(this,"DataWorker");var u=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,a.then(function(c){u.dataIsReady=!0,u.data=c,u.max=c&&c.length||0,u.type=r.getTypeOf(c),u.isPaused||u._tickAndRepeat()},function(c){u.error(c)})}r.inherits(s,l),s.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var a=null,u=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":a=this.data.substring(this.index,u);break;case"uint8array":a=this.data.subarray(this.index,u);break;case"array":case"nodebuffer":a=this.data.slice(this.index,u)}return this.index=u,this.push({data:a,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(n,i,o){function r(l){this.name=l||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(l){this.emit("data",l)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(l){this.emit("error",l)}return!0},error:function(l){return!this.isFinished&&(this.isPaused?this.generatedError=l:(this.isFinished=!0,this.emit("error",l),this.previous&&this.previous.error(l),this.cleanUp()),!0)},on:function(l,s){return this._listeners[l].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(l,s){if(this._listeners[l])for(var a=0;a<this._listeners[l].length;a++)this._listeners[l][a].call(this,s)},pipe:function(l){return l.registerPrevious(this)},registerPrevious:function(l){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=l.streamInfo,this.mergeStreamInfo(),this.previous=l;var s=this;return l.on("data",function(a){s.processChunk(a)}),l.on("end",function(){s.end()}),l.on("error",function(a){s.error(a)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var l=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),l=!0),this.previous&&this.previous.resume(),!l},flush:function(){},processChunk:function(l){this.push(l)},withStreamInfo:function(l,s){return this.extraStreamInfo[l]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var l in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,l)&&(this.streamInfo[l]=this.extraStreamInfo[l])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var l="Worker "+this.name;return this.previous?this.previous+" -> "+l:l}},i.exports=r},{}],29:[function(n,i,o){var r=n("../utils"),l=n("./ConvertWorker"),s=n("./GenericWorker"),a=n("../base64"),u=n("../support"),c=n("../external"),p=null;if(u.nodestream)try{p=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function v(h,d){return new c.Promise(function(y,g){var _=[],D=h._internalType,C=h._outputType,k=h._mimeType;h.on("data",function(P,A){_.push(P),d&&d(A)}).on("error",function(P){_=[],g(P)}).on("end",function(){try{var P=function(A,V,x){switch(A){case"blob":return r.newBlob(r.transformTo("arraybuffer",V),x);case"base64":return a.encode(V);default:return r.transformTo(A,V)}}(C,function(A,V){var x,W=0,et=null,S=0;for(x=0;x<V.length;x++)S+=V[x].length;switch(A){case"string":return V.join("");case"array":return Array.prototype.concat.apply([],V);case"uint8array":for(et=new Uint8Array(S),x=0;x<V.length;x++)et.set(V[x],W),W+=V[x].length;return et;case"nodebuffer":return Buffer.concat(V);default:throw new Error("concat : unsupported type '"+A+"'")}}(D,_),k);y(P)}catch(A){g(A)}_=[]}).resume()})}function m(h,d,y){var g=d;switch(d){case"blob":case"arraybuffer":g="uint8array";break;case"base64":g="string"}try{this._internalType=g,this._outputType=d,this._mimeType=y,r.checkSupport(g),this._worker=h.pipe(new l(g)),h.lock()}catch(_){this._worker=new s("error"),this._worker.error(_)}}m.prototype={accumulate:function(h){return v(this,h)},on:function(h,d){var y=this;return h==="data"?this._worker.on(h,function(g){d.call(y,g.data,g.meta)}):this._worker.on(h,function(){r.delay(d,arguments,y)}),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(h){if(r.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},h)}},i.exports=m},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,i,o){if(o.base64=!0,o.array=!0,o.string=!0,o.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",o.nodebuffer=typeof Buffer<"u",o.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")o.blob=!1;else{var r=new ArrayBuffer(0);try{o.blob=new Blob([r],{type:"application/zip"}).size===0}catch{try{var l=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);l.append(r),o.blob=l.getBlob("application/zip").size===0}catch{o.blob=!1}}}try{o.nodestream=!!n("readable-stream").Readable}catch{o.nodestream=!1}},{"readable-stream":16}],31:[function(n,i,o){for(var r=n("./utils"),l=n("./support"),s=n("./nodejsUtils"),a=n("./stream/GenericWorker"),u=new Array(256),c=0;c<256;c++)u[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;u[254]=u[254]=1;function p(){a.call(this,"utf-8 decode"),this.leftOver=null}function v(){a.call(this,"utf-8 encode")}o.utf8encode=function(m){return l.nodebuffer?s.newBufferFrom(m,"utf-8"):function(h){var d,y,g,_,D,C=h.length,k=0;for(_=0;_<C;_++)(64512&(y=h.charCodeAt(_)))==55296&&_+1<C&&(64512&(g=h.charCodeAt(_+1)))==56320&&(y=65536+(y-55296<<10)+(g-56320),_++),k+=y<128?1:y<2048?2:y<65536?3:4;for(d=l.uint8array?new Uint8Array(k):new Array(k),_=D=0;D<k;_++)(64512&(y=h.charCodeAt(_)))==55296&&_+1<C&&(64512&(g=h.charCodeAt(_+1)))==56320&&(y=65536+(y-55296<<10)+(g-56320),_++),y<128?d[D++]=y:(y<2048?d[D++]=192|y>>>6:(y<65536?d[D++]=224|y>>>12:(d[D++]=240|y>>>18,d[D++]=128|y>>>12&63),d[D++]=128|y>>>6&63),d[D++]=128|63&y);return d}(m)},o.utf8decode=function(m){return l.nodebuffer?r.transformTo("nodebuffer",m).toString("utf-8"):function(h){var d,y,g,_,D=h.length,C=new Array(2*D);for(d=y=0;d<D;)if((g=h[d++])<128)C[y++]=g;else if(4<(_=u[g]))C[y++]=65533,d+=_-1;else{for(g&=_===2?31:_===3?15:7;1<_&&d<D;)g=g<<6|63&h[d++],_--;1<_?C[y++]=65533:g<65536?C[y++]=g:(g-=65536,C[y++]=55296|g>>10&1023,C[y++]=56320|1023&g)}return C.length!==y&&(C.subarray?C=C.subarray(0,y):C.length=y),r.applyFromCharCode(C)}(m=r.transformTo(l.uint8array?"uint8array":"array",m))},r.inherits(p,a),p.prototype.processChunk=function(m){var h=r.transformTo(l.uint8array?"uint8array":"array",m.data);if(this.leftOver&&this.leftOver.length){if(l.uint8array){var d=h;(h=new Uint8Array(d.length+this.leftOver.length)).set(this.leftOver,0),h.set(d,this.leftOver.length)}else h=this.leftOver.concat(h);this.leftOver=null}var y=function(_,D){var C;for((D=D||_.length)>_.length&&(D=_.length),C=D-1;0<=C&&(192&_[C])==128;)C--;return C<0||C===0?D:C+u[_[C]]>D?C:D}(h),g=h;y!==h.length&&(l.uint8array?(g=h.subarray(0,y),this.leftOver=h.subarray(y,h.length)):(g=h.slice(0,y),this.leftOver=h.slice(y,h.length))),this.push({data:o.utf8decode(g),meta:m.meta})},p.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:o.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},o.Utf8DecodeWorker=p,r.inherits(v,a),v.prototype.processChunk=function(m){this.push({data:o.utf8encode(m.data),meta:m.meta})},o.Utf8EncodeWorker=v},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,i,o){var r=n("./support"),l=n("./base64"),s=n("./nodejsUtils"),a=n("./external");function u(d){return d}function c(d,y){for(var g=0;g<d.length;++g)y[g]=255&d.charCodeAt(g);return y}n("setimmediate"),o.newBlob=function(d,y){o.checkSupport("blob");try{return new Blob([d],{type:y})}catch{try{var g=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return g.append(d),g.getBlob(y)}catch{throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(d,y,g){var _=[],D=0,C=d.length;if(C<=g)return String.fromCharCode.apply(null,d);for(;D<C;)y==="array"||y==="nodebuffer"?_.push(String.fromCharCode.apply(null,d.slice(D,Math.min(D+g,C)))):_.push(String.fromCharCode.apply(null,d.subarray(D,Math.min(D+g,C)))),D+=g;return _.join("")},stringifyByChar:function(d){for(var y="",g=0;g<d.length;g++)y+=String.fromCharCode(d[g]);return y},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}}()}};function v(d){var y=65536,g=o.getTypeOf(d),_=!0;if(g==="uint8array"?_=p.applyCanBeUsed.uint8array:g==="nodebuffer"&&(_=p.applyCanBeUsed.nodebuffer),_)for(;1<y;)try{return p.stringifyByChunk(d,g,y)}catch{y=Math.floor(y/2)}return p.stringifyByChar(d)}function m(d,y){for(var g=0;g<d.length;g++)y[g]=d[g];return y}o.applyFromCharCode=v;var h={};h.string={string:u,array:function(d){return c(d,new Array(d.length))},arraybuffer:function(d){return h.string.uint8array(d).buffer},uint8array:function(d){return c(d,new Uint8Array(d.length))},nodebuffer:function(d){return c(d,s.allocBuffer(d.length))}},h.array={string:v,array:u,arraybuffer:function(d){return new Uint8Array(d).buffer},uint8array:function(d){return new Uint8Array(d)},nodebuffer:function(d){return s.newBufferFrom(d)}},h.arraybuffer={string:function(d){return v(new Uint8Array(d))},array:function(d){return m(new Uint8Array(d),new Array(d.byteLength))},arraybuffer:u,uint8array:function(d){return new Uint8Array(d)},nodebuffer:function(d){return s.newBufferFrom(new Uint8Array(d))}},h.uint8array={string:v,array:function(d){return m(d,new Array(d.length))},arraybuffer:function(d){return d.buffer},uint8array:u,nodebuffer:function(d){return s.newBufferFrom(d)}},h.nodebuffer={string:v,array:function(d){return m(d,new Array(d.length))},arraybuffer:function(d){return h.nodebuffer.uint8array(d).buffer},uint8array:function(d){return m(d,new Uint8Array(d.length))},nodebuffer:u},o.transformTo=function(d,y){if(y=y||"",!d)return y;o.checkSupport(d);var g=o.getTypeOf(y);return h[g][d](y)},o.resolve=function(d){for(var y=d.split("/"),g=[],_=0;_<y.length;_++){var D=y[_];D==="."||D===""&&_!==0&&_!==y.length-1||(D===".."?g.pop():g.push(D))}return g.join("/")},o.getTypeOf=function(d){return typeof d=="string"?"string":Object.prototype.toString.call(d)==="[object Array]"?"array":r.nodebuffer&&s.isBuffer(d)?"nodebuffer":r.uint8array&&d instanceof Uint8Array?"uint8array":r.arraybuffer&&d instanceof ArrayBuffer?"arraybuffer":void 0},o.checkSupport=function(d){if(!r[d.toLowerCase()])throw new Error(d+" is not supported by this platform")},o.MAX_VALUE_16BITS=65535,o.MAX_VALUE_32BITS=-1,o.pretty=function(d){var y,g,_="";for(g=0;g<(d||"").length;g++)_+="\\x"+((y=d.charCodeAt(g))<16?"0":"")+y.toString(16).toUpperCase();return _},o.delay=function(d,y,g){setImmediate(function(){d.apply(g||null,y||[])})},o.inherits=function(d,y){function g(){}g.prototype=y.prototype,d.prototype=new g},o.extend=function(){var d,y,g={};for(d=0;d<arguments.length;d++)for(y in arguments[d])Object.prototype.hasOwnProperty.call(arguments[d],y)&&g[y]===void 0&&(g[y]=arguments[d][y]);return g},o.prepareContent=function(d,y,g,_,D){return a.Promise.resolve(y).then(function(C){return r.blob&&(C instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(C))!==-1)&&typeof FileReader<"u"?new a.Promise(function(k,P){var A=new FileReader;A.onload=function(V){k(V.target.result)},A.onerror=function(V){P(V.target.error)},A.readAsArrayBuffer(C)}):C}).then(function(C){var k=o.getTypeOf(C);return k?(k==="arraybuffer"?C=o.transformTo("uint8array",C):k==="string"&&(D?C=l.decode(C):g&&_!==!0&&(C=function(P){return c(P,r.uint8array?new Uint8Array(P.length):new Array(P.length))}(C))),C):a.Promise.reject(new Error("Can't read the data of '"+d+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,i,o){var r=n("./reader/readerFor"),l=n("./utils"),s=n("./signature"),a=n("./zipEntry"),u=n("./support");function c(p){this.files=[],this.loadOptions=p}c.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var v=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+l.pretty(v)+", expected "+l.pretty(p)+")")}},isSignature:function(p,v){var m=this.reader.index;this.reader.setIndex(p);var h=this.reader.readString(4)===v;return this.reader.setIndex(m),h},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),v=u.uint8array?"uint8array":"array",m=l.transformTo(v,p);this.zipComment=this.loadOptions.decodeFileName(m)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p,v,m,h=this.zip64EndOfCentralSize-44;0<h;)p=this.reader.readInt(2),v=this.reader.readInt(4),m=this.reader.readData(v),this.zip64ExtensibleData[p]={id:p,length:v,value:m}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,v;for(p=0;p<this.files.length;p++)v=this.files[p],this.reader.setIndex(v.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),v.readLocalPart(this.reader),v.handleUTF8(),v.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(p=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(p<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(p);var v=p;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===l.MAX_VALUE_16BITS||this.diskWithCentralDirStart===l.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===l.MAX_VALUE_16BITS||this.centralDirRecords===l.MAX_VALUE_16BITS||this.centralDirSize===l.MAX_VALUE_32BITS||this.centralDirOffset===l.MAX_VALUE_32BITS){if(this.zip64=!0,(p=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var m=this.centralDirOffset+this.centralDirSize;this.zip64&&(m+=20,m+=12+this.zip64EndOfCentralSize);var h=v-m;if(0<h)this.isSignature(v,s.CENTRAL_FILE_HEADER)||(this.reader.zero=h);else if(h<0)throw new Error("Corrupted zip: missing "+Math.abs(h)+" bytes.")},prepareReader:function(p){this.reader=r(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=c},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,i,o){var r=n("./reader/readerFor"),l=n("./utils"),s=n("./compressedObject"),a=n("./crc32"),u=n("./utf8"),c=n("./compressions"),p=n("./support");function v(m,h){this.options=m,this.loadOptions=h}v.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(m){var h,d;if(m.skip(22),this.fileNameLength=m.readInt(2),d=m.readInt(2),this.fileName=m.readData(this.fileNameLength),m.skip(d),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((h=function(y){for(var g in c)if(Object.prototype.hasOwnProperty.call(c,g)&&c[g].magic===y)return c[g];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+l.pretty(this.compressionMethod)+" unknown (inner file : "+l.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,h,m.readData(this.compressedSize))},readCentralPart:function(m){this.versionMadeBy=m.readInt(2),m.skip(2),this.bitFlag=m.readInt(2),this.compressionMethod=m.readString(2),this.date=m.readDate(),this.crc32=m.readInt(4),this.compressedSize=m.readInt(4),this.uncompressedSize=m.readInt(4);var h=m.readInt(2);if(this.extraFieldsLength=m.readInt(2),this.fileCommentLength=m.readInt(2),this.diskNumberStart=m.readInt(2),this.internalFileAttributes=m.readInt(2),this.externalFileAttributes=m.readInt(4),this.localHeaderOffset=m.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");m.skip(h),this.readExtraFields(m),this.parseZIP64ExtraField(m),this.fileComment=m.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var m=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),m==0&&(this.dosPermissions=63&this.externalFileAttributes),m==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var m=r(this.extraFields[1].value);this.uncompressedSize===l.MAX_VALUE_32BITS&&(this.uncompressedSize=m.readInt(8)),this.compressedSize===l.MAX_VALUE_32BITS&&(this.compressedSize=m.readInt(8)),this.localHeaderOffset===l.MAX_VALUE_32BITS&&(this.localHeaderOffset=m.readInt(8)),this.diskNumberStart===l.MAX_VALUE_32BITS&&(this.diskNumberStart=m.readInt(4))}},readExtraFields:function(m){var h,d,y,g=m.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});m.index+4<g;)h=m.readInt(2),d=m.readInt(2),y=m.readData(d),this.extraFields[h]={id:h,length:d,value:y};m.setIndex(g)},handleUTF8:function(){var m=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var h=this.findExtraFieldUnicodePath();if(h!==null)this.fileNameStr=h;else{var d=l.transformTo(m,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(d)}var y=this.findExtraFieldUnicodeComment();if(y!==null)this.fileCommentStr=y;else{var g=l.transformTo(m,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(g)}}},findExtraFieldUnicodePath:function(){var m=this.extraFields[28789];if(m){var h=r(m.value);return h.readInt(1)!==1||a(this.fileName)!==h.readInt(4)?null:u.utf8decode(h.readData(m.length-5))}return null},findExtraFieldUnicodeComment:function(){var m=this.extraFields[25461];if(m){var h=r(m.value);return h.readInt(1)!==1||a(this.fileComment)!==h.readInt(4)?null:u.utf8decode(h.readData(m.length-5))}return null}},i.exports=v},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,i,o){function r(h,d,y){this.name=h,this.dir=y.dir,this.date=y.date,this.comment=y.comment,this.unixPermissions=y.unixPermissions,this.dosPermissions=y.dosPermissions,this._data=d,this._dataBinary=y.binary,this.options={compression:y.compression,compressionOptions:y.compressionOptions}}var l=n("./stream/StreamHelper"),s=n("./stream/DataWorker"),a=n("./utf8"),u=n("./compressedObject"),c=n("./stream/GenericWorker");r.prototype={internalStream:function(h){var d=null,y="string";try{if(!h)throw new Error("No output type specified.");var g=(y=h.toLowerCase())==="string"||y==="text";y!=="binarystring"&&y!=="text"||(y="string"),d=this._decompressWorker();var _=!this._dataBinary;_&&!g&&(d=d.pipe(new a.Utf8EncodeWorker)),!_&&g&&(d=d.pipe(new a.Utf8DecodeWorker))}catch(D){(d=new c("error")).error(D)}return new l(d,y,"")},async:function(h,d){return this.internalStream(h).accumulate(d)},nodeStream:function(h,d){return this.internalStream(h||"nodebuffer").toNodejsStream(d)},_compressWorker:function(h,d){if(this._data instanceof u&&this._data.compression.magic===h.magic)return this._data.getCompressedWorker();var y=this._decompressWorker();return this._dataBinary||(y=y.pipe(new a.Utf8EncodeWorker)),u.createWorkerFrom(y,h,d)},_decompressWorker:function(){return this._data instanceof u?this._data.getContentWorker():this._data instanceof c?this._data:new s(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],v=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},m=0;m<p.length;m++)r.prototype[p[m]]=v;i.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,i,o){(function(r){var l,s,a=r.MutationObserver||r.WebKitMutationObserver;if(a){var u=0,c=new a(h),p=r.document.createTextNode("");c.observe(p,{characterData:!0}),l=function(){p.data=u=++u%2}}else if(r.setImmediate||r.MessageChannel===void 0)l="document"in r&&"onreadystatechange"in r.document.createElement("script")?function(){var d=r.document.createElement("script");d.onreadystatechange=function(){h(),d.onreadystatechange=null,d.parentNode.removeChild(d),d=null},r.document.documentElement.appendChild(d)}:function(){setTimeout(h,0)};else{var v=new r.MessageChannel;v.port1.onmessage=h,l=function(){v.port2.postMessage(0)}}var m=[];function h(){var d,y;s=!0;for(var g=m.length;g;){for(y=m,m=[],d=-1;++d<g;)y[d]();g=m.length}s=!1}i.exports=function(d){m.push(d)!==1||s||l()}}).call(this,typeof Di<"u"?Di:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,i,o){var r=n("immediate");function l(){}var s={},a=["REJECTED"],u=["FULFILLED"],c=["PENDING"];function p(g){if(typeof g!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,g!==l&&d(this,g)}function v(g,_,D){this.promise=g,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof D=="function"&&(this.onRejected=D,this.callRejected=this.otherCallRejected)}function m(g,_,D){r(function(){var C;try{C=_(D)}catch(k){return s.reject(g,k)}C===g?s.reject(g,new TypeError("Cannot resolve promise with itself")):s.resolve(g,C)})}function h(g){var _=g&&g.then;if(g&&(typeof g=="object"||typeof g=="function")&&typeof _=="function")return function(){_.apply(g,arguments)}}function d(g,_){var D=!1;function C(A){D||(D=!0,s.reject(g,A))}function k(A){D||(D=!0,s.resolve(g,A))}var P=y(function(){_(k,C)});P.status==="error"&&C(P.value)}function y(g,_){var D={};try{D.value=g(_),D.status="success"}catch(C){D.status="error",D.value=C}return D}(i.exports=p).prototype.finally=function(g){if(typeof g!="function")return this;var _=this.constructor;return this.then(function(D){return _.resolve(g()).then(function(){return D})},function(D){return _.resolve(g()).then(function(){throw D})})},p.prototype.catch=function(g){return this.then(null,g)},p.prototype.then=function(g,_){if(typeof g!="function"&&this.state===u||typeof _!="function"&&this.state===a)return this;var D=new this.constructor(l);return this.state!==c?m(D,this.state===u?g:_,this.outcome):this.queue.push(new v(D,g,_)),D},v.prototype.callFulfilled=function(g){s.resolve(this.promise,g)},v.prototype.otherCallFulfilled=function(g){m(this.promise,this.onFulfilled,g)},v.prototype.callRejected=function(g){s.reject(this.promise,g)},v.prototype.otherCallRejected=function(g){m(this.promise,this.onRejected,g)},s.resolve=function(g,_){var D=y(h,_);if(D.status==="error")return s.reject(g,D.value);var C=D.value;if(C)d(g,C);else{g.state=u,g.outcome=_;for(var k=-1,P=g.queue.length;++k<P;)g.queue[k].callFulfilled(_)}return g},s.reject=function(g,_){g.state=a,g.outcome=_;for(var D=-1,C=g.queue.length;++D<C;)g.queue[D].callRejected(_);return g},p.resolve=function(g){return g instanceof this?g:s.resolve(new this(l),g)},p.reject=function(g){var _=new this(l);return s.reject(_,g)},p.all=function(g){var _=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var D=g.length,C=!1;if(!D)return this.resolve([]);for(var k=new Array(D),P=0,A=-1,V=new this(l);++A<D;)x(g[A],A);return V;function x(W,et){_.resolve(W).then(function(S){k[et]=S,++P!==D||C||(C=!0,s.resolve(V,k))},function(S){C||(C=!0,s.reject(V,S))})}},p.race=function(g){var _=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var D=g.length,C=!1;if(!D)return this.resolve([]);for(var k=-1,P=new this(l);++k<D;)A=g[k],_.resolve(A).then(function(V){C||(C=!0,s.resolve(P,V))},function(V){C||(C=!0,s.reject(P,V))});var A;return P}},{immediate:36}],38:[function(n,i,o){var r={};(0,n("./lib/utils/common").assign)(r,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),i.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,i,o){var r=n("./zlib/deflate"),l=n("./utils/common"),s=n("./utils/strings"),a=n("./zlib/messages"),u=n("./zlib/zstream"),c=Object.prototype.toString,p=0,v=-1,m=0,h=8;function d(g){if(!(this instanceof d))return new d(g);this.options=l.assign({level:v,method:h,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},g||{});var _=this.options;_.raw&&0<_.windowBits?_.windowBits=-_.windowBits:_.gzip&&0<_.windowBits&&_.windowBits<16&&(_.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var D=r.deflateInit2(this.strm,_.level,_.method,_.windowBits,_.memLevel,_.strategy);if(D!==p)throw new Error(a[D]);if(_.header&&r.deflateSetHeader(this.strm,_.header),_.dictionary){var C;if(C=typeof _.dictionary=="string"?s.string2buf(_.dictionary):c.call(_.dictionary)==="[object ArrayBuffer]"?new Uint8Array(_.dictionary):_.dictionary,(D=r.deflateSetDictionary(this.strm,C))!==p)throw new Error(a[D]);this._dict_set=!0}}function y(g,_){var D=new d(_);if(D.push(g,!0),D.err)throw D.msg||a[D.err];return D.result}d.prototype.push=function(g,_){var D,C,k=this.strm,P=this.options.chunkSize;if(this.ended)return!1;C=_===~~_?_:_===!0?4:0,typeof g=="string"?k.input=s.string2buf(g):c.call(g)==="[object ArrayBuffer]"?k.input=new Uint8Array(g):k.input=g,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new l.Buf8(P),k.next_out=0,k.avail_out=P),(D=r.deflate(k,C))!==1&&D!==p)return this.onEnd(D),!(this.ended=!0);k.avail_out!==0&&(k.avail_in!==0||C!==4&&C!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(l.shrinkBuf(k.output,k.next_out))):this.onData(l.shrinkBuf(k.output,k.next_out)))}while((0<k.avail_in||k.avail_out===0)&&D!==1);return C===4?(D=r.deflateEnd(this.strm),this.onEnd(D),this.ended=!0,D===p):C!==2||(this.onEnd(p),!(k.avail_out=0))},d.prototype.onData=function(g){this.chunks.push(g)},d.prototype.onEnd=function(g){g===p&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},o.Deflate=d,o.deflate=y,o.deflateRaw=function(g,_){return(_=_||{}).raw=!0,y(g,_)},o.gzip=function(g,_){return(_=_||{}).gzip=!0,y(g,_)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,i,o){var r=n("./zlib/inflate"),l=n("./utils/common"),s=n("./utils/strings"),a=n("./zlib/constants"),u=n("./zlib/messages"),c=n("./zlib/zstream"),p=n("./zlib/gzheader"),v=Object.prototype.toString;function m(d){if(!(this instanceof m))return new m(d);this.options=l.assign({chunkSize:16384,windowBits:0,to:""},d||{});var y=this.options;y.raw&&0<=y.windowBits&&y.windowBits<16&&(y.windowBits=-y.windowBits,y.windowBits===0&&(y.windowBits=-15)),!(0<=y.windowBits&&y.windowBits<16)||d&&d.windowBits||(y.windowBits+=32),15<y.windowBits&&y.windowBits<48&&!(15&y.windowBits)&&(y.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var g=r.inflateInit2(this.strm,y.windowBits);if(g!==a.Z_OK)throw new Error(u[g]);this.header=new p,r.inflateGetHeader(this.strm,this.header)}function h(d,y){var g=new m(y);if(g.push(d,!0),g.err)throw g.msg||u[g.err];return g.result}m.prototype.push=function(d,y){var g,_,D,C,k,P,A=this.strm,V=this.options.chunkSize,x=this.options.dictionary,W=!1;if(this.ended)return!1;_=y===~~y?y:y===!0?a.Z_FINISH:a.Z_NO_FLUSH,typeof d=="string"?A.input=s.binstring2buf(d):v.call(d)==="[object ArrayBuffer]"?A.input=new Uint8Array(d):A.input=d,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new l.Buf8(V),A.next_out=0,A.avail_out=V),(g=r.inflate(A,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&x&&(P=typeof x=="string"?s.string2buf(x):v.call(x)==="[object ArrayBuffer]"?new Uint8Array(x):x,g=r.inflateSetDictionary(this.strm,P)),g===a.Z_BUF_ERROR&&W===!0&&(g=a.Z_OK,W=!1),g!==a.Z_STREAM_END&&g!==a.Z_OK)return this.onEnd(g),!(this.ended=!0);A.next_out&&(A.avail_out!==0&&g!==a.Z_STREAM_END&&(A.avail_in!==0||_!==a.Z_FINISH&&_!==a.Z_SYNC_FLUSH)||(this.options.to==="string"?(D=s.utf8border(A.output,A.next_out),C=A.next_out-D,k=s.buf2string(A.output,D),A.next_out=C,A.avail_out=V-C,C&&l.arraySet(A.output,A.output,D,C,0),this.onData(k)):this.onData(l.shrinkBuf(A.output,A.next_out)))),A.avail_in===0&&A.avail_out===0&&(W=!0)}while((0<A.avail_in||A.avail_out===0)&&g!==a.Z_STREAM_END);return g===a.Z_STREAM_END&&(_=a.Z_FINISH),_===a.Z_FINISH?(g=r.inflateEnd(this.strm),this.onEnd(g),this.ended=!0,g===a.Z_OK):_!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),!(A.avail_out=0))},m.prototype.onData=function(d){this.chunks.push(d)},m.prototype.onEnd=function(d){d===a.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg},o.Inflate=m,o.inflate=h,o.inflateRaw=function(d,y){return(y=y||{}).raw=!0,h(d,y)},o.ungzip=h},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,i,o){var r=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";o.assign=function(a){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var c=u.shift();if(c){if(typeof c!="object")throw new TypeError(c+"must be non-object");for(var p in c)c.hasOwnProperty(p)&&(a[p]=c[p])}}return a},o.shrinkBuf=function(a,u){return a.length===u?a:a.subarray?a.subarray(0,u):(a.length=u,a)};var l={arraySet:function(a,u,c,p,v){if(u.subarray&&a.subarray)a.set(u.subarray(c,c+p),v);else for(var m=0;m<p;m++)a[v+m]=u[c+m]},flattenChunks:function(a){var u,c,p,v,m,h;for(u=p=0,c=a.length;u<c;u++)p+=a[u].length;for(h=new Uint8Array(p),u=v=0,c=a.length;u<c;u++)m=a[u],h.set(m,v),v+=m.length;return h}},s={arraySet:function(a,u,c,p,v){for(var m=0;m<p;m++)a[v+m]=u[c+m]},flattenChunks:function(a){return[].concat.apply([],a)}};o.setTyped=function(a){a?(o.Buf8=Uint8Array,o.Buf16=Uint16Array,o.Buf32=Int32Array,o.assign(o,l)):(o.Buf8=Array,o.Buf16=Array,o.Buf32=Array,o.assign(o,s))},o.setTyped(r)},{}],42:[function(n,i,o){var r=n("./common"),l=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{l=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var a=new r.Buf8(256),u=0;u<256;u++)a[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;function c(p,v){if(v<65537&&(p.subarray&&s||!p.subarray&&l))return String.fromCharCode.apply(null,r.shrinkBuf(p,v));for(var m="",h=0;h<v;h++)m+=String.fromCharCode(p[h]);return m}a[254]=a[254]=1,o.string2buf=function(p){var v,m,h,d,y,g=p.length,_=0;for(d=0;d<g;d++)(64512&(m=p.charCodeAt(d)))==55296&&d+1<g&&(64512&(h=p.charCodeAt(d+1)))==56320&&(m=65536+(m-55296<<10)+(h-56320),d++),_+=m<128?1:m<2048?2:m<65536?3:4;for(v=new r.Buf8(_),d=y=0;y<_;d++)(64512&(m=p.charCodeAt(d)))==55296&&d+1<g&&(64512&(h=p.charCodeAt(d+1)))==56320&&(m=65536+(m-55296<<10)+(h-56320),d++),m<128?v[y++]=m:(m<2048?v[y++]=192|m>>>6:(m<65536?v[y++]=224|m>>>12:(v[y++]=240|m>>>18,v[y++]=128|m>>>12&63),v[y++]=128|m>>>6&63),v[y++]=128|63&m);return v},o.buf2binstring=function(p){return c(p,p.length)},o.binstring2buf=function(p){for(var v=new r.Buf8(p.length),m=0,h=v.length;m<h;m++)v[m]=p.charCodeAt(m);return v},o.buf2string=function(p,v){var m,h,d,y,g=v||p.length,_=new Array(2*g);for(m=h=0;m<g;)if((d=p[m++])<128)_[h++]=d;else if(4<(y=a[d]))_[h++]=65533,m+=y-1;else{for(d&=y===2?31:y===3?15:7;1<y&&m<g;)d=d<<6|63&p[m++],y--;1<y?_[h++]=65533:d<65536?_[h++]=d:(d-=65536,_[h++]=55296|d>>10&1023,_[h++]=56320|1023&d)}return c(_,h)},o.utf8border=function(p,v){var m;for((v=v||p.length)>p.length&&(v=p.length),m=v-1;0<=m&&(192&p[m])==128;)m--;return m<0||m===0?v:m+a[p[m]]>v?m:v}},{"./common":41}],43:[function(n,i,o){i.exports=function(r,l,s,a){for(var u=65535&r|0,c=r>>>16&65535|0,p=0;s!==0;){for(s-=p=2e3<s?2e3:s;c=c+(u=u+l[a++]|0)|0,--p;);u%=65521,c%=65521}return u|c<<16|0}},{}],44:[function(n,i,o){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,i,o){var r=function(){for(var l,s=[],a=0;a<256;a++){l=a;for(var u=0;u<8;u++)l=1&l?3988292384^l>>>1:l>>>1;s[a]=l}return s}();i.exports=function(l,s,a,u){var c=r,p=u+a;l^=-1;for(var v=u;v<p;v++)l=l>>>8^c[255&(l^s[v])];return-1^l}},{}],46:[function(n,i,o){var r,l=n("../utils/common"),s=n("./trees"),a=n("./adler32"),u=n("./crc32"),c=n("./messages"),p=0,v=4,m=0,h=-2,d=-1,y=4,g=2,_=8,D=9,C=286,k=30,P=19,A=2*C+1,V=15,x=3,W=258,et=W+x+1,S=42,$=113,b=1,j=2,st=3,H=4;function ct(f,F){return f.msg=c[F],F}function Y(f){return(f<<1)-(4<f?9:0)}function rt(f){for(var F=f.length;0<=--F;)f[F]=0}function I(f){var F=f.state,O=F.pending;O>f.avail_out&&(O=f.avail_out),O!==0&&(l.arraySet(f.output,F.pending_buf,F.pending_out,O,f.next_out),f.next_out+=O,F.pending_out+=O,f.total_out+=O,f.avail_out-=O,F.pending-=O,F.pending===0&&(F.pending_out=0))}function R(f,F){s._tr_flush_block(f,0<=f.block_start?f.block_start:-1,f.strstart-f.block_start,F),f.block_start=f.strstart,I(f.strm)}function nt(f,F){f.pending_buf[f.pending++]=F}function J(f,F){f.pending_buf[f.pending++]=F>>>8&255,f.pending_buf[f.pending++]=255&F}function K(f,F){var O,w,E=f.max_chain_length,T=f.strstart,z=f.prev_length,G=f.nice_match,L=f.strstart>f.w_size-et?f.strstart-(f.w_size-et):0,X=f.window,Q=f.w_mask,q=f.prev,it=f.strstart+W,_t=X[T+z-1],bt=X[T+z];f.prev_length>=f.good_match&&(E>>=2),G>f.lookahead&&(G=f.lookahead);do if(X[(O=F)+z]===bt&&X[O+z-1]===_t&&X[O]===X[T]&&X[++O]===X[T+1]){T+=2,O++;do;while(X[++T]===X[++O]&&X[++T]===X[++O]&&X[++T]===X[++O]&&X[++T]===X[++O]&&X[++T]===X[++O]&&X[++T]===X[++O]&&X[++T]===X[++O]&&X[++T]===X[++O]&&T<it);if(w=W-(it-T),T=it-W,z<w){if(f.match_start=F,G<=(z=w))break;_t=X[T+z-1],bt=X[T+z]}}while((F=q[F&Q])>L&&--E!=0);return z<=f.lookahead?z:f.lookahead}function yt(f){var F,O,w,E,T,z,G,L,X,Q,q=f.w_size;do{if(E=f.window_size-f.lookahead-f.strstart,f.strstart>=q+(q-et)){for(l.arraySet(f.window,f.window,q,q,0),f.match_start-=q,f.strstart-=q,f.block_start-=q,F=O=f.hash_size;w=f.head[--F],f.head[F]=q<=w?w-q:0,--O;);for(F=O=q;w=f.prev[--F],f.prev[F]=q<=w?w-q:0,--O;);E+=q}if(f.strm.avail_in===0)break;if(z=f.strm,G=f.window,L=f.strstart+f.lookahead,X=E,Q=void 0,Q=z.avail_in,X<Q&&(Q=X),O=Q===0?0:(z.avail_in-=Q,l.arraySet(G,z.input,z.next_in,Q,L),z.state.wrap===1?z.adler=a(z.adler,G,Q,L):z.state.wrap===2&&(z.adler=u(z.adler,G,Q,L)),z.next_in+=Q,z.total_in+=Q,Q),f.lookahead+=O,f.lookahead+f.insert>=x)for(T=f.strstart-f.insert,f.ins_h=f.window[T],f.ins_h=(f.ins_h<<f.hash_shift^f.window[T+1])&f.hash_mask;f.insert&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[T+x-1])&f.hash_mask,f.prev[T&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=T,T++,f.insert--,!(f.lookahead+f.insert<x)););}while(f.lookahead<et&&f.strm.avail_in!==0)}function Lt(f,F){for(var O,w;;){if(f.lookahead<et){if(yt(f),f.lookahead<et&&F===p)return b;if(f.lookahead===0)break}if(O=0,f.lookahead>=x&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+x-1])&f.hash_mask,O=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart),O!==0&&f.strstart-O<=f.w_size-et&&(f.match_length=K(f,O)),f.match_length>=x)if(w=s._tr_tally(f,f.strstart-f.match_start,f.match_length-x),f.lookahead-=f.match_length,f.match_length<=f.max_lazy_match&&f.lookahead>=x){for(f.match_length--;f.strstart++,f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+x-1])&f.hash_mask,O=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart,--f.match_length!=0;);f.strstart++}else f.strstart+=f.match_length,f.match_length=0,f.ins_h=f.window[f.strstart],f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+1])&f.hash_mask;else w=s._tr_tally(f,0,f.window[f.strstart]),f.lookahead--,f.strstart++;if(w&&(R(f,!1),f.strm.avail_out===0))return b}return f.insert=f.strstart<x-1?f.strstart:x-1,F===v?(R(f,!0),f.strm.avail_out===0?st:H):f.last_lit&&(R(f,!1),f.strm.avail_out===0)?b:j}function ht(f,F){for(var O,w,E;;){if(f.lookahead<et){if(yt(f),f.lookahead<et&&F===p)return b;if(f.lookahead===0)break}if(O=0,f.lookahead>=x&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+x-1])&f.hash_mask,O=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart),f.prev_length=f.match_length,f.prev_match=f.match_start,f.match_length=x-1,O!==0&&f.prev_length<f.max_lazy_match&&f.strstart-O<=f.w_size-et&&(f.match_length=K(f,O),f.match_length<=5&&(f.strategy===1||f.match_length===x&&4096<f.strstart-f.match_start)&&(f.match_length=x-1)),f.prev_length>=x&&f.match_length<=f.prev_length){for(E=f.strstart+f.lookahead-x,w=s._tr_tally(f,f.strstart-1-f.prev_match,f.prev_length-x),f.lookahead-=f.prev_length-1,f.prev_length-=2;++f.strstart<=E&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+x-1])&f.hash_mask,O=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart),--f.prev_length!=0;);if(f.match_available=0,f.match_length=x-1,f.strstart++,w&&(R(f,!1),f.strm.avail_out===0))return b}else if(f.match_available){if((w=s._tr_tally(f,0,f.window[f.strstart-1]))&&R(f,!1),f.strstart++,f.lookahead--,f.strm.avail_out===0)return b}else f.match_available=1,f.strstart++,f.lookahead--}return f.match_available&&(w=s._tr_tally(f,0,f.window[f.strstart-1]),f.match_available=0),f.insert=f.strstart<x-1?f.strstart:x-1,F===v?(R(f,!0),f.strm.avail_out===0?st:H):f.last_lit&&(R(f,!1),f.strm.avail_out===0)?b:j}function gt(f,F,O,w,E){this.good_length=f,this.max_lazy=F,this.nice_length=O,this.max_chain=w,this.func=E}function kt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=_,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new l.Buf16(2*A),this.dyn_dtree=new l.Buf16(2*(2*k+1)),this.bl_tree=new l.Buf16(2*(2*P+1)),rt(this.dyn_ltree),rt(this.dyn_dtree),rt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new l.Buf16(V+1),this.heap=new l.Buf16(2*C+1),rt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new l.Buf16(2*C+1),rt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Et(f){var F;return f&&f.state?(f.total_in=f.total_out=0,f.data_type=g,(F=f.state).pending=0,F.pending_out=0,F.wrap<0&&(F.wrap=-F.wrap),F.status=F.wrap?S:$,f.adler=F.wrap===2?0:1,F.last_flush=p,s._tr_init(F),m):ct(f,h)}function zt(f){var F=Et(f);return F===m&&function(O){O.window_size=2*O.w_size,rt(O.head),O.max_lazy_match=r[O.level].max_lazy,O.good_match=r[O.level].good_length,O.nice_match=r[O.level].nice_length,O.max_chain_length=r[O.level].max_chain,O.strstart=0,O.block_start=0,O.lookahead=0,O.insert=0,O.match_length=O.prev_length=x-1,O.match_available=0,O.ins_h=0}(f.state),F}function $t(f,F,O,w,E,T){if(!f)return h;var z=1;if(F===d&&(F=6),w<0?(z=0,w=-w):15<w&&(z=2,w-=16),E<1||D<E||O!==_||w<8||15<w||F<0||9<F||T<0||y<T)return ct(f,h);w===8&&(w=9);var G=new kt;return(f.state=G).strm=f,G.wrap=z,G.gzhead=null,G.w_bits=w,G.w_size=1<<G.w_bits,G.w_mask=G.w_size-1,G.hash_bits=E+7,G.hash_size=1<<G.hash_bits,G.hash_mask=G.hash_size-1,G.hash_shift=~~((G.hash_bits+x-1)/x),G.window=new l.Buf8(2*G.w_size),G.head=new l.Buf16(G.hash_size),G.prev=new l.Buf16(G.w_size),G.lit_bufsize=1<<E+6,G.pending_buf_size=4*G.lit_bufsize,G.pending_buf=new l.Buf8(G.pending_buf_size),G.d_buf=1*G.lit_bufsize,G.l_buf=3*G.lit_bufsize,G.level=F,G.strategy=T,G.method=O,zt(f)}r=[new gt(0,0,0,0,function(f,F){var O=65535;for(O>f.pending_buf_size-5&&(O=f.pending_buf_size-5);;){if(f.lookahead<=1){if(yt(f),f.lookahead===0&&F===p)return b;if(f.lookahead===0)break}f.strstart+=f.lookahead,f.lookahead=0;var w=f.block_start+O;if((f.strstart===0||f.strstart>=w)&&(f.lookahead=f.strstart-w,f.strstart=w,R(f,!1),f.strm.avail_out===0)||f.strstart-f.block_start>=f.w_size-et&&(R(f,!1),f.strm.avail_out===0))return b}return f.insert=0,F===v?(R(f,!0),f.strm.avail_out===0?st:H):(f.strstart>f.block_start&&(R(f,!1),f.strm.avail_out),b)}),new gt(4,4,8,4,Lt),new gt(4,5,16,8,Lt),new gt(4,6,32,32,Lt),new gt(4,4,16,16,ht),new gt(8,16,32,32,ht),new gt(8,16,128,128,ht),new gt(8,32,128,256,ht),new gt(32,128,258,1024,ht),new gt(32,258,258,4096,ht)],o.deflateInit=function(f,F){return $t(f,F,_,15,8,0)},o.deflateInit2=$t,o.deflateReset=zt,o.deflateResetKeep=Et,o.deflateSetHeader=function(f,F){return f&&f.state?f.state.wrap!==2?h:(f.state.gzhead=F,m):h},o.deflate=function(f,F){var O,w,E,T;if(!f||!f.state||5<F||F<0)return f?ct(f,h):h;if(w=f.state,!f.output||!f.input&&f.avail_in!==0||w.status===666&&F!==v)return ct(f,f.avail_out===0?-5:h);if(w.strm=f,O=w.last_flush,w.last_flush=F,w.status===S)if(w.wrap===2)f.adler=0,nt(w,31),nt(w,139),nt(w,8),w.gzhead?(nt(w,(w.gzhead.text?1:0)+(w.gzhead.hcrc?2:0)+(w.gzhead.extra?4:0)+(w.gzhead.name?8:0)+(w.gzhead.comment?16:0)),nt(w,255&w.gzhead.time),nt(w,w.gzhead.time>>8&255),nt(w,w.gzhead.time>>16&255),nt(w,w.gzhead.time>>24&255),nt(w,w.level===9?2:2<=w.strategy||w.level<2?4:0),nt(w,255&w.gzhead.os),w.gzhead.extra&&w.gzhead.extra.length&&(nt(w,255&w.gzhead.extra.length),nt(w,w.gzhead.extra.length>>8&255)),w.gzhead.hcrc&&(f.adler=u(f.adler,w.pending_buf,w.pending,0)),w.gzindex=0,w.status=69):(nt(w,0),nt(w,0),nt(w,0),nt(w,0),nt(w,0),nt(w,w.level===9?2:2<=w.strategy||w.level<2?4:0),nt(w,3),w.status=$);else{var z=_+(w.w_bits-8<<4)<<8;z|=(2<=w.strategy||w.level<2?0:w.level<6?1:w.level===6?2:3)<<6,w.strstart!==0&&(z|=32),z+=31-z%31,w.status=$,J(w,z),w.strstart!==0&&(J(w,f.adler>>>16),J(w,65535&f.adler)),f.adler=1}if(w.status===69)if(w.gzhead.extra){for(E=w.pending;w.gzindex<(65535&w.gzhead.extra.length)&&(w.pending!==w.pending_buf_size||(w.gzhead.hcrc&&w.pending>E&&(f.adler=u(f.adler,w.pending_buf,w.pending-E,E)),I(f),E=w.pending,w.pending!==w.pending_buf_size));)nt(w,255&w.gzhead.extra[w.gzindex]),w.gzindex++;w.gzhead.hcrc&&w.pending>E&&(f.adler=u(f.adler,w.pending_buf,w.pending-E,E)),w.gzindex===w.gzhead.extra.length&&(w.gzindex=0,w.status=73)}else w.status=73;if(w.status===73)if(w.gzhead.name){E=w.pending;do{if(w.pending===w.pending_buf_size&&(w.gzhead.hcrc&&w.pending>E&&(f.adler=u(f.adler,w.pending_buf,w.pending-E,E)),I(f),E=w.pending,w.pending===w.pending_buf_size)){T=1;break}T=w.gzindex<w.gzhead.name.length?255&w.gzhead.name.charCodeAt(w.gzindex++):0,nt(w,T)}while(T!==0);w.gzhead.hcrc&&w.pending>E&&(f.adler=u(f.adler,w.pending_buf,w.pending-E,E)),T===0&&(w.gzindex=0,w.status=91)}else w.status=91;if(w.status===91)if(w.gzhead.comment){E=w.pending;do{if(w.pending===w.pending_buf_size&&(w.gzhead.hcrc&&w.pending>E&&(f.adler=u(f.adler,w.pending_buf,w.pending-E,E)),I(f),E=w.pending,w.pending===w.pending_buf_size)){T=1;break}T=w.gzindex<w.gzhead.comment.length?255&w.gzhead.comment.charCodeAt(w.gzindex++):0,nt(w,T)}while(T!==0);w.gzhead.hcrc&&w.pending>E&&(f.adler=u(f.adler,w.pending_buf,w.pending-E,E)),T===0&&(w.status=103)}else w.status=103;if(w.status===103&&(w.gzhead.hcrc?(w.pending+2>w.pending_buf_size&&I(f),w.pending+2<=w.pending_buf_size&&(nt(w,255&f.adler),nt(w,f.adler>>8&255),f.adler=0,w.status=$)):w.status=$),w.pending!==0){if(I(f),f.avail_out===0)return w.last_flush=-1,m}else if(f.avail_in===0&&Y(F)<=Y(O)&&F!==v)return ct(f,-5);if(w.status===666&&f.avail_in!==0)return ct(f,-5);if(f.avail_in!==0||w.lookahead!==0||F!==p&&w.status!==666){var G=w.strategy===2?function(L,X){for(var Q;;){if(L.lookahead===0&&(yt(L),L.lookahead===0)){if(X===p)return b;break}if(L.match_length=0,Q=s._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++,Q&&(R(L,!1),L.strm.avail_out===0))return b}return L.insert=0,X===v?(R(L,!0),L.strm.avail_out===0?st:H):L.last_lit&&(R(L,!1),L.strm.avail_out===0)?b:j}(w,F):w.strategy===3?function(L,X){for(var Q,q,it,_t,bt=L.window;;){if(L.lookahead<=W){if(yt(L),L.lookahead<=W&&X===p)return b;if(L.lookahead===0)break}if(L.match_length=0,L.lookahead>=x&&0<L.strstart&&(q=bt[it=L.strstart-1])===bt[++it]&&q===bt[++it]&&q===bt[++it]){_t=L.strstart+W;do;while(q===bt[++it]&&q===bt[++it]&&q===bt[++it]&&q===bt[++it]&&q===bt[++it]&&q===bt[++it]&&q===bt[++it]&&q===bt[++it]&&it<_t);L.match_length=W-(_t-it),L.match_length>L.lookahead&&(L.match_length=L.lookahead)}if(L.match_length>=x?(Q=s._tr_tally(L,1,L.match_length-x),L.lookahead-=L.match_length,L.strstart+=L.match_length,L.match_length=0):(Q=s._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++),Q&&(R(L,!1),L.strm.avail_out===0))return b}return L.insert=0,X===v?(R(L,!0),L.strm.avail_out===0?st:H):L.last_lit&&(R(L,!1),L.strm.avail_out===0)?b:j}(w,F):r[w.level].func(w,F);if(G!==st&&G!==H||(w.status=666),G===b||G===st)return f.avail_out===0&&(w.last_flush=-1),m;if(G===j&&(F===1?s._tr_align(w):F!==5&&(s._tr_stored_block(w,0,0,!1),F===3&&(rt(w.head),w.lookahead===0&&(w.strstart=0,w.block_start=0,w.insert=0))),I(f),f.avail_out===0))return w.last_flush=-1,m}return F!==v?m:w.wrap<=0?1:(w.wrap===2?(nt(w,255&f.adler),nt(w,f.adler>>8&255),nt(w,f.adler>>16&255),nt(w,f.adler>>24&255),nt(w,255&f.total_in),nt(w,f.total_in>>8&255),nt(w,f.total_in>>16&255),nt(w,f.total_in>>24&255)):(J(w,f.adler>>>16),J(w,65535&f.adler)),I(f),0<w.wrap&&(w.wrap=-w.wrap),w.pending!==0?m:1)},o.deflateEnd=function(f){var F;return f&&f.state?(F=f.state.status)!==S&&F!==69&&F!==73&&F!==91&&F!==103&&F!==$&&F!==666?ct(f,h):(f.state=null,F===$?ct(f,-3):m):h},o.deflateSetDictionary=function(f,F){var O,w,E,T,z,G,L,X,Q=F.length;if(!f||!f.state||(T=(O=f.state).wrap)===2||T===1&&O.status!==S||O.lookahead)return h;for(T===1&&(f.adler=a(f.adler,F,Q,0)),O.wrap=0,Q>=O.w_size&&(T===0&&(rt(O.head),O.strstart=0,O.block_start=0,O.insert=0),X=new l.Buf8(O.w_size),l.arraySet(X,F,Q-O.w_size,O.w_size,0),F=X,Q=O.w_size),z=f.avail_in,G=f.next_in,L=f.input,f.avail_in=Q,f.next_in=0,f.input=F,yt(O);O.lookahead>=x;){for(w=O.strstart,E=O.lookahead-(x-1);O.ins_h=(O.ins_h<<O.hash_shift^O.window[w+x-1])&O.hash_mask,O.prev[w&O.w_mask]=O.head[O.ins_h],O.head[O.ins_h]=w,w++,--E;);O.strstart=w,O.lookahead=x-1,yt(O)}return O.strstart+=O.lookahead,O.block_start=O.strstart,O.insert=O.lookahead,O.lookahead=0,O.match_length=O.prev_length=x-1,O.match_available=0,f.next_in=G,f.input=L,f.avail_in=z,O.wrap=T,m},o.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,i,o){i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,i,o){i.exports=function(r,l){var s,a,u,c,p,v,m,h,d,y,g,_,D,C,k,P,A,V,x,W,et,S,$,b,j;s=r.state,a=r.next_in,b=r.input,u=a+(r.avail_in-5),c=r.next_out,j=r.output,p=c-(l-r.avail_out),v=c+(r.avail_out-257),m=s.dmax,h=s.wsize,d=s.whave,y=s.wnext,g=s.window,_=s.hold,D=s.bits,C=s.lencode,k=s.distcode,P=(1<<s.lenbits)-1,A=(1<<s.distbits)-1;t:do{D<15&&(_+=b[a++]<<D,D+=8,_+=b[a++]<<D,D+=8),V=C[_&P];e:for(;;){if(_>>>=x=V>>>24,D-=x,(x=V>>>16&255)===0)j[c++]=65535&V;else{if(!(16&x)){if(!(64&x)){V=C[(65535&V)+(_&(1<<x)-1)];continue e}if(32&x){s.mode=12;break t}r.msg="invalid literal/length code",s.mode=30;break t}W=65535&V,(x&=15)&&(D<x&&(_+=b[a++]<<D,D+=8),W+=_&(1<<x)-1,_>>>=x,D-=x),D<15&&(_+=b[a++]<<D,D+=8,_+=b[a++]<<D,D+=8),V=k[_&A];n:for(;;){if(_>>>=x=V>>>24,D-=x,!(16&(x=V>>>16&255))){if(!(64&x)){V=k[(65535&V)+(_&(1<<x)-1)];continue n}r.msg="invalid distance code",s.mode=30;break t}if(et=65535&V,D<(x&=15)&&(_+=b[a++]<<D,(D+=8)<x&&(_+=b[a++]<<D,D+=8)),m<(et+=_&(1<<x)-1)){r.msg="invalid distance too far back",s.mode=30;break t}if(_>>>=x,D-=x,(x=c-p)<et){if(d<(x=et-x)&&s.sane){r.msg="invalid distance too far back",s.mode=30;break t}if($=g,(S=0)===y){if(S+=h-x,x<W){for(W-=x;j[c++]=g[S++],--x;);S=c-et,$=j}}else if(y<x){if(S+=h+y-x,(x-=y)<W){for(W-=x;j[c++]=g[S++],--x;);if(S=0,y<W){for(W-=x=y;j[c++]=g[S++],--x;);S=c-et,$=j}}}else if(S+=y-x,x<W){for(W-=x;j[c++]=g[S++],--x;);S=c-et,$=j}for(;2<W;)j[c++]=$[S++],j[c++]=$[S++],j[c++]=$[S++],W-=3;W&&(j[c++]=$[S++],1<W&&(j[c++]=$[S++]))}else{for(S=c-et;j[c++]=j[S++],j[c++]=j[S++],j[c++]=j[S++],2<(W-=3););W&&(j[c++]=j[S++],1<W&&(j[c++]=j[S++]))}break}}break}}while(a<u&&c<v);a-=W=D>>3,_&=(1<<(D-=W<<3))-1,r.next_in=a,r.next_out=c,r.avail_in=a<u?u-a+5:5-(a-u),r.avail_out=c<v?v-c+257:257-(c-v),s.hold=_,s.bits=D}},{}],49:[function(n,i,o){var r=n("../utils/common"),l=n("./adler32"),s=n("./crc32"),a=n("./inffast"),u=n("./inftrees"),c=1,p=2,v=0,m=-2,h=1,d=852,y=592;function g(S){return(S>>>24&255)+(S>>>8&65280)+((65280&S)<<8)+((255&S)<<24)}function _(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function D(S){var $;return S&&S.state?($=S.state,S.total_in=S.total_out=$.total=0,S.msg="",$.wrap&&(S.adler=1&$.wrap),$.mode=h,$.last=0,$.havedict=0,$.dmax=32768,$.head=null,$.hold=0,$.bits=0,$.lencode=$.lendyn=new r.Buf32(d),$.distcode=$.distdyn=new r.Buf32(y),$.sane=1,$.back=-1,v):m}function C(S){var $;return S&&S.state?(($=S.state).wsize=0,$.whave=0,$.wnext=0,D(S)):m}function k(S,$){var b,j;return S&&S.state?(j=S.state,$<0?(b=0,$=-$):(b=1+($>>4),$<48&&($&=15)),$&&($<8||15<$)?m:(j.window!==null&&j.wbits!==$&&(j.window=null),j.wrap=b,j.wbits=$,C(S))):m}function P(S,$){var b,j;return S?(j=new _,(S.state=j).window=null,(b=k(S,$))!==v&&(S.state=null),b):m}var A,V,x=!0;function W(S){if(x){var $;for(A=new r.Buf32(512),V=new r.Buf32(32),$=0;$<144;)S.lens[$++]=8;for(;$<256;)S.lens[$++]=9;for(;$<280;)S.lens[$++]=7;for(;$<288;)S.lens[$++]=8;for(u(c,S.lens,0,288,A,0,S.work,{bits:9}),$=0;$<32;)S.lens[$++]=5;u(p,S.lens,0,32,V,0,S.work,{bits:5}),x=!1}S.lencode=A,S.lenbits=9,S.distcode=V,S.distbits=5}function et(S,$,b,j){var st,H=S.state;return H.window===null&&(H.wsize=1<<H.wbits,H.wnext=0,H.whave=0,H.window=new r.Buf8(H.wsize)),j>=H.wsize?(r.arraySet(H.window,$,b-H.wsize,H.wsize,0),H.wnext=0,H.whave=H.wsize):(j<(st=H.wsize-H.wnext)&&(st=j),r.arraySet(H.window,$,b-j,st,H.wnext),(j-=st)?(r.arraySet(H.window,$,b-j,j,0),H.wnext=j,H.whave=H.wsize):(H.wnext+=st,H.wnext===H.wsize&&(H.wnext=0),H.whave<H.wsize&&(H.whave+=st))),0}o.inflateReset=C,o.inflateReset2=k,o.inflateResetKeep=D,o.inflateInit=function(S){return P(S,15)},o.inflateInit2=P,o.inflate=function(S,$){var b,j,st,H,ct,Y,rt,I,R,nt,J,K,yt,Lt,ht,gt,kt,Et,zt,$t,f,F,O,w,E=0,T=new r.Buf8(4),z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!S||!S.state||!S.output||!S.input&&S.avail_in!==0)return m;(b=S.state).mode===12&&(b.mode=13),ct=S.next_out,st=S.output,rt=S.avail_out,H=S.next_in,j=S.input,Y=S.avail_in,I=b.hold,R=b.bits,nt=Y,J=rt,F=v;t:for(;;)switch(b.mode){case h:if(b.wrap===0){b.mode=13;break}for(;R<16;){if(Y===0)break t;Y--,I+=j[H++]<<R,R+=8}if(2&b.wrap&&I===35615){T[b.check=0]=255&I,T[1]=I>>>8&255,b.check=s(b.check,T,2,0),R=I=0,b.mode=2;break}if(b.flags=0,b.head&&(b.head.done=!1),!(1&b.wrap)||(((255&I)<<8)+(I>>8))%31){S.msg="incorrect header check",b.mode=30;break}if((15&I)!=8){S.msg="unknown compression method",b.mode=30;break}if(R-=4,f=8+(15&(I>>>=4)),b.wbits===0)b.wbits=f;else if(f>b.wbits){S.msg="invalid window size",b.mode=30;break}b.dmax=1<<f,S.adler=b.check=1,b.mode=512&I?10:12,R=I=0;break;case 2:for(;R<16;){if(Y===0)break t;Y--,I+=j[H++]<<R,R+=8}if(b.flags=I,(255&b.flags)!=8){S.msg="unknown compression method",b.mode=30;break}if(57344&b.flags){S.msg="unknown header flags set",b.mode=30;break}b.head&&(b.head.text=I>>8&1),512&b.flags&&(T[0]=255&I,T[1]=I>>>8&255,b.check=s(b.check,T,2,0)),R=I=0,b.mode=3;case 3:for(;R<32;){if(Y===0)break t;Y--,I+=j[H++]<<R,R+=8}b.head&&(b.head.time=I),512&b.flags&&(T[0]=255&I,T[1]=I>>>8&255,T[2]=I>>>16&255,T[3]=I>>>24&255,b.check=s(b.check,T,4,0)),R=I=0,b.mode=4;case 4:for(;R<16;){if(Y===0)break t;Y--,I+=j[H++]<<R,R+=8}b.head&&(b.head.xflags=255&I,b.head.os=I>>8),512&b.flags&&(T[0]=255&I,T[1]=I>>>8&255,b.check=s(b.check,T,2,0)),R=I=0,b.mode=5;case 5:if(1024&b.flags){for(;R<16;){if(Y===0)break t;Y--,I+=j[H++]<<R,R+=8}b.length=I,b.head&&(b.head.extra_len=I),512&b.flags&&(T[0]=255&I,T[1]=I>>>8&255,b.check=s(b.check,T,2,0)),R=I=0}else b.head&&(b.head.extra=null);b.mode=6;case 6:if(1024&b.flags&&(Y<(K=b.length)&&(K=Y),K&&(b.head&&(f=b.head.extra_len-b.length,b.head.extra||(b.head.extra=new Array(b.head.extra_len)),r.arraySet(b.head.extra,j,H,K,f)),512&b.flags&&(b.check=s(b.check,j,K,H)),Y-=K,H+=K,b.length-=K),b.length))break t;b.length=0,b.mode=7;case 7:if(2048&b.flags){if(Y===0)break t;for(K=0;f=j[H+K++],b.head&&f&&b.length<65536&&(b.head.name+=String.fromCharCode(f)),f&&K<Y;);if(512&b.flags&&(b.check=s(b.check,j,K,H)),Y-=K,H+=K,f)break t}else b.head&&(b.head.name=null);b.length=0,b.mode=8;case 8:if(4096&b.flags){if(Y===0)break t;for(K=0;f=j[H+K++],b.head&&f&&b.length<65536&&(b.head.comment+=String.fromCharCode(f)),f&&K<Y;);if(512&b.flags&&(b.check=s(b.check,j,K,H)),Y-=K,H+=K,f)break t}else b.head&&(b.head.comment=null);b.mode=9;case 9:if(512&b.flags){for(;R<16;){if(Y===0)break t;Y--,I+=j[H++]<<R,R+=8}if(I!==(65535&b.check)){S.msg="header crc mismatch",b.mode=30;break}R=I=0}b.head&&(b.head.hcrc=b.flags>>9&1,b.head.done=!0),S.adler=b.check=0,b.mode=12;break;case 10:for(;R<32;){if(Y===0)break t;Y--,I+=j[H++]<<R,R+=8}S.adler=b.check=g(I),R=I=0,b.mode=11;case 11:if(b.havedict===0)return S.next_out=ct,S.avail_out=rt,S.next_in=H,S.avail_in=Y,b.hold=I,b.bits=R,2;S.adler=b.check=1,b.mode=12;case 12:if($===5||$===6)break t;case 13:if(b.last){I>>>=7&R,R-=7&R,b.mode=27;break}for(;R<3;){if(Y===0)break t;Y--,I+=j[H++]<<R,R+=8}switch(b.last=1&I,R-=1,3&(I>>>=1)){case 0:b.mode=14;break;case 1:if(W(b),b.mode=20,$!==6)break;I>>>=2,R-=2;break t;case 2:b.mode=17;break;case 3:S.msg="invalid block type",b.mode=30}I>>>=2,R-=2;break;case 14:for(I>>>=7&R,R-=7&R;R<32;){if(Y===0)break t;Y--,I+=j[H++]<<R,R+=8}if((65535&I)!=(I>>>16^65535)){S.msg="invalid stored block lengths",b.mode=30;break}if(b.length=65535&I,R=I=0,b.mode=15,$===6)break t;case 15:b.mode=16;case 16:if(K=b.length){if(Y<K&&(K=Y),rt<K&&(K=rt),K===0)break t;r.arraySet(st,j,H,K,ct),Y-=K,H+=K,rt-=K,ct+=K,b.length-=K;break}b.mode=12;break;case 17:for(;R<14;){if(Y===0)break t;Y--,I+=j[H++]<<R,R+=8}if(b.nlen=257+(31&I),I>>>=5,R-=5,b.ndist=1+(31&I),I>>>=5,R-=5,b.ncode=4+(15&I),I>>>=4,R-=4,286<b.nlen||30<b.ndist){S.msg="too many length or distance symbols",b.mode=30;break}b.have=0,b.mode=18;case 18:for(;b.have<b.ncode;){for(;R<3;){if(Y===0)break t;Y--,I+=j[H++]<<R,R+=8}b.lens[z[b.have++]]=7&I,I>>>=3,R-=3}for(;b.have<19;)b.lens[z[b.have++]]=0;if(b.lencode=b.lendyn,b.lenbits=7,O={bits:b.lenbits},F=u(0,b.lens,0,19,b.lencode,0,b.work,O),b.lenbits=O.bits,F){S.msg="invalid code lengths set",b.mode=30;break}b.have=0,b.mode=19;case 19:for(;b.have<b.nlen+b.ndist;){for(;gt=(E=b.lencode[I&(1<<b.lenbits)-1])>>>16&255,kt=65535&E,!((ht=E>>>24)<=R);){if(Y===0)break t;Y--,I+=j[H++]<<R,R+=8}if(kt<16)I>>>=ht,R-=ht,b.lens[b.have++]=kt;else{if(kt===16){for(w=ht+2;R<w;){if(Y===0)break t;Y--,I+=j[H++]<<R,R+=8}if(I>>>=ht,R-=ht,b.have===0){S.msg="invalid bit length repeat",b.mode=30;break}f=b.lens[b.have-1],K=3+(3&I),I>>>=2,R-=2}else if(kt===17){for(w=ht+3;R<w;){if(Y===0)break t;Y--,I+=j[H++]<<R,R+=8}R-=ht,f=0,K=3+(7&(I>>>=ht)),I>>>=3,R-=3}else{for(w=ht+7;R<w;){if(Y===0)break t;Y--,I+=j[H++]<<R,R+=8}R-=ht,f=0,K=11+(127&(I>>>=ht)),I>>>=7,R-=7}if(b.have+K>b.nlen+b.ndist){S.msg="invalid bit length repeat",b.mode=30;break}for(;K--;)b.lens[b.have++]=f}}if(b.mode===30)break;if(b.lens[256]===0){S.msg="invalid code -- missing end-of-block",b.mode=30;break}if(b.lenbits=9,O={bits:b.lenbits},F=u(c,b.lens,0,b.nlen,b.lencode,0,b.work,O),b.lenbits=O.bits,F){S.msg="invalid literal/lengths set",b.mode=30;break}if(b.distbits=6,b.distcode=b.distdyn,O={bits:b.distbits},F=u(p,b.lens,b.nlen,b.ndist,b.distcode,0,b.work,O),b.distbits=O.bits,F){S.msg="invalid distances set",b.mode=30;break}if(b.mode=20,$===6)break t;case 20:b.mode=21;case 21:if(6<=Y&&258<=rt){S.next_out=ct,S.avail_out=rt,S.next_in=H,S.avail_in=Y,b.hold=I,b.bits=R,a(S,J),ct=S.next_out,st=S.output,rt=S.avail_out,H=S.next_in,j=S.input,Y=S.avail_in,I=b.hold,R=b.bits,b.mode===12&&(b.back=-1);break}for(b.back=0;gt=(E=b.lencode[I&(1<<b.lenbits)-1])>>>16&255,kt=65535&E,!((ht=E>>>24)<=R);){if(Y===0)break t;Y--,I+=j[H++]<<R,R+=8}if(gt&&!(240&gt)){for(Et=ht,zt=gt,$t=kt;gt=(E=b.lencode[$t+((I&(1<<Et+zt)-1)>>Et)])>>>16&255,kt=65535&E,!(Et+(ht=E>>>24)<=R);){if(Y===0)break t;Y--,I+=j[H++]<<R,R+=8}I>>>=Et,R-=Et,b.back+=Et}if(I>>>=ht,R-=ht,b.back+=ht,b.length=kt,gt===0){b.mode=26;break}if(32&gt){b.back=-1,b.mode=12;break}if(64&gt){S.msg="invalid literal/length code",b.mode=30;break}b.extra=15&gt,b.mode=22;case 22:if(b.extra){for(w=b.extra;R<w;){if(Y===0)break t;Y--,I+=j[H++]<<R,R+=8}b.length+=I&(1<<b.extra)-1,I>>>=b.extra,R-=b.extra,b.back+=b.extra}b.was=b.length,b.mode=23;case 23:for(;gt=(E=b.distcode[I&(1<<b.distbits)-1])>>>16&255,kt=65535&E,!((ht=E>>>24)<=R);){if(Y===0)break t;Y--,I+=j[H++]<<R,R+=8}if(!(240&gt)){for(Et=ht,zt=gt,$t=kt;gt=(E=b.distcode[$t+((I&(1<<Et+zt)-1)>>Et)])>>>16&255,kt=65535&E,!(Et+(ht=E>>>24)<=R);){if(Y===0)break t;Y--,I+=j[H++]<<R,R+=8}I>>>=Et,R-=Et,b.back+=Et}if(I>>>=ht,R-=ht,b.back+=ht,64&gt){S.msg="invalid distance code",b.mode=30;break}b.offset=kt,b.extra=15&gt,b.mode=24;case 24:if(b.extra){for(w=b.extra;R<w;){if(Y===0)break t;Y--,I+=j[H++]<<R,R+=8}b.offset+=I&(1<<b.extra)-1,I>>>=b.extra,R-=b.extra,b.back+=b.extra}if(b.offset>b.dmax){S.msg="invalid distance too far back",b.mode=30;break}b.mode=25;case 25:if(rt===0)break t;if(K=J-rt,b.offset>K){if((K=b.offset-K)>b.whave&&b.sane){S.msg="invalid distance too far back",b.mode=30;break}yt=K>b.wnext?(K-=b.wnext,b.wsize-K):b.wnext-K,K>b.length&&(K=b.length),Lt=b.window}else Lt=st,yt=ct-b.offset,K=b.length;for(rt<K&&(K=rt),rt-=K,b.length-=K;st[ct++]=Lt[yt++],--K;);b.length===0&&(b.mode=21);break;case 26:if(rt===0)break t;st[ct++]=b.length,rt--,b.mode=21;break;case 27:if(b.wrap){for(;R<32;){if(Y===0)break t;Y--,I|=j[H++]<<R,R+=8}if(J-=rt,S.total_out+=J,b.total+=J,J&&(S.adler=b.check=b.flags?s(b.check,st,J,ct-J):l(b.check,st,J,ct-J)),J=rt,(b.flags?I:g(I))!==b.check){S.msg="incorrect data check",b.mode=30;break}R=I=0}b.mode=28;case 28:if(b.wrap&&b.flags){for(;R<32;){if(Y===0)break t;Y--,I+=j[H++]<<R,R+=8}if(I!==(4294967295&b.total)){S.msg="incorrect length check",b.mode=30;break}R=I=0}b.mode=29;case 29:F=1;break t;case 30:F=-3;break t;case 31:return-4;case 32:default:return m}return S.next_out=ct,S.avail_out=rt,S.next_in=H,S.avail_in=Y,b.hold=I,b.bits=R,(b.wsize||J!==S.avail_out&&b.mode<30&&(b.mode<27||$!==4))&&et(S,S.output,S.next_out,J-S.avail_out)?(b.mode=31,-4):(nt-=S.avail_in,J-=S.avail_out,S.total_in+=nt,S.total_out+=J,b.total+=J,b.wrap&&J&&(S.adler=b.check=b.flags?s(b.check,st,J,S.next_out-J):l(b.check,st,J,S.next_out-J)),S.data_type=b.bits+(b.last?64:0)+(b.mode===12?128:0)+(b.mode===20||b.mode===15?256:0),(nt==0&&J===0||$===4)&&F===v&&(F=-5),F)},o.inflateEnd=function(S){if(!S||!S.state)return m;var $=S.state;return $.window&&($.window=null),S.state=null,v},o.inflateGetHeader=function(S,$){var b;return S&&S.state&&2&(b=S.state).wrap?((b.head=$).done=!1,v):m},o.inflateSetDictionary=function(S,$){var b,j=$.length;return S&&S.state?(b=S.state).wrap!==0&&b.mode!==11?m:b.mode===11&&l(1,$,j,0)!==b.check?-3:et(S,$,j,j)?(b.mode=31,-4):(b.havedict=1,v):m},o.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,i,o){var r=n("../utils/common"),l=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(c,p,v,m,h,d,y,g){var _,D,C,k,P,A,V,x,W,et=g.bits,S=0,$=0,b=0,j=0,st=0,H=0,ct=0,Y=0,rt=0,I=0,R=null,nt=0,J=new r.Buf16(16),K=new r.Buf16(16),yt=null,Lt=0;for(S=0;S<=15;S++)J[S]=0;for($=0;$<m;$++)J[p[v+$]]++;for(st=et,j=15;1<=j&&J[j]===0;j--);if(j<st&&(st=j),j===0)return h[d++]=20971520,h[d++]=20971520,g.bits=1,0;for(b=1;b<j&&J[b]===0;b++);for(st<b&&(st=b),S=Y=1;S<=15;S++)if(Y<<=1,(Y-=J[S])<0)return-1;if(0<Y&&(c===0||j!==1))return-1;for(K[1]=0,S=1;S<15;S++)K[S+1]=K[S]+J[S];for($=0;$<m;$++)p[v+$]!==0&&(y[K[p[v+$]]++]=$);if(A=c===0?(R=yt=y,19):c===1?(R=l,nt-=257,yt=s,Lt-=257,256):(R=a,yt=u,-1),S=b,P=d,ct=$=I=0,C=-1,k=(rt=1<<(H=st))-1,c===1&&852<rt||c===2&&592<rt)return 1;for(;;){for(V=S-ct,W=y[$]<A?(x=0,y[$]):y[$]>A?(x=yt[Lt+y[$]],R[nt+y[$]]):(x=96,0),_=1<<S-ct,b=D=1<<H;h[P+(I>>ct)+(D-=_)]=V<<24|x<<16|W|0,D!==0;);for(_=1<<S-1;I&_;)_>>=1;if(_!==0?(I&=_-1,I+=_):I=0,$++,--J[S]==0){if(S===j)break;S=p[v+y[$]]}if(st<S&&(I&k)!==C){for(ct===0&&(ct=st),P+=b,Y=1<<(H=S-ct);H+ct<j&&!((Y-=J[H+ct])<=0);)H++,Y<<=1;if(rt+=1<<H,c===1&&852<rt||c===2&&592<rt)return 1;h[C=I&k]=st<<24|H<<16|P-d|0}}return I!==0&&(h[P+I]=S-ct<<24|64<<16|0),g.bits=st,0}},{"../utils/common":41}],51:[function(n,i,o){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,i,o){var r=n("../utils/common"),l=0,s=1;function a(E){for(var T=E.length;0<=--T;)E[T]=0}var u=0,c=29,p=256,v=p+1+c,m=30,h=19,d=2*v+1,y=15,g=16,_=7,D=256,C=16,k=17,P=18,A=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],V=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],et=new Array(2*(v+2));a(et);var S=new Array(2*m);a(S);var $=new Array(512);a($);var b=new Array(256);a(b);var j=new Array(c);a(j);var st,H,ct,Y=new Array(m);function rt(E,T,z,G,L){this.static_tree=E,this.extra_bits=T,this.extra_base=z,this.elems=G,this.max_length=L,this.has_stree=E&&E.length}function I(E,T){this.dyn_tree=E,this.max_code=0,this.stat_desc=T}function R(E){return E<256?$[E]:$[256+(E>>>7)]}function nt(E,T){E.pending_buf[E.pending++]=255&T,E.pending_buf[E.pending++]=T>>>8&255}function J(E,T,z){E.bi_valid>g-z?(E.bi_buf|=T<<E.bi_valid&65535,nt(E,E.bi_buf),E.bi_buf=T>>g-E.bi_valid,E.bi_valid+=z-g):(E.bi_buf|=T<<E.bi_valid&65535,E.bi_valid+=z)}function K(E,T,z){J(E,z[2*T],z[2*T+1])}function yt(E,T){for(var z=0;z|=1&E,E>>>=1,z<<=1,0<--T;);return z>>>1}function Lt(E,T,z){var G,L,X=new Array(y+1),Q=0;for(G=1;G<=y;G++)X[G]=Q=Q+z[G-1]<<1;for(L=0;L<=T;L++){var q=E[2*L+1];q!==0&&(E[2*L]=yt(X[q]++,q))}}function ht(E){var T;for(T=0;T<v;T++)E.dyn_ltree[2*T]=0;for(T=0;T<m;T++)E.dyn_dtree[2*T]=0;for(T=0;T<h;T++)E.bl_tree[2*T]=0;E.dyn_ltree[2*D]=1,E.opt_len=E.static_len=0,E.last_lit=E.matches=0}function gt(E){8<E.bi_valid?nt(E,E.bi_buf):0<E.bi_valid&&(E.pending_buf[E.pending++]=E.bi_buf),E.bi_buf=0,E.bi_valid=0}function kt(E,T,z,G){var L=2*T,X=2*z;return E[L]<E[X]||E[L]===E[X]&&G[T]<=G[z]}function Et(E,T,z){for(var G=E.heap[z],L=z<<1;L<=E.heap_len&&(L<E.heap_len&&kt(T,E.heap[L+1],E.heap[L],E.depth)&&L++,!kt(T,G,E.heap[L],E.depth));)E.heap[z]=E.heap[L],z=L,L<<=1;E.heap[z]=G}function zt(E,T,z){var G,L,X,Q,q=0;if(E.last_lit!==0)for(;G=E.pending_buf[E.d_buf+2*q]<<8|E.pending_buf[E.d_buf+2*q+1],L=E.pending_buf[E.l_buf+q],q++,G===0?K(E,L,T):(K(E,(X=b[L])+p+1,T),(Q=A[X])!==0&&J(E,L-=j[X],Q),K(E,X=R(--G),z),(Q=V[X])!==0&&J(E,G-=Y[X],Q)),q<E.last_lit;);K(E,D,T)}function $t(E,T){var z,G,L,X=T.dyn_tree,Q=T.stat_desc.static_tree,q=T.stat_desc.has_stree,it=T.stat_desc.elems,_t=-1;for(E.heap_len=0,E.heap_max=d,z=0;z<it;z++)X[2*z]!==0?(E.heap[++E.heap_len]=_t=z,E.depth[z]=0):X[2*z+1]=0;for(;E.heap_len<2;)X[2*(L=E.heap[++E.heap_len]=_t<2?++_t:0)]=1,E.depth[L]=0,E.opt_len--,q&&(E.static_len-=Q[2*L+1]);for(T.max_code=_t,z=E.heap_len>>1;1<=z;z--)Et(E,X,z);for(L=it;z=E.heap[1],E.heap[1]=E.heap[E.heap_len--],Et(E,X,1),G=E.heap[1],E.heap[--E.heap_max]=z,E.heap[--E.heap_max]=G,X[2*L]=X[2*z]+X[2*G],E.depth[L]=(E.depth[z]>=E.depth[G]?E.depth[z]:E.depth[G])+1,X[2*z+1]=X[2*G+1]=L,E.heap[1]=L++,Et(E,X,1),2<=E.heap_len;);E.heap[--E.heap_max]=E.heap[1],function(bt,Ht){var ze,Zt,Ve,Tt,mn,kn,ie=Ht.dyn_tree,Un=Ht.max_code,ui=Ht.stat_desc.static_tree,ci=Ht.stat_desc.has_stree,mi=Ht.stat_desc.extra_bits,Wn=Ht.stat_desc.extra_base,Ge=Ht.stat_desc.max_length,hn=0;for(Tt=0;Tt<=y;Tt++)bt.bl_count[Tt]=0;for(ie[2*bt.heap[bt.heap_max]+1]=0,ze=bt.heap_max+1;ze<d;ze++)Ge<(Tt=ie[2*ie[2*(Zt=bt.heap[ze])+1]+1]+1)&&(Tt=Ge,hn++),ie[2*Zt+1]=Tt,Un<Zt||(bt.bl_count[Tt]++,mn=0,Wn<=Zt&&(mn=mi[Zt-Wn]),kn=ie[2*Zt],bt.opt_len+=kn*(Tt+mn),ci&&(bt.static_len+=kn*(ui[2*Zt+1]+mn)));if(hn!==0){do{for(Tt=Ge-1;bt.bl_count[Tt]===0;)Tt--;bt.bl_count[Tt]--,bt.bl_count[Tt+1]+=2,bt.bl_count[Ge]--,hn-=2}while(0<hn);for(Tt=Ge;Tt!==0;Tt--)for(Zt=bt.bl_count[Tt];Zt!==0;)Un<(Ve=bt.heap[--ze])||(ie[2*Ve+1]!==Tt&&(bt.opt_len+=(Tt-ie[2*Ve+1])*ie[2*Ve],ie[2*Ve+1]=Tt),Zt--)}}(E,T),Lt(X,_t,E.bl_count)}function f(E,T,z){var G,L,X=-1,Q=T[1],q=0,it=7,_t=4;for(Q===0&&(it=138,_t=3),T[2*(z+1)+1]=65535,G=0;G<=z;G++)L=Q,Q=T[2*(G+1)+1],++q<it&&L===Q||(q<_t?E.bl_tree[2*L]+=q:L!==0?(L!==X&&E.bl_tree[2*L]++,E.bl_tree[2*C]++):q<=10?E.bl_tree[2*k]++:E.bl_tree[2*P]++,X=L,_t=(q=0)===Q?(it=138,3):L===Q?(it=6,3):(it=7,4))}function F(E,T,z){var G,L,X=-1,Q=T[1],q=0,it=7,_t=4;for(Q===0&&(it=138,_t=3),G=0;G<=z;G++)if(L=Q,Q=T[2*(G+1)+1],!(++q<it&&L===Q)){if(q<_t)for(;K(E,L,E.bl_tree),--q!=0;);else L!==0?(L!==X&&(K(E,L,E.bl_tree),q--),K(E,C,E.bl_tree),J(E,q-3,2)):q<=10?(K(E,k,E.bl_tree),J(E,q-3,3)):(K(E,P,E.bl_tree),J(E,q-11,7));X=L,_t=(q=0)===Q?(it=138,3):L===Q?(it=6,3):(it=7,4)}}a(Y);var O=!1;function w(E,T,z,G){J(E,(u<<1)+(G?1:0),3),function(L,X,Q,q){gt(L),nt(L,Q),nt(L,~Q),r.arraySet(L.pending_buf,L.window,X,Q,L.pending),L.pending+=Q}(E,T,z)}o._tr_init=function(E){O||(function(){var T,z,G,L,X,Q=new Array(y+1);for(L=G=0;L<c-1;L++)for(j[L]=G,T=0;T<1<<A[L];T++)b[G++]=L;for(b[G-1]=L,L=X=0;L<16;L++)for(Y[L]=X,T=0;T<1<<V[L];T++)$[X++]=L;for(X>>=7;L<m;L++)for(Y[L]=X<<7,T=0;T<1<<V[L]-7;T++)$[256+X++]=L;for(z=0;z<=y;z++)Q[z]=0;for(T=0;T<=143;)et[2*T+1]=8,T++,Q[8]++;for(;T<=255;)et[2*T+1]=9,T++,Q[9]++;for(;T<=279;)et[2*T+1]=7,T++,Q[7]++;for(;T<=287;)et[2*T+1]=8,T++,Q[8]++;for(Lt(et,v+1,Q),T=0;T<m;T++)S[2*T+1]=5,S[2*T]=yt(T,5);st=new rt(et,A,p+1,v,y),H=new rt(S,V,0,m,y),ct=new rt(new Array(0),x,0,h,_)}(),O=!0),E.l_desc=new I(E.dyn_ltree,st),E.d_desc=new I(E.dyn_dtree,H),E.bl_desc=new I(E.bl_tree,ct),E.bi_buf=0,E.bi_valid=0,ht(E)},o._tr_stored_block=w,o._tr_flush_block=function(E,T,z,G){var L,X,Q=0;0<E.level?(E.strm.data_type===2&&(E.strm.data_type=function(q){var it,_t=4093624447;for(it=0;it<=31;it++,_t>>>=1)if(1&_t&&q.dyn_ltree[2*it]!==0)return l;if(q.dyn_ltree[18]!==0||q.dyn_ltree[20]!==0||q.dyn_ltree[26]!==0)return s;for(it=32;it<p;it++)if(q.dyn_ltree[2*it]!==0)return s;return l}(E)),$t(E,E.l_desc),$t(E,E.d_desc),Q=function(q){var it;for(f(q,q.dyn_ltree,q.l_desc.max_code),f(q,q.dyn_dtree,q.d_desc.max_code),$t(q,q.bl_desc),it=h-1;3<=it&&q.bl_tree[2*W[it]+1]===0;it--);return q.opt_len+=3*(it+1)+5+5+4,it}(E),L=E.opt_len+3+7>>>3,(X=E.static_len+3+7>>>3)<=L&&(L=X)):L=X=z+5,z+4<=L&&T!==-1?w(E,T,z,G):E.strategy===4||X===L?(J(E,2+(G?1:0),3),zt(E,et,S)):(J(E,4+(G?1:0),3),function(q,it,_t,bt){var Ht;for(J(q,it-257,5),J(q,_t-1,5),J(q,bt-4,4),Ht=0;Ht<bt;Ht++)J(q,q.bl_tree[2*W[Ht]+1],3);F(q,q.dyn_ltree,it-1),F(q,q.dyn_dtree,_t-1)}(E,E.l_desc.max_code+1,E.d_desc.max_code+1,Q+1),zt(E,E.dyn_ltree,E.dyn_dtree)),ht(E),G&&gt(E)},o._tr_tally=function(E,T,z){return E.pending_buf[E.d_buf+2*E.last_lit]=T>>>8&255,E.pending_buf[E.d_buf+2*E.last_lit+1]=255&T,E.pending_buf[E.l_buf+E.last_lit]=255&z,E.last_lit++,T===0?E.dyn_ltree[2*z]++:(E.matches++,T--,E.dyn_ltree[2*(b[z]+p+1)]++,E.dyn_dtree[2*R(T)]++),E.last_lit===E.lit_bufsize-1},o._tr_align=function(E){J(E,2,3),K(E,D,et),function(T){T.bi_valid===16?(nt(T,T.bi_buf),T.bi_buf=0,T.bi_valid=0):8<=T.bi_valid&&(T.pending_buf[T.pending++]=255&T.bi_buf,T.bi_buf>>=8,T.bi_valid-=8)}(E)}},{"../utils/common":41}],53:[function(n,i,o){i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,i,o){(function(r){(function(l,s){if(!l.setImmediate){var a,u,c,p,v=1,m={},h=!1,d=l.document,y=Object.getPrototypeOf&&Object.getPrototypeOf(l);y=y&&y.setTimeout?y:l,a={}.toString.call(l.process)==="[object process]"?function(C){process.nextTick(function(){_(C)})}:function(){if(l.postMessage&&!l.importScripts){var C=!0,k=l.onmessage;return l.onmessage=function(){C=!1},l.postMessage("","*"),l.onmessage=k,C}}()?(p="setImmediate$"+Math.random()+"$",l.addEventListener?l.addEventListener("message",D,!1):l.attachEvent("onmessage",D),function(C){l.postMessage(p+C,"*")}):l.MessageChannel?((c=new MessageChannel).port1.onmessage=function(C){_(C.data)},function(C){c.port2.postMessage(C)}):d&&"onreadystatechange"in d.createElement("script")?(u=d.documentElement,function(C){var k=d.createElement("script");k.onreadystatechange=function(){_(C),k.onreadystatechange=null,u.removeChild(k),k=null},u.appendChild(k)}):function(C){setTimeout(_,0,C)},y.setImmediate=function(C){typeof C!="function"&&(C=new Function(""+C));for(var k=new Array(arguments.length-1),P=0;P<k.length;P++)k[P]=arguments[P+1];var A={callback:C,args:k};return m[v]=A,a(v),v++},y.clearImmediate=g}function g(C){delete m[C]}function _(C){if(h)setTimeout(_,0,C);else{var k=m[C];if(k){h=!0;try{(function(P){var A=P.callback,V=P.args;switch(V.length){case 0:A();break;case 1:A(V[0]);break;case 2:A(V[0],V[1]);break;case 3:A(V[0],V[1],V[2]);break;default:A.apply(s,V)}})(k)}finally{g(C),h=!1}}}}function D(C){C.source===l&&typeof C.data=="string"&&C.data.indexOf(p)===0&&_(+C.data.slice(p.length))}})(typeof self>"u"?r===void 0?this:r:self)}).call(this,typeof Di<"u"?Di:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Kh);var H_=Kh.exports;const U_=G_(H_);async function W_(t){return U_.loadAsync(t)}function ke(){return["main"]}async function Y_(t){if(t.file)return t.file;if(t.link)return z_(Yh(decodeURI(t.link)));if(t.id)return qh(Xh(decodeURI(t.id)));if(t.hash&&gr(decodeURI(t.hash).trim()))return V_(decodeURI(t.hash).trim());throw new Error("Could not search for file.")}const je=async t=>{let e=0;try{let n=function(){Ct.status("info",`Loading ${[...p].join(", ")}... [${a}/${u-2}]`,Ai(a/u,15,80))};console.time("loading time"),e=performance.now(),Ei.enable(!1);let i=await Y_(t);Ct.status("info","Extracting zip",0),At.switchHeader(!1);const o=await W_(i),r=o.filter(_=>_.endsWith("Info.dat")||_.endsWith("info.dat")||_.endsWith("Info.json")||_.endsWith("info.json")).map(_=>_.name.split("/")).filter(_=>_.length<=2).sort((_,D)=>_.length-D.length);if(r.length===0)throw new Error("Couldn't find Info.dat");let l=r[0].slice(0,-1).join("/");l&&(Fe.loading.nested=!0,l+="/"),Ei.enable(!1),Ct.status("info","Parsing map info...",10),Z.tInfo(ke(),"Parsing map info");const s=await N_(o,l);at.beatmapInfo=s,K0(s),s.audio.duration&&(at.duration=s.audio.duration,At.setSongDuration(s.audio.duration));let a=0,u=0,c=0;const p=new Set(["map","cover image","contributors image","audio","audio/BPM data"]),v=[new Promise(async _=>{Z.tInfo(ke(),"Loading cover image");const D=o.file(s.coverImageFilename);if(tt.load.imageCover&&D){let C=await D.async("base64");At.setCoverImage("data:image;base64,"+C),Fe.loading.coverImage=!0}else Z.tError(ke(),`${s.coverImageFilename} does not exists.`);a++,p.delete("cover image"),n(),_(null)}),new Promise(async _=>{if(at.contributors=[],s.customData._contributors)for(const D of s.customData._contributors){Z.tInfo(ke(),"Loading contributor image "+D._name);const C=o.file(D._iconPath);let k=null;tt.load.imageContributor&&C?k=await C.async("base64"):Z.tError(ke(),`${D._iconPath} does not exists.`),at.contributors.push({...D,_base64:k})}Ul(at.contributors),a++,p.delete("contributors image"),n(),_(null)}),new Promise(async _=>{Z.tInfo(ke(),"Loading audio");let D=o.file(s.audio.filename);if(tt.load.audio&&D){let C=!1;setTimeout(()=>{!C&&!Fe.loading.finished&&Ct.status("info","Loading audio... (this may take a while)",Ai(a/u,15,80))},1e4);let k=await D.async("arraybuffer");At.setAudio(k),await new AudioContext().decodeAudioData(k).then(A=>{C=!0;let V=A.duration;at.duration=V,At.setSongDuration(V),Fe.loading.audio=!0}).catch(function(A){At.setSongDuration(),Z.tError(ke(),A)})}else at.duration||At.setSongDuration(),Z.tError(ke(),`${s.audio.filename} does not exist.`);a+=2,p.delete("Audio"),n(),_(null)}),new Promise(async _=>{const D=await I_(s,o,l);a++,p.delete("audio/BPM data"),D&&(Fe.loading.audio||(at.duration=D.duration),At.setSongDuration(D.duration),n()),_(D)}),...A_(s,o,l).map(async(_,D,C)=>{const k=await _;return a++,c++,k===null?null:(C.length===c&&p.delete("map"),n(),k)})];u=v.length+2,n();const m=await Promise.allSettled(v);at.beatmaps=m.slice(4).map(_=>_.status==="fulfilled"?_.value:null).filter(_=>_);const h=m[3].status==="fulfilled"?m[3].value:null;let d=Math.min(s.audio.bpm,...((h==null?void 0:h.bpm)??[]).map(_=>_.bpm)),y=Math.max(s.audio.bpm,...((h==null?void 0:h.bpm)??[]).map(_=>_.bpm));at.beatmaps.forEach(_=>{_.rawVersion===4&&(_.timeProcessor.timescale=h.bpm);const D=_.timeProcessor.change.map(k=>k.BPM),C=_.timeProcessor.timescale.map(k=>_.timeProcessor.bpm/k.scale);d=Math.min(d,...D,...C),y=Math.max(y,...D,...C)}),d!==y&&At.setSongBPM(s.audio.bpm,d,y),$n.adjustBeatTime(),Ph.populateSelectCharacteristic(s),Z.tInfo(ke(),"Analysing map"),Ct.status("info","Analysing general...",85),Cn.runGeneral(),$n.displayOutputGeneral(),await rl(5),Ct.status("info","Analysing difficulty...",90),Cn.applyAll(),$n.displayOutputDifficulty(),await rl(5),Ei.enable(!0);let g=performance.now();Ct.status("info",`Completed! (took ${M((g-e)/1e3,2)}s)`)}catch(n){Ct.status("error",n),Z.tError(ke(),n),at.clear(),Ei.enable(!0),At.switchHeader(!0)}finally{console.timeEnd("loading time")}},Ii=document.querySelector(".input__intro-url"),Ni=document.querySelector(".input__intro-id"),Oi=document.querySelector(".input__intro-hash"),X_=document.querySelector(".input__search-button"),q_=document.querySelector(".input__file"),Zh=document.querySelector(".input__file-zone");Ii.addEventListener("keydown",jr);Ni.addEventListener("keydown",jr);Oi.addEventListener("keydown",jr);X_.addEventListener("click",K_);q_.addEventListener("change",Z_);Zh.addEventListener("drop",J_);Zh.addEventListener("dragover",Q_);async function jr(t){const e=t.target;t.key==="Enter"&&e.value!==""&&(e.classList.contains("input__intro-url")&&await je({link:e.value}),e.classList.contains("input__intro-id")&&await je({id:e.value}),e.classList.contains("input__intro-hash")&&await je({hash:e.value}))}async function K_(t){if(Ii&&Ii.value!==""){await je({link:Ii.value});return}if(Ni&&Ni.value!==""){await je({id:Ni.value});return}if(Oi&&Oi.value!==""){await je({hash:Oi.value});return}}async function Z_(t){const e=t.target;Ct.status("info","Reading file input",0);const n=e.files?e.files[0]:null;try{if(n==null)throw Ct.status("info","No file input",0),new Error("No file input");if(n&&(n.name.substr(-4)===".zip"||n.name.substr(-4)===".bsl")){const i=new FileReader;i.readAsArrayBuffer(n),i.addEventListener("load",async()=>{await je({file:n})})}else throw new Error("Unsupported file format, please enter zip file")}catch(i){Ct.status("error",i,0),console.error(i)}}async function J_(t){t.preventDefault(),t.stopPropagation();try{if(t.dataTransfer==null)throw new Error("No file input");if(t.dataTransfer.items){if(!t.dataTransfer.items[0])throw new Error("Failed to retrieve file from drag & drop");if(t.dataTransfer.items[0].kind==="file"){let e=t.dataTransfer.items[0].getAsFile();if(e&&(e.name.substring(e.name.length-4)===".zip"||e.name.substring(e.name.length-4)===".bsl")){const n=new FileReader;n.readAsArrayBuffer(e),n.addEventListener("load",async()=>{await je({file:e})})}else throw new Error("Unsupported file format, please enter zip file")}}}catch(e){Ct.status("error",e,0),console.error(e)}}async function Q_(t){t.preventDefault(),t.stopPropagation()}const ty=document.querySelector("body"),ey=["Dark","Light"],zr={list:ey,set(t){ty.className="theme-"+t.toLowerCase().replace(" ","")}},Vr=document.querySelector(".settings__theme"),Jh=document.querySelector(".settings__beat-numbering"),Qh=document.querySelector(".settings__rounding"),tf=document.querySelector(".settings__info-count"),ef=document.querySelector(".settings__data-check"),nf=document.querySelectorAll(".settings__load"),br=document.querySelector(".settings__sort"),of=document.querySelectorAll(".settings__show"),ny=document.querySelector(".settings__clear-button"),iy=document.querySelector(".settings__checks-persistent");Vr.addEventListener("change",oy);zr.list.forEach(t=>{const e=document.createElement("option");e.value=t,e.textContent=t,Vr.add(e)});Jh.addEventListener("change",ry);Qh.addEventListener("change",sy);tf.addEventListener("change",ay);ef.addEventListener("change",ly);nf.forEach(t=>t.addEventListener("change",py));br.addEventListener("change",hy);of.forEach(t=>t.addEventListener("change",uy));iy.addEventListener("click",cy);ny.addEventListener("click",rf);function oy(t){const e=t.target;tt.theme=e.options[e.options.selectedIndex].value,zr.set(tt.theme),tt.save()}function ry(t){const e=t.target;tt.beatNumbering=e.options[e.options.selectedIndex].value,tt.save()}function sy(t){const e=t.target;tt.rounding=parseInt(e.value),tt.save()}function ay(t){const e=t.target;tt.infoRowCount=parseInt(e.value),Wl(),tt.save()}function ly(t){const e=t.target;tt.dataCheck=e.checked,tt.save()}function uy(t){const n=t.target.id.replace("settings__show-","");tt.show=n,tt.save()}function cy(t){const e=t.target;tt.checks.persistent=e.checked,tt.save()}function my(t){of.forEach(e=>{e.id.endsWith(t)&&(e.checked=!0)})}function hy(t){const e=t.target;tt.sorting=e.checked,tt.save()}function fy(t){br&&(br.checked=t)}function py(t){const e=t.target,n=e.name;tt.load[n]=e.checked,tt.save()}function dy(t,e){nf.forEach(n=>{n.name===t&&(n.checked=e)})}function by(t){Vr.value=t}function gy(t){Jh.value=t}function vy(t){Qh.value=t.toString()}function _y(t){tf.value=t.toString(),Wl()}function yy(t){ef.checked=t}function rf(){tt.clear(),tt.reset(),location.reload()}const Ue={setShowCheck:my,setSortCheck:fy,setLoadCheck:dy,setTheme:by,setBeatNumbering:gy,setRounding:vy,setInfoRow:_y,setDataCheck:yy,clear:rf},Wi="UI Stats: ",Dt="stats__",Ey=document.getElementById("stats__table-nps-overall"),wy=document.getElementById("stats__table-nps-mapped"),Dy=document.getElementById("stats__table-nps-peak-16"),Sy=document.getElementById("stats__table-nps-peak-8"),Cy=document.getElementById("stats__table-nps-peak-4");function ky(t,e){const n=e.timeProcessor,i=at.duration||0,o=n.toRealTime(ti(e.data));Ey.textContent=M(ms(e.data,i),2).toString(),wy.textContent=M(ms(e.data,o),2).toString(),Dy.textContent=M(Bo(e.data,16,n),2).toString(),Sy.textContent=M(Bo(e.data,8,n),2).toString(),Cy.textContent=M(Bo(e.data,4,n),2).toString()}const Ty=document.getElementById("stats__table-settings-version"),Ly=document.getElementById("stats__table-settings-njs"),Ry=document.getElementById("stats__table-settings-sdm"),By=document.getElementById("stats__table-settings-hjd"),xy=document.getElementById("stats__table-settings-jd"),Iy=document.getElementById("stats__table-settings-rt");function Ny(t,e){const n=he.create(t.audio.bpm,e.settings.njs||he.FallbackNJS[e.settings.difficulty],e.settings.njsOffset);Ty.textContent=e.rawData.version||e.rawData._version||"N/A",Ly.textContent=M(n.value,3).toString(),Ry.textContent=M(n.offset,3).toString(),By.textContent=M(n.hjd,3).toString(),xy.textContent=M(n.jd,3).toString(),Iy.textContent=M(n.reactionTime*1e3).toString()+"ms"}const Oy=document.getElementById("stats__table-sps-avg-total"),Ay=document.getElementById("stats__table-sps-avg-red"),Py=document.getElementById("stats__table-sps-avg-blue"),$y=document.getElementById("stats__table-sps-median-total"),My=document.getElementById("stats__table-sps-median-red"),Fy=document.getElementById("stats__table-sps-median-blue"),jy=document.getElementById("stats__table-sps-peak-total"),zy=document.getElementById("stats__table-sps-peak-red"),Vy=document.getElementById("stats__table-sps-peak-blue"),Gy=document.getElementById("stats__table-sps-total-total"),Hy=document.getElementById("stats__table-sps-total-red"),Uy=document.getElementById("stats__table-sps-total-blue");function Wy(t,e){const n=e.swingAnalysis;Oy.innerText=M(n.total.perSecond,2).toString(),Ay.innerText=M(n.red.perSecond,2).toString(),Py.innerText=M(n.blue.perSecond,2).toString(),$y.innerText=M(n.total.median,2).toString(),My.innerText=M(n.red.median,2).toString(),Fy.innerText=M(n.blue.median,2).toString(),jy.innerText=M(n.total.peak,2).toString(),zy.innerText=M(n.red.peak,2).toString(),Vy.innerText=M(n.blue.peak,2).toString(),Gy.innerText=M(n.total.total,2).toString(),Hy.innerText=M(n.red.total,2).toString(),Uy.innerText=M(n.blue.total,2).toString()}const sf=document.getElementById("stats__table-angle-note"),af=document.getElementById("stats__table-angle-arc"),lf=document.getElementById("stats__table-angle-chain"),uf=document.getElementById("stats__table-angle-red"),cf=document.getElementById("stats__table-angle-blue"),Yy=document.getElementById("stats__table-angle");sf.addEventListener("change",li);af.addEventListener("change",li);lf.addEventListener("change",li);uf.addEventListener("change",li);cf.addEventListener("change",li);const dn={note:sf.checked,arc:af.checked,chain:lf.checked,red:uf.checked,blue:cf.checked};function li(t){const e=t.target,n=e.id.split("-").at(-1);dn[n]=e.checked;const i=at.beatmapInfo,o=at.beatmaps.find(r=>r.settings.characteristic===un()&&r.settings.difficulty===cn());if(!o)throw new Error(Wi+"Could not find map data");mf(i,o)}function Xy(t){const e=t.length||1,n=[4,0,5,2,8,3,6,1,7];let i="";for(let o=0;o<3;o++){i+="<tr>";for(let r=0;r<3;r++){let l=M0(t,n[o*3+r]);i+=`<td class="${Dt}table-element">${l}<br>(${M(l/e*100,1)}%)</td>`}i+="</tr>"}return i}function mf(t,e){let n=e.noteContainer;dn.note||(n=n.filter(o=>o.type!==lt.COLOR)),dn.arc||(n=n.filter(o=>o.type!==lt.ARC)),dn.chain||(n=n.filter(o=>o.type!==lt.CHAIN)),dn.bomb||(n=n.filter(o=>o.type!==lt.BOMB)),dn.red||(n=n.filter(o=>o.data.color!==0)),dn.blue||(n=n.filter(o=>o.data.color!==1));let i=Xy(n.map(o=>o.data));Yy.innerHTML=i}const qy=document.getElementById("stats__table-events-content");function Ky(t,e){const n=e.environment,i=e.stats.basicEvents;let o=0,r=0,l=0;for(const a in i)o+=i[a].total;let s=`<tr><th class="${Dt}table-header" colspan="5">Total</th><td class="${Dt}table-element">${o}</td></tr>`;for(const a in i)r+=i[a].chroma,l+=i[a].chromaOld,s+=`<tr><th class="${Dt}table-header">${a}</th><th class="${Dt}table-header" colspan="4">${x0(parseInt(a),n)}</th><td class="${Dt}table-element">${i[a].total}</td></tr>`;r&&(s+=`<tr><th class="${Dt}table-header" colspan="5">Chroma</th><td class="${Dt}table-element">${r}</td></tr>`),l&&(s+=`<tr><th class="${Dt}table-header" colspan="5">OG Chroma</th><td class="${Dt}table-element">${l}</td></tr>`),qy.innerHTML=s}function Zy(...t){for(const e of t)for(const n in e)for(const i of t)i[n]||(i[n]={groups:0,boxes:0,bases:0})}const Jy=document.getElementById("stats__table-ebg-content"),Qy=document.getElementById("stats__table-ebg-group-total"),t1=document.getElementById("stats__table-ebg-box-total"),e1=document.getElementById("stats__table-ebg-base-total"),n1=document.getElementById("stats__table-ebg-group-color"),i1=document.getElementById("stats__table-ebg-box-color"),o1=document.getElementById("stats__table-ebg-base-color"),r1=document.getElementById("stats__table-ebg-group-rotate"),s1=document.getElementById("stats__table-ebg-box-rotate"),a1=document.getElementById("stats__table-ebg-base-rotate"),l1=document.getElementById("stats__table-ebg-group-translate"),u1=document.getElementById("stats__table-ebg-box-translate"),c1=document.getElementById("stats__table-ebg-base-translate"),m1=document.getElementById("stats__table-ebg-group-fx"),h1=document.getElementById("stats__table-ebg-box-fx"),f1=document.getElementById("stats__table-ebg-base-fx");function p1(t,e){const n=e.environment,i=e.stats.lightColorEventBoxGroups,o=e.stats.lightRotationEventBoxGroups,r=e.stats.lightTranslationEventBoxGroups,l=e.stats.fxEventBoxGroups;Zy(i,o,r,l),Qy.textContent=(Object.values(i).reduce((a,{groups:u})=>a+u,0)+Object.values(o).reduce((a,{groups:u})=>a+u,0)+Object.values(r).reduce((a,{groups:u})=>a+u,0)+Object.values(l).reduce((a,{groups:u})=>a+u,0)).toString(),t1.textContent=(Object.values(i).reduce((a,{boxes:u})=>a+u,0)+Object.values(o).reduce((a,{boxes:u})=>a+u,0)+Object.values(r).reduce((a,{boxes:u})=>a+u,0)+Object.values(l).reduce((a,{boxes:u})=>a+u,0)).toString(),e1.textContent=(Object.values(i).reduce((a,{bases:u})=>a+u,0)+Object.values(o).reduce((a,{bases:u})=>a+u,0)+Object.values(r).reduce((a,{bases:u})=>a+u,0)+Object.values(l).reduce((a,{bases:u})=>a+u,0)).toString(),n1.textContent=Object.values(i).reduce((a,{groups:u})=>a+u,0).toString(),i1.textContent=Object.values(i).reduce((a,{boxes:u})=>a+u,0).toString(),o1.textContent=Object.values(i).reduce((a,{bases:u})=>a+u,0).toString(),r1.textContent=Object.values(o).reduce((a,{groups:u})=>a+u,0).toString(),s1.textContent=Object.values(o).reduce((a,{boxes:u})=>a+u,0).toString(),a1.textContent=Object.values(o).reduce((a,{bases:u})=>a+u,0).toString(),l1.textContent=Object.values(r).reduce((a,{groups:u})=>a+u,0).toString(),u1.textContent=Object.values(r).reduce((a,{boxes:u})=>a+u,0).toString(),c1.textContent=Object.values(r).reduce((a,{bases:u})=>a+u,0).toString(),m1.textContent=Object.values(l).reduce((a,{groups:u})=>a+u,0).toString(),h1.textContent=Object.values(l).reduce((a,{boxes:u})=>a+u,0).toString(),f1.textContent=Object.values(l).reduce((a,{bases:u})=>a+u,0).toString();let s="";for(const a in i)s+=`<tr><th class="${Dt}table-header">${a}</th><th class="${Dt}table-header" colspan="5">${N0(parseInt(a),n)}</th><td class="${Dt}table-element" title="${i[a].groups} Box (${i[a].bases} Base)">${i[a].groups}</td><td class="${Dt}table-element" title="${o[a].boxes} Box (${o[a].bases} Base)">${o[a].groups}</td><td class="${Dt}table-element" title="${r[a].boxes} Box (${r[a].bases} Base)">${r[a].groups}</td><td class="${Dt}table-element" title="${l[a].groups} Box (${l[a].bases} Base)">${l[a].groups}</td></tr>`;Jy.innerHTML=s}const d1=document.getElementById("stats__table-ni-ratio"),b1=document.getElementById("stats__table-ni-maxscore"),g1=document.getElementById("stats__table-ni-ebpm"),v1=document.getElementById("stats__table-ni-ebpm-swing"),Po=document.getElementById("stats__table-ni-minspeed"),$o=document.getElementById("stats__table-ni-maxspeed");function _1(t,e){const n=e.stats.notes;d1.textContent=M(n.red.total/n.blue.total,2).toString(),b1.textContent=_f(e.score),g1.textContent=M(j0(e.swingAnalysis.container),2).toString(),v1.textContent=M(z0(e.swingAnalysis.container),2).toString();const i=M(X0(e.swingAnalysis.container)*1e3,1),o=M(q0(e.swingAnalysis.container)*1e3,1);i||o?(Po.textContent=i.toString()+"ms",$o.textContent=i.toString()+"ms",Po.parentNode.classList.remove("hidden"),$o.parentNode.classList.remove("hidden")):(Po.parentNode.classList.add("hidden"),$o.parentNode.classList.add("hidden"))}const y1=document.getElementById("stats__table-nc-total"),E1=document.getElementById("stats__table-nc-arc"),w1=document.getElementById("stats__table-nc-chain"),D1=document.getElementById("stats__table-nc-bomb"),S1=document.getElementById("stats__table-nc-red"),C1=document.getElementById("stats__table-nc-arc-red"),k1=document.getElementById("stats__table-nc-chain-red");document.getElementById("stats__table-nc-bomb-red");const T1=document.getElementById("stats__table-nc-blue"),L1=document.getElementById("stats__table-nc-arc-blue"),R1=document.getElementById("stats__table-nc-chain-blue");document.getElementById("stats__table-nc-bomb-blue");const Mo=document.getElementById("stats__table-nc-chroma"),Fo=document.getElementById("stats__table-nc-arc-chroma"),jo=document.getElementById("stats__table-nc-chain-chroma"),zo=document.getElementById("stats__table-nc-bomb-chroma"),Vo=document.getElementById("stats__table-nc-noodle"),Go=document.getElementById("stats__table-nc-arc-noodle"),Ho=document.getElementById("stats__table-nc-chain-noodle"),Uo=document.getElementById("stats__table-nc-bomb-noodle"),Wo=document.getElementById("stats__table-nc-me"),Yo=document.getElementById("stats__table-nc-arc-me"),Xo=document.getElementById("stats__table-nc-chain-me"),qo=document.getElementById("stats__table-nc-bomb-me");function B1(t,e){const n=e.stats.notes,i=e.stats.arcs,o=e.stats.chains,r=e.stats.bombs;y1.textContent=(n.red.total+n.blue.total).toString(),E1.textContent=(i.red.total+i.blue.total).toString(),w1.textContent=(o.red.total+o.blue.total).toString(),D1.textContent=r.total.toString(),S1.textContent=n.red.total.toString(),C1.textContent=i.red.total.toString(),k1.textContent=o.red.total.toString(),T1.textContent=n.blue.total.toString(),L1.textContent=i.blue.total.toString(),R1.textContent=o.blue.total.toString(),n.red.chroma||n.blue.chroma||i.red.chroma||i.blue.chroma||o.red.chroma||o.blue.chroma||r.chroma?(Mo.textContent=(n.red.chroma+n.blue.chroma).toString(),Fo.textContent=(i.red.chroma+i.blue.chroma).toString(),jo.textContent=(o.red.chroma+o.blue.chroma).toString(),zo.textContent=r.chroma.toString(),Mo.parentNode.classList.remove("hidden"),Fo.parentNode.classList.remove("hidden"),jo.parentNode.classList.remove("hidden"),zo.parentNode.classList.remove("hidden")):(Mo.parentNode.classList.add("hidden"),Fo.parentNode.classList.add("hidden"),jo.parentNode.classList.add("hidden"),zo.parentNode.classList.add("hidden")),n.red.noodleExtensions||n.blue.noodleExtensions||i.red.noodleExtensions||i.blue.noodleExtensions||o.red.noodleExtensions||o.blue.noodleExtensions||r.noodleExtensions?(Vo.textContent=(n.red.noodleExtensions+n.blue.noodleExtensions).toString(),Go.textContent=(i.red.noodleExtensions+i.blue.noodleExtensions).toString(),Ho.textContent=(o.red.noodleExtensions+o.blue.noodleExtensions).toString(),Uo.textContent=r.noodleExtensions.toString(),Vo.parentNode.classList.remove("hidden"),Go.parentNode.classList.remove("hidden"),Ho.parentNode.classList.remove("hidden"),Uo.parentNode.classList.remove("hidden")):(Vo.parentNode.classList.add("hidden"),Go.parentNode.classList.add("hidden"),Ho.parentNode.classList.add("hidden"),Uo.parentNode.classList.add("hidden")),n.red.mappingExtensions||n.blue.mappingExtensions||i.red.mappingExtensions||i.blue.mappingExtensions||o.red.mappingExtensions||o.blue.mappingExtensions||r.mappingExtensions?(Wo.textContent=(n.red.mappingExtensions+n.blue.mappingExtensions).toString(),Yo.textContent=(i.red.mappingExtensions+i.blue.mappingExtensions).toString(),Xo.textContent=(o.red.mappingExtensions+o.blue.mappingExtensions).toString(),qo.textContent=r.mappingExtensions.toString(),Wo.parentNode.classList.remove("hidden"),Yo.parentNode.classList.remove("hidden"),Xo.parentNode.classList.remove("hidden"),qo.parentNode.classList.remove("hidden")):(Wo.parentNode.classList.add("hidden"),Yo.parentNode.classList.add("hidden"),Xo.parentNode.classList.add("hidden"),qo.parentNode.classList.add("hidden"))}const hf=document.getElementById("stats__table-placement-note"),ff=document.getElementById("stats__table-placement-arc"),pf=document.getElementById("stats__table-placement-chain"),df=document.getElementById("stats__table-placement-bomb"),bf=document.getElementById("stats__table-placement-red"),gf=document.getElementById("stats__table-placement-blue"),x1=document.getElementById("stats__table-placement");hf.addEventListener("change",Hn);ff.addEventListener("change",Hn);pf.addEventListener("change",Hn);df.addEventListener("change",Hn);bf.addEventListener("change",Hn);gf.addEventListener("change",Hn);const bn={note:hf.checked,arc:ff.checked,chain:pf.checked,bomb:df.checked,red:bf.checked,blue:gf.checked};function Hn(t){const e=t.target,n=e.id.split("-").at(-1);bn[n]=e.checked;const i=at.beatmapInfo,o=at.beatmaps.find(r=>r.settings.characteristic===un()&&r.settings.difficulty===cn());if(!o)throw new Error(Wi+"Could not find map data");vf(i,o)}function I1(t){const e=t.length||1;let n="";for(let i=2;i>=0;i--){n+="<tr>";for(let o=0;o<=3;o++)n+=`<td class="${Dt}table-element">${$0(t,o,i)}</td>`;n+=`<td class="${Dt}table-element ${Dt}table--no-border">${M(P0(t,i)/e*100,1)}%</td>
        </tr>`}return n+=`<tr><td class="${Dt}table-element ${Dt}table--no-border">${M(yi(t,0)/e*100,1)}%</td><td class="${Dt}table-element ${Dt}table--no-border">${M(yi(t,1)/e*100,1)}%</td><td class="${Dt}table-element ${Dt}table--no-border">${M(yi(t,2)/e*100,1)}%</td><td class="${Dt}table-element ${Dt}table--no-border">${M(yi(t,3)/e*100,1)}%</td></tr>`,n}function vf(t,e){let n=e.noteContainer;bn.note||(n=n.filter(o=>o.type!==lt.COLOR)),bn.arc||(n=n.filter(o=>o.type!==lt.ARC)),bn.chain||(n=n.filter(o=>o.type!==lt.CHAIN)),bn.bomb||(n=n.filter(o=>o.type!==lt.BOMB)),bn.red||(n=n.filter(o=>o.data.color!==0)),bn.blue||(n=n.filter(o=>o.data.color!==1));let i=I1(n.map(o=>o.data));x1.innerHTML=i}const N1=document.getElementById("stats__table-obstacles-total"),O1=document.getElementById("stats__table-obstacles-interactive"),Ko=document.getElementById("stats__table-obstacles-chroma"),Zo=document.getElementById("stats__table-obstacles-noodle"),Jo=document.getElementById("stats__table-obstacles-me");function A1(t,e){const n=e.stats.obstacles;N1.textContent=n.total.toString(),O1.textContent=n.interactive.toString(),n.chroma?(Ko.textContent=n.chroma.toString(),Ko.parentNode.classList.remove("hidden")):Ko.parentNode.classList.add("hidden"),n.noodleExtensions?(Zo.textContent=n.noodleExtensions.toString(),Zo.parentNode.classList.remove("hidden")):Zo.parentNode.classList.add("hidden"),n.mappingExtensions?(Jo.textContent=n.mappingExtensions.toString(),Jo.parentNode.classList.remove("hidden")):Jo.parentNode.classList.add("hidden")}function P1(t,e){if(!at.beatmapInfo)throw new Error(Wi+"map info could not be found in loadedData");const n=at.beatmapInfo,i=at.beatmaps.find(o=>o.settings.characteristic===t&&o.settings.difficulty===e);if(!i)throw new Error(Wi+"Could not find map data");Ny(n,i),ky(n,i),Wy(n,i),_1(n,i),B1(n,i),vf(n,i),mf(n,i),Ky(n,i),p1(n,i),A1(n,i)}Do.push(P1);const $1=document.querySelectorAll(".input__reset-button");$1.forEach(t=>t.addEventListener("click",M1));function M1(){Ct.reset(),At.reset(),Z0(),$n.reset(),Ph.reset(),at.clear()}const F1="2.7.0",j1="Kival Evan",sl=new class{constructor(){this._version=F1+"-beta-d",this._wm=j1}get value(){return this._version}get watermark(){return this._wm}},z1=document.querySelectorAll(".link__watermark"),V1=document.querySelectorAll(".link__version");function al(){const t=new Date;return t.getMonth()==5&&t.getDate()==10}const ll={setWatermark:t=>{z1.forEach(e=>{e.textContent=(al()?"Happy Birthday, ":"")+t,al()&&(e.title=`Happy ${new Date().getFullYear()-new Date("1999-06-10").getFullYear()} Birthday, 10th June`)})},setVersion:t=>{V1.forEach(e=>e.textContent=t)}},G1=function(){let t=!1;return function(){if(!t){t=!0,ll.setWatermark(sl.watermark),ll.setVersion(sl.value),$n.populateTool(),Ue.setTheme(tt.theme),Ue.setBeatNumbering(tt.beatNumbering),Ue.setRounding(tt.rounding),Ue.setInfoRow(tt.infoRowCount),Ue.setDataCheck(tt.dataCheck);for(const e in tt.load)Ue.setLoadCheck(e,tt.load[e]);Ue.setSortCheck(tt.sorting),Qv(tt.show),Ue.setShowCheck(tt.show),zr.set(tt.theme),$n.init(),Z.tInfo(["init"],"User interface initialised")}}}();(async function(){Z.tagPrint=(o,r)=>`[${o.join("::")}]`,G1();const t=new URL(location.href),e=t.searchParams.get("url"),n=t.searchParams.get("id"),i=t.searchParams.get("hash");(n||e||i)&&await je({link:e,id:n,hash:i})})();
