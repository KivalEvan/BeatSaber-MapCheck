var au=Object.defineProperty;var ru=(i,t,e)=>t in i?au(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var O=(i,t,e)=>(ru(i,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function e(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerpolicy&&(o.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?o.credentials="include":a.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=e(a);fetch(a.href,o)}})();var Oo=(i=>(i.none="",i.ExpertPlus="accordion__label--bg-expertplus",i.Expert="accordion__label--bg-expert",i.Hard="accordion__label--bg-hard",i.Normal="accordion__label--bg-normal",i.Easy="accordion__label--bg-easy",i))(Oo||{});const su="UI Accordion: ",wn="accordion__",Mo=document.querySelectorAll(".accordion__button");Mo.length||console.error(su+"empty accordion list, intentional or typo error?");const Po={create:(i,t,e,n=!1)=>{const a=document.createElement("div");a.className="accordion";const o=document.createElement("input");o.className=wn+"button",o.id=i,o.setAttribute("type","checkbox");const r=document.createElement("label");r.className=wn+"label unselectable",r.htmlFor=i,r.textContent=t,e&&r.classList.add(Oo[e]);const s=document.createElement("div");return s.className=n?wn+"collapsible-flex":wn+"collapsible",s.id=i+"-content",a.appendChild(o),a.appendChild(r),a.appendChild(s),a},show:(i,t)=>{Mo.forEach(e=>{e.id.endsWith(i)&&(e.checked=t)})}},zr=new Map([[0,"VERBOSE"],[1,"DEBUG"],[2,"INFO"],[3,"WARN"],[4,"!!ERROR!!"],[5,"NONE"]]);class ou{constructor(){O(this,"logLevel",2)}log(t,...e){if(t<this.logLevel)return;const n=[zr.get(t),">",...e];switch(t){case 1:return console.debug(...n);case 2:return console.info(...n);case 3:return console.warn(...n);case 4:return console.error(...n);default:return console.log(...n)}}setLevel(t){t=Math.min(t,5),this.logLevel=t,this.info("[logger::setLevel]",`Log level set to ${zr.get(t)}`)}verbose(...t){this.log(0,...t)}debug(...t){this.log(1,...t)}info(...t){this.log(2,...t)}warn(...t){this.log(3,...t)}error(...t){this.log(4,...t)}}const rt=new ou;function lu(i){return i.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function A(i,t=0){return Math.round(i*Math.pow(10,t))/Math.pow(10,t)}function La(i){return i*(180/Math.PI)}function Ci(i){return i*(Math.PI/180)}function Xr(i,t){t<0&&(t=-t);const e=i%t;return e<0?e+t:e}function Ur(i,t,e){return Math.min(Xr(i-t,e),Xr(t-i,e))}function Da(i){if(i.length===0)return 0;i.sort((e,n)=>e-n);const t=Math.floor(i.length/2);return i.length%2?i[t]:(i[t-1]+i[t])/2}function jr(i,t,e){return Math.min(Math.max(t,i),e)}function vt(i){if(typeof i!="object")throw new Error("Received non-object type");return JSON.parse(JSON.stringify(i))}function Fo(i){return/[a-fA-F0-9]*/g.test(i)}function Wn(i){const t=[i.r,i.g,i.b];return typeof i.a=="number"&&t.push(i.a),t}function Sn(i){const t=i.toString(16);return t.length===1?"0"+t:t}function cu(i){return i>1&&!(i<0)?255:A(i*255)}function $t(i){const t={r:0,g:0,b:0};for(const e in i){const n=i[e];n!==void 0&&(t[e]=cu(n))}return`#${Sn(t.r)}${Sn(t.g)}${Sn(t.b)}${typeof t.a=="number"?Sn(t.a):""}`}function Yr(i){let t=i[0],e=i[1],n=i[2],a,o,r;return t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92,a=(t*.4124+e*.3576+n*.1805)/.95047,o=(t*.2126+e*.7152+n*.0722)/1,r=(t*.0193+e*.1192+n*.9505)/1.08883,a=a>.008856?Math.pow(a,1/3):7.787*a+16/116,o=o>.008856?Math.pow(o,1/3):7.787*o+16/116,r=r>.008856?Math.pow(r,1/3):7.787*r+16/116,[116*o-16,500*(a-o),200*(o-r)]}function Gr(i,t){let e=0;return i>=0&&t===0?0:i<0&&t===0?180:i===0&&t>0?90:i===0&&t<0?270:(i>0&&t>0&&(e=0),i<0&&(e=180),i>0&&t<0&&(e=360),La(Math.atan(t/i))+e)}function Ca(i,t){const[e,n,a]=Yr(i),[o,r,s]=Yr(t),l=1,c=1,u=1;let d,m,h,p,g,b,y,v,S,L,C,F,M,j,B,G,tt,w,$,_;return d=Math.sqrt(n*n+a*a),m=Math.sqrt(r*r+s*s),h=(d+m)/2,g=.5*(1-Math.sqrt((h^7)/((h^7)+30))),S=(1+g)*n,d=Math.sqrt(S*S+a*a),b=Gr(S,a),S=(1+g)*r,m=Math.sqrt(S*S+s*s),y=Gr(S,s),w=o-e,$=m-d,d*m==0?_=0:(S=A(y-b,12),Math.abs(S)<=180?_=y-b:S>180?_=y-b-360:_=y-b+360),_=2*Math.sqrt(d*m)*Math.sin(Ci(_/2)),L=(e+o)/2,p=(d+m)/2,d*m==0?v=b+y:(S=Math.abs(A(b-y,12)),S>180?y+b<360?v=b+y+360:v=b+y-360:v=b+y,v/=2),C=1-.17*Math.cos(Ci(v-30))+.24*Math.cos(Ci(2*v))+.32*Math.cos(Ci(3*v+6))-.2*Math.cos(Ci(4*v-63)),B=30*Math.exp(-((v-275)/25)*((v-275)/25)),G=2*Math.sqrt((p^7)/((p^7)+30)),F=1+.015*((L-50)*(L-50))/Math.sqrt(20+(L-50)*(L-50)),M=1+.045*p,j=1+.015*p*C,tt=-Math.sin(Ci(2*B))*G,w=w/(l*F),$=$/(c*M),_=_/(u*j),Math.sqrt(w*w+$*$+_*_+tt*$*_)}function kt(i){if(!i)return"0:00";const t=Math.floor(i),e=t/60,n=e<0?`-${Math.ceil(e).toString()}`:Math.floor(e).toString(),a=Math.abs(t%60).toString().padStart(2,"0");return`${n}:${a}`}function uu(i){if(!i)return"0:00:00";const t=Math.round(i*60%60).toString().padStart(2,"0");return`${kt(i)}:${t}`}function Nn(i){var e;if(!i)return"0:00.000";const t=((e=(i%1).toString().split(".")[1])==null?void 0:e.padEnd(3,"0").slice(0,3))||"000";return`${kt(i)}.${t}`}function Ho(i){const t=/^(http|ftp|https):\/\/([\w_-]+(?:(?:\.[\w_-]+)+))([\w.,@?^=%&:/~+#-]*[\w@?^=%&/~+#-])?/;if(i=i.trim(),/^http:\/\//.test(i)&&(i=i.replace("http://","https://")),t.test(i))return i;throw new Error("Invalid URL")}function zo(i){const t=/^[0-9a-fA-F]{1,6}$/;if(i=i.trim(),/^!bsr /.test(i)&&(i=i.replace("!bsr ","")),t.test(i))return i;throw new Error("Invalid ID")}function ka(i){for(let t=i.options.length-1;t>=0;t--)i.remove(t)}const er="UI Header: ",Ra=document.querySelector(".intro"),xa=document.querySelector(".metadata"),di=document.querySelector(".cover__link"),ir=document.querySelector(".cover__image"),Xo=document.querySelector(".metadata__song-name"),Uo=document.querySelector(".metadata__song-subname"),jo=document.querySelector(".metadata__song-author"),Yo=document.querySelector(".metadata__song-bpm"),Na=document.querySelector(".metadata__song-duration"),Go=document.querySelector(".audio");if(!Ra||!xa)throw new Error(er+"header component is missing one of the two section");if(!di||!ir)throw new Error(er+"cover component is missing");if(!Xo||!Uo||!jo||!Yo||!Na)throw new Error(er+"metadata component is missing one of the part");function Wo(i){i?(Ra.classList.remove("hidden"),xa.classList.add("hidden")):(Ra.classList.add("hidden"),xa.classList.remove("hidden"))}function Vo(i){ir.src=i||"./img/unknown.jpg"}function hu(){return ir.src}function Jo(i,t){if(i==null&&t==null){di.textContent="",di.href="",di.classList.add("disabled");return}i!=null&&(di.textContent=t!=null?t:"Download Link",di.href=i,di.classList.remove("disabled"))}function du(i){Xo.textContent=i}function fu(i){Uo.textContent=i}function mu(i){jo.textContent=i}function pu(i,t,e){t==null&&typeof e=="number"&&(t=Math.min(i,e)),e==null&&typeof t=="number"&&(e=Math.max(i,t));let n=A(i,2).toString()+"BPM";t&&e&&(n+=` (${A(t,2)}-${A(e,2)})`),Yo.textContent=n}function qo(i){i?Na.textContent=Nn(i):Na.textContent="No audio"}async function gu(i){const t=new Blob([i],{type:"audio/ogg"});Go.src=window.URL.createObjectURL(t)}function Zo(){Go.src="",window.URL.revokeObjectURL("")}function _u(){Wo(!0),Vo(null),Jo(),qo(0),Zo()}const Xt={switchHeader:Wo,setCoverImage:Vo,getCoverImage:hu,setCoverLink:Jo,setSongName:du,setSongSubname:fu,setSongAuthor:mu,setSongBPM:pu,setSongDuration:qo,setAudio:gu,unloadAudio:Zo,reset:_u},zi=new class{constructor(){O(this,"loading",{info:!1,difficulty:!1,analysis:!1,audio:!1,coverImage:!1,contributorImage:!1,finished:!1})}resetLoad(){this.loading.info=!1,this.loading.difficulty=!1,this.loading.analysis=!1,this.loading.audio=!1,this.loading.coverImage=!1,this.loading.contributorImage=!1,this.loading.finished=!1}},lt=new class{constructor(){O(this,"beatmapInfo",null);O(this,"beatmapDifficulty",[]);O(this,"contributors",[]);O(this,"analysis",null);O(this,"duration",null)}retrieveSafe(){if(!this.beatmapInfo)throw new Error("Beatmap info is not loaded.");if(!this.analysis)throw new Error("Beatmap analysis is not loaded.");if(this.duration===null)throw new Error("Audio is not loaded.");if(zi.loading.finished)return{beatmapInfo:this.beatmapInfo,beatmapDifficulty:this.beatmapDifficulty,contributors:this.contributors,analysis:this.analysis,duration:this.duration};throw new Error("Could not retrieve saved data, loading process is not finished.")}clear(){zi.loading.finished=!1,this.beatmapInfo=null,this.beatmapDifficulty=[],this.contributors=[],this.analysis=null,this.duration=null}},Or=class{constructor(t,e=[],n=0){O(this,"_bpm");O(this,"_bpmChange");O(this,"_timeScale");O(this,"_offset");this._bpm=t,this._offset=n/1e3,this._timeScale=this.getTimeScale(e.filter(a=>{if(a.m===0)throw new Error("v3 BPM Change of value 0 detected.");return a.m!=null&&a.o==null})),this._bpmChange=this.getBPMChangeTime(e.filter(a=>a._time!=null||a.o!=null))}get value(){return this._bpm}set value(t){this._bpm=t}get change(){return this._bpmChange}set change(t){this._bpmChange=t}set timescale(t){this._timeScale=this.getTimeScale(t)}get offset(){return this._offset*1e3}set offset(t){this._offset=t/1e3}getBPMChangeTime(t=[]){var a,o,r,s,l;let e;const n=[];for(let c=0;c<t.length;c++){const u={time:(a=t[c]._time)!=null?a:t[c].b,BPM:(r=(o=t[c]._BPM)!=null?o:t[c]._bpm)!=null?r:t[c].m,beatsPerBar:(s=t[c]._beatsPerBar)!=null?s:t[c].p,metronomeOffset:(l=t[c]._metronomeOffset)!=null?l:t[c].o,newTime:0};e?u.newTime=Math.ceil((u.time-e.time)/this._bpm*e.BPM+e.newTime-.01):u.newTime=Math.ceil(u.time-this._offset*this._bpm/60-.01),n.push(u),e=u}return n}getTimeScale(t=[]){return t.map(e=>({time:e.b,scale:this._bpm/e.m}))}offsetBegone(t){return this.toBeatTime(this.toRealTime(t,!1)-this._offset)}toRealTime(t,e=!0){if(!e)return t/this._bpm*60;let n=0;for(let a=this._timeScale.length-1;a>=0;a--)t>this._timeScale[a].time&&(n+=(t-this._timeScale[a].time)*this._timeScale[a].scale,t=this._timeScale[a].time);return(t+n)/this._bpm*60}toBeatTime(t,e=!1){if(!e)return t*this._bpm/60;let n=0;for(let a=this._timeScale.length-1;a>=0;a--){const o=this.toRealTime(this._timeScale[a].time);t>o&&(n+=(t-o)/this._timeScale[a].scale,t=o)}return this.toBeatTime(t+n)}toJSONTime(t){for(let e=this._bpmChange.length-1;e>=0;e--)if(t>this._bpmChange[e].newTime)return(t-this._bpmChange[e].newTime)/this._bpmChange[e].BPM*this._bpm+this._bpmChange[e].time;return this.toBeatTime(this.toRealTime(t,!1)+this._offset)}adjustTime(t){for(let e=this._bpmChange.length-1;e>=0;e--)if(t>this._bpmChange[e].time)return(t-this._bpmChange[e].time)/this._bpm*this._bpmChange[e].BPM+this._bpmChange[e].newTime;return this.offsetBegone(t)}};let be=Or;O(be,"create",(t,e,n)=>new Or(t,e,n));const bu={DefaultEnvironment:"The First",OriginsEnvironment:"Origins",TriangleEnvironment:"Triangle",NiceEnvironment:"Nice",BigMirrorEnvironment:"Big Mirror",DragonsEnvironment:"Dragons",KDAEnvironment:"K/DA",MonstercatEnvironment:"Monstercat",CrabRaveEnvironment:"Crab Rave",PanicEnvironment:"Panic",RocketEnvironment:"Rocket",GreenDayEnvironment:"Green Day",GreenDayGrenadeEnvironment:"Green Day Grenade",TimbalandEnvironment:"Timbaland",FitBeatEnvironment:"FitBeat",LinkinParkEnvironment:"Linkin Park",BTSEnvironment:"BTS",KaleidoscopeEnvironment:"Kaleidoscope",InterscopeEnvironment:"Interscope",SkrillexEnvironment:"Skrillex",BillieEnvironment:"Billie",HalloweenEnvironment:"Spooky",GagaEnvironment:"Gaga",WeaveEnvironment:"Weave",PyroEnvironment:"Pyro",EDMEnvironment:"EDM",TheSecondEnvironment:"The Second",LizzoEnvironment:"Lizzo",TheWeekndEnvironment:"The Weeknd",GlassDesertEnvironment:"Glass Desert"},Ie={DefaultEnvironment:[[0,1,2,3,4,8,9,12,13],[]],OriginsEnvironment:[[0,1,2,3,4,8,9,12,13],[]],TriangleEnvironment:[[0,1,2,3,4,8,9,12,13],[]],NiceEnvironment:[[0,1,2,3,4,8,9,12,13],[]],BigMirrorEnvironment:[[0,1,2,3,4,8,9,12,13],[]],DragonsEnvironment:[[0,1,2,3,4,8,9,12,13],[]],KDAEnvironment:[[0,1,2,3,4,8,9,12,13],[]],MonstercatEnvironment:[[0,1,2,3,4,8,9,12,13],[]],CrabRaveEnvironment:[[0,1,2,3,4,8,9,12,13],[]],PanicEnvironment:[[0,1,2,3,4,8,9,12,13],[]],RocketEnvironment:[[0,1,2,3,4,8,9,12,13],[]],GreenDayEnvironment:[[0,1,2,3,4,8,9,12,13],[]],GreenDayGrenadeEnvironment:[[0,1,2,3,4,8,9,12,13],[]],TimbalandEnvironment:[[0,1,2,3,4,8,9,12,13],[]],FitBeatEnvironment:[[0,1,2,3,4,8,9,12,13],[]],LinkinParkEnvironment:[[0,1,2,3,4,8,9,12,13],[]],BTSEnvironment:[[0,1,2,3,4,8,9,12,13],[]],KaleidoscopeEnvironment:[[0,1,2,3,4,8,9,12,13],[]],InterscopeEnvironment:[[0,1,2,3,4,6,7,8,9,12,13,16,17],[]],SkrillexEnvironment:[[0,1,2,3,4,6,7,8,9,12,13],[]],BillieEnvironment:[[0,1,2,3,4,6,7,8,9,10,11,12,13],[]],HalloweenEnvironment:[[0,1,2,3,4,8,9,12,13],[]],GagaEnvironment:[[0,1,2,3,4,6,7,8,9,10,11,12,13,16,17],[]],GlassDesertEnvironment:[[0,1,2,3,4,8,9,12,13],[]],WeaveEnvironment:[[],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]],PyroEnvironment:[[0,1,2,3,4,6],[0,1,2,3,4,5,6,7,8,9,10,11,12,13]],EDMEnvironment:[[0,1,4],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]],TheSecondEnvironment:[[0,1,2,3,4,9],[0,1,2,3,4,5,6,7,8,9,10,11,12,13]],LizzoEnvironment:[[0,1,2,3,4,6,7,8,9,10,11,12,16,17],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]],TheWeekndEnvironment:[[0,1,6],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,29,30,31,32,33,34,35,36,38,39,40]]},_a="UI Info: ",Ia=document.querySelector(".info__version"),Aa=document.querySelector(".info__play-time"),Ba=document.querySelector(".info__time-spend"),$a=document.querySelector(".info__custom-color"),Oa=document.querySelector(".info__requirements"),Ma=document.querySelector(".info__suggestions"),Pa=document.querySelector(".info__information"),Fa=document.querySelector(".info__warnings"),Ha=document.querySelector(".info__bookmarks"),za=document.querySelector(".info__bpm-changes"),Xa=document.querySelector(".info__environment-enhancement"),Ua=document.querySelector(".info__point-definitions"),ja=document.querySelector(".info__custom-events"),Ko=document.querySelectorAll(".info__table-element");if(!Ia||!Aa||!Ba||!$a||!Oa||!Ma||!Pa||!Fa||!Ha||!za||!Xa||!Ua||!ja||!Ko)throw new Error(_a+"table info component is missing part");const Ya=document.querySelector(".info__level-author"),Ga=document.querySelector(".info__environment"),In=document.querySelector(".info__editors"),An=document.querySelector(".info__contributors"),Vn=document.querySelector(".info__contributors-select"),yu=document.querySelector(".info__contributors-image"),Qo=document.querySelector(".info__contributors-name"),tl=document.querySelector(".info__contributors-role");if(!Ya||!Ga||!In)throw new Error(_a+"info component is missing part");if(!An||!Qo||!tl)throw new Error(_a+"contributors component is missing part");if(Vn)Vn.addEventListener("change",wu);else throw new Error(_a+"contributors select is missing");function el(i){if(!i){Ya.textContent="";return}Ya.textContent="Mapped by "+i}function il(i){if(!i){Ga.textContent="";return}Ga.textContent=(bu[i]||"Unknown")+" Environment"}function nl(i){if(!i||!i._lastEditedBy){In.classList.add("hidden");return}In.classList.remove("hidden");const t=i._lastEditedBy||"Undefined";let e="Last edited on "+t;if(i[t]){const n=i[t];e+=" v"+n.version}In.textContent=e}function vu(i){yu.src=i||"./img/unknown.jpg"}function Eu(i){Qo.textContent=i}function Du(i){tl.textContent=i}function al(i){vu(i._base64?"data:image;base64,"+i._base64:null),Eu(i._name),Du(i._role)}function rl(i){if(An&&(!i||!i.length)){An.classList.add("hidden"),ka(Vn);return}if(i){An.classList.remove("hidden");let t=!0;i.forEach((e,n)=>{t&&(t=!1,al(e));const a=document.createElement("option");a.value=n.toString(),a.text=e._name+" -- "+e._role,Vn.add(a)})}}function wu(i){const t=i.target;al(lt.contributors[parseInt(t.value)])}const an={version:3,load:{audio:!0,imageCover:!0,imageContributor:!0},sorting:!0,beatNumbering:"beattime",infoRowHeight:4,rounding:3,dataCheck:!0,dataError:!0,theme:"Dark",onLoad:{stats:!1},show:{info:!1,tools:!1,stats:!1,settings:!1}},et=new class{constructor(){O(this,"property",vt(an));O(this,"stringify",()=>JSON.stringify({settings:this.property}));O(this,"init",()=>{var e,n;if(localStorage==null)return;const t=localStorage.getItem("settings");if(t){const a=JSON.parse(t);if(!((e=a.settings)!=null&&e.version)){this.clear();return}this.property=(n=a.settings)!=null?n:this.property;for(const o in an)typeof this.property[o]>"u"&&(this.property[o]=an[o]);this.property.version=an.version,this.save()}});O(this,"save",()=>{localStorage&&localStorage.setItem("settings",this.stringify())});O(this,"clear",()=>{localStorage&&localStorage.clear()});O(this,"reset",()=>{this.property=vt(an)});this.init()}get version(){return this.property.version}get load(){return this.property.load}get sorting(){return this.property.sorting}set sorting(t){this.property.sorting=t}get beatNumbering(){return this.property.beatNumbering}set beatNumbering(t){this.property.beatNumbering=t}get infoRowHeight(){return this.property.infoRowHeight}set infoRowHeight(t){this.property.infoRowHeight=t}get rounding(){return this.property.rounding}set rounding(t){this.property.rounding=t}get dataCheck(){return this.property.dataCheck}set dataCheck(t){this.property.dataCheck=t}get dataError(){return this.property.dataError}set dataError(t){this.property.dataError=t}get theme(){return this.property.theme}set theme(t){this.property.theme=t}get onLoad(){return this.property.onLoad}get show(){return this.property.show}};var sl=(i=>(i.tiny="panel--tiny",i.small="panel--small",i.medium="panel--medium",i.large="panel--large",i.max="panel--max",i))(sl||{}),ol=(i=>(i.normal="panel--offset",i.half="panel--offset-half",i.none="",i))(ol||{});const sn={create:(i,t,e,n)=>{const a=document.createElement("div");return a.className=`panel ${sl[i]}`,t&&t!=="none"&&a.classList.add(ol[t]),e&&a.classList.add("panel--flex"+n?"-column":""),a}};function Zt(i){const t=i.querySelector(".info__table-element");t&&(t.innerHTML=""),i.classList.add("hidden")}function Kt(i,t){const e=i.querySelector(".info__table-element");if(e){for(;e.firstChild;)e.removeChild(e.firstChild);typeof t=="string"?e.textContent=t:(t.forEach(n=>{if(typeof n=="string"){const a=document.createElement("span");a.textContent=n,e.appendChild(a),e.appendChild(document.createElement("br"))}else e.appendChild(n),e.appendChild(document.createElement("br"))}),e.lastChild&&e.removeChild(e.lastChild))}i.classList.remove("hidden")}function ll(i){Ko.forEach(t=>t.style.maxHeight=`${i}rem`)}function cl(i,t){if(i==null||!i.length){Zt(Ha);return}const e=sn.create("max","none",!0);i.forEach((n,a)=>{let o=n.b,r;const s=document.createElement("div"),l=document.createElement("div"),c=document.createElement("div");s.appendChild(l),s.appendChild(c),l.className="info__color-dot",l.style.backgroundColor="#000000",c.className="info__color-text",typeof n.n!="string"&&(c.textContent=`Error parsing bookmarks[${a}]`,e.appendChild(s)),t&&(o=t.adjustTime(o),r=t.toRealTime(o)),l.style.backgroundColor=n.c?$t({r:n.c[0],g:n.c[1],b:n.c[2]}):"#333333",c.textContent=`${A(n.b,et.rounding)}${r?" | "+kt(r):""} -- ${n.n!=""?n.n:"**EMPTY NAME**"}`,e.appendChild(s)}),Kt(Ha,[e])}function ul(i){if(!i||!i.change.length){Zt(za);return}const t=i.change.map(e=>{const n=A(e.newTime,et.rounding),a=i.toRealTime(e.time);return`${n} | ${kt(a)} -- ${e.BPM}`});Kt(za,t)}const pe={DefaultEnvironment:"The First",OriginsEnvironment:"Origins",TriangleEnvironment:"The First",NiceEnvironment:"The First",BigMirrorEnvironment:"The First",DragonsEnvironment:"The First",KDAEnvironment:"KDA",MonstercatEnvironment:"The First",CrabRaveEnvironment:"Crab Rave",PanicEnvironment:"The First",RocketEnvironment:"Rocket",GreenDayEnvironment:"Green Day",GreenDayGrenadeEnvironment:"Green Day",TimbalandEnvironment:"Timbaland",FitBeatEnvironment:"FitBeat",LinkinParkEnvironment:"Linkin Park",BTSEnvironment:"BTS",KaleidoscopeEnvironment:"Kaleidoscope",InterscopeEnvironment:"Interscope",SkrillexEnvironment:"Skrillex",BillieEnvironment:"Billie Eilish",HalloweenEnvironment:"Spooky",GagaEnvironment:"Gaga",WeaveEnvironment:"Weave",PyroEnvironment:"Pyro",EDMEnvironment:"EDM",TheSecondEnvironment:"The Second",LizzoEnvironment:"Lizzo",TheWeekndEnvironment:"The Weeknd",GlassDesertEnvironment:"Glass Desert"},Su={_colorLeft:"Left Note Color",_colorRight:"Right Note Color",_envColorLeft:"Left Environment Color",_envColorRight:"Right Environment Color",_envColorWhite:"White Environment Color",_envColorLeftBoost:"Left Environment Boost Color",_envColorRightBoost:"Right Environment Boost Color",_envColorWhiteBoost:"White Environment Boost Color",_obstacleColor:"Obstacle Color"},ge={"Default Custom":{_colorLeft:{r:.7529412,g:.1882353,b:.1882353},_colorRight:{r:.1254902,g:.3921569,b:.6588235},_envColorLeft:{r:.7529412,g:.1882353,b:.1882353},_envColorRight:{r:.1882353,g:.5960785,b:1},_obstacleColor:{r:1,g:.1882353,b:.1882353}},"The First":{_colorLeft:{r:.7843137,g:.07843138,b:.07843138},_colorRight:{r:.1568627,g:.5568627,b:.8235294},_envColorLeft:{r:.85,g:.08499997,b:.08499997},_envColorRight:{r:.1882353,g:.675294,b:1},_obstacleColor:{r:1,g:.1882353,b:.1882353}},Origins:{_colorLeft:{r:.6792453,g:.5712628,b:0},_colorRight:{r:.7075472,g:0,b:.5364411},_envColorLeft:{r:.4910995,g:.6862745,b:.7},_envColorRight:{r:.03844783,g:.6862745,b:.9056604},_obstacleColor:{r:.06167676,g:.2869513,b:.3962264}},KDA:{_colorLeft:{r:.6588235,g:.2627451,b:.1607843},_colorRight:{r:.5019608,g:.08235294,b:.572549},_envColorLeft:{r:1,g:.3960785,b:.2431373},_envColorRight:{r:.7607844,g:.1254902,b:.8666667},_obstacleColor:{r:1,g:.3960785,b:.2431373}},"Crab Rave":{_colorLeft:{r:0,g:.7130001,b:.07806564},_colorRight:{r:.04805952,g:.5068096,b:.734},_envColorLeft:{r:.134568,g:.756,b:.1557533},_envColorRight:{r:.05647058,g:.6211764,b:.9},_obstacleColor:{r:0,g:.8117648,b:.09019608}},Noir:{_colorLeft:{r:.1792453,g:.1792453,b:.1792453},_colorRight:{r:.5943396,g:.5943396,b:.5943396},_envColorLeft:{r:.4056604,g:.4056604,b:.4056604},_envColorRight:{r:.6037736,g:.6037736,b:.6037736},_obstacleColor:{r:.2358491,g:.2358491,b:.2358491}},Rocket:{_colorLeft:{r:1,g:.4980392,b:0},_colorRight:{r:0,g:.5294118,b:1},_envColorLeft:{r:.9,g:.4866279,b:.3244186},_envColorRight:{r:.4,g:.7180724,b:1},_obstacleColor:{r:.3176471,g:.6117647,b:.7254902}},"Green Day":{_colorLeft:{r:.2588235,g:.7843138,b:.01960784},_colorRight:{r:0,g:.7137255,b:.6705883},_envColorLeft:{r:0,g:.7137255,b:.6705883},_envColorRight:{r:.2588235,g:.7843137,b:.01960784},_obstacleColor:{r:0,g:.8117648,b:.09019608}},Timbaland:{_colorLeft:{r:.5019608,g:.5019608,b:.5019608},_colorRight:{r:.1,g:.5517647,b:1},_envColorLeft:{r:.1,g:.5517647,b:1},_envColorRight:{r:.1,g:.5517647,b:1},_obstacleColor:{r:.5,g:.5,b:.5}},FitBeat:{_colorLeft:{r:.8000001,g:.6078432,b:.1568628},_colorRight:{r:.7921569,g:.1607843,b:.682353},_envColorLeft:{r:.8,g:.5594772,b:.5594772},_envColorRight:{r:.5594772,g:.5594772,b:.8},_obstacleColor:{r:.2784314,g:.2784314,b:.4}},"Linkin Park":{_colorLeft:{r:.6627451,g:.1643608,b:.1690187},_colorRight:{r:.3870196,g:.5168997,b:.5568628},_envColorLeft:{r:.7529412,g:.672753,b:.5925647},_envColorRight:{r:.6241197,g:.6890281,b:.709},_envColorLeftBoost:{r:.922,g:.5957885,b:.255394},_envColorRightBoost:{r:.282353,g:.4586275,b:.6235294},_obstacleColor:{r:.6627451,g:.1647059,b:.172549}},BTS:{_colorLeft:{r:1,g:.09019607,b:.4059771},_colorRight:{r:.8018868,g:0,b:.7517689},_envColorLeft:{r:.7843137,g:.1254902,b:.5010797},_envColorRight:{r:.6941177,g:.1254902,b:.8666667},_envColorLeftBoost:{r:.9019608,g:.5411765,b:1},_envColorRightBoost:{r:.3490196,g:.8078431,b:1},_obstacleColor:{r:.6698113,g:.1800908,b:.5528399}},Kaleidoscope:{_colorLeft:{r:.65882355,g:.1254902,b:.1254902},_colorRight:{r:.28235295,g:.28235295,b:.28235295},_envColorLeft:{r:.65882355,g:.1254902,b:.1254902},_envColorRight:{r:.47058824,g:.47058824,b:.47058824},_envColorLeftBoost:{r:.50196081,g:0,b:0},_envColorRightBoost:{r:.49244517,g:0,b:.53725493},_obstacleColor:{r:.25098041,g:.25098041,b:.25098041}},Interscope:{_colorLeft:{r:.726415,g:.62691,b:.31181},_colorRight:{r:.589571,g:.297888,b:.723},_envColorLeft:{r:.724254,g:.319804,b:.913725},_envColorRight:{r:.764706,g:.758971,b:.913725},_envColorLeftBoost:{r:.792453,g:.429686,b:.429868},_envColorRightBoost:{r:.7038,g:.715745,b:.765},_obstacleColor:{r:.588235,g:.298039,b:.721569}},Skrillex:{_colorLeft:{r:.69803923,g:.14117648,b:.36862746},_colorRight:{r:.32933334,g:.32299998,b:.38},_envColorLeft:{r:.80000001,g:.28000003,b:.58594489},_envColorRight:{r:.06525807,g:.57800001,b:.56867743},_envColorLeftBoost:{r:.81176478,g:.30588236,b:.30588236},_envColorRightBoost:{r:.27843139,g:.80000001,b:.44597632},_obstacleColor:{r:.15686275,g:.60392159,b:.60392159}},"Billie Eilish":{_colorLeft:{r:.80000001,g:.64481932,b:.43200001},_colorRight:{r:.54808509,g:.61276591,b:.63999999},_envColorLeft:{r:.81960785,g:.442,b:.184},_envColorRight:{r:.94117647,g:.70677096,b:.56470591},_obstacleColor:{r:.71325314,g:.56140977,b:.78301889},_envColorLeftBoost:{r:.80000001,g:0,b:0},_envColorRightBoost:{r:.55686277,g:.7019608,b:.77647066}},Spooky:{_colorLeft:{r:.81960785,g:.49807876,b:.27702752},_colorRight:{r:.37894738,g:.35789475,b:.40000001},_envColorLeft:{r:.90196079,g:.23009226,b:0},_envColorRight:{r:.46005884,g:.56889427,b:.92941177},_obstacleColor:{r:.81960791,g:.44313729,b:.18431373},_envColorLeftBoost:{r:.33768433,g:.63207543,b:.33690813},_envColorRightBoost:{r:.60209066,g:.3280082,b:.85849059}},Gaga:{_colorLeft:{r:.85,g:.4333333,b:.7833334},_colorRight:{r:.4705882,g:.8,b:.4078431},_envColorLeft:{r:.706,g:.649,b:.2394706},_envColorRight:{r:.894,g:.1625455,b:.7485644},_obstacleColor:{r:.9921569,g:0,b:.7719755},_envColorLeftBoost:{r:.754717,g:.3610244,b:.22071921},_envColorRightBoost:{r:0,g:.7058824,b:1}},Weave:{_colorLeft:{r:.7843137,g:.07843138,b:.07843138},_colorRight:{r:.1568627,g:.5568627,b:.8235294},_envColorLeft:{r:.85,g:.08499997,b:.08499997},_envColorRight:{r:.1882353,g:.675294,b:1},_envColorLeftBoost:{r:.8218409,g:.08627451,b:.8509804},_envColorRightBoost:{r:.5320754,g:.5320754,b:.5320754},_obstacleColor:{r:1,g:.1882353,b:.1882353}},Pyro:{_colorLeft:{r:.5764706,g:0,b:.03921569},_colorRight:{r:1,g:.6705883,b:0},_envColorLeft:{r:1,g:.1098039,b:.2039216},_envColorRight:{r:.8862745,g:.7372549,b:.2627451},_envColorLeftBoost:{r:1,g:0,b:.1764706},_envColorRightBoost:{r:.7647059,g:.7647059,b:.7647059},_obstacleColor:{r:.8490566,g:.7037643,b:.4285333}},EDM:{_colorLeft:{r:.6320754,g:.6320754,b:.6320754},_colorRight:{r:.1764706,g:.6980392,b:.8784314},_envColorLeft:{r:.08220173,g:.7169812,b:0},_envColorRight:{r:0,g:.3671638,b:.7169812},_envColorLeftBoost:{r:.735849,g:0,b:.1758632},_envColorRightBoost:{r:.4284593,g:0,b:.754717},_obstacleColor:{r:.1764706,g:.6980392,b:.8784314}},"The Second":{_colorLeft:{r:.7843137,g:.07843138,b:.07843138},_colorRight:{r:.1568627,g:.5568627,b:.8235294},_envColorLeft:{r:.85,g:.08499997,b:.08499997},_envColorRight:{r:.1882353,g:.675294,b:1},_envColorLeftBoost:{r:.8235294,g:.08627451,b:.8509804},_envColorRightBoost:{r:0,g:1,b:.6478302},_obstacleColor:{r:1,g:.1882353,b:.1882353}},Lizzo:{_colorLeft:{r:1,g:.8132076,b:.3773585},_colorRight:{r:.6705883,g:.254902,b:.8980392},_envColorLeft:{r:.8392157,g:.6470588,b:.2156863},_envColorRight:{r:.8196079,g:.2392157,b:.8784314},_envColorLeftBoost:{r:1,g:.4,b:.5529412},_envColorRightBoost:{r:.3686275,g:.7960784,b:1},_obstacleColor:{r:1,g:.5020987,b:.1882353}},"The Weeknd":{_colorLeft:{r:.5843138,g:.1294118,b:.1294118},_colorRight:{r:.2235294,g:.2901961,b:.3294118},_envColorLeft:{r:1,g:.2979701,b:.1411765},_envColorRight:{r:.1668743,g:.3753689,b:.7075472},_envColorLeftBoost:{r:.9568628,g:.6039216,b:.1215686},_envColorRightBoost:{r:.5254902,g:.8274511,b:.9921569},_obstacleColor:{r:.9176471,g:.2980392,b:.007843138}},"Glass Desert":{_colorLeft:{r:.6792453,g:.5712628,b:0},_colorRight:{r:.7075472,g:0,b:.5364411},_envColorLeft:{r:.32222217,g:.6111111,b:.75},_envColorRight:{r:.03844783,g:.62239975,b:.90566039},_obstacleColor:{r:.06167676,g:.2869513,b:.3962264}}};function hl(i,t){var l,c,u,d,m,h,p;if(!i||!i._colorLeft&&!i._colorRight&&!i._envColorLeft&&!i._envColorLeftBoost&&!i._envColorRight&&!i._envColorRightBoost&&!i._obstacleColor){Zt($a);return}t||(t="DefaultEnvironment");const e={_colorLeft:(l=ge[pe[t]])==null?void 0:l._colorLeft,_colorRight:(c=ge[pe[t]])==null?void 0:c._colorRight,_envColorLeft:(u=ge[pe[t]])==null?void 0:u._envColorLeft,_envColorRight:(d=ge[pe[t]])==null?void 0:d._envColorRight,_envColorLeftBoost:(m=ge[pe[t]])==null?void 0:m._envColorLeftBoost,_envColorRightBoost:(h=ge[pe[t]])==null?void 0:h._envColorRightBoost,_obstacleColor:(p=ge[pe[t]])==null?void 0:p._obstacleColor},n={_colorLeft:e._colorLeft?$t(e._colorLeft):null,_colorRight:e._colorRight?$t(e._colorRight):null,_envColorLeft:e._envColorLeft?$t(e._envColorLeft):null,_envColorRight:e._envColorRight?$t(e._envColorRight):null,_envColorLeftBoost:e._envColorLeftBoost?$t(e._envColorLeftBoost):null,_envColorRightBoost:e._envColorRightBoost?$t(e._envColorRightBoost):null,_obstacleColor:e._obstacleColor?$t(e._obstacleColor):null};i._colorLeft&&(n._colorLeft=$t(i._colorLeft)),i._colorRight&&(n._colorRight=$t(i._colorRight)),i._envColorLeft?n._envColorLeft=$t(i._envColorLeft):i._colorLeft&&(n._envColorLeft=$t(i._colorLeft)),i._envColorRight?n._envColorRight=$t(i._envColorRight):i._colorRight&&(n._envColorRight=$t(i._colorRight));let a,o,r=!1;i._envColorLeftBoost?(a=$t(i._envColorLeftBoost),r=!0):a=e._envColorLeftBoost?$t(e._envColorLeftBoost):n._envColorLeft,i._envColorRightBoost?(o=$t(i._envColorRightBoost),r=!0):o=e._envColorRightBoost?$t(e._envColorRightBoost):n._envColorRight,r&&(n._envColorLeftBoost=a,n._envColorRightBoost=o),i._obstacleColor&&(n._obstacleColor=$t(i._obstacleColor));const s=sn.create("max","none",!0);for(const g in n){if(!n[g])continue;const b=document.createElement("div"),y=document.createElement("div"),v=document.createElement("div"),S=document.createElement("div");y.className="info__color-dot",y.style.backgroundColor=n[g]||"#000000",v.className="info__color-text info__color-text--monospace",v.textContent=`${n[g]}`,S.className="info__color-text",S.textContent=` -- ${Su[g]}`,b.appendChild(y),b.appendChild(v),b.appendChild(S),s.appendChild(b)}Kt($a,[s])}var dl=(i=>(i.duplicate="D",i.active="A",i.scale="S",i.position="P",i.localPosition="Lp",i.rotation="R",i.localRotation="Lr",i.lightID="Li",i.track="T",i))(dl||{}),fl=(i=>(i.childrenTracks="Ct",i.color="C",i.definitePosition="Dp",i.dissolve="D",i.dissolveArrow="Da",i.duration="Dur",i.easing="E",i.interactable="I",i.localRotation="Lr",i.parentTrack="Pt",i.position="P",i.rotation="R",i.scale="S",i.time="T",i.track="Tr",i.worldPositionStays="Wps",i))(fl||{});function ml(i,t){if(i==null||!i.length){Zt(ja);return}const e=i.map((n,a)=>{let o=n.b,r;t&&(o=t.adjustTime(o),r=t.toRealTime(o));const s=[];if(!n.d)return`Error parsing customEvents[${a}]`;for(const l in n.d){if(l=="_duration"||l=="_easing"||l=="_track"||l=="duration"||l=="easing"||l=="track")continue;const c=fl[l];n.d[l]!=null&&s.push(c)}return`${A(n.b,et.rounding)}${r?" | "+kt(r):""} -- ${n.t} -> [${s.join("")}]${n.t!=="AssignTrackParent"?`(${n.d.track})`:""}`});Kt(ja,e)}function pl(i){if(i==null||!i.length){Zt(Xa);return}const t=i.map((e,n)=>{const a=[];if(!e.id&&!e.geometry)return`Error parsing environment[${n}]`;for(const o in e){if(o=="lookupMethod"||o=="id"||o=="geometry")continue;const r=dl[o];e[o]!=null&&a.push(r)}return`${e.lookupMethod} [${a.join("")}]${e.track?`(${e.track})`:""} -> ${e.geometry?e.geometry.type:e.id}`});Kt(Xa,t)}function Wa(i){if(i==null){Zt(Ia);return}Kt(Ia,i)}function gl(i){if(i==null){Zt(Ba);return}Kt(Ba,uu(i))}function _l(i){if(i==null||!i.length){Zt(Oa);return}Kt(Oa,i.join(", "))}function bl(i){if(i==null||!i.length){Zt(Ma);return}Kt(Ma,i.join(", "))}function yl(i){if(i==null||!i.length){Zt(Pa);return}Kt(Pa,i)}function vl(i){if(i==null||!i.length){Zt(Fa);return}Kt(Fa,i)}function El(i){if(i==null){Zt(Ua);return}const t=[];for(const e in i)i[e]||t.push(`Error parsing pointDefinitions[${e}]`),t.push(`${e} -- ${i[e].length} point${i[e].length>1?"s":""}`);Kt(Ua,t)}function Dl(i,t){if(i==null||t==null){Zt(Aa);return}Kt(Aa,`${kt(i)} to ${kt(t)}${lt.duration?` -- [ ${kt(t-i)} / ${kt(lt.duration)} ]`:""}`)}function Tu(i){var t;Xt.setSongName(i._songName),Xt.setSongSubname(i._songSubName),Xt.setSongAuthor(i._songAuthorName),Xt.setSongBPM(i._beatsPerMinute),el(i._levelAuthorName),il(i._environmentName),nl((t=i._customData)==null?void 0:t._editors)}function wl(i){var t,e,n,a,o;if(i.rawVersion===2&&Wa(i.rawData._version),i.rawVersion===3&&Wa(i.rawData.version),(t=i.info)!=null&&t._customData&&(hl(i.info._customData),_l(i.info._customData._requirements),bl(i.info._customData._suggestions),yl(i.info._customData._information),vl(i.info._customData._warnings)),(e=i.data)!=null&&e.customData){const r=(n=lt.beatmapInfo)!=null&&n._beatsPerMinute?be.create(lt.beatmapInfo._beatsPerMinute,i.data.customData._bpmChanges||i.data.customData._BPMChanges||i.data.customData.BPMChanges):null;gl((a=i.data.customData._time)!=null?a:i.data.customData.time),cl((o=i.data.customData._bookmarks)!=null?o:i.data.customData._bookmarks,r),ul(r),pl(i.data.customData.environment),El(i.data.customData.pointDefinitions),ml(i.data.customData.customEvents,r)}Dl(i.bpm.toRealTime(i.data.getFirstInteractiveTime()),i.bpm.toRealTime(i.data.getLastInteractiveTime()))}function Lu(){el(),il(),nl(),rl(),Wa(),Dl(),gl(),hl(),_l(),bl(),yl(),vl(),cl(),ul(),pl(),El(),ml()}const Cu="UI Input: ",Tn={enable:i=>{const t=document.querySelectorAll(".input-toggle");if(!t.length){console.error(Cu+"empty list, intentional or typo error?");return}t.forEach(e=>{e.disabled=!i})}},ku="UI Loading: ",ki=document.querySelector(".loading__bar"),Wr="loading__bar--error",Vr="loading__bar--download",Sl=document.querySelector(".loading__text");if(!ki||!Sl)throw new Error(ku+"loading component is missing part");function Tl(i,t,e=100){Sl.textContent=t,ki.style.width=`${e}%`,i==="error"?ki.classList.add(Wr):ki.classList.remove(Wr),i==="download"?ki.classList.add(Vr):ki.classList.remove(Vr)}function Ru(){Tl("info","No map loaded",0)}const wt={status:Tl,reset:Ru};var ft=(i=>(i[i.GENERAL_AUDIO=0]="GENERAL_AUDIO",i[i.GENERAL_COVER_IMAGE=1]="GENERAL_COVER_IMAGE",i[i.GENERAL_PREVIEW_TIME=2]="GENERAL_PREVIEW_TIME",i[i.GENERAL_PROGRESSION=3]="GENERAL_PROGRESSION",i[i.OTHERS_INVALID_OBJECT=4]="OTHERS_INVALID_OBJECT",i[i.OTHERS_OUTSIDE_PLAYABLE=5]="OTHERS_OUTSIDE_PLAYABLE",i[i.OTHERS_HOT_START=6]="OTHERS_HOT_START",i[i.OTHERS_NJS=7]="OTHERS_NJS",i[i.OTHERS_DIFFICULTY_LABEL=8]="OTHERS_DIFFICULTY_LABEL",i[i.EVENTS_INSUFFICIENT_LIGHT=9]="EVENTS_INSUFFICIENT_LIGHT",i[i.EVENTS_UNLIT_BOMB=10]="EVENTS_UNLIT_BOMB",i[i.NOTES_EFFECTIVE_BPM=11]="NOTES_EFFECTIVE_BPM",i[i.NOTES_ACCEPTABLE_PRECISION=12]="NOTES_ACCEPTABLE_PRECISION",i[i.NOTES_PARITY=13]="NOTES_PARITY",i[i.NOTES_VARY_SWING=14]="NOTES_VARY_SWING",i[i.NOTES_SLOW_SLIDER=15]="NOTES_SLOW_SLIDER",i[i.NOTES_INLINE_ANGLE=16]="NOTES_INLINE_ANGLE",i[i.NOTES_SHRADO_ANGLE=17]="NOTES_SHRADO_ANGLE",i[i.NOTES_SPEED_PAUSE=18]="NOTES_SPEED_PAUSE",i[i.NOTES_IMPROPER_ARC=19]="NOTES_IMPROPER_ARC",i[i.NOTES_IMPROPER_CHAIN=20]="NOTES_IMPROPER_CHAIN",i[i.NOTES_IMPROPER_WINDOW=21]="NOTES_IMPROPER_WINDOW",i[i.NOTES_HITBOX_STAIR=22]="NOTES_HITBOX_STAIR",i[i.NOTES_HITBOX_REVERSE_STAIR=23]="NOTES_HITBOX_REVERSE_STAIR",i[i.NOTES_HITBOX_INLINE=24]="NOTES_HITBOX_INLINE",i[i.NOTES_HITBOX_PATH=25]="NOTES_HITBOX_PATH",i[i.NOTES_COLOR_CHECK=26]="NOTES_COLOR_CHECK",i[i.NOTES_STACKED_NOTE=27]="NOTES_STACKED_NOTE",i[i.NOTES_DOUBLE_DIRECTIONAL=28]="NOTES_DOUBLE_DIRECTIONAL",i[i.NOTES_VISION_BLOCK=29]="NOTES_VISION_BLOCK",i[i.OBSTACLES_SHORT=30]="OBSTACLES_SHORT",i[i.OBSTACLES_CENTER=31]="OBSTACLES_CENTER",i[i.OBSTACLES_ZERO=32]="OBSTACLES_ZERO",i[i.OBSTACLES_NEGATIVE=33]="OBSTACLES_NEGATIVE",i))(ft||{}),mt=(i=>(i[i.GENERAL_AUDIO=0]="GENERAL_AUDIO",i[i.GENERAL_COVER_IMAGE=1]="GENERAL_COVER_IMAGE",i[i.GENERAL_PREVIEW_TIME=2]="GENERAL_PREVIEW_TIME",i[i.GENERAL_PROGRESSION=3]="GENERAL_PROGRESSION",i[i.OTHERS_INVALID_OBJECT=4]="OTHERS_INVALID_OBJECT",i[i.OTHERS_OUTSIDE_PLAYABLE=5]="OTHERS_OUTSIDE_PLAYABLE",i[i.OTHERS_HOT_START=6]="OTHERS_HOT_START",i[i.OTHERS_NJS=7]="OTHERS_NJS",i[i.OTHERS_DIFFICULTY_LABEL=8]="OTHERS_DIFFICULTY_LABEL",i[i.EVENTS_INSUFFICIENT_LIGHT=9]="EVENTS_INSUFFICIENT_LIGHT",i[i.EVENTS_UNLIT_BOMB=10]="EVENTS_UNLIT_BOMB",i[i.NOTES_COLOR_CHECK=11]="NOTES_COLOR_CHECK",i[i.NOTES_EFFECTIVE_BPM=12]="NOTES_EFFECTIVE_BPM",i[i.NOTES_ACCEPTABLE_PRECISION=13]="NOTES_ACCEPTABLE_PRECISION",i[i.NOTES_PARITY=14]="NOTES_PARITY",i[i.NOTES_VARY_SWING=15]="NOTES_VARY_SWING",i[i.NOTES_SLOW_SLIDER=16]="NOTES_SLOW_SLIDER",i[i.NOTES_INLINE_ANGLE=17]="NOTES_INLINE_ANGLE",i[i.NOTES_SHRADO_ANGLE=18]="NOTES_SHRADO_ANGLE",i[i.NOTES_SPEED_PAUSE=19]="NOTES_SPEED_PAUSE",i[i.NOTES_IMPROPER_ARC=20]="NOTES_IMPROPER_ARC",i[i.NOTES_IMPROPER_CHAIN=21]="NOTES_IMPROPER_CHAIN",i[i.NOTES_IMPROPER_WINDOW=22]="NOTES_IMPROPER_WINDOW",i[i.NOTES_HITBOX_STAIR=23]="NOTES_HITBOX_STAIR",i[i.NOTES_HITBOX_REVERSE_STAIR=24]="NOTES_HITBOX_REVERSE_STAIR",i[i.NOTES_HITBOX_INLINE=25]="NOTES_HITBOX_INLINE",i[i.NOTES_HITBOX_PATH=26]="NOTES_HITBOX_PATH",i[i.NOTES_STACKED_NOTE=27]="NOTES_STACKED_NOTE",i[i.NOTES_DOUBLE_DIRECTIONAL=28]="NOTES_DOUBLE_DIRECTIONAL",i[i.NOTES_VISION_BLOCK=29]="NOTES_VISION_BLOCK",i[i.OBSTACLES_SHORT=30]="OBSTACLES_SHORT",i[i.OBSTACLES_CENTER=31]="OBSTACLES_CENTER",i[i.OBSTACLES_ZERO=32]="OBSTACLES_ZERO",i[i.OBSTACLES_NEGATIVE=33]="OBSTACLES_NEGATIVE",i))(mt||{});function pt(i,t){const e=document.createElement("div");return t?e.innerHTML=`<b>${i}:</b> ${t}`:e.innerHTML=`<b>${i}</b>`,e}function _t(i,t,e){const n=document.createElement("div");return n.innerHTML=`<b>${i} [${t.length}]:</b> ${t.map(a=>{switch(et.beatNumbering){case"realtime":return`<span title="Beat ${A(e.adjustTime(a),et.rounding)}">${kt(e.toRealTime(a))}</span>`;case"realtimems":return`<span title="Beat ${A(e.adjustTime(a),et.rounding)}">${Nn(e.toRealTime(a))}</span>`;case"jsontime":return`<span title="Time ${Nn(e.toRealTime(a))}">${A(a,et.rounding)}</span>`;case"beattime":default:return`<span title="Time ${Nn(e.toRealTime(a))}">${A(e.adjustTime(a),et.rounding)}</span>`}}).join(", ")}`,n}const ga=class{constructor(){}};let ut=ga;O(ut,"list",[]),O(ut,"create",(t,e,n,a)=>{const o=t.trim().toLowerCase().replace(" ","-");if(ga.list.includes(o))throw new Error(o+" is already being used.");ga.list.push(o);const r=document.createElement("div"),s=document.createElement("input"),l=document.createElement("label");return l.textContent=" "+t,l.title=e,l.htmlFor="input__tools-"+o,s.id="input__tools-"+o,s.className="input-toggle",s.type="checkbox",s.checked=n,s.addEventListener("change",a),r.appendChild(s),r.appendChild(l),r});const Jr="Validate Cover Image",qr="Validate cover image.",Zr=!0,Jn={name:Jr,description:qr,type:"general",order:{input:ft.GENERAL_COVER_IMAGE,output:mt.GENERAL_COVER_IMAGE},input:{enabled:Zr,params:{},html:ut.create(Jr,qr,Zr,function(){Jn.input.enabled=this.checked})},output:{html:null},run:xu};function xu(){const i=new Image,t=Xt.getCoverImage(),e=[];if(zi.loading.coverImage&&t!==null?(i.src=t,i.width!==i.height&&e.push(pt("Cover image is not square","resize to fit square")),(i.width<256||i.height<256)&&e.push(pt("Cover image is too small","require at least 256x256"))):e.push(pt("No cover image",et.load.imageCover?"could not be loaded or found":"no cover image option is enabled")),e.length){const n=document.createElement("div");e.forEach(a=>n.append(a)),Jn.output.html=n}else Jn.output.html=null}const Kr="Audio Duration",Qr="For ranking purpose, check for audio duration.",ts=!0,on={name:Kr,description:Qr,type:"general",order:{input:ft.GENERAL_AUDIO,output:mt.GENERAL_AUDIO},input:{enabled:ts,params:{},html:ut.create(Kr,Qr,ts,function(){on.input.enabled=this.checked})},output:{html:null},run:Nu};function Nu(i){const{audioDuration:t}=i.settings;t&&t<20?on.output.html=pt("Unrankable audio length",`too short (${kt(t)}s)`):zi.loading.audio?on.output.html=null:on.output.html=pt("No audio",et.load.audio?"could not be loaded or not found":"no audio mode is enabled")}const es="Preview Time",is="Warn default editor preview time.",ns=!0,qn={name:es,description:is,type:"general",order:{input:ft.GENERAL_PREVIEW_TIME,output:mt.GENERAL_PREVIEW_TIME},input:{enabled:ns,params:{},html:ut.create(es,is,ns,function(){qn.input.enabled=this.checked})},output:{html:null},run:Iu};function Iu(i){const{_previewStartTime:t,_previewDuration:e}=i.info;if(t===12&&e===10){const n=document.createElement("div");n.innerHTML="<b>Default preview time:</b> strongly recommended to set for audience's 1st impression",qn.output.html=n}else qn.output.html=null}function Au(i){return Math.max(...i.map(t=>t.ebpm),0)}function Bu(i){return Math.max(...i.map(t=>t.ebpmSwing),0)}const ba=4;var it=(i=>(i[i.RED=0]="RED",i[i.BLUE=1]="BLUE",i))(it||{}),z=(i=>(i[i.UP=0]="UP",i[i.DOWN=1]="DOWN",i[i.LEFT=2]="LEFT",i[i.RIGHT=3]="RIGHT",i[i.UP_LEFT=4]="UP_LEFT",i[i.UP_RIGHT=5]="UP_RIGHT",i[i.DOWN_LEFT=6]="DOWN_LEFT",i[i.DOWN_RIGHT=7]="DOWN_RIGHT",i[i.ANY=8]="ANY",i))(z||{}),ot=(i=>(i[i.LEFT=0]="LEFT",i[i.MIDDLE_LEFT=1]="MIDDLE_LEFT",i[i.MIDDLE_RIGHT=2]="MIDDLE_RIGHT",i[i.RIGHT=3]="RIGHT",i))(ot||{}),At=(i=>(i[i.BOTTOM=0]="BOTTOM",i[i.MIDDLE=1]="MIDDLE",i[i.TOP=2]="TOP",i))(At||{});const Rt={[0]:180,[1]:0,[2]:270,[3]:90,[4]:225,[5]:135,[6]:315,[7]:45,[8]:0},$u={[0]:1,[1]:0,[2]:3,[3]:2,[4]:7,[5]:6,[6]:5,[7]:4,[8]:8},je={[0]:[0,1],[1]:[0,-1],[2]:[-1,0],[3]:[1,0],[4]:[-1,1],[5]:[1,1],[6]:[-1,-1],[7]:[1,-1],[8]:[0,0]},Ou={0:-60,1:-45,2:-30,3:-15,4:15,5:30,6:45,7:60};class Wi{constructor(t){O(this,"data");this.data=t}serialize(){return JSON.stringify(this.toJSON())}clone(){return new this.constructor(this.toJSON())}}class Ll extends Wi{resetCustomData(){return this.customData={},this}removeCustomData(t){return typeof t=="string"?delete this.customData[t]:t.forEach(e=>delete this.customData[e]),this}func(t){return t(this),this}isChroma(){return!1}isNoodleExtensions(){return!1}isMappingExtensions(){return!1}}class Pe extends Ll{setTime(t){return this.time=t,this}}class ya extends Pe{setPosX(t){return this.posX=t,this}setPosY(t){return this.posY=t,this}mirror(t=!0){return this.posX=ba-1-this.posX,this}swapPosition(t){const e=t.posX;t.posX=this.posX,this.posX=e;const n=t.posY;return t.posY=this.posY,this.posY=n,this}getPosition(t){switch(t){case"vanilla":return[this.posX-2,this.posY];case"me":return[(this.posX<=-1e3?this.posX/1e3:this.posX>=1e3?this.posX/1e3:this.posX)-2,this.posY<=-1e3?this.posY/1e3:this.posY>=1e3?this.posY/1e3:this.posY];case"ne":return[this.posX-2,this.posY];default:return[(this.posX<=-1e3?this.posX/1e3:this.posX>=1e3?this.posX/1e3:this.posX)-2,this.posY<=-1e3?this.posY/1e3:this.posY>=1e3?this.posY/1e3:this.posY]}}getDistance(t){const[e,n]=this.getPosition(),[a,o]=t.getPosition();return Math.sqrt(Math.pow(a-e,2)+Math.pow(o-n,2))}isVertical(t){const[e]=this.getPosition(),[n]=t.getPosition(),a=e-n;return a>-.001&&a<.001}isHorizontal(t){const[e,n]=this.getPosition(),[a,o]=t.getPosition(),r=n-o;return r>-.001&&r<.001}isDiagonal(t){const[e,n]=this.getPosition(),[a,o]=t.getPosition(),r=Math.abs(e-a),s=Math.abs(n-o);return r===s}isInline(t,e=.5){return this.getDistance(t)<=e}isAdjacent(t){const e=this.getDistance(t);return e>.499&&e<1.001}isWindow(t,e=1.8){return this.getDistance(t)>e}isSlantedWindow(t){return this.isWindow(t)&&!this.isDiagonal(t)&&!this.isHorizontal(t)&&!this.isVertical(t)}}class Cl extends ya{setColor(t){return this.color=t,this}setDirection(t){return this.direction=t,this}isRed(){return this.color===0}isBlue(){return this.color===1}mirror(t=!0){switch(t&&(this.color=(1+this.color)%2),this.direction){case 2:this.direction=3;break;case 3:this.direction=2;break;case 6:this.direction=7;break;case 7:this.direction=6;break;case 4:this.direction=5;break;case 5:this.direction=4;break}return super.mirror(t)}swapRotation(t,e=!0){const n=t.direction;return t.direction=this.direction,this.direction=n,this}getAngle(t){switch(t){case"vanilla":return Rt[this.direction]||0;case"me":if(this.direction>=1e3)return Math.abs(this.direction%1e3%360-360);case"ne":return Rt[this.direction]||0;default:return this.direction>=1e3?Math.abs(this.direction%1e3%360-360):Rt[this.direction]||0}}isDouble(t,e=.01){return t.time>this.time-e&&t.time<this.time+e&&this.color!==t.color}isValidDirection(){return this.direction>=0&&this.direction<=8}isValid(){return!this.isMappingExtensions()&&this.isValidDirection()}}class nr extends Cl{setType(t){return this.type=t,this}setAngleOffset(t){return this.angleOffset=t,this}isNote(){return this.type===0||this.type===1}isBomb(){return this.type===3}mirror(t=!0){return super.mirror(t)}swapRotation(t,e=!0){const n=t.angleOffset;return t.angleOffset=this.angleOffset,this.angleOffset=n,e&&(t.angleOffset=0-t.angleOffset,this.angleOffset=0-this.angleOffset),this}getAngle(t){switch(t){case"vanilla":return(Rt[this.direction]||0)+this.angleOffset;case"me":if(this.direction>=1e3)return Math.abs(this.direction%1e3%360-360);case"ne":return(Rt[this.direction]||0)+this.angleOffset;default:return this.direction>=1e3?Math.abs(this.direction%1e3%360-360):(Rt[this.direction]||0)+this.angleOffset}}isMappingExtensions(){return this.posX>3||this.posX<0||this.posY>2||this.posY<0||this.direction>=1e3&&this.direction<=1360||this.direction>=2e3&&this.direction<=2360}}function kl(i,t,e){return i.direction===z.ANY&&t.direction===z.ANY&&e!==z.ANY&&(i.posX>t.posX&&(e===z.UP_RIGHT||e===z.RIGHT||e===z.DOWN_RIGHT)||i.posX<t.posX&&(e===z.DOWN_LEFT||e===z.LEFT||e===z.UP_LEFT)||i.posY>t.posY&&(e===z.UP_LEFT||e===z.UP||e===z.UP_RIGHT)||i.posY<t.posY&&(e===z.DOWN_LEFT||e===z.DOWN||e===z.DOWN_RIGHT))||i.posX>t.posX&&(i.direction===z.UP_RIGHT||i.direction===z.RIGHT||i.direction===z.DOWN_RIGHT||(t.direction===z.UP_RIGHT||t.direction===z.RIGHT||t.direction===z.DOWN_RIGHT)&&i.direction===z.ANY)||i.posX<t.posX&&(i.direction===z.DOWN_LEFT||i.direction===z.LEFT||i.direction===z.UP_LEFT||(t.direction===z.DOWN_LEFT||t.direction===z.LEFT||t.direction===z.UP_LEFT)&&i.direction===z.ANY)||i.posY>t.posY&&(i.direction===z.UP_LEFT||i.direction===z.UP||i.direction===z.UP_RIGHT||(t.direction===z.UP_LEFT||t.direction===z.UP||t.direction===z.UP_RIGHT)&&i.direction===z.ANY)||i.posY<t.posY&&(i.direction===z.DOWN_LEFT||i.direction===z.DOWN||i.direction===z.DOWN_RIGHT||(t.direction===z.DOWN_LEFT||t.direction===z.DOWN||t.direction===z.DOWN_RIGHT)&&i.direction===z.ANY)}function Va(i,t,e,n=!1){const[a,o]=i.getPosition(),[r,s]=t.getPosition(),l=n?540:360;let c=!1;if(i.direction!==8){const d=i.getAngle(),m=(La(Math.atan2(o-s,a-r))+450)%360;for(const[h,p,g]of e){const b=g!=null?g:0,y=(d+l-h+b)%360,v=(d+l+h+b)%360;if(c=p>=Math.sqrt(Math.pow(a-r,2)+Math.pow(o-s,2))&&(y<v&&y<=m&&m<=v||y>=v&&(m<=v||m>=y))||c,c)break}}let u=!1;if(t instanceof nr&&t.direction!==8){const d=t.getAngle(),m=(La(Math.atan2(s-o,r-a))+450)%360;for(const[h,p,g]of e){const b=g!=null?g:0,y=(d+l-h+b)%360,v=(d+l+h+b)%360;if(u=p>=Math.sqrt(Math.pow(a-r,2)+Math.pow(o-s,2))&&(y<v&&y<=m&&m<=v||y>=v&&(m<=v||m>=y))||u,u)break}}return[c,u]}function as(i,t){if(kl(i,t,z.ANY))return i.direction===z.ANY?t.direction:i.direction;if(i.direction!==z.ANY)return i.direction;if(i.time>t.time){if(i.posX>t.posX&&i.isHorizontal(t))return z.RIGHT;if(i.posX<t.posX&&i.isHorizontal(t))return z.LEFT;if(i.posY>t.posY){if(i.isVertical(t))return z.UP;if(i.posX>t.posX)return z.UP_RIGHT;if(i.posX<t.posX)return z.UP_LEFT}if(i.posY<t.posY){if(i.isVertical(t))return z.DOWN;if(i.posX>t.posX)return z.DOWN_RIGHT;if(i.posX<t.posX)return z.DOWN_LEFT}}return z.ANY}function mn(i,t,e,n){let a,o;if(i===null||t===null)return!1;if(typeof i=="number")a=i;else{if(i.direction===z.ANY)return!1;a=i.getAngle()}if(typeof t=="number")o=t;else{if(t.direction===z.ANY)return!1;o=t.getAngle()}return n?Ur(a,o,360)<=e:Ur(a,o,360)>=e}class Ut{constructor(t){O(this,"time");O(this,"duration");O(this,"minSpeed");O(this,"maxSpeed");O(this,"ebpm");O(this,"ebpmSwing");O(this,"data");this.time=t.time,this.duration=t.duration,this.minSpeed=t.minSpeed,this.maxSpeed=t.maxSpeed,this.ebpm=t.ebpm,this.ebpmSwing=t.ebpmSwing,this.data=t.data}static generate(t,e){const n=[];let a=0,o=0,r,s;const l={},c={},u={0:[],1:[]};for(const d of t)d.type==="note"&&(r=0,s=Number.MAX_SAFE_INTEGER,c[d.data.color]?this.next(d,c[d.data.color],e,u[d.data.color])&&(r=this.calcMinSliderSpeed(u[d.data.color],e),s=this.calcMaxSliderSpeed(u[d.data.color],e),r>0&&s!==1/0||(r=0,s=0),n.push({time:l[d.data.color].data.time,duration:c[d.data.color].data.time-l[d.data.color].data.time,data:u[d.data.color],ebpm:a,ebpmSwing:o,maxSpeed:s,minSpeed:r}),o=this.calcEBPMBetweenObject(d.data,l[d.data.color].data,e.value),a=this.calcEBPMBetweenObject(d.data,c[d.data.color].data,e.value),l[d.data.color]=d,u[d.data.color]=[]):l[d.data.color]=d,c[d.data.color]=d,u[d.data.color].push(d));for(let d=0;d<2;d++)c[d]&&(r=this.calcMinSliderSpeed(u[d],e),s=this.calcMaxSliderSpeed(u[d],e),r>0&&s!==1/0||(r=0,s=0),n.push({time:l[d].data.time,duration:c[d].data.time-l[d].data.time,data:u[d],ebpm:a,ebpmSwing:o,maxSpeed:s,minSpeed:r}));return n}}O(Ut,"next",(t,e,n,a)=>{if(t.type==="bomb"||e.type==="bomb")throw new Error("Invalid type");if(a&&a.length>0&&n.toRealTime(e.data.time)+.005<n.toRealTime(t.data.time)&&t.data.direction!==z.ANY){for(const o of a)if(o.type==="note"&&o.data.direction!==z.ANY&&mn(t.data,o.data,90,!1))return!0}if(a&&a.length>0){for(const o of a)if(o.type==="note"&&t.data.isInline(o.data))return!0}return t.data.isWindow(e.data)&&n.toRealTime(t.data.time-e.data.time)>.08||n.toRealTime(t.data.time-e.data.time)>.07}),O(Ut,"calcEBPMBetweenObject",(t,e,n)=>n/((t.time-e.time)*2)),O(Ut,"calcMinSliderSpeed",(t,e)=>{let n=!1,a=!1,o=0;const r=e.toRealTime(Math.max(...t.map((s,l)=>l===0?0:((t[l].data.isHorizontal(t[l-1].data)||t[l].data.isVertical(t[l-1].data))&&!n&&(n=!0,o=(t[l].data.time-t[l-1].data.time)/(t[l].data.getDistance(t[l-1].data)||1)),a=t[l].data.isDiagonal(t[l-1].data)||t[l].data.isSlantedWindow(t[l-1].data)||a,(t[l].data.time-t[l-1].data.time)/(t[l].data.getDistance(t[l-1].data)||1)))));return n&&a?e.toRealTime(o):r}),O(Ut,"calcMaxSliderSpeed",(t,e)=>{let n=!1,a=!1,o=Number.MAX_SAFE_INTEGER;const r=e.toRealTime(Math.min(...t.map((s,l)=>l===0?Number.MAX_SAFE_INTEGER:((t[l].data.isHorizontal(t[l-1].data)||t[l].data.isVertical(t[l-1].data))&&!n&&(n=!0,o=(t[l].data.time-t[l-1].data.time)/(t[l].data.getDistance(t[l-1].data)||1)),a=t[l].data.isDiagonal(t[l-1].data)||t[l].data.isSlantedWindow(t[l-1].data)||a,(t[l].data.time-t[l-1].data.time)/(t[l].data.getDistance(t[l-1].data)||1)))));return n&&a?e.toRealTime(o):r});function Mu(i,t,e){const n={left:new Array(Math.floor(t+1)).fill(0),right:new Array(Math.floor(t+1)).fill(0)};let a,o;for(const r of i){if(r.type!=="note")continue;const s=e.toRealTime(r.data.time);r.data.color===0&&(a?Ut.next(r,a,e)&&n.left[Math.floor(s)]++:n.left[Math.floor(s)]++,a=r),r.data.color===1&&(o?Ut.next(r,o,e)&&n.right[Math.floor(s)]++:n.right[Math.floor(s)]++,o=r)}return n}function wa(i,t){if(!i.length)return 0;if(i.length<t)return i.reduce((a,o)=>a+o)/i.length;let e=i.slice(0,t).reduce((a,o)=>a+o),n=e;for(let a=0;a<i.length-t;a++)e=e-i[a]+i[a+t],n=Math.max(n,e);return n/t}function rs(i,t,e,n){const o={characteristic:e,difficulty:n,red:{average:0,peak:0,median:0,total:0},blue:{average:0,peak:0,median:0,total:0},total:{average:0,peak:0,median:0,total:0},container:Ut.generate(i.getNoteContainer(),t)},r=Math.max(t.toRealTime(i.getLastInteractiveTime()-i.getFirstInteractiveTime()),0),s=Math.max(t.toRealTime(i.getLastInteractiveTime()),0),l=Mu(i.getNoteContainer(),s,t),c=l.left.map((h,p)=>h+l.right[p]);if(c.reduce((h,p)=>h+p)===0)return o;const u=[],d=[],m=[];for(let h=0,p=Math.ceil(c.length/10);h<p;h++){const g=h*10;let b=10;b+g>c.length&&(b=c.length-g);const y=l.left.slice(g,g+b),v=l.right.slice(g,g+b),S=c.slice(g,g+b);u.push(y.reduce((L,C)=>L+C)/b),d.push(v.reduce((L,C)=>L+C)/b),m.push(S.reduce((L,C)=>L+C)/b)}return o.red.total=l.left.reduce((h,p)=>h+p),o.red.average=l.left.reduce((h,p)=>h+p)/r,o.red.peak=wa(l.left,10),o.red.median=Da(u),o.blue.total=l.right.reduce((h,p)=>h+p),o.blue.average=l.right.reduce((h,p)=>h+p)/r,o.blue.peak=wa(l.right,10),o.blue.median=Da(d),o.total.total=o.red.total+o.blue.total,o.total.average=c.reduce((h,p)=>h+p)/r,o.total.peak=wa(c,10),o.total.median=Da(m),o}function Pu(i,t){let e=0,n=0,a;for(const o of i){const r=o.total.average;if(n>0&&r>0&&(e=Math.abs(1-n/r)*100),n=r>0?r:n,n>t&&e>40)return{result:o,comparedTo:a};a=o}return null}function Fu(i,t){let e=Number.MAX_SAFE_INTEGER,n=0,a;for(const o of i){const r=o.total.average;if(n>0&&r>0&&(e=Math.abs(1-n/r)*100),n=r>0?r:n,n>t&&e<10)return{result:o,comparedTo:a};a=o}return null}function Hu(i){let t=0,e=Number.MAX_SAFE_INTEGER;return i.forEach(n=>{const a=n.total.average;a>0&&(t=Math.max(t,a),e=Math.min(e,a))}),t||t&&e?(1-e/t)*100:0}function ss(i){let t=Number.MAX_SAFE_INTEGER;return i.forEach(e=>{const n=e.total.average;n>0&&(t=Math.min(t,n))}),t}function os(i){let t=0;return i.forEach(e=>{const n=e.total.average;n>0&&(t=Math.max(t,n))}),t}function zu(i){return Math.max(...i.map(t=>t.minSpeed),0)}function Xu(i){const t=i.map(e=>e.maxSpeed).filter(e=>e!==0);return t.length?Math.min(...t):0}var Rl=(i=>(i[i.Easy=1]="Easy",i[i.Normal=3]="Normal",i[i.Hard=5]="Hard",i[i.Expert=7]="Expert",i[i.ExpertPlus=9]="ExpertPlus",i))(Rl||{}),_e=(i=>(i.Easy="Easy",i.Normal="Normal",i.Hard="Hard",i.Expert="Expert",i.ExpertPlus="Expert+",i))(_e||{});const xl="Difficulty Progression",Nl="For ranking purpose, check difficuly progression to fit rankability criteria.",Il=!0,ar=document.createElement("div"),Al=document.createElement("ul"),Uu=["ExpertPlus","Expert","Hard","Normal","Easy"];for(const i of Uu)Al.appendChild(ut.create(_e[i],`Toggle check progression for Standard ${_e[i]}`,!0,function(){Ve.input.params[i]=this.checked}));ar.appendChild(ut.create(xl,Nl,Il,function(){Ve.input.enabled=this.checked}));ar.appendChild(Al);const Ve={name:xl,description:Nl,type:"general",order:{input:ft.GENERAL_PROGRESSION,output:mt.GENERAL_PROGRESSION},input:{enabled:Il,params:{ExpertPlus:!0,Expert:!0,Hard:!0,Normal:!0,Easy:!0},html:ar},output:{html:null},run:ju};function ju(i){var s,l,c,u,d,m,h,p;const{audioDuration:t}=i.settings;if(!t){Ve.output.html=null;return}const e=lt.beatmapDifficulty.map(g=>g.swingAnalysis).filter(g=>g.characteristic==="Standard"&&Ve.input.params[g.difficulty]||g.total.total===0).sort((g,b)=>g.total.average-b.total.average).reverse();if(!e.length){Ve.output.html=null;return}const n=Math.max(t<120?3.2:t<240?4.2:5.2,A(os(e)*.4,2)),a=[];t<360&&ss(e)>n&&a.push(pt(`Minimum SPS not met (<${n})`,`lowest SPS is ${A(ss(e),2)}, ${A(Hu(e),2)}% drop from highest SPS (${A(os(e),2)})`));const o=Pu(e,n),r=Fu(e,n);if(o&&t<360&&a.push(pt("Violates progression",`${_e[o.result.difficulty]} exceeded 40% SPS drop, ${A(o.result.total.average,2)} from ${A(((l=(s=o.comparedTo)==null?void 0:s.total)==null?void 0:l.average)||0,2)} ${_e[o.comparedTo.difficulty]}, acceptable range (${A((((u=(c=o.comparedTo)==null?void 0:c.total)==null?void 0:u.average)||0)*.6,2)}-${A((((d=o.comparedTo)==null?void 0:d.total.average)||0)*.9,2)})`)),r&&t<360&&a.push(pt("Violates progression",`${_e[r.result.difficulty]} has less than 10% SPS drop, ${A(r.result.total.average,2)} from ${A(((m=r.comparedTo)==null?void 0:m.total.average)||0,2)} ${_e[r.comparedTo.difficulty]}, acceptable range (${A((((h=r.comparedTo)==null?void 0:h.total.average)||0)*.6,2)}-${A((((p=r.comparedTo)==null?void 0:p.total.average)||0)*.9,2)})`)),a.length){const g=document.createElement("div");a.forEach(b=>g.append(b)),Ve.output.html=g}else Ve.output.html=null}const ls=Object.freeze(Object.defineProperty({__proto__:null,coverImage:Jn,audio:on,previewTime:qn,progression:Ve},Symbol.toStringTag,{value:"Module"})),Bl="Effective BPM",$l=`Effective BPM is calculated by one hand making 1/2 precision movement relative to the BPM.
EBPM starts from previous end note to next start note (typically for sliders).
EBPM Swing starts from previous start note to next start note.`,Ol=!0,rr=450,sr=350,bn=ut.create(Bl+" threshold",$l,Ol,function(){Wt.input.enabled=this.checked}),Ke=document.createElement("input"),or=document.createElement("label"),Qe=document.createElement("input"),lr=document.createElement("label");or.textContent=": ";or.htmlFor="input__tools-ebpm";Ke.id="input__tools-ebpm";Ke.className="input-toggle input--small";Ke.type="number";Ke.min="0";Ke.value=rr.toString();Ke.addEventListener("change",Gu);lr.textContent=" (swing): ";lr.htmlFor="input__tools-ebpms";Qe.id="input__tools-ebpms";Qe.className="input-toggle input--small";Qe.type="number";Qe.min="0";Qe.value=sr.toString();Qe.addEventListener("change",Wu);bn.appendChild(or);bn.appendChild(Ke);bn.appendChild(lr);bn.appendChild(Qe);const Wt={name:Bl,description:$l,type:"note",order:{input:ft.NOTES_EFFECTIVE_BPM,output:mt.NOTES_EFFECTIVE_BPM},input:{enabled:Ol,params:{ebpmThres:rr,ebpmsThres:sr},html:bn,adjustTime:Yu},output:{html:null},run:Ju};function Yu(i){Wt.input.params.ebpmThres=A(Math.min(rr,i.value*2*1.285714),1),Wt.input.params.ebpmsThres=A(Math.min(sr,i.value*2),1),Ke.value=Wt.input.params.ebpmThres.toString(),Qe.value=Wt.input.params.ebpmsThres.toString()}function Gu(){Wt.input.params.ebpmThres=A(Math.abs(parseFloat(this.value)),1),this.value=Wt.input.params.ebpmThres.toString()}function Wu(){Wt.input.params.ebpmsThres=A(Math.abs(parseFloat(this.value)),1),this.value=Wt.input.params.ebpmsThres.toString()}function Vu(i){const{swingAnalysis:t}=i.difficulty,{ebpmThres:e,ebpmsThres:n}=Wt.input.params,a=t.container.filter(r=>r.ebpm>e).map(r=>r.time),o=t.container.filter(r=>r.ebpmSwing>n).map(r=>r.time);return{base:a,swing:o}}function Ju(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=Vu(i),{ebpmThres:e,ebpmsThres:n}=Wt.input.params,a=[];if(t.base.length&&a.push(_t(`>${e}EBPM warning`,t.base,i.settings.bpm)),t.swing.length&&a.push(_t(`>${n}EBPM (swing) warning`,t.swing,i.settings.bpm)),a.length){const o=document.createElement("div");a.forEach(r=>o.append(r)),Wt.output.html=o}else Wt.output.html=null}const Ml="Acceptable Beat Precision",Pl=`Validate note timing placement is within timing precision.
i.e: 1/8 1/6 1/x`,Fl=!0,Hl=[8,6],zl=ut.create(Ml+": ",Pl,Fl,function(){wi.input.enabled=this.checked}),Vi=document.createElement("input");Vi.id="input__tools-prec";Vi.className="input-toggle input--small";Vi.type="text";Vi.value=Hl.join(" ");Vi.addEventListener("change",qu);zl.appendChild(Vi);const wi={name:Ml,description:Pl,type:"note",order:{input:ft.NOTES_ACCEPTABLE_PRECISION,output:mt.NOTES_ACCEPTABLE_PRECISION},input:{enabled:Fl,params:{prec:[...Hl]},html:zl},output:{html:null},run:Ku};function qu(){wi.input.params.prec=this.value.trim().split(" ").map(i=>parseInt(i)).filter(i=>i>0?!Number.isNaN(i):!1),this.value=wi.input.params.prec.join(" ")}function Zu(i,t){const{bpm:e}=i,n=t.swingAnalysis.container,{prec:a}=wi.input.params;return n.map(o=>o.time).filter((o,r,s)=>!r||o!==s[r-1]).filter(o=>{if(!a.length)return!1;for(let r=0;r<a.length;r++)if((e.adjustTime(o)+.001)%(1/a[r])<.01)return!1;return!0})}function Ku(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=Zu(i.settings,i.difficulty);t.length?wi.output.html=_t("Off-beat precision",t,i.settings.bpm):wi.output.html=null}const cs="Varying Swing Speed",us="Check for varying swing speed due to changes in slider distance.",hs=!0,Zn={name:cs,description:us,type:"note",order:{input:ft.NOTES_VARY_SWING,output:mt.NOTES_VARY_SWING},input:{enabled:hs,params:{},html:ut.create(cs,us,hs,function(){Zn.input.enabled=this.checked})},output:{html:null},run:th};function Qu(i){const{swingAnalysis:t}=i;return t.container.filter(e=>Math.abs(e.minSpeed-e.maxSpeed)>.002).map(e=>e.time).filter((e,n,a)=>!n||e!==a[n-1])}function th(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=Qu(i.difficulty);t.length?Zn.output.html=_t("Varying swing speed",t,i.settings.bpm):Zn.output.html=null}const Xl="Slow Slider",Ul="Look for slider that require slow swing.",jl=!0,Yl=.025,Ji=document.createElement("div"),ti=document.createElement("input"),cr=document.createElement("label"),ei=document.createElement("input"),ur=document.createElement("label");let Xi;cr.textContent="min speed (ms): ";cr.htmlFor="input__tools-slow-slider-time";ti.id="input__tools-slow-slider-time";ti.className="input-toggle input--small";ti.type="number";ti.min="0";ti.value=A(Yl*1e3,1).toString();ti.addEventListener("change",ih);ur.textContent=" (prec): ";ur.htmlFor="input__tools-slow-slider-prec";ei.id="input__tools-slow-slider-prec";ei.className="input-toggle input--small";ei.type="number";ei.min="0";ei.addEventListener("change",nh);Ji.appendChild(ut.create(Xl,Ul,jl,function(){le.input.enabled=this.checked}));Ji.appendChild(cr);Ji.appendChild(ti);Ji.appendChild(ur);Ji.appendChild(ei);const le={name:Xl,description:Ul,type:"note",order:{input:ft.NOTES_SLOW_SLIDER,output:mt.NOTES_SLOW_SLIDER},input:{enabled:jl,params:{minSpeed:Yl},html:Ji,adjustTime:eh},output:{html:null},run:rh};function eh(i){Xi=i,ei.value=A(1/Xi.toBeatTime(le.input.params.minSpeed),2).toString()}function ih(){le.input.params.minSpeed=Math.abs(parseFloat(this.value))/1e3,this.value=A(le.input.params.minSpeed*1e3,1).toString(),Xi&&(ei.value=A(1/Xi.toBeatTime(le.input.params.minSpeed),2).toString())}function nh(){if(!Xi){this.value="0";return}let i=A(Math.abs(parseFloat(this.value)),2)||1;le.input.params.minSpeed=Xi.toRealTime(1/i),ti.value=A(le.input.params.minSpeed*1e3,1).toString(),this.value=i.toString()}function ah(i){const{swingAnalysis:t}=i.difficulty,{minSpeed:e}=le.input.params;return t.container.filter(n=>n.maxSpeed>e||n.minSpeed>e).map(n=>n.time).filter((n,a,o)=>!a||n!==o[a-1])}function rh(i){if(!i.difficulty){console.error("Something went wrong!");return}const{minSpeed:t}=le.input.params,e=ah(i);e.length?le.output.html=_t(`Slow slider (>${A(t*1e3,1)}ms)`,e,i.settings.bpm):le.output.html=null}const Gl="Inline Sharp Angle",Wl="Check for angle changes within inline note.",Vl=!0,Jl=.15;let Ui;const qi=document.createElement("div"),ii=document.createElement("input"),hr=document.createElement("label"),Fe=document.createElement("input"),dr=document.createElement("label");hr.textContent="max time (ms): ";hr.htmlFor="input__tools-inline-angle-time";ii.id="input__tools-inline-angle-time";ii.className="input-toggle input--small";ii.type="number";ii.min="0";ii.value=A(Jl*1e3,1).toString();ii.addEventListener("change",oh);dr.textContent=" (beat): ";dr.htmlFor="input__tools-inline-angle-beat";Fe.id="input__tools-inline-angle-beat";Fe.className="input-toggle input--small";Fe.type="number";Fe.min="0";Fe.step="0.1";Fe.addEventListener("change",lh);qi.appendChild(ut.create(Gl,Wl,Vl,function(){ye.input.enabled=this.checked}));qi.appendChild(hr);qi.appendChild(ii);qi.appendChild(dr);qi.appendChild(Fe);const ye={name:Gl,description:Wl,type:"note",order:{input:ft.NOTES_INLINE_ANGLE,output:mt.NOTES_INLINE_ANGLE},input:{enabled:Vl,params:{maxTime:Jl},html:qi,adjustTime:sh},output:{html:null},run:uh};function sh(i){Ui=i,Fe.value=A(Ui.toBeatTime(ye.input.params.maxTime),2).toString()}function oh(){ye.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=A(ye.input.params.maxTime*1e3,1).toString(),Ui&&(Fe.value=A(Ui.toBeatTime(ye.input.params.maxTime),2).toString())}function lh(){if(!Ui){this.value="0";return}let i=A(Math.abs(parseFloat(this.value)),2)||1;ye.input.params.maxTime=Ui.toRealTime(i),ii.value=A(ye.input.params.maxTime*1e3,1).toString(),this.value=i.toString()}function ch(i){const{bpm:t}=i.settings,e=i.difficulty.noteContainer,{maxTime:n}=ye.input.params,a=t.toBeatTime(n)+.001,o={},r={},s={},l={[it.RED]:[],[it.BLUE]:[]},c=[];let u=0;for(let d=0,m=e.length;d<m;d++){const h=e[d];h.type==="note"&&o[h.data.color]?Ut.next(h,o[h.data.color],t,l[h.data.color])?(s[h.data.color]&&(s[h.data.color]=null,r[h.data.color]=(r[h.data.color]+180)%360),ds(h.data,e,u,a)&&mn(h.data,r[h.data.color],90,!0)&&c.push(h.data),h.data.direction===z.ANY?s[h.data.color]=h.data:r[h.data.color]=h.data.getAngle(),l[h.data.color]=[]):(s[h.data.color]&&ds(h.data,e,u,a)&&mn(h.data,r[h.data.color],90,!0)&&(c.push(s[h.data.color]),s[h.data.color]=null),h.data.direction!==z.ANY&&(r[h.data.color]=h.data.getAngle())):h.type==="note"&&(r[h.data.color]=h.data.getAngle()),h.type==="note"&&(o[h.data.color]=h,l[h.data.color].push(h)),h.type==="bomb"&&(h.data.posY===At.BOTTOM&&(h.data.posX===ot.MIDDLE_LEFT&&(r[it.RED]=Rt[z.UP],s[it.RED]=null),h.data.posX===ot.MIDDLE_RIGHT&&(r[it.BLUE]=Rt[z.UP],s[it.BLUE]=null)),h.data.posY===At.TOP&&(h.data.posX===ot.MIDDLE_LEFT&&(r[it.RED]=Rt[z.DOWN],s[it.RED]=null),h.data.posX===ot.MIDDLE_RIGHT&&(r[it.BLUE]=Rt[z.DOWN],s[it.BLUE]=null)))}return c.map(d=>d.time).filter(function(d,m,h){return!m||d!==h[m-1]})}function ds(i,t,e,n){for(let a=e;t[a].data.time<i.time;a++){const o=t[a];if(o.type==="note"&&i.isInline(o.data)&&i.time-t[a].data.time<=n)return!0}return!1}function uh(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=ch(i);t.length?ye.output.html=_t("Inline sharp angle",t,i.settings.bpm):ye.output.html=null}const ql="shrado Angle",Zl="Look for common negative curvature pattern.",Kl=!1,Ql=.15,tc=1;let ji;const He=document.createElement("div"),Ti=document.createElement("input"),fr=document.createElement("label"),ni=document.createElement("input"),mr=document.createElement("label"),ze=document.createElement("input"),pr=document.createElement("label");fr.textContent="min distance: ";fr.htmlFor="input__tools-shrado-angle-distance";Ti.id="input__tools-shrado-angle-distance";Ti.className="input-toggle input--small";Ti.type="number";Ti.min="0";Ti.value=tc.toString();Ti.addEventListener("change",dh);mr.textContent="max time (ms): ";mr.htmlFor="input__tools-shrado-angle-time";ni.id="input__tools-shrado-angle-time";ni.className="input-toggle input--small";ni.type="number";ni.min="0";ni.value=A(Ql*1e3,1).toString();ni.addEventListener("change",fh);pr.textContent=" (beat): ";pr.htmlFor="input__tools-shrado-angle-beat";ze.id="input__tools-shrado-angle-beat";ze.className="input-toggle input--small";ze.type="number";ze.min="0";ze.step="0.1";ze.addEventListener("change",mh);He.appendChild(ut.create(ql,Zl,Kl,function(){Jt.input.enabled=this.checked}));He.appendChild(fr);He.appendChild(Ti);He.appendChild(document.createElement("br"));He.appendChild(mr);He.appendChild(ni);He.appendChild(pr);He.appendChild(ze);const Jt={name:ql,description:Zl,type:"note",order:{input:ft.NOTES_SHRADO_ANGLE,output:mt.NOTES_SHRADO_ANGLE},input:{enabled:Kl,params:{distance:tc,maxTime:Ql},html:He,adjustTime:hh},output:{html:null},run:gh};function hh(i){ji=i,ze.value=A(ji.toBeatTime(Jt.input.params.maxTime),2).toString()}function dh(){Jt.input.params.distance=Math.max(parseInt(this.value),0),this.value=Jt.input.params.distance.toString()}function fh(){Jt.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=A(Jt.input.params.maxTime*1e3,1).toString(),ji&&(ze.value=A(ji.toBeatTime(Jt.input.params.maxTime),2).toString())}function mh(){if(!ji){this.value="0";return}let i=A(Math.abs(parseFloat(this.value)),2)||1;Jt.input.params.maxTime=ji.toRealTime(i),ni.value=A(Jt.input.params.maxTime*1e3,1).toString(),this.value=i.toString()}function ph(i){var d;const{bpm:t}=i.settings,{noteContainer:e}=i.difficulty,{maxTime:n,distance:a}=Jt.input.params,o=t.toBeatTime(n)+.001,r={},s={},l={},c={[it.RED]:[],[it.BLUE]:[]},u=[];for(let m=0,h=e.length;m<h;m++){if(e[m].type!=="note")continue;const p=e[m];r[p.data.color]?Ut.next(p,r[p.data.color],t,c[p.data.color])?(l[p.data.color]&&(l[p.data.color]=null,s[p.data.color]=(d=$u[s[p.data.color]])!=null?d:8),p.data.getDistance(r[p.data.color].data)>=a&&fs(p.data.direction,s[p.data.color],p.data.color)&&p.data.time-r[p.data.color].data.time<=o&&u.push(p),p.data.direction===z.ANY?l[p.data.color]=p:s[p.data.color]=p.data.direction,c[p.data.color]=[]):(l[p.data.color]&&p.data.getDistance(r[p.data.color].data)>=a&&fs(p.data.direction,s[p.data.color],p.data.color)&&p.data.time-r[p.data.color].data.time<=o&&(u.push(l[p.data.color]),l[p.data.color]=null),p.data.direction!==z.ANY&&(s[p.data.color]=p.data.direction)):s[p.data.color]=p.data.direction,r[p.data.color]=p,c[p.data.color].push(p)}return u.map(m=>m.data.time).filter(function(m,h,p){return!h||m!==p[h-1]})}function fs(i,t,e){return i===8||t===8?!1:(e===0?t===7:t===6)&&i===0}function gh(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=ph(i);t.length?Jt.output.html=_t("Shrado angle",t,i.settings.bpm):Jt.output.html=null}const ec="Speed Pause",ic="Look for stream/burst containing timing gap causing sudden change of pace.",nc=!1,ac=.075;let Yi;const Zi=document.createElement("div"),ai=document.createElement("input"),gr=document.createElement("label"),ri=document.createElement("input"),_r=document.createElement("label");gr.textContent="stream speed (ms): ";gr.htmlFor="input__tools-speed-pause-time";ai.id="input__tools-speed-pause-time";ai.className="input-toggle input--small";ai.type="number";ai.min="0";ai.value=A(ac*1e3,1).toString();ai.addEventListener("change",bh);_r.textContent=" (prec): ";_r.htmlFor="input__tools-speed-pause-prec";ri.id="input__tools-speed-pause-prec";ri.className="input-toggle input--small";ri.type="number";ri.min="0";ri.addEventListener("change",yh);Zi.appendChild(ut.create(ec,ic,nc,function(){ve.input.enabled=this.checked}));Zi.appendChild(gr);Zi.appendChild(ai);Zi.appendChild(_r);Zi.appendChild(ri);const ve={name:ec,description:ic,type:"note",order:{input:ft.NOTES_SPEED_PAUSE,output:mt.NOTES_SPEED_PAUSE},input:{enabled:nc,params:{maxTime:ac},html:Zi,adjustTime:_h},output:{html:null},run:Eh};function _h(i){Yi=i,ri.value=A(1/Yi.toBeatTime(ve.input.params.maxTime),2).toString()}function bh(){ve.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=A(ve.input.params.maxTime*1e3,1).toString(),Yi&&(ri.value=A(1/Yi.toBeatTime(ve.input.params.maxTime),2).toString())}function yh(){if(!Yi){this.value="0";return}let i=A(Math.abs(parseFloat(this.value)),2)||1;ve.input.params.maxTime=Yi.toRealTime(1/i),ai.value=A(ve.input.params.maxTime*1e3,1).toString(),this.value=i.toString()}function vh(i,t){const{bpm:e}=i,{noteContainer:n}=t,{maxTime:a}=ve.input.params,o=e.toBeatTime(a)+.001,r={},s={},l={[it.RED]:!1,[it.BLUE]:!1},c={[it.RED]:[],[it.BLUE]:[]},u=[];for(let d=0,m=n.length;d<m;d++){if(n[d].type!=="note")continue;const h=n[d];r[h.data.color]?Ut.next(h,r[h.data.color],e,c[h.data.color])&&(h.data.time-r[h.data.color].data.time<=o*2?(l[it.RED]&&l[it.BLUE]&&r[h.data.color].data.time-s[h.data.color].data.time<=o*3&&u.push(r[h.data.color]),l[h.data.color]=!1):l[h.data.color]||(l[h.data.color]=!0,s[h.data.color]=r[h.data.color]),c[h.data.color]=[],r[h.data.color]=h):r[h.data.color]=h,c[h.data.color].push(h)}return u.map(d=>d.data.time).filter(function(d,m,h){return!m||d!==h[m-1]})}function Eh(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=vh(i.settings,i.difficulty);t.length?ve.output.html=_t("Speed pause",t,i.settings.bpm):ve.output.html=null}const Ft=class extends nr{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,o,r,s,l,c,u;return e.push(new this({b:(a=n.b)!=null?a:Ft.default.b,x:(o=n.x)!=null?o:Ft.default.x,y:(r=n.y)!=null?r:Ft.default.y,c:(s=n.c)!=null?s:Ft.default.c,d:(l=n.d)!=null?l:Ft.default.d,a:(c=n.a)!=null?c:Ft.default.a,customData:(u=n.customData)!=null?u:Ft.default.customData()}))}),e.length?e:[new this({b:Ft.default.b,x:Ft.default.x,y:Ft.default.y,c:Ft.default.c,d:Ft.default.d,a:Ft.default.a,customData:Ft.default.customData()})]}toJSON(){return{b:this.time,c:this.color,x:this.posX,y:this.posY,d:this.direction,a:this.angleOffset,customData:vt(this.customData)}}get time(){return this.data.b}set time(t){this.data.b=t}get posX(){return this.data.x}set posX(t){this.data.x=t}get posY(){return this.data.y}set posY(t){this.data.y=t}get color(){return this.data.c}set color(t){this.data.c=t}get type(){return this.data.c}set type(t){this.data.c=t}get direction(){return this.data.d}set direction(t){this.data.d=t}get angleOffset(){return this.data.a}set angleOffset(t){this.data.a=t}get customData(){return this.data.customData}set customData(t){this.data.customData=t}setCustomData(t){return this.customData=t,this}addCustomData(t){return this.customData={...this.customData,object:t},this}setColor(t){return this.color=t,this}setDirection(t){return this.direction=t,this}setAngleOffset(t){return this.angleOffset=t,this}mirror(t=!0){return this.customData.coordinates&&(this.customData.coordinates[0]=-1-this.customData.coordinates[0]),this.customData.flip&&(this.customData.flip[0]=-1-this.customData.flip[0]),this.customData.animation&&(Array.isArray(this.customData.animation.definitePosition)&&this.customData.animation.definitePosition.forEach(e=>{e[0]=-e[0]}),Array.isArray(this.customData.animation.offsetPosition)&&this.customData.animation.offsetPosition.forEach(e=>{e[0]=-e[0]})),super.mirror(t)}getAngle(t){switch(t){case"vanilla":return(Rt[this.direction]||0)+this.angleOffset;case"me":if(this.direction>=1e3)return Math.abs(this.direction%1e3%360-360);case"ne":return(Rt[this.direction]||0)+this.angleOffset;default:return this.direction>=1e3?Math.abs(this.direction%1e3%360-360):(Rt[this.direction]||0)+this.angleOffset}}isChroma(){return Array.isArray(this.customData.color)||typeof this.customData.spawnEffect=="boolean"}isNoodleExtensions(){return Array.isArray(this.customData.animation)||typeof this.customData.disableNoteGravity=="boolean"||typeof this.customData.disableNoteLook=="boolean"||Array.isArray(this.customData.flip)||typeof this.customData.uninteractable=="boolean"||Array.isArray(this.customData.localRotation)||typeof this.customData.noteJumpMovementSpeed=="number"||typeof this.customData.noteJumpStartBeatOffset=="number"||Array.isArray(this.customData.coordinates)||Array.isArray(this.customData.worldRotation)||typeof this.customData.worldRotation=="number"||typeof this.customData.track=="string"}};let Ne=Ft;O(Ne,"default",{b:0,c:0,x:0,y:0,d:0,a:0,customData:()=>({})});const ms="Hitbox Staircase",ps="Check for overlapping post-swing hitbox with note hitbox during swing.",gs=!0,Kn={name:ms,description:ps,type:"note",order:{input:ft.NOTES_HITBOX_STAIR,output:mt.NOTES_HITBOX_STAIR},input:{enabled:gs,params:{},html:ut.create(ms,ps,gs,function(){Kn.input.enabled=this.checked})},output:{html:null},run:Sh};function Dh(i,t,e){for(let n=e,a=t.length;n<a;n++)if(t[n].type==="note"){if(t[n].data.time<i.data.time+.01&&t[n].data.color!==i.data.color)return!0;if(t[n].data.time>i.data.time+.01)return!1}return!1}function wh(i){const{bpm:t}=i.settings,{noteContainer:e}=i.difficulty,n=t.toBeatTime(.15),a={},o={},r={},s={[it.RED]:[],[it.BLUE]:[]},l={[it.RED]:Ne.create()[0],[it.BLUE]:Ne.create({c:1})[0]},c=[];for(let u=0,d=e.length;u<d;u++){if(e[u].type!=="note")continue;const m=e[u];a[m.data.color]?(Ut.next(m,a[m.data.color],t,s[m.data.color])?(r[m.data.color]=m.data.time-a[m.data.color].data.time,m.data.direction!==z.ANY?(l[m.data.color].posX=m.data.posX+je[m.data.direction][0],l[m.data.color].posY=m.data.posY+je[m.data.direction][1]):(l[m.data.color].posX=-1,l[m.data.color].posY=-1),s[m.data.color]=[],o[m.data.color]=m.data.direction):kl(m.data,a[m.data.color].data,o[m.data.color])&&(m.data.direction!==z.ANY?(l[m.data.color].posX=m.data.posX+je[m.data.direction][0],l[m.data.color].posY=m.data.posY+je[m.data.direction][1],o[m.data.color]=m.data.direction):(l[m.data.color].posX=m.data.posX+je[o[m.data.color]][0],l[m.data.color].posY=m.data.posY+je[o[m.data.color]][1])),a[(m.data.color+1)%2]&&m.data.time-a[(m.data.color+1)%2].data.time!==0&&m.data.time-a[(m.data.color+1)%2].data.time<Math.min(n,r[(m.data.color+1)%2])&&m.data.posX===l[(m.data.color+1)%2].posX&&m.data.posY===l[(m.data.color+1)%2].posY&&!Dh(m,e,u)&&c.push(m)):(m.data.direction!==z.ANY?(l[m.data.color].posX=m.data.posX+je[m.data.direction][0],l[m.data.color].posY=m.data.posY+je[m.data.direction][1]):(l[m.data.color].posX=-1,l[m.data.color].posY=-1),o[m.data.color]=m.data.direction),a[m.data.color]=m,s[m.data.color].push(m)}return c.map(u=>u.data.time).filter(function(u,d,m){return!d||u!==m[d-1]})}function Sh(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=wh(i);t.length?Kn.output.html=_t("Hitbox staircase",t,i.settings.bpm):Kn.output.html=null}const _s="Hitbox Reverse Staircase",bs="Check for overlapping pre-swing hitbox with note hitbox during swing.",ys=!0,Qn={name:_s,description:bs,type:"note",order:{input:ft.NOTES_HITBOX_REVERSE_STAIR,output:mt.NOTES_HITBOX_REVERSE_STAIR},input:{enabled:ys,params:{},html:ut.create(_s,bs,ys,function(){Qn.input.enabled=this.checked})},output:{html:null},run:kh},Th=.03414823529,Lh=.03414823529;function Ch(i){const{bpm:t,njs:e}=i.settings,{noteContainer:n}=i.difficulty,a={},o={[it.RED]:[],[it.BLUE]:[]},r=[];for(let s=0,l=n.length;s<l;s++){if(n[s].type!=="note")continue;const c=n[s];a[c.data.color]&&Ut.next(c,a[c.data.color],t,o[c.data.color])&&(o[c.data.color]=[]);for(const u of o[(c.data.color+1)%2])if(u.type==="note"&&u.data.direction!==z.ANY){if(!(t.toRealTime(c.data.time)>t.toRealTime(u.data.time)+.01))continue;const d=u.data.getAngle()%90>15&&u.data.getAngle()%90<75;if(e.value<1.425/(60*(c.data.time-u.data.time)/t.value+(d?Lh:Th))&&Va(c.data,u.data,[[15,1.5]])[1]){r.push(u);break}}a[c.data.color]=c,o[c.data.color].push(c)}return r.map(s=>s.data.time).filter(function(s,l,c){return!l||s!==c[l-1]})}function kh(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=Ch(i);t.length?Qn.output.html=_t("Hitbox reverse Staircase",t,i.settings.bpm):Qn.output.html=null}const vs="Hitbox Inline",Es="Check for overlapping note hitbox for inline note.",Ds=!0,ta={name:vs,description:Es,type:"note",order:{input:ft.NOTES_HITBOX_INLINE,output:mt.NOTES_HITBOX_INLINE},input:{enabled:Ds,params:{},html:ut.create(vs,Es,Ds,function(){ta.input.enabled=this.checked})},output:{html:null},run:Nh},Rh=0;function xh(i){const{bpm:t,njs:e}=i.settings,{noteContainer:n}=i.difficulty,a={},o={[it.RED]:[],[it.BLUE]:[]},r=[];for(let s=0,l=n.length;s<l;s++){if(n[s].type!=="note")continue;const c=n[s];a[c.data.color]&&Ut.next(c,a[c.data.color],t,o[c.data.color])&&(o[c.data.color]=[]);for(const u of o[(c.data.color+1)%2])if(u.type==="note"&&e.value<1.425/(60*(c.data.time-u.data.time)/t.value+Rh)&&c.data.isInline(u.data)){r.push(c);break}a[c.data.color]=c,o[c.data.color].push(c)}return r.map(s=>s.data.time).filter(function(s,l,c){return!l||s!==c[l-1]})}function Nh(i){const t=xh(i);t.length?ta.output.html=_t("Hitbox inline",t,i.settings.bpm):ta.output.html=null}const ws="Hitbox Path",Ss="Check for overlapping pre-swing note hitbox at same time.",Ts=!0,ea={name:ws,description:Ss,type:"note",order:{input:ft.NOTES_HITBOX_PATH,output:mt.NOTES_HITBOX_PATH},input:{enabled:Ts,params:{},html:ut.create(ws,Ss,Ts,function(){ea.input.enabled=this.checked})},output:{html:null},run:Ah};function Ih(i){const{bpm:t}=i.settings,e=i.difficulty.noteContainer.filter(o=>o.type==="bomb"||o.type==="note"),n=[];let a=0;for(let o=0,r=e.length;o<r;o++){const s=e[o];if(!(s.type==="bomb"||s.type==="slider"||s.type==="burstSlider"||t.toRealTime(s.data.time)<a+.01))for(let l=o+1;l<r;l++){const c=e[l];if(t.toRealTime(c.data.time)>t.toRealTime(s.data.time)+.01)break;c.type==="note"&&s.data.color===c.data.color||((s.data.isHorizontal(c.data)||s.data.isVertical(c.data))&&Va(s.data,c.data,[[45,1],[15,2]]).some(u=>u)||s.data.isDiagonal(c.data)&&Va(s.data,c.data,[[45,1],[15,1.5]]).some(u=>u))&&(n.push(s.data),a=t.toRealTime(s.data.time))}}return n.map(o=>o.time).filter(function(o,r,s){return!r||o!==s[r-1]})}function Ah(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=Ih(i);t.length?ea.output.html=_t("Hitbox path",t,i.settings.bpm):ea.output.html=null}const Ls="Improper Arc",Cs="Check for correct use of arc.",ks=!0,ia={name:Ls,description:Cs,type:"note",order:{input:ft.NOTES_IMPROPER_ARC,output:mt.NOTES_IMPROPER_ARC},input:{enabled:ks,params:{},html:ut.create(Ls,Cs,ks,function(){ia.input.enabled=this.checked})},output:{html:null},run:$h};function Bh(i){const t=[...i.difficulty.noteContainer].sort((n,a)=>n.type!=="slider"?1:a.type!=="slider"?-1:0).sort((n,a)=>n.data.time-a.data.time),e=[];for(let n=0,a=!0,o=t.length;n<o;n++){const r=t[n];if(r.type==="slider"){a=!0;for(let s=n,l=!1;s<o;s++){const c=t[s];if(c.type==="note"&&r.data.posX===c.data.posX&&r.data.posY===c.data.posY&&c.data.time<=r.data.time+.001&&r.data.color===c.data.color&&(c.data.direction!==z.ANY?r.data.direction===c.data.direction:!0)){for(let u=s;u<o;u++){const d=t[s];if(d.type==="bomb"&&r.data.posX===d.data.posX&&r.data.posY===d.data.posY&&d.data.time<=r.data.time+.001){l=!0;break}if(!(d.type!=="note"||d.data.time<r.data.tailTime)){if(r.data.posX===c.data.posX&&r.data.posY===c.data.posY&&c.data.time<=r.data.time+.001&&(r.data.color!==c.data.color||(c.data.direction!==z.ANY?r.data.direction!==c.data.direction:!0))){l=!0;break}if(c.data.time>r.data.tailTime+.001)break}}a=l||!1;break}if(c.type==="bomb"&&r.data.posX===c.data.posX&&r.data.posY===c.data.posY&&c.data.time<=r.data.time+.001||c.data.time>r.data.time+.001)break}a&&e.push(r)}}return e.map(n=>n.data.time).filter(function(n,a,o){return!a||n!==o[a-1]})}function $h(i){const t=Bh(i);t.length?ia.output.html=_t("Improper arc",t,i.settings.bpm):ia.output.html=null}const Rs="Improper Chain",xs="Check for correct use of chain.",Ns=!0,na={name:Rs,description:xs,type:"note",order:{input:ft.NOTES_IMPROPER_CHAIN,output:mt.NOTES_IMPROPER_CHAIN},input:{enabled:Ns,params:{},html:ut.create(Rs,xs,Ns,function(){na.input.enabled=this.checked})},output:{html:null},run:Mh};function Oh(i){const t=[...i.difficulty.noteContainer].sort((n,a)=>n.type!=="burstSlider"?1:a.type!=="burstSlider"?-1:0).sort((n,a)=>n.data.time-a.data.time),e=[];for(let n=0,a=!0,o=t.length;n<o;n++){const r=t[n];if(r.type==="burstSlider"){a=!0;for(let s=n;s<o;s++){const l=t[s];if(l.type==="note"&&r.data.posX===l.data.posX&&r.data.posY===l.data.posY&&l.data.time<=r.data.time+.001&&r.data.color===l.data.color&&(l.data.direction!==z.ANY?r.data.direction===l.data.direction:!0)){a=!1;break}if(l.type==="bomb"&&r.data.posX===l.data.posX&&r.data.posY===l.data.posY&&l.data.time<=r.data.time+.001||l.data.time>r.data.time+.001)break}a&&e.push(r)}}return e.map(n=>n.data.time).filter(function(n,a,o){return!a||n!==o[a-1]})}function Mh(i){const t=Oh(i);t.length?na.output.html=_t("Improper chain",t,i.settings.bpm):na.output.html=null}const Is="Improper Window Snap",As="Check for slanted window snap timing.",Bs=!0,aa={name:Is,description:As,type:"note",order:{input:ft.NOTES_IMPROPER_WINDOW,output:mt.NOTES_IMPROPER_WINDOW},input:{enabled:Bs,params:{},html:ut.create(Is,As,Bs,function(){aa.input.enabled=this.checked})},output:{html:null},run:Fh};function Ph(i){const{bpm:t}=i.settings,{noteContainer:e}=i.difficulty,n={},a={[it.RED]:[],[it.BLUE]:[]},o=[];for(let r=0,s=e.length;r<s;r++){if(e[r].type!=="note")continue;const l=e[r];n[l.data.color]?Ut.next(l,n[l.data.color],t,a[l.data.color])?(n[l.data.color]=l,a[l.data.color]=[]):l.data.isSlantedWindow(n[l.data.color].data)&&l.data.time-n[l.data.color].data.time>=.001&&l.data.direction===n[l.data.color].data.direction&&l.data.direction!==z.ANY&&n[l.data.color].data.direction!==z.ANY&&o.push(n[l.data.color]):n[l.data.color]=l,a[l.data.color].push(l)}return o.map(r=>r.data.time).filter(function(r,s,l){return!s||r!==l[s-1]})}function Fh(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=Ph(i);t.length?aa.output.html=_t("Improper window snap",t,i.settings.bpm):aa.output.html=null}const yn={create:(i,t,e,n,...a)=>{const o=document.createElement(e);o.className=n;const r=document.createElement("select");r.className="input-toggle",r.id=i,a.forEach(l=>{const c=document.createElement("option");c.textContent=l.text,c.value=l.value,r.append(c)});const s=document.createElement("label");return s.htmlFor=i,s.innerHTML=`<span>${t}</span>`,o.append(s),o.append(r),o}};var rc=(i=>(i.forehand="backhand",i.backhand="forehand",i))(rc||{});const Ln={[it.RED]:{forehand:[z.DOWN,z.RIGHT,z.DOWN_LEFT,z.DOWN_RIGHT],backhand:[z.UP,z.LEFT,z.UP_LEFT,z.UP_RIGHT]},[it.BLUE]:{forehand:[z.DOWN,z.LEFT,z.DOWN_LEFT,z.DOWN_RIGHT],backhand:[z.UP,z.RIGHT,z.UP_LEFT,z.UP_RIGHT]}},hi={[it.RED]:[0,0,90,90,45,-45,45,-45],[it.BLUE]:[0,0,-90,-90,-45,45,-45,45]},$s={0:{forehand:[180,0,-90,90,-135,135,-45,45],backhand:[0,180,90,-90,45,-45,135,-135]},1:{forehand:[-180,0,-90,90,-135,135,-45,45],backhand:[0,-180,90,-90,45,-45,135,-135]}},xi=class{constructor(t,e,n,a,o,r){O(this,"state");O(this,"color");O(this,"rotation");O(this,"position");O(this,"warningThreshold");O(this,"errorThreshold");O(this,"allowedRotation");this.color=e,this.warningThreshold=n,this.errorThreshold=a,this.allowedRotation=o,r&&r!=="neutral"?(this.state=r,this.rotation=0):(this.state=this.predictStartState(t,e),this.rotation=this.predictStartRotation(t,e)),this.position=this.predictStartPosition(t,e)}check(t,e){if(this.state==="neutral")return"none";if(!t.length)throw new Error("no notes were given");const n=t[0].data.time,a=this.color;let o=this.state,r=this.rotation;e.forEach(u=>{u.data.time-.001>n||(u.data.posY===At.BOTTOM&&u.data.posX===(a?ot.MIDDLE_RIGHT:ot.MIDDLE_LEFT)&&(o="backhand",r=0),u.data.posY===At.TOP&&u.data.posX===(a?ot.MIDDLE_RIGHT:ot.MIDDLE_LEFT)&&(o="forehand",r=0))});let s,l=z.ANY;for(const u of t)u.type==="note"&&(u.data.direction!==z.ANY&&(l=u.data.direction),s&&l===z.ANY&&(l=as(u.data,s.data)),s=u);if(l===z.ANY)return"none";const c=$s[a][rc[o]][l];return(r>c?r-c:c-r)>180||c<xi.CONSTRAINT_ROTATION[a][0]+this.errorThreshold||c>xi.CONSTRAINT_ROTATION[a][1]-this.errorThreshold?"error":c<xi.CONSTRAINT_ROTATION[a][0]+this.warningThreshold||c>xi.CONSTRAINT_ROTATION[a][1]-this.warningThreshold||(r>c?r-c:c-r)>this.allowedRotation?"warning":"none"}next(t,e){if(this.check(t,e)!=="error")switch(this.state){case"forehand":{this.state="backhand";break}case"backhand":{this.state="forehand";break}case"neutral":{for(let s=0;s<t.length;s++){if(t[s].type!=="note")continue;const l=t[s];if(Ln[l.data.color].forehand.includes(l.data.direction)){this.state="backhand";break}if(Ln[l.data.color].backhand.includes(l.data.direction)){this.state="forehand";break}this.state==="neutral"&&l.data.direction===z.ANY&&(l.data.posY===0&&(this.state="backhand"),l.data.posY>0&&(this.state="forehand"))}break}}if(this.state==="neutral")throw new Error("parity unexpected input");const n=t[0].data.time,a=this.color;e.forEach(s=>{s.data.time-.001>n||(s.data.posY===At.BOTTOM&&s.data.posX===(a?ot.MIDDLE_RIGHT:ot.MIDDLE_LEFT)&&(this.state="forehand",this.rotation=0),s.data.posY===At.TOP&&s.data.posX===(a?ot.MIDDLE_RIGHT:ot.MIDDLE_LEFT)&&(this.state="backhand",this.rotation=0))});let o,r=z.ANY;for(const s of t)s.type==="note"&&(s.data.direction!==z.ANY&&(r=s.data.direction),o&&r===z.ANY&&(r=as(s.data,o.data)),o=s);r!==z.ANY&&(this.rotation=$s[this.color][this.state][r])}predictStartState(t,e){let n="neutral";for(let a=0,o=t.length;a<o;a++){if(t[a].type==="bomb"&&(t[a].data.posY===At.BOTTOM&&(t[a].data.posX===e?ot.MIDDLE_RIGHT:ot.MIDDLE_LEFT)&&(n="backhand"),t[a].data.posY===At.TOP&&(t[a].data.posX===e?ot.MIDDLE_RIGHT:ot.MIDDLE_LEFT)&&(n="forehand")),t[a].type!=="note")continue;let r=t[a];if(r.data.color!==Math.abs(e-1)&&r.data.color===e){if(n!=="neutral")break;const s=r.data.time;for(let l=a;l<t.length&&!(t[l].data.time>r.data.time+.001&&s<r.data.time+.001);l++){if(r=t[l],Ln[r.data.color].forehand.includes(r.data.direction))return"backhand";if(Ln[r.data.color].backhand.includes(r.data.direction))return"forehand";n==="neutral"&&r.data.direction===z.ANY&&(r.data.posY===At.BOTTOM&&(n="backhand"),r.data.posY>At.BOTTOM&&(n="forehand"))}break}}return n}predictStartRotation(t,e){let n=0;for(let a=0,o=t.length;a<o;a++){if(t[a].type!=="note")continue;let r=t[a];if(r.data.color===e&&r.data.color===e){const s=r.data.time;for(let l=a;l<t.length&&!(t[l].data.time>r.data.time+.001&&s<r.data.time+.001);l++){if(r=t[l],r.data.direction!==z.ANY)return hi[r.data.color][r.data.direction];r.data.direction===z.ANY&&(r.data.posY===At.BOTTOM&&(r.data.posX===ot.LEFT&&(n=hi[r.data.color][6]),r.data.posX===ot.RIGHT&&(n=hi[r.data.color][7])),r.data.posY===At.MIDDLE&&(r.data.posX===ot.LEFT&&(n=hi[r.data.color][2]),r.data.posX===ot.RIGHT&&(n=hi[r.data.color][3])),r.data.posY===At.BOTTOM&&(r.data.posX===ot.LEFT&&(n=hi[r.data.color][4]),r.data.posX===ot.RIGHT&&(n=hi[r.data.color][5])))}break}}return n}predictStartPosition(t,e){return e?[-.5,1]:[.5,1]}};let ln=xi;O(ln,"CONSTRAINT_ROTATION",[[-155,195],[-195,155]]);const sc="Parity Check",oc="Perform parity check.",lc=!1,cc=document.createElement("div");yn.create("input__tools-parity-rotation","Wrist rotation type: ","div","",{text:"Normal",value:"90"},{text:"Extended",value:"135"},{text:"Squid",value:"180"});yn.create("input__tools-parity-left","Left hand parity: ","div","",{text:"Auto",value:"auto"},{text:"Forehand",value:"forehand"},{text:"Backhand",value:"backhand"});yn.create("input__tools-parity-right","Right hand parity: ","div","",{text:"Auto",value:"auto"},{text:"Forehand",value:"forehand"},{text:"Backhand",value:"backhand"});cc.appendChild(ut.create(sc+" (EXPERIMENTAL)",oc,lc,function(){pn.input.enabled=this.checked}));const pn={name:sc,description:oc,type:"note",order:{input:ft.NOTES_PARITY,output:mt.NOTES_PARITY},input:{enabled:lc,params:{warningThres:90,errorThres:45,allowedRot:90},html:cc},output:{html:null},run:zh};function Hh(i){const{bpm:t}=i.settings,{noteContainer:e}=i.difficulty,{warningThres:n,errorThres:a,allowedRot:o}=pn.input.params,r={},s={[it.RED]:[],[it.BLUE]:[]},l={[it.RED]:[],[it.BLUE]:[]},c={[it.RED]:[],[it.BLUE]:[]},u={[it.RED]:new ln(e,0,n,a,o),[it.BLUE]:new ln(e,1,n,a,o)},d={warning:[],error:[]};for(let m=0,h=e.length;m<h;m++){const p=e[m];if(p.type==="note"&&r[p.data.color]&&Ut.next(p,r[p.data.color],t,s[p.data.color])){switch(u[p.data.color].check(s[p.data.color],c[p.data.color])){case"warning":{d.warning.push(s[p.data.color][0].data.time);break}case"error":{d.error.push(s[p.data.color][0].data.time);break}}u[p.data.color].next(s[p.data.color],c[p.data.color]),c[p.data.color]=l[p.data.color],l[p.data.color]=[],s[p.data.color]=[]}p.type==="bomb"&&(l[it.RED].push(p),l[it.BLUE].push(p)),p.type==="note"&&(r[p.data.color]=p,s[p.data.color].push(p))}for(let m=0;m<2;m++)if(r[m])switch(u[m].check(s[m],l[m])){case"warning":{d.warning.push(s[m][0].data.time);break}case"error":{d.error.push(s[m][0].data.time);break}}return d}function zh(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=Hh(i);t.warning=t.warning.filter(function(n,a,o){return!a||n!==o[a-1]}).sort((n,a)=>n-a),t.error=t.error.filter(function(n,a,o){return!a||n!==o[a-1]}).sort((n,a)=>n-a);const e=[];if(t.warning.length&&e.push(_t("Parity warning",t.warning,i.settings.bpm)),t.error.length&&e.push(_t("Parity error",t.error,i.settings.bpm)),e.length){const n=document.createElement("div");e.forEach(a=>n.append(a)),pn.output.html=n}else pn.output.html=null}const Os="Double-directional",Ms="Check double-directional note swing (this may not mean parity break).",Ps=!0,ra={name:Os,description:Ms,type:"note",order:{input:ft.NOTES_DOUBLE_DIRECTIONAL,output:mt.NOTES_DOUBLE_DIRECTIONAL},input:{enabled:Ps,params:{},html:ut.create(Os,Ms,Ps,function(){ra.input.enabled=this.checked})},output:{html:null},run:Uh};function Xh(i,t){const{bpm:e}=i,n=t.noteContainer,a={},o={},r={},s={[it.RED]:[],[it.BLUE]:[]},l=[];for(let c=0,u=n.length;c<u;c++){const d=n[c];d.type==="note"&&a[d.data.color]?Ut.next(d,a[d.data.color],e,s[d.data.color])?(r[d.data.color]&&(r[d.data.color]=null,o[d.data.color]=(o[d.data.color]+180)%360),mn(d.data,o[d.data.color],45,!0)&&l.push(d.data),d.data.direction===z.ANY?r[d.data.color]=d.data:o[d.data.color]=d.data.getAngle(),s[d.data.color]=[]):(r[d.data.color]&&mn(d.data,o[d.data.color],45,!0)&&(l.push(d.data),r[d.data.color]=null,o[d.data.color]=d.data.getAngle()),d.data.direction!==z.ANY&&(r[d.data.color]=null,o[d.data.color]=d.data.getAngle())):d.type==="note"&&(o[d.data.color]=d.data.getAngle()),d.type==="note"&&(a[d.data.color]=d,s[d.data.color].push(d)),d.type==="bomb"&&(d.data.posY===At.BOTTOM&&(d.data.posX===ot.MIDDLE_LEFT&&(o[it.RED]=Rt[z.UP],r[it.RED]=null),d.data.posX===ot.MIDDLE_RIGHT&&(o[it.BLUE]=Rt[z.UP],r[it.BLUE]=null)),d.data.posY===At.TOP&&(d.data.posX===ot.MIDDLE_LEFT&&(o[it.RED]=Rt[z.DOWN],r[it.RED]=null),d.data.posX===ot.MIDDLE_RIGHT&&(o[it.BLUE]=Rt[z.DOWN],r[it.BLUE]=null)))}return l.map(c=>c.time).filter(function(c,u,d){return!u||c!==d[u-1]})}function Uh(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=Xh(i.settings,i.difficulty);t.length?ra.output.html=_t("Double-directional",t,i.settings.bpm):ra.output.html=null}const uc="Vision Block",hc="Check for vision block caused by center note.",dc=!0,fc=.1,mc=.5;let qt;const Fs={Easy:{min:.025,max:1.2},Normal:{min:.05,max:1},Hard:{min:.08,max:.75},Expert:{min:.1,max:.625},ExpertPlus:{min:.1,max:.5}},jt=document.createElement("div"),Li=document.createElement("input"),br=document.createElement("label"),si=document.createElement("input"),yr=document.createElement("label"),oi=document.createElement("input"),vr=document.createElement("label"),Xe=document.createElement("input"),Er=document.createElement("label"),Ae=document.createElement("input"),Dr=document.createElement("label"),Ee=document.createElement("input"),wr=document.createElement("label");br.textContent=" VB time specific ";br.htmlFor="input__tools-vb-time-check";Li.id="input__tools-vb-time-check";Li.className="input-toggle";Li.type="radio";Li.name="input__tools-vb-spec";Li.value="time";Li.addEventListener("change",pc);yr.textContent=" VB difficulty specific ";yr.htmlFor="input__tools-vb-diff-check";si.id="input__tools-vb-diff-check";si.className="input-toggle";si.type="radio";si.checked=!0;si.name="input__tools-vb-spec";si.value="difficulty";si.addEventListener("change",pc);vr.textContent="min time (ms): ";vr.htmlFor="input__tools-vb-min-time";oi.id="input__tools-vb-min-time";oi.className="input-toggle input--small";oi.type="number";oi.min="0";oi.value=A(fc*1e3,1).toString();oi.addEventListener("change",Yh);Er.textContent=" (beat): ";Er.htmlFor="input__tools-vb-min-beat";Xe.id="input__tools-vb-min-beat";Xe.className="input-toggle input--small";Xe.type="number";Xe.min="0";Xe.step="0.1";Xe.addEventListener("change",Gh);Dr.textContent="max time (ms): ";Dr.htmlFor="input__tools-vb-max-time";Ae.id="input__tools-vb-max-time";Ae.className="input-toggle input--small";Ae.type="number";Ae.min="0";Ae.value=A(mc*1e3,1).toString();Ae.addEventListener("change",Wh);wr.textContent=" (beat): ";wr.htmlFor="input__tools-vb-max-beat";Ee.id="input__tools-vb-max-beat";Ee.className="input-toggle input--small";Ee.type="number";Ee.min="0";Ee.step="0.1";Ee.addEventListener("change",Vh);jt.appendChild(ut.create(uc,hc,dc,function(){yt.input.enabled=this.checked}));jt.appendChild(Li);jt.appendChild(br);jt.appendChild(si);jt.appendChild(yr);jt.appendChild(document.createElement("br"));jt.appendChild(vr);jt.appendChild(oi);jt.appendChild(Er);jt.appendChild(Xe);jt.appendChild(document.createElement("br"));jt.appendChild(Dr);jt.appendChild(Ae);jt.appendChild(wr);jt.appendChild(Ee);const yt={name:uc,description:hc,type:"note",order:{input:ft.NOTES_VISION_BLOCK,output:mt.NOTES_VISION_BLOCK},input:{enabled:dc,params:{specific:"difficulty",minTime:fc,maxTime:mc},html:jt,adjustTime:jh},output:{html:null},run:qh};function jh(i){qt=i,Xe.value=A(qt.toBeatTime(yt.input.params.minTime),2).toString(),Ee.value=A(qt.toBeatTime(yt.input.params.maxTime),2).toString()}function pc(){yt.input.params.specific=this.value}function Yh(){yt.input.params.minTime=Math.abs(parseFloat(this.value))/1e3,this.value=A(yt.input.params.minTime*1e3,1).toString(),qt&&(Xe.value=A(qt.toBeatTime(yt.input.params.minTime),2).toString(),yt.input.params.minTime>yt.input.params.maxTime&&(yt.input.params.maxTime=yt.input.params.minTime,Ae.value=A(yt.input.params.maxTime*1e3,1).toString(),Ee.value=A(qt.toBeatTime(yt.input.params.maxTime),2).toString()))}function Gh(){if(!qt){this.value="0";return}const i=Math.abs(parseFloat(this.value))||1;yt.input.params.minTime=qt.toRealTime(i),oi.value=A(yt.input.params.minTime*1e3,1).toString(),this.value=A(i,2).toString(),yt.input.params.minTime>yt.input.params.maxTime&&(yt.input.params.maxTime=yt.input.params.minTime,Ae.value=A(yt.input.params.maxTime*1e3,1).toString(),Ee.value=A(qt.toBeatTime(yt.input.params.maxTime),2).toString())}function Wh(){yt.input.params.maxTime=Math.abs(parseFloat(this.value))/1e3,this.value=A(yt.input.params.maxTime*1e3,1).toString(),qt&&(Ee.value=A(qt.toBeatTime(yt.input.params.maxTime),2).toString())}function Vh(){if(!qt){this.value="0";return}const i=Math.abs(parseFloat(this.value))||1;yt.input.params.maxTime=qt.toRealTime(i),Ae.value=A(yt.input.params.maxTime*1e3,1).toString(),this.value=A(i,2).toString()}function Jh(i){const{bpm:t,njs:e}=i.settings,n=i.difficulty.data.getNoteContainer().filter(m=>m.type!=="slider"),{minTime:a,maxTime:o,specific:r}=yt.input.params,s=r==="time"?t.toBeatTime(a):t.toBeatTime(Fs[i.difficulty.difficulty].min),l=r==="time"?t.toBeatTime(o):Math.min(e.hjd,t.toBeatTime(Fs[i.difficulty.difficulty].max));let c=null,u=null;const d=[];for(let m=0,h=n.length;m<h;m++){const p=n[m];c&&(p.data.time-c.data.time>=s&&p.data.time-c.data.time<=l?p.data.posX<ot.MIDDLE_RIGHT&&d.push(p):p.data.time-c.data.time>l&&(c=null)),u&&(p.data.time-u.data.time>=s&&p.data.time-u.data.time<=l?p.data.posX>ot.MIDDLE_LEFT&&d.push(p):p.data.time-u.data.time>l&&(u=null)),p.data.posY===At.MIDDLE&&p.data.posX===ot.MIDDLE_LEFT&&(c=p),p.data.posY===At.MIDDLE&&p.data.posX===ot.MIDDLE_RIGHT&&(u=p)}return d.map(m=>m.data.time).filter(function(m,h,p){return!h||m!==p[h-1]})}function qh(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=Jh(i);t.length?yt.output.html=_t("Vision block",t,i.settings.bpm):yt.output.html=null}const Hs="Stacked Note",zs="Look for stacked note.",Xs=!0,sa={name:Hs,description:zs,type:"note",order:{input:ft.NOTES_STACKED_NOTE,output:mt.NOTES_STACKED_NOTE},input:{enabled:Xs,params:{},html:ut.create(Hs,zs,Xs,function(){sa.input.enabled=this.checked})},output:{html:null},run:Qh};function Zh(i,t){const{bpm:e}=i,{colorNotes:n}=t.data,a=[];let o=0;for(let r=0,s=n.length;r<s;r++)if(!(e.toRealTime(n[r].time)<o+.01))for(let l=r+1;l<s&&!(e.toRealTime(n[l].time)>e.toRealTime(n[r].time)+.01);l++)n[l].isInline(n[r])&&(a.push(n[r]),o=e.toRealTime(n[r].time));return a.map(r=>r.time).filter(function(r,s,l){return!s||r!==l[s-1]})}function Kh(i,t){const{bpm:e,njs:n}=i,{bombNotes:a}=t.data,o=[];for(let r=0,s=a.length;r<s;r++)for(let l=r+1;l<s&&!(e.toRealTime(a[l].time)>e.toRealTime(a[r].time)+1);l++)a[r].isInline(a[l])&&(n.value<e.value/(120*(a[l].time-a[r].time))||e.toRealTime(a[l].time)<e.toRealTime(a[r].time)+.02)&&o.push(a[r]);return o.map(r=>r.time).filter(function(r,s,l){return!s||r!==l[s-1]})}function Qh(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=Zh(i.settings,i.difficulty),e=Kh(i.settings,i.difficulty),n=[];if(t.length&&n.push(_t("Stacked note",t,i.settings.bpm)),e.length&&n.push(_t("Stacked bomb",e,i.settings.bpm)),n.length){const a=document.createElement("div");n.forEach(o=>a.append(o)),sa.output.html=a}else sa.output.html=null}const Us="Color Check",js="Compare note color with other colored note and the arrow on itself.",Ys=!0,Gs=[1,1,1],Ws={1:"Indistinguishable",5:"Hardly perceivable",10:"Close apparent",20:"Mildly similar",40:"Different",90:"Discernible",100:"Opposite"};function Vs(i,t){var a;let e=(a=Object.keys(i).find(o=>parseFloat(o)>=t))!=null?a:"100",n=parseFloat(e);return i[n]}const oa={name:Us,description:js,type:"note",order:{input:ft.NOTES_COLOR_CHECK,output:mt.NOTES_COLOR_CHECK},input:{enabled:Ys,params:{},html:ut.create(Us+" (EXPERIMENTAL)",js,Ys,function(){oa.input.enabled=this.checked})},output:{html:null},run:id};function td(i){var n,a,o,r,s,l,c,u;const t=(r=(a=(n=i.difficulty)==null?void 0:n.info._customData)==null?void 0:a._colorLeft)!=null?r:ge[(o=pe[i.info._environmentName])!=null?o:"The First"]._colorLeft,e=(u=(l=(s=i.difficulty)==null?void 0:s.info._customData)==null?void 0:l._colorRight)!=null?u:ge[(c=pe[i.info._environmentName])!=null?c:"The First"]._colorRight;return t&&e?Ca(Wn(t),Wn(e)):100}function ed(i){var o,r,s,l,c,u,d,m;let t=100,e=100;const n=(l=(r=(o=i.difficulty)==null?void 0:o.info._customData)==null?void 0:r._colorLeft)!=null?l:ge[(s=pe[i.info._environmentName])!=null?s:"The First"]._colorLeft,a=(m=(u=(c=i.difficulty)==null?void 0:c.info._customData)==null?void 0:u._colorRight)!=null?m:ge[(d=pe[i.info._environmentName])!=null?d:"The First"]._colorRight;return n&&(t=Ca(Gs,Wn(n))),a&&(e=Ca(Gs,Wn(a))),Math.min(t,e)}function id(i){var a,o,r,s;if(!((o=(a=i.difficulty)==null?void 0:a.info._customData)!=null&&o._colorLeft)&&!((s=(r=i.difficulty)==null?void 0:r.info._customData)!=null&&s._colorRight))return;const t=td(i),e=ed(i),n=[];if(t<=20&&n.push(pt(`${Vs(Ws,t)} note color (dE${A(t,1)})`,"suggest change to better differentiate between 2 note colour")),e<=20&&n.push(pt(`${Vs(Ws,e)} arrow note color (dE${A(e,1)})`,"may be difficult to see the arrow")),n.length){const l=document.createElement("div");n.forEach(c=>l.append(c)),oa.output.html=l}else oa.output.html=null}const Js=Object.freeze(Object.defineProperty({__proto__:null,effectiveBPM:Wt,acceptablePrec:wi,varySwing:Zn,slowSlider:le,inlineAngle:ye,shradoAngle:Jt,speedPause:ve,hitboxStair:Kn,hitboxReverseStair:Qn,hitboxInline:ta,hitboxPath:ea,improperArc:ia,improperChain:na,improperWindow:aa,parity:pn,doubleDirectional:ra,visionBlock:yt,stackedNote:sa,colorCheck:oa},Symbol.toStringTag,{value:"Module"}));class gc extends ya{setDuration(t){return this.duration=t,this}setWidth(t){return this.width=t,this}setHeight(t){return this.height=t,this}mirror(){return this.posX=ba-1-(this.posX+this.width-1),this}getPosition(){return[(this.posX<=-1e3?this.posX/1e3:this.posX>=1e3?this.posX/1e3:this.posX)-2,(this.posY<=-1e3?this.posY/1e3:this.posY>=1e3?this.posY/1e3:this.posY)-.5]}isInteractive(){return this.posX<0&&this.width>1-this.posX||this.posX===0&&this.width>1||this.posX===1||this.posX===2}isLonger(t,e=0){return this.time+this.duration>t.time+t.duration+e}hasZero(){return this.duration===0||this.width===0||this.height===0}hasNegative(){return this.posY<0||this.duration<0||this.width<0||this.height<0}isMappingExtensions(){return this.posY>2||this.posX<=-1e3||this.posX>=1e3}isValid(){return!this.isMappingExtensions()&&!this.hasZero()&&!this.hasNegative()}}const Ht=class extends gc{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,o,r,s,l,c,u;return e.push(new this({b:(a=n.b)!=null?a:Ht.default.b,x:(o=n.x)!=null?o:Ht.default.x,y:(r=n.y)!=null?r:Ht.default.y,d:(s=n.d)!=null?s:Ht.default.d,w:(l=n.w)!=null?l:Ht.default.w,h:(c=n.h)!=null?c:Ht.default.h,customData:(u=n.customData)!=null?u:Ht.default.customData()}))}),e.length?e:[new this({b:Ht.default.b,x:Ht.default.x,y:Ht.default.y,d:Ht.default.d,w:Ht.default.w,h:Ht.default.h,customData:Ht.default.customData()})]}toJSON(){return{b:this.time,x:this.posX,y:this.posY,d:this.duration,w:this.width,h:this.height,customData:vt(this.customData)}}get time(){return this.data.b}set time(t){this.data.b=t}get posX(){return this.data.x}set posX(t){this.data.x=t}get posY(){return this.data.y}set posY(t){this.data.y=t}get duration(){return this.data.d}set duration(t){this.data.d=t}get width(){return this.data.w}set width(t){this.data.w=t}get height(){return this.data.h}set height(t){this.data.h=t}get customData(){return this.data.customData}set customData(t){this.data.customData=t}setCustomData(t){return this.customData=t,this}addCustomData(t){return this.customData={...this.customData,object:t},this}mirror(){var e,n;const t=(n=(e=this.customData.size)==null?void 0:e[0])!=null?n:this.width;return this.customData.coordinates&&(this.customData.coordinates[0]=-1-this.customData.coordinates[0]),this.customData.animation&&(Array.isArray(this.customData.animation.definitePosition)&&this.customData.animation.definitePosition.forEach(a=>{a[0]=-a[0]-(this.posX+t-1)}),Array.isArray(this.customData.animation.offsetPosition)&&this.customData.animation.offsetPosition.forEach(a=>{a[0]=-a[0]-(this.posX+t-1)})),super.mirror()}getPosition(){return this.customData.coordinates?[this.customData.coordinates[0],this.customData.coordinates[1]]:super.getPosition()}isChroma(){return Array.isArray(this.customData.color)}isNoodleExtensions(){return Array.isArray(this.customData.animation)||typeof this.customData.uninteractable=="boolean"||Array.isArray(this.customData.localRotation)||typeof this.customData.noteJumpMovementSpeed=="number"||typeof this.customData.noteJumpStartBeatOffset=="number"||Array.isArray(this.customData.coordinates)||Array.isArray(this.customData.worldRotation)||Array.isArray(this.customData.size)||typeof this.customData.track=="string"}};let Vt=Ht;O(Vt,"default",{b:0,x:0,y:0,d:1,w:1,h:1,customData:()=>({})});const qs="<15ms Obstacle",Zs=`Look for obstacle with inadequate duration.
This causes player to not take damage when in collision with obstacle.`,Ks=!0,gn={name:qs,description:Zs,type:"obstacle",order:{input:ft.OBSTACLES_SHORT,output:mt.OBSTACLES_SHORT},input:{enabled:Ks,params:{minDur:.015},html:ut.create(qs,Zs,Ks,function(){gn.input.enabled=this.checked})},output:{html:null},run:ad};function nd(i){const{obstacles:t}=i.difficulty.data,{bpm:e}=i.settings,{minDur:n}=gn.input.params,a=e.toBeatTime(n),o=[];let r=Vt.create()[0],s=Vt.create()[0],l=Vt.create()[0],c=Vt.create()[0];return t.forEach(u=>{u.posY===At.BOTTOM&&u.height>2&&u.duration>0?u.width>2||u.width>1&&u.posX===1?(u.isLonger(r)&&(u.duration<a&&o.push(u),r=u),u.isLonger(s)&&(u.duration<a&&o.push(u),s=u)):u.width===2?u.posX===ot.LEFT?u.isLonger(r)&&(u.duration<a&&o.push(u),r=u):u.posX===ot.MIDDLE_RIGHT&&u.isLonger(s)&&(u.duration<a&&o.push(u),s=u):u.width===1&&(u.posX===ot.MIDDLE_LEFT?u.isLonger(r)&&(u.duration<a&&o.push(u),r=u):u.posX===ot.MIDDLE_RIGHT&&u.isLonger(s)&&(u.duration<a&&o.push(u),s=u)):u.posY===At.TOP&&u.height>2&&u.duration>0&&(u.width>2||u.width>1&&u.posX===ot.MIDDLE_LEFT?(u.isLonger(l)&&(u.duration<a&&u.isLonger(r,a)&&u.isLonger(l,a)&&o.push(u),l=u),u.isLonger(c)&&(u.duration<a&&u.isLonger(s,a)&&u.isLonger(c,a)&&o.push(u),c=u)):u.width===2?u.posX===ot.LEFT?u.isLonger(l)&&(u.duration<a&&u.isLonger(r,a)&&u.isLonger(l,a)&&o.push(u),l=u):u.posX===ot.MIDDLE_RIGHT&&u.isLonger(c)&&(u.duration<a&&u.isLonger(s,a)&&u.isLonger(c,a)&&o.push(u),c=u):u.width===1&&(u.posX===ot.MIDDLE_LEFT?u.isLonger(l)&&(u.duration<a&&u.isLonger(r,a)&&u.isLonger(l,a)&&o.push(u),l=u):u.posX===ot.MIDDLE_RIGHT&&u.isLonger(c)&&(u.duration<a&&u.isLonger(s,a)&&u.isLonger(c,a)&&o.push(u),c=u)))}),o.map(u=>u.time).filter(function(u,d,m){return!d||u!==m[d-1]})}function ad(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=nd(i);t.length?gn.output.html=_t("<15ms obstacle",t,i.settings.bpm):gn.output.html=null}const _c="2-wide Center Obstacle",bc="Look for 2-wide center obstacle including obstacles that are relatively close to each other.",yc=!0,vc=.25;let Gi;const Ki=document.createElement("div"),li=document.createElement("input"),Sr=document.createElement("label"),Ue=document.createElement("input"),Tr=document.createElement("label");Sr.textContent="recovery time (ms): ";Sr.htmlFor="input__tools-2wide-wall-time";li.id="input__tools-2wide-wall-time";li.className="input-toggle input--small";li.type="number";li.min="0";li.value=A(vc*1e3,1).toString();li.addEventListener("change",sd);Tr.textContent=" (beat): ";Tr.htmlFor="input__tools-2wide-wall-beat";Ue.id="input__tools-2wide-wall-beat";Ue.className="input-toggle input--small";Ue.type="number";Ue.min="0";Ue.step="0.1";Ue.addEventListener("change",od);Ki.appendChild(ut.create(_c,bc,yc,function(){ce.input.enabled=this.checked}));Ki.appendChild(Sr);Ki.appendChild(li);Ki.appendChild(Tr);Ki.appendChild(Ue);const ce={name:_c,description:bc,type:"obstacle",order:{input:ft.OBSTACLES_CENTER,output:mt.OBSTACLES_CENTER},input:{enabled:yc,params:{recovery:vc},html:Ki,adjustTime:rd},output:{html:null},run:cd};function rd(i){Gi=i,Ue.value=A(Gi.toBeatTime(ce.input.params.recovery),2).toString()}function sd(){ce.input.params.recovery=Math.abs(parseFloat(this.value))/1e3,this.value=A(ce.input.params.recovery*1e3,1).toString(),Gi&&(Ue.value=A(Gi.toBeatTime(ce.input.params.recovery),2).toString())}function od(){if(!Gi){this.value="0";return}let i=A(Math.abs(parseFloat(this.value)),2)||1;ce.input.params.recovery=Gi.toRealTime(i),li.value=A(ce.input.params.recovery*1e3,1).toString(),this.value=i.toString()}function ld(i){const{obstacles:t}=i.difficulty.data,{bpm:e}=i.settings,{recovery:n}=ce.input.params,a=[];let o=Vt.create()[0],r=Vt.create()[0];return t.forEach(s=>{s.posY<At.TOP&&s.height>1&&(s.width>2&&(a.push(s),s.isLonger(o)&&(o=s),s.isLonger(r)&&(r=s)),s.width===2&&(s.posX===ot.LEFT&&s.isLonger(o)&&(e.toRealTime(s.time)>e.toRealTime(r.time)-n&&e.toRealTime(s.time)<e.toRealTime(r.time+r.duration)+n&&a.push(s),o=s),s.posX===ot.MIDDLE_LEFT&&(a.push(s),s.isLonger(o)&&(o=s),s.isLonger(r)&&(r=s)),s.posX===ot.MIDDLE_RIGHT&&s.isLonger(r)&&(e.toRealTime(s.time)>e.toRealTime(o.time)-n&&e.toRealTime(s.time)<e.toRealTime(o.time+o.duration)+n&&a.push(s),r=s)),s.width===1&&(s.posX===ot.MIDDLE_LEFT&&s.isLonger(o)&&(e.toRealTime(s.time)>e.toRealTime(r.time)-n&&e.toRealTime(s.time)<e.toRealTime(r.time+r.duration)+n&&a.push(s),o=s),s.posX===ot.MIDDLE_RIGHT&&s.isLonger(r)&&(e.toRealTime(s.time)>e.toRealTime(o.time)-n&&e.toRealTime(s.time)<e.toRealTime(o.time+o.duration)+n&&a.push(s),r=s)))}),a.map(s=>s.time).filter(function(s,l,c){return!l||s!==c[l-1]})}function cd(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=ld(i),{recovery:e}=ce.input.params;t.length?ce.output.html=_t(`2-wide center obstacle (<${A(e*1e3)}ms)`,t,i.settings.bpm):ce.output.html=null}const Qs="Zero Obstacle",to="Look for obstacle with zero value.",eo=!0,la={name:Qs,description:to,type:"obstacle",order:{input:ft.OBSTACLES_ZERO,output:mt.OBSTACLES_ZERO},input:{enabled:eo,params:{},html:ut.create(Qs,to,eo,function(){la.input.enabled=this.checked})},output:{html:null},run:hd};function ud(i){const{obstacles:t}=i.difficulty.data;return t.filter(e=>e.hasZero()).map(e=>e.time)}function hd(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=ud(i);t.length?la.output.html=_t("Zero value obstacle",t,i.settings.bpm):la.output.html=null}const io=Object.freeze(Object.defineProperty({__proto__:null,shortObstacle:gn,centerObstacle:ce,zeroObstacle:la},Symbol.toStringTag,{value:"Module"})),no="Insufficient Lighting Event",ao="Check if there is enough light event.",ro=!0,ca={name:no,description:ao,type:"event",order:{input:ft.EVENTS_INSUFFICIENT_LIGHT,output:mt.EVENTS_INSUFFICIENT_LIGHT},input:{enabled:ro,params:{},html:ut.create(no,ao,ro,function(){ca.input.enabled=this.checked})},output:{html:null},run:fd};function dd(i,t){let e=0;for(let n=i.length-1;n>=0;n--)if(i[n].isLightEvent(t)&&!i[n].isOff()&&(e++,e>10))return!0;return!1}function fd(i){if(!i.difficulty){console.error("Something went wrong!");return}dd(i.difficulty.data.basicEvents,i.difficulty.characteristic==="360Degree"||i.difficulty.characteristic==="90Degree"?i.info._allDirectionsEnvironmentName:i.info._environmentName)?ca.output.html=null:ca.output.html=pt("Insufficient light event")}const so="Unlit Bomb",oo="Check for lighting around bomb.",lo=!0,ua={name:so,description:oo,type:"event",order:{input:ft.EVENTS_UNLIT_BOMB,output:mt.EVENTS_UNLIT_BOMB},input:{enabled:lo,params:{},html:ut.create(so,oo,lo,function(){ua.input.enabled=this.checked})},output:{html:null},run:pd},md=(i,t,e,n)=>{var d,m,h;if(!t.length)return[];const a=[],o=(m=(d=Ie[n])==null?void 0:d[0])!=null?m:Ie.DefaultEnvironment[0],r=t.filter(p=>p.isLightEvent(n)&&o.includes(p.type)).sort((p,g)=>p.type-g.type),s={0:{state:"off",time:0,fadeTime:0},1:{state:"off",time:0,fadeTime:0},2:{state:"off",time:0,fadeTime:0},3:{state:"off",time:0,fadeTime:0},4:{state:"off",time:0,fadeTime:0},6:{state:"off",time:0,fadeTime:0},7:{state:"off",time:0,fadeTime:0},10:{state:"off",time:0,fadeTime:0},11:{state:"off",time:0,fadeTime:0}},l={};o.forEach(p=>l[p]=[[0,!1]]);const c=e.toBeatTime(1),u=e.toBeatTime(.25);for(let p=0,g=r.length;p<g;p++){const b=r[p];if((b.isOn()||b.isFlash())&&s[b.type].state!=="on"){s[b.type]={state:"on",time:b.time,fadeTime:0};const y=l[b.type].find(v=>v[0]>=b.time);y?(y[0]=b.time,y[1]=!0):l[b.type].push([b.time,!0])}if(b.isFade()){s[b.type]={state:"off",time:b.time,fadeTime:c};const y=l[b.type].find(v=>v[0]>=b.time);y?(y[0]=b.time,y[1]=!0):l[b.type].push([b.time,!0]),l[b.type].push([b.time+c,!1])}(((h=b==null?void 0:b.floatValue)!=null?h:1)<.25||b.isOff()||b.customData._color&&(typeof b.customData._color[3]=="number"&&b.customData._color[3]<.25||Math.max(b.customData._color[0],b.customData._color[1],b.customData._color[2])<.25))&&s[b.type].state!=="off"&&(s[b.type]={state:"off",time:b.time,fadeTime:s[b.type].state==="on"?u:Math.min(u,s[b.type].fadeTime)},l[b.type].push([b.time+(s[b.type].state==="on"?u:Math.min(u,s[b.type].fadeTime)),!1]))}for(const p in l)l[p].reverse();for(let p=0,g=i.length,b=!1;p<g;p++){const y=i[p];b=!1;for(const v in l){const S=l[v].find(L=>L[0]<=y.time);S&&(b=b||S[1])}b||a.push(y)}return a.map(p=>p.time).filter(function(p,g,b){return!g||p!==b[g-1]})};function pd(i){if(!i.difficulty){console.error("Something went wrong!");return}const t=md(i.difficulty.data.bombNotes,i.difficulty.data.basicEvents,i.settings.bpm,i.info._environmentName);t.length?ua.output.html=_t("Unlit bomb",t,i.settings.bpm):ua.output.html=null}const co=Object.freeze(Object.defineProperty({__proto__:null,insufficientLight:ca,unlitBomb:ua},Symbol.toStringTag,{value:"Module"})),Ec="Hot Start",Dc="Check for first interactive object starting from start time.",wc=!0,Sc=1.5,ci=document.createElement("input");ci.id="input__tools-hot-start";ci.className="input-toggle input--small";ci.type="number";ci.min="0";ci.step="0.1";ci.value=Sc.toString();ci.addEventListener("change",gd);const Tc=ut.create(Ec+" (s): ",Dc,wc,function(){pi.input.enabled=this.checked});Tc.appendChild(ci);const pi={name:Ec,description:Dc,type:"other",order:{input:ft.OTHERS_HOT_START,output:mt.OTHERS_HOT_START},input:{enabled:wc,params:{time:Sc},html:Tc},output:{html:null},run:_d};function gd(){pi.input.params.time=A(Math.abs(parseFloat(this.value)),3),this.value=pi.input.params.time.toString()}function _d(i){if(!i.difficulty){console.error("Something went wrong!");return}const{time:t}=pi.input.params,e=i.settings.bpm.toRealTime(i.difficulty.data.getFirstInteractiveTime());e<t?pi.output.html=pt("Hot start",`${A(e,2)}s`):pi.output.html=null}const uo="Difficulty Label Check",ho="For ranking purpose, check difficulty label to fit rankability criteria.",fo=!0,ha={name:uo,description:ho,type:"other",order:{input:ft.OTHERS_DIFFICULTY_LABEL,output:mt.OTHERS_DIFFICULTY_LABEL},input:{enabled:fo,params:{},html:ut.create(uo,ho,fo,function(){ha.input.enabled=this.checked})},output:{html:null},run:bd};function bd(i){var e;if(!i.difficulty){console.error("Something went wrong!");return}const t=(e=i.difficulty.info._customData)==null?void 0:e._difficultyLabel;t&&t.length>30?ha.output.html=pt(`Difficulty label is too long (${t.length} characters)`,"exceeded 30 max characters by ranking criteria"):ha.output.html=null}var Lr=(i=>(i.Standard="Standard",i.NoArrows="No Arrows",i.OneSaber="One Saber",i["360Degree"]="360 Degree",i["90Degree"]="90 Degree",i.Lightshow="Lightshow",i.Lawless="Lawless",i))(Lr||{}),Ja=(i=>(i[i.Standard=0]="Standard",i[i.NoArrows=1]="NoArrows",i[i.OneSaber=2]="OneSaber",i[i["360Degree"]=3]="360Degree",i[i["90Degree"]=4]="90Degree",i[i.Lightshow=5]="Lightshow",i[i.Lawless=6]="Lawless",i))(Ja||{});const fi=class{constructor(t,e=10,n=0){O(this,"_bpm");O(this,"_njs");O(this,"_sdm");O(this,"_hjd");O(this,"_jd");O(this,"_jdMin");O(this,"_reactionTime");this._bpm=t,this._njs=e,this._sdm=n,this.update()}static create(t,e=10,n=0){return new fi(typeof t=="number"?be.create(t):t,e,n)}get value(){return this._njs}set value(t){this._njs=t,this.update()}get offset(){return this._sdm}set offset(t){this._sdm=t,this.update()}get hjd(){return this._hjd}get hjdMin(){return fi.HJD_MIN}get reactTime(){return this._reactionTime}get jd(){return this._jd}get jdMin(){return this._jdMin}update(){this._hjd=this.calcHJD(),this._jd=this.calcJD(),this._jdMin=this.calcJD(fi.HJD_MIN),this._reactionTime=this.calcRTFromHJD()}calcHJDRaw(){const e=this._njs*this._njs/this._njs,n=60/this._bpm.value;let a=fi.HJD_START;for(;e*n*a>17.999;)a/=2;return a<1&&(a=1),a}calcHJD(t=this.offset){return Math.max(this.calcHJDRaw()+t,fi.HJD_MIN)}calcHJDFromJD(t=this.calcJD()){return t/(60/this._bpm.value*this._njs*2)}calcHJDFromRT(t=this.calcRTFromHJD()){return t/(60/this._bpm.value)}calcJD(t=this.calcHJD()){return this._njs*(60/this._bpm.value)*t*2}calcJDOptimalHigh(){return 18*(1/1.07)**this._njs+18}calcJDOptimalLow(){return-(18/(this._njs+1))+18}calcRTFromJD(t=this.calcJD()){return t/(2*this._njs)}calcRTFromHJD(t=this.calcHJD()){return 60/this._bpm.value*t}calcDistance(t){return this._njs*60/this._bpm.value*t*2}};let oe=fi;O(oe,"HJD_START",4),O(oe,"HJD_MIN",.25),O(oe,"FallbackNJS",{ExpertPlus:16,Expert:12,Hard:10,Normal:10,Easy:10});function yd(i,t){const e=mo(i),n=mo(t);for(const a in e){if(e[a]<n[a])return"old";if(e[a]>n[a])return"new"}return"current"}function mo(i){return i.replace("v","").split(".").map(t=>parseInt(t))}class vd extends ya{isMappingExtensions(){return this.posX>3||this.posX<0||this.posY>2||this.posY<0}isValid(){return!this.isMappingExtensions()}}class Ed extends Pe{setBPM(t){return this.bpm=t,this}isValid(){return this.bpm>0}}class Lc extends Cl{setTailTime(t){return this.tailTime=t,this}setTailPosX(t){return this.tailPosX=t,this}setTailPosY(t){return this.tailPosY=t,this}mirror(t=!0){return this.tailPosX=ba-1-this.tailPosX,super.mirror(t)}getTailPosition(t){switch(t){case"vanilla":return[this.tailPosX,this.tailPosY];case"me":return[(this.tailPosX<=-1e3?this.tailPosX/1e3:this.tailPosX>=1e3?this.tailPosX/1e3:this.tailPosX)-2,this.tailPosY<=-1e3?this.tailPosY/1e3:this.tailPosY>=1e3?this.tailPosY/1e3:this.tailPosY];case"ne":return[this.tailPosX,this.tailPosY];default:return[(this.tailPosX<=-1e3?this.tailPosX/1e3:this.tailPosX>=1e3?this.tailPosX/1e3:this.tailPosX)-2,this.tailPosY<=-1e3?this.tailPosY/1e3:this.tailPosY>=1e3?this.tailPosY/1e3:this.tailPosY]}}getAngle(t){switch(t){case"vanilla":return Rt[this.direction]||0;case"me":if(this.direction>=1e3)return Math.abs(this.direction%1e3%360-360);case"ne":return Rt[this.direction]||0}return this.direction>=1e3?Math.abs(this.direction%1e3%360-360):Rt[this.direction]||0}getDistance(t){const[e,n]=this.getPosition(),[a,o]=t.getPosition();return Math.sqrt(Math.pow(a-e,2)+Math.pow(o-n,2))}isVertical(t){const[e]=this.getPosition(),[n]=t.getPosition(),a=e-n;return a>-.001&&a<.001}isHorizontal(t){const[e,n]=this.getPosition(),[a,o]=t.getPosition(),r=n-o;return r>-.001&&r<.001}isDiagonal(t){const[e,n]=this.getPosition(),[a,o]=t.getPosition(),r=Math.abs(e-a),s=Math.abs(n-o);return r===s}isInline(t,e=.5){return this.getDistance(t)<=e}isAdjacent(t){const e=this.getDistance(t);return e>.499&&e<1.001}isWindow(t,e=1.8){return this.getDistance(t)>e}isSlantedWindow(t){return this.isWindow(t)&&!this.isDiagonal(t)&&!this.isHorizontal(t)&&!this.isVertical(t)}isInverse(){return this.time>this.tailTime}}class Dd extends Lc{setSliceCount(t){return this.sliceCount=t,this}setSquish(t){return this.squish=t,this}isMappingExtensions(){return this.posY>2||this.posY<0||this.posX<=-1e3||this.posX>=1e3||this.direction>=1e3&&this.direction<=1360}isValid(){return!(this.isMappingExtensions()||this.isInverse()||this.posX<0||this.posX>3||this.tailPosX<0||this.tailPosX>3)&&!(this.posX===this.tailPosX&&this.posY===this.tailPosY)}}class wd extends Pe{setToggle(t){return this.toggle=t,this}isValid(){return!0}}class Cc extends Pe{setType(t){return this.type=t,this}setValue(t){return this.value=t,this}setFloatValue(t){return this.floatValue=t,this}isOff(){return this.value===0}isOn(){return this.value===1||this.value===5||this.value===9}isFlash(){return this.value===2||this.value===6||this.value===10}isFade(){return this.value===3||this.value===7||this.value===11}isTransition(){return this.value===4||this.value===8||this.value===12}isBlue(){return this.value===1||this.value===2||this.value===3||this.value===4}isRed(){return this.value===5||this.value===6||this.value===7||this.value===8}isWhite(){return this.value===9||this.value===10||this.value===11||this.value===12}isLightEvent(t){switch(t){case"LizzoEnvironment":return this.type===0||this.type===1||this.type===2||this.type===3||this.type===4||this.type===6||this.type===7||this.type===8||this.type===9||this.type===10||this.type===11||this.type===12;default:return this.type===0||this.type===1||this.type===2||this.type===3||this.type===4||this.type===6||this.type===7||this.type===10||this.type===11}}isColorBoost(){return this.type===5}isRingEvent(t){switch(t){case"LizzoEnvironment":return!1;default:return this.type===8||this.type===9}}isLaserRotationEvent(t){switch(t){case"LizzoEnvironment":return!1;default:return this.type===12||this.type===13}}isLaneRotationEvent(t){return this.type===14||this.type===15}isExtraEvent(t){return this.type===16||this.type===17||this.type===18||this.type===19}isSpecialEvent(t){return this.type===40||this.type===41||this.type===42||this.type===43}isBPMChangeEvent(){return this.type===100}isLightingEvent(t){return this.isLightEvent(t)||this.isRingEvent(t)||this.isLaserRotationEvent(t)||this.isExtraEvent(t)}isOldChroma(){return this.value>=2e9}isValidType(){return this.type>=0&&this.type<=19||this.type>=40&&this.type<=43||this.type===100}isValid(){return this.isValidType()&&this.value>=0&&!(!this.isLaserRotationEvent()&&this.value>12&&!this.isOldChroma())}}class kc extends Wi{setKeyword(t){return this.keyword=t,this}setEvents(t){return this.events=t,this}addEvent(t){return this.events.push(t),this}removeEvent(t){const e=this.events.indexOf(t,0);return e>-1&&this.events.splice(e,1),this}}class Rc extends Wi{setData(t){return this.list=t,this}removeData(t){return this.list=this.list.filter(e=>e.keyword!==t),this}}class Sd extends Wi{setType(t){return this.type=t,this}setP0(t){return this.p0=t,this}setP1(t){return this.p1=t,this}setReverse(t){return this.reverse=t,this}setChunks(t){return this.chunks=t,this}setLimit(t){return this.limit=t,this}setLimitAffectsType(t){return this.limitAffectsType=t,this}setRandom(t){return this.random=t,this}setSeed(t){return this.seed=t,this}}class Td extends Pe{setTransition(t){return this.transition=t,this}setColor(t){return this.color=t,this}setBrightness(t){return this.brightness=t,this}setFrequency(t){return this.frequency=t,this}isValid(){return this.transition>=0&&this.transition<=2&&this.color>=0&&this.color<=2&&this.brightness>=0&&this.frequency>=0}}class Cr extends Ll{setFilter(t){return this.filter=t,this}setBeatDistribution(t){return this.beatDistribution=t,this}setBeatDistributionType(t){return this.beatDistributionType=t,this}setEasing(t){return this.easing=t,this}isValid(){return this.beatDistributionType===1||this.beatDistributionType===2}}class Ld extends Cr{setBrightnessDistribution(t){return this.brightnessDistribution=t,this}setBrightnessDistributionType(t){return this.brightnessDistributionType=t,this}setAffectFirst(t){return this.affectFirst=t,this}isValid(){return super.isValid()&&(this.brightnessDistributionType===1||this.brightnessDistributionType===2)&&(this.affectFirst===0||this.affectFirst===1)}}class Cd extends Pe{isValid(){return this.id>=0}}class kr extends Cd{}class kd extends kr{}class Rd extends Pe{setPrevious(t){return this.previous=t,this}setEasing(t){return this.easing=t,this}setLoop(t){return this.loop=t,this}setRotation(t){return this.rotation=t,this}setDirection(t){return this.direction=t,this}isValid(){return(this.previous===0||this.previous===1)&&this.easing>=-1&&this.easing<=3&&(this.loop===0||this.loop===1)&&this.direction>=0&&this.direction<=2}}class xd extends Cr{setRotationDistribution(t){return this.rotationDistribution=t,this}setRotationDistributionType(t){return this.rotationDistributionType=t,this}setAxis(t){return this.axis=t,this}setFlip(t){return this.flip=t,this}setAffectFirst(t){return this.affectFirst=t,this}isValid(){return super.isValid()&&(this.rotationDistributionType===1||this.rotationDistributionType===2)&&(this.axis===0||this.axis===1)&&(this.flip===0||this.flip===1)&&(this.affectFirst===0||this.affectFirst===1)}}class Nd extends kr{}class Id extends Pe{setExecutionTime(t){return this.executionTime=t,this}setRotation(t){return this.rotation=t,this}isValid(){return this.executionTime===0||this.executionTime===1}}class xc extends Lc{setLengthMultiplier(t){return this.lengthMultiplier=t,this}setTailLengthMultiplier(t){return this.tailLengthMultiplier=t,this}setTailDirection(t){return this.tailDirection=t,this}setMidAnchor(t){return this.midAnchor=t,this}mirror(t=!0){switch(this.tailDirection){case 2:this.tailDirection=3;break;case 3:this.tailDirection=2;break;case 6:this.tailDirection=7;break;case 7:this.tailDirection=6;break;case 4:this.tailDirection=5;break;case 5:this.tailDirection=4;break}return this.midAnchor&&(this.midAnchor=this.midAnchor===1?2:1),super.mirror(t)}getTailAngle(t){switch(t){case"vanilla":return Rt[this.tailDirection]||0;case"me":if(this.tailDirection>=1e3)return Math.abs(this.tailDirection%1e3%360-360);case"ne":return Rt[this.tailDirection]||0;default:return this.tailDirection>=1e3?Math.abs(this.tailDirection%1e3%360-360):Rt[this.tailDirection]||0}}isMappingExtensions(){return this.posY>2||this.posY<0||this.posX<=-1e3||this.posX>=1e3||this.direction>=1e3&&this.direction<=1360||this.tailDirection>=1e3&&this.tailDirection<=1360}isValid(){return!(this.isMappingExtensions()||this.isInverse()||this.posX<0||this.posX>3||this.tailPosX<0||this.tailPosX>3||this.posX===this.tailPosX&&this.posY===this.tailPosY&&this.time===this.tailTime)}}class Nc extends ya{setDirection(t){return this.direction=t,this}mirror(){switch(this.posX=ba-1-this.posX,this.direction){case 2:this.direction=3;break;case 3:this.direction=2;break;case 6:this.direction=7;break;case 7:this.direction=6;break;case 4:this.direction=5;break;case 5:this.direction=4;break}return this}isValid(){return this.direction>=0&&this.direction<=9&&this.direction!==8}}const Yt=class extends nr{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,o,r,s,l,c;return e.push(new this({_time:(a=n._time)!=null?a:Yt.default._time,_lineIndex:(o=n._lineIndex)!=null?o:Yt.default._lineIndex,_lineLayer:(r=n._lineLayer)!=null?r:Yt.default._lineLayer,_type:(s=n._type)!=null?s:Yt.default._type,_cutDirection:(l=n._cutDirection)!=null?l:Yt.default._cutDirection,_customData:(c=n._customData)!=null?c:Yt.default._customData()}))}),e.length?e:[new this({_time:Yt.default._time,_lineIndex:Yt.default._lineIndex,_lineLayer:Yt.default._lineLayer,_type:Yt.default._type,_cutDirection:Yt.default._cutDirection,_customData:Yt.default._customData()})]}toJSON(){return{_time:this.time,_type:this.type,_lineIndex:this.posX,_lineLayer:this.posY,_cutDirection:this.direction,_customData:vt(this.customData)}}get time(){return this.data._time}set time(t){this.data._time=t}get posX(){return this.data._lineIndex}set posX(t){this.data._lineIndex=t}get posY(){return this.data._lineLayer}set posY(t){this.data._lineLayer=t}get type(){return this.data._type}set type(t){this.data._type=t}get color(){return this.data._type}set color(t){this.data._type=t}get direction(){return this.data._cutDirection}set direction(t){this.data._cutDirection=t}get angleOffset(){return 0}set angleOffset(t){}get customData(){return this.data._customData}set customData(t){this.data._customData=t}setCustomData(t){return this.customData=t,this}addCustomData(t){return this.customData={...this.customData,object:t},this}getPosition(t){return this.customData._position?[this.customData._position[0],this.customData._position[1]]:super.getPosition(t)}getAngle(t){return this.customData._cutDirection?this.customData._cutDirection>0?this.customData._cutDirection%360:360+this.customData._cutDirection%360:super.getAngle(t)}isChroma(){return Array.isArray(this.customData._color)||typeof this.customData._disableSpawnEffect=="boolean"}isNoodleExtensions(){return Array.isArray(this.customData._animation)||typeof this.customData._cutDirection=="number"||typeof this.customData._disableNoteGravity=="boolean"||typeof this.customData._disableNoteLook=="boolean"||typeof this.customData._fake=="boolean"||Array.isArray(this.customData._flip)||typeof this.customData._interactable=="boolean"||Array.isArray(this.customData._localRotation)||typeof this.customData._noteJumpMovementSpeed=="number"||typeof this.customData._noteJumpStartBeatOffset=="number"||Array.isArray(this.customData._position)||Array.isArray(this.customData._rotation)||typeof this.customData._track=="string"}};let Ai=Yt;O(Ai,"default",{_time:0,_lineIndex:0,_lineLayer:0,_type:0,_cutDirection:0,_customData:()=>({})});const Et=class extends xc{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,o,r,s,l,c,u,d,m,h,p,g,b,y,v;return e.push(new this({_colorType:(a=n._colorType)!=null?a:Et.default._colorType,_headTime:(r=(o=n._headTime)!=null?o:n._tailTime)!=null?r:Et.default._headTime,_headLineIndex:(s=n._headLineIndex)!=null?s:Et.default._headLineIndex,_headLineLayer:(l=n._headLineLayer)!=null?l:Et.default._headLineLayer,_headCutDirection:(c=n._headCutDirection)!=null?c:Et.default._headCutDirection,_headControlPointLengthMultiplier:(u=n._headControlPointLengthMultiplier)!=null?u:Et.default._headControlPointLengthMultiplier,_tailTime:(m=(d=n._tailTime)!=null?d:n._headTime)!=null?m:Et.default._tailTime,_tailLineIndex:(h=n._tailLineIndex)!=null?h:Et.default._tailLineIndex,_tailLineLayer:(p=n._tailLineLayer)!=null?p:Et.default._tailLineLayer,_tailCutDirection:(g=n._tailCutDirection)!=null?g:Et.default._tailCutDirection,_tailControlPointLengthMultiplier:(b=n._tailControlPointLengthMultiplier)!=null?b:Et.default._tailControlPointLengthMultiplier,_sliderMidAnchorMode:(y=n._sliderMidAnchorMode)!=null?y:Et.default._sliderMidAnchorMode,_customData:(v=n._customData)!=null?v:Et.default._customData()}))}),e.length?e:[new this({_colorType:Et.default._colorType,_headTime:Et.default._headTime,_headLineIndex:Et.default._headLineIndex,_headLineLayer:Et.default._headLineLayer,_headCutDirection:Et.default._headCutDirection,_headControlPointLengthMultiplier:Et.default._headControlPointLengthMultiplier,_tailTime:Et.default._tailTime,_tailLineIndex:Et.default._tailLineIndex,_tailLineLayer:Et.default._tailLineLayer,_tailCutDirection:Et.default._tailCutDirection,_tailControlPointLengthMultiplier:Et.default._tailControlPointLengthMultiplier,_sliderMidAnchorMode:Et.default._sliderMidAnchorMode,_customData:Et.default._customData()})]}toJSON(){return{_colorType:this.color,_headTime:this.time,_headLineIndex:this.posX,_headLineLayer:this.posY,_headCutDirection:this.direction,_headControlPointLengthMultiplier:this.lengthMultiplier,_tailTime:this.tailTime,_tailLineIndex:this.tailPosX,_tailLineLayer:this.tailPosY,_tailCutDirection:this.tailDirection,_tailControlPointLengthMultiplier:this.tailLengthMultiplier,_sliderMidAnchorMode:this.midAnchor,_customData:vt(this.customData)}}get color(){return this.data._colorType}set color(t){this.data._colorType=t}get time(){return this.data._headTime}set time(t){this.data._headTime=t}get posX(){return this.data._headLineIndex}set posX(t){this.data._headLineIndex=t}get posY(){return this.data._headLineLayer}set posY(t){this.data._headLineLayer=t}get direction(){return this.data._headCutDirection}set direction(t){this.data._headCutDirection=t}get lengthMultiplier(){return this.data._headControlPointLengthMultiplier}set lengthMultiplier(t){this.data._headControlPointLengthMultiplier=t}get tailTime(){return this.data._tailTime}set tailTime(t){this.data._tailTime=t}get tailPosX(){return this.data._tailLineIndex}set tailPosX(t){this.data._tailLineIndex=t}get tailPosY(){return this.data._tailLineLayer}set tailPosY(t){this.data._tailLineLayer=t}get tailDirection(){return this.data._tailCutDirection}set tailDirection(t){this.data._tailCutDirection=t}get tailLengthMultiplier(){return this.data._tailControlPointLengthMultiplier}set tailLengthMultiplier(t){this.data._tailControlPointLengthMultiplier=t}get midAnchor(){return this.data._sliderMidAnchorMode}set midAnchor(t){this.data._sliderMidAnchorMode=t}get customData(){return this.data._customData}set customData(t){this.data._customData=t}setCustomData(t){return this.customData=t,this}addCustomData(t){return this.customData={...this.customData,object:t},this}};let Bi=Et;O(Bi,"default",{_colorType:0,_headTime:0,_headLineIndex:0,_headLineLayer:0,_headCutDirection:0,_headControlPointLengthMultiplier:1,_tailTime:0,_tailLineIndex:0,_tailLineLayer:0,_tailCutDirection:0,_tailControlPointLengthMultiplier:1,_sliderMidAnchorMode:0,_customData:()=>({})});const Mt=class extends gc{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,o,r,s,l,c,u,d;return e.push(new this({_time:(a=n._time)!=null?a:Mt.default._time,_type:(o=n._type)!=null?o:Mt.default._type,_lineIndex:(r=n._lineIndex)!=null?r:Mt.default._lineIndex,_lineLayer:(s=n._lineLayer)!=null?s:Mt.default._lineLayer,_duration:(l=n._duration)!=null?l:Mt.default._duration,_width:(c=n._width)!=null?c:Mt.default._width,_height:(u=n._height)!=null?u:Mt.default._height,_customData:(d=n._customData)!=null?d:Mt.default._customData()}))}),e.length?e:[new this({_time:Mt.default._time,_type:Mt.default._type,_lineIndex:Mt.default._lineIndex,_lineLayer:Mt.default._lineLayer,_duration:Mt.default._duration,_width:Mt.default._width,_height:Mt.default._height,_customData:Mt.default._customData()})]}toJSON(){return{_time:this.time,_type:this.type,_lineIndex:this.posX,_lineLayer:this.posY,_duration:this.duration,_width:this.width,_height:this.height,_customData:vt(this.customData)}}get time(){return this.data._time}set time(t){this.data._time=t}get posX(){return this.data._lineIndex}set posX(t){this.data._lineIndex=t}get posY(){return this.data._lineLayer}set posY(t){this.data._lineLayer=t}get type(){return this.data._type}set type(t){this.data._type=t}get duration(){return this.data._duration}set duration(t){this.data._duration=t}get width(){return this.data._width}set width(t){this.data._width=t}get height(){return this.data._height}set height(t){this.data._height=t}get customData(){return this.data._customData}set customData(t){this.data._customData=t}setCustomData(t){return this.customData=t,this}addCustomData(t){return this.customData={...this.customData,object:t},this}getPosition(){return this.customData._position?[this.customData._position[0],this.customData._position[1]]:super.getPosition()}isChroma(){return Array.isArray(this.customData._color)}isNoodleExtensions(){return Array.isArray(this.customData._animation)||typeof this.customData._fake=="boolean"||typeof this.customData._interactable=="boolean"||Array.isArray(this.customData._localRotation)||typeof this.customData._noteJumpMovementSpeed=="number"||typeof this.customData._noteJumpStartBeatOffset=="number"||Array.isArray(this.customData._position)||Array.isArray(this.customData._rotation)||Array.isArray(this.customData._scale)||typeof this.customData._track=="string"}};let $i=Mt;O($i,"default",{_time:0,_lineIndex:0,_lineLayer:0,_type:0,_duration:1,_width:1,_height:1,_customData:()=>({})});const ee=class extends Cc{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,o,r,s,l;return e.push(new this({_time:(a=n._time)!=null?a:ee.default._time,_type:(o=n._type)!=null?o:ee.default._type,_value:(r=n._value)!=null?r:ee.default._value,_floatValue:(s=n._floatValue)!=null?s:ee.default._floatValue,_customData:(l=n._customData)!=null?l:ee.default._customData()}))}),e.length?e:[new this({_time:ee.default._time,_type:ee.default._type,_value:ee.default._value,_floatValue:ee.default._floatValue,_customData:ee.default._customData()})]}toJSON(){return{_time:this.time,_type:this.type,_value:this.value,_floatValue:this.floatValue,_customData:vt(this.customData)}}get time(){return this.data._time}set time(t){this.data._time=t}get type(){return this.data._type}set type(t){this.data._type=t}get value(){return this.data._value}set value(t){this.data._value=t}get floatValue(){return this.data._floatValue}set floatValue(t){this.data._floatValue=t}get customData(){return this.data._customData}set customData(t){this.data._customData=t}setCustomData(t){return this.customData=t,this}addCustomData(t){return this.customData={...this.customData,object:t},this}isLightEvent(t){return super.isLightEvent(t)}isRingEvent(t){return super.isRingEvent(t)}isLaserRotationEvent(t){return super.isLaserRotationEvent(t)}isLaneRotationEvent(t){return super.isLaneRotationEvent(t)}isChroma(){return this.isLightEvent()?Array.isArray(this.customData._color)||typeof this.customData._lightID=="number"||Array.isArray(this.customData._lightID)||typeof this.customData._propID=="number"||typeof this.customData._lightGradient=="object"||typeof this.customData._easing=="string"||typeof this.customData._lerpType=="string":this.isRingEvent()?typeof this.customData._nameFilter=="string"||typeof this.customData._reset=="boolean"||typeof this.customData._rotation=="number"||typeof this.customData._step=="number"||typeof this.customData._prop=="number"||typeof this.customData._speed=="number"||typeof this.customData._direction=="number"||typeof this.customData._counterSpin=="boolean"||typeof this.customData._stepMult=="number"||typeof this.customData._propMult=="number"||typeof this.customData._speedMult=="number":this.isLaserRotationEvent()?typeof this.customData._lockPosition=="boolean"||typeof this.customData._speed=="number"||typeof this.customData._preciseSpeed=="number"||typeof this.customData._direction=="number":!1}isNoodleExtensions(){return this.isLaneRotationEvent()&&typeof this.customData._rotation=="number"}isMappingExtensions(){return this.isLaneRotationEvent()&&this.value>=1e3&&this.value<=1720}};let Oi=ee;O(Oi,"default",{_time:0,_type:0,_value:0,_floatValue:1,_customData:()=>({})});const ie=class extends Nc{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,o,r,s,l;return e.push(new this({_time:(a=n._time)!=null?a:ie.default._time,_lineIndex:(o=n._lineIndex)!=null?o:ie.default._lineIndex,_lineLayer:(r=n._lineLayer)!=null?r:ie.default._lineLayer,_offsetDirection:(s=n._offsetDirection)!=null?s:ie.default._offsetDirection,_customData:(l=n._customData)!=null?l:ie.default._customData()}))}),e.length?e:[new this({_time:ie.default._time,_lineIndex:ie.default._lineIndex,_lineLayer:ie.default._lineLayer,_offsetDirection:ie.default._offsetDirection,_customData:ie.default._customData()})]}toJSON(){return{_time:this.time,_lineIndex:this.posX,_lineLayer:this.posY,_offsetDirection:this.direction,_customData:vt(this.customData)}}get time(){return this.data._time}set time(t){this.data._time=t}get posX(){return this.data._lineIndex}set posX(t){this.data._lineIndex=t}get posY(){return this.data._lineLayer}set posY(t){this.data._lineLayer=t}get direction(){return this.data._offsetDirection}set direction(t){this.data._offsetDirection=t}get customData(){return this.data._customData}set customData(t){this.data._customData=t}setCustomData(t){return this.customData=t,this}addCustomData(t){return this.customData={...this.customData,object:t},this}};let Mi=ie;O(Mi,"default",{_time:0,_lineIndex:0,_lineLayer:0,_offsetDirection:1,_customData:()=>({})});const Ni=class extends kc{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,o;return e.push(new this({_keyword:(a=n._keyword)!=null?a:Ni.default._keyword,_specialEvents:(o=n._specialEvents)!=null?o:Ni.default._specialEvents()}))}),e.length?e:[new this({_keyword:Ni.default._keyword,_specialEvents:Ni.default._specialEvents()})]}toJSON(){return{_keyword:this.keyword,_specialEvents:this.events}}get keyword(){return this.data._keyword}set keyword(t){this.data._keyword=t}get events(){return this.data._specialEvents}set events(t){this.data._specialEvents=t}};let Bn=Ni;O(Bn,"default",{_keyword:"",_specialEvents:()=>[]});const Mr=class extends Rc{constructor(e){super(e);O(this,"_d");this._d=e._keywords.map(n=>Bn.create({_keyword:n._keyword,_specialEvents:n._specialEvents})[0])}static create(e={}){var n;return new this({_keywords:(n=e._keywords)!=null?n:Mr.default._keywords()})}toJSON(){return{_keywords:this._d.map(e=>e.toJSON())}}get list(){return this._d}set list(e){this._d=e}addData(e){return this._d.push(e),this}};let $n=Mr;O($n,"default",{_keywords:()=>[]});class Ad extends Wi{constructor(e){super(e);O(this,"_fileName","UnnamedDifficulty.dat");O(this,"version");O(this,"notes");O(this,"sliders");O(this,"obstacles");O(this,"events");O(this,"waypoints");O(this,"specialEventsKeywordFilters");O(this,"customData");this.version="2.6.0",this.notes=e._notes.map(n=>Ai.create(n)[0]),this.sliders=e._sliders.map(n=>Bi.create(n)[0]),this.obstacles=e._obstacles.map(n=>$i.create(n)[0]),this.events=e._events.map(n=>Oi.create(n)[0]),this.waypoints=e._waypoints.map(n=>Mi.create(n)[0]),this.specialEventsKeywordFilters=$n.create(e._specialEventsKeywordFilters),this.customData=e._customData}static create(e={}){var n,a,o,r,s,l,c;return new this({_version:"2.6.0",_notes:(n=e._notes)!=null?n:[],_sliders:(a=e._sliders)!=null?a:[],_obstacles:(o=e._obstacles)!=null?o:[],_events:(r=e._events)!=null?r:[],_waypoints:(s=e._waypoints)!=null?s:[],_specialEventsKeywordFilters:(l=e._specialEventsKeywordFilters)!=null?l:{_keywords:[]},_customData:(c=e._customData)!=null?c:{}})}toJSON(){return{_version:"2.6.0",_notes:this.notes.map(e=>e.toJSON()),_sliders:this.sliders.map(e=>e.toJSON()),_obstacles:this.obstacles.map(e=>e.toJSON()),_events:this.events.map(e=>e.toJSON()),_waypoints:this.waypoints.map(e=>e.toJSON()),_specialEventsKeywordFilters:this.specialEventsKeywordFilters.toJSON(),_customData:vt(this.customData)}}clone(){const e=this.fileName;return super.clone().setFileName(e)}set fileName(e){this._fileName=e.trim()}get fileName(){return this._fileName}setFileName(e){return this.fileName=e,this}getFirstInteractiveTime(){let e=Number.MAX_VALUE;this.notes.length>0&&(e=this.notes[0].time);const n=this.findFirstInteractiveObstacleTime();return Math.min(e,n)}getLastInteractiveTime(){let e=0;this.notes.length>0&&(e=this.notes[this.notes.length-1].time);const n=this.findLastInteractiveObstacleTime();return Math.max(e,n)}findFirstInteractiveObstacleTime(){for(let e=0,n=this.obstacles.length;e<n;e++)if(this.obstacles[e].isInteractive())return this.obstacles[e].time;return Number.MAX_VALUE}findLastInteractiveObstacleTime(){let e=0;for(let n=this.obstacles.length-1;n>=0;n--)this.obstacles[n].isInteractive()&&(e=Math.max(e,this.obstacles[n].time+this.obstacles[n].duration));return e}addNotes(...e){this.notes.push(...e.map(n=>n instanceof Ai?n:Ai.create(n)[0]))}addObstacles(...e){this.obstacles.push(...e.map(n=>n instanceof $i?n:$i.create(n)[0]))}addEvents(...e){this.events.push(...e.map(n=>n instanceof Oi?n:Oi.create(n)[0]))}addWaypoints(...e){this.waypoints.push(...e.map(n=>n instanceof Mi?n:Mi.create(n)[0]))}addSliders(...e){this.sliders.push(...e.map(n=>n instanceof Bi?n:Bi.create(n)[0]))}}const ne=class extends Cc{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,o,r,s,l;return e.push(new this({b:(a=n.b)!=null?a:ne.default.b,et:(o=n.et)!=null?o:ne.default.et,i:(r=n.i)!=null?r:ne.default.i,f:(s=n.f)!=null?s:ne.default.f,customData:(l=n.customData)!=null?l:ne.default.customData()}))}),e.length?e:[new this({b:ne.default.b,et:ne.default.et,i:ne.default.i,f:ne.default.f,customData:ne.default.customData()})]}toJSON(){return{b:this.time,et:this.type,i:this.value,f:this.floatValue,customData:vt(this.customData)}}get time(){return this.data.b}set time(t){this.data.b=t}get type(){return this.data.et}set type(t){this.data.et=t}get value(){return this.data.i}set value(t){this.data.i=t}get floatValue(){return this.data.f}set floatValue(t){this.data.f=t}get customData(){return this.data.customData}set customData(t){this.data.customData=t}setCustomData(t){return this.customData=t,this}addCustomData(t){return this.customData={...this.customData,object:t},this}isLightEvent(t){return super.isLightEvent(t)}isRingEvent(t){return super.isRingEvent(t)}isLaserRotationEvent(t){return super.isLaserRotationEvent(t)}isLaneRotationEvent(t){return super.isLaneRotationEvent(t)}isChroma(){return this.isLightEvent()?Array.isArray(this.customData.color)||typeof this.customData.lightID=="number"||Array.isArray(this.customData.lightID)||typeof this.customData.easing=="string"||typeof this.customData.lerpType=="string":this.isRingEvent()?typeof this.customData.nameFilter=="string"||typeof this.customData.rotation=="number"||typeof this.customData.step=="number"||typeof this.customData.prop=="number"||typeof this.customData.speed=="number"||typeof this.customData.direction=="number":this.isLaserRotationEvent()?typeof this.customData.lockRotation=="boolean"||typeof this.customData.speed=="number"||typeof this.customData.direction=="number":!1}};let gi=ne;O(gi,"default",{b:0,et:0,i:0,f:1,customData:()=>({})});const Ii=class extends kc{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,o;return e.push(new this({k:(a=n.k)!=null?a:Ii.default.k,e:(o=n.e)!=null?o:Ii.default.e()}))}),e.length?e:[new this({k:Ii.default.k,e:Ii.default.e()})]}toJSON(){return{k:this.keyword,e:this.events}}get keyword(){return this.data.k}set keyword(t){this.data.k=t}get events(){return this.data.e}set events(t){this.data.e=t}};let On=Ii;O(On,"default",{k:"",e:()=>[]});const Pr=class extends Rc{constructor(e){super(e);O(this,"d");this.d=e.d.map(n=>On.create({e:n.e,k:n.k})[0])}static create(e={}){var n;return new this({d:(n=e.d)!=null?n:Pr.default.d()})}toJSON(){return{d:this.list.map(e=>e.toJSON())}}get list(){return this.d}set list(e){this.d=e}addData(e){return this.list.push(e),this}};let cn=Pr;O(cn,"default",{d:()=>[]});const Le=class extends vd{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,o,r,s;return e.push(new this({b:(a=n.b)!=null?a:Le.default.b,x:(o=n.x)!=null?o:Le.default.x,y:(r=n.y)!=null?r:Le.default.y,customData:(s=n.customData)!=null?s:Le.default.customData()}))}),e.length?e:[new this({b:Le.default.b,x:Le.default.x,y:Le.default.y,customData:Le.default.customData()})]}toJSON(){return{b:this.time,x:this.posX,y:this.posY,customData:vt(this.customData)}}get time(){return this.data.b}set time(t){this.data.b=t}get posX(){return this.data.x}set posX(t){this.data.x=t}get posY(){return this.data.y}set posY(t){this.data.y=t}get customData(){return this.data.customData}set customData(t){this.data.customData=t}setCustomData(t){return this.customData=t,this}addCustomData(t){return this.customData={...this.customData,object:t},this}mirror(){return this.customData.coordinates&&(this.customData.coordinates[0]=-1-this.customData.coordinates[0]),this.customData.flip&&(this.customData.flip[0]=-1-this.customData.flip[0]),this.customData.animation&&(Array.isArray(this.customData.animation.definitePosition)&&this.customData.animation.definitePosition.forEach(t=>{t[0]=-t[0]}),Array.isArray(this.customData.animation.offsetPosition)&&this.customData.animation.offsetPosition.forEach(t=>{t[0]=-t[0]})),super.mirror()}isChroma(){return Array.isArray(this.customData.color)||typeof this.customData.spawnEffect=="boolean"}isNoodleExtensions(){return Array.isArray(this.customData.animation)||typeof this.customData.disableNoteGravity=="boolean"||typeof this.customData.disableNoteLook=="boolean"||Array.isArray(this.customData.flip)||typeof this.customData.uninteractable=="boolean"||Array.isArray(this.customData.localRotation)||typeof this.customData.noteJumpMovementSpeed=="number"||typeof this.customData.noteJumpStartBeatOffset=="number"||Array.isArray(this.customData.coordinates)||Array.isArray(this.customData.worldRotation)||typeof this.customData.worldRotation=="number"||typeof this.customData.track=="string"}};let Je=Le;O(Je,"default",{b:0,x:0,y:0,customData:()=>({})});const Ge=class extends Ed{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,o,r;return e.push(new this({b:(a=n.b)!=null?a:Ge.default.b,m:(o=n.m)!=null?o:Ge.default.m,customData:(r=n.customData)!=null?r:Ge.default.customData()}))}),e.length?e:[new this({b:Ge.default.b,m:Ge.default.m,customData:Ge.default.customData()})]}toJSON(){return{b:this.time,m:this.bpm,customData:vt(this.customData)}}get time(){return this.data.b}set time(t){this.data.b=t}get bpm(){return this.data.m}set bpm(t){this.data.m=t}setBPM(t){return this.bpm=t,this}get customData(){return this.data.customData}set customData(t){this.data.customData=t}setCustomData(t){return this.customData=t,this}addCustomData(t){return this.customData={...this.customData,object:t},this}isValid(){return this.bpm>0}};let _i=Ge;O(_i,"default",{b:0,m:0,customData:()=>({})});const Tt=class extends Dd{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,o,r,s,l,c,u,d,m,h,p,g,b;return e.push(new this({b:(o=(a=n.b)!=null?a:n.tb)!=null?o:Tt.default.b,c:(r=n.c)!=null?r:Tt.default.c,x:(s=n.x)!=null?s:Tt.default.x,y:(l=n.y)!=null?l:Tt.default.y,d:(c=n.d)!=null?c:Tt.default.d,tb:(d=(u=n.tb)!=null?u:n.b)!=null?d:Tt.default.tb,tx:(m=n.tx)!=null?m:Tt.default.tx,ty:(h=n.ty)!=null?h:Tt.default.ty,sc:(p=n.sc)!=null?p:Tt.default.sc,s:(g=n.s)!=null?g:Tt.default.s,customData:(b=n.customData)!=null?b:Tt.default.customData()}))}),e.length?e:[new this({b:Tt.default.b,c:Tt.default.c,x:Tt.default.x,y:Tt.default.y,d:Tt.default.d,tb:Tt.default.tb,tx:Tt.default.tx,ty:Tt.default.ty,sc:Tt.default.sc,s:Tt.default.s,customData:Tt.default.customData()})]}toJSON(){return{b:this.time,c:this.color,x:this.posX,y:this.posY,d:this.direction,tb:this.tailTime,tx:this.tailPosX,ty:this.tailPosY,sc:this.sliceCount,s:this.squish,customData:vt(this.customData)}}get time(){return this.data.b}set time(t){this.data.b=t}get posX(){return this.data.x}set posX(t){this.data.x=t}get posY(){return this.data.y}set posY(t){this.data.y=t}get color(){return this.data.c}set color(t){this.data.c=t}get direction(){return this.data.d}set direction(t){this.data.d=t}get tailTime(){return this.data.tb}set tailTime(t){this.data.tb=t}get tailPosX(){return this.data.tx}set tailPosX(t){this.data.tx=t}get tailPosY(){return this.data.ty}set tailPosY(t){this.data.ty=t}get sliceCount(){return this.data.sc}set sliceCount(t){this.data.sc=t}get squish(){return this.data.s}set squish(t){this.data.s=t}get customData(){return this.data.customData}set customData(t){this.data.customData=t}setCustomData(t){return this.customData=t,this}addCustomData(t){return this.customData={...this.customData,object:t},this}mirror(t=!0){return this.customData.coordinates&&(this.customData.coordinates[0]=-1-this.customData.coordinates[0]),this.customData.flip&&(this.customData.flip[0]=-1-this.customData.flip[0]),this.customData.animation&&(Array.isArray(this.customData.animation.definitePosition)&&this.customData.animation.definitePosition.forEach(e=>{e[0]=-e[0]}),Array.isArray(this.customData.animation.offsetPosition)&&this.customData.animation.offsetPosition.forEach(e=>{e[0]=-e[0]})),super.mirror(t)}};let Pi=Tt;O(Pi,"default",{b:0,c:0,x:0,y:0,d:0,tb:0,tx:0,ty:0,sc:1,s:1,customData:()=>({})});const We=class extends wd{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,o,r;return e.push(new this({b:(a=n.b)!=null?a:We.default.b,o:(o=n.o)!=null?o:We.default.o,customData:(r=n.customData)!=null?r:We.default.customData()}))}),e.length?e:[new this({b:We.default.b,o:We.default.o,customData:We.default.customData()})]}toJSON(){return{b:this.time,o:this.toggle,customData:vt(this.customData)}}get time(){return this.data.b}set time(t){this.data.b=t}get toggle(){return this.data.o}set toggle(t){this.data.o=t}get customData(){return this.data.customData}set customData(t){this.data.customData=t}setCustomData(t){return this.customData=t,this}addCustomData(t){return this.customData={...this.customData,object:t},this}isValid(){return!0}};let bi=We;O(bi,"default",{b:0,o:!1,customData:()=>({})});const ae=class extends Sd{constructor(t){super(t),this.data.f===1&&(this.p0=this.p0?this.p0:1)}static create(t={}){var e,n,a,o,r,s,l,c,u;return new ae({f:(e=t.f)!=null?e:ae.default.f,p:(n=t.p)!=null?n:ae.default.p,t:(a=t.t)!=null?a:ae.default.t,r:(o=t.r)!=null?o:ae.default.r,c:(r=t.c)!=null?r:ae.default.c,n:(s=t.n)!=null?s:ae.default.n,s:(l=t.s)!=null?l:ae.default.s,l:(c=t.l)!=null?c:ae.default.l,d:(u=t.d)!=null?u:ae.default.d})}toJSON(){return{f:this.type,p:this.p0,t:this.p1,r:this.reverse,c:this.chunks,n:this.random,s:this.seed,l:this.limit,d:this.limitAffectsType}}get type(){return this.data.f}set type(t){this.data.f=t}get p0(){return this.data.p}set p0(t){this.data.p=t}get p1(){return this.data.t}set p1(t){this.data.t=t}get reverse(){return this.data.r}set reverse(t){this.data.r=t}get chunks(){return this.data.c}set chunks(t){this.data.c=t}get limit(){return this.data.l}set limit(t){this.data.l=t}get limitAffectsType(){return this.data.d}set limitAffectsType(t){this.data.d=t}get random(){return this.data.n}set random(t){this.data.n=t}get seed(){return this.data.s}set seed(t){this.data.s=t}};let gt=ae;O(gt,"default",{f:1,p:0,t:0,r:0,c:0,n:0,s:0,l:0,d:0});const Gt=class extends Td{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,o,r,s,l,c;return e.push(new this({b:(a=n.b)!=null?a:Gt.default.b,i:(o=n.i)!=null?o:Gt.default.i,c:(r=n.c)!=null?r:Gt.default.c,s:(s=n.s)!=null?s:Gt.default.s,f:(l=n.f)!=null?l:Gt.default.f,customData:(c=n.customData)!=null?c:Gt.default.customData()}))}),e.length?e:[new this({b:Gt.default.b,i:Gt.default.i,c:Gt.default.c,s:Gt.default.s,f:Gt.default.f,customData:Gt.default.customData()})]}toJSON(){return{b:this.time,i:this.transition,c:this.color,s:this.brightness,f:this.frequency,customData:vt(this.data.customData)}}get time(){return this.data.b}set time(t){this.data.b=t}get transition(){return this.data.i}set transition(t){this.data.i=t}get color(){return this.data.c}set color(t){this.data.c=t}get brightness(){return this.data.s}set brightness(t){this.data.s=t}get frequency(){return this.data.f}set frequency(t){this.data.f=t}get customData(){return this.data.customData}set customData(t){this.data.customData=t}setCustomData(t){return this.customData=t,this}addCustomData(t){return this.customData={...this.customData,object:t},this}};let Mn=Gt;O(Mn,"default",{b:0,i:0,c:0,s:1,f:0,customData:()=>({})});const Bt=class extends Ld{constructor(e){super(e);O(this,"_f");O(this,"_e");this._f=gt.create(e.f),this._e=e.e.map(a=>Mn.create(a)[0]);const n=Math.max(...this._e.map(a=>a.time));this.beatDistributionType===2&&(this.beatDistribution=this.beatDistribution<n?n:this.beatDistribution)}static create(...e){const n=[];return e==null||e.forEach(a=>{var o,r,s,l,c,u,d,m,h;return n.push(new this({f:(o=a.f)!=null?o:Bt.default.f(),w:(r=a.w)!=null?r:Bt.default.w,d:(s=a.d)!=null?s:Bt.default.d,r:(l=a.r)!=null?l:Bt.default.r,t:(c=a.t)!=null?c:Bt.default.t,b:(u=a.b)!=null?u:Bt.default.b,i:(d=a.i)!=null?d:Bt.default.i,e:(m=a.e)!=null?m:Bt.default.e(),customData:(h=a.customData)!=null?h:Bt.default.customData()}))}),n.length?n:[new this({f:Bt.default.f(),w:Bt.default.w,d:Bt.default.d,r:Bt.default.r,t:Bt.default.t,b:Bt.default.b,i:Bt.default.i,e:Bt.default.e(),customData:Bt.default.customData()})]}toJSON(){return{f:this.filter.toJSON(),w:this.beatDistribution,d:this.beatDistributionType,r:this.brightnessDistribution,t:this.brightnessDistributionType,b:this.affectFirst,i:this.easing,e:this.events.map(e=>e.toJSON()),customData:vt(this.customData)}}get filter(){return this._f}set filter(e){this._f=e}get beatDistribution(){return this.data.w}set beatDistribution(e){this.data.w=e}get beatDistributionType(){return this.data.d}set beatDistributionType(e){this.data.d=e}get brightnessDistribution(){return this.data.r}set brightnessDistribution(e){this.data.r=e}get brightnessDistributionType(){return this.data.t}set brightnessDistributionType(e){this.data.t=e}get affectFirst(){return this.data.b}set affectFirst(e){this.data.b=e?1:0}get easing(){return this.data.i}set easing(e){this.data.i=e}get events(){return this._e}set events(e){this._e=e}get customData(){return this.data.customData}set customData(e){this.data.customData=e}setCustomData(e){return this.customData=e,this}addCustomData(e){return this.customData={...this.customData,object:e},this}setEvents(e){return this.events=e,this}};let Pn=Bt;O(Pn,"default",{f:()=>({f:gt.default.f,p:gt.default.p,t:gt.default.t,r:gt.default.r,c:gt.default.c,l:gt.default.l,d:gt.default.d,n:gt.default.n,s:gt.default.s}),w:0,d:1,r:0,t:1,b:0,i:0,e:()=>[],customData:()=>({})});const Ce=class extends kd{constructor(e){super(e);O(this,"_e");this._e=e.e.map(n=>Pn.create(n)[0])}static create(...e){const n=[];return e==null||e.forEach(a=>{var o,r,s,l;return n.push(new this({b:(o=a.b)!=null?o:Ce.default.b,g:(r=a.g)!=null?r:Ce.default.g,e:(s=a.e)!=null?s:Ce.default.e(),customData:(l=a.customData)!=null?l:Ce.default.customData()}))}),n.length?n:[new this({b:Ce.default.b,g:Ce.default.g,e:Ce.default.e(),customData:Ce.default.customData()})]}toJSON(){return{b:this.time,g:this.id,e:this.events.map(e=>e.toJSON()),customData:vt(this.customData)}}get time(){return this.data.b}set time(e){this.data.b=e}get id(){return this.data.g}set id(e){this.data.g=e}get events(){return this._e}set events(e){this._e=e}get customData(){return this.data.customData}set customData(e){this.data.customData=e}setCustomData(e){return this.customData=e,this}addCustomData(e){return this.customData={...this.customData,object:e},this}isValid(){return this.id>=0}};let Fi=Ce;O(Fi,"default",{b:0,g:0,e:()=>[],customData:()=>({})});const zt=class extends Rd{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,o,r,s,l,c,u;return e.push(new this({b:(a=n.b)!=null?a:zt.default.b,p:(o=n.p)!=null?o:zt.default.p,e:(r=n.e)!=null?r:zt.default.e,l:(s=n.l)!=null?s:zt.default.l,r:(l=n.r)!=null?l:zt.default.r,o:(c=n.o)!=null?c:zt.default.o,customData:(u=n.customData)!=null?u:zt.default.customData()}))}),e.length?e:[new this({b:zt.default.b,p:zt.default.p,e:zt.default.e,l:zt.default.l,r:zt.default.r,o:zt.default.o,customData:zt.default.customData()})]}toJSON(){return{b:this.time,p:this.previous,e:this.easing,l:this.loop,r:this.rotation,o:this.direction,customData:vt(this.data.customData)}}get time(){return this.data.b}set time(t){this.data.b=t}get previous(){return this.data.p}set previous(t){this.data.p=t}get easing(){return this.data.e}set easing(t){this.data.e=t}get loop(){return this.data.l}set loop(t){this.data.l=t}get rotation(){return this.data.r}set rotation(t){this.data.r=t}get direction(){return this.data.o}set direction(t){this.data.o=t}get customData(){return this.data.customData}set customData(t){this.data.customData=t}setCustomData(t){return this.customData=t,this}addCustomData(t){return this.customData={...this.customData,object:t},this}};let Fn=zt;O(Fn,"default",{b:0,p:0,e:0,l:0,r:0,o:0,customData:()=>({})});const Lt=class extends xd{constructor(e){super(e);O(this,"_f");O(this,"_l");this._f=gt.create(e.f),this._l=e.l.map(a=>Fn.create(a)[0]);const n=Math.max(...this._l.map(a=>a.time));this.beatDistributionType===2&&(this.beatDistribution=this.beatDistribution<n?n:this.beatDistribution)}static create(...e){const n=[];return e==null||e.forEach(a=>{var o,r,s,l,c,u,d,m,h,p,g;return n.push(new this({f:(o=a.f)!=null?o:Lt.default.f(),w:(r=a.w)!=null?r:Lt.default.w,d:(s=a.d)!=null?s:Lt.default.d,s:(l=a.s)!=null?l:Lt.default.s,t:(c=a.t)!=null?c:Lt.default.t,a:(u=a.a)!=null?u:Lt.default.a,r:(d=a.r)!=null?d:Lt.default.r,b:(m=a.b)!=null?m:Lt.default.b,i:(h=a.i)!=null?h:Lt.default.i,l:(p=a.l)!=null?p:Lt.default.l(),customData:(g=a.customData)!=null?g:Lt.default.customData()}))}),n.length?n:[new this({f:Lt.default.f(),w:Lt.default.w,d:Lt.default.d,s:Lt.default.s,t:Lt.default.t,a:Lt.default.a,r:Lt.default.r,b:Lt.default.b,i:Lt.default.i,l:Lt.default.l(),customData:Lt.default.customData()})]}toJSON(){return{f:this.filter.toJSON(),w:this.beatDistribution,d:this.beatDistributionType,s:this.rotationDistribution,t:this.rotationDistributionType,a:this.axis,r:this.flip,b:this.affectFirst,l:this.events.map(e=>e.toJSON()),i:this.easing,customData:vt(this.customData)}}get filter(){return this._f}set filter(e){this._f=e}get beatDistribution(){return this.data.w}set beatDistribution(e){this.data.w=e}get beatDistributionType(){return this.data.d}set beatDistributionType(e){this.data.d=e}get rotationDistribution(){return this.data.s}set rotationDistribution(e){this.data.s=e}get rotationDistributionType(){return this.data.t}set rotationDistributionType(e){this.data.t=e}get axis(){return this.data.a}set axis(e){this.data.a=e}get flip(){return this.data.r}set flip(e){this.data.r=e?1:0}get affectFirst(){return this.data.b}set affectFirst(e){this.data.b=e?1:0}get easing(){return this.data.i}set easing(e){this.data.i=e}get events(){return this._l}set events(e){this._l=e}get customData(){return this.data.customData}set customData(e){this.data.customData=e}setCustomData(e){return this.customData=e,this}addCustomData(e){return this.customData={...this.customData,object:e},this}setEvents(e){return this.events=e,this}};let Hn=Lt;O(Hn,"default",{f:()=>({f:gt.default.f,p:gt.default.p,t:gt.default.t,r:gt.default.r,c:gt.default.c,l:gt.default.l,d:gt.default.d,n:gt.default.n,s:gt.default.s}),w:0,d:1,s:0,t:1,a:0,r:0,b:0,i:0,l:()=>[],customData:()=>({})});const ke=class extends Nd{constructor(e){super(e);O(this,"_e");this._e=e.e.map(n=>Hn.create(n)[0])}static create(...e){const n=[];return e==null||e.forEach(a=>{var o,r,s,l;return n.push(new this({b:(o=a.b)!=null?o:ke.default.b,g:(r=a.g)!=null?r:ke.default.g,e:(s=a.e)!=null?s:ke.default.e(),customData:(l=a.customData)!=null?l:ke.default.customData()}))}),n.length?n:[new this({b:ke.default.b,g:ke.default.g,e:ke.default.e(),customData:ke.default.customData()})]}toJSON(){return{b:this.time,g:this.id,e:this.events.map(e=>e.toJSON()),customData:vt(this.customData)}}get time(){return this.data.b}set time(e){this.data.b=e}get id(){return this.data.g}set id(e){this.data.g=e}get events(){return this._e}set events(e){this._e=e}get customData(){return this.data.customData}set customData(e){this.data.customData=e}setCustomData(e){return this.customData=e,this}addCustomData(e){return this.customData={...this.customData,object:e},this}isValid(){return this.id>=0}};let Hi=ke;O(Hi,"default",{b:0,g:0,e:()=>[],customData:()=>({})});class Bd extends Cr{setTranslationDistribution(t){return this.translationDistribution=t,this}setTranslationDistributionType(t){return this.translationDistributionType=t,this}setAxis(t){return this.axis=t,this}setFlip(t){return this.flip=t,this}setAffectFirst(t){return this.affectFirst=t,this}isValid(){return super.isValid()&&(this.translationDistributionType===1||this.translationDistributionType===2)&&(this.axis===0||this.axis===1)&&(this.flip===0||this.flip===1)&&(this.affectFirst===0||this.affectFirst===1)}}class $d extends Pe{setPrevious(t){return this.previous=t,this}setEasing(t){return this.easing=t,this}setTranslation(t){return this.translation=t,this}isValid(){return(this.previous===0||this.previous===1)&&this.easing>=-1&&this.easing<=3}}const re=class extends $d{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,o,r,s,l;return e.push(new this({b:(a=n.b)!=null?a:re.default.b,p:(o=n.p)!=null?o:re.default.p,e:(r=n.e)!=null?r:re.default.e,t:(s=n.t)!=null?s:re.default.t,customData:(l=n.customData)!=null?l:re.default.customData()}))}),e.length?e:[new this({b:re.default.b,p:re.default.p,e:re.default.e,t:re.default.t,customData:re.default.customData()})]}toJSON(){return{b:this.time,p:this.previous,e:this.easing,t:this.translation,customData:vt(this.data.customData)}}get time(){return this.data.b}set time(t){this.data.b=t}get previous(){return this.data.p}set previous(t){this.data.p=t}get easing(){return this.data.e}set easing(t){this.data.e=t}get translation(){return this.data.t}set translation(t){this.data.t=t}get customData(){return this.data.customData}set customData(t){this.data.customData=t}setCustomData(t){return this.customData=t,this}addCustomData(t){return this.customData={...this.customData,object:t},this}};let zn=re;O(zn,"default",{b:0,p:0,e:0,t:0,customData:()=>({})});const Ct=class extends Bd{constructor(e){super(e);O(this,"_f");O(this,"_l");this._f=gt.create(e.f),this._l=e.l.map(a=>zn.create(a)[0]);const n=Math.max(...this._l.map(a=>a.time));this.beatDistributionType===2&&(this.beatDistribution=this.beatDistribution<n?n:this.beatDistribution)}static create(...e){const n=[];return e==null||e.forEach(a=>{var o,r,s,l,c,u,d,m,h,p,g;return n.push(new this({f:(o=a.f)!=null?o:Ct.default.f(),w:(r=a.w)!=null?r:Ct.default.w,d:(s=a.d)!=null?s:Ct.default.d,s:(l=a.s)!=null?l:Ct.default.s,t:(c=a.t)!=null?c:Ct.default.t,a:(u=a.a)!=null?u:Ct.default.a,r:(d=a.r)!=null?d:Ct.default.r,b:(m=a.b)!=null?m:Ct.default.b,i:(h=a.i)!=null?h:Ct.default.i,l:(p=a.l)!=null?p:Ct.default.l(),customData:(g=a.customData)!=null?g:Ct.default.customData()}))}),n.length?n:[new this({f:Ct.default.f(),w:Ct.default.w,d:Ct.default.d,s:Ct.default.s,t:Ct.default.t,a:Ct.default.a,r:Ct.default.r,b:Ct.default.b,i:Ct.default.i,l:Ct.default.l(),customData:Ct.default.customData()})]}toJSON(){return{f:this.filter.toJSON(),w:this.beatDistribution,d:this.beatDistributionType,s:this.translationDistribution,t:this.translationDistributionType,a:this.axis,r:this.flip,b:this.affectFirst,l:this.events.map(e=>e.toJSON()),i:this.easing,customData:vt(this.customData)}}get filter(){return this._f}set filter(e){this._f=e}get beatDistribution(){return this.data.w}set beatDistribution(e){this.data.w=e}get beatDistributionType(){return this.data.d}set beatDistributionType(e){this.data.d=e}get translationDistribution(){return this.data.s}set translationDistribution(e){this.data.s=e}get translationDistributionType(){return this.data.t}set translationDistributionType(e){this.data.t=e}get axis(){return this.data.a}set axis(e){this.data.a=e}get flip(){return this.data.r}set flip(e){this.data.r=e?1:0}get affectFirst(){return this.data.b}set affectFirst(e){this.data.b=e?1:0}get easing(){return this.data.i}set easing(e){this.data.i=e}get events(){return this._l}set events(e){this._l=e}get customData(){return this.data.customData}set customData(e){this.data.customData=e}setCustomData(e){return this.customData=e,this}addCustomData(e){return this.customData={...this.customData,object:e},this}setEvents(e){return this.events=e,this}};let Xn=Ct;O(Xn,"default",{f:()=>({f:gt.default.f,p:gt.default.p,t:gt.default.t,r:gt.default.r,c:gt.default.c,l:gt.default.l,d:gt.default.d,n:gt.default.n,s:gt.default.s}),w:0,d:1,s:0,t:1,a:0,r:0,b:0,i:0,l:()=>[],customData:()=>({})});class Od extends kr{}const Re=class extends Od{constructor(e){super(e);O(this,"_e");this._e=e.e.map(n=>Xn.create(n)[0])}static create(...e){const n=[];return e==null||e.forEach(a=>{var o,r,s,l;return n.push(new this({b:(o=a.b)!=null?o:Re.default.b,g:(r=a.g)!=null?r:Re.default.g,e:(s=a.e)!=null?s:Re.default.e(),customData:(l=a.customData)!=null?l:Re.default.customData()}))}),n.length?n:[new this({b:Re.default.b,g:Re.default.g,e:Re.default.e(),customData:Re.default.customData()})]}toJSON(){return{b:this.time,g:this.id,e:this.events.map(e=>e.toJSON()),customData:vt(this.customData)}}get time(){return this.data.b}set time(e){this.data.b=e}get id(){return this.data.g}set id(e){this.data.g=e}get events(){return this._e}set events(e){this._e=e}get customData(){return this.data.customData}set customData(e){this.data.customData=e}setCustomData(e){return this.customData=e,this}addCustomData(e){return this.customData={...this.customData,object:e},this}isValid(){return this.id>=0}};let Un=Re;O(Un,"default",{b:0,g:0,e:()=>[],customData:()=>({})});const xe=class extends Id{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,o,r,s;return e.push(new this({b:(a=n.b)!=null?a:xe.default.b,e:(o=n.e)!=null?o:xe.default.e,r:(r=n.r)!=null?r:xe.default.r,customData:(s=n.customData)!=null?s:xe.default.customData()}))}),e.length?e:[new this({b:xe.default.b,e:xe.default.e,r:xe.default.r,customData:xe.default.customData()})]}toJSON(){return{b:this.time,e:this.executionTime,r:this.rotation,customData:vt(this.customData)}}get time(){return this.data.b}set time(t){this.data.b=t}get executionTime(){return this.data.e}set executionTime(t){this.data.e=t}get rotation(){return this.data.r}set rotation(t){this.data.r=t}get customData(){return this.data.customData}set customData(t){this.data.customData=t}setCustomData(t){return this.customData=t,this}addCustomData(t){return this.customData={...this.customData,object:t},this}};let yi=xe;O(yi,"default",{b:0,e:0,r:0,customData:()=>({})});const Dt=class extends xc{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,o,r,s,l,c,u,d,m,h,p,g,b;return e.push(new this({b:(a=n.b)!=null?a:Dt.default.b,c:(o=n.c)!=null?o:Dt.default.c,x:(r=n.x)!=null?r:Dt.default.x,y:(s=n.y)!=null?s:Dt.default.y,d:(l=n.d)!=null?l:Dt.default.d,mu:(c=n.mu)!=null?c:Dt.default.mu,tb:(u=n.tb)!=null?u:Dt.default.tb,tx:(d=n.tx)!=null?d:Dt.default.tx,ty:(m=n.ty)!=null?m:Dt.default.ty,tc:(h=n.tc)!=null?h:Dt.default.tc,tmu:(p=n.tmu)!=null?p:Dt.default.tmu,m:(g=n.m)!=null?g:Dt.default.m,customData:(b=n.customData)!=null?b:Dt.default.customData()}))}),e.length?e:[new this({b:Dt.default.b,c:Dt.default.c,x:Dt.default.x,y:Dt.default.y,d:Dt.default.d,mu:Dt.default.mu,tb:Dt.default.tb,tx:Dt.default.tx,ty:Dt.default.ty,tc:Dt.default.tc,tmu:Dt.default.tmu,m:Dt.default.m,customData:Dt.default.customData()})]}toJSON(){return{b:this.time,c:this.color,x:this.posX,y:this.posY,d:this.direction,mu:this.lengthMultiplier,tb:this.tailTime,tx:this.tailPosX,ty:this.tailPosY,tc:this.tailDirection,tmu:this.tailLengthMultiplier,m:this.midAnchor,customData:vt(this.customData)}}get time(){return this.data.b}set time(t){this.data.b=t}get posX(){return this.data.x}set posX(t){this.data.x=t}get posY(){return this.data.y}set posY(t){this.data.y=t}get color(){return this.data.c}set color(t){this.data.c=t}get direction(){return this.data.d}set direction(t){this.data.d=t}get lengthMultiplier(){return this.data.mu}set lengthMultiplier(t){this.data.mu=t}get tailTime(){return this.data.tb}set tailTime(t){this.data.tb=t}get tailPosX(){return this.data.tx}set tailPosX(t){this.data.tx=t}get tailPosY(){return this.data.ty}set tailPosY(t){this.data.ty=t}get tailDirection(){return this.data.tc}set tailDirection(t){this.data.tc=t}get tailLengthMultiplier(){return this.data.tmu}set tailLengthMultiplier(t){this.data.tmu=t}get midAnchor(){return this.data.m}set midAnchor(t){this.data.m=t}get customData(){return this.data.customData}set customData(t){this.data.customData=t}setCustomData(t){return this.customData=t,this}addCustomData(t){return this.customData={...this.customData,object:t},this}mirror(t=!0){return this.customData.coordinates&&(this.customData.coordinates[0]=-1-this.customData.coordinates[0]),this.customData.flip&&(this.customData.flip[0]=-1-this.customData.flip[0]),this.customData.animation&&(Array.isArray(this.customData.animation.definitePosition)&&this.customData.animation.definitePosition.forEach(e=>{e[0]=-e[0]}),Array.isArray(this.customData.animation.offsetPosition)&&this.customData.animation.offsetPosition.forEach(e=>{e[0]=-e[0]})),super.mirror(t)}getTailPosition(t){switch(t){case"ne":return this.customData.tailCoordinates?[this.customData.tailCoordinates[0],this.customData.tailCoordinates[1]]:[this.tailPosX,this.tailPosY];default:return this.customData.tailCoordinates?[this.customData.tailCoordinates[0],this.customData.tailCoordinates[1]]:super.getTailPosition(t)}}};let vi=Dt;O(vi,"default",{b:0,c:0,x:0,y:0,d:0,mu:1,tb:0,tx:0,ty:0,tc:0,tmu:1,m:0,customData:()=>({})});const se=class extends Nc{constructor(t){super(t)}static create(...t){const e=[];return t==null||t.forEach(n=>{var a,o,r,s,l;return e.push(new this({b:(a=n.b)!=null?a:se.default.b,x:(o=n.x)!=null?o:se.default.x,y:(r=n.y)!=null?r:se.default.y,d:(s=n.d)!=null?s:se.default.d,customData:(l=n.customData)!=null?l:se.default.customData()}))}),e.length?e:[new this({b:se.default.b,x:se.default.x,y:se.default.y,d:se.default.d,customData:se.default.customData()})]}toJSON(){return{b:this.time,x:this.posX,y:this.posY,d:this.direction,customData:vt(this.customData)}}get time(){return this.data.b}set time(t){this.data.b=t}get posX(){return this.data.x}set posX(t){this.data.x=t}get posY(){return this.data.y}set posY(t){this.data.y=t}get direction(){return this.data.d}set direction(t){this.data.d=t}get customData(){return this.data.customData}set customData(t){this.data.customData=t}setCustomData(t){return this.customData=t,this}addCustomData(t){return this.customData={...this.customData,object:t},this}};let Ei=se;O(Ei,"default",{b:0,x:0,y:0,d:1,customData:()=>({})});class Ic extends Wi{constructor(e){var n,a,o,r,s,l,c,u,d,m,h,p,g,b,y,v,S,L,C,F,M,j,B,G,tt,w,$,_,H;super(e);O(this,"_fileName","UnnamedDifficulty.dat");O(this,"version");O(this,"bpmEvents");O(this,"rotationEvents");O(this,"colorNotes");O(this,"bombNotes");O(this,"obstacles");O(this,"sliders");O(this,"burstSliders");O(this,"waypoints");O(this,"basicEvents");O(this,"colorBoostEvents");O(this,"lightColorEventBoxGroups");O(this,"lightRotationEventBoxGroups");O(this,"lightTranslationEventBoxGroups");O(this,"basicEventTypesWithKeywords");O(this,"useNormalEventsAsCompatibleEvents");O(this,"customData");this.version="3.2.0",this.bpmEvents=(a=(n=e.bpmEvents)==null?void 0:n.map(Z=>_i.create(Z)[0]))!=null?a:[],this.rotationEvents=(r=(o=e.rotationEvents)==null?void 0:o.map(Z=>yi.create(Z)[0]))!=null?r:[],this.colorNotes=(l=(s=e.colorNotes)==null?void 0:s.map(Z=>Ne.create(Z)[0]))!=null?l:[],this.bombNotes=(u=(c=e.bombNotes)==null?void 0:c.map(Z=>Je.create(Z)[0]))!=null?u:[],this.obstacles=(m=(d=e.obstacles)==null?void 0:d.map(Z=>Vt.create(Z)[0]))!=null?m:[],this.sliders=(p=(h=e.sliders)==null?void 0:h.map(Z=>vi.create(Z)[0]))!=null?p:[],this.burstSliders=(b=(g=e.burstSliders)==null?void 0:g.map(Z=>Pi.create(Z)[0]))!=null?b:[],this.waypoints=(v=(y=e.waypoints)==null?void 0:y.map(Z=>Ei.create(Z)[0]))!=null?v:[],this.basicEvents=(L=(S=e.basicBeatmapEvents)==null?void 0:S.map(Z=>gi.create(Z)[0]))!=null?L:[],this.colorBoostEvents=(F=(C=e.colorBoostBeatmapEvents)==null?void 0:C.map(Z=>bi.create(Z)[0]))!=null?F:[],this.lightColorEventBoxGroups=(j=(M=e.lightColorEventBoxGroups)==null?void 0:M.map(Z=>Fi.create(Z)[0]))!=null?j:[],this.lightRotationEventBoxGroups=(G=(B=e.lightRotationEventBoxGroups)==null?void 0:B.map(Z=>Hi.create(Z)[0]))!=null?G:[],this.lightTranslationEventBoxGroups=(w=(tt=e.lightTranslationEventBoxGroups)==null?void 0:tt.map(Z=>Un.create(Z)[0]))!=null?w:[],this.basicEventTypesWithKeywords=($=cn.create(e.basicEventTypesWithKeywords))!=null?$:{d:[]},this.useNormalEventsAsCompatibleEvents=(_=e.useNormalEventsAsCompatibleEvents)!=null?_:!1,this.customData=(H=e.customData)!=null?H:{}}static create(e={}){var n,a,o,r,s,l,c,u,d,m,h,p,g,b,y,v;return new this({version:"3.2.0",bpmEvents:(n=e.bpmEvents)!=null?n:[],rotationEvents:(a=e.rotationEvents)!=null?a:[],colorNotes:(o=e.colorNotes)!=null?o:[],bombNotes:(r=e.bombNotes)!=null?r:[],obstacles:(s=e.obstacles)!=null?s:[],sliders:(l=e.sliders)!=null?l:[],burstSliders:(c=e.burstSliders)!=null?c:[],waypoints:(u=e.waypoints)!=null?u:[],basicBeatmapEvents:(d=e.basicBeatmapEvents)!=null?d:[],colorBoostBeatmapEvents:(m=e.colorBoostBeatmapEvents)!=null?m:[],lightColorEventBoxGroups:(h=e.lightColorEventBoxGroups)!=null?h:[],lightRotationEventBoxGroups:(p=e.lightRotationEventBoxGroups)!=null?p:[],lightTranslationEventBoxGroups:(g=e.lightTranslationEventBoxGroups)!=null?g:[],basicEventTypesWithKeywords:(b=e.basicEventTypesWithKeywords)!=null?b:{d:[]},useNormalEventsAsCompatibleEvents:(y=e.useNormalEventsAsCompatibleEvents)!=null?y:!1,customData:(v=e.customData)!=null?v:{}})}toJSON(){return{version:"3.2.0",bpmEvents:this.bpmEvents.map(e=>e.toJSON()),rotationEvents:this.rotationEvents.map(e=>e.toJSON()),colorNotes:this.colorNotes.map(e=>e.toJSON()),bombNotes:this.bombNotes.map(e=>e.toJSON()),obstacles:this.obstacles.map(e=>e.toJSON()),sliders:this.sliders.map(e=>e.toJSON()),burstSliders:this.burstSliders.map(e=>e.toJSON()),waypoints:this.waypoints.map(e=>e.toJSON()),basicBeatmapEvents:this.basicEvents.map(e=>e.toJSON()),colorBoostBeatmapEvents:this.colorBoostEvents.map(e=>e.toJSON()),lightColorEventBoxGroups:this.lightColorEventBoxGroups.map(e=>e.toJSON()),lightRotationEventBoxGroups:this.lightRotationEventBoxGroups.map(e=>e.toJSON()),lightTranslationEventBoxGroups:this.lightTranslationEventBoxGroups.map(e=>e.toJSON()),basicEventTypesWithKeywords:this.basicEventTypesWithKeywords.toJSON(),useNormalEventsAsCompatibleEvents:this.useNormalEventsAsCompatibleEvents,customData:vt(this.customData)}}clone(){const e=this.fileName;return super.clone().setFileName(e)}set fileName(e){this._fileName=e.trim()}get fileName(){return this._fileName}setFileName(e){return this.fileName=e,this}nps(e){const n=this.getNoteContainer().filter(a=>a.type!=="bomb");return e?n.length/e:0}peak(e,n){let a=0,o=0;n=typeof n=="number"?be.create(n):n;const r=this.getNoteContainer().filter(s=>s.type!=="bomb");for(let s=0;s<r.length;s++){for(;r[s].data.time-r[o].data.time>e;)o++;a=Math.max(a,(s-o+1)/n.toRealTime(e))}return a}getFirstInteractiveTime(){const e=this.getNoteContainer().filter(o=>o.type!=="bomb");let n=Number.MAX_VALUE;e.length>0&&(n=e[0].data.time);const a=this.findFirstInteractiveObstacleTime();return Math.min(n,a)}getLastInteractiveTime(){const e=this.getNoteContainer().filter(o=>o.type!=="bomb");let n=0;e.length>0&&(n=e[e.length-1].data.time);const a=this.findLastInteractiveObstacleTime();return Math.max(n,a)}findFirstInteractiveObstacleTime(){for(let e=0,n=this.obstacles.length;e<n;e++)if(this.obstacles[e].isInteractive())return this.obstacles[e].time;return Number.MAX_VALUE}findLastInteractiveObstacleTime(){let e=0;for(let n=this.obstacles.length-1;n>=0;n--)this.obstacles[n].isInteractive()&&(e=Math.max(e,this.obstacles[n].time+this.obstacles[n].duration));return e}getNoteContainer(){const e=[];return this.colorNotes.forEach(n=>e.push({type:"note",data:n})),this.sliders.forEach(n=>e.push({type:"slider",data:n})),this.burstSliders.forEach(n=>e.push({type:"burstSlider",data:n})),this.bombNotes.forEach(n=>e.push({type:"bomb",data:n})),e.sort((n,a)=>n.data.time-a.data.time)}getEventContainer(){const e=[];return this.basicEvents.forEach(n=>e.push({type:"basicEvent",data:n})),this.colorBoostEvents.forEach(n=>e.push({type:"boost",data:n})),e.sort((n,a)=>n.data.time-a.data.time)}addBPMEvents(...e){this.bpmEvents.push(...e.map(n=>n instanceof _i?n:_i.create(n)[0]))}addRotationEvents(...e){this.rotationEvents.push(...e.map(n=>n instanceof yi?n:yi.create(n)[0]))}addColorNotes(...e){this.colorNotes.push(...e.map(n=>n instanceof Ne?n:Ne.create(n)[0]))}addBombNotes(...e){this.bombNotes.push(...e.map(n=>n instanceof Je?n:Je.create(n)[0]))}addObstacles(...e){this.obstacles.push(...e.map(n=>n instanceof Vt?n:Vt.create(n)[0]))}addSliders(...e){this.sliders.push(...e.map(n=>n instanceof vi?n:vi.create(n)[0]))}addBurstSliders(...e){this.burstSliders.push(...e.map(n=>n instanceof Pi?n:Pi.create(n)[0]))}addWaypoints(...e){this.waypoints.push(...e.map(n=>n instanceof Ei?n:Ei.create(n)[0]))}addBasicEvents(...e){this.basicEvents.push(...e.map(n=>n instanceof gi?n:gi.create(n)[0]))}addColorBoostEvents(...e){this.colorBoostEvents.push(...e.map(n=>n instanceof bi?n:bi.create(n)[0]))}addLightColorEventBoxGroups(...e){this.lightColorEventBoxGroups.push(...e.map(n=>n instanceof Fi?n:Fi.create(n)[0]))}addLightRotationEventBoxGroups(...e){this.lightRotationEventBoxGroups.push(...e.map(n=>n instanceof Hi?n:Hi.create(n)[0]))}}const Sa=i=>`[shared::parse::${i}]`;function Md(i){return rt.info(Sa("info"),"Parsing beatmap info v2.x.x"),i._difficultyBeatmapSets.sort((t,e)=>Ja[t._beatmapCharacteristicName]-Ja[e._beatmapCharacteristicName]),i._difficultyBeatmapSets.forEach(t=>{let e=0;t._difficultyBeatmaps.forEach(n=>{var a,o;n._difficultyRank-e<=0&&rt.warn(Sa("info"),n._difficulty+" is unordered"),Rl[n._difficulty]!==n._difficultyRank&&rt.error(Sa("info"),n._difficulty+" has invalid rank"),e=n._difficultyRank,typeof((a=n._customData)==null?void 0:a._editorOffset)=="number"&&n._customData._editorOffset===0&&delete n._customData._editorOffset,typeof((o=n._customData)==null?void 0:o._editorOldOffset)=="number"&&n._customData._editorOldOffset===0&&delete n._customData._editorOldOffset}),t._difficultyBeatmaps.sort((n,a)=>n._difficultyRank-a._difficultyRank)}),i}const Ac=i=>`[shared::dataCheck::${i}]`;function Ye(i,t,e){if(t)throw Error(i);rt.warn(Ac("deepCheck"),i),e.push(i)}function un(i,t,e,n,a=!0,o=[]){if(rt.verbose(Ac("deepCheck"),`Looking up ${e}`),Array.isArray(i)){i.forEach((s,l)=>un(s,t,`${e}[${l}]`,n));return}const r=Object.keys(t);for(const s in i){if(!r.length)break;r.includes(s)||Ye(`Unused key ${s} found in ${e}`,!1,o)}for(const s in t){if(typeof i[s]>"u"){if(t[s].optional||yd(n,t[s].version)==="old")continue;Ye(`Missing ${s} in object ${e}!`,a,o)}i[s]==null&&Ye(`${s} contain null value in object ${e}!`,a,o),t[s].type==="array"&&(Array.isArray(i[s])||Ye(`${s} is not an array in object ${e}!`,a,o),un(i[s],t[s].check,`${e} ${s}`,n)),t[s].type==="object"&&(!Array.isArray(i[s])&&typeof i[s]!="object"?Ye(`${s} is not an object in object ${e}!`,a,o):un(i[s],t[s].check,`${e} ${s}`,n)),t[s].type!=="array"&&typeof i[s]!==t[s].type&&Ye(`${s} is not ${t[s].type} in object ${e}!`,a,o),t[s].type==="number"&&typeof i[s]=="number"&&(t[s].int&&i[s]%1!==0&&Ye(`${e} ${s} cannot be float!`,!1,o),t[s].unsigned&&i[s]<0&&Ye(`${e} ${s} cannot be negative!`,!1,o))}}const Pd={_time:{type:"number",version:"2.0.0"},_type:{type:"number",int:!0,unsigned:!0,version:"2.0.0"},_lineIndex:{type:"number",int:!0,version:"2.0.0"},_lineLayer:{type:"number",int:!0,version:"2.0.0"},_cutDirection:{type:"number",int:!0,unsigned:!0,version:"2.0.0"},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},Fd={_colorType:{type:"number",version:"2.0.0"},_headTime:{type:"number",version:"2.0.0"},_headLineIndex:{type:"number",int:!0,version:"2.0.0"},_headLineLayer:{type:"number",int:!0,version:"2.0.0"},_headCutDirection:{type:"number",int:!0,unsigned:!0,version:"2.0.0"},_headControlPointLengthMultiplier:{type:"number",version:"2.0.0"},_tailTime:{type:"number",version:"2.0.0"},_tailLineIndex:{type:"number",int:!0,version:"2.0.0"},_tailLineLayer:{type:"number",int:!0,version:"2.0.0"},_tailCutDirection:{type:"number",int:!0,unsigned:!0,version:"2.0.0"},_tailControlPointLengthMultiplier:{type:"number",version:"2.0.0"},_sliderMidAnchorMode:{type:"number",version:"2.0.0"},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},Hd={_time:{type:"number",version:"2.0.0"},_lineIndex:{type:"number",int:!0,version:"2.0.0"},_lineLayer:{type:"number",int:!0,version:"2.6.0",optional:!0},_type:{type:"number",int:!0,unsigned:!0,version:"2.0.0"},_duration:{type:"number",version:"2.0.0"},_width:{type:"number",int:!0,version:"2.0.0"},_height:{type:"number",int:!0,version:"2.6.0",optional:!0},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},zd={_time:{type:"number",version:"2.0.0"},_type:{type:"number",int:!0,version:"2.0.0"},_value:{type:"number",int:!0,version:"2.0.0"},_floatValue:{type:"number",version:"2.5.0",optional:!0},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},Xd={_time:{type:"number",version:"2.2.0"},_lineIndex:{type:"number",int:!0,version:"2.2.0"},_lineLayer:{type:"number",int:!0,version:"2.2.0"},_offsetDirection:{type:"number",int:!0,version:"2.2.0"},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},Ud={_keyword:{type:"string",version:"2.4.0"},_specialEvents:{type:"number",int:!0,version:"2.4.0"}},jd={_keywords:{type:"array",version:"2.4.0",check:Ud}},Yd={_version:{type:"string",version:"2.0.0"},_notes:{type:"array",version:"2.0.0",check:Pd},_sliders:{type:"array",version:"2.6.0",check:Fd},_obstacles:{type:"array",version:"2.0.0",check:Hd},_events:{type:"array",version:"2.0.0",check:zd},_waypoints:{type:"array",version:"2.2.0",check:Xd,optional:!0},_specialEventsKeywordFilters:{type:"object",version:"2.4.0",check:jd,optional:!0},_customData:{type:"object",version:"2.0.0",check:{},optional:!0}},po=i=>`[v2::parse::${i}]`,Cn=(i,t)=>i._time-t._time;function Gd(i,t={enable:!0,throwError:!0}){var e,n,a,o,r,s;return rt.info(po("difficulty"),"Parsing beatmap difficulty v2.x.x"),(e=i._version)!=null&&e.startsWith("2")||(rt.warn(po("difficulty"),"Unidentified beatmap version"),i._version="2.0.0"),t.enable&&un(i,Yd,"difficulty",i._version,t.throwError),i._notes=(n=i._notes)!=null?n:[],i._sliders=(a=i._sliders)!=null?a:[],i._obstacles=(o=i._obstacles)!=null?o:[],i._events=(r=i._events)!=null?r:[],i._waypoints=(s=i._waypoints)!=null?s:[],i._notes.sort(Cn),i._sliders.sort((l,c)=>l._headTime-c._headTime),i._obstacles.sort(Cn),i._events.sort(Cn),i._waypoints.sort(Cn),Ad.create(i)}const Wd={b:{type:"number",version:"3.0.0"},c:{type:"number",int:!0,version:"3.0.0"},x:{type:"number",int:!0,version:"3.0.0"},y:{type:"number",int:!0,version:"3.0.0"},d:{type:"number",int:!0,version:"3.0.0"},a:{type:"number",int:!0,version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Vd={b:{type:"number",version:"3.0.0"},x:{type:"number",int:!0,version:"3.0.0"},y:{type:"number",int:!0,version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Jd={b:{type:"number",version:"3.0.0"},c:{type:"number",int:!0,version:"3.0.0"},x:{type:"number",int:!0,version:"3.0.0"},y:{type:"number",int:!0,version:"3.0.0"},d:{type:"number",int:!0,version:"3.0.0"},mu:{type:"number",version:"3.0.0"},tb:{type:"number",version:"3.0.0"},tx:{type:"number",int:!0,version:"3.0.0"},ty:{type:"number",int:!0,version:"3.0.0"},tc:{type:"number",int:!0,version:"3.0.0"},tmu:{type:"number",version:"3.0.0"},m:{type:"number",int:!0,version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},qd={b:{type:"number",version:"3.0.0"},c:{type:"number",int:!0,version:"3.0.0"},x:{type:"number",int:!0,version:"3.0.0"},y:{type:"number",int:!0,version:"3.0.0"},d:{type:"number",int:!0,version:"3.0.0"},tb:{type:"number",version:"3.0.0"},tx:{type:"number",int:!0,version:"3.0.0"},ty:{type:"number",int:!0,version:"3.0.0"},sc:{type:"number",int:!0,version:"3.0.0"},s:{type:"number",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Zd={b:{type:"number",version:"3.0.0"},x:{type:"number",int:!0,version:"3.0.0"},y:{type:"number",int:!0,version:"3.0.0"},d:{type:"number",version:"3.0.0"},w:{type:"number",int:!0,version:"3.0.0"},h:{type:"number",int:!0,version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Kd={b:{type:"number",version:"3.0.0"},et:{type:"number",int:!0,version:"3.0.0"},i:{type:"number",int:!0,version:"3.0.0"},f:{type:"number",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Qd={b:{type:"number",version:"3.0.0"},m:{type:"number",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},tf={b:{type:"number",version:"3.0.0"},e:{type:"number",int:!0,version:"3.0.0"},r:{type:"number",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},ef={b:{type:"number",version:"3.0.0"},o:{type:"boolean",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},Rr={f:{type:"number",int:!0,version:"3.0.0"},p:{type:"number",version:"3.0.0"},t:{type:"number",version:"3.0.0"},r:{type:"number",int:!0,version:"3.0.0"},c:{type:"number",int:!0,version:"3.1.0"},l:{type:"number",version:"3.1.0"},d:{type:"number",int:!0,version:"3.1.0"},n:{type:"number",int:!0,version:"3.1.0"},s:{type:"number",int:!0,version:"3.1.0"}},nf={b:{type:"number",version:"3.0.0"},i:{type:"number",int:!0,version:"3.0.0"},c:{type:"number",int:!0,version:"3.0.0"},s:{type:"number",version:"3.0.0"},f:{type:"number",version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},af={f:{type:"object",version:"3.0.0",check:Rr},w:{type:"number",version:"3.0.0"},d:{type:"number",int:!0,version:"3.0.0"},r:{type:"number",version:"3.0.0"},t:{type:"number",int:!0,version:"3.0.0"},e:{type:"array",version:"3.0.0",check:nf},b:{type:"number",int:!0,version:"3.0.0"},i:{type:"number",int:!0,version:"3.2.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},rf={b:{type:"number",version:"3.0.0"},g:{type:"number",int:!0,version:"3.0.0"},e:{type:"array",version:"3.0.0",check:af},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},sf={b:{type:"number",version:"3.0.0"},p:{type:"number",int:!0,version:"3.0.0"},e:{type:"number",int:!0,version:"3.0.0"},l:{type:"number",version:"3.0.0"},r:{type:"number",version:"3.0.0"},o:{type:"number",int:!0,version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},of={f:{type:"object",version:"3.0.0",check:Rr},w:{type:"number",version:"3.0.0"},d:{type:"number",int:!0,version:"3.0.0"},s:{type:"number",version:"3.0.0"},t:{type:"number",int:!0,version:"3.0.0"},a:{type:"number",int:!0,version:"3.0.0"},l:{type:"array",version:"3.0.0",check:sf},r:{type:"number",int:!0,version:"3.0.0"},b:{type:"number",int:!0,version:"3.0.0"},i:{type:"number",int:!0,version:"3.2.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},lf={b:{type:"number",version:"3.0.0"},g:{type:"number",int:!0,version:"3.0.0"},e:{type:"array",version:"3.0.0",check:of},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},cf={b:{type:"number",version:"3.2.0"},p:{type:"number",int:!0,version:"3.2.0"},e:{type:"number",int:!0,version:"3.2.0"},t:{type:"number",version:"3.2.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},uf={f:{type:"object",version:"3.2.0",check:Rr},w:{type:"number",version:"3.2.0"},d:{type:"number",int:!0,version:"3.2.0"},s:{type:"number",version:"3.2.0"},t:{type:"number",int:!0,version:"3.2.0"},a:{type:"number",int:!0,version:"3.2.0"},l:{type:"array",version:"3.2.0",check:cf},r:{type:"number",int:!0,version:"3.2.0"},b:{type:"number",int:!0,version:"3.2.0"},i:{type:"number",int:!0,version:"3.2.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},hf={b:{type:"number",version:"3.2.0"},g:{type:"number",int:!0,version:"3.2.0"},e:{type:"array",version:"3.2.0",check:uf},customData:{type:"object",version:"3.2.0",check:{},optional:!0}},df={k:{type:"string",version:"3.0.0"},e:{type:"number",int:!0,version:"3.0.0"}},ff={d:{type:"array",version:"3.0.0",check:df,optional:!0}},mf={b:{type:"number",version:"3.0.0"},d:{type:"number",int:!0,version:"3.0.0"},x:{type:"number",int:!0,version:"3.0.0"},y:{type:"number",int:!0,version:"3.0.0"},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},pf={version:{type:"string",version:"3.0.0"},bpmEvents:{type:"array",version:"3.0.0",check:Qd,optional:!0},rotationEvents:{type:"array",version:"3.0.0",check:tf,optional:!0},colorNotes:{type:"array",version:"3.0.0",check:Wd,optional:!0},bombNotes:{type:"array",version:"3.0.0",check:Vd,optional:!0},obstacles:{type:"array",version:"3.0.0",check:Zd,optional:!0},sliders:{type:"array",version:"3.0.0",check:Jd,optional:!0},burstSliders:{type:"array",version:"3.0.0",check:qd,optional:!0},waypoints:{type:"array",version:"3.0.0",check:mf,optional:!0},basicBeatmapEvents:{type:"array",version:"3.0.0",check:Kd,optional:!0},colorBoostBeatmapEvents:{type:"array",version:"3.0.0",check:ef,optional:!0},lightColorEventBoxGroups:{type:"array",version:"3.0.0",check:rf,optional:!0},lightRotationEventBoxGroups:{type:"array",version:"3.0.0",check:lf,optional:!0},lightTranslationEventBoxGroups:{type:"array",version:"3.2.0",check:hf,optional:!0},basicEventTypesWithKeywords:{type:"object",version:"3.0.0",check:ff},useNormalEventsAsCompatibleEvents:{type:"boolean",version:"3.0.0",optional:!0},customData:{type:"object",version:"3.0.0",check:{},optional:!0}},go=i=>`[v3::parse::${i}]`,te=(i,t)=>i.b-t.b;function gf(i,t={enable:!0,throwError:!0}){var e,n,a,o,r,s,l,c,u,d,m,h;return rt.info(go("difficulty"),"Parsing beatmap difficulty v3.x.x"),i.version==="3.0.0"||i.version==="3.1.0"||i.version==="3.2.0"||(rt.warn(go("difficulty"),"Unidentified beatmap version"),i.version="3.0.0"),t.enable&&un(i,pf,"difficulty",i.version,t.throwError),i.bpmEvents=(e=i.bpmEvents)!=null?e:[],i.rotationEvents=(n=i.rotationEvents)!=null?n:[],i.colorNotes=(a=i.colorNotes)!=null?a:[],i.bombNotes=(o=i.bombNotes)!=null?o:[],i.obstacles=(r=i.obstacles)!=null?r:[],i.sliders=(s=i.sliders)!=null?s:[],i.burstSliders=(l=i.burstSliders)!=null?l:[],i.waypoints=(c=i.waypoints)!=null?c:[],i.basicBeatmapEvents=(u=i.basicBeatmapEvents)!=null?u:[],i.colorBoostBeatmapEvents=(d=i.colorBoostBeatmapEvents)!=null?d:[],i.lightColorEventBoxGroups=(m=i.lightColorEventBoxGroups)!=null?m:[],i.lightRotationEventBoxGroups=(h=i.lightRotationEventBoxGroups)!=null?h:[],i.bpmEvents.sort(te),i.rotationEvents.sort(te),i.colorNotes.sort(te),i.bombNotes.sort(te),i.obstacles.sort(te),i.sliders.sort(te),i.burstSliders.sort(te),i.waypoints.sort(te),i.basicBeatmapEvents.sort(te),i.colorBoostBeatmapEvents.sort(te),i.lightColorEventBoxGroups.sort(te),i.lightRotationEventBoxGroups.sort(te),Ic.create(i)}const _o="NJS Check",bo="Check note jump speed for suitable value.",yo=!0,da={name:_o,description:bo,type:"other",order:{input:ft.OTHERS_NJS,output:mt.OTHERS_NJS},input:{enabled:yo,params:{},html:ut.create(_o,bo,yo,function(){da.input.enabled=this.checked})},output:{html:null},run:_f};function _f(i){if(!i.difficulty){console.error("Something went wrong!");return}const{njs:t,bpm:e}=i.settings,n=[];if(i.difficulty.info._noteJumpMovementSpeed===0&&n.push(pt("Unset NJS","fallback NJS is used")),t.value>23&&n.push(pt(`NJS is too high (${A(t.value,2)})`,"use lower whenever necessary")),t.value<3&&n.push(pt(`NJS is too low (${A(t.value,2)})`,"timing is less significant below this")),t.jd>36&&n.push(pt("Very high jump distance",`${A(t.jd,2)}`)),t.jd<18&&n.push(pt("Very low jump distance",`${A(t.jd,2)}`)),t.jd>t.calcJDOptimalHigh()&&n.push(pt(`High jump distance warning (>${A(t.calcJDOptimalHigh(),2)})`,"NJS & offset may be uncomfortable to play")),e.toRealTime(t.hjd)<.42&&n.push(pt(`Very quick reaction time (${A(e.toRealTime(t.hjd)*1e3)}ms)`,"may lead to suboptimal gameplay")),t.calcHJDRaw()+t.offset<oe.HJD_MIN&&n.push(pt("Unnecessary negative offset",`will not drop below ${oe.HJD_MIN}`)),n.length){const a=document.createElement("div");n.forEach(o=>a.append(o)),da.output.html=a}else da.output.html=null}const vo="Outside Playable Object",Eo="Look for any object starting before and after song timer.",Do=!0,fa={name:vo,description:Eo,type:"other",order:{input:ft.OTHERS_OUTSIDE_PLAYABLE,output:mt.OTHERS_OUTSIDE_PLAYABLE},input:{enabled:Do,params:{},html:ut.create(vo,Eo,Do,function(){fa.input.enabled=this.checked})},output:{html:null},run:bf};function bf(i){if(!i.difficulty){console.error("Something went wrong!");return}const{bpm:t,audioDuration:e}=i.settings,{colorNotes:n,bombNotes:a,obstacles:o,basicEvents:r,sliders:s,burstSliders:l}=i.difficulty.data,c=[];if(e){let u=t.toBeatTime(e,!0);n.length&&n[0].time<0&&c.push(pt("Note(s) before start time",`${A(n[0].time,3)} (${kt(t.toRealTime(n[0].time))}`)),a.length&&a[0].time<0&&c.push(pt("Bomb(s) before start time",`${A(a[0].time,3)} (${kt(t.toRealTime(a[0].time))}`)),s.length&&s[0].time<0&&c.push(pt("Arc(s) before start time",`${A(s[0].time,3)} (${kt(t.toRealTime(s[0].time))}`)),l.length&&l[0].time<0&&c.push(pt("Chain(s) before start time",`${A(l[0].time,3)} (${kt(t.toRealTime(l[0].time))}`)),o.length&&o[0].time<0&&c.push(pt("Obstacle(s) before start time",`${A(o[0].time,3)} (${kt(t.toRealTime(o[0].time))}`)),r.length&&r[0].time<0&&c.push(pt("Event(s) before start time",`${A(r[0].time,3)} (${kt(t.toRealTime(r[0].time))}`)),n.length&&n[n.length-1].time>u&&c.push(pt("Note(s) after end time",`${A(n[n.length-1].time,3)} (${kt(t.toRealTime(n[n.length-1].time))})`)),a.length&&a[a.length-1].time>u&&c.push(pt("Bomb(s) after end time",`${A(a[a.length-1].time,3)} (${kt(t.toRealTime(a[a.length-1].time))})`)),s.length&&s[s.length-1].time>u&&c.push(pt("Arc(s) after end time",`${A(s[s.length-1].time,3)} (${kt(t.toRealTime(s[s.length-1].time))})`)),l.length&&l[l.length-1].time>u&&c.push(pt("Chain(s) after end time",`${A(l[l.length-1].time,3)} (${kt(t.toRealTime(l[l.length-1].time))})`)),o.length&&o[o.length-1].time>u&&c.push(pt("Obstacle(s) after end time",`${A(o[o.length-1].time,3)} (${kt(t.toRealTime(o[o.length-1].time))})`)),r.length&&r[r.length-1].time>u&&c.push(pt("Event(s) after end time",`${A(r[r.length-1].time,3)} (${kt(t.toRealTime(r[r.length-1].time))})`))}if(c.length){const u=document.createElement("div");c.forEach(d=>u.append(d)),fa.output.html=u}else fa.output.html=null}const wo="Invalid Object",So="Validate beatmap object to be compatible with vanilla (ignores for modded).",To=!0,ma={name:wo,description:So,type:"other",order:{input:ft.OTHERS_INVALID_OBJECT,output:mt.OTHERS_INVALID_OBJECT},input:{enabled:To,params:{},html:ut.create(wo,So,To,function(){ma.input.enabled=this.checked})},output:{html:null},run:yf};function yf(i){var p,g,b,y;if(!i.difficulty){console.error("Something went wrong!");return}const{colorNotes:t,bombNotes:e,obstacles:n,basicEvents:a,sliders:o,burstSliders:r}=i.difficulty.data;let s=[],l=[],c=[],u=[],d=[];(g=(p=i.difficulty.info._customData)==null?void 0:p._requirements)!=null&&g.includes("Mapping Extensions")||((y=(b=i.difficulty.info._customData)==null?void 0:b._requirements)!=null&&y.includes("Noodle Extensions")?(s=t.filter(v=>v.isMappingExtensions()).map(v=>v.time),l=n.filter(v=>v.isMappingExtensions()).map(v=>v.time),c=e.filter(v=>v.isMappingExtensions()).map(v=>v.time),u=o.filter(v=>v.isMappingExtensions()).map(v=>v.time),d=r.filter(v=>v.isMappingExtensions()).map(v=>v.time)):(s=t.filter(v=>!v.isValid()).map(v=>v.time),l=n.filter(v=>!v.isValid()).map(v=>v.time),c=e.filter(v=>!v.isValid()).map(v=>v.time),u=o.filter(v=>!v.isValid()).map(v=>v.time),d=r.filter(v=>!v.isValid()).map(v=>v.time)));const m=a.filter(v=>!v.isValid()).map(v=>v.time),h=[];if(s.length&&h.push(_t("Invalid note",s,i.settings.bpm)),c.length&&h.push(_t("Invalid bomb",c,i.settings.bpm)),u.length&&h.push(_t("Invalid arc",u,i.settings.bpm)),d.length&&h.push(_t("Invalid chain",d,i.settings.bpm)),l.length&&h.push(_t("Invalid obstacle",l,i.settings.bpm)),m.length&&h.push(_t("Invalid event",m,i.settings.bpm)),h.length){const v=document.createElement("div");h.forEach(S=>v.append(S)),ma.output.html=v}else ma.output.html=null}const Lo=Object.freeze(Object.defineProperty({__proto__:null,hotStart:pi,difficultyLabel:ha,njs:da,outsidePlayable:fa,invalidObject:ma},Symbol.toStringTag,{value:"Module"})),me=class{constructor(){}};let fe=me;O(fe,"getNote",()=>Object.keys(Js).map(t=>Js[t])),O(fe,"getObstacle",()=>Object.keys(io).map(t=>io[t])),O(fe,"getEvent",()=>Object.keys(co).map(t=>co[t])),O(fe,"getOther",()=>Object.keys(Lo).map(t=>Lo[t])),O(fe,"getGeneral",()=>Object.keys(ls).map(t=>ls[t])),O(fe,"getDifficulty",()=>[...me.getNote(),...me.getObstacle(),...me.getEvent(),...me.getOther()]),O(fe,"getAll",()=>[...me.getNote(),...me.getObstacle(),...me.getEvent(),...me.getOther(),...me.getGeneral()]);const mi=i=>`[analyzer::${i}]`,Bc=fe.getAll().sort((i,t)=>i.order.input-t.order.input),$c=[...Bc].sort((i,t)=>i.order.output-t.order.output);function Oc(){lt.analysis={general:{html:null},map:[]}}function vf(){var r,s;const i=lt.beatmapInfo;if(!i){rt.error(mi("runGeneral"),"Could not analyse, missing map info");return}lt.analysis||Oc();const t=(r=lt.analysis)==null?void 0:r.general,e=be.create(i._beatsPerMinute),n=oe.create(e),a={bpm:e,njs:n,audioDuration:(s=lt.duration)!=null?s:null,mapDuration:0};rt.info(mi("runGeneral"),"Analysing general");const o=[];$c.filter(l=>l.type==="general").forEach(l=>{if(l.input.enabled)try{l.run({settings:a,info:i}),l.output.html&&o.push(l.output.html)}catch(c){rt.error(mi("runGeneral"),c)}}),t&&(t.html=o)}function Mc(i,t){var l,c,u,d;const e=lt.beatmapInfo;if(!e){rt.error(mi("runDifficulty"),"Could not analyse, missing map info");return}lt.analysis||Oc();const n=(l=lt.beatmapDifficulty)==null?void 0:l.find(m=>m.characteristic===i&&m.difficulty===t);if(!n){rt.error(mi("runDifficulty"),"Could not analyse, missing map data");return}const a=(c=lt.analysis)==null?void 0:c.map.find(m=>m.difficulty===t&&m.mode===i),o=oe.create(n.bpm,n.info._noteJumpMovementSpeed||oe.FallbackNJS[n.difficulty],n.info._noteJumpStartBeatOffset),r={bpm:n.bpm,njs:o,audioDuration:(u=lt.duration)!=null?u:null,mapDuration:n.bpm.toRealTime(n.data.getLastInteractiveTime())};rt.info(mi("runDifficulty"),`Analysing ${i} ${t}`);const s=[];$c.filter(m=>m.type!=="general").forEach(m=>{if(m.input.enabled)try{m.run({settings:r,difficulty:n,info:e}),m.output.html&&s.push(m.output.html)}catch(h){rt.error(mi("runDifficulty"),h)}}),a?a.html=s:(d=lt.analysis)==null||d.map.push({mode:i,difficulty:t,html:s})}function Ef(i){fe.getDifficulty().sort((e,n)=>e.order.output-n.order.output).forEach(e=>{e.input.adjustTime&&e.input.adjustTime(i)})}function Df(){var i;(i=lt.beatmapDifficulty)==null||i.forEach(t=>Mc(t.characteristic,t.difficulty))}const Si={toolListInput:Bc,runGeneral:vf,runDifficulty:Mc,adjustTime:Ef,applyAll:Df},ui="UI Tools: ",qe=document.querySelectorAll(".tools__select-mode"),Ze=document.querySelectorAll(".tools__select-difficulty"),wf=document.querySelectorAll(".difficulty__label"),Pc=document.querySelector(".tools__note-content"),Fc=document.querySelector(".tools__obstacle-content"),Hc=document.querySelector(".tools__event-content"),zc=document.querySelector(".tools__other-content"),Xc=document.querySelector(".tools__general-content"),$e=document.querySelector(".tools__output-diff"),Oe=document.querySelector(".tools__output-general"),Co=document.querySelector(".tools__apply-this"),ko=document.querySelector(".tools__apply-all"),Ro=document.querySelector(".tools__apply-general");if(!Pc||!Fc||!Hc||!zc||!Xc)throw new Error(ui+"missing content element");if(!$e||!Oe)throw new Error(ui+"missing output element");if(Co&&ko&&Ro)Co.addEventListener("click",xf),ko.addEventListener("click",Nf),Ro.addEventListener("click",If);else throw new Error(ui+"missing apply element");qe.forEach(i=>i.addEventListener("change",kf));Ze.forEach(i=>i.addEventListener("change",Rf));function Uc(){var t;const i=(t=lt.analysis)==null?void 0:t.general;if(!i){Oe.textContent="ERROR: could not find analysis for general";return}if(!i.html){Oe.textContent="ERROR: could not find HTML for general";return}Oe.innerHTML="",i.html.forEach(e=>Oe.appendChild(e)),Oe.firstChild||(Oe.textContent="No issues found.")}function vn(i,t){var n;if(!i&&!t&&(i=qe[0].value,t=Ze[0].value),!i||!t)throw new Error(ui+"something went wrong!");$e.innerHTML="";const e=(n=lt.analysis)==null?void 0:n.map.find(a=>a.difficulty===t&&a.mode===i);if(!e){$e.textContent="ERROR: could not find analysis for "+i+" "+t;return}if(!e.html){$e.textContent="ERROR: could not find HTML for "+i+" "+t;return}e.html.forEach(a=>$e.appendChild(a)),$e.firstChild||($e.textContent="No issues found.")}function va(i){wf.forEach(t=>t.textContent=i)}function jc(i){if(!i)return;Ze.forEach(e=>{for(let n=e.options.length-1;n>=0;n--)e.remove(n)});let t=!0;for(let e=i._difficultyBeatmaps.length-1;e>=0;e--){const n=i._difficultyBeatmaps[e];Ze.forEach(a=>{var r,s,l,c;const o=document.createElement("option");if(o.value=n._difficulty,o.textContent=_e[n._difficulty]+((r=n._customData)!=null&&r._difficultyLabel?" -- "+((s=n._customData)==null?void 0:s._difficultyLabel):""),t){const u=(l=lt.beatmapDifficulty)==null?void 0:l.find(d=>d.difficulty===n._difficulty&&d.characteristic===i._beatmapCharacteristicName);if(!u)throw new Error("missing _mapSetData");wl(u),va(((c=n._customData)==null?void 0:c._difficultyLabel)||_e[n._difficulty]),vn(i._beatmapCharacteristicName,n._difficulty)}t=!1,a.add(o)})}}function Yc(i){if(!i){qe.forEach(e=>ka(e)),Ze.forEach(e=>ka(e));return}let t=!0;i._difficultyBeatmapSets.forEach(e=>{qe.forEach(n=>{const a=document.createElement("option");a.value=e._beatmapCharacteristicName,a.textContent=Lr[e._beatmapCharacteristicName],n.add(a)}),t&&jc(e),t=!1})}function Sf(){const i=lt.beatmapInfo;if(!i)throw new Error(ui+"could not find map info");const t=be.create(i._beatsPerMinute);Si.adjustTime(t)}function Tf(){Si.toolListInput.forEach(i=>{if(i.input.html)switch(i.type){case"note":{Pc.appendChild(i.input.html);break}case"obstacle":{Fc.appendChild(i.input.html);break}case"event":{Hc.appendChild(i.input.html);break}case"other":{zc.appendChild(i.input.html);break}case"general":{Xc.appendChild(i.input.html);break}default:console.error(ui+"could not recognise type "+i.type+" for "+i.name)}})}function Lf(){Oe&&(Oe.innerHTML="No output."),$e&&($e.innerHTML="No output.")}function Cf(){Lf(),va("Difficulty Label"),Yc()}function kf(i){var n;const t=i.target;qe.forEach(a=>{a!==t&&(a.value=t.value)});const e=(n=lt.beatmapInfo)==null?void 0:n._difficultyBeatmapSets.find(a=>a._beatmapCharacteristicName===t.value);jc(e)}function Rf(i){var a,o,r,s;const t=i.target;Ze.forEach(l=>{l!==t&&(l.value=t.value)});const e=(a=lt.beatmapInfo)==null?void 0:a._difficultyBeatmapSets.find(l=>l._beatmapCharacteristicName===qe.item(0).value);if(!e)throw new Error("aaaaaaaaaaaaaaaaaaa");const n=(o=lt.beatmapDifficulty)==null?void 0:o.find(l=>l.difficulty===t.value&&l.characteristic===e._beatmapCharacteristicName);n&&(wl(n),va(((s=(r=n.info)==null?void 0:r._customData)==null?void 0:s._difficultyLabel)||_e[t.value]),vn(n.characteristic,n.difficulty))}function xf(){const i=qe[0].value,t=Ze[0].value;if(!i||!t)throw new Error(ui+"mode/difficulty does not exist");wt.status("info",`Re-analysing ${i} ${t}`,100),Si.runDifficulty(i,t),wt.status("info",`Re-analysed ${i} ${t}`,100),vn(i,t)}function Nf(){const i=qe[0].value,t=Ze[0].value;if(!i||!t)throw new Error(ui+"mode/difficulty does not exist");wt.status("info","Re-analysing all difficulties",100),Si.applyAll(),wt.status("info","Re-analysed all difficulties",100),vn(i,t)}function If(){wt.status("info","Re-analysing all difficulties",100),Si.runGeneral(),wt.status("info","Re-analysed all difficulties",100),Uc()}const Ri={displayOutputGeneral:Uc,displayOutputDifficulty:vn,setDifficultyLabel:va,adjustTime:Sf,populateSelect:Yc,populateTool:Tf,reset:Cf},Di="UI Stats: ",R="stats__";function Af(i,t){const e=t.bpm,n=lt.duration||0,a=e.toRealTime(t.data.getLastInteractiveTime()),o=document.createElement("table");return o.className=R+"table",o.innerHTML=`<caption class="${R}table-caption">Note Per Seconds (NPS):</caption><tr><th class="${R}table-header" colspan="2">Overall</th><td class="${R}table-element">${A(t.data.nps(n),2)}</td></tr><tr><th class="${R}table-header" colspan="2">Mapped</th><td class="${R}table-element">${A(t.data.nps(a),2)}</td></tr><tr><th class="${R}table-header" rowspan="3">Peak</th><th class="${R}table-header">16-beat</th><td class="${R}table-element">${A(t.data.peak(16,e.value),2)}</td></tr><tr><th class="${R}table-header">8-beat</th><td class="${R}table-element">${A(t.data.peak(8,e.value),2)}</td></tr><tr><th class="${R}table-header">4-beat</th><td class="${R}table-element">${A(t.data.peak(4,e.value),2)}</td></tr>`,o}function Bf(i,t){const e=be.create(i._beatsPerMinute),n=oe.create(e,t.info._noteJumpMovementSpeed||oe.FallbackNJS[t.difficulty],t.info._noteJumpStartBeatOffset),a=document.createElement("table");return a.className=R+"table",a.innerHTML=`<caption class="${R}table-caption">Map Settings:</caption><tr><th class="${R}table-header" colspan="2">Note Jump Speed</th><td class="${R}table-element">${A(n.value,3)}</td></tr><tr><th class="${R}table-header" colspan="2">Spawn Distance Modifier</th><td class="${R}table-element">${A(n.offset,3)}</td></tr><tr><th class="${R}table-header" colspan="2">Half Jump Duration</th><td class="${R}table-element">${A(n.hjd,3)}</td></tr><tr><th class="${R}table-header" colspan="2">Jump Distance</th><td class="${R}table-element">${A(n.jd,3)}</td></tr><tr><th class="${R}table-header" colspan="2">Reaction Time</th><td class="${R}table-element">${A(n.reactTime*1e3)}ms</td></tr>`,a}function $f(i,t){const e=t.swingAnalysis,n=document.createElement("table");return n.className=R+"table",n.innerHTML=`<caption class="${R}table-caption">Swing Per Seconds (SPS):</caption><tr><th class="${R}table-header"></th><th class="${R}table-header">Total</th><th class="${R}table-header">Red</th><th class="${R}table-header">Blue</th></tr><tr><th class="${R}table-header">Average</th><td class="${R}table-element">${A(e.total.average,2)}</td><td class="${R}table-element">${A(e.red.average,2)}</td><td class="${R}table-element">${A(e.blue.average,2)}</td></tr><tr><th class="${R}table-header">Median</th><td class="${R}table-element">${A(e.total.median,2)}</td><td class="${R}table-element">${A(e.red.median,2)}</td><td class="${R}table-element">${A(e.blue.median,2)}</td></tr><tr><th class="${R}table-header">Peak</th><td class="${R}table-element">${A(e.total.peak,2)}</td><td class="${R}table-element">${A(e.red.peak,2)}</td><td class="${R}table-element">${A(e.blue.peak,2)}</td></tr><tr><th class="${R}table-header">Total</th><td class="${R}table-element">${e.total.total}</td><td class="${R}table-element">${e.red.total}</td><td class="${R}table-element">${e.blue.total}</td></tr>`,n}function jn(i){const t={red:{total:0,chroma:0,noodleExtensions:0,mappingExtensions:0},blue:{total:0,chroma:0,noodleExtensions:0,mappingExtensions:0}};for(let e=i.length-1;e>=0;e--)i[e].color===0?(t.red.total++,i[e].isChroma()&&t.red.chroma++,i[e].isNoodleExtensions()&&t.red.noodleExtensions++,i[e].isMappingExtensions()&&t.red.mappingExtensions++):i[e].color===1&&(t.blue.total++,i[e].isChroma()&&t.blue.chroma++,i[e].isNoodleExtensions()&&t.blue.noodleExtensions++,i[e].isMappingExtensions()&&t.blue.mappingExtensions++);return t}function Of(i){const t={total:0,chroma:0,noodleExtensions:0,mappingExtensions:0};for(let e=i.length-1;e>=0;e--)t.total++,i[e].isChroma()&&t.chroma++,i[e].isNoodleExtensions()&&t.noodleExtensions++,i[e].isMappingExtensions()&&t.mappingExtensions++;return t}function kn(i,t){return i.filter(e=>e.data.posX===t).length}function Mf(i,t){return i.filter(e=>e.data.posY===t).length}function Pf(i,t,e){return i.filter(n=>n.data.posX===t&&n.data.posY===e).length}function Ff(i,t){return i.filter(e=>e.type!=="bomb"&&e.data.direction===t).length}function Gc(i,t){switch(t){case"note":return i.filter(e=>e.type==="note");case"red":return i.filter(e=>e.type==="note"&&e.data.color===0);case"blue":return i.filter(e=>e.type==="note"&&e.data.color===1);case"arc":return i.filter(e=>e.type==="slider");case"redArc":return i.filter(e=>e.type==="slider"&&e.data.color===0);case"blueArc":return i.filter(e=>e.type==="slider"&&e.data.color===1);case"chain":return i.filter(e=>e.type==="burstSlider");case"redChain":return i.filter(e=>e.type==="burstSlider"&&e.data.color===0);case"blueChain":return i.filter(e=>e.type==="burstSlider"&&e.data.color===1);case"bomb":return i.filter(e=>e.type==="bomb");default:return i}}function Hf(i){var l;const t=i.target,e=t.id.replace(`${R}table-select-angle-`,"").split("-"),n=e[0],a=e[1],o=(l=lt.beatmapDifficulty.find(c=>c.characteristic===n&&c.difficulty===a))==null?void 0:l.noteContainer;if(!o){console.error(Di+"note could not be found");return}const r=Gc(o,t.value),s=document.querySelector(`#${R}table-angle-${n}-${a}`);if(!s){console.error(Di+"table could not be found");return}s.innerHTML=Wc(r)}function Wc(i){const t=i.length||1,e=[4,0,5,2,8,3,6,1,7];let n="";for(let a=0;a<3;a++){n+="<tr>";for(let o=0;o<3;o++){let r=Ff(i,e[a*3+o]);n+=`<td class="${R}table-element">${r}<br>(${A(r/t*100,1)}%)</td>`}n+="</tr>"}return n}function zf(i,t){var o;const e=yn.create(`${R}table-select-angle-${t.characteristic}-${t.difficulty}`,"Note Angle: ","caption",`${R}table-caption`,{text:"All",value:"all"},{text:"Note Only",value:"note"},{text:"Red Note",value:"red"},{text:"Blue Note",value:"blue"},{text:"Arc Only",value:"arc"},{text:"Red Arc",value:"redArc"},{text:"Blue Arc",value:"blueArc"},{text:"Chain Only",value:"chain"},{text:"Red Chain",value:"redChain"},{text:"Blue Chain",value:"blueChain"});(o=e.querySelector("select"))==null||o.addEventListener("change",Hf);let n=`<tbody id="${R}table-angle-${t.characteristic}-${t.difficulty}">${Wc(t.noteContainer)}</tbody>`;const a=document.createElement("table");return a.className=R+"table",a.innerHTML=n,a.prepend(e),a}function Xf(i,t,e="DefaultEnvironment"){var o,r;const n=(r=(o=Ie[e])==null?void 0:o[0])!=null?r:Ie.DefaultEnvironment[0],a={};for(let s=n.length-1;s>=0;s--)a[n[s]]={total:0,chroma:0,chromaOld:0};a[5]={total:t.length,chroma:0,chromaOld:0};for(let s=i.length-1;s>=0;s--)i[s].isValidType()&&(a[i[s].type]||(a[i[s].type]={total:0,chroma:0,chromaOld:0}),a[i[s].type].total++,i[s].isChroma()&&a[i[s].type].chroma++,i[s].isOldChroma()&&a[i[s].type].chromaOld++);return a}function Uf(i,t="DefaultEnvironment"){var a,o;const e=(o=(a=Ie[t])==null?void 0:a[1])!=null?o:Ie.DefaultEnvironment[1],n={};for(let r=e.length-1;r>=0;r--)n[e[r]]={total:0,eventBox:0,base:0};for(let r=i.length-1;r>=0;r--)n[i[r].id]||(n[i[r].id]={total:0,eventBox:0,base:0}),n[i[r].id].total++,n[i[r].id].eventBox+=i[r].events.length,n[i[r].id].base+=i[r].events.reduce((s,l)=>s+l.events.length,0);return n}function jf(i,t="DefaultEnvironment"){var a,o;const e=(o=(a=Ie[t])==null?void 0:a[1])!=null?o:Ie.DefaultEnvironment[1],n={};for(let r=e.length-1;r>=0;r--)n[e[r]]={total:0,eventBox:0,base:0};for(let r=i.length-1;r>=0;r--)n[i[r].id]||(n[i[r].id]={total:0,eventBox:0,base:0}),n[i[r].id].total++,n[i[r].id].eventBox+=i[r].events.length,n[i[r].id].base+=i[r].events.reduce((s,l)=>s+l.events.length,0);return n}function Yf(i,t="DefaultEnvironment"){var a,o;const e=(o=(a=Ie[t])==null?void 0:a[1])!=null?o:Ie.DefaultEnvironment[1],n={};for(let r=e.length-1;r>=0;r--)n[e[r]]={total:0,eventBox:0,base:0};for(let r=i.length-1;r>=0;r--)n[i[r].id]||(n[i[r].id]={total:0,eventBox:0,base:0}),n[i[r].id].total++,n[i[r].id].eventBox+=i[r].events.length,n[i[r].id].base+=i[r].events.reduce((s,l)=>s+l.events.length,0);return n}function Gf(i){const t={total:0,interactive:0,chroma:0,noodleExtensions:0,mappingExtensions:0};for(let e=i.length-1;e>-1;e--)t.total++,i[e].isInteractive()&&t.interactive++,i[e].isChroma()&&t.chroma++,i[e].isNoodleExtensions()&&t.noodleExtensions++,i[e].isMappingExtensions()&&t.mappingExtensions++;return t}function Wf(i,t){switch(t){case"LinkinParkEnvironment":switch(i){case 0:return"Lane Light";case 1:return"Ceiling Lights";case 8:return"Laser Mode"}break;case"BTSEnvironment":switch(i){case 0:return"Door Light";case 1:return"Vertical Pillar Lights";case 8:return"Distant Tower Spin";case 9:return"Raise/Lower Pillars";case 40:return"BTS Event 1";case 41:return"BTS Event 2";case 42:return"BTS Event 3";case 43:return"BTS Event 4"}break;case"KaleidoscopeEnvironment":switch(i){case 0:return"Spike Tip Lights";case 1:return"Spike Mid Lights";case 2:return"Spike Left Lights";case 3:return"Spike Right Lights";case 4:return"Distant Lasers and Spike Top Lights"}break;case"InterscopeEnvironment":switch(i){case 0:return"Gate 1";case 1:return"Gate 2";case 2:return"Gate 3";case 3:return"Gate 4";case 4:return"Gate 5";case 6:return"Extra 1";case 7:return"Extra 2"}break;case"SkrillexEnvironment":switch(i){case 0:return"Logo";case 1:return"Top Lanes and 1st Ring Set";case 4:return"Bottom Lanes and 2nd Ring Set";case 6:return"Left Panel";case 7:return"Right Panel";case 12:return"Left Laser & Panel Speed";case 13:return"Right Laser & Panel Speed"}break;case"BillieEnvironment":switch(i){case 0:return"Water 4";case 1:return"Water 1";case 2:return"Left Sun Beams";case 3:return"Right Sun Beams";case 4:return"Sun";case 6:return"Water 2";case 7:return"Water 3";case 8:return"Toggle Rain";case 9:return"Sunbeam Mode";case 10:return"Left Bottom Lasers";case 11:return"Right Bottom Lasers";case 12:return"Left Sun Beams Speed";case 13:return"Right Sun Beams Speed"}break;case"HalloweenEnvironment":switch(i){case 0:return"Sky Lasers";case 1:return"Moon";case 4:return"Lane + Castle Interior"}break;case"GagaEnvironment":switch(i){case 0:return"Aurora 1";case 1:return"Aurora 2";case 2:return"Tower 1";case 3:return"Tower 2";case 4:return"Logo";case 6:return"Tower 3";case 7:return"Tower 4";case 10:return"Tower 5";case 11:return"Tower 6";case 14:return"Tower 1 Height";case 15:return"Tower 2 Height";case 16:return"Tower 3 Height";case 17:return"Tower 4 Height";case 18:return"Tower 5 Height";case 19:return"Tower 6 Height"}break;case"WeaveEnvironment":switch(i){case 4:return"Player Space"}break;case"PyroEnvironment":switch(i){case 0:return"Video Alpha";case 1:return"Logo";case 2:return"Left Projectors";case 3:return"Right Projectors";case 4:return"Platform";case 6:return"Ambient";case 40:return"Video Projection"}break;case"EDMEnvironment":switch(i){case 0:return"Lane Lights Bottom";case 1:return"Lane Lights Top";case 4:return"Player Space & Spectrogram"}break;case"TheSecondEnvironment":switch(i){case 0:return"Logo";case 1:return"Runway";case 2:return"Left Flags";case 3:return"Right Flags";case 4:return"Buildings"}break;case"LizzoEnvironment":switch(i){case 0:return"Runway Left";case 1:return"Runway Right";case 2:return"Left Ring";case 3:return"Right Ring";case 4:return"Top Square";case 6:return"Ambient";case 7:return"Cherry Left";case 8:return"Cherry Right";case 9:return"LI Sign";case 10:return"Z Left Sign";case 11:return"Z Right Sign";case 12:return"O Sign";case 16:return"Left Balloon Particles";case 17:return"Right Balloon Particles"}break;case"TheWeekndEnvironment":switch(i){case 0:return"Runway Left";case 1:return"Runway Right";case 6:return"Ambient"}break}switch(i){case 0:return"Back Lasers";case 1:return"Ring Lights";case 2:return"Left Lasers";case 3:return"Right Lasers";case 4:return"Center Lights";case 5:return"Boost Colors";case 6:return"Extra Left Lights";case 7:return"Extra Right Lights";case 8:return"Ring Rotation";case 9:return"Ring Zoom";case 10:return"Extra Left Lasers";case 11:return"Extra Right Lasers";case 12:return"Left Laser Speed";case 13:return"Right Laser Speed";case 14:return"Early Lane Rotation";case 15:return"Late Lane Rotation";case 16:return"Utility Event 1";case 17:return"Utility Event 2";case 18:return"Utility Event 3";case 19:return"Utility Event 4";case 40:return"Special Event 1";case 41:return"Special Event 2";case 42:return"Special Event 3";case 43:return"Special Event 4";default:return"Unknown"}}function Vf(i,t){switch(t){case"WeaveEnvironment":switch(i){case 0:return"Outer Square Bottom Left Laser";case 1:return"Outer Square Bottom Right Laser";case 2:return"Outer Square Top Left Laser";case 3:return"Outer Square Top Right Laser";case 4:return"Inner Square Bottom Left Laser";case 5:return"Inner Square Bottom Right Laser";case 6:return"Inner Square Top Left Laser";case 7:return"Inner Square Top Right Laser";case 8:return"Side Square Bottom Left Laser";case 9:return"Side Square Bottom Right Laser";case 10:return"Side Square Top Left Laser";case 11:return"Side Square Top Right Laser";case 12:return"Distant Square Top Laser";case 13:return"Distant Square Bottom Laser";case 14:return"Distant Square Left Laser";case 15:return"Distant Square Right Laser"}case"PyroEnvironment":switch(i){case 0:return"Left Stage Light";case 1:return"Right Stage Light";case 2:return"Top Left Laser";case 3:return"Top Right Laser";case 4:return"Top Middle Laser";case 5:return"Top Light";case 6:return"Left Light Tower";case 7:return"Right Light Tower";case 8:return"Stage Left Laser";case 9:return"Stage Right Laser";case 10:return"Stage Far Left Laser";case 11:return"Stage Far Right Laser";case 12:return"Left Flame";case 13:return"Right Flame"}case"EDMEnvironment":switch(i){case 0:return"Top Circle";case 1:return"Close Circle";case 2:return"Distant Circle";case 3:return"Distant Circle 2";case 4:return"Left Single Source Circle";case 5:return"Right Single Source Circle";case 6:return"Left Laser (Up)";case 7:return"Left Laser (Out)";case 8:return"Right Laser (Up)";case 9:return"Right Laser (Out)";case 10:return"Left Laser (Down)";case 11:return"Right Laser (Down)";case 12:return"Left Laser (Down) / Top Circle";case 13:return"Right Laser (Up) / Close Circle";case 14:return"Distant Circle";case 15:return"Distant Circle 2";case 16:return"Left Single Source Circle";case 17:return"Right Single Source Circle"}case"TheSecondEnvironment":switch(i){case 0:return"Big Rings";case 1:return"Small Rings";case 2:return"Runway Left";case 3:return"Runway Right";case 4:return"Spotlight Left";case 5:return"Spotlight Right";case 6:return"Top Lasers Left Bottom";case 7:return"Top Lasers Right Bottom";case 8:return"Top Lasers Left Top";case 9:return"Top Lasers Right Top";case 10:return"Bottom Lasers Left Bottom";case 11:return"Bottom Lasers Right Bottom";case 12:return"Bottom Lasers Left Top";case 13:return"Bottom Lasers Right Top"}case"LizzoEnvironment":switch(i){case 0:return"Main Floor";case 1:return"Rainbow Arcs Inner";case 2:return"Rainbow Arcs 2";case 3:return"Rainbow Arcs 3";case 4:return"Rainbow Arcs 4";case 5:return"Rainbow Arcs Outer";case 6:return"Rainbow Rings Left";case 7:return"Rainbow Rings Right";case 8:return"Rainbow Rings Lasers Left";case 9:return"Rainbow Rings Lasers Right";case 10:return"Main Top Lasers";case 11:return"Environment Stands Left";case 12:return"Environment Stands Right";case 13:return"Environment Clouds Left";case 14:return"Environment Clouds Right";case 15:return"Main Left Lasers";case 16:return"Main Right Lasers";case 17:return"Environment Stand Lasers Left";case 18:return"Environment Stand Lasers Right";case 19:return"Rainbow Arcs Laser"}case"TheWeekndEnvironment":switch(i){case 0:return"Lamps Poles Left";case 1:return"Lamps Poles Right";case 2:return"Lamps Rings Left";case 3:return"Lamps Rings Right";case 4:return"Environment Arrows";case 5:return"Environment Side Lasers Left";case 6:return"Environment Side Lasers Right";case 7:return"Environment Runway Lane";case 8:return"Environment Center Ring";case 9:return"Environment Center Ring Lasers";case 10:return"Windows Left 1 Front";case 11:return"Windows Left 1 Side";case 12:return"Windows Left 2 Side";case 13:return"Windows Left 3 Front";case 14:return"Windows Left 3 Side";case 15:return"Windows Right 1 Front";case 16:return"Windows Right 1 Side";case 17:return"Windows Right 2 Side";case 18:return"Windows Right 3 Front";case 19:return"Windows Right 3 Side";case 20:return"Buildings Left";case 21:return"Buildings Right";case 22:return"Buildings Roof Left";case 23:return"Buildings Roof Right";case 29:return"Lamp Rings Left 1";case 30:return"Lamp Rings Left 2";case 31:return"Lamp Rings Left 3";case 32:return"Lamp Rings Left 4";case 33:return"Lamp Rings Right 1";case 34:return"Lamp Rings Right 2";case 35:return"Lamp Rings Right 3";case 36:return"Lamp Rings Right 4";case 38:return"Buildings Background Left";case 39:return"Buildings Background Right";case 40:return"Buildings Side Buildings"}default:return"Unknown"}}function Jf(i,t){const e=t.characteristic==="360Degree"||t.characteristic==="90Degree"?i._allDirectionsEnvironmentName:i._environmentName,n=Xf(t.data.basicEvents,t.data.colorBoostEvents,e);let a=0,o=0,r=`<caption class="${R}table-caption">Events: ${Object.values(n).reduce((l,{total:c})=>l+c,0)}</caption>`;for(const l in n)a+=n[l].chroma,o+=n[l].chromaOld,r+=`<tr><th class="${R}table-header">${l}</th><th class="${R}table-header" colspan="4">${Wf(parseInt(l),e)}</th><td class="${R}table-element">${n[l].total}</td></tr>`;a&&(r+=`<tr><th class="${R}table-header" colspan="5">Chroma</th><td class="${R}table-element">${a}</td></tr>`),o&&(r+=`<tr><th class="${R}table-header" colspan="5">OG Chroma</th><td class="${R}table-element">${o}</td></tr>`);const s=document.createElement("table");return s.className=R+"table",s.innerHTML=r,s}function qf(i,t){const e=t.characteristic==="360Degree"||t.characteristic==="90Degree"?i._allDirectionsEnvironmentName:i._environmentName,n=Uf(t.data.lightColorEventBoxGroups,e),a=jf(t.data.lightRotationEventBoxGroups,e),o=Yf(t.data.lightTranslationEventBoxGroups,e);let r=`<caption class="${R}table-caption">Color Event Box Groups: <span title="${Object.values(n).reduce((l,{eventBox:c})=>l+c,0)} Box (${Object.values(n).reduce((l,{base:c})=>l+c,0)} Base)">${Object.values(n).reduce((l,{total:c})=>l+c,0)}</span><br>Rotation Event Box Groups: <span title="${Object.values(a).reduce((l,{eventBox:c})=>l+c,0)} Box (${Object.values(a).reduce((l,{base:c})=>l+c,0)} Base)">${Object.values(a).reduce((l,{total:c})=>l+c,0)}</span><br>Translation Event Box Groups: <span title="${Object.values(o).reduce((l,{eventBox:c})=>l+c,0)} Box (${Object.values(o).reduce((l,{base:c})=>l+c,0)} Base)">${Object.values(o).reduce((l,{total:c})=>l+c,0)}</span></caption>`;for(const l in n)r+=`<tr><th class="${R}table-header">${l}</th><th class="${R}table-header" colspan="5">${Vf(parseInt(l),e)}</th><td class="${R}table-element" title="${n[l].eventBox} Box (${n[l].base} Base)">${n[l].total}</td><td class="${R}table-element" title="${a[l].eventBox} Box (${a[l].base} Base)">${a[l].total}</td><td class="${R}table-element" title="${o[l].eventBox} Box (${o[l].base} Base)">${o[l].total}</td></tr>`;const s=document.createElement("table");return s.className=R+"table",s.innerHTML=r,s}const Zf=115;function Kf(i){let t=0,e=1;for(let n=0,a=i.filter(o=>o.type==="note"&&!(typeof o.data.customData.uninteractable<"u"||!o.data.customData.uninteractable)).length;n<a;n++)e<8&&n===-3+e*4&&(e*=2),t+=Zf*e;return t}function Qf(i,t){const e=jn(t.data.colorNotes);let n=`<caption class="${R}table-caption">Note Information:</caption><tr><th class="${R}table-header" colspan="2">R/B Ratio</th><td class="${R}table-element">${A(e.red.total/e.blue.total,2)}</td></tr><tr><th class="${R}table-header" colspan="2">Max Score</th><td class="${R}table-element">${lu(Kf(t.noteContainer))}</td></tr><tr><th class="${R}table-header" colspan="2">Effective BPM</th><td class="${R}table-element">${A(Au(t.swingAnalysis.container),2)}</td></tr><tr><th class="${R}table-header" colspan="2">Effective BPM (swing)</th><td class="${R}table-element">${A(Bu(t.swingAnalysis.container),2)}</td></tr>`,a=A(zu(t.swingAnalysis.container)*1e3,1),o=A(Xu(t.swingAnalysis.container)*1e3,1);a&&o&&(n+=`<tr><th class="${R}table-header" colspan="2">Min. Slider Speed</th><td class="${R}table-element">${a}ms</td></tr><tr><th class="${R}table-header" colspan="2">Max. Slider Speed</th><td class="${R}table-element">${o}ms</td></tr>`);const r=document.createElement("table");return r.className=R+"table",r.innerHTML=n,r}function tm(i,t){const e=jn(t.data.colorNotes),n=jn(t.data.sliders),a=jn(t.data.burstSliders),o=Of(t.data.bombNotes);let r=`<caption class="${R}table-caption">Note Count:</caption><tr><th class="${R}table-header"></th><th class="${R}table-header">Note</th><th class="${R}table-header">Arc</th><th class="${R}table-header">Chain</th><th class="${R}table-header">Bomb</th></tr><tr><th class="${R}table-header">Total</th><td class="${R}table-element">${e.red.total+e.blue.total}</td><td class="${R}table-element">${n.red.total+n.blue.total}</td><td class="${R}table-element">${a.red.total+a.blue.total}</td><td class="${R}table-element">${o.total}</td></tr><tr><th class="${R}table-header">Red</th><td class="${R}table-element">${e.red.total}</td><td class="${R}table-element">${n.red.total}</td><td class="${R}table-element">${a.red.total}</td><td class="${R}table-element">0</td></tr><tr><th class="${R}table-header">Blue</th><td class="${R}table-element">${e.blue.total}</td><td class="${R}table-element">${n.blue.total}</td><td class="${R}table-element">${a.blue.total}</td><td class="${R}table-element">0</td></tr>`;(e.red.chroma||e.blue.chroma||n.red.chroma||n.blue.chroma||a.red.chroma||a.blue.chroma||o.chroma)&&(r+=`<tr><th class="${R}table-header">Chroma</th><td class="${R}table-element">${e.red.chroma+e.blue.chroma}</td><td class="${R}table-element">${n.red.chroma+n.blue.chroma}</td><td class="${R}table-element">${a.red.chroma+a.blue.chroma}</td><td class="${R}table-element">${o.chroma}</td></tr>`),(e.red.noodleExtensions||e.blue.noodleExtensions||n.red.noodleExtensions||n.blue.noodleExtensions||a.red.noodleExtensions||a.blue.noodleExtensions||o.noodleExtensions)&&(r+=`<tr><th class="${R}table-header">NE</th><td class="${R}table-element">${e.red.noodleExtensions+e.blue.noodleExtensions}</td><td class="${R}table-element">${n.red.noodleExtensions+n.blue.noodleExtensions}</td><td class="${R}table-element">${a.red.noodleExtensions+a.blue.noodleExtensions}</td><td class="${R}table-element">${o.noodleExtensions}</td></tr></tr>`),(e.red.mappingExtensions||e.blue.mappingExtensions||n.red.mappingExtensions||n.blue.mappingExtensions||a.red.mappingExtensions||a.blue.mappingExtensions||o.mappingExtensions)&&(r+=`<tr><th class="${R}table-header">ME</th><td class="${R}table-element">${e.red.mappingExtensions+e.blue.mappingExtensions}</td><td class="${R}table-element">${n.red.mappingExtensions+n.blue.mappingExtensions}</td><td class="${R}table-element">${a.red.mappingExtensions+a.blue.mappingExtensions}</td><td class="${R}table-element">${o.mappingExtensions}</td></tr></tr>`);const s=document.createElement("table");return s.className=R+"table",s.innerHTML=r,s}function em(i){var l;const t=i.target,e=t.id.replace(`${R}table-select-placement-`,"").split("-"),n=e[0],a=e[1],o=(l=lt.beatmapDifficulty.find(c=>c.characteristic===n&&c.difficulty===a))==null?void 0:l.noteContainer;if(!o){console.error(Di+"note could not be found");return}const r=Gc(o,t.value),s=document.querySelector(`#${R}table-placement-${n}-${a}`);if(!s){console.error(Di+"table could not be found");return}s.innerHTML=Vc(r)}function Vc(i){const t=i.length||1;let e="";for(let n=2;n>=0;n--){e+="<tr>";for(let a=0;a<=3;a++)e+=`<td class="${R}table-element">${Pf(i,a,n)}</td>`;e+=`<td class="${R}table-element ${R}table--no-border">${A(Mf(i,n)/t*100,1)}%</td>
        </tr>`}return e+=`<tr><td class="${R}table-element ${R}table--no-border">${A(kn(i,0)/t*100,1)}%</td><td class="${R}table-element ${R}table--no-border">${A(kn(i,1)/t*100,1)}%</td><td class="${R}table-element ${R}table--no-border">${A(kn(i,2)/t*100,1)}%</td><td class="${R}table-element ${R}table--no-border">${A(kn(i,3)/t*100,1)}%</td></tr>`,e}function im(i,t){var o;const e=yn.create(`${R}table-select-placement-${t.characteristic}-${t.difficulty}`,"Note Placement: ","caption",`${R}table-caption`,{text:"All",value:"all"},{text:"Note Only",value:"note"},{text:"Red Note",value:"red"},{text:"Blue Note",value:"blue"},{text:"Arc Only",value:"arc"},{text:"Red Arc",value:"redArc"},{text:"Blue Arc",value:"blueArc"},{text:"Chain Only",value:"chain"},{text:"Red Chain",value:"redChain"},{text:"Blue Chain",value:"blueChain"},{text:"Bomb",value:"bomb"});(o=e.querySelector("select"))==null||o.addEventListener("change",em);let n=`<tbody id="${R}table-placement-${t.characteristic}-${t.difficulty}">${Vc(t.noteContainer)}</tbody>`;const a=document.createElement("table");return a.className=R+"table",a.innerHTML=n,a.prepend(e),a}function nm(i,t){const e=Gf(t.data.obstacles);let n=`<caption class="${R}table-caption">Obstacles: ${e.total}</caption>`;e.interactive&&(n+=`<tr><th class="${R}table-header" colspan="2">Interactive</th><td class="${R}table-element">${e.interactive}</td></tr>`),e.chroma&&(n+=`<tr><th class="${R}table-header" colspan="2">Chroma</th><td class="${R}table-element">${e.chroma}</td></tr>`),e.noodleExtensions&&(n+=`<tr><th class="${R}table-header" colspan="2">Noodle Extensions</th><td class="${R}table-element">${e.noodleExtensions}</td></tr>`),e.mappingExtensions&&(n+=`<tr><th class="${R}table-header" colspan="2">Mapping Extensions</th><td class="${R}table-element">${e.mappingExtensions}</td></tr>`);const a=document.createElement("table");return a.className=R+"table",a.innerHTML=n,a}const Yn=document.querySelector("#stats .accordion__collapsible");function am(){if(!lt.beatmapInfo)throw new Error(Di+"map info could not be found in savedData");const i=lt.beatmapInfo;i._difficultyBeatmapSets.forEach(t=>{var a,o;const e=document.createElement("div");e.className=R+"mode-"+t._beatmapCharacteristicName;const n=document.createElement("div");n.className=R+"title",n.textContent=Lr[t._beatmapCharacteristicName],e.appendChild(n);for(let r=t._difficultyBeatmaps.length-1;r>=0;r--){const s=t._difficultyBeatmaps[r],l=lt.beatmapDifficulty.find(g=>g.characteristic===t._beatmapCharacteristicName&&g.difficulty===s._difficulty);if(!l)throw new Error(Di+"Could not find map data");const c=Po.create(`${R}${t._beatmapCharacteristicName}-${s._difficulty}`,_e[s._difficulty]+((a=s._customData)!=null&&a._difficultyLabel?" -- "+((o=s._customData)==null?void 0:o._difficultyLabel):""),s._difficulty,!0),u=c.querySelector(".accordion__collapsible-flex"),d=c.querySelector(".accordion__button");if(!u||!d)throw new Error(Di+"something went wrong!");d.checked=et.onLoad.stats;const m=sn.create("small","half"),h=sn.create("small","half"),p=sn.create("small","half");m.append(Bf(i,l)),m.append(document.createElement("br")),m.append(Af(i,l)),m.append(document.createElement("br")),m.append($f(i,l)),h.append(Qf(i,l)),h.append(document.createElement("br")),h.append(tm(i,l)),h.append(document.createElement("br")),h.append(im(i,l)),h.append(document.createElement("br")),h.append(zf(i,l)),p.append(Jf(i,l)),p.append(document.createElement("br")),p.append(qf(i,l)),p.append(document.createElement("br")),p.append(nm(i,l)),u.appendChild(m),u.appendChild(h),u.appendChild(p),e.appendChild(c)}Yn.appendChild(e)})}function rm(){for(;Yn.firstChild;)Yn.removeChild(Yn.firstChild)}function xo(i){var e,n,a,o,r,s,l,c,u,d,m,h,p,g;if(!i)return{};const t=vt(i);return Object.keys(t).length?((e=t.color)!=null||(t.color=t._color),(n=t.coordinates)!=null||(t.coordinates=t._position),(a=t.disableNoteGravity)!=null||(t.disableNoteGravity=t._disableNoteGravity),(o=t.disableNoteLook)!=null||(t.disableNoteLook=t._disableNoteLook),(r=t.flip)!=null||(t.flip=t._flip),(s=t.localRotation)!=null||(t.localRotation=t._localRotation),(l=t.noteJumpMovementSpeed)!=null||(t.noteJumpMovementSpeed=t._noteJumpMovementSpeed),(c=t.noteJumpStartBeatOffset)!=null||(t.noteJumpStartBeatOffset=t._noteJumpStartBeatOffset),(u=t.spawnEffect)!=null||(t.spawnEffect=typeof t._disableSpawnEffect=="boolean"?!t._disableSpawnEffect:void 0),(d=t.size)!=null||(t.size=t._scale),(m=t.track)!=null||(t.track=t._track),(h=t.uninteractable)!=null||(t.uninteractable=typeof t._interactable=="boolean"?!t._interactable:void 0),(p=t.worldRotation)!=null||(t.worldRotation=t._rotation),t._animation&&((g=t.animation)!=null||(t.animation={color:t._animation._color,definitePosition:t._animation._definitePosition,dissolve:t._animation._dissolve,dissolveArrow:t._animation._dissolveArrow,interactable:t._animation._interactable,localRotation:t._animation._localRotation,offsetPosition:t._animation._position,offsetRotation:t._animation._rotation,scale:t._animation._scale,time:t._animation._time})),delete t._color,delete t._position,delete t._disableNoteGravity,delete t._disableNoteLook,delete t._flip,delete t._cutDirection,delete t._localRotation,delete t._noteJumpMovementSpeed,delete t._noteJumpStartBeatOffset,delete t._disableSpawnEffect,delete t._scale,delete t._track,delete t._interactable,delete t._rotation,delete t._animation,t):{}}function sm(i){var n,a,o,r,s,l,c,u,d,m,h,p;if(!i)return{};const t=vt(i);if(!Object.keys(t).length)return{};const e=(n=t._preciseSpeed)!=null?n:t._speed;return(a=t.color)!=null||(t.color=t._color),(o=t.lightID)!=null||(t.lightID=t._lightID),(r=t.easing)!=null||(t.easing=t._easing),(s=t.lerpType)!=null||(t.lerpType=t._lerpType),(l=t.nameFilter)!=null||(t.nameFilter=t._nameFilter),(c=t.rotation)!=null||(t.rotation=t._rotation),(u=t.step)!=null||(t.step=t._step),(d=t.prop)!=null||(t.prop=t._prop),(m=t.speed)!=null||(t.speed=e),(h=t.direction)!=null||(t.direction=t._direction),(p=t.lockRotation)!=null||(t.lockRotation=t._lockPosition),delete t._color,delete t._lightID,delete t._easing,delete t._lerpType,delete t._propID,delete t._lightGradient,delete t._nameFilter,delete t._rotation,delete t._step,delete t._prop,delete t._speed,delete t._preciseSpeed,delete t._direction,delete t._reset,delete t._counterSpin,delete t._stepMult,delete t._propMult,delete t._speedMult,delete t._lockPosition,t}const he=i=>`[convert::${i}]`;function om(i,t){var n,a,o,r,s,l;if(t)rt.warn(he("V2toV3"),"Converting beatmap v2 to v3 may lose certain data!");else{if(rt.warn(he("V2toV3"),"Converting beatmap v2 to v3 may lose certain data!"),prompt("Proceed with conversion? (y/N):","n")[0].toLowerCase()!=="y")throw Error("Conversion to beatmap v3 denied.");rt.info(he("V2toV3"),"Converting beatmap v2 to v3")}const e=Ic.create();if(e.fileName=i.fileName,e.customData.fakeBombNotes=[],e.customData.fakeColorNotes=[],e.customData.fakeObstacles=[],i.notes.forEach((c,u)=>{const d=xo(c.customData);if(typeof c.customData._cutDirection=="number"&&rt.debug(he("V2toV3"),`notes[${u}] at time ${c.time} NE _cutDirection will be converted.`),c.isBomb()&&(c.customData._fake?e.customData.fakeBombNotes.push(Je.create({b:c.time,x:c.posX,y:c.posY,customData:d})[0].toJSON()):e.bombNotes.push(Je.create({b:c.time,x:c.posX,y:c.posY,customData:d})[0])),c.isNote()){let m=0;typeof c.customData._cutDirection=="number"?m=c.customData._cutDirection>0?c.customData._cutDirection%360:360+c.customData._cutDirection%360:c.direction>=1e3&&(m=Math.abs(c.direction%1e3%360-360)),c.customData._fake?e.customData.fakeColorNotes.push(Ne.create({b:c.time,c:c.type,x:c.posX,y:c.posY,d:c.direction>=1e3||typeof c.customData._cutDirection=="number"?c.direction===8?8:1:jr(c.direction,0,8),a:m,customData:d})[0].toJSON()):e.colorNotes.push(Ne.create({b:c.time,c:c.type,x:c.posX,y:c.posY,d:c.direction>=1e3||typeof c.customData._cutDirection=="number"?c.direction===8?8:1:jr(c.direction,0,8),a:m,customData:d})[0])}}),i.obstacles.forEach(c=>{const u=xo(c.customData);c.customData._fake?e.customData.fakeObstacles.push(Vt.create({b:c.time,x:c.posX,y:c.type===2?c.posY:c.type?2:0,d:c.duration,w:c.width,h:c.type===2?c.height:c.type?3:5,customData:u})[0].toJSON()):e.obstacles.push(Vt.create({b:c.time,x:c.posX,y:c.type===2?c.posY:c.type?2:0,d:c.duration,w:c.width,h:c.type===2?c.height:c.type?3:5,customData:u})[0])}),i.events.forEach((c,u)=>{var d;if(c.isColorBoost())e.colorBoostEvents.push(bi.create({b:c.time,o:!!c.value})[0]);else if(c.isLaneRotationEvent())e.rotationEvents.push(yi.create({b:c.time,e:c.type===14?0:1,r:typeof c.customData._rotation=="number"?c.customData._rotation:c.value>=1e3?(c.value-1360)%360:(d=Ou[c.value])!=null?d:0})[0]);else if(c.isBPMChangeEvent())e.bpmEvents.push(_i.create({b:c.time,m:c.floatValue})[0]);else{const m=sm(c.customData);c.isLightEvent()&&(c.customData._propID&&rt.warn(he("V2toV3"),`events[${u}] at time ${c.time} Chroma _propID will be removed.`),c.customData._lightGradient&&rt.warn(he("V2toV3"),`events[${u}] at time ${c.time} Chroma _lightGradient will be removed.`)),c.isRingEvent()&&(c.customData._reset&&rt.warn(he("V2toV3"),`events[${u}] at time ${c.time} Chroma _reset will be removed.`),c.customData._counterSpin&&rt.warn(he("V2toV3"),`events[${u}] at time ${c.time} Chroma _counterSpin will be removed.`),(c.customData._stepMult||c.customData._propMult||c.customData._speedMult)&&rt.warn(he("V2toV3"),`events[${u}] at time ${c.time} Chroma _mult will be removed.`)),e.basicEvents.push(gi.create({b:c.time,et:c.type,i:c.value,f:c.floatValue,customData:m})[0])}}),i.waypoints.forEach(c=>{e.waypoints.push(Ei.create({b:c.time,x:c.posX,y:c.posY,d:c.direction})[0])}),i.sliders.forEach(c=>e.sliders.push(vi.create({c:c.color,b:c.time,x:c.posX,y:c.posY,d:c.direction,mu:c.lengthMultiplier,tb:c.tailTime,tx:c.tailPosX,ty:c.tailPosY,tc:c.tailDirection,tmu:c.tailLengthMultiplier,m:c.midAnchor})[0])),e.basicEventTypesWithKeywords=cn.create({d:(o=(a=(n=i.specialEventsKeywordFilters)==null?void 0:n.list)==null?void 0:a.map(c=>({k:c.keyword,e:c.events})))!=null?o:[]}),i.customData)for(const c in i.customData){if(c==="_customEvents"){e.customData.customEvents=[],i.customData._customEvents.forEach(u=>{var d,m,h,p,g;u._type==="AnimateTrack"&&((d=e.customData.customEvents)==null||d.push({b:u._time,t:"AnimateTrack",d:{track:u._data._track,duration:u._data._duration,easing:u._data._easing,position:u._data._position,rotation:u._data._rotation,localRotation:u._data._localRotation,scale:u._data._scale,dissolve:u._data._dissolve,dissolveArrow:u._data._dissolveArrow,color:u._data._color,interactable:u._data._interactable,time:u._data._time}})),u._type==="AssignPathAnimation"&&((m=e.customData.customEvents)==null||m.push({b:u._time,t:"AssignPathAnimation",d:{track:u._data._track,easing:u._data._easing,position:u._data._position,rotation:u._data._rotation,localRotation:u._data._localRotation,scale:u._data._scale,dissolve:u._data._dissolve,dissolveArrow:u._data._dissolveArrow,color:u._data._color,interactable:u._data._interactable,definitePosition:u._data._definitePosition}})),u._type==="AssignTrackParent"&&((h=e.customData.customEvents)==null||h.push({b:u._time,t:"AssignTrackParent",d:{childrenTracks:u._data._childrenTracks,parentTrack:u._data._parentTrack,worldPositionStays:u._data._worldPositionStays}})),u._type==="AssignPlayerToTrack"&&((p=e.customData.customEvents)==null||p.push({b:u._time,t:"AssignPlayerToTrack",d:{track:u._data._track,playerTrackObject:u._data._playerTrackObject}})),u._type==="AssignFogTrack"&&((g=e.customData.customEvents)==null||g.push({b:u._time,t:"AnimateComponent",d:{track:u._data._track,duration:u._data._duration||0,BloomFogEnvironment:{attenuation:typeof u._data._attenuation=="number"?[[u._data._attenuation,0]]:u._data._attenuation,height:typeof u._data._height=="number"?[[u._data._height,0]]:u._data._height,offset:typeof u._data._offset=="number"?[[u._data._offset,0]]:u._data._offset,startY:typeof u._data._startY=="number"?[[u._data._startY,0]]:u._data._startY}}}))});continue}if(c==="_environment"){e.customData.environment=i.customData._environment.map(u=>{var m,h,p,g;let d={};if(u._lightID&&(d={ILightWithId:{lightID:u._lightID}}),u._id&&u._lookupMethod)return{id:u._id,lookupMethod:u._lookupMethod,track:u._track,duplicate:u._duplicate,active:u._active,scale:u._scale,position:(m=u._position)==null?void 0:m.map(b=>b*.6),rotation:u._rotation,localPosition:(h=u._localPosition)==null?void 0:h.map(b=>b*.6),localRotation:u._localRotation,components:d};if(u._geometry)return u._lightID&&d.ILightWithId&&(d.ILightWithId.type=0),{geometry:u._geometry._type==="CUSTOM"?{type:u._geometry._type,mesh:{vertices:u._geometry._mesh._vertices,uv:u._geometry._mesh._uv,triangles:u._geometry._mesh._triangles},material:typeof u._geometry._material=="string"?u._geometry._material:{shader:u._geometry._material._shader,shaderKeywords:u._geometry._material._shaderKeywords,collision:u._geometry._material._collision,track:u._geometry._material._track,color:u._geometry._material._color},collision:u._geometry._collision}:{type:u._geometry._type,material:typeof u._geometry._material=="string"?u._geometry._material:{shader:u._geometry._material._shader,shaderKeywords:u._geometry._material._shaderKeywords,collision:u._geometry._material._collision,track:u._geometry._material._track,color:u._geometry._material._color},collision:u._geometry._collision},track:u._track,duplicate:u._duplicate,active:u._active,scale:u._scale,position:(p=u._position)==null?void 0:p.map(b=>b*.6),rotation:u._rotation,localPosition:(g=u._localPosition)==null?void 0:g.map(b=>b*.6),localRotation:u._localRotation,components:d};throw new Error("Error converting environment v2 to v3")});continue}if(c==="_materials"){e.customData.materials={};for(const u in i.customData._materials)e.customData.materials[u]={shader:i.customData._materials[u]._shader,shaderKeywords:i.customData._materials[u]._shaderKeywords,collision:i.customData._materials[u]._collision,track:i.customData._materials[u]._track,color:i.customData._materials[u]._color};continue}if(c==="_pointDefinitions"){e.customData.pointDefinitions={},i.customData._pointDefinitions.forEach(u=>{e.customData.pointDefinitions[u._name]=u._points});continue}if(c==="_time"){e.customData.time=i.customData[c];continue}if(c==="_BPMChanges"){e.customData.BPMChanges=(r=i.customData[c])==null?void 0:r.map(u=>({b:u._time,m:u._BPM,p:u._beatsPerBar,o:u._metronomeOffset}));continue}if(c==="_bpmChanges"){e.customData.BPMChanges=(s=i.customData[c])==null?void 0:s.map(u=>({b:u._time,m:u._bpm,p:u._beatsPerBar,o:u._metronomeOffset}));continue}if(c==="_bookmarks"){e.customData.bookmarks=(l=i.customData._bookmarks)==null?void 0:l.map(u=>({b:u._time,n:u._name,c:u._color}));continue}e.customData[c]=i.customData[c]}if(e.customData.environment){const c=[];for(const d of e.customData.environment)d.track&&c.push(d.track);const u=[];if(e.customData.customEvents){for(const d of e.customData.customEvents)if(d.t==="AnimateTrack"){if(typeof d.d.track=="string"&&c.includes(d.d.track))u.push(d);else if(Array.isArray(d.d.track)){for(const m of d.d.track)if(c.includes(m)){u.push(d);break}}}}for(const d of u)typeof d.d.track=="string"?typeof d.d.position=="string"?rt.warn(he("V2toV3"),"Cannot convert point definitions, unknown use."):Array.isArray(d.d.position)&&d.d.position.forEach(m=>{m[0]*=.6,m[1]*=.6,m[2]*=.6}):rt.warn(he("V2toV3"),"Environment animate track array conversion not yet implemented.")}return e.useNormalEventsAsCompatibleEvents=!0,e}const rn=i=>`[load::${i}]`;async function lm(i){const t=i.file("Info.dat")||i.file("info.dat");if(!t)throw new Error("Couldn't find Info.dat");return rt.info(rn("loadInfo"),"loading info"),Md(JSON.parse(await t.async("string")))}async function cm(i,t){var a,o,r,s,l,c;const e=[],n=i._difficultyBeatmapSets;for(let u=n.length-1;u>=0;u--){const d=n[u]._difficultyBeatmaps;if(d.length===0||!d){rt.error(rn("loadDifficulty"),"Empty difficulty set, removing..."),n.splice(u,1);continue}for(let m=0;m<d.length;m++){const h=d[m],p=t.file(h._beatmapFilename);if(p){rt.info(rn("loadDifficulty"),`Loading ${n[u]._beatmapCharacteristicName} ${h._difficulty}`);let g;try{g=JSON.parse(await p.async("string"))}catch(b){throw new Error(`${n[u]._beatmapCharacteristicName} ${h._difficulty} ${b}`)}try{if(g._notes&&g.version&&rt.error(rn("loadDifficulty"),`${n[u]._beatmapCharacteristicName} ${h._difficulty} contains 2 version of the map in the same file, attempting to load v3 instead`),g.version){const b=gf(g),y=be.create(i._beatsPerMinute,[...(a=b.customData.BPMChanges)!=null?a:[],...b.bpmEvents.map(v=>v.toJSON())],(o=h._customData)==null?void 0:o._editorOffset);e.push({info:h,characteristic:n[u]._beatmapCharacteristicName,difficulty:h._difficulty,bpm:y,data:b,noteContainer:b.getNoteContainer(),eventContainer:b.getEventContainer(),swingAnalysis:rs(b,y,n[u]._beatmapCharacteristicName,h._difficulty),rawVersion:3,rawData:g})}else{const b=om(Gd(g),!0),y=be.create(i._beatsPerMinute,(l=(r=g._customData)==null?void 0:r._BPMChanges)!=null?l:(s=g._customData)==null?void 0:s._bpmChanges,(c=h._customData)==null?void 0:c._editorOffset);e.push({info:h,characteristic:n[u]._beatmapCharacteristicName,difficulty:h._difficulty,bpm:y,data:b,noteContainer:b.getNoteContainer(),eventContainer:b.getEventContainer(),swingAnalysis:rs(b,y,n[u]._beatmapCharacteristicName,h._difficulty),rawVersion:2,rawData:g})}}catch(b){throw new Error(`${n[u]._beatmapCharacteristicName} ${h._difficulty} ${b}`)}}else if(rt.error(rn("loadDifficulty"),`Missing ${h._beatmapFilename} file for ${n[u]._beatmapCharacteristicName} ${h._difficulty}, ignoring.`),n[u]._difficultyBeatmaps.splice(m,1),m--,n[u]._difficultyBeatmaps.length<1){rt.error(`${n[u]._beatmapCharacteristicName} difficulty set now empty, ignoring.`),n.splice(u,1);continue}}}return e}async function Jc(i){return new Promise(function(t,e){const n=new XMLHttpRequest;n.open("GET",i,!0),n.responseType="json",n.timeout=5e3;let a=Date.now();n.onprogress=()=>{n.timeout+=Date.now()-a},n.onload=()=>{n.status===200&&t(n.response),n.status===404&&e("Error 404: Map does not exist"),n.status===403&&e("Error 403: Forbidden"),e(`Error ${n.status}`)},n.onerror=()=>{e("Error downloading")},n.ontimeout=()=>{e("Connection timeout")},n.send()})}async function um(i){const t=`https://api.beatsaver.com/maps/id/${i}`,e=await Jc(t);if(e!=null&&e.versions.length)return e.versions[e.versions.length-1].downloadURL;throw new Error("could not find map download link")}async function hm(i){const t=`https://api.beatsaver.com/maps/hash/${i}`,e=await Jc(t);if(e!=null&&e.versions.length)return e.versions[e.versions.length-1].downloadURL;throw new Error("could not find map download link")}const _n=i=>`[download::${i}]`;async function xr(i){return new Promise(function(t,e){const n=new XMLHttpRequest;n.open("GET",i,!0),n.responseType="arraybuffer",n.timeout=5e3;let a=Date.now();n.onprogress=o=>{n.timeout+=Date.now()-a,wt.status("download",`Downloading map: ${A(o.loaded/1024/1024,1)}MB / ${A(o.total/1024/1024,1)}MB`,o.loaded/o.total*100)},n.onload=()=>{n.status===200&&t(n.response),n.status===404&&e("Error 404: Map/link does not exist"),n.status===403&&e("Error 403: Forbidden"),e(`Error ${n.status}`)},n.onerror=()=>{e("Error downloading")},n.ontimeout=()=>{e("Connection timeout")},n.send()})}async function qc(i){const t=zo(i);rt.info(_n("downloadFromID"),`fetching download URL from BeatSaver for map ID ${t}`),wt.status("info","Fetching download URL from BeatSaver",0);const e=await um(t);rt.info(_n("downloadFromID"),`downloading from BeatSaver for map ID ${t}`),wt.status("info","Requesting download from BeatSaver",0);const n=await xr(e);return Xt.setCoverLink("https://beatsaver.com/maps/"+t,t),n}async function dm(i){const t=Ho(i);if(t.match(/^(https?:\/\/)?(www\.)?beatsaver\.com\/maps\//))return qc(t.replace(/^https?:\/\/(www\.)?beatsaver\.com\/maps\//,"").match(/[a-fA-F0-9]*/)[0]);wt.status("info","Requesting download from link",0),rt.info(_n("downloadFromURL"),`downloading from ${t}`);let e=await xr("https://cors.bsmg.dev/"+t);return Xt.setCoverLink(t),e}async function fm(i){let t;if(Fo(i.trim()))t=i.trim();else throw new Error("invalid hash");rt.info(_n("downloadFromHash"),`fetching download URL from BeatSaver for map hash ${t}`),wt.status("info","Fetching download URL from BeatSaver",0);const e=await hm(t);return rt.info(_n("downloadFromHash"),`downloading from BeatSaver for map hash ${t}`),wt.status("info","Requesting download from BeatSaver",0),await xr(e)}var Rn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function xn(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Zc={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(i,t){(function(e){i.exports=e()})(function(){return function e(n,a,o){function r(c,u){if(!a[c]){if(!n[c]){var d=typeof xn=="function"&&xn;if(!u&&d)return d(c,!0);if(s)return s(c,!0);var m=new Error("Cannot find module '"+c+"'");throw m.code="MODULE_NOT_FOUND",m}var h=a[c]={exports:{}};n[c][0].call(h.exports,function(p){var g=n[c][1][p];return r(g||p)},h,h.exports,e,n,a,o)}return a[c].exports}for(var s=typeof xn=="function"&&xn,l=0;l<o.length;l++)r(o[l]);return r}({1:[function(e,n,a){var o=e("./utils"),r=e("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(l){for(var c,u,d,m,h,p,g,b=[],y=0,v=l.length,S=v,L=o.getTypeOf(l)!=="string";y<l.length;)S=v-y,d=L?(c=l[y++],u=y<v?l[y++]:0,y<v?l[y++]:0):(c=l.charCodeAt(y++),u=y<v?l.charCodeAt(y++):0,y<v?l.charCodeAt(y++):0),m=c>>2,h=(3&c)<<4|u>>4,p=1<S?(15&u)<<2|d>>6:64,g=2<S?63&d:64,b.push(s.charAt(m)+s.charAt(h)+s.charAt(p)+s.charAt(g));return b.join("")},a.decode=function(l){var c,u,d,m,h,p,g=0,b=0,y="data:";if(l.substr(0,y.length)===y)throw new Error("Invalid base64 input, it looks like a data url.");var v,S=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===s.charAt(64)&&S--,l.charAt(l.length-2)===s.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(v=r.uint8array?new Uint8Array(0|S):new Array(0|S);g<l.length;)c=s.indexOf(l.charAt(g++))<<2|(m=s.indexOf(l.charAt(g++)))>>4,u=(15&m)<<4|(h=s.indexOf(l.charAt(g++)))>>2,d=(3&h)<<6|(p=s.indexOf(l.charAt(g++))),v[b++]=c,h!==64&&(v[b++]=u),p!==64&&(v[b++]=d);return v}},{"./support":30,"./utils":32}],2:[function(e,n,a){var o=e("./external"),r=e("./stream/DataWorker"),s=e("./stream/Crc32Probe"),l=e("./stream/DataLengthProbe");function c(u,d,m,h,p){this.compressedSize=u,this.uncompressedSize=d,this.crc32=m,this.compression=h,this.compressedContent=p}c.prototype={getContentWorker:function(){var u=new r(o.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),d=this;return u.on("end",function(){if(this.streamInfo.data_length!==d.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new r(o.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(u,d,m){return u.pipe(new s).pipe(new l("uncompressedSize")).pipe(d.compressWorker(m)).pipe(new l("compressedSize")).withStreamInfo("compression",d)},n.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,n,a){var o=e("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(){return new o("STORE compression")},uncompressWorker:function(){return new o("STORE decompression")}},a.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,n,a){var o=e("./utils"),r=function(){for(var s,l=[],c=0;c<256;c++){s=c;for(var u=0;u<8;u++)s=1&s?3988292384^s>>>1:s>>>1;l[c]=s}return l}();n.exports=function(s,l){return s!==void 0&&s.length?o.getTypeOf(s)!=="string"?function(c,u,d,m){var h=r,p=m+d;c^=-1;for(var g=m;g<p;g++)c=c>>>8^h[255&(c^u[g])];return-1^c}(0|l,s,s.length,0):function(c,u,d,m){var h=r,p=m+d;c^=-1;for(var g=m;g<p;g++)c=c>>>8^h[255&(c^u.charCodeAt(g))];return-1^c}(0|l,s,s.length,0):0}},{"./utils":32}],5:[function(e,n,a){a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(e,n,a){var o=null;o=typeof Promise<"u"?Promise:e("lie"),n.exports={Promise:o}},{lie:37}],7:[function(e,n,a){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",r=e("pako"),s=e("./utils"),l=e("./stream/GenericWorker"),c=o?"uint8array":"array";function u(d,m){l.call(this,"FlateWorker/"+d),this._pako=null,this._pakoAction=d,this._pakoOptions=m,this.meta={}}a.magic="\b\0",s.inherits(u,l),u.prototype.processChunk=function(d){this.meta=d.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(c,d.data),!1)},u.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new r[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var d=this;this._pako.onData=function(m){d.push({data:m,meta:d.meta})}},a.compressWorker=function(d){return new u("Deflate",d)},a.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,n,a){function o(h,p){var g,b="";for(g=0;g<p;g++)b+=String.fromCharCode(255&h),h>>>=8;return b}function r(h,p,g,b,y,v){var S,L,C=h.file,F=h.compression,M=v!==c.utf8encode,j=s.transformTo("string",v(C.name)),B=s.transformTo("string",c.utf8encode(C.name)),G=C.comment,tt=s.transformTo("string",v(G)),w=s.transformTo("string",c.utf8encode(G)),$=B.length!==C.name.length,_=w.length!==G.length,H="",Z="",Y="",ct=C.dir,W=C.date,st={crc32:0,compressedSize:0,uncompressedSize:0};p&&!g||(st.crc32=h.crc32,st.compressedSize=h.compressedSize,st.uncompressedSize=h.uncompressedSize);var N=0;p&&(N|=8),M||!$&&!_||(N|=2048);var x=0,at=0;ct&&(x|=16),y==="UNIX"?(at=798,x|=function(q,xt){var Pt=q;return q||(Pt=xt?16893:33204),(65535&Pt)<<16}(C.unixPermissions,ct)):(at=20,x|=function(q){return 63&(q||0)}(C.dosPermissions)),S=W.getUTCHours(),S<<=6,S|=W.getUTCMinutes(),S<<=5,S|=W.getUTCSeconds()/2,L=W.getUTCFullYear()-1980,L<<=4,L|=W.getUTCMonth()+1,L<<=5,L|=W.getUTCDate(),$&&(Z=o(1,1)+o(u(j),4)+B,H+="up"+o(Z.length,2)+Z),_&&(Y=o(1,1)+o(u(tt),4)+w,H+="uc"+o(Y.length,2)+Y);var K="";return K+=`
\0`,K+=o(N,2),K+=F.magic,K+=o(S,2),K+=o(L,2),K+=o(st.crc32,4),K+=o(st.compressedSize,4),K+=o(st.uncompressedSize,4),K+=o(j.length,2),K+=o(H.length,2),{fileRecord:d.LOCAL_FILE_HEADER+K+j+H,dirRecord:d.CENTRAL_FILE_HEADER+o(at,2)+K+o(tt.length,2)+"\0\0\0\0"+o(x,4)+o(b,4)+j+H+tt}}var s=e("../utils"),l=e("../stream/GenericWorker"),c=e("../utf8"),u=e("../crc32"),d=e("../signature");function m(h,p,g,b){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=p,this.zipPlatform=g,this.encodeFileName=b,this.streamFiles=h,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(m,l),m.prototype.push=function(h){var p=h.meta.percent||0,g=this.entriesCount,b=this._sources.length;this.accumulate?this.contentBuffer.push(h):(this.bytesWritten+=h.data.length,l.prototype.push.call(this,{data:h.data,meta:{currentFile:this.currentFile,percent:g?(p+100*(g-b-1))/g:100}}))},m.prototype.openedSource=function(h){this.currentSourceOffset=this.bytesWritten,this.currentFile=h.file.name;var p=this.streamFiles&&!h.file.dir;if(p){var g=r(h,p,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:g.fileRecord,meta:{percent:0}})}else this.accumulate=!0},m.prototype.closedSource=function(h){this.accumulate=!1;var p=this.streamFiles&&!h.file.dir,g=r(h,p,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(g.dirRecord),p)this.push({data:function(b){return d.DATA_DESCRIPTOR+o(b.crc32,4)+o(b.compressedSize,4)+o(b.uncompressedSize,4)}(h),meta:{percent:100}});else for(this.push({data:g.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},m.prototype.flush=function(){for(var h=this.bytesWritten,p=0;p<this.dirRecords.length;p++)this.push({data:this.dirRecords[p],meta:{percent:100}});var g=this.bytesWritten-h,b=function(y,v,S,L,C){var F=s.transformTo("string",C(L));return d.CENTRAL_DIRECTORY_END+"\0\0\0\0"+o(y,2)+o(y,2)+o(v,4)+o(S,4)+o(F.length,2)+F}(this.dirRecords.length,g,h,this.zipComment,this.encodeFileName);this.push({data:b,meta:{percent:100}})},m.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},m.prototype.registerPrevious=function(h){this._sources.push(h);var p=this;return h.on("data",function(g){p.processChunk(g)}),h.on("end",function(){p.closedSource(p.previous.streamInfo),p._sources.length?p.prepareNextSource():p.end()}),h.on("error",function(g){p.error(g)}),this},m.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},m.prototype.error=function(h){var p=this._sources;if(!l.prototype.error.call(this,h))return!1;for(var g=0;g<p.length;g++)try{p[g].error(h)}catch{}return!0},m.prototype.lock=function(){l.prototype.lock.call(this);for(var h=this._sources,p=0;p<h.length;p++)h[p].lock()},n.exports=m},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,n,a){var o=e("../compressions"),r=e("./ZipFileWorker");a.generateWorker=function(s,l,c){var u=new r(l.streamFiles,c,l.platform,l.encodeFileName),d=0;try{s.forEach(function(m,h){d++;var p=function(v,S){var L=v||S,C=o[L];if(!C)throw new Error(L+" is not a valid compression method !");return C}(h.options.compression,l.compression),g=h.options.compressionOptions||l.compressionOptions||{},b=h.dir,y=h.date;h._compressWorker(p,g).withStreamInfo("file",{name:m,dir:b,date:y,comment:h.comment||"",unixPermissions:h.unixPermissions,dosPermissions:h.dosPermissions}).pipe(u)}),u.entriesCount=d}catch(m){u.error(m)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,n,a){function o(){if(!(this instanceof o))return new o;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var r=new o;for(var s in this)typeof this[s]!="function"&&(r[s]=this[s]);return r}}(o.prototype=e("./object")).loadAsync=e("./load"),o.support=e("./support"),o.defaults=e("./defaults"),o.version="3.10.1",o.loadAsync=function(r,s){return new o().loadAsync(r,s)},o.external=e("./external"),n.exports=o},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,n,a){var o=e("./utils"),r=e("./external"),s=e("./utf8"),l=e("./zipEntries"),c=e("./stream/Crc32Probe"),u=e("./nodejsUtils");function d(m){return new r.Promise(function(h,p){var g=m.decompressed.getContentWorker().pipe(new c);g.on("error",function(b){p(b)}).on("end",function(){g.streamInfo.crc32!==m.decompressed.crc32?p(new Error("Corrupted zip : CRC32 mismatch")):h()}).resume()})}n.exports=function(m,h){var p=this;return h=o.extend(h||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),u.isNode&&u.isStream(m)?r.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):o.prepareContent("the loaded zip file",m,!0,h.optimizedBinaryString,h.base64).then(function(g){var b=new l(h);return b.load(g),b}).then(function(g){var b=[r.Promise.resolve(g)],y=g.files;if(h.checkCRC32)for(var v=0;v<y.length;v++)b.push(d(y[v]));return r.Promise.all(b)}).then(function(g){for(var b=g.shift(),y=b.files,v=0;v<y.length;v++){var S=y[v],L=S.fileNameStr,C=o.resolve(S.fileNameStr);p.file(C,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:h.createFolders}),S.dir||(p.file(C).unsafeOriginalName=L)}return b.zipComment.length&&(p.comment=b.zipComment),p})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,n,a){var o=e("../utils"),r=e("../stream/GenericWorker");function s(l,c){r.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}o.inherits(s,r),s.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(u){c.push({data:u,meta:{percent:0}})}).on("error",function(u){c.isPaused?this.generatedError=u:c.error(u)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},s.prototype.pause=function(){return!!r.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,n,a){var o=e("readable-stream").Readable;function r(s,l,c){o.call(this,l),this._helper=s;var u=this;s.on("data",function(d,m){u.push(d)||u._helper.pause(),c&&c(m)}).on("error",function(d){u.emit("error",d)}).on("end",function(){u.push(null)})}e("../utils").inherits(r,o),r.prototype._read=function(){this._helper.resume()},n.exports=r},{"../utils":32,"readable-stream":16}],14:[function(e,n,a){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(o,r){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(o,r);if(typeof o=="number")throw new Error('The "data" argument must not be a number');return new Buffer(o,r)},allocBuffer:function(o){if(Buffer.alloc)return Buffer.alloc(o);var r=new Buffer(o);return r.fill(0),r},isBuffer:function(o){return Buffer.isBuffer(o)},isStream:function(o){return o&&typeof o.on=="function"&&typeof o.pause=="function"&&typeof o.resume=="function"}}},{}],15:[function(e,n,a){function o(C,F,M){var j,B=s.getTypeOf(F),G=s.extend(M||{},u);G.date=G.date||new Date,G.compression!==null&&(G.compression=G.compression.toUpperCase()),typeof G.unixPermissions=="string"&&(G.unixPermissions=parseInt(G.unixPermissions,8)),G.unixPermissions&&16384&G.unixPermissions&&(G.dir=!0),G.dosPermissions&&16&G.dosPermissions&&(G.dir=!0),G.dir&&(C=y(C)),G.createFolders&&(j=b(C))&&v.call(this,j,!0);var tt=B==="string"&&G.binary===!1&&G.base64===!1;M&&M.binary!==void 0||(G.binary=!tt),(F instanceof d&&F.uncompressedSize===0||G.dir||!F||F.length===0)&&(G.base64=!1,G.binary=!0,F="",G.compression="STORE",B="string");var w=null;w=F instanceof d||F instanceof l?F:p.isNode&&p.isStream(F)?new g(C,F):s.prepareContent(C,F,G.binary,G.optimizedBinaryString,G.base64);var $=new m(C,w,G);this.files[C]=$}var r=e("./utf8"),s=e("./utils"),l=e("./stream/GenericWorker"),c=e("./stream/StreamHelper"),u=e("./defaults"),d=e("./compressedObject"),m=e("./zipObject"),h=e("./generate"),p=e("./nodejsUtils"),g=e("./nodejs/NodejsStreamInputAdapter"),b=function(C){C.slice(-1)==="/"&&(C=C.substring(0,C.length-1));var F=C.lastIndexOf("/");return 0<F?C.substring(0,F):""},y=function(C){return C.slice(-1)!=="/"&&(C+="/"),C},v=function(C,F){return F=F!==void 0?F:u.createFolders,C=y(C),this.files[C]||o.call(this,C,null,{dir:!0,createFolders:F}),this.files[C]};function S(C){return Object.prototype.toString.call(C)==="[object RegExp]"}var L={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(C){var F,M,j;for(F in this.files)j=this.files[F],(M=F.slice(this.root.length,F.length))&&F.slice(0,this.root.length)===this.root&&C(M,j)},filter:function(C){var F=[];return this.forEach(function(M,j){C(M,j)&&F.push(j)}),F},file:function(C,F,M){if(arguments.length!==1)return C=this.root+C,o.call(this,C,F,M),this;if(S(C)){var j=C;return this.filter(function(G,tt){return!tt.dir&&j.test(G)})}var B=this.files[this.root+C];return B&&!B.dir?B:null},folder:function(C){if(!C)return this;if(S(C))return this.filter(function(B,G){return G.dir&&C.test(B)});var F=this.root+C,M=v.call(this,F),j=this.clone();return j.root=M.name,j},remove:function(C){C=this.root+C;var F=this.files[C];if(F||(C.slice(-1)!=="/"&&(C+="/"),F=this.files[C]),F&&!F.dir)delete this.files[C];else for(var M=this.filter(function(B,G){return G.name.slice(0,C.length)===C}),j=0;j<M.length;j++)delete this.files[M[j].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(C){var F,M={};try{if((M=s.extend(C||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:r.utf8encode})).type=M.type.toLowerCase(),M.compression=M.compression.toUpperCase(),M.type==="binarystring"&&(M.type="string"),!M.type)throw new Error("No output type specified.");s.checkSupport(M.type),M.platform!=="darwin"&&M.platform!=="freebsd"&&M.platform!=="linux"&&M.platform!=="sunos"||(M.platform="UNIX"),M.platform==="win32"&&(M.platform="DOS");var j=M.comment||this.comment||"";F=h.generateWorker(this,M,j)}catch(B){(F=new l("error")).error(B)}return new c(F,M.type||"string",M.mimeType)},generateAsync:function(C,F){return this.generateInternalStream(C).accumulate(F)},generateNodeStream:function(C,F){return(C=C||{}).type||(C.type="nodebuffer"),this.generateInternalStream(C).toNodejsStream(F)}};n.exports=L},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,n,a){n.exports=e("stream")},{stream:void 0}],17:[function(e,n,a){var o=e("./DataReader");function r(s){o.call(this,s);for(var l=0;l<this.data.length;l++)s[l]=255&s[l]}e("../utils").inherits(r,o),r.prototype.byteAt=function(s){return this.data[this.zero+s]},r.prototype.lastIndexOfSignature=function(s){for(var l=s.charCodeAt(0),c=s.charCodeAt(1),u=s.charCodeAt(2),d=s.charCodeAt(3),m=this.length-4;0<=m;--m)if(this.data[m]===l&&this.data[m+1]===c&&this.data[m+2]===u&&this.data[m+3]===d)return m-this.zero;return-1},r.prototype.readAndCheckSignature=function(s){var l=s.charCodeAt(0),c=s.charCodeAt(1),u=s.charCodeAt(2),d=s.charCodeAt(3),m=this.readData(4);return l===m[0]&&c===m[1]&&u===m[2]&&d===m[3]},r.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},n.exports=r},{"../utils":32,"./DataReader":18}],18:[function(e,n,a){var o=e("../utils");function r(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}r.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(){},readInt:function(s){var l,c=0;for(this.checkOffset(s),l=this.index+s-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=s,c},readString:function(s){return o.transformTo("string",this.readData(s))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},n.exports=r},{"../utils":32}],19:[function(e,n,a){var o=e("./Uint8ArrayReader");function r(s){o.call(this,s)}e("../utils").inherits(r,o),r.prototype.readData=function(s){this.checkOffset(s);var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},n.exports=r},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,n,a){var o=e("./DataReader");function r(s){o.call(this,s)}e("../utils").inherits(r,o),r.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},r.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},r.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},r.prototype.readData=function(s){this.checkOffset(s);var l=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},n.exports=r},{"../utils":32,"./DataReader":18}],21:[function(e,n,a){var o=e("./ArrayReader");function r(s){o.call(this,s)}e("../utils").inherits(r,o),r.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,l},n.exports=r},{"../utils":32,"./ArrayReader":17}],22:[function(e,n,a){var o=e("../utils"),r=e("../support"),s=e("./ArrayReader"),l=e("./StringReader"),c=e("./NodeBufferReader"),u=e("./Uint8ArrayReader");n.exports=function(d){var m=o.getTypeOf(d);return o.checkSupport(m),m!=="string"||r.uint8array?m==="nodebuffer"?new c(d):r.uint8array?new u(o.transformTo("uint8array",d)):new s(o.transformTo("array",d)):new l(d)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,n,a){a.LOCAL_FILE_HEADER="PK",a.CENTRAL_FILE_HEADER="PK",a.CENTRAL_DIRECTORY_END="PK",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,n,a){var o=e("./GenericWorker"),r=e("../utils");function s(l){o.call(this,"ConvertWorker to "+l),this.destType=l}r.inherits(s,o),s.prototype.processChunk=function(l){this.push({data:r.transformTo(this.destType,l.data),meta:l.meta})},n.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(e,n,a){var o=e("./GenericWorker"),r=e("../crc32");function s(){o.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(s,o),s.prototype.processChunk=function(l){this.streamInfo.crc32=r(l.data,this.streamInfo.crc32||0),this.push(l)},n.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,n,a){var o=e("../utils"),r=e("./GenericWorker");function s(l){r.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}o.inherits(s,r),s.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}r.prototype.processChunk.call(this,l)},n.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(e,n,a){var o=e("../utils"),r=e("./GenericWorker");function s(l){r.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(u){c.dataIsReady=!0,c.data=u,c.max=u&&u.length||0,c.type=o.getTypeOf(u),c.isPaused||c._tickAndRepeat()},function(u){c.error(u)})}o.inherits(s,r),s.prototype.cleanUp=function(){r.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,o.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(o.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(e,n,a){function o(r){this.name=r||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}o.prototype={push:function(r){this.emit("data",r)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(r){this.emit("error",r)}return!0},error:function(r){return!this.isFinished&&(this.isPaused?this.generatedError=r:(this.isFinished=!0,this.emit("error",r),this.previous&&this.previous.error(r),this.cleanUp()),!0)},on:function(r,s){return this._listeners[r].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(r,s){if(this._listeners[r])for(var l=0;l<this._listeners[r].length;l++)this._listeners[r][l].call(this,s)},pipe:function(r){return r.registerPrevious(this)},registerPrevious:function(r){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=r.streamInfo,this.mergeStreamInfo(),this.previous=r;var s=this;return r.on("data",function(l){s.processChunk(l)}),r.on("end",function(){s.end()}),r.on("error",function(l){s.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var r=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),r=!0),this.previous&&this.previous.resume(),!r},flush:function(){},processChunk:function(r){this.push(r)},withStreamInfo:function(r,s){return this.extraStreamInfo[r]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var r in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,r)&&(this.streamInfo[r]=this.extraStreamInfo[r])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var r="Worker "+this.name;return this.previous?this.previous+" -> "+r:r}},n.exports=o},{}],29:[function(e,n,a){var o=e("../utils"),r=e("./ConvertWorker"),s=e("./GenericWorker"),l=e("../base64"),c=e("../support"),u=e("../external"),d=null;if(c.nodestream)try{d=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function m(p,g){return new u.Promise(function(b,y){var v=[],S=p._internalType,L=p._outputType,C=p._mimeType;p.on("data",function(F,M){v.push(F),g&&g(M)}).on("error",function(F){v=[],y(F)}).on("end",function(){try{var F=function(M,j,B){switch(M){case"blob":return o.newBlob(o.transformTo("arraybuffer",j),B);case"base64":return l.encode(j);default:return o.transformTo(M,j)}}(L,function(M,j){var B,G=0,tt=null,w=0;for(B=0;B<j.length;B++)w+=j[B].length;switch(M){case"string":return j.join("");case"array":return Array.prototype.concat.apply([],j);case"uint8array":for(tt=new Uint8Array(w),B=0;B<j.length;B++)tt.set(j[B],G),G+=j[B].length;return tt;case"nodebuffer":return Buffer.concat(j);default:throw new Error("concat : unsupported type '"+M+"'")}}(S,v),C);b(F)}catch(M){y(M)}v=[]}).resume()})}function h(p,g,b){var y=g;switch(g){case"blob":case"arraybuffer":y="uint8array";break;case"base64":y="string"}try{this._internalType=y,this._outputType=g,this._mimeType=b,o.checkSupport(y),this._worker=p.pipe(new r(y)),p.lock()}catch(v){this._worker=new s("error"),this._worker.error(v)}}h.prototype={accumulate:function(p){return m(this,p)},on:function(p,g){var b=this;return p==="data"?this._worker.on(p,function(y){g.call(b,y.data,y.meta)}):this._worker.on(p,function(){o.delay(g,arguments,b)}),this},resume:function(){return o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(p){if(o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new d(this,{objectMode:this._outputType!=="nodebuffer"},p)}},n.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,n,a){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",a.nodebuffer=typeof Buffer<"u",a.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")a.blob=!1;else{var o=new ArrayBuffer(0);try{a.blob=new Blob([o],{type:"application/zip"}).size===0}catch{try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);r.append(o),a.blob=r.getBlob("application/zip").size===0}catch{a.blob=!1}}}try{a.nodestream=!!e("readable-stream").Readable}catch{a.nodestream=!1}},{"readable-stream":16}],31:[function(e,n,a){for(var o=e("./utils"),r=e("./support"),s=e("./nodejsUtils"),l=e("./stream/GenericWorker"),c=new Array(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;c[254]=c[254]=1;function d(){l.call(this,"utf-8 decode"),this.leftOver=null}function m(){l.call(this,"utf-8 encode")}a.utf8encode=function(h){return r.nodebuffer?s.newBufferFrom(h,"utf-8"):function(p){var g,b,y,v,S,L=p.length,C=0;for(v=0;v<L;v++)(64512&(b=p.charCodeAt(v)))==55296&&v+1<L&&(64512&(y=p.charCodeAt(v+1)))==56320&&(b=65536+(b-55296<<10)+(y-56320),v++),C+=b<128?1:b<2048?2:b<65536?3:4;for(g=r.uint8array?new Uint8Array(C):new Array(C),v=S=0;S<C;v++)(64512&(b=p.charCodeAt(v)))==55296&&v+1<L&&(64512&(y=p.charCodeAt(v+1)))==56320&&(b=65536+(b-55296<<10)+(y-56320),v++),b<128?g[S++]=b:(b<2048?g[S++]=192|b>>>6:(b<65536?g[S++]=224|b>>>12:(g[S++]=240|b>>>18,g[S++]=128|b>>>12&63),g[S++]=128|b>>>6&63),g[S++]=128|63&b);return g}(h)},a.utf8decode=function(h){return r.nodebuffer?o.transformTo("nodebuffer",h).toString("utf-8"):function(p){var g,b,y,v,S=p.length,L=new Array(2*S);for(g=b=0;g<S;)if((y=p[g++])<128)L[b++]=y;else if(4<(v=c[y]))L[b++]=65533,g+=v-1;else{for(y&=v===2?31:v===3?15:7;1<v&&g<S;)y=y<<6|63&p[g++],v--;1<v?L[b++]=65533:y<65536?L[b++]=y:(y-=65536,L[b++]=55296|y>>10&1023,L[b++]=56320|1023&y)}return L.length!==b&&(L.subarray?L=L.subarray(0,b):L.length=b),o.applyFromCharCode(L)}(h=o.transformTo(r.uint8array?"uint8array":"array",h))},o.inherits(d,l),d.prototype.processChunk=function(h){var p=o.transformTo(r.uint8array?"uint8array":"array",h.data);if(this.leftOver&&this.leftOver.length){if(r.uint8array){var g=p;(p=new Uint8Array(g.length+this.leftOver.length)).set(this.leftOver,0),p.set(g,this.leftOver.length)}else p=this.leftOver.concat(p);this.leftOver=null}var b=function(v,S){var L;for((S=S||v.length)>v.length&&(S=v.length),L=S-1;0<=L&&(192&v[L])==128;)L--;return L<0||L===0?S:L+c[v[L]]>S?L:S}(p),y=p;b!==p.length&&(r.uint8array?(y=p.subarray(0,b),this.leftOver=p.subarray(b,p.length)):(y=p.slice(0,b),this.leftOver=p.slice(b,p.length))),this.push({data:a.utf8decode(y),meta:h.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=d,o.inherits(m,l),m.prototype.processChunk=function(h){this.push({data:a.utf8encode(h.data),meta:h.meta})},a.Utf8EncodeWorker=m},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,n,a){var o=e("./support"),r=e("./base64"),s=e("./nodejsUtils"),l=e("./external");function c(g){return g}function u(g,b){for(var y=0;y<g.length;++y)b[y]=255&g.charCodeAt(y);return b}e("setimmediate"),a.newBlob=function(g,b){a.checkSupport("blob");try{return new Blob([g],{type:b})}catch{try{var y=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return y.append(g),y.getBlob(b)}catch{throw new Error("Bug : can't construct the Blob.")}}};var d={stringifyByChunk:function(g,b,y){var v=[],S=0,L=g.length;if(L<=y)return String.fromCharCode.apply(null,g);for(;S<L;)b==="array"||b==="nodebuffer"?v.push(String.fromCharCode.apply(null,g.slice(S,Math.min(S+y,L)))):v.push(String.fromCharCode.apply(null,g.subarray(S,Math.min(S+y,L)))),S+=y;return v.join("")},stringifyByChar:function(g){for(var b="",y=0;y<g.length;y++)b+=String.fromCharCode(g[y]);return b},applyCanBeUsed:{uint8array:function(){try{return o.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return o.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}}()}};function m(g){var b=65536,y=a.getTypeOf(g),v=!0;if(y==="uint8array"?v=d.applyCanBeUsed.uint8array:y==="nodebuffer"&&(v=d.applyCanBeUsed.nodebuffer),v)for(;1<b;)try{return d.stringifyByChunk(g,y,b)}catch{b=Math.floor(b/2)}return d.stringifyByChar(g)}function h(g,b){for(var y=0;y<g.length;y++)b[y]=g[y];return b}a.applyFromCharCode=m;var p={};p.string={string:c,array:function(g){return u(g,new Array(g.length))},arraybuffer:function(g){return p.string.uint8array(g).buffer},uint8array:function(g){return u(g,new Uint8Array(g.length))},nodebuffer:function(g){return u(g,s.allocBuffer(g.length))}},p.array={string:m,array:c,arraybuffer:function(g){return new Uint8Array(g).buffer},uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return s.newBufferFrom(g)}},p.arraybuffer={string:function(g){return m(new Uint8Array(g))},array:function(g){return h(new Uint8Array(g),new Array(g.byteLength))},arraybuffer:c,uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return s.newBufferFrom(new Uint8Array(g))}},p.uint8array={string:m,array:function(g){return h(g,new Array(g.length))},arraybuffer:function(g){return g.buffer},uint8array:c,nodebuffer:function(g){return s.newBufferFrom(g)}},p.nodebuffer={string:m,array:function(g){return h(g,new Array(g.length))},arraybuffer:function(g){return p.nodebuffer.uint8array(g).buffer},uint8array:function(g){return h(g,new Uint8Array(g.length))},nodebuffer:c},a.transformTo=function(g,b){if(b=b||"",!g)return b;a.checkSupport(g);var y=a.getTypeOf(b);return p[y][g](b)},a.resolve=function(g){for(var b=g.split("/"),y=[],v=0;v<b.length;v++){var S=b[v];S==="."||S===""&&v!==0&&v!==b.length-1||(S===".."?y.pop():y.push(S))}return y.join("/")},a.getTypeOf=function(g){return typeof g=="string"?"string":Object.prototype.toString.call(g)==="[object Array]"?"array":o.nodebuffer&&s.isBuffer(g)?"nodebuffer":o.uint8array&&g instanceof Uint8Array?"uint8array":o.arraybuffer&&g instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(g){if(!o[g.toLowerCase()])throw new Error(g+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(g){var b,y,v="";for(y=0;y<(g||"").length;y++)v+="\\x"+((b=g.charCodeAt(y))<16?"0":"")+b.toString(16).toUpperCase();return v},a.delay=function(g,b,y){setImmediate(function(){g.apply(y||null,b||[])})},a.inherits=function(g,b){function y(){}y.prototype=b.prototype,g.prototype=new y},a.extend=function(){var g,b,y={};for(g=0;g<arguments.length;g++)for(b in arguments[g])Object.prototype.hasOwnProperty.call(arguments[g],b)&&y[b]===void 0&&(y[b]=arguments[g][b]);return y},a.prepareContent=function(g,b,y,v,S){return l.Promise.resolve(b).then(function(L){return o.blob&&(L instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(L))!==-1)&&typeof FileReader<"u"?new l.Promise(function(C,F){var M=new FileReader;M.onload=function(j){C(j.target.result)},M.onerror=function(j){F(j.target.error)},M.readAsArrayBuffer(L)}):L}).then(function(L){var C=a.getTypeOf(L);return C?(C==="arraybuffer"?L=a.transformTo("uint8array",L):C==="string"&&(S?L=r.decode(L):y&&v!==!0&&(L=function(F){return u(F,o.uint8array?new Uint8Array(F.length):new Array(F.length))}(L))),L):l.Promise.reject(new Error("Can't read the data of '"+g+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,n,a){var o=e("./reader/readerFor"),r=e("./utils"),s=e("./signature"),l=e("./zipEntry"),c=e("./support");function u(d){this.files=[],this.loadOptions=d}u.prototype={checkSignature:function(d){if(!this.reader.readAndCheckSignature(d)){this.reader.index-=4;var m=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+r.pretty(m)+", expected "+r.pretty(d)+")")}},isSignature:function(d,m){var h=this.reader.index;this.reader.setIndex(d);var p=this.reader.readString(4)===m;return this.reader.setIndex(h),p},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var d=this.reader.readData(this.zipCommentLength),m=c.uint8array?"uint8array":"array",h=r.transformTo(m,d);this.zipComment=this.loadOptions.decodeFileName(h)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var d,m,h,p=this.zip64EndOfCentralSize-44;0<p;)d=this.reader.readInt(2),m=this.reader.readInt(4),h=this.reader.readData(m),this.zip64ExtensibleData[d]={id:d,length:m,value:h}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var d,m;for(d=0;d<this.files.length;d++)m=this.files[d],this.reader.setIndex(m.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),m.readLocalPart(this.reader),m.handleUTF8(),m.processAttributes()},readCentralDir:function(){var d;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(d=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(d);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var d=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(d<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(d);var m=d;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===r.MAX_VALUE_16BITS||this.diskWithCentralDirStart===r.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===r.MAX_VALUE_16BITS||this.centralDirRecords===r.MAX_VALUE_16BITS||this.centralDirSize===r.MAX_VALUE_32BITS||this.centralDirOffset===r.MAX_VALUE_32BITS){if(this.zip64=!0,(d=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(d),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var h=this.centralDirOffset+this.centralDirSize;this.zip64&&(h+=20,h+=12+this.zip64EndOfCentralSize);var p=m-h;if(0<p)this.isSignature(m,s.CENTRAL_FILE_HEADER)||(this.reader.zero=p);else if(p<0)throw new Error("Corrupted zip: missing "+Math.abs(p)+" bytes.")},prepareReader:function(d){this.reader=o(d)},load:function(d){this.prepareReader(d),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,n,a){var o=e("./reader/readerFor"),r=e("./utils"),s=e("./compressedObject"),l=e("./crc32"),c=e("./utf8"),u=e("./compressions"),d=e("./support");function m(h,p){this.options=h,this.loadOptions=p}m.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(h){var p,g;if(h.skip(22),this.fileNameLength=h.readInt(2),g=h.readInt(2),this.fileName=h.readData(this.fileNameLength),h.skip(g),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((p=function(b){for(var y in u)if(Object.prototype.hasOwnProperty.call(u,y)&&u[y].magic===b)return u[y];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+r.pretty(this.compressionMethod)+" unknown (inner file : "+r.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,p,h.readData(this.compressedSize))},readCentralPart:function(h){this.versionMadeBy=h.readInt(2),h.skip(2),this.bitFlag=h.readInt(2),this.compressionMethod=h.readString(2),this.date=h.readDate(),this.crc32=h.readInt(4),this.compressedSize=h.readInt(4),this.uncompressedSize=h.readInt(4);var p=h.readInt(2);if(this.extraFieldsLength=h.readInt(2),this.fileCommentLength=h.readInt(2),this.diskNumberStart=h.readInt(2),this.internalFileAttributes=h.readInt(2),this.externalFileAttributes=h.readInt(4),this.localHeaderOffset=h.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");h.skip(p),this.readExtraFields(h),this.parseZIP64ExtraField(h),this.fileComment=h.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var h=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),h==0&&(this.dosPermissions=63&this.externalFileAttributes),h==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var h=o(this.extraFields[1].value);this.uncompressedSize===r.MAX_VALUE_32BITS&&(this.uncompressedSize=h.readInt(8)),this.compressedSize===r.MAX_VALUE_32BITS&&(this.compressedSize=h.readInt(8)),this.localHeaderOffset===r.MAX_VALUE_32BITS&&(this.localHeaderOffset=h.readInt(8)),this.diskNumberStart===r.MAX_VALUE_32BITS&&(this.diskNumberStart=h.readInt(4))}},readExtraFields:function(h){var p,g,b,y=h.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});h.index+4<y;)p=h.readInt(2),g=h.readInt(2),b=h.readData(g),this.extraFields[p]={id:p,length:g,value:b};h.setIndex(y)},handleUTF8:function(){var h=d.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var p=this.findExtraFieldUnicodePath();if(p!==null)this.fileNameStr=p;else{var g=r.transformTo(h,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(g)}var b=this.findExtraFieldUnicodeComment();if(b!==null)this.fileCommentStr=b;else{var y=r.transformTo(h,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(y)}}},findExtraFieldUnicodePath:function(){var h=this.extraFields[28789];if(h){var p=o(h.value);return p.readInt(1)!==1||l(this.fileName)!==p.readInt(4)?null:c.utf8decode(p.readData(h.length-5))}return null},findExtraFieldUnicodeComment:function(){var h=this.extraFields[25461];if(h){var p=o(h.value);return p.readInt(1)!==1||l(this.fileComment)!==p.readInt(4)?null:c.utf8decode(p.readData(h.length-5))}return null}},n.exports=m},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,n,a){function o(p,g,b){this.name=p,this.dir=b.dir,this.date=b.date,this.comment=b.comment,this.unixPermissions=b.unixPermissions,this.dosPermissions=b.dosPermissions,this._data=g,this._dataBinary=b.binary,this.options={compression:b.compression,compressionOptions:b.compressionOptions}}var r=e("./stream/StreamHelper"),s=e("./stream/DataWorker"),l=e("./utf8"),c=e("./compressedObject"),u=e("./stream/GenericWorker");o.prototype={internalStream:function(p){var g=null,b="string";try{if(!p)throw new Error("No output type specified.");var y=(b=p.toLowerCase())==="string"||b==="text";b!=="binarystring"&&b!=="text"||(b="string"),g=this._decompressWorker();var v=!this._dataBinary;v&&!y&&(g=g.pipe(new l.Utf8EncodeWorker)),!v&&y&&(g=g.pipe(new l.Utf8DecodeWorker))}catch(S){(g=new u("error")).error(S)}return new r(g,b,"")},async:function(p,g){return this.internalStream(p).accumulate(g)},nodeStream:function(p,g){return this.internalStream(p||"nodebuffer").toNodejsStream(g)},_compressWorker:function(p,g){if(this._data instanceof c&&this._data.compression.magic===p.magic)return this._data.getCompressedWorker();var b=this._decompressWorker();return this._dataBinary||(b=b.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(b,p,g)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof u?this._data:new s(this._data)}};for(var d=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],m=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<d.length;h++)o.prototype[d[h]]=m;n.exports=o},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,n,a){(function(o){var r,s,l=o.MutationObserver||o.WebKitMutationObserver;if(l){var c=0,u=new l(p),d=o.document.createTextNode("");u.observe(d,{characterData:!0}),r=function(){d.data=c=++c%2}}else if(o.setImmediate||o.MessageChannel===void 0)r="document"in o&&"onreadystatechange"in o.document.createElement("script")?function(){var g=o.document.createElement("script");g.onreadystatechange=function(){p(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},o.document.documentElement.appendChild(g)}:function(){setTimeout(p,0)};else{var m=new o.MessageChannel;m.port1.onmessage=p,r=function(){m.port2.postMessage(0)}}var h=[];function p(){var g,b;s=!0;for(var y=h.length;y;){for(b=h,h=[],g=-1;++g<y;)b[g]();y=h.length}s=!1}n.exports=function(g){h.push(g)!==1||s||r()}}).call(this,typeof Rn<"u"?Rn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,n,a){var o=e("immediate");function r(){}var s={},l=["REJECTED"],c=["FULFILLED"],u=["PENDING"];function d(y){if(typeof y!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,y!==r&&g(this,y)}function m(y,v,S){this.promise=y,typeof v=="function"&&(this.onFulfilled=v,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function h(y,v,S){o(function(){var L;try{L=v(S)}catch(C){return s.reject(y,C)}L===y?s.reject(y,new TypeError("Cannot resolve promise with itself")):s.resolve(y,L)})}function p(y){var v=y&&y.then;if(y&&(typeof y=="object"||typeof y=="function")&&typeof v=="function")return function(){v.apply(y,arguments)}}function g(y,v){var S=!1;function L(M){S||(S=!0,s.reject(y,M))}function C(M){S||(S=!0,s.resolve(y,M))}var F=b(function(){v(C,L)});F.status==="error"&&L(F.value)}function b(y,v){var S={};try{S.value=y(v),S.status="success"}catch(L){S.status="error",S.value=L}return S}(n.exports=d).prototype.finally=function(y){if(typeof y!="function")return this;var v=this.constructor;return this.then(function(S){return v.resolve(y()).then(function(){return S})},function(S){return v.resolve(y()).then(function(){throw S})})},d.prototype.catch=function(y){return this.then(null,y)},d.prototype.then=function(y,v){if(typeof y!="function"&&this.state===c||typeof v!="function"&&this.state===l)return this;var S=new this.constructor(r);return this.state!==u?h(S,this.state===c?y:v,this.outcome):this.queue.push(new m(S,y,v)),S},m.prototype.callFulfilled=function(y){s.resolve(this.promise,y)},m.prototype.otherCallFulfilled=function(y){h(this.promise,this.onFulfilled,y)},m.prototype.callRejected=function(y){s.reject(this.promise,y)},m.prototype.otherCallRejected=function(y){h(this.promise,this.onRejected,y)},s.resolve=function(y,v){var S=b(p,v);if(S.status==="error")return s.reject(y,S.value);var L=S.value;if(L)g(y,L);else{y.state=c,y.outcome=v;for(var C=-1,F=y.queue.length;++C<F;)y.queue[C].callFulfilled(v)}return y},s.reject=function(y,v){y.state=l,y.outcome=v;for(var S=-1,L=y.queue.length;++S<L;)y.queue[S].callRejected(v);return y},d.resolve=function(y){return y instanceof this?y:s.resolve(new this(r),y)},d.reject=function(y){var v=new this(r);return s.reject(v,y)},d.all=function(y){var v=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=y.length,L=!1;if(!S)return this.resolve([]);for(var C=new Array(S),F=0,M=-1,j=new this(r);++M<S;)B(y[M],M);return j;function B(G,tt){v.resolve(G).then(function(w){C[tt]=w,++F!==S||L||(L=!0,s.resolve(j,C))},function(w){L||(L=!0,s.reject(j,w))})}},d.race=function(y){var v=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=y.length,L=!1;if(!S)return this.resolve([]);for(var C=-1,F=new this(r);++C<S;)M=y[C],v.resolve(M).then(function(j){L||(L=!0,s.resolve(F,j))},function(j){L||(L=!0,s.reject(F,j))});var M;return F}},{immediate:36}],38:[function(e,n,a){var o={};(0,e("./lib/utils/common").assign)(o,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),n.exports=o},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,n,a){var o=e("./zlib/deflate"),r=e("./utils/common"),s=e("./utils/strings"),l=e("./zlib/messages"),c=e("./zlib/zstream"),u=Object.prototype.toString,d=0,m=-1,h=0,p=8;function g(y){if(!(this instanceof g))return new g(y);this.options=r.assign({level:m,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},y||{});var v=this.options;v.raw&&0<v.windowBits?v.windowBits=-v.windowBits:v.gzip&&0<v.windowBits&&v.windowBits<16&&(v.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var S=o.deflateInit2(this.strm,v.level,v.method,v.windowBits,v.memLevel,v.strategy);if(S!==d)throw new Error(l[S]);if(v.header&&o.deflateSetHeader(this.strm,v.header),v.dictionary){var L;if(L=typeof v.dictionary=="string"?s.string2buf(v.dictionary):u.call(v.dictionary)==="[object ArrayBuffer]"?new Uint8Array(v.dictionary):v.dictionary,(S=o.deflateSetDictionary(this.strm,L))!==d)throw new Error(l[S]);this._dict_set=!0}}function b(y,v){var S=new g(v);if(S.push(y,!0),S.err)throw S.msg||l[S.err];return S.result}g.prototype.push=function(y,v){var S,L,C=this.strm,F=this.options.chunkSize;if(this.ended)return!1;L=v===~~v?v:v===!0?4:0,typeof y=="string"?C.input=s.string2buf(y):u.call(y)==="[object ArrayBuffer]"?C.input=new Uint8Array(y):C.input=y,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new r.Buf8(F),C.next_out=0,C.avail_out=F),(S=o.deflate(C,L))!==1&&S!==d)return this.onEnd(S),!(this.ended=!0);C.avail_out!==0&&(C.avail_in!==0||L!==4&&L!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(r.shrinkBuf(C.output,C.next_out))):this.onData(r.shrinkBuf(C.output,C.next_out)))}while((0<C.avail_in||C.avail_out===0)&&S!==1);return L===4?(S=o.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===d):L!==2||(this.onEnd(d),!(C.avail_out=0))},g.prototype.onData=function(y){this.chunks.push(y)},g.prototype.onEnd=function(y){y===d&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg},a.Deflate=g,a.deflate=b,a.deflateRaw=function(y,v){return(v=v||{}).raw=!0,b(y,v)},a.gzip=function(y,v){return(v=v||{}).gzip=!0,b(y,v)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,n,a){var o=e("./zlib/inflate"),r=e("./utils/common"),s=e("./utils/strings"),l=e("./zlib/constants"),c=e("./zlib/messages"),u=e("./zlib/zstream"),d=e("./zlib/gzheader"),m=Object.prototype.toString;function h(g){if(!(this instanceof h))return new h(g);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},g||{});var b=this.options;b.raw&&0<=b.windowBits&&b.windowBits<16&&(b.windowBits=-b.windowBits,b.windowBits===0&&(b.windowBits=-15)),!(0<=b.windowBits&&b.windowBits<16)||g&&g.windowBits||(b.windowBits+=32),15<b.windowBits&&b.windowBits<48&&(15&b.windowBits)==0&&(b.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var y=o.inflateInit2(this.strm,b.windowBits);if(y!==l.Z_OK)throw new Error(c[y]);this.header=new d,o.inflateGetHeader(this.strm,this.header)}function p(g,b){var y=new h(b);if(y.push(g,!0),y.err)throw y.msg||c[y.err];return y.result}h.prototype.push=function(g,b){var y,v,S,L,C,F,M=this.strm,j=this.options.chunkSize,B=this.options.dictionary,G=!1;if(this.ended)return!1;v=b===~~b?b:b===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof g=="string"?M.input=s.binstring2buf(g):m.call(g)==="[object ArrayBuffer]"?M.input=new Uint8Array(g):M.input=g,M.next_in=0,M.avail_in=M.input.length;do{if(M.avail_out===0&&(M.output=new r.Buf8(j),M.next_out=0,M.avail_out=j),(y=o.inflate(M,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&B&&(F=typeof B=="string"?s.string2buf(B):m.call(B)==="[object ArrayBuffer]"?new Uint8Array(B):B,y=o.inflateSetDictionary(this.strm,F)),y===l.Z_BUF_ERROR&&G===!0&&(y=l.Z_OK,G=!1),y!==l.Z_STREAM_END&&y!==l.Z_OK)return this.onEnd(y),!(this.ended=!0);M.next_out&&(M.avail_out!==0&&y!==l.Z_STREAM_END&&(M.avail_in!==0||v!==l.Z_FINISH&&v!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=s.utf8border(M.output,M.next_out),L=M.next_out-S,C=s.buf2string(M.output,S),M.next_out=L,M.avail_out=j-L,L&&r.arraySet(M.output,M.output,S,L,0),this.onData(C)):this.onData(r.shrinkBuf(M.output,M.next_out)))),M.avail_in===0&&M.avail_out===0&&(G=!0)}while((0<M.avail_in||M.avail_out===0)&&y!==l.Z_STREAM_END);return y===l.Z_STREAM_END&&(v=l.Z_FINISH),v===l.Z_FINISH?(y=o.inflateEnd(this.strm),this.onEnd(y),this.ended=!0,y===l.Z_OK):v!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(M.avail_out=0))},h.prototype.onData=function(g){this.chunks.push(g)},h.prototype.onEnd=function(g){g===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},a.Inflate=h,a.inflate=p,a.inflateRaw=function(g,b){return(b=b||{}).raw=!0,p(g,b)},a.ungzip=p},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,n,a){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";a.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var u=c.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var d in u)u.hasOwnProperty(d)&&(l[d]=u[d])}}return l},a.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var r={arraySet:function(l,c,u,d,m){if(c.subarray&&l.subarray)l.set(c.subarray(u,u+d),m);else for(var h=0;h<d;h++)l[m+h]=c[u+h]},flattenChunks:function(l){var c,u,d,m,h,p;for(c=d=0,u=l.length;c<u;c++)d+=l[c].length;for(p=new Uint8Array(d),c=m=0,u=l.length;c<u;c++)h=l[c],p.set(h,m),m+=h.length;return p}},s={arraySet:function(l,c,u,d,m){for(var h=0;h<d;h++)l[m+h]=c[u+h]},flattenChunks:function(l){return[].concat.apply([],l)}};a.setTyped=function(l){l?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,r)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,s))},a.setTyped(o)},{}],42:[function(e,n,a){var o=e("./common"),r=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var l=new o.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function u(d,m){if(m<65537&&(d.subarray&&s||!d.subarray&&r))return String.fromCharCode.apply(null,o.shrinkBuf(d,m));for(var h="",p=0;p<m;p++)h+=String.fromCharCode(d[p]);return h}l[254]=l[254]=1,a.string2buf=function(d){var m,h,p,g,b,y=d.length,v=0;for(g=0;g<y;g++)(64512&(h=d.charCodeAt(g)))==55296&&g+1<y&&(64512&(p=d.charCodeAt(g+1)))==56320&&(h=65536+(h-55296<<10)+(p-56320),g++),v+=h<128?1:h<2048?2:h<65536?3:4;for(m=new o.Buf8(v),g=b=0;b<v;g++)(64512&(h=d.charCodeAt(g)))==55296&&g+1<y&&(64512&(p=d.charCodeAt(g+1)))==56320&&(h=65536+(h-55296<<10)+(p-56320),g++),h<128?m[b++]=h:(h<2048?m[b++]=192|h>>>6:(h<65536?m[b++]=224|h>>>12:(m[b++]=240|h>>>18,m[b++]=128|h>>>12&63),m[b++]=128|h>>>6&63),m[b++]=128|63&h);return m},a.buf2binstring=function(d){return u(d,d.length)},a.binstring2buf=function(d){for(var m=new o.Buf8(d.length),h=0,p=m.length;h<p;h++)m[h]=d.charCodeAt(h);return m},a.buf2string=function(d,m){var h,p,g,b,y=m||d.length,v=new Array(2*y);for(h=p=0;h<y;)if((g=d[h++])<128)v[p++]=g;else if(4<(b=l[g]))v[p++]=65533,h+=b-1;else{for(g&=b===2?31:b===3?15:7;1<b&&h<y;)g=g<<6|63&d[h++],b--;1<b?v[p++]=65533:g<65536?v[p++]=g:(g-=65536,v[p++]=55296|g>>10&1023,v[p++]=56320|1023&g)}return u(v,p)},a.utf8border=function(d,m){var h;for((m=m||d.length)>d.length&&(m=d.length),h=m-1;0<=h&&(192&d[h])==128;)h--;return h<0||h===0?m:h+l[d[h]]>m?h:m}},{"./common":41}],43:[function(e,n,a){n.exports=function(o,r,s,l){for(var c=65535&o|0,u=o>>>16&65535|0,d=0;s!==0;){for(s-=d=2e3<s?2e3:s;u=u+(c=c+r[l++]|0)|0,--d;);c%=65521,u%=65521}return c|u<<16|0}},{}],44:[function(e,n,a){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,n,a){var o=function(){for(var r,s=[],l=0;l<256;l++){r=l;for(var c=0;c<8;c++)r=1&r?3988292384^r>>>1:r>>>1;s[l]=r}return s}();n.exports=function(r,s,l,c){var u=o,d=c+l;r^=-1;for(var m=c;m<d;m++)r=r>>>8^u[255&(r^s[m])];return-1^r}},{}],46:[function(e,n,a){var o,r=e("../utils/common"),s=e("./trees"),l=e("./adler32"),c=e("./crc32"),u=e("./messages"),d=0,m=4,h=0,p=-2,g=-1,b=4,y=2,v=8,S=9,L=286,C=30,F=19,M=2*L+1,j=15,B=3,G=258,tt=G+B+1,w=42,$=113,_=1,H=2,Z=3,Y=4;function ct(f,P){return f.msg=u[P],P}function W(f){return(f<<1)-(4<f?9:0)}function st(f){for(var P=f.length;0<=--P;)f[P]=0}function N(f){var P=f.state,I=P.pending;I>f.avail_out&&(I=f.avail_out),I!==0&&(r.arraySet(f.output,P.pending_buf,P.pending_out,I,f.next_out),f.next_out+=I,P.pending_out+=I,f.total_out+=I,f.avail_out-=I,P.pending-=I,P.pending===0&&(P.pending_out=0))}function x(f,P){s._tr_flush_block(f,0<=f.block_start?f.block_start:-1,f.strstart-f.block_start,P),f.block_start=f.strstart,N(f.strm)}function at(f,P){f.pending_buf[f.pending++]=P}function K(f,P){f.pending_buf[f.pending++]=P>>>8&255,f.pending_buf[f.pending++]=255&P}function q(f,P){var I,D,E=f.max_chain_length,T=f.strstart,X=f.prev_length,U=f.nice_match,k=f.strstart>f.w_size-tt?f.strstart-(f.w_size-tt):0,V=f.window,Q=f.w_mask,J=f.prev,nt=f.strstart+G,St=V[T+X-1],dt=V[T+X];f.prev_length>=f.good_match&&(E>>=2),U>f.lookahead&&(U=f.lookahead);do if(V[(I=P)+X]===dt&&V[I+X-1]===St&&V[I]===V[T]&&V[++I]===V[T+1]){T+=2,I++;do;while(V[++T]===V[++I]&&V[++T]===V[++I]&&V[++T]===V[++I]&&V[++T]===V[++I]&&V[++T]===V[++I]&&V[++T]===V[++I]&&V[++T]===V[++I]&&V[++T]===V[++I]&&T<nt);if(D=G-(nt-T),T=nt-G,X<D){if(f.match_start=P,U<=(X=D))break;St=V[T+X-1],dt=V[T+X]}}while((P=J[P&Q])>k&&--E!=0);return X<=f.lookahead?X:f.lookahead}function xt(f){var P,I,D,E,T,X,U,k,V,Q,J=f.w_size;do{if(E=f.window_size-f.lookahead-f.strstart,f.strstart>=J+(J-tt)){for(r.arraySet(f.window,f.window,J,J,0),f.match_start-=J,f.strstart-=J,f.block_start-=J,P=I=f.hash_size;D=f.head[--P],f.head[P]=J<=D?D-J:0,--I;);for(P=I=J;D=f.prev[--P],f.prev[P]=J<=D?D-J:0,--I;);E+=J}if(f.strm.avail_in===0)break;if(X=f.strm,U=f.window,k=f.strstart+f.lookahead,V=E,Q=void 0,Q=X.avail_in,V<Q&&(Q=V),I=Q===0?0:(X.avail_in-=Q,r.arraySet(U,X.input,X.next_in,Q,k),X.state.wrap===1?X.adler=l(X.adler,U,Q,k):X.state.wrap===2&&(X.adler=c(X.adler,U,Q,k)),X.next_in+=Q,X.total_in+=Q,Q),f.lookahead+=I,f.lookahead+f.insert>=B)for(T=f.strstart-f.insert,f.ins_h=f.window[T],f.ins_h=(f.ins_h<<f.hash_shift^f.window[T+1])&f.hash_mask;f.insert&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[T+B-1])&f.hash_mask,f.prev[T&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=T,T++,f.insert--,!(f.lookahead+f.insert<B)););}while(f.lookahead<tt&&f.strm.avail_in!==0)}function Pt(f,P){for(var I,D;;){if(f.lookahead<tt){if(xt(f),f.lookahead<tt&&P===d)return _;if(f.lookahead===0)break}if(I=0,f.lookahead>=B&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+B-1])&f.hash_mask,I=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart),I!==0&&f.strstart-I<=f.w_size-tt&&(f.match_length=q(f,I)),f.match_length>=B)if(D=s._tr_tally(f,f.strstart-f.match_start,f.match_length-B),f.lookahead-=f.match_length,f.match_length<=f.max_lazy_match&&f.lookahead>=B){for(f.match_length--;f.strstart++,f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+B-1])&f.hash_mask,I=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart,--f.match_length!=0;);f.strstart++}else f.strstart+=f.match_length,f.match_length=0,f.ins_h=f.window[f.strstart],f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+1])&f.hash_mask;else D=s._tr_tally(f,0,f.window[f.strstart]),f.lookahead--,f.strstart++;if(D&&(x(f,!1),f.strm.avail_out===0))return _}return f.insert=f.strstart<B-1?f.strstart:B-1,P===m?(x(f,!0),f.strm.avail_out===0?Z:Y):f.last_lit&&(x(f,!1),f.strm.avail_out===0)?_:H}function ht(f,P){for(var I,D,E;;){if(f.lookahead<tt){if(xt(f),f.lookahead<tt&&P===d)return _;if(f.lookahead===0)break}if(I=0,f.lookahead>=B&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+B-1])&f.hash_mask,I=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart),f.prev_length=f.match_length,f.prev_match=f.match_start,f.match_length=B-1,I!==0&&f.prev_length<f.max_lazy_match&&f.strstart-I<=f.w_size-tt&&(f.match_length=q(f,I),f.match_length<=5&&(f.strategy===1||f.match_length===B&&4096<f.strstart-f.match_start)&&(f.match_length=B-1)),f.prev_length>=B&&f.match_length<=f.prev_length){for(E=f.strstart+f.lookahead-B,D=s._tr_tally(f,f.strstart-1-f.prev_match,f.prev_length-B),f.lookahead-=f.prev_length-1,f.prev_length-=2;++f.strstart<=E&&(f.ins_h=(f.ins_h<<f.hash_shift^f.window[f.strstart+B-1])&f.hash_mask,I=f.prev[f.strstart&f.w_mask]=f.head[f.ins_h],f.head[f.ins_h]=f.strstart),--f.prev_length!=0;);if(f.match_available=0,f.match_length=B-1,f.strstart++,D&&(x(f,!1),f.strm.avail_out===0))return _}else if(f.match_available){if((D=s._tr_tally(f,0,f.window[f.strstart-1]))&&x(f,!1),f.strstart++,f.lookahead--,f.strm.avail_out===0)return _}else f.match_available=1,f.strstart++,f.lookahead--}return f.match_available&&(D=s._tr_tally(f,0,f.window[f.strstart-1]),f.match_available=0),f.insert=f.strstart<B-1?f.strstart:B-1,P===m?(x(f,!0),f.strm.avail_out===0?Z:Y):f.last_lit&&(x(f,!1),f.strm.avail_out===0)?_:H}function bt(f,P,I,D,E){this.good_length=f,this.max_lazy=P,this.nice_length=I,this.max_chain=D,this.func=E}function Ot(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=v,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(2*M),this.dyn_dtree=new r.Buf16(2*(2*C+1)),this.bl_tree=new r.Buf16(2*(2*F+1)),st(this.dyn_ltree),st(this.dyn_dtree),st(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(j+1),this.heap=new r.Buf16(2*L+1),st(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(2*L+1),st(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Nt(f){var P;return f&&f.state?(f.total_in=f.total_out=0,f.data_type=y,(P=f.state).pending=0,P.pending_out=0,P.wrap<0&&(P.wrap=-P.wrap),P.status=P.wrap?w:$,f.adler=P.wrap===2?0:1,P.last_flush=d,s._tr_init(P),h):ct(f,p)}function we(f){var P=Nt(f);return P===h&&function(I){I.window_size=2*I.w_size,st(I.head),I.max_lazy_match=o[I.level].max_lazy,I.good_match=o[I.level].good_length,I.nice_match=o[I.level].nice_length,I.max_chain_length=o[I.level].max_chain,I.strstart=0,I.block_start=0,I.lookahead=0,I.insert=0,I.match_length=I.prev_length=B-1,I.match_available=0,I.ins_h=0}(f.state),P}function ue(f,P,I,D,E,T){if(!f)return p;var X=1;if(P===g&&(P=6),D<0?(X=0,D=-D):15<D&&(X=2,D-=16),E<1||S<E||I!==v||D<8||15<D||P<0||9<P||T<0||b<T)return ct(f,p);D===8&&(D=9);var U=new Ot;return(f.state=U).strm=f,U.wrap=X,U.gzhead=null,U.w_bits=D,U.w_size=1<<U.w_bits,U.w_mask=U.w_size-1,U.hash_bits=E+7,U.hash_size=1<<U.hash_bits,U.hash_mask=U.hash_size-1,U.hash_shift=~~((U.hash_bits+B-1)/B),U.window=new r.Buf8(2*U.w_size),U.head=new r.Buf16(U.hash_size),U.prev=new r.Buf16(U.w_size),U.lit_bufsize=1<<E+6,U.pending_buf_size=4*U.lit_bufsize,U.pending_buf=new r.Buf8(U.pending_buf_size),U.d_buf=1*U.lit_bufsize,U.l_buf=3*U.lit_bufsize,U.level=P,U.strategy=T,U.method=I,we(f)}o=[new bt(0,0,0,0,function(f,P){var I=65535;for(I>f.pending_buf_size-5&&(I=f.pending_buf_size-5);;){if(f.lookahead<=1){if(xt(f),f.lookahead===0&&P===d)return _;if(f.lookahead===0)break}f.strstart+=f.lookahead,f.lookahead=0;var D=f.block_start+I;if((f.strstart===0||f.strstart>=D)&&(f.lookahead=f.strstart-D,f.strstart=D,x(f,!1),f.strm.avail_out===0)||f.strstart-f.block_start>=f.w_size-tt&&(x(f,!1),f.strm.avail_out===0))return _}return f.insert=0,P===m?(x(f,!0),f.strm.avail_out===0?Z:Y):(f.strstart>f.block_start&&(x(f,!1),f.strm.avail_out),_)}),new bt(4,4,8,4,Pt),new bt(4,5,16,8,Pt),new bt(4,6,32,32,Pt),new bt(4,4,16,16,ht),new bt(8,16,32,32,ht),new bt(8,16,128,128,ht),new bt(8,32,128,256,ht),new bt(32,128,258,1024,ht),new bt(32,258,258,4096,ht)],a.deflateInit=function(f,P){return ue(f,P,v,15,8,0)},a.deflateInit2=ue,a.deflateReset=we,a.deflateResetKeep=Nt,a.deflateSetHeader=function(f,P){return f&&f.state?f.state.wrap!==2?p:(f.state.gzhead=P,h):p},a.deflate=function(f,P){var I,D,E,T;if(!f||!f.state||5<P||P<0)return f?ct(f,p):p;if(D=f.state,!f.output||!f.input&&f.avail_in!==0||D.status===666&&P!==m)return ct(f,f.avail_out===0?-5:p);if(D.strm=f,I=D.last_flush,D.last_flush=P,D.status===w)if(D.wrap===2)f.adler=0,at(D,31),at(D,139),at(D,8),D.gzhead?(at(D,(D.gzhead.text?1:0)+(D.gzhead.hcrc?2:0)+(D.gzhead.extra?4:0)+(D.gzhead.name?8:0)+(D.gzhead.comment?16:0)),at(D,255&D.gzhead.time),at(D,D.gzhead.time>>8&255),at(D,D.gzhead.time>>16&255),at(D,D.gzhead.time>>24&255),at(D,D.level===9?2:2<=D.strategy||D.level<2?4:0),at(D,255&D.gzhead.os),D.gzhead.extra&&D.gzhead.extra.length&&(at(D,255&D.gzhead.extra.length),at(D,D.gzhead.extra.length>>8&255)),D.gzhead.hcrc&&(f.adler=c(f.adler,D.pending_buf,D.pending,0)),D.gzindex=0,D.status=69):(at(D,0),at(D,0),at(D,0),at(D,0),at(D,0),at(D,D.level===9?2:2<=D.strategy||D.level<2?4:0),at(D,3),D.status=$);else{var X=v+(D.w_bits-8<<4)<<8;X|=(2<=D.strategy||D.level<2?0:D.level<6?1:D.level===6?2:3)<<6,D.strstart!==0&&(X|=32),X+=31-X%31,D.status=$,K(D,X),D.strstart!==0&&(K(D,f.adler>>>16),K(D,65535&f.adler)),f.adler=1}if(D.status===69)if(D.gzhead.extra){for(E=D.pending;D.gzindex<(65535&D.gzhead.extra.length)&&(D.pending!==D.pending_buf_size||(D.gzhead.hcrc&&D.pending>E&&(f.adler=c(f.adler,D.pending_buf,D.pending-E,E)),N(f),E=D.pending,D.pending!==D.pending_buf_size));)at(D,255&D.gzhead.extra[D.gzindex]),D.gzindex++;D.gzhead.hcrc&&D.pending>E&&(f.adler=c(f.adler,D.pending_buf,D.pending-E,E)),D.gzindex===D.gzhead.extra.length&&(D.gzindex=0,D.status=73)}else D.status=73;if(D.status===73)if(D.gzhead.name){E=D.pending;do{if(D.pending===D.pending_buf_size&&(D.gzhead.hcrc&&D.pending>E&&(f.adler=c(f.adler,D.pending_buf,D.pending-E,E)),N(f),E=D.pending,D.pending===D.pending_buf_size)){T=1;break}T=D.gzindex<D.gzhead.name.length?255&D.gzhead.name.charCodeAt(D.gzindex++):0,at(D,T)}while(T!==0);D.gzhead.hcrc&&D.pending>E&&(f.adler=c(f.adler,D.pending_buf,D.pending-E,E)),T===0&&(D.gzindex=0,D.status=91)}else D.status=91;if(D.status===91)if(D.gzhead.comment){E=D.pending;do{if(D.pending===D.pending_buf_size&&(D.gzhead.hcrc&&D.pending>E&&(f.adler=c(f.adler,D.pending_buf,D.pending-E,E)),N(f),E=D.pending,D.pending===D.pending_buf_size)){T=1;break}T=D.gzindex<D.gzhead.comment.length?255&D.gzhead.comment.charCodeAt(D.gzindex++):0,at(D,T)}while(T!==0);D.gzhead.hcrc&&D.pending>E&&(f.adler=c(f.adler,D.pending_buf,D.pending-E,E)),T===0&&(D.status=103)}else D.status=103;if(D.status===103&&(D.gzhead.hcrc?(D.pending+2>D.pending_buf_size&&N(f),D.pending+2<=D.pending_buf_size&&(at(D,255&f.adler),at(D,f.adler>>8&255),f.adler=0,D.status=$)):D.status=$),D.pending!==0){if(N(f),f.avail_out===0)return D.last_flush=-1,h}else if(f.avail_in===0&&W(P)<=W(I)&&P!==m)return ct(f,-5);if(D.status===666&&f.avail_in!==0)return ct(f,-5);if(f.avail_in!==0||D.lookahead!==0||P!==d&&D.status!==666){var U=D.strategy===2?function(k,V){for(var Q;;){if(k.lookahead===0&&(xt(k),k.lookahead===0)){if(V===d)return _;break}if(k.match_length=0,Q=s._tr_tally(k,0,k.window[k.strstart]),k.lookahead--,k.strstart++,Q&&(x(k,!1),k.strm.avail_out===0))return _}return k.insert=0,V===m?(x(k,!0),k.strm.avail_out===0?Z:Y):k.last_lit&&(x(k,!1),k.strm.avail_out===0)?_:H}(D,P):D.strategy===3?function(k,V){for(var Q,J,nt,St,dt=k.window;;){if(k.lookahead<=G){if(xt(k),k.lookahead<=G&&V===d)return _;if(k.lookahead===0)break}if(k.match_length=0,k.lookahead>=B&&0<k.strstart&&(J=dt[nt=k.strstart-1])===dt[++nt]&&J===dt[++nt]&&J===dt[++nt]){St=k.strstart+G;do;while(J===dt[++nt]&&J===dt[++nt]&&J===dt[++nt]&&J===dt[++nt]&&J===dt[++nt]&&J===dt[++nt]&&J===dt[++nt]&&J===dt[++nt]&&nt<St);k.match_length=G-(St-nt),k.match_length>k.lookahead&&(k.match_length=k.lookahead)}if(k.match_length>=B?(Q=s._tr_tally(k,1,k.match_length-B),k.lookahead-=k.match_length,k.strstart+=k.match_length,k.match_length=0):(Q=s._tr_tally(k,0,k.window[k.strstart]),k.lookahead--,k.strstart++),Q&&(x(k,!1),k.strm.avail_out===0))return _}return k.insert=0,V===m?(x(k,!0),k.strm.avail_out===0?Z:Y):k.last_lit&&(x(k,!1),k.strm.avail_out===0)?_:H}(D,P):o[D.level].func(D,P);if(U!==Z&&U!==Y||(D.status=666),U===_||U===Z)return f.avail_out===0&&(D.last_flush=-1),h;if(U===H&&(P===1?s._tr_align(D):P!==5&&(s._tr_stored_block(D,0,0,!1),P===3&&(st(D.head),D.lookahead===0&&(D.strstart=0,D.block_start=0,D.insert=0))),N(f),f.avail_out===0))return D.last_flush=-1,h}return P!==m?h:D.wrap<=0?1:(D.wrap===2?(at(D,255&f.adler),at(D,f.adler>>8&255),at(D,f.adler>>16&255),at(D,f.adler>>24&255),at(D,255&f.total_in),at(D,f.total_in>>8&255),at(D,f.total_in>>16&255),at(D,f.total_in>>24&255)):(K(D,f.adler>>>16),K(D,65535&f.adler)),N(f),0<D.wrap&&(D.wrap=-D.wrap),D.pending!==0?h:1)},a.deflateEnd=function(f){var P;return f&&f.state?(P=f.state.status)!==w&&P!==69&&P!==73&&P!==91&&P!==103&&P!==$&&P!==666?ct(f,p):(f.state=null,P===$?ct(f,-3):h):p},a.deflateSetDictionary=function(f,P){var I,D,E,T,X,U,k,V,Q=P.length;if(!f||!f.state||(T=(I=f.state).wrap)===2||T===1&&I.status!==w||I.lookahead)return p;for(T===1&&(f.adler=l(f.adler,P,Q,0)),I.wrap=0,Q>=I.w_size&&(T===0&&(st(I.head),I.strstart=0,I.block_start=0,I.insert=0),V=new r.Buf8(I.w_size),r.arraySet(V,P,Q-I.w_size,I.w_size,0),P=V,Q=I.w_size),X=f.avail_in,U=f.next_in,k=f.input,f.avail_in=Q,f.next_in=0,f.input=P,xt(I);I.lookahead>=B;){for(D=I.strstart,E=I.lookahead-(B-1);I.ins_h=(I.ins_h<<I.hash_shift^I.window[D+B-1])&I.hash_mask,I.prev[D&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=D,D++,--E;);I.strstart=D,I.lookahead=B-1,xt(I)}return I.strstart+=I.lookahead,I.block_start=I.strstart,I.insert=I.lookahead,I.lookahead=0,I.match_length=I.prev_length=B-1,I.match_available=0,f.next_in=U,f.input=k,f.avail_in=X,I.wrap=T,h},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,n,a){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,n,a){n.exports=function(o,r){var s,l,c,u,d,m,h,p,g,b,y,v,S,L,C,F,M,j,B,G,tt,w,$,_,H;s=o.state,l=o.next_in,_=o.input,c=l+(o.avail_in-5),u=o.next_out,H=o.output,d=u-(r-o.avail_out),m=u+(o.avail_out-257),h=s.dmax,p=s.wsize,g=s.whave,b=s.wnext,y=s.window,v=s.hold,S=s.bits,L=s.lencode,C=s.distcode,F=(1<<s.lenbits)-1,M=(1<<s.distbits)-1;t:do{S<15&&(v+=_[l++]<<S,S+=8,v+=_[l++]<<S,S+=8),j=L[v&F];e:for(;;){if(v>>>=B=j>>>24,S-=B,(B=j>>>16&255)===0)H[u++]=65535&j;else{if(!(16&B)){if((64&B)==0){j=L[(65535&j)+(v&(1<<B)-1)];continue e}if(32&B){s.mode=12;break t}o.msg="invalid literal/length code",s.mode=30;break t}G=65535&j,(B&=15)&&(S<B&&(v+=_[l++]<<S,S+=8),G+=v&(1<<B)-1,v>>>=B,S-=B),S<15&&(v+=_[l++]<<S,S+=8,v+=_[l++]<<S,S+=8),j=C[v&M];i:for(;;){if(v>>>=B=j>>>24,S-=B,!(16&(B=j>>>16&255))){if((64&B)==0){j=C[(65535&j)+(v&(1<<B)-1)];continue i}o.msg="invalid distance code",s.mode=30;break t}if(tt=65535&j,S<(B&=15)&&(v+=_[l++]<<S,(S+=8)<B&&(v+=_[l++]<<S,S+=8)),h<(tt+=v&(1<<B)-1)){o.msg="invalid distance too far back",s.mode=30;break t}if(v>>>=B,S-=B,(B=u-d)<tt){if(g<(B=tt-B)&&s.sane){o.msg="invalid distance too far back",s.mode=30;break t}if($=y,(w=0)===b){if(w+=p-B,B<G){for(G-=B;H[u++]=y[w++],--B;);w=u-tt,$=H}}else if(b<B){if(w+=p+b-B,(B-=b)<G){for(G-=B;H[u++]=y[w++],--B;);if(w=0,b<G){for(G-=B=b;H[u++]=y[w++],--B;);w=u-tt,$=H}}}else if(w+=b-B,B<G){for(G-=B;H[u++]=y[w++],--B;);w=u-tt,$=H}for(;2<G;)H[u++]=$[w++],H[u++]=$[w++],H[u++]=$[w++],G-=3;G&&(H[u++]=$[w++],1<G&&(H[u++]=$[w++]))}else{for(w=u-tt;H[u++]=H[w++],H[u++]=H[w++],H[u++]=H[w++],2<(G-=3););G&&(H[u++]=H[w++],1<G&&(H[u++]=H[w++]))}break}}break}}while(l<c&&u<m);l-=G=S>>3,v&=(1<<(S-=G<<3))-1,o.next_in=l,o.next_out=u,o.avail_in=l<c?c-l+5:5-(l-c),o.avail_out=u<m?m-u+257:257-(u-m),s.hold=v,s.bits=S}},{}],49:[function(e,n,a){var o=e("../utils/common"),r=e("./adler32"),s=e("./crc32"),l=e("./inffast"),c=e("./inftrees"),u=1,d=2,m=0,h=-2,p=1,g=852,b=592;function y(w){return(w>>>24&255)+(w>>>8&65280)+((65280&w)<<8)+((255&w)<<24)}function v(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(w){var $;return w&&w.state?($=w.state,w.total_in=w.total_out=$.total=0,w.msg="",$.wrap&&(w.adler=1&$.wrap),$.mode=p,$.last=0,$.havedict=0,$.dmax=32768,$.head=null,$.hold=0,$.bits=0,$.lencode=$.lendyn=new o.Buf32(g),$.distcode=$.distdyn=new o.Buf32(b),$.sane=1,$.back=-1,m):h}function L(w){var $;return w&&w.state?(($=w.state).wsize=0,$.whave=0,$.wnext=0,S(w)):h}function C(w,$){var _,H;return w&&w.state?(H=w.state,$<0?(_=0,$=-$):(_=1+($>>4),$<48&&($&=15)),$&&($<8||15<$)?h:(H.window!==null&&H.wbits!==$&&(H.window=null),H.wrap=_,H.wbits=$,L(w))):h}function F(w,$){var _,H;return w?(H=new v,(w.state=H).window=null,(_=C(w,$))!==m&&(w.state=null),_):h}var M,j,B=!0;function G(w){if(B){var $;for(M=new o.Buf32(512),j=new o.Buf32(32),$=0;$<144;)w.lens[$++]=8;for(;$<256;)w.lens[$++]=9;for(;$<280;)w.lens[$++]=7;for(;$<288;)w.lens[$++]=8;for(c(u,w.lens,0,288,M,0,w.work,{bits:9}),$=0;$<32;)w.lens[$++]=5;c(d,w.lens,0,32,j,0,w.work,{bits:5}),B=!1}w.lencode=M,w.lenbits=9,w.distcode=j,w.distbits=5}function tt(w,$,_,H){var Z,Y=w.state;return Y.window===null&&(Y.wsize=1<<Y.wbits,Y.wnext=0,Y.whave=0,Y.window=new o.Buf8(Y.wsize)),H>=Y.wsize?(o.arraySet(Y.window,$,_-Y.wsize,Y.wsize,0),Y.wnext=0,Y.whave=Y.wsize):(H<(Z=Y.wsize-Y.wnext)&&(Z=H),o.arraySet(Y.window,$,_-H,Z,Y.wnext),(H-=Z)?(o.arraySet(Y.window,$,_-H,H,0),Y.wnext=H,Y.whave=Y.wsize):(Y.wnext+=Z,Y.wnext===Y.wsize&&(Y.wnext=0),Y.whave<Y.wsize&&(Y.whave+=Z))),0}a.inflateReset=L,a.inflateReset2=C,a.inflateResetKeep=S,a.inflateInit=function(w){return F(w,15)},a.inflateInit2=F,a.inflate=function(w,$){var _,H,Z,Y,ct,W,st,N,x,at,K,q,xt,Pt,ht,bt,Ot,Nt,we,ue,f,P,I,D,E=0,T=new o.Buf8(4),X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!w||!w.state||!w.output||!w.input&&w.avail_in!==0)return h;(_=w.state).mode===12&&(_.mode=13),ct=w.next_out,Z=w.output,st=w.avail_out,Y=w.next_in,H=w.input,W=w.avail_in,N=_.hold,x=_.bits,at=W,K=st,P=m;t:for(;;)switch(_.mode){case p:if(_.wrap===0){_.mode=13;break}for(;x<16;){if(W===0)break t;W--,N+=H[Y++]<<x,x+=8}if(2&_.wrap&&N===35615){T[_.check=0]=255&N,T[1]=N>>>8&255,_.check=s(_.check,T,2,0),x=N=0,_.mode=2;break}if(_.flags=0,_.head&&(_.head.done=!1),!(1&_.wrap)||(((255&N)<<8)+(N>>8))%31){w.msg="incorrect header check",_.mode=30;break}if((15&N)!=8){w.msg="unknown compression method",_.mode=30;break}if(x-=4,f=8+(15&(N>>>=4)),_.wbits===0)_.wbits=f;else if(f>_.wbits){w.msg="invalid window size",_.mode=30;break}_.dmax=1<<f,w.adler=_.check=1,_.mode=512&N?10:12,x=N=0;break;case 2:for(;x<16;){if(W===0)break t;W--,N+=H[Y++]<<x,x+=8}if(_.flags=N,(255&_.flags)!=8){w.msg="unknown compression method",_.mode=30;break}if(57344&_.flags){w.msg="unknown header flags set",_.mode=30;break}_.head&&(_.head.text=N>>8&1),512&_.flags&&(T[0]=255&N,T[1]=N>>>8&255,_.check=s(_.check,T,2,0)),x=N=0,_.mode=3;case 3:for(;x<32;){if(W===0)break t;W--,N+=H[Y++]<<x,x+=8}_.head&&(_.head.time=N),512&_.flags&&(T[0]=255&N,T[1]=N>>>8&255,T[2]=N>>>16&255,T[3]=N>>>24&255,_.check=s(_.check,T,4,0)),x=N=0,_.mode=4;case 4:for(;x<16;){if(W===0)break t;W--,N+=H[Y++]<<x,x+=8}_.head&&(_.head.xflags=255&N,_.head.os=N>>8),512&_.flags&&(T[0]=255&N,T[1]=N>>>8&255,_.check=s(_.check,T,2,0)),x=N=0,_.mode=5;case 5:if(1024&_.flags){for(;x<16;){if(W===0)break t;W--,N+=H[Y++]<<x,x+=8}_.length=N,_.head&&(_.head.extra_len=N),512&_.flags&&(T[0]=255&N,T[1]=N>>>8&255,_.check=s(_.check,T,2,0)),x=N=0}else _.head&&(_.head.extra=null);_.mode=6;case 6:if(1024&_.flags&&(W<(q=_.length)&&(q=W),q&&(_.head&&(f=_.head.extra_len-_.length,_.head.extra||(_.head.extra=new Array(_.head.extra_len)),o.arraySet(_.head.extra,H,Y,q,f)),512&_.flags&&(_.check=s(_.check,H,q,Y)),W-=q,Y+=q,_.length-=q),_.length))break t;_.length=0,_.mode=7;case 7:if(2048&_.flags){if(W===0)break t;for(q=0;f=H[Y+q++],_.head&&f&&_.length<65536&&(_.head.name+=String.fromCharCode(f)),f&&q<W;);if(512&_.flags&&(_.check=s(_.check,H,q,Y)),W-=q,Y+=q,f)break t}else _.head&&(_.head.name=null);_.length=0,_.mode=8;case 8:if(4096&_.flags){if(W===0)break t;for(q=0;f=H[Y+q++],_.head&&f&&_.length<65536&&(_.head.comment+=String.fromCharCode(f)),f&&q<W;);if(512&_.flags&&(_.check=s(_.check,H,q,Y)),W-=q,Y+=q,f)break t}else _.head&&(_.head.comment=null);_.mode=9;case 9:if(512&_.flags){for(;x<16;){if(W===0)break t;W--,N+=H[Y++]<<x,x+=8}if(N!==(65535&_.check)){w.msg="header crc mismatch",_.mode=30;break}x=N=0}_.head&&(_.head.hcrc=_.flags>>9&1,_.head.done=!0),w.adler=_.check=0,_.mode=12;break;case 10:for(;x<32;){if(W===0)break t;W--,N+=H[Y++]<<x,x+=8}w.adler=_.check=y(N),x=N=0,_.mode=11;case 11:if(_.havedict===0)return w.next_out=ct,w.avail_out=st,w.next_in=Y,w.avail_in=W,_.hold=N,_.bits=x,2;w.adler=_.check=1,_.mode=12;case 12:if($===5||$===6)break t;case 13:if(_.last){N>>>=7&x,x-=7&x,_.mode=27;break}for(;x<3;){if(W===0)break t;W--,N+=H[Y++]<<x,x+=8}switch(_.last=1&N,x-=1,3&(N>>>=1)){case 0:_.mode=14;break;case 1:if(G(_),_.mode=20,$!==6)break;N>>>=2,x-=2;break t;case 2:_.mode=17;break;case 3:w.msg="invalid block type",_.mode=30}N>>>=2,x-=2;break;case 14:for(N>>>=7&x,x-=7&x;x<32;){if(W===0)break t;W--,N+=H[Y++]<<x,x+=8}if((65535&N)!=(N>>>16^65535)){w.msg="invalid stored block lengths",_.mode=30;break}if(_.length=65535&N,x=N=0,_.mode=15,$===6)break t;case 15:_.mode=16;case 16:if(q=_.length){if(W<q&&(q=W),st<q&&(q=st),q===0)break t;o.arraySet(Z,H,Y,q,ct),W-=q,Y+=q,st-=q,ct+=q,_.length-=q;break}_.mode=12;break;case 17:for(;x<14;){if(W===0)break t;W--,N+=H[Y++]<<x,x+=8}if(_.nlen=257+(31&N),N>>>=5,x-=5,_.ndist=1+(31&N),N>>>=5,x-=5,_.ncode=4+(15&N),N>>>=4,x-=4,286<_.nlen||30<_.ndist){w.msg="too many length or distance symbols",_.mode=30;break}_.have=0,_.mode=18;case 18:for(;_.have<_.ncode;){for(;x<3;){if(W===0)break t;W--,N+=H[Y++]<<x,x+=8}_.lens[X[_.have++]]=7&N,N>>>=3,x-=3}for(;_.have<19;)_.lens[X[_.have++]]=0;if(_.lencode=_.lendyn,_.lenbits=7,I={bits:_.lenbits},P=c(0,_.lens,0,19,_.lencode,0,_.work,I),_.lenbits=I.bits,P){w.msg="invalid code lengths set",_.mode=30;break}_.have=0,_.mode=19;case 19:for(;_.have<_.nlen+_.ndist;){for(;bt=(E=_.lencode[N&(1<<_.lenbits)-1])>>>16&255,Ot=65535&E,!((ht=E>>>24)<=x);){if(W===0)break t;W--,N+=H[Y++]<<x,x+=8}if(Ot<16)N>>>=ht,x-=ht,_.lens[_.have++]=Ot;else{if(Ot===16){for(D=ht+2;x<D;){if(W===0)break t;W--,N+=H[Y++]<<x,x+=8}if(N>>>=ht,x-=ht,_.have===0){w.msg="invalid bit length repeat",_.mode=30;break}f=_.lens[_.have-1],q=3+(3&N),N>>>=2,x-=2}else if(Ot===17){for(D=ht+3;x<D;){if(W===0)break t;W--,N+=H[Y++]<<x,x+=8}x-=ht,f=0,q=3+(7&(N>>>=ht)),N>>>=3,x-=3}else{for(D=ht+7;x<D;){if(W===0)break t;W--,N+=H[Y++]<<x,x+=8}x-=ht,f=0,q=11+(127&(N>>>=ht)),N>>>=7,x-=7}if(_.have+q>_.nlen+_.ndist){w.msg="invalid bit length repeat",_.mode=30;break}for(;q--;)_.lens[_.have++]=f}}if(_.mode===30)break;if(_.lens[256]===0){w.msg="invalid code -- missing end-of-block",_.mode=30;break}if(_.lenbits=9,I={bits:_.lenbits},P=c(u,_.lens,0,_.nlen,_.lencode,0,_.work,I),_.lenbits=I.bits,P){w.msg="invalid literal/lengths set",_.mode=30;break}if(_.distbits=6,_.distcode=_.distdyn,I={bits:_.distbits},P=c(d,_.lens,_.nlen,_.ndist,_.distcode,0,_.work,I),_.distbits=I.bits,P){w.msg="invalid distances set",_.mode=30;break}if(_.mode=20,$===6)break t;case 20:_.mode=21;case 21:if(6<=W&&258<=st){w.next_out=ct,w.avail_out=st,w.next_in=Y,w.avail_in=W,_.hold=N,_.bits=x,l(w,K),ct=w.next_out,Z=w.output,st=w.avail_out,Y=w.next_in,H=w.input,W=w.avail_in,N=_.hold,x=_.bits,_.mode===12&&(_.back=-1);break}for(_.back=0;bt=(E=_.lencode[N&(1<<_.lenbits)-1])>>>16&255,Ot=65535&E,!((ht=E>>>24)<=x);){if(W===0)break t;W--,N+=H[Y++]<<x,x+=8}if(bt&&(240&bt)==0){for(Nt=ht,we=bt,ue=Ot;bt=(E=_.lencode[ue+((N&(1<<Nt+we)-1)>>Nt)])>>>16&255,Ot=65535&E,!(Nt+(ht=E>>>24)<=x);){if(W===0)break t;W--,N+=H[Y++]<<x,x+=8}N>>>=Nt,x-=Nt,_.back+=Nt}if(N>>>=ht,x-=ht,_.back+=ht,_.length=Ot,bt===0){_.mode=26;break}if(32&bt){_.back=-1,_.mode=12;break}if(64&bt){w.msg="invalid literal/length code",_.mode=30;break}_.extra=15&bt,_.mode=22;case 22:if(_.extra){for(D=_.extra;x<D;){if(W===0)break t;W--,N+=H[Y++]<<x,x+=8}_.length+=N&(1<<_.extra)-1,N>>>=_.extra,x-=_.extra,_.back+=_.extra}_.was=_.length,_.mode=23;case 23:for(;bt=(E=_.distcode[N&(1<<_.distbits)-1])>>>16&255,Ot=65535&E,!((ht=E>>>24)<=x);){if(W===0)break t;W--,N+=H[Y++]<<x,x+=8}if((240&bt)==0){for(Nt=ht,we=bt,ue=Ot;bt=(E=_.distcode[ue+((N&(1<<Nt+we)-1)>>Nt)])>>>16&255,Ot=65535&E,!(Nt+(ht=E>>>24)<=x);){if(W===0)break t;W--,N+=H[Y++]<<x,x+=8}N>>>=Nt,x-=Nt,_.back+=Nt}if(N>>>=ht,x-=ht,_.back+=ht,64&bt){w.msg="invalid distance code",_.mode=30;break}_.offset=Ot,_.extra=15&bt,_.mode=24;case 24:if(_.extra){for(D=_.extra;x<D;){if(W===0)break t;W--,N+=H[Y++]<<x,x+=8}_.offset+=N&(1<<_.extra)-1,N>>>=_.extra,x-=_.extra,_.back+=_.extra}if(_.offset>_.dmax){w.msg="invalid distance too far back",_.mode=30;break}_.mode=25;case 25:if(st===0)break t;if(q=K-st,_.offset>q){if((q=_.offset-q)>_.whave&&_.sane){w.msg="invalid distance too far back",_.mode=30;break}xt=q>_.wnext?(q-=_.wnext,_.wsize-q):_.wnext-q,q>_.length&&(q=_.length),Pt=_.window}else Pt=Z,xt=ct-_.offset,q=_.length;for(st<q&&(q=st),st-=q,_.length-=q;Z[ct++]=Pt[xt++],--q;);_.length===0&&(_.mode=21);break;case 26:if(st===0)break t;Z[ct++]=_.length,st--,_.mode=21;break;case 27:if(_.wrap){for(;x<32;){if(W===0)break t;W--,N|=H[Y++]<<x,x+=8}if(K-=st,w.total_out+=K,_.total+=K,K&&(w.adler=_.check=_.flags?s(_.check,Z,K,ct-K):r(_.check,Z,K,ct-K)),K=st,(_.flags?N:y(N))!==_.check){w.msg="incorrect data check",_.mode=30;break}x=N=0}_.mode=28;case 28:if(_.wrap&&_.flags){for(;x<32;){if(W===0)break t;W--,N+=H[Y++]<<x,x+=8}if(N!==(4294967295&_.total)){w.msg="incorrect length check",_.mode=30;break}x=N=0}_.mode=29;case 29:P=1;break t;case 30:P=-3;break t;case 31:return-4;case 32:default:return h}return w.next_out=ct,w.avail_out=st,w.next_in=Y,w.avail_in=W,_.hold=N,_.bits=x,(_.wsize||K!==w.avail_out&&_.mode<30&&(_.mode<27||$!==4))&&tt(w,w.output,w.next_out,K-w.avail_out)?(_.mode=31,-4):(at-=w.avail_in,K-=w.avail_out,w.total_in+=at,w.total_out+=K,_.total+=K,_.wrap&&K&&(w.adler=_.check=_.flags?s(_.check,Z,K,w.next_out-K):r(_.check,Z,K,w.next_out-K)),w.data_type=_.bits+(_.last?64:0)+(_.mode===12?128:0)+(_.mode===20||_.mode===15?256:0),(at==0&&K===0||$===4)&&P===m&&(P=-5),P)},a.inflateEnd=function(w){if(!w||!w.state)return h;var $=w.state;return $.window&&($.window=null),w.state=null,m},a.inflateGetHeader=function(w,$){var _;return w&&w.state?(2&(_=w.state).wrap)==0?h:((_.head=$).done=!1,m):h},a.inflateSetDictionary=function(w,$){var _,H=$.length;return w&&w.state?(_=w.state).wrap!==0&&_.mode!==11?h:_.mode===11&&r(1,$,H,0)!==_.check?-3:tt(w,$,H,H)?(_.mode=31,-4):(_.havedict=1,m):h},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,n,a){var o=e("../utils/common"),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(u,d,m,h,p,g,b,y){var v,S,L,C,F,M,j,B,G,tt=y.bits,w=0,$=0,_=0,H=0,Z=0,Y=0,ct=0,W=0,st=0,N=0,x=null,at=0,K=new o.Buf16(16),q=new o.Buf16(16),xt=null,Pt=0;for(w=0;w<=15;w++)K[w]=0;for($=0;$<h;$++)K[d[m+$]]++;for(Z=tt,H=15;1<=H&&K[H]===0;H--);if(H<Z&&(Z=H),H===0)return p[g++]=20971520,p[g++]=20971520,y.bits=1,0;for(_=1;_<H&&K[_]===0;_++);for(Z<_&&(Z=_),w=W=1;w<=15;w++)if(W<<=1,(W-=K[w])<0)return-1;if(0<W&&(u===0||H!==1))return-1;for(q[1]=0,w=1;w<15;w++)q[w+1]=q[w]+K[w];for($=0;$<h;$++)d[m+$]!==0&&(b[q[d[m+$]]++]=$);if(M=u===0?(x=xt=b,19):u===1?(x=r,at-=257,xt=s,Pt-=257,256):(x=l,xt=c,-1),w=_,F=g,ct=$=N=0,L=-1,C=(st=1<<(Y=Z))-1,u===1&&852<st||u===2&&592<st)return 1;for(;;){for(j=w-ct,G=b[$]<M?(B=0,b[$]):b[$]>M?(B=xt[Pt+b[$]],x[at+b[$]]):(B=96,0),v=1<<w-ct,_=S=1<<Y;p[F+(N>>ct)+(S-=v)]=j<<24|B<<16|G|0,S!==0;);for(v=1<<w-1;N&v;)v>>=1;if(v!==0?(N&=v-1,N+=v):N=0,$++,--K[w]==0){if(w===H)break;w=d[m+b[$]]}if(Z<w&&(N&C)!==L){for(ct===0&&(ct=Z),F+=_,W=1<<(Y=w-ct);Y+ct<H&&!((W-=K[Y+ct])<=0);)Y++,W<<=1;if(st+=1<<Y,u===1&&852<st||u===2&&592<st)return 1;p[L=N&C]=Z<<24|Y<<16|F-g|0}}return N!==0&&(p[F+N]=w-ct<<24|64<<16|0),y.bits=Z,0}},{"../utils/common":41}],51:[function(e,n,a){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,n,a){var o=e("../utils/common"),r=0,s=1;function l(E){for(var T=E.length;0<=--T;)E[T]=0}var c=0,u=29,d=256,m=d+1+u,h=30,p=19,g=2*m+1,b=15,y=16,v=7,S=256,L=16,C=17,F=18,M=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],j=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],B=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],tt=new Array(2*(m+2));l(tt);var w=new Array(2*h);l(w);var $=new Array(512);l($);var _=new Array(256);l(_);var H=new Array(u);l(H);var Z,Y,ct,W=new Array(h);function st(E,T,X,U,k){this.static_tree=E,this.extra_bits=T,this.extra_base=X,this.elems=U,this.max_length=k,this.has_stree=E&&E.length}function N(E,T){this.dyn_tree=E,this.max_code=0,this.stat_desc=T}function x(E){return E<256?$[E]:$[256+(E>>>7)]}function at(E,T){E.pending_buf[E.pending++]=255&T,E.pending_buf[E.pending++]=T>>>8&255}function K(E,T,X){E.bi_valid>y-X?(E.bi_buf|=T<<E.bi_valid&65535,at(E,E.bi_buf),E.bi_buf=T>>y-E.bi_valid,E.bi_valid+=X-y):(E.bi_buf|=T<<E.bi_valid&65535,E.bi_valid+=X)}function q(E,T,X){K(E,X[2*T],X[2*T+1])}function xt(E,T){for(var X=0;X|=1&E,E>>>=1,X<<=1,0<--T;);return X>>>1}function Pt(E,T,X){var U,k,V=new Array(b+1),Q=0;for(U=1;U<=b;U++)V[U]=Q=Q+X[U-1]<<1;for(k=0;k<=T;k++){var J=E[2*k+1];J!==0&&(E[2*k]=xt(V[J]++,J))}}function ht(E){var T;for(T=0;T<m;T++)E.dyn_ltree[2*T]=0;for(T=0;T<h;T++)E.dyn_dtree[2*T]=0;for(T=0;T<p;T++)E.bl_tree[2*T]=0;E.dyn_ltree[2*S]=1,E.opt_len=E.static_len=0,E.last_lit=E.matches=0}function bt(E){8<E.bi_valid?at(E,E.bi_buf):0<E.bi_valid&&(E.pending_buf[E.pending++]=E.bi_buf),E.bi_buf=0,E.bi_valid=0}function Ot(E,T,X,U){var k=2*T,V=2*X;return E[k]<E[V]||E[k]===E[V]&&U[T]<=U[X]}function Nt(E,T,X){for(var U=E.heap[X],k=X<<1;k<=E.heap_len&&(k<E.heap_len&&Ot(T,E.heap[k+1],E.heap[k],E.depth)&&k++,!Ot(T,U,E.heap[k],E.depth));)E.heap[X]=E.heap[k],X=k,k<<=1;E.heap[X]=U}function we(E,T,X){var U,k,V,Q,J=0;if(E.last_lit!==0)for(;U=E.pending_buf[E.d_buf+2*J]<<8|E.pending_buf[E.d_buf+2*J+1],k=E.pending_buf[E.l_buf+J],J++,U===0?q(E,k,T):(q(E,(V=_[k])+d+1,T),(Q=M[V])!==0&&K(E,k-=H[V],Q),q(E,V=x(--U),X),(Q=j[V])!==0&&K(E,U-=W[V],Q)),J<E.last_lit;);q(E,S,T)}function ue(E,T){var X,U,k,V=T.dyn_tree,Q=T.stat_desc.static_tree,J=T.stat_desc.has_stree,nt=T.stat_desc.elems,St=-1;for(E.heap_len=0,E.heap_max=g,X=0;X<nt;X++)V[2*X]!==0?(E.heap[++E.heap_len]=St=X,E.depth[X]=0):V[2*X+1]=0;for(;E.heap_len<2;)V[2*(k=E.heap[++E.heap_len]=St<2?++St:0)]=1,E.depth[k]=0,E.opt_len--,J&&(E.static_len-=Q[2*k+1]);for(T.max_code=St,X=E.heap_len>>1;1<=X;X--)Nt(E,V,X);for(k=nt;X=E.heap[1],E.heap[1]=E.heap[E.heap_len--],Nt(E,V,1),U=E.heap[1],E.heap[--E.heap_max]=X,E.heap[--E.heap_max]=U,V[2*k]=V[2*X]+V[2*U],E.depth[k]=(E.depth[X]>=E.depth[U]?E.depth[X]:E.depth[U])+1,V[2*X+1]=V[2*U+1]=k,E.heap[1]=k++,Nt(E,V,1),2<=E.heap_len;);E.heap[--E.heap_max]=E.heap[1],function(dt,Qt){var tn,Se,en,It,En,Ea,Be=Qt.dyn_tree,Fr=Qt.max_code,eu=Qt.stat_desc.static_tree,iu=Qt.stat_desc.has_stree,nu=Qt.stat_desc.extra_bits,Hr=Qt.stat_desc.extra_base,nn=Qt.stat_desc.max_length,Dn=0;for(It=0;It<=b;It++)dt.bl_count[It]=0;for(Be[2*dt.heap[dt.heap_max]+1]=0,tn=dt.heap_max+1;tn<g;tn++)nn<(It=Be[2*Be[2*(Se=dt.heap[tn])+1]+1]+1)&&(It=nn,Dn++),Be[2*Se+1]=It,Fr<Se||(dt.bl_count[It]++,En=0,Hr<=Se&&(En=nu[Se-Hr]),Ea=Be[2*Se],dt.opt_len+=Ea*(It+En),iu&&(dt.static_len+=Ea*(eu[2*Se+1]+En)));if(Dn!==0){do{for(It=nn-1;dt.bl_count[It]===0;)It--;dt.bl_count[It]--,dt.bl_count[It+1]+=2,dt.bl_count[nn]--,Dn-=2}while(0<Dn);for(It=nn;It!==0;It--)for(Se=dt.bl_count[It];Se!==0;)Fr<(en=dt.heap[--tn])||(Be[2*en+1]!==It&&(dt.opt_len+=(It-Be[2*en+1])*Be[2*en],Be[2*en+1]=It),Se--)}}(E,T),Pt(V,St,E.bl_count)}function f(E,T,X){var U,k,V=-1,Q=T[1],J=0,nt=7,St=4;for(Q===0&&(nt=138,St=3),T[2*(X+1)+1]=65535,U=0;U<=X;U++)k=Q,Q=T[2*(U+1)+1],++J<nt&&k===Q||(J<St?E.bl_tree[2*k]+=J:k!==0?(k!==V&&E.bl_tree[2*k]++,E.bl_tree[2*L]++):J<=10?E.bl_tree[2*C]++:E.bl_tree[2*F]++,V=k,St=(J=0)===Q?(nt=138,3):k===Q?(nt=6,3):(nt=7,4))}function P(E,T,X){var U,k,V=-1,Q=T[1],J=0,nt=7,St=4;for(Q===0&&(nt=138,St=3),U=0;U<=X;U++)if(k=Q,Q=T[2*(U+1)+1],!(++J<nt&&k===Q)){if(J<St)for(;q(E,k,E.bl_tree),--J!=0;);else k!==0?(k!==V&&(q(E,k,E.bl_tree),J--),q(E,L,E.bl_tree),K(E,J-3,2)):J<=10?(q(E,C,E.bl_tree),K(E,J-3,3)):(q(E,F,E.bl_tree),K(E,J-11,7));V=k,St=(J=0)===Q?(nt=138,3):k===Q?(nt=6,3):(nt=7,4)}}l(W);var I=!1;function D(E,T,X,U){K(E,(c<<1)+(U?1:0),3),function(k,V,Q,J){bt(k),J&&(at(k,Q),at(k,~Q)),o.arraySet(k.pending_buf,k.window,V,Q,k.pending),k.pending+=Q}(E,T,X,!0)}a._tr_init=function(E){I||(function(){var T,X,U,k,V,Q=new Array(b+1);for(k=U=0;k<u-1;k++)for(H[k]=U,T=0;T<1<<M[k];T++)_[U++]=k;for(_[U-1]=k,k=V=0;k<16;k++)for(W[k]=V,T=0;T<1<<j[k];T++)$[V++]=k;for(V>>=7;k<h;k++)for(W[k]=V<<7,T=0;T<1<<j[k]-7;T++)$[256+V++]=k;for(X=0;X<=b;X++)Q[X]=0;for(T=0;T<=143;)tt[2*T+1]=8,T++,Q[8]++;for(;T<=255;)tt[2*T+1]=9,T++,Q[9]++;for(;T<=279;)tt[2*T+1]=7,T++,Q[7]++;for(;T<=287;)tt[2*T+1]=8,T++,Q[8]++;for(Pt(tt,m+1,Q),T=0;T<h;T++)w[2*T+1]=5,w[2*T]=xt(T,5);Z=new st(tt,M,d+1,m,b),Y=new st(w,j,0,h,b),ct=new st(new Array(0),B,0,p,v)}(),I=!0),E.l_desc=new N(E.dyn_ltree,Z),E.d_desc=new N(E.dyn_dtree,Y),E.bl_desc=new N(E.bl_tree,ct),E.bi_buf=0,E.bi_valid=0,ht(E)},a._tr_stored_block=D,a._tr_flush_block=function(E,T,X,U){var k,V,Q=0;0<E.level?(E.strm.data_type===2&&(E.strm.data_type=function(J){var nt,St=4093624447;for(nt=0;nt<=31;nt++,St>>>=1)if(1&St&&J.dyn_ltree[2*nt]!==0)return r;if(J.dyn_ltree[18]!==0||J.dyn_ltree[20]!==0||J.dyn_ltree[26]!==0)return s;for(nt=32;nt<d;nt++)if(J.dyn_ltree[2*nt]!==0)return s;return r}(E)),ue(E,E.l_desc),ue(E,E.d_desc),Q=function(J){var nt;for(f(J,J.dyn_ltree,J.l_desc.max_code),f(J,J.dyn_dtree,J.d_desc.max_code),ue(J,J.bl_desc),nt=p-1;3<=nt&&J.bl_tree[2*G[nt]+1]===0;nt--);return J.opt_len+=3*(nt+1)+5+5+4,nt}(E),k=E.opt_len+3+7>>>3,(V=E.static_len+3+7>>>3)<=k&&(k=V)):k=V=X+5,X+4<=k&&T!==-1?D(E,T,X,U):E.strategy===4||V===k?(K(E,2+(U?1:0),3),we(E,tt,w)):(K(E,4+(U?1:0),3),function(J,nt,St,dt){var Qt;for(K(J,nt-257,5),K(J,St-1,5),K(J,dt-4,4),Qt=0;Qt<dt;Qt++)K(J,J.bl_tree[2*G[Qt]+1],3);P(J,J.dyn_ltree,nt-1),P(J,J.dyn_dtree,St-1)}(E,E.l_desc.max_code+1,E.d_desc.max_code+1,Q+1),we(E,E.dyn_ltree,E.dyn_dtree)),ht(E),U&&bt(E)},a._tr_tally=function(E,T,X){return E.pending_buf[E.d_buf+2*E.last_lit]=T>>>8&255,E.pending_buf[E.d_buf+2*E.last_lit+1]=255&T,E.pending_buf[E.l_buf+E.last_lit]=255&X,E.last_lit++,T===0?E.dyn_ltree[2*X]++:(E.matches++,T--,E.dyn_ltree[2*(_[X]+d+1)]++,E.dyn_dtree[2*x(T)]++),E.last_lit===E.lit_bufsize-1},a._tr_align=function(E){K(E,2,3),q(E,S,tt),function(T){T.bi_valid===16?(at(T,T.bi_buf),T.bi_buf=0,T.bi_valid=0):8<=T.bi_valid&&(T.pending_buf[T.pending++]=255&T.bi_buf,T.bi_buf>>=8,T.bi_valid-=8)}(E)}},{"../utils/common":41}],53:[function(e,n,a){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,n,a){(function(o){(function(r,s){if(!r.setImmediate){var l,c,u,d,m=1,h={},p=!1,g=r.document,b=Object.getPrototypeOf&&Object.getPrototypeOf(r);b=b&&b.setTimeout?b:r,l={}.toString.call(r.process)==="[object process]"?function(L){process.nextTick(function(){v(L)})}:function(){if(r.postMessage&&!r.importScripts){var L=!0,C=r.onmessage;return r.onmessage=function(){L=!1},r.postMessage("","*"),r.onmessage=C,L}}()?(d="setImmediate$"+Math.random()+"$",r.addEventListener?r.addEventListener("message",S,!1):r.attachEvent("onmessage",S),function(L){r.postMessage(d+L,"*")}):r.MessageChannel?((u=new MessageChannel).port1.onmessage=function(L){v(L.data)},function(L){u.port2.postMessage(L)}):g&&"onreadystatechange"in g.createElement("script")?(c=g.documentElement,function(L){var C=g.createElement("script");C.onreadystatechange=function(){v(L),C.onreadystatechange=null,c.removeChild(C),C=null},c.appendChild(C)}):function(L){setTimeout(v,0,L)},b.setImmediate=function(L){typeof L!="function"&&(L=new Function(""+L));for(var C=new Array(arguments.length-1),F=0;F<C.length;F++)C[F]=arguments[F+1];var M={callback:L,args:C};return h[m]=M,l(m),m++},b.clearImmediate=y}function y(L){delete h[L]}function v(L){if(p)setTimeout(v,0,L);else{var C=h[L];if(C){p=!0;try{(function(F){var M=F.callback,j=F.args;switch(j.length){case 0:M();break;case 1:M(j[0]);break;case 2:M(j[0],j[1]);break;case 3:M(j[0],j[1],j[2]);break;default:M.apply(s,j)}})(C)}finally{y(L),p=!1}}}}function S(L){L.source===r&&typeof L.data=="string"&&L.data.indexOf(d)===0&&v(+L.data.slice(d.length))}})(typeof self>"u"?o===void 0?this:o:self)}).call(this,typeof Rn<"u"?Rn:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(Zc);const mm=Zc.exports;async function pm(i){return await mm.loadAsync(i)}const de=()=>"[main]",Me=async i=>{var t;try{console.time("loading time"),Tn.enable(!1);let e;if(i.file)e=i.file;else if(i.link)e=await dm(Ho(decodeURI(i.link)));else if(i.id)e=await qc(zo(decodeURI(i.id)));else if(i.hash&&Fo(decodeURI(i.hash).trim()))e=await fm(decodeURI(i.hash).trim());else throw new Error("Could not search for file.");wt.status("info","Extracting zip",0),Xt.switchHeader(!1);const n=await pm(e);Tn.enable(!1),wt.status("info","Parsing map info...",0),rt.info(de(),"Parsing map info");const a=await lm(n);lt.beatmapInfo=a,Tu(a),wt.status("info","Loading image...",10.4375),rt.info(de(),"Loading cover image");let o=n.file(a._coverImageFilename);if(et.load.imageCover&&o){let c=await o.async("base64");Xt.setCoverImage("data:image;base64,"+c),zi.loading.coverImage=!0}else rt.error(de(),`${a._coverImageFilename} does not exists.`);if(lt.contributors=[],(t=a==null?void 0:a._customData)!=null&&t._contributors)for(const c of a._customData._contributors){rt.info(de(),"Loading contributor image "+c._name),o=n.file(c._iconPath);let u=null;et.load.imageContributor&&o?u=await o.async("base64"):rt.error(de(),`${c._iconPath} does not exists.`),lt.contributors.push({...c,_base64:u})}wt.status("info","Loading audio...",20.875),rt.info(de(),"Loading audio");let r=n.file(a._songFilename);if(et.load.audio&&r){let c=!1;setTimeout(()=>{c||wt.status("info","Loading audio... (this may take a while)",20.875)},1e4);let u=await r.async("arraybuffer");Xt.setAudio(u),await new AudioContext().decodeAudioData(u).then(m=>{c=!0;let h=m.duration;lt.duration=h,Xt.setSongDuration(h),zi.loading.audio=!0}).catch(function(m){Xt.setSongDuration(),rt.error(de(),m)})}else Xt.setSongDuration(),rt.error(de(),`${a._songFilename} does not exist.`);wt.status("info","Parsing difficulty...",70),lt.beatmapDifficulty=await cm(a,n),Ri.adjustTime(),wt.status("info","Adding map difficulty stats...",80),rt.info(de(),"Adding map stats"),am(),rl(lt.contributors);let s=a._beatsPerMinute,l=a._beatsPerMinute;lt.beatmapDifficulty.forEach(c=>{const u=c.bpm.change.map(m=>m.BPM),d=c.data.bpmEvents.map(m=>m.bpm);s=Math.min(s,...u,...d),l=Math.max(l,...u,...d)}),s!==l&&Xt.setSongBPM(a._beatsPerMinute,s,l),wt.status("info","Analysing general...",85),rt.info(de(),"Analysing map"),Si.runGeneral(),Ri.displayOutputGeneral(),wt.status("info","Analysing difficulty...",90),Si.applyAll(),Ri.populateSelect(a),Ri.displayOutputDifficulty(),Tn.enable(!0),wt.status("info","Map successfully loaded!"),console.timeEnd("loading time")}catch(e){wt.status("error",e,100),rt.error(de(),e),lt.clear(),Tn.enable(!0),Xt.switchHeader(!0)}},Qi="UI Intro: ",hn=document.querySelector(".input__intro-url"),dn=document.querySelector(".input__intro-id"),fn=document.querySelector(".input__intro-hash"),No=document.querySelector(".input__search-button"),Io=document.querySelector(".input__file"),Ta=document.querySelector(".input__file-zone");if(hn)hn.addEventListener("keydown",Nr);else throw new Error(Qi+"URL input is missing");if(dn)dn.addEventListener("keydown",Nr);else throw new Error(Qi+"ID input is missing");if(fn)fn.addEventListener("keydown",Nr);else throw new Error(Qi+"Hash input is missing");if(No)No.addEventListener("click",gm);else throw new Error(Qi+"search button is missing");if(Io)Io.addEventListener("change",_m);else throw new Error(Qi+"file input is missing");if(Ta)Ta.addEventListener("drop",bm),Ta.addEventListener("dragover",ym);else throw new Error(Qi+"file drop zone is missing");function Nr(i){const t=i.target;i.key==="Enter"&&t.value!==""&&(t.classList.contains("input__intro-url")&&Me({link:t.value}),t.classList.contains("input__intro-id")&&Me({id:t.value}),t.classList.contains("input__intro-hash")&&Me({hash:t.value}))}function gm(i){if(hn&&hn.value!==""){Me({link:hn.value});return}if(dn&&dn.value!==""){Me({id:dn.value});return}if(fn&&fn.value!==""){Me({hash:fn.value});return}}function _m(i){const t=i.target;wt.status("info","Reading file input",0);const e=t.files?t.files[0]:null;try{if(e==null)throw wt.status("info","No file input",0),new Error("No file input");if(e&&(e.name.substr(-4)===".zip"||e.name.substr(-4)===".bsl")){const n=new FileReader;n.readAsArrayBuffer(e),n.addEventListener("load",()=>{Me({file:e})})}else throw new Error("Unsupported file format, please enter zip file")}catch(n){wt.status("error",n,0),console.error(n)}}function bm(i){i.preventDefault(),i.stopPropagation();try{if(i.dataTransfer==null)throw new Error("No file input");if(i.dataTransfer.items&&i.dataTransfer.items[0].kind==="file"){let t=i.dataTransfer.items[0].getAsFile();if(t&&(t.name.substr(-4)===".zip"||t.name.substr(-4)===".bsl")){const e=new FileReader;e.readAsArrayBuffer(t),e.addEventListener("load",()=>{Me({file:t})})}else throw new Error("Unsupported file format, please enter zip file")}}catch(t){wt.status("error",t,0),console.error(t)}}function ym(i){i.preventDefault(),i.stopPropagation()}const vm=document.querySelector("body"),Em=["Dark","Light","Monochrome"],Ir={list:Em,set:i=>{vm.className="theme-"+i.toLowerCase().replace(" ","")}},De="UI Settings: ",Gn=document.querySelector(".settings__theme"),qa=document.querySelector(".settings__beat-numbering"),Za=document.querySelector(".settings__rounding"),Ka=document.querySelector(".settings__info-height"),Qa=document.querySelector(".settings__data-check"),tr=document.querySelector(".settings__data-error"),Ar=document.querySelectorAll(".settings__load"),pa=document.querySelector(".settings__sort"),Br=document.querySelectorAll(".settings__show"),$r=document.querySelectorAll(".settings__onload"),Ao=document.querySelector(".settings__clear-button");if(Gn)Gn.addEventListener("change",Dm),Ir.list.forEach(i=>{const t=document.createElement("option");t.value=i,t.textContent=i,Gn.add(t)});else throw new Error(De+"theme select is missing");if(qa)qa.addEventListener("change",wm);else throw new Error(De+"missing settings");if(Za)Za.addEventListener("change",Sm);else throw new Error(De+"missing settings");if(Ka)Ka.addEventListener("change",Tm);else throw new Error(De+"missing settings");if(Qa)Qa.addEventListener("change",Lm);else throw new Error(De+"missing settings");if(tr)tr.addEventListener("change",Cm);else throw new Error(De+"missing settings");Ar.length||console.error(De+"empty load list, intentional or typo error?");Ar.forEach(i=>i.addEventListener("change",Im));if(pa)pa.addEventListener("change",xm);else throw new Error(De+"sort check is missing");$r.length||console.error(De+"empty onload list, intentional or typo error?");$r.forEach(i=>i.addEventListener("change",Bm));Br.length||console.error(De+"empty show list, intentional or typo error?");Br.forEach(i=>i.addEventListener("change",km));if(Ao)Ao.addEventListener("click",Kc);else throw new Error(De+"clear button is missing");function Dm(i){const t=i.target;et.theme=t.options[t.options.selectedIndex].value,Ir.set(et.theme),et.save()}function wm(i){const t=i.target;et.beatNumbering=t.options[t.options.selectedIndex].value,et.save()}function Sm(i){const t=i.target;et.rounding=parseInt(t.value),et.save()}function Tm(i){const t=i.target;et.infoRowHeight=parseInt(t.value),ll(et.infoRowHeight),et.save()}function Lm(i){const t=i.target;et.dataCheck=t.checked,et.save()}function Cm(i){const t=i.target;et.dataError=t.checked,et.save()}function km(i){const t=i.target,e=t.id.replace("settings__show-","");et.show[e]=t.checked,et.save()}function Rm(i,t){Br.forEach(e=>{e.id.endsWith(i)&&(e.checked=t)})}function xm(i){const t=i.target;et.sorting=t.checked,et.save()}function Nm(i){pa&&(pa.checked=i)}function Im(i){const t=i.target,e=t.name;et.load[e]=t.checked,et.save()}function Am(i,t){Ar.forEach(e=>{e.name===i&&(e.checked=t)})}function Bm(i){const t=i.target,e=t.name;et.onLoad[e]=t.checked,et.save()}function $m(i,t){$r.forEach(e=>{e.name===i&&(e.checked=t)})}function Om(i){Gn.value=i}function Mm(i){qa.value=i}function Pm(i){Za.value=i.toString()}function Fm(i){Ka.value=i.toString(),ll(et.infoRowHeight)}function Hm(i){Qa.checked=i}function zm(i){tr.checked=i}function Kc(){et.clear(),et.reset(),location.reload()}const Te={setShowCheck:Rm,setSortCheck:Nm,setLoadCheck:Am,setOnLoadCheck:$m,setTheme:Om,setBeatNumbering:Mm,setRounding:Pm,setInfoHeight:Fm,setDataCheck:Hm,setDataError:zm,clear:Kc},Xm=document.querySelectorAll(".input__reset-button");Xm.forEach(i=>i.addEventListener("click",Um));function Um(){wt.reset(),Xt.reset(),Lu(),Ri.reset(),rm(),lt.clear()}const jm=2,Ym=5,Gm=6,Wm="Kival Evan#5480",Bo=new class{constructor(){O(this,"_version",`${jm}.${Ym}.${Gm}`);O(this,"_wm",Wm)}get value(){return this._version}get watermark(){return this._wm}},Vm="UI Footer: ",Qc=document.querySelectorAll(".link__watermark"),tu=document.querySelectorAll(".link__version");(!Qc.length||!tu.length)&&console.error(Vm+"missing part");const $o={setWatermark:i=>{Qc.forEach(t=>t.textContent=i)},setVersion:i=>{tu.forEach(t=>t.textContent=i)}},Jm=function(){let i=!1;return function(){if(!i){i=!0,$o.setWatermark(Bo.watermark),$o.setVersion(Bo.value),Ri.populateTool(),Te.setTheme(et.theme),Te.setBeatNumbering(et.beatNumbering),Te.setRounding(et.rounding),Te.setInfoHeight(et.infoRowHeight),Te.setDataCheck(et.dataCheck),Te.setDataError(et.dataError);for(const t in et.load)Te.setLoadCheck(t,et.load[t]);Te.setSortCheck(et.sorting);for(const t in et.show)Po.show(t,et.show[t]),Te.setShowCheck(t,et.show[t]);for(const t in et.onLoad)Te.setOnLoadCheck(t,et.onLoad[t]);Ir.set(et.theme),rt.info("User interface initialised")}}}();(function(){Jm();const i=new URL(location.href),t=i.searchParams.get("url"),e=i.searchParams.get("id"),n=i.searchParams.get("hash");(e||t||n)&&Me({link:t,id:e,hash:n})})();
